<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/reverb.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('reverb_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">reverb.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="reverb_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***********************************************************/</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="atomic_8h.html">atomic.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="python_8h.html">python.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">   17</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>[<a class="code" href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a>];</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">   18</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">delay_dump_bank_size</a> = 65535, <a class="code" href="reverb_8c.html#a43dc90d8db821aedbbdb98368d4e1000">delay_dump_bank_curr</a> = 0;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">   19</a></span>&#160;<span class="keywordtype">int</span> *<a class="code" href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">delay_dump_spec</a>;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="reverb_8c.html#a7bfc559baf9a00e484c273ebef3e387f">   20</a></span>&#160;<a class="code" href="structphoton.html">PhotPtr</a> <a class="code" href="reverb_8c.html#a7bfc559baf9a00e484c273ebef3e387f">delay_dump_bank</a>;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keywordtype">double</span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="templates_8h.html#aa5efed3848af045bb3035fc6db93e757">   37</a></span>&#160;<a class="code" href="reverb_8c.html#aa5efed3848af045bb3035fc6db93e757">delay_to_observer</a> (<a class="code" href="structphoton.html">PhotPtr</a> pp)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="structplane.html">plane_dummy</a> observer;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  observer.<a class="code" href="structplane.html#a3e0a915298ae7b9f7dbde607ebf5e5fa">x</a>[0] = pp-&gt;<a class="code" href="structphoton.html#a1166dfb4c725aac37dafe72bcf1aec2b">lmn</a>[0] * <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7e0e317f07c82f819badcb1cfc4fc478">rmax</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  observer.<a class="code" href="structplane.html#a3e0a915298ae7b9f7dbde607ebf5e5fa">x</a>[1] = pp-&gt;<a class="code" href="structphoton.html#a1166dfb4c725aac37dafe72bcf1aec2b">lmn</a>[1] * <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7e0e317f07c82f819badcb1cfc4fc478">rmax</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  observer.<a class="code" href="structplane.html#a3e0a915298ae7b9f7dbde607ebf5e5fa">x</a>[2] = pp-&gt;<a class="code" href="structphoton.html#a1166dfb4c725aac37dafe72bcf1aec2b">lmn</a>[2] * <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7e0e317f07c82f819badcb1cfc4fc478">rmax</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  observer.<a class="code" href="structplane.html#aecafa59e4a24ae66f9dd66e6ce87be4b">lmn</a>[0] = pp-&gt;<a class="code" href="structphoton.html#a1166dfb4c725aac37dafe72bcf1aec2b">lmn</a>[0];</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  observer.<a class="code" href="structplane.html#aecafa59e4a24ae66f9dd66e6ce87be4b">lmn</a>[1] = pp-&gt;<a class="code" href="structphoton.html#a1166dfb4c725aac37dafe72bcf1aec2b">lmn</a>[1];</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  observer.<a class="code" href="structplane.html#aecafa59e4a24ae66f9dd66e6ce87be4b">lmn</a>[2] = pp-&gt;<a class="code" href="structphoton.html#a1166dfb4c725aac37dafe72bcf1aec2b">lmn</a>[2];</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span> (pp-&gt;<a class="code" href="structphoton.html#a3029350c63c7c27314adca143458c4ed">path</a> + <a class="code" href="foo_8h.html#ae443765b508c1d69ac5249ef9de2bb81">ds_to_plane</a> (&amp;observer, pp));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="templates_8h.html#aed071173676fa884b0045139793c85d7">   68</a></span>&#160;<a class="code" href="reverb_8c.html#aed071173676fa884b0045139793c85d7">delay_dump_prep</a> (<span class="keywordtype">int</span> restart_stat)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  FILE *fptr;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">char</span> s_time[<a class="code" href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a>];</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//Get output filename</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> &gt; 0)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    sprintf (<a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>, <span class="stringliteral">&quot;%s.delay_dump%d&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    sprintf (<a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>, <span class="stringliteral">&quot;%s.delay_dump&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">//Allocate and zero dump files and set extract status</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  delay_dump_bank = (<a class="code" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>) calloc (<span class="keyword">sizeof</span> (<a class="code" href="structphoton.html">p_dummy</a>), <a class="code" href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">delay_dump_bank_size</a>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">delay_dump_spec</a> = (<span class="keywordtype">int</span> *) calloc (<span class="keyword">sizeof</span> (<span class="keywordtype">int</span>), <a class="code" href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">delay_dump_bank_size</a>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">delay_dump_bank_size</a>; i++)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">delay_dump_spec</a>[i] = 0;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span> (restart_stat == 1)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  {                             <span class="comment">//Check whether the output file already has a header</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;delay_dump_prep: Resume run, skipping writeout\n&quot;</span>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> ((fptr = fopen (<a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>, <span class="stringliteral">&quot;w&quot;</span>)) != NULL)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  {                             <span class="comment">//If this isn&#39;t a continue run, prep the output file</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> &gt; 0)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;# Delay dump file for slave process %d\n&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {                           <span class="comment">// Construct and write a header string for the output file</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;# Python Version %s\n&quot;</span>, <a class="code" href="version_8h.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="foo_8h.html#aa3b24089fadbcdf92560f31730390556">get_time</a> (s_time);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;# Date    %s\n#  \n&quot;</span>, s_time);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;# \n#    Freq.     Lambda     Weight      Last X      Last Y      Last Z Scat. RScat      Delay Spec. Orig.  Res.\n&quot;</span>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    fclose (fptr);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;delay_dump_prep: Thread %d successfully prepared file &#39;%s&#39; for writing\n&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>, <a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;delay_dump_prep: Thread %d failed to open file &#39;%s&#39; due to error %d: %s\n&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>, <a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>, errno,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;           strerror (errno));</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="templates_8h.html#a835e66c48118aa52e1903512ed676f20">  133</a></span>&#160;<a class="code" href="reverb_8c.html#a835e66c48118aa52e1903512ed676f20">delay_dump_finish</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;delay_dump_finish: Dumping %d photons to file\n&quot;</span>, <a class="code" href="reverb_8c.html#a43dc90d8db821aedbbdb98368d4e1000">delay_dump_bank_curr</a> - 1);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="reverb_8c.html#a43dc90d8db821aedbbdb98368d4e1000">delay_dump_bank_curr</a> &gt; 0)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="reverb_8c.html#ac0ede87d97addcd4c5df57e2930dbdb6">delay_dump</a> (delay_dump_bank, <a class="code" href="reverb_8c.html#a43dc90d8db821aedbbdb98368d4e1000">delay_dump_bank_curr</a> - 1);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  free (delay_dump_bank);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  free (<a class="code" href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">delay_dump_spec</a>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="templates_8h.html#a83531c4a215b42e705cd97b00088be71">  159</a></span>&#160;<a class="code" href="reverb_8c.html#a83531c4a215b42e705cd97b00088be71">delay_dump_combine</a> (<span class="keywordtype">int</span> i_ranks)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  FILE *fopen ();               <span class="comment">//, *f_base, *f_cat;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">char</span> c_call[<a class="code" href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a>];      <span class="comment">//, c_cat[LINELENGTH], c_char;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">//int i;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">    f_base = fopen(delay_dump_file, &#39;a&#39;);</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">    for(i=1;i&lt;iRanks;i++)</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">    {</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">        sprintf(c_cat, &quot;%s%d&quot;, c_cat, i);</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">        if((f_cat = fopen(c_cat, &#39;r&#39;)) == NULL)</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">            Error(&quot;delay_dump_combine: Missing file %s%d&quot;, c_cat,i);</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">        else</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">            while((c_char = fgetc(f_cat)) != EOF) fputc(c_char, f_base);</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">        fclose(f_cat);</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">    fclose(f_base);</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">//Yes this is done as a system call and won &#39;t work on Windows machines. Lazy solution!</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  sprintf (c_call, <span class="stringliteral">&quot;cat %s[0-9]* &gt;&gt; %s&quot;</span>, <a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>, <a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (system (c_call) &lt; 0)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;delay_dump_combine: Error calling system command &#39;%s&#39;&quot;</span>, c_call);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    sprintf (c_call, <span class="stringliteral">&quot;rm %s[0-9]*&quot;</span>, <a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (system (c_call) &lt; 0)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;delay_dump_combine: Error calling system command &#39;%s&#39;&quot;</span>, c_call);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="templates_8h.html#ac0ede87d97addcd4c5df57e2930dbdb6">  212</a></span>&#160;<a class="code" href="reverb_8c.html#ac0ede87d97addcd4c5df57e2930dbdb6">delay_dump</a> (<a class="code" href="structphoton.html">PhotPtr</a> p, <span class="keywordtype">int</span> <a class="code" href="structphoton.html#ac6a38267c9cc04060e249c1cbaad3d9a">np</a>)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  FILE *fopen (), *fptr;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordtype">int</span> nphot, mscat, mtopbot, <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>, subzero;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordtype">double</span> delay;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  subzero = 0;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;delay_dump: Dumping %d photons\n&quot;</span>, np);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">   * Open a file for writing the spectrum</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">if</span> ((fptr = fopen (<a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>, <span class="stringliteral">&quot;a&quot;</span>)) == NULL)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;delay_dump: Unable to reopen %s for writing\n&quot;</span>, <a class="code" href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    exit (0);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">for</span> (nphot = 0; nphot &lt; <a class="code" href="structphoton.html#ac6a38267c9cc04060e249c1cbaad3d9a">np</a>; nphot++)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">     * Complicated if statement to allow one to choose</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">     * whether to construct the spectrum from all photons</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">     * or just from photons which have scattered a</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">     * specific number of times.  01apr13--ksl-Modified</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">     * if statement to change behavior on negative</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">     * numbers to say that a negative number for mscat</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">     * implies that you accept any photon with |mscat| or</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">     * more scatters</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    i = <a class="code" href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">delay_dump_spec</a>[nphot];</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (((mscat = <a class="code" href="python_8h.html#aab08a99ccf346fb7e214cecf5cc371ca">xxspec</a>[i].<a class="code" href="python_8h.html#a7f1a35f2b77c432f12210d39f4d95501">nscat</a>) &gt; 999 ||</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;         p[nphot].nscat == mscat ||</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         (mscat &lt; 0 &amp;&amp; p[nphot].nscat &gt;= (-mscat))) &amp;&amp; ((mtopbot = <a class="code" href="python_8h.html#aab08a99ccf346fb7e214cecf5cc371ca">xxspec</a>[i].top_bot) == 0 || (mtopbot * p[nphot].<a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[2]) &gt; 0))</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      delay = (<a class="code" href="reverb_8c.html#aa5efed3848af045bb3035fc6db93e757">delay_to_observer</a> (&amp;p[nphot]) - <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7e0e317f07c82f819badcb1cfc4fc478">rmax</a>) / <a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">if</span> (delay &lt; 0)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        subzero++;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        fprintf (fptr,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                 <span class="stringliteral">&quot;%10.5g %12.7g %10.5g %+10.5g %+10.5g %+10.5g %3d     %3d     %10.5g %5d %5d %5d\n&quot;</span>,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                 p[nphot].<a class="code" href="structphoton.html#a98c6d400814a43aeda7d7fd1ed2d7dc6">freq</a>, <a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> * 1e8 / p[nphot].freq, p[nphot].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                 p[nphot].x[0], p[nphot].x[1], p[nphot].x[2],</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                 p[nphot].nscat, p[nphot].<a class="code" href="structphoton.html#a96a247f2621b88fe5313dbfdeca7d37f">nrscat</a>, delay,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                 i - <a class="code" href="python_8h.html#a22df28a6020ba05104bc3f04858b7c22">MSPEC</a>, p[nphot].<a class="code" href="structphoton.html#a201206174a8fa79b29526a68e20704cf">origin</a>, p[nphot].<a class="code" href="python_8h.html#ac1f90b11b79f8d2c9a25f12643063ee7">nres</a>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (subzero &gt; 0)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;delay_dump: %d photons with &lt;0 delay found! Increase path bin resolution to minimise this error.&quot;</span>, subzero);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  fclose (fptr);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="templates_8h.html#a30c0a9051caebba27b5ef5583d38ad0c">  281</a></span>&#160;<a class="code" href="reverb_8c.html#a30c0a9051caebba27b5ef5583d38ad0c">delay_dump_single</a> (<a class="code" href="structphoton.html">PhotPtr</a> pp, <span class="keywordtype">int</span> i_spec)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18f12c75b10603ccb3083536f26cc7a3">reverb_filter_lines</a> == -1 &amp;&amp; pp-&gt;<a class="code" href="structphoton.html#ad91ab6667b2f4635925deb64ea7841bd">nres</a> == -1)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">//If we&#39;re filtering out continuum photons and this is a continuum photon, throw it away.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span> (1);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18f12c75b10603ccb3083536f26cc7a3">reverb_filter_lines</a> &gt; 0)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//If we&#39;re filtering to *only* photons of given lines, is this one of them? If not, throw away</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>, bFound = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18f12c75b10603ccb3083536f26cc7a3">reverb_filter_lines</a>; i++)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">if</span> (pp-&gt;<a class="code" href="structphoton.html#ad91ab6667b2f4635925deb64ea7841bd">nres</a> == <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab6ec9d315491d03aa734835e215aa1ce">reverb_filter_line</a>[i])</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        bFound = 1;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (!bFound)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">return</span> (1);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041">stuff_phot</a> (pp, &amp;delay_dump_bank[<a class="code" href="reverb_8c.html#a43dc90d8db821aedbbdb98368d4e1000">delay_dump_bank_curr</a>]);      <span class="comment">//Bank single photon in temp array</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">delay_dump_spec</a>[<a class="code" href="reverb_8c.html#a43dc90d8db821aedbbdb98368d4e1000">delay_dump_bank_curr</a>] = i_spec;       <span class="comment">//Record photon spectrum too</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">if</span> (delay_dump_bank_curr == <a class="code" href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">delay_dump_bank_size</a> - 1) <span class="comment">//If temp array is full</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="reverb_8c.html#ac0ede87d97addcd4c5df57e2930dbdb6">delay_dump</a> (delay_dump_bank, <a class="code" href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">delay_dump_bank_size</a>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    delay_dump_bank_curr = 0;   <span class="comment">//Dump to file, zero array position</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    delay_dump_bank_curr++;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div><div class="ttc" id="reverb_8c_html_a835e66c48118aa52e1903512ed676f20"><div class="ttname"><a href="reverb_8c.html#a835e66c48118aa52e1903512ed676f20">delay_dump_finish</a></div><div class="ttdeci">int delay_dump_finish(void)</div><div class="ttdoc">Finishes dumping tracked photons to file. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00133">reverb.c:133</a></div></div>
<div class="ttc" id="structgeometry_html_a7e0e317f07c82f819badcb1cfc4fc478"><div class="ttname"><a href="structgeometry.html#a7e0e317f07c82f819badcb1cfc4fc478">geometry::rmax</a></div><div class="ttdeci">double rmax</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00357">python.h:357</a></div></div>
<div class="ttc" id="structphoton_html_a5fa87a07a9ceef33dd79aa5cdd7856cb"><div class="ttname"><a href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">photon::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01039">python.h:1039</a></div></div>
<div class="ttc" id="log_8h_html_a9a25be4f0d7d13fccc8457774d74167f"><div class="ttname"><a href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="ttdeci">int Log(char *format,...)</div><div class="ttdoc">Print/write an informational message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00325">xlog.c:325</a></div></div>
<div class="ttc" id="version_8h_html_a1c6d5de492ac61ad29aec7aa9a436bbf"><div class="ttname"><a href="version_8h.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a></div><div class="ttdeci">#define VERSION</div><div class="ttdef"><b>Definition:</b> <a href="version_8h_source.html#l00001">version.h:1</a></div></div>
<div class="ttc" id="python_8h_html_aab08a99ccf346fb7e214cecf5cc371ca"><div class="ttname"><a href="python_8h.html#aab08a99ccf346fb7e214cecf5cc371ca">xxspec</a></div><div class="ttdeci">SpecPtr xxspec</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01175">python.h:1175</a></div></div>
<div class="ttc" id="python_8h_html_ad2424d53ebcf811656882a87e11b440c"><div class="ttname"><a href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a></div><div class="ttdeci">struct photon * PhotPtr</div></div>
<div class="ttc" id="structgeometry_html_ab6ec9d315491d03aa734835e215aa1ce"><div class="ttname"><a href="structgeometry.html#ab6ec9d315491d03aa734835e215aa1ce">geometry::reverb_filter_line</a></div><div class="ttdeci">int * reverb_filter_line</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00580">python.h:580</a></div></div>
<div class="ttc" id="reverb_8c_html_aa5efed3848af045bb3035fc6db93e757"><div class="ttname"><a href="reverb_8c.html#aa5efed3848af045bb3035fc6db93e757">delay_to_observer</a></div><div class="ttdeci">double delay_to_observer(PhotPtr pp)</div><div class="ttdoc">Calculates the delay to the observer plane. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00037">reverb.c:37</a></div></div>
<div class="ttc" id="reverb_8c_html_a30c0a9051caebba27b5ef5583d38ad0c"><div class="ttname"><a href="reverb_8c.html#a30c0a9051caebba27b5ef5583d38ad0c">delay_dump_single</a></div><div class="ttdeci">int delay_dump_single(PhotPtr pp, int i_spec)</div><div class="ttdoc">Preps a single photon to be dumped. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00281">reverb.c:281</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_ab47e1e72aea1af4158c96f38ee80b8f7"><div class="ttname"><a href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a></div><div class="ttdeci">int i[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00031">import_cylindrical.c:31</a></div></div>
<div class="ttc" id="python_8h_html_a22df28a6020ba05104bc3f04858b7c22"><div class="ttname"><a href="python_8h.html#a22df28a6020ba05104bc3f04858b7c22">MSPEC</a></div><div class="ttdeci">#define MSPEC</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01131">python.h:1131</a></div></div>
<div class="ttc" id="python_8h_html_ac5be720a47277d650c31cee6ee815026"><div class="ttname"><a href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a></div><div class="ttdeci">struct filenames files</div></div>
<div class="ttc" id="structplane_html_aecafa59e4a24ae66f9dd66e6ce87be4b"><div class="ttname"><a href="structplane.html#aecafa59e4a24ae66f9dd66e6ce87be4b">plane::lmn</a></div><div class="ttdeci">double lmn[3]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00171">python.h:171</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_a099bc7b5a9501685180c163c1ffb67d0"><div class="ttname"><a href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a></div><div class="ttdeci">double x[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00033">import_cylindrical.c:33</a></div></div>
<div class="ttc" id="structphoton_html"><div class="ttname"><a href="structphoton.html">photon</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01034">python.h:1034</a></div></div>
<div class="ttc" id="reverb_8c_html_a55ca7fab98bba495ce75d100d6e90d4c"><div class="ttname"><a href="reverb_8c.html#a55ca7fab98bba495ce75d100d6e90d4c">delay_dump_file</a></div><div class="ttdeci">char delay_dump_file[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00017">reverb.c:17</a></div></div>
<div class="ttc" id="reverb_8c_html_a588f4feb9a791e95c422851e3806239e"><div class="ttname"><a href="reverb_8c.html#a588f4feb9a791e95c422851e3806239e">delay_dump_bank_size</a></div><div class="ttdeci">int delay_dump_bank_size</div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00018">reverb.c:18</a></div></div>
<div class="ttc" id="foo_8h_html_aa3b24089fadbcdf92560f31730390556"><div class="ttname"><a href="foo_8h.html#aa3b24089fadbcdf92560f31730390556">get_time</a></div><div class="ttdeci">int get_time(char curtime[])</div></div>
<div class="ttc" id="python_8h_html_a3a571e0bd4220490c5c5bd86f51c83ba"><div class="ttname"><a href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a></div><div class="ttdeci">struct geometry geo</div></div>
<div class="ttc" id="foo_8h_html_ae443765b508c1d69ac5249ef9de2bb81"><div class="ttname"><a href="foo_8h.html#ae443765b508c1d69ac5249ef9de2bb81">ds_to_plane</a></div><div class="ttdeci">double ds_to_plane(struct plane *pl, struct photon *p)</div><div class="ttdoc">calculates the distance of a photon must travel to hit the plane. </div><div class="ttdef"><b>Definition:</b> <a href="phot__util_8c_source.html#l00794">phot_util.c:794</a></div></div>
<div class="ttc" id="structphoton_html_a201206174a8fa79b29526a68e20704cf"><div class="ttname"><a href="structphoton.html#a201206174a8fa79b29526a68e20704cf">photon::origin</a></div><div class="ttdeci">enum photon::origin_enum origin</div></div>
<div class="ttc" id="structplane_html_a3e0a915298ae7b9f7dbde607ebf5e5fa"><div class="ttname"><a href="structplane.html#a3e0a915298ae7b9f7dbde607ebf5e5fa">plane::x</a></div><div class="ttdeci">double x[3]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00170">python.h:170</a></div></div>
<div class="ttc" id="python_8h_html_a7f1a35f2b77c432f12210d39f4d95501"><div class="ttname"><a href="python_8h.html#a7f1a35f2b77c432f12210d39f4d95501">nscat</a></div><div class="ttdeci">int nscat[MAXSCAT+1]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01138">python.h:1138</a></div></div>
<div class="ttc" id="structphoton_html_a98c6d400814a43aeda7d7fd1ed2d7dc6"><div class="ttname"><a href="structphoton.html#a98c6d400814a43aeda7d7fd1ed2d7dc6">photon::freq</a></div><div class="ttdeci">double freq</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01038">python.h:1038</a></div></div>
<div class="ttc" id="reverb_8c_html_a43dc90d8db821aedbbdb98368d4e1000"><div class="ttname"><a href="reverb_8c.html#a43dc90d8db821aedbbdb98368d4e1000">delay_dump_bank_curr</a></div><div class="ttdeci">int delay_dump_bank_curr</div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00018">reverb.c:18</a></div></div>
<div class="ttc" id="structfilenames_html_a8c053bab321640d4f0f5b75110980c89"><div class="ttname"><a href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">filenames::root</a></div><div class="ttdeci">char root[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01371">python.h:1371</a></div></div>
<div class="ttc" id="python_8h_html"><div class="ttname"><a href="python_8h.html">python.h</a></div></div>
<div class="ttc" id="get__atomicdata_8c_html_a10e8c7b8458375c3dbfbb4010a2aba8c"><div class="ttname"><a href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a></div><div class="ttdeci">#define LINELENGTH</div><div class="ttdef"><b>Definition:</b> <a href="get__atomicdata_8c_source.html#l00159">get_atomicdata.c:159</a></div></div>
<div class="ttc" id="python_8h_html_a48632b55b333d2627f6a1ddd87b3d7ea"><div class="ttname"><a href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a></div><div class="ttdeci">int rank_global</div><div class="ttdoc">Global variable which holds the number of MPI processes. </div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00009">python.h:9</a></div></div>
<div class="ttc" id="structphoton_html_a1166dfb4c725aac37dafe72bcf1aec2b"><div class="ttname"><a href="structphoton.html#a1166dfb4c725aac37dafe72bcf1aec2b">photon::lmn</a></div><div class="ttdeci">double lmn[3]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01037">python.h:1037</a></div></div>
<div class="ttc" id="python_8h_html_ac1f90b11b79f8d2c9a25f12643063ee7"><div class="ttname"><a href="python_8h.html#ac1f90b11b79f8d2c9a25f12643063ee7">nres</a></div><div class="ttdeci">int nres[MAXSCAT+1]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01138">python.h:1138</a></div></div>
<div class="ttc" id="structphoton_html_ad91ab6667b2f4635925deb64ea7841bd"><div class="ttname"><a href="structphoton.html#ad91ab6667b2f4635925deb64ea7841bd">photon::nres</a></div><div class="ttdeci">int nres</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01056">python.h:1056</a></div></div>
<div class="ttc" id="log_8h_html_a4f4caa375f1c3a9def422000f305cce5"><div class="ttname"><a href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="ttdeci">int Error(char *format,...)</div><div class="ttdoc">Print/write out an error message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00402">xlog.c:402</a></div></div>
<div class="ttc" id="atomic_8h_html"><div class="ttname"><a href="atomic_8h.html">atomic.h</a></div></div>
<div class="ttc" id="reverb_8c_html_aed071173676fa884b0045139793c85d7"><div class="ttname"><a href="reverb_8c.html#aed071173676fa884b0045139793c85d7">delay_dump_prep</a></div><div class="ttdeci">int delay_dump_prep(int restart_stat)</div><div class="ttdoc">Prepares delay dump output file. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00068">reverb.c:68</a></div></div>
<div class="ttc" id="atomic_8h_html_ac4cf4b2ab929bd23951a8676eeac086b"><div class="ttname"><a href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div><div class="ttdeci">#define C</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00011">atomic.h:11</a></div></div>
<div class="ttc" id="structphoton_html_ac6a38267c9cc04060e249c1cbaad3d9a"><div class="ttname"><a href="structphoton.html#ac6a38267c9cc04060e249c1cbaad3d9a">photon::np</a></div><div class="ttdeci">int np</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01082">python.h:1082</a></div></div>
<div class="ttc" id="structgeometry_html_a18f12c75b10603ccb3083536f26cc7a3"><div class="ttname"><a href="structgeometry.html#a18f12c75b10603ccb3083536f26cc7a3">geometry::reverb_filter_lines</a></div><div class="ttdeci">int reverb_filter_lines</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00580">python.h:580</a></div></div>
<div class="ttc" id="structphoton_html_a3029350c63c7c27314adca143458c4ed"><div class="ttname"><a href="structphoton.html#a3029350c63c7c27314adca143458c4ed">photon::path</a></div><div class="ttdeci">double path</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01084">python.h:1084</a></div></div>
<div class="ttc" id="reverb_8c_html_a83531c4a215b42e705cd97b00088be71"><div class="ttname"><a href="reverb_8c.html#a83531c4a215b42e705cd97b00088be71">delay_dump_combine</a></div><div class="ttdeci">int delay_dump_combine(int i_ranks)</div><div class="ttdoc">Prepares delay dump output file. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00159">reverb.c:159</a></div></div>
<div class="ttc" id="reverb_8c_html_ac4656ec5b05a4c9cd89509459fd8243e"><div class="ttname"><a href="reverb_8c.html#ac4656ec5b05a4c9cd89509459fd8243e">delay_dump_spec</a></div><div class="ttdeci">int * delay_dump_spec</div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00019">reverb.c:19</a></div></div>
<div class="ttc" id="reverb_8c_html_ac0ede87d97addcd4c5df57e2930dbdb6"><div class="ttname"><a href="reverb_8c.html#ac0ede87d97addcd4c5df57e2930dbdb6">delay_dump</a></div><div class="ttdeci">int delay_dump(PhotPtr p, int np)</div><div class="ttdoc">Dumps tracked photons to file. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00212">reverb.c:212</a></div></div>
<div class="ttc" id="foo_8h_html_a1c6dc9c24a43e2bc6319b23faba4a041"><div class="ttname"><a href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041">stuff_phot</a></div><div class="ttdeci">int stuff_phot(PhotPtr pin, PhotPtr pout)</div><div class="ttdoc">Simply copy one photon bundle into another. </div><div class="ttdef"><b>Definition:</b> <a href="phot__util_8c_source.html#l00046">phot_util.c:46</a></div></div>
<div class="ttc" id="structplane_html"><div class="ttname"><a href="structplane.html">plane</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00168">python.h:168</a></div></div>
<div class="ttc" id="reverb_8c_html_a7bfc559baf9a00e484c273ebef3e387f"><div class="ttname"><a href="reverb_8c.html#a7bfc559baf9a00e484c273ebef3e387f">delay_dump_bank</a></div><div class="ttdeci">PhotPtr delay_dump_bank</div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00020">reverb.c:20</a></div></div>
<div class="ttc" id="structphoton_html_a96a247f2621b88fe5313dbfdeca7d37f"><div class="ttname"><a href="structphoton.html#a96a247f2621b88fe5313dbfdeca7d37f">photon::nrscat</a></div><div class="ttdeci">int nrscat</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01061">python.h:1061</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="reverb_8c.html">reverb.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
