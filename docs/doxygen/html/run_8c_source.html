<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/run.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('run_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">run.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="run_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/***********************************************************/</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="atomic_8h.html">atomic.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="python_8h.html">python.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616">   52</a></span>&#160;<a class="code" href="run_8c.html#a28fc174aa63a5eeef6de99ef392e1616">calculate_ionization</a> (restart_stat)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;     <span class="keywordtype">int</span> restart_stat;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> n, nn;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">double</span> zz, <a class="code" href="random_8c.html#ab16eca63ff4c92b224ecc442e2cc56ac">zzz</a>, zze, ztot, zz_adiab;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> nn_adiab;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="structwind.html">WindPtr</a> <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="structphoton.html">PhotPtr</a> p;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">char</span> dummy[<a class="code" href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a>];</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">double</span> freqmin, freqmax;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">long</span> nphot_to_define;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">int</span> iwind;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">int</span> ioniz_spec_helpers;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  p = <a class="code" href="python_8h.html#a8583a724925f059ca755b773ba7f1c48">photmain</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  w = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  freqmin = <a class="code" href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a>.<a class="code" href="structxbands.html#a4822266ca02ed8a4b214e5efcd79256c">f1</a>[0];</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  freqmax = <a class="code" href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a>.<a class="code" href="structxbands.html#af398da6fd226bb4257ad64ac9704098a">f2</a>[<a class="code" href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a>.<a class="code" href="structxbands.html#aad6fe819267976ae85b61e65e0b70f75">nbands</a> - 1];</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">/* the length of the big arrays to help with the MPI reductions of the spectra</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">     the variables for the estimator arrays are set up in the subroutines themselves */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  ioniz_spec_helpers = 2 * <a class="code" href="python_8h.html#a22df28a6020ba05104bc3f04858b7c22">MSPEC</a> * <a class="code" href="python_8h.html#a466538c019bc48c22053d7807c5ac843">NWAVE</a>;       <span class="comment">//we need space for log and lin spectra for MSPEC XNWAVE</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">/* THE CALCULATION OF THE IONIZATION OF THE WIND */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a1cdd3c658ff714b9504c7ada69ae1f0d">ioniz_or_extract</a> = 1;     <span class="comment">//SS July 04 - want to compute MC estimators during ionization cycles</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">//1 simply implies we are in the ionization section of the code</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//and allows routines to act accordinaly.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">/* 67 -ksl- geo.wycle will start at zero unless we are completing an old run */</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">/* BEGINNING OF CYCLE TO CALCULATE THE IONIZATION OF THE WIND */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a> == <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa741269f119248a897fc45d181117656">wcycles</a>)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s No ionization needed: wcycles(%d)==wcyeles(%d)\n&quot;</span>, <span class="stringliteral">&quot;COMMENT&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa741269f119248a897fc45d181117656">wcycles</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> = 0;             <span class="comment">/* Set the spectrum cycles executed to 0, because </span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">                                   we are going to modify the wind and hence any</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">                                   previously calculated spectra must be recreated</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">                                 */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">/* SWM - Setup for path tracking */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">reverb</a> &gt; REV_NONE)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="foo_8h.html#a782f80aab666cb86b3a296856d1f34e6">reverb_init</a> (<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="foo_8h.html#aed071173676fa884b0045139793c85d7">delay_dump_prep</a> (restart_stat);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a> &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa741269f119248a897fc45d181117656">wcycles</a>)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  {                             <span class="comment">/* This allows you to build up photons in bunches */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Starting %d of %d ionization cycle \n&quot;</span>, <span class="stringliteral">&quot;NOK&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa741269f119248a897fc45d181117656">wcycles</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!Python: Beginning cycle %d of %d for defining wind\n&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa741269f119248a897fc45d181117656">wcycles</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="log_8h.html#a762beaa59cb344fbb45e3458b86c95ce">Log_flush</a> ();               <span class="comment">/* Flush the log file (so that we know where are if there are problems */</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">/* Initialize all of the arrays, etc, that need initialization for each cycle</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="foo_8h.html#a4dfd9797e2dca42842f8082b5f8e96c4">spectrum_init</a> (freqmin, freqmax, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a15530f8a501f4fad4572e8e751707af9">nangles</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a47aa76b952a45aeef55a33feb4c2b531">angle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#afbde871884638b579979cc55b7e7871d">phase</a>,</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                   <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aaede16ca055dbc6f8297e4ed58c4082d">scat_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7ec4db1a56c0b84abac1c2d5411e05b0">top_bot_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">select_extract</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ad91f1041aaf45a72a4d2c67de476848f">rho_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aea2042fe2011ace4827d2b0e0792168d">z_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a8c012380cab384d943962d3c36bdab4f">az_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#adf45001b1836a0566cf25d9151b0906d">r_select</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="foo_8h.html#a1a5d1633d95cf4e242e41401a1dd5fc5">wind_rad_init</a> ();           <span class="comment">/*Zero the parameters pertaining to the radiation field */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#abe1f88e34b47518ef744a2345c518f5a">n_ioniz</a> = 0.0;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a2691579d747650ade154f06e3db69198">cool_tot_ioniz</a> = 0.0;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    ztot = 0.0;                 <span class="comment">/* ztot is the luminosity of the disk multipled by the number of cycles, which is used by save_disk_heating */</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aff6d34b209264b154fa7bd36266f70de">wind_radiation</a> || (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a> == 0 &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> != <a class="code" href="python_8h.html#a9bc1d8131e46b327abd573ff73547834">RUN_TYPE_PREVIOUS</a>))</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      iwind = -1;               <span class="comment">/* Do not generate photons from wind */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      iwind = 1;                <span class="comment">/* Create wind photons and force a reinitialization of wind parms */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">/* Create the photons that need to be transported through the wind</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">     * NPHOT is the number of photon bundles which will equal the luminosity; </span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">     * 0 =&gt; for ionization calculation </span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    nphot_to_define = (long) <a class="code" href="python_8h.html#a6b165c4b0ee72279f0301e93f2f30ac3">NPHOT</a>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="foo_8h.html#aa943bd857500a1f2937d8b97d84ff633">define_phot</a> (p, freqmin, freqmax, nphot_to_define, 0, iwind, 1);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">/* Zero the arrays, and other variables that need to be zeroed after the photons are generated. */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a908bbfb132cc0e0fdcd5253dd75234ec">lum_star_back</a>=0;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a143da65a7b611a98673b356de0c4509c">lum_disk_back</a>=0;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#af8b02d1bed15b59f7062901b55c4d123">NRINGS</a>; n++)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="python_8h.html#a6fc0e71b62cf70fae8b25bc22652a9a1">qdisk</a>.<a class="code" href="structxdisk.html#a34624d7a4f7db389afb745110b43a82c">heat</a>[n] = <a class="code" href="python_8h.html#a6fc0e71b62cf70fae8b25bc22652a9a1">qdisk</a>.<a class="code" href="structxdisk.html#a5812ceecd51e235f48eccda5b854f8e8">nphot</a>[n] = <a class="code" href="python_8h.html#a6fc0e71b62cf70fae8b25bc22652a9a1">qdisk</a>.<a class="code" href="structxdisk.html#a0cfeacb568d69b8a9ae73c33c0f7419c">w</a>[n] = <a class="code" href="python_8h.html#a6fc0e71b62cf70fae8b25bc22652a9a1">qdisk</a>.<a class="code" href="structxdisk.html#aba52b04695b1df389f04944f8a8d69cf">ave_freq</a>[n] = 0;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="foo_8h.html#a663f46d36d6962c7993e4c002442c23b">photon_checks</a> (p, freqmin, freqmax, <span class="stringliteral">&quot;Check before transport&quot;</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">//OLD Removed Ferland IP    wind_ip ();</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    zz = 0.0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (nn = 0; nn &lt; <a class="code" href="python_8h.html#a6b165c4b0ee72279f0301e93f2f30ac3">NPHOT</a>; nn++)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      zz += p[nn].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!python: Total photon luminosity before transphot %18.12e\n&quot;</span>, zz);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="log_8h.html#a762beaa59cb344fbb45e3458b86c95ce">Log_flush</a> ();               <span class="comment">/* NSH June 13 Added call to flush logfile */</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    ztot += zz;                 <span class="comment">/* Total luminosity in all cycles, used for calculating disk heating */</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">/* kbf_need determines how many &amp; which bf processes one needs to considere.  It was introduced</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">     * as a way to speed up the program.  It has to be recalculated evey time one changes</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">     * freqmin and freqmax</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="foo_8h.html#a7d7a0bd03f273ab50a2eabadb685b585">kbf_need</a> (freqmin, freqmax);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">/* NSH 22/10/12  This next call populates the prefactor for free free heating for each cell in the plasma array */</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">/* NSH 4/12/12  Changed so it is only called if we have read in gsqrd data */</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#ad32fe0ae6262048b1c776344ba5f1462">gaunt_n_gsqrd</a> &gt; 0)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="foo_8h.html#a768f0a037ecfb93227eda643e247b219">pop_kappa_ff_array</a> ();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">/* Transport the photons through the wind */</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="balance__templates_8h.html#a620388e1c4a8e38f192c5a0ce42af389">trans_phot</a> (w, p, 0);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">/*Determine how much energy was absorbed in the wind */</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    zze = zzz = zz_adiab = 0.0;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    nn_adiab = 0;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">for</span> (nn = 0; nn &lt; <a class="code" href="python_8h.html#a6b165c4b0ee72279f0301e93f2f30ac3">NPHOT</a>; nn++)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      zzz += p[nn].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">if</span> (p[nn].<a class="code" href="structphoton.html#adf0be64e948d68d787555681d15e13e2">istat</a> == <a class="code" href="structphoton.html#ae56bb7ca587dc91f44d8c72a6a571f45aa37b54e0d964345f5fd2d98c848392a8">P_ESCAPE</a>)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        zze += p[nn].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">if</span> (p[nn].<a class="code" href="structphoton.html#adf0be64e948d68d787555681d15e13e2">istat</a> == <a class="code" href="structphoton.html#ae56bb7ca587dc91f44d8c72a6a571f45a05b54609857135f4ec62f8c4d91fa8aa">P_ADIABATIC</a>)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        zz_adiab += p[nn].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        nn_adiab++;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!python: Total photon luminosity after transphot %18.12e (diff %18.12e). Radiated luminosity %18.12e\n&quot;</span>, zzz, zzz - zz, zze);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">rt_mode</a> == <a class="code" href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a>)</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Luminosity taken up by adiabatic kpkt destruction %18.12e number of packets %d\n&quot;</span>, zz_adiab, nn_adiab);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="foo_8h.html#a663f46d36d6962c7993e4c002442c23b">photon_checks</a> (p, freqmin, freqmax, <span class="stringliteral">&quot;Check after transport&quot;</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="foo_8h.html#a3e05df283bba500d0e7a307679b291d6">spectrum_create</a> (p, freqmin, freqmax, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a15530f8a501f4fad4572e8e751707af9">nangles</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">select_extract</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">/* At this point we should communicate all the useful infomation </span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">       that has been accummulated on differenet MPI tasks */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="foo_8h.html#a311f414c070511a6e17313830d4d3c36">communicate_estimators_para</a> ();</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="foo_8h.html#a426a0602a269a1d9738c39c8098ffaae">communicate_matom_estimators_para</a> ();       <span class="comment">// this will return 0 if nlevels_macro == 0</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">/* Calculate and store the amount of heating of the disk due to radiation impinging on the disk */</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">/* We only want one process to write to the file */</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == 0)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="disk_8c.html#a7c88d034953bdd81d94f7b4834f455cb">qdisk_save</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a5bf5e6c9f50e525d5df91800b2c1becc">disk</a>, ztot);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    MPI_Barrier (MPI_COMM_WORLD);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">/* Completed writing file describing disk heating */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!python: Number of ionizing photons %g lum of ionizing photons %g\n&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#abe1f88e34b47518ef744a2345c518f5a">n_ioniz</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a2691579d747650ade154f06e3db69198">cool_tot_ioniz</a>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">/* This step should be MPI_parallelised too */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="foo_8h.html#a861aa1ae584f627229b18f9b352ae2be">wind_update</a> (w);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Completed ionization cycle %d :  The elapsed TIME was %f\n&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>, <a class="code" href="foo_8h.html#a766e9400cf36e77e8d5dc4c5289735e2">timer</a> ());</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">/* Do an MPI reduce to get the spectra all gathered to the master thread */</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="foo_8h.html#ab7869aa7674de4defa57e532b23d3a2d">gather_spectra_para</a> (ioniz_spec_helpers, <a class="code" href="python_8h.html#a22df28a6020ba05104bc3f04858b7c22">MSPEC</a>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == 0)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">/* The variables for spectrum_sumamry are the filename, the attribute for the file write, the minimum and maximum spectra to write out, </span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> * the type of spectrum (RAW meaning internal luminosity units, the amount by which to renormalize (1 means use the existing</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> * values, loglin (0=linear, 1=log for the wavelength scale), all photons or just wind photons</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#aa5f57d0dd0cd0bb983889cff1a2de34c">wspec</a>,       0, 6, <a class="code" href="python_8h.html#a05d53c168b71c14071a82ac0c1d31ab8">SPECTYPE_RAW</a>, 1., 0, 0);  <span class="comment">/* .spec_tot */</span> </div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a79368c322d08dbd2e3fa460d364ed3a0">lwspec</a>,      0, 6, <a class="code" href="python_8h.html#a05d53c168b71c14071a82ac0c1d31ab8">SPECTYPE_RAW</a>, 1., 1, 0);  <span class="comment">/* .log_spec_tot */</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a06c80950019150200d964f62ff9417f1">wspec_wind</a>,  0, 6, <a class="code" href="python_8h.html#a05d53c168b71c14071a82ac0c1d31ab8">SPECTYPE_RAW</a>, 1., 0, 1);  <span class="comment">/* .spec_tot_wind  */</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a87e29f1b92b3d9f5be4928380029aaed">lwspec_wind</a>, 0, 6, <a class="code" href="python_8h.html#a05d53c168b71c14071a82ac0c1d31ab8">SPECTYPE_RAW</a>, 1., 1, 1);  <span class="comment">/* .log_spec_tot_wind */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="foo_8h.html#a8b4486eb9a59ffa30a219586ef94b56c">phot_gen_sum</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#aebb92f2514d1dbb4fce18c2d30871c67">phot</a>, <span class="stringliteral">&quot;w&quot;</span>);   <span class="comment">/* Save info about the way photons are created and absorbed</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">                                           by the disk */</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    MPI_Barrier (MPI_COMM_WORLD);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">/* Save everything after each cycle and prepare for the next cycle </span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">       JM1304: moved geo.wcycle++ after xsignal to record cycles correctly. First cycle is cycle 0. */</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">/* NSH1306 - moved geo.wcycle++ back, but moved the log and xsignal statements */</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Finished %d of %d ionization cycle \n&quot;</span>, <span class="stringliteral">&quot;OK&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa741269f119248a897fc45d181117656">wcycles</a>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>++;               <span class="comment">//Increment ionisation cycles</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">/* Save only the windsave file from thread 0, to prevent many processors from writing to the same</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> * file. */</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == 0)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="foo_8h.html#ab38c3e9bfb1c5f325ba00fbefbae66e1">wind_save</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a316c909bfa7dc0d7740d84f9d33d6418">windsave</a>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b">Log_silent</a> (<span class="stringliteral">&quot;Saved wind structure in %s after cycle %d\n&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a316c909bfa7dc0d7740d84f9d33d6418">windsave</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">/* In a diagnostic mode save the wind file for each cycle (from thread 0) */</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#aec6e4133d1409070e2add4ec7f619168">keep_ioncycle_windsaves</a>)</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        strcpy (dummy, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        sprintf (dummy, <span class="stringliteral">&quot;python%02d.wind_save&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="foo_8h.html#ab38c3e9bfb1c5f325ba00fbefbae66e1">wind_save</a> (dummy);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Saved wind structure in %s\n&quot;</span>, dummy);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#aaf94bf2761fb596aefe7d1e9b6fb20dc">make_tables</a>)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          strcpy(dummy,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          sprintf(dummy,<span class="stringliteral">&quot;diag_%s/%s%02d&quot;</span>,<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>,<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>,<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <a class="code" href="foo_8h.html#a435ccfb2aea5f873c9508368e974eced">do_windsave2table</a>(dummy);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    MPI_Barrier (MPI_COMM_WORLD);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="foo_8h.html#aa067770b0286b11ebb3282166d941c85">check_time</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="log_8h.html#a762beaa59cb344fbb45e3458b86c95ce">Log_flush</a> ();               <span class="comment">/*Flush the logfile */</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }                             <span class="comment">// End of Cycle loop</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/* END OF CYCLE TO CALCULATE THE IONIZATION OF THE WIND */</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot; Completed wind creation.  The elapsed TIME was %f\n&quot;</span>, <a class="code" href="foo_8h.html#a766e9400cf36e77e8d5dc4c5289735e2">timer</a> ());</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">/* SWM - Evaluate wind paths for last iteration */</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">reverb</a> == REV_WIND || <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">reverb</a> == REV_MATOM)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="foo_8h.html#a210e77beda2c9c25b9008de9107a17f8">wind_paths_evaluate</a> (w, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0">  368</a></span>&#160;<a class="code" href="run_8c.html#abc2ad803345c801984f4dc64d4d4a9e0">make_spectra</a> (restart_stat)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;     <span class="keywordtype">int</span> restart_stat;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="structwind.html">WindPtr</a> <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="structphoton.html">PhotPtr</a> p;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordtype">double</span> freqmin, freqmax;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846">renorm</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordtype">long</span> nphot_to_define;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">int</span> iwind;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">char</span> dummy[<a class="code" href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a>];</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordtype">int</span> spec_spec_helpers;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordtype">int</span> icheck;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  p = <a class="code" href="python_8h.html#a8583a724925f059ca755b773ba7f1c48">photmain</a>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  w = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  freqmax = <a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> / (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#abc10c324e776f2bf8c809096402ecb75">swavemin</a> * 1.e-8);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  freqmin = <a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> / (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a140530983e750dba228f9cd27d12000f">swavemax</a> * 1.e-8);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">/* the length of the big arrays to help with the MPI reductions of the spectra</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">     the variables for the estimator arrays are set up in the subroutines themselves */</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  spec_spec_helpers = (<a class="code" href="python_8h.html#a466538c019bc48c22053d7807c5ac843">NWAVE</a> * (<a class="code" href="python_8h.html#a22df28a6020ba05104bc3f04858b7c22">MSPEC</a> + <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a15530f8a501f4fad4572e8e751707af9">nangles</a>));  <span class="comment">//We need space for NWAVE wavelengths for nspectra, which will eventually equal nangles + MSPEC</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">/* Perform the initilizations required to handle macro-atoms during the detailed</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">     calculation of the spectrum.  </span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">     Next lines turns off macro atom estimators and other portions of the code that are</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">     unnecessary during spectrum cycles.  */</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a1cdd3c658ff714b9504c7ada69ae1f0d">ioniz_or_extract</a> = 0;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/* Next steps to speed up extraction stage */</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a067fe29b52bdeb7a6f9efa1019e418f1">keep_photoabs</a>)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="python_8h.html#a269192868359259c3fb4fad8d9f7b669">DENSITY_PHOT_MIN</a> = -1.0;    <span class="comment">// Do not calculated photoabsorption in detailed spectrum </span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">/*Switch on k-packet/macro atom emissivities  SS June 04 */</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">rt_mode</a> == <a class="code" href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a>)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a4b97dc16b54fd49d53a06ff8896596a6">matom_radiation</a> = 1;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">/* Finished initializations required for macro-atom approach */</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">/* Calculate and store which bf processess need to be considered in each cell</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">   * Note that this is not macro-specific but is just to speed the program up.</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="foo_8h.html#a7d7a0bd03f273ab50a2eabadb685b585">kbf_need</a> (freqmin, freqmax);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">/* BEGIN CYCLES TO CREATE THE DETAILED SPECTRUM */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">/* the next section initializes the spectrum array in two cases, for the</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">   * standard one where one is calulating the spectrum for the first time</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">   * and in the somewhat abnormal case where additional ionization cycles</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">   * were calculated for the wind</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> == 0)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="foo_8h.html#a4dfd9797e2dca42842f8082b5f8e96c4">spectrum_init</a> (freqmin, freqmax, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a15530f8a501f4fad4572e8e751707af9">nangles</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a47aa76b952a45aeef55a33feb4c2b531">angle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#afbde871884638b579979cc55b7e7871d">phase</a>,</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                   <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aaede16ca055dbc6f8297e4ed58c4082d">scat_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7ec4db1a56c0b84abac1c2d5411e05b0">top_bot_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">select_extract</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ad91f1041aaf45a72a4d2c67de476848f">rho_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aea2042fe2011ace4827d2b0e0792168d">z_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a8c012380cab384d943962d3c36bdab4f">az_select</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#adf45001b1836a0566cf25d9151b0906d">r_select</a>);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">/* zero the portion of plasma main that records the numbers of scatters by</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">     * each ion in a cell</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="foo_8h.html#a055c7dce44e704928680abae7b7aa684">zero_scatters</a> ();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">/* the next condition should really when one has nothing more to do */</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> &gt;= <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s No spectrum   needed: pcycles(%d)==pcycles(%d)\n&quot;</span>, <span class="stringliteral">&quot;COMMENT&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">/* Then we are restarting a run with more spectral cycles, but we </span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">       have already completed some. The memory for the spectral arrays</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">       should already have been allocated, and the spectrum was initialised</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">       on the original run, so we just need to renormalise the saved spectrum */</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">/* See issue #134 (JM) */</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span> (restart_stat == 0)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;Not restarting, but geo.pcycle = %i and trying to renormalise!\n&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="foo_8h.html#a6d37ca5473b25832956cb6988e1b4ed5">spectrum_restart_renormalise</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a15530f8a501f4fad4572e8e751707af9">nangles</a>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  {                             <span class="comment">/* This allows you to build up photons in bunches */</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Starting %d of %d spectral cycle \n&quot;</span>, <span class="stringliteral">&quot;NOK&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!Cycle %d of %d to calculate a detailed spectrum\n&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="log_8h.html#a762beaa59cb344fbb45e3458b86c95ce">Log_flush</a> ();               <span class="comment">/*NSH June 13 Added call to flush logfile */</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aff6d34b209264b154fa7bd36266f70de">wind_radiation</a>)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      iwind = -1;               <span class="comment">/* Do not generate photons from wind */</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> == 0)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      iwind = 1;                <span class="comment">/* Create wind photons and force a reinitialization of wind parms */</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      iwind = 0;                <span class="comment">/* Create wind photons but do not force reinitialization */</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">/* Create the initial photon bundles which need to be trannsported through the wind </span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">       For the detailed spectra, NPHOT*pcycles is the number of photon bundles which will equal the luminosity, </span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">       1 implies that detailed spectra, as opposed to the ionization of the wind is being calculated</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">       JM 130306 must convert NPHOT and pcycles to double precision variable nphot_to_define</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    nphot_to_define = (long) <a class="code" href="python_8h.html#a6b165c4b0ee72279f0301e93f2f30ac3">NPHOT</a> *(<span class="keywordtype">long</span>) <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="foo_8h.html#aa943bd857500a1f2937d8b97d84ff633">define_phot</a> (p, freqmin, freqmax, nphot_to_define, 1, iwind, 0);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">for</span> (icheck = 0; icheck &lt; <a class="code" href="python_8h.html#a6b165c4b0ee72279f0301e93f2f30ac3">NPHOT</a>; icheck++)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (p[icheck].<a class="code" href="structphoton.html#a98c6d400814a43aeda7d7fd1ed2d7dc6">freq</a>))</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;python after define phot:sane_check unnatural frequency for photon %d\n&quot;</span>, icheck);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">/* Tranport photons through the wind */</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="balance__templates_8h.html#a620388e1c4a8e38f192c5a0ce42af389">trans_phot</a> (w, p, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">select_extract</a>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="foo_8h.html#a3e05df283bba500d0e7a307679b291d6">spectrum_create</a> (p, freqmin, freqmax, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a15530f8a501f4fad4572e8e751707af9">nangles</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">select_extract</a>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">/* Write out the detailed spectrum each cycle so that one can see the statistics build up! */</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    renorm = ((double) (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>)) / (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> + 1.0);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">/* Do an MPI reduce to get the spectra all gathered to the master thread */</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="foo_8h.html#ab7869aa7674de4defa57e532b23d3a2d">gather_spectra_para</a> (spec_spec_helpers, <a class="code" href="python_8h.html#a7852ade47c3f7391c55a3d26006b855c">nspectra</a>);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == 0)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a1532ac6d7bebce60d86774d552e0c078">spec</a>,  0, <a class="code" href="python_8h.html#a7852ade47c3f7391c55a3d26006b855c">nspectra</a> - 1, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a384632d687a144af30856d0c8d96f01c">select_spectype</a>, renorm, 0, 0);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#abe876554c7cdd821a6365745cc23079b">lspec</a>, 0, <a class="code" href="python_8h.html#a7852ade47c3f7391c55a3d26006b855c">nspectra</a> - 1, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a384632d687a144af30856d0c8d96f01c">select_spectype</a>, renorm, 1, 0);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="comment">/* Next lines  produce spectra from photons in the wind only */</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a4e7d0693cd2c2a7359a840d8649a75c1">spec_wind</a>,  0, <a class="code" href="python_8h.html#a7852ade47c3f7391c55a3d26006b855c">nspectra</a> - 1, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a384632d687a144af30856d0c8d96f01c">select_spectype</a>, renorm, 0, 1);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <a class="code" href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ae7434018e963fbee3799a61f17025e01">lspec_wind</a>, 0, <a class="code" href="python_8h.html#a7852ade47c3f7391c55a3d26006b855c">nspectra</a> - 1, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a384632d687a144af30856d0c8d96f01c">select_spectype</a>, renorm, 1, 1);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Completed spectrum cycle %3d :  The elapsed TIME was %f\n&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a>, <a class="code" href="foo_8h.html#a766e9400cf36e77e8d5dc4c5289735e2">timer</a> ());</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">/* JM1304: moved geo.pcycle++ after xsignal to record cycles correctly. First cycle is cycle 0. */</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Finished %3d of %3d spectrum cycles \n&quot;</span>, <span class="stringliteral">&quot;OK&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a>++;               <span class="comment">// Increment the spectral cycles</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == 0)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <a class="code" href="foo_8h.html#ab38c3e9bfb1c5f325ba00fbefbae66e1">wind_save</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a316c909bfa7dc0d7740d84f9d33d6418">windsave</a>);       <span class="comment">// This is only needed to update pcycle</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="foo_8h.html#a2bf66d8d630de2eee13ab88a332cbbfc">spec_save</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a12010879e17a410582c95418e70fb8f4">specsave</a>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="foo_8h.html#aa067770b0286b11ebb3282166d941c85">check_time</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">/* END CYCLE TO CALCULATE DETAILED SPECTRUM */</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == 0)</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="foo_8h.html#a8b4486eb9a59ffa30a219586ef94b56c">phot_gen_sum</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#aebb92f2514d1dbb4fce18c2d30871c67">phot</a>, <span class="stringliteral">&quot;a&quot;</span>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">/* SWM0215: Dump the last photon path details to file */</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">reverb</a> != REV_NONE)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="foo_8h.html#a835e66c48118aa52e1903512ed676f20">delay_dump_finish</a> ();       <span class="comment">// Each thread dumps to file</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  MPI_Barrier (MPI_COMM_WORLD); <span class="comment">// Once all done</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == 0 &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">reverb</a> != REV_NONE)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="foo_8h.html#a83531c4a215b42e705cd97b00088be71">delay_dump_combine</a> (<a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a>); <span class="comment">// Combine results if necessary</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">/* Finally done */</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  sprintf (dummy, <span class="stringliteral">&quot;End of program, Thread %d only&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>);       <span class="comment">// added so we make clear these are just errors for thread ngit status    </span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="log_8h.html#a3d395705c83c0bda5aeee6a271fdfd47">error_summary</a> (dummy);        <span class="comment">// Summarize the errors that were recorded by the program</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Run py_error.py for full error report.\n&quot;</span>);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <a class="code" href="log_8h.html#a3d395705c83c0bda5aeee6a271fdfd47">error_summary</a> (<span class="stringliteral">&quot;End of program&quot;</span>);     <span class="comment">// Summarize the errors that were recorded by the program</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  MPI_Finalize ();</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <a class="code" href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9">Log_parallel</a> (<span class="stringliteral">&quot;Thread %d Finalized. All done\n&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s %s\n&quot;</span>, <span class="stringliteral">&quot;COMPLETE&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Completed entire program.  The elapsed TIME was %f\n&quot;</span>, <a class="code" href="foo_8h.html#a766e9400cf36e77e8d5dc4c5289735e2">timer</a> ());</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;}</div><div class="ttc" id="structgeometry_html_a853e273c5a2a6630c2c1c609db0f47a1"><div class="ttname"><a href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">geometry::reverb</a></div><div class="ttdeci">enum geometry::reverb_enum reverb</div></div>
<div class="ttc" id="structfilenames_html_a12010879e17a410582c95418e70fb8f4"><div class="ttname"><a href="structfilenames.html#a12010879e17a410582c95418e70fb8f4">filenames::specsave</a></div><div class="ttdeci">char specsave[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01374">python.h:1374</a></div></div>
<div class="ttc" id="python_8h_html_a8583a724925f059ca755b773ba7f1c48"><div class="ttname"><a href="python_8h.html#a8583a724925f059ca755b773ba7f1c48">photmain</a></div><div class="ttdeci">PhotPtr photmain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01088">python.h:1088</a></div></div>
<div class="ttc" id="foo_8h_html_a8e643e0881e482c11120d32f41ff00c0"><div class="ttname"><a href="foo_8h.html#a8e643e0881e482c11120d32f41ff00c0">spectrum_summary</a></div><div class="ttdeci">int spectrum_summary(char filename[], int nspecmin, int nspecmax, int select_spectype, double renorm, int loglin, int iwind)</div></div>
<div class="ttc" id="foo_8h_html_a210e77beda2c9c25b9008de9107a17f8"><div class="ttname"><a href="foo_8h.html#a210e77beda2c9c25b9008de9107a17f8">wind_paths_evaluate</a></div><div class="ttdeci">int wind_paths_evaluate(WindPtr wind, int i_rank)</div><div class="ttdoc">Evaluates wind path details for a cycle. </div><div class="ttdef"><b>Definition:</b> <a href="paths_8c_source.html#l00533">paths.c:533</a></div></div>
<div class="ttc" id="structadvanced__modes_html_aec6e4133d1409070e2add4ec7f619168"><div class="ttname"><a href="structadvanced__modes.html#aec6e4133d1409070e2add4ec7f619168">advanced_modes::keep_ioncycle_windsaves</a></div><div class="ttdeci">int keep_ioncycle_windsaves</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01346">python.h:1346</a></div></div>
<div class="ttc" id="structgeometry_html_a8c012380cab384d943962d3c36bdab4f"><div class="ttname"><a href="structgeometry.html#a8c012380cab384d943962d3c36bdab4f">geometry::az_select</a></div><div class="ttdeci">double az_select[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00347">python.h:347</a></div></div>
<div class="ttc" id="foo_8h_html_a426a0602a269a1d9738c39c8098ffaae"><div class="ttname"><a href="foo_8h.html#a426a0602a269a1d9738c39c8098ffaae">communicate_matom_estimators_para</a></div><div class="ttdeci">int communicate_matom_estimators_para(void)</div><div class="ttdef"><b>Definition:</b> <a href="para__update_8c_source.html#l00349">para_update.c:349</a></div></div>
<div class="ttc" id="foo_8h_html_a311f414c070511a6e17313830d4d3c36"><div class="ttname"><a href="foo_8h.html#a311f414c070511a6e17313830d4d3c36">communicate_estimators_para</a></div><div class="ttdeci">int communicate_estimators_para(void)</div><div class="ttdoc">communicates the MC estimators between tasks </div><div class="ttdef"><b>Definition:</b> <a href="para__update_8c_source.html#l00035">para_update.c:35</a></div></div>
<div class="ttc" id="foo_8h_html_aed071173676fa884b0045139793c85d7"><div class="ttname"><a href="foo_8h.html#aed071173676fa884b0045139793c85d7">delay_dump_prep</a></div><div class="ttdeci">int delay_dump_prep(int restart_stat)</div><div class="ttdoc">Prepares delay dump output file. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00068">reverb.c:68</a></div></div>
<div class="ttc" id="structphoton_html_a5fa87a07a9ceef33dd79aa5cdd7856cb"><div class="ttname"><a href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">photon::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01039">python.h:1039</a></div></div>
<div class="ttc" id="foo_8h_html_a2bf66d8d630de2eee13ab88a332cbbfc"><div class="ttname"><a href="foo_8h.html#a2bf66d8d630de2eee13ab88a332cbbfc">spec_save</a></div><div class="ttdeci">int spec_save(char filename[])</div></div>
<div class="ttc" id="structgeometry_html_a47aa76b952a45aeef55a33feb4c2b531"><div class="ttname"><a href="structgeometry.html#a47aa76b952a45aeef55a33feb4c2b531">geometry::angle</a></div><div class="ttdeci">double angle[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00345">python.h:345</a></div></div>
<div class="ttc" id="log_8h_html_a9a25be4f0d7d13fccc8457774d74167f"><div class="ttname"><a href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="ttdeci">int Log(char *format,...)</div><div class="ttdoc">Print/write an informational message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00325">xlog.c:325</a></div></div>
<div class="ttc" id="foo_8h_html_ab38c3e9bfb1c5f325ba00fbefbae66e1"><div class="ttname"><a href="foo_8h.html#ab38c3e9bfb1c5f325ba00fbefbae66e1">wind_save</a></div><div class="ttdeci">int wind_save(char filename[])</div></div>
<div class="ttc" id="python_8h_html_a9bc1d8131e46b327abd573ff73547834"><div class="ttname"><a href="python_8h.html#a9bc1d8131e46b327abd573ff73547834">RUN_TYPE_PREVIOUS</a></div><div class="ttdeci">#define RUN_TYPE_PREVIOUS</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00300">python.h:300</a></div></div>
<div class="ttc" id="structfilenames_html_a4e7d0693cd2c2a7359a840d8649a75c1"><div class="ttname"><a href="structfilenames.html#a4e7d0693cd2c2a7359a840d8649a75c1">filenames::spec_wind</a></div><div class="ttdeci">char spec_wind[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01385">python.h:1385</a></div></div>
<div class="ttc" id="python_8h_html_a4d5c68b263c929465c5ce25903ab1773"><div class="ttname"><a href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a></div><div class="ttdeci">#define RT_MODE_MACRO</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00456">python.h:456</a></div></div>
<div class="ttc" id="structgeometry_html_af1df42c04bb7980f13bbb390f7fbb222"><div class="ttname"><a href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">geometry::pcycles</a></div><div class="ttdeci">int pcycles</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00337">python.h:337</a></div></div>
<div class="ttc" id="structgeometry_html_aa741269f119248a897fc45d181117656"><div class="ttname"><a href="structgeometry.html#aa741269f119248a897fc45d181117656">geometry::wcycles</a></div><div class="ttdeci">int wcycles</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00337">python.h:337</a></div></div>
<div class="ttc" id="run_8c_html_abc2ad803345c801984f4dc64d4d4a9e0"><div class="ttname"><a href="run_8c.html#abc2ad803345c801984f4dc64d4d4a9e0">make_spectra</a></div><div class="ttdeci">int make_spectra(int restart_stat)</div><div class="ttdoc">generates the detailed spectra </div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00368">run.c:368</a></div></div>
<div class="ttc" id="structfilenames_html_ae7434018e963fbee3799a61f17025e01"><div class="ttname"><a href="structfilenames.html#ae7434018e963fbee3799a61f17025e01">filenames::lspec_wind</a></div><div class="ttdeci">char lspec_wind[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01386">python.h:1386</a></div></div>
<div class="ttc" id="structphoton_html_ae56bb7ca587dc91f44d8c72a6a571f45aa37b54e0d964345f5fd2d98c848392a8"><div class="ttname"><a href="structphoton.html#ae56bb7ca587dc91f44d8c72a6a571f45aa37b54e0d964345f5fd2d98c848392a8">photon::P_ESCAPE</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01045">python.h:1045</a></div></div>
<div class="ttc" id="log_8h_html_a3d395705c83c0bda5aeee6a271fdfd47"><div class="ttname"><a href="log_8h.html#a3d395705c83c0bda5aeee6a271fdfd47">error_summary</a></div><div class="ttdeci">int error_summary(char *message)</div><div class="ttdoc">Summarize the errors that have occurred. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00630">xlog.c:630</a></div></div>
<div class="ttc" id="foo_8h_html_ab1f63fcb955cb5c77dcb2d35b5da2cd4"><div class="ttname"><a href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a></div><div class="ttdeci">int xsignal(char *root, char *format,...)</div><div class="ttdoc">xsignal generates a single line message to a file names root.sig </div><div class="ttdef"><b>Definition:</b> <a href="signal_8c_source.html#l00078">signal.c:78</a></div></div>
<div class="ttc" id="structfilenames_html_abe876554c7cdd821a6365745cc23079b"><div class="ttname"><a href="structfilenames.html#abe876554c7cdd821a6365745cc23079b">filenames::lspec</a></div><div class="ttdeci">char lspec[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01384">python.h:1384</a></div></div>
<div class="ttc" id="random_8c_html_ab16eca63ff4c92b224ecc442e2cc56ac"><div class="ttname"><a href="random_8c.html#ab16eca63ff4c92b224ecc442e2cc56ac">zzz</a></div><div class="ttdeci">double zzz[]</div><div class="ttdef"><b>Definition:</b> <a href="random_8c_source.html#l00091">random.c:91</a></div></div>
<div class="ttc" id="structgeometry_html_adf45001b1836a0566cf25d9151b0906d"><div class="ttname"><a href="structgeometry.html#adf45001b1836a0566cf25d9151b0906d">geometry::r_select</a></div><div class="ttdeci">double r_select[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00347">python.h:347</a></div></div>
<div class="ttc" id="foo_8h_html_a782f80aab666cb86b3a296856d1f34e6"><div class="ttname"><a href="foo_8h.html#a782f80aab666cb86b3a296856d1f34e6">reverb_init</a></div><div class="ttdeci">int reverb_init(WindPtr wind)</div><div class="ttdoc">Initialises everything for reverb mapping. </div><div class="ttdef"><b>Definition:</b> <a href="paths_8c_source.html#l00086">paths.c:86</a></div></div>
<div class="ttc" id="foo_8h_html_ab7869aa7674de4defa57e532b23d3a2d"><div class="ttname"><a href="foo_8h.html#ab7869aa7674de4defa57e532b23d3a2d">gather_spectra_para</a></div><div class="ttdeci">int gather_spectra_para(int nspec_helper, int nspecs)</div><div class="ttdoc">sum up the synthetic spectra between threads. </div><div class="ttdef"><b>Definition:</b> <a href="para__update_8c_source.html#l00286">para_update.c:286</a></div></div>
<div class="ttc" id="structadvanced__modes_html_aaf94bf2761fb596aefe7d1e9b6fb20dc"><div class="ttname"><a href="structadvanced__modes.html#aaf94bf2761fb596aefe7d1e9b6fb20dc">advanced_modes::make_tables</a></div><div class="ttdeci">int make_tables</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01347">python.h:1347</a></div></div>
<div class="ttc" id="structgeometry_html_ab8605990f1d7f0862abaf18f1c701045"><div class="ttname"><a href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">geometry::select_extract</a></div><div class="ttdeci">int select_extract</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00349">python.h:349</a></div></div>
<div class="ttc" id="structgeometry_html_a143da65a7b611a98673b356de0c4509c"><div class="ttname"><a href="structgeometry.html#a143da65a7b611a98673b356de0c4509c">geometry::lum_disk_back</a></div><div class="ttdeci">double lum_disk_back</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00395">python.h:395</a></div></div>
<div class="ttc" id="python_8h_html_a6b165c4b0ee72279f0301e93f2f30ac3"><div class="ttname"><a href="python_8h.html#a6b165c4b0ee72279f0301e93f2f30ac3">NPHOT</a></div><div class="ttdeci">int NPHOT</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00093">python.h:93</a></div></div>
<div class="ttc" id="structfilenames_html_aebb92f2514d1dbb4fce18c2d30871c67"><div class="ttname"><a href="structfilenames.html#aebb92f2514d1dbb4fce18c2d30871c67">filenames::phot</a></div><div class="ttdeci">char phot[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01389">python.h:1389</a></div></div>
<div class="ttc" id="structphoton_html_adf0be64e948d68d787555681d15e13e2"><div class="ttname"><a href="structphoton.html#adf0be64e948d68d787555681d15e13e2">photon::istat</a></div><div class="ttdeci">enum photon::istat_enum istat</div></div>
<div class="ttc" id="structgeometry_html_aea2042fe2011ace4827d2b0e0792168d"><div class="ttname"><a href="structgeometry.html#aea2042fe2011ace4827d2b0e0792168d">geometry::z_select</a></div><div class="ttdeci">double z_select[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00347">python.h:347</a></div></div>
<div class="ttc" id="foo_8h_html_a3e05df283bba500d0e7a307679b291d6"><div class="ttname"><a href="foo_8h.html#a3e05df283bba500d0e7a307679b291d6">spectrum_create</a></div><div class="ttdeci">int spectrum_create(PhotPtr p, double f1, double f2, int nangle, int select_extract)</div><div class="ttdoc">Increments the spectrum arrays after each flight of photons is processed (during ionization cycles an...</div><div class="ttdef"><b>Definition:</b> <a href="spectra_8c_source.html#l00427">spectra.c:427</a></div></div>
<div class="ttc" id="foo_8h_html_ab14e3dce54237244859ed06cef6b5846"><div class="ttname"><a href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846">renorm</a></div><div class="ttdeci">int renorm(double a[], double scalar)</div></div>
<div class="ttc" id="python_8h_html_a7852ade47c3f7391c55a3d26006b855c"><div class="ttname"><a href="python_8h.html#a7852ade47c3f7391c55a3d26006b855c">nspectra</a></div><div class="ttdeci">int nspectra</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01132">python.h:1132</a></div></div>
<div class="ttc" id="python_8h_html_a4f0e3bc930f46505989f47a576f3ae3b"><div class="ttname"><a href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a></div><div class="ttdeci">struct xbands xband</div></div>
<div class="ttc" id="foo_8h_html_a861aa1ae584f627229b18f9b352ae2be"><div class="ttname"><a href="foo_8h.html#a861aa1ae584f627229b18f9b352ae2be">wind_update</a></div><div class="ttdeci">int wind_update(WindPtr(w))</div></div>
<div class="ttc" id="python_8h_html_a22df28a6020ba05104bc3f04858b7c22"><div class="ttname"><a href="python_8h.html#a22df28a6020ba05104bc3f04858b7c22">MSPEC</a></div><div class="ttdeci">#define MSPEC</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01131">python.h:1131</a></div></div>
<div class="ttc" id="structgeometry_html_a2691579d747650ade154f06e3db69198"><div class="ttname"><a href="structgeometry.html#a2691579d747650ade154f06e3db69198">geometry::cool_tot_ioniz</a></div><div class="ttdeci">double cool_tot_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00568">python.h:568</a></div></div>
<div class="ttc" id="python_8h_html_ac5be720a47277d650c31cee6ee815026"><div class="ttname"><a href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a></div><div class="ttdeci">struct filenames files</div></div>
<div class="ttc" id="structfilenames_html_a87e29f1b92b3d9f5be4928380029aaed"><div class="ttname"><a href="structfilenames.html#a87e29f1b92b3d9f5be4928380029aaed">filenames::lwspec_wind</a></div><div class="ttdeci">char lwspec_wind[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01382">python.h:1382</a></div></div>
<div class="ttc" id="structxdisk_html_aba52b04695b1df389f04944f8a8d69cf"><div class="ttname"><a href="structxdisk.html#aba52b04695b1df389f04944f8a8d69cf">xdisk::ave_freq</a></div><div class="ttdeci">double ave_freq[NRINGS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00612">python.h:612</a></div></div>
<div class="ttc" id="foo_8h_html_a055c7dce44e704928680abae7b7aa684"><div class="ttname"><a href="foo_8h.html#a055c7dce44e704928680abae7b7aa684">zero_scatters</a></div><div class="ttdeci">int zero_scatters(void)</div><div class="ttdoc">zero out the portion of plasmamain that records the number of scatters in each cell ...</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01151">wind2d.c:1151</a></div></div>
<div class="ttc" id="structwind_html"><div class="ttname"><a href="structwind.html">wind</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00692">python.h:692</a></div></div>
<div class="ttc" id="python_8h_html_a33f8696ebd56cd4158a5b519ec627fc5"><div class="ttname"><a href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a></div><div class="ttdeci">struct advanced_modes modes</div></div>
<div class="ttc" id="structphoton_html"><div class="ttname"><a href="structphoton.html">photon</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01034">python.h:1034</a></div></div>
<div class="ttc" id="foo_8h_html_a766e9400cf36e77e8d5dc4c5289735e2"><div class="ttname"><a href="foo_8h.html#a766e9400cf36e77e8d5dc4c5289735e2">timer</a></div><div class="ttdeci">double timer(void)</div><div class="ttdoc">Return the time in seconds since the timer was initiated. </div><div class="ttdef"><b>Definition:</b> <a href="time_8c_source.html#l00047">time.c:47</a></div></div>
<div class="ttc" id="structadvanced__modes_html_a067fe29b52bdeb7a6f9efa1019e418f1"><div class="ttname"><a href="structadvanced__modes.html#a067fe29b52bdeb7a6f9efa1019e418f1">advanced_modes::keep_photoabs</a></div><div class="ttdeci">int keep_photoabs</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01355">python.h:1355</a></div></div>
<div class="ttc" id="structfilenames_html_a316c909bfa7dc0d7740d84f9d33d6418"><div class="ttname"><a href="structfilenames.html#a316c909bfa7dc0d7740d84f9d33d6418">filenames::windsave</a></div><div class="ttdeci">char windsave[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01372">python.h:1372</a></div></div>
<div class="ttc" id="foo_8h_html_a8b4486eb9a59ffa30a219586ef94b56c"><div class="ttname"><a href="foo_8h.html#a8b4486eb9a59ffa30a219586ef94b56c">phot_gen_sum</a></div><div class="ttdeci">int phot_gen_sum(char filename[], char mode[])</div></div>
<div class="ttc" id="log_8h_html_a655c6e64b9d44a15b3331e49b6f168f9"><div class="ttname"><a href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9">Log_parallel</a></div><div class="ttdeci">int Log_parallel(char *format,...)</div><div class="ttdoc">In addition to writing to the diag file, print a message to the screen from all threads. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00728">xlog.c:728</a></div></div>
<div class="ttc" id="structxdisk_html_a34624d7a4f7db389afb745110b43a82c"><div class="ttname"><a href="structxdisk.html#a34624d7a4f7db389afb745110b43a82c">xdisk::heat</a></div><div class="ttdeci">double heat[NRINGS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00611">python.h:611</a></div></div>
<div class="ttc" id="structxbands_html_af398da6fd226bb4257ad64ac9704098a"><div class="ttname"><a href="structxbands.html#af398da6fd226bb4257ad64ac9704098a">xbands::f2</a></div><div class="ttdeci">double f2[NBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01264">python.h:1264</a></div></div>
<div class="ttc" id="python_8h_html_a3a571e0bd4220490c5c5bd86f51c83ba"><div class="ttname"><a href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a></div><div class="ttdeci">struct geometry geo</div></div>
<div class="ttc" id="foo_8h_html_a83531c4a215b42e705cd97b00088be71"><div class="ttname"><a href="foo_8h.html#a83531c4a215b42e705cd97b00088be71">delay_dump_combine</a></div><div class="ttdeci">int delay_dump_combine(int i_ranks)</div><div class="ttdoc">Prepares delay dump output file. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00159">reverb.c:159</a></div></div>
<div class="ttc" id="log_8h_html_a762beaa59cb344fbb45e3458b86c95ce"><div class="ttname"><a href="log_8h.html#a762beaa59cb344fbb45e3458b86c95ce">Log_flush</a></div><div class="ttdeci">int Log_flush(void)</div><div class="ttdoc">Flush the diagnostic file to assure that one has an up-to-date version of the log file...</div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00664">xlog.c:664</a></div></div>
<div class="ttc" id="structgeometry_html_a908bbfb132cc0e0fdcd5253dd75234ec"><div class="ttname"><a href="structgeometry.html#a908bbfb132cc0e0fdcd5253dd75234ec">geometry::lum_star_back</a></div><div class="ttdeci">double lum_star_back</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00364">python.h:364</a></div></div>
<div class="ttc" id="structxdisk_html_a0cfeacb568d69b8a9ae73c33c0f7419c"><div class="ttname"><a href="structxdisk.html#a0cfeacb568d69b8a9ae73c33c0f7419c">xdisk::w</a></div><div class="ttdeci">double w[NRINGS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00613">python.h:613</a></div></div>
<div class="ttc" id="structgeometry_html_a5c5643e70e2f927fac6f1ff6e9ecb489"><div class="ttname"><a href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">geometry::pcycle</a></div><div class="ttdeci">int pcycle</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00336">python.h:336</a></div></div>
<div class="ttc" id="run_8c_html_a28fc174aa63a5eeef6de99ef392e1616"><div class="ttname"><a href="run_8c.html#a28fc174aa63a5eeef6de99ef392e1616">calculate_ionization</a></div><div class="ttdeci">int calculate_ionization(int restart_stat)</div><div class="ttdoc">run the ionization cycles for a python model </div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00052">run.c:52</a></div></div>
<div class="ttc" id="structphoton_html_a98c6d400814a43aeda7d7fd1ed2d7dc6"><div class="ttname"><a href="structphoton.html#a98c6d400814a43aeda7d7fd1ed2d7dc6">photon::freq</a></div><div class="ttdeci">double freq</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01038">python.h:1038</a></div></div>
<div class="ttc" id="foo_8h_html_a435ccfb2aea5f873c9508368e974eced"><div class="ttname"><a href="foo_8h.html#a435ccfb2aea5f873c9508368e974eced">do_windsave2table</a></div><div class="ttdeci">int do_windsave2table(char *root)</div><div class="ttdoc">The main routine associated with windsave2table, this routine calls various other routines which writ...</div><div class="ttdef"><b>Definition:</b> <a href="windsave2table__sub_8c_source.html#l00051">windsave2table_sub.c:51</a></div></div>
<div class="ttc" id="atomic_8h_html_ad32fe0ae6262048b1c776344ba5f1462"><div class="ttname"><a href="atomic_8h.html#ad32fe0ae6262048b1c776344ba5f1462">gaunt_n_gsqrd</a></div><div class="ttdeci">int gaunt_n_gsqrd</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00544">atomic.h:544</a></div></div>
<div class="ttc" id="structgeometry_html_ad91f1041aaf45a72a4d2c67de476848f"><div class="ttname"><a href="structgeometry.html#ad91f1041aaf45a72a4d2c67de476848f">geometry::rho_select</a></div><div class="ttdeci">double rho_select[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00347">python.h:347</a></div></div>
<div class="ttc" id="structgeometry_html_a384632d687a144af30856d0c8d96f01c"><div class="ttname"><a href="structgeometry.html#a384632d687a144af30856d0c8d96f01c">geometry::select_spectype</a></div><div class="ttdeci">int select_spectype</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00349">python.h:349</a></div></div>
<div class="ttc" id="structfilenames_html_a8c053bab321640d4f0f5b75110980c89"><div class="ttname"><a href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">filenames::root</a></div><div class="ttdeci">char root[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01371">python.h:1371</a></div></div>
<div class="ttc" id="foo_8h_html_a6d37ca5473b25832956cb6988e1b4ed5"><div class="ttname"><a href="foo_8h.html#a6d37ca5473b25832956cb6988e1b4ed5">spectrum_restart_renormalise</a></div><div class="ttdeci">int spectrum_restart_renormalise(int nangle)</div><div class="ttdoc">renormalizes the detailed spectra in case of a restart </div><div class="ttdef"><b>Definition:</b> <a href="spectra_8c_source.html#l01019">spectra.c:1019</a></div></div>
<div class="ttc" id="structphoton_html_ae56bb7ca587dc91f44d8c72a6a571f45a05b54609857135f4ec62f8c4d91fa8aa"><div class="ttname"><a href="structphoton.html#ae56bb7ca587dc91f44d8c72a6a571f45a05b54609857135f4ec62f8c4d91fa8aa">photon::P_ADIABATIC</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01052">python.h:1052</a></div></div>
<div class="ttc" id="structxdisk_html_a5812ceecd51e235f48eccda5b854f8e8"><div class="ttname"><a href="structxdisk.html#a5812ceecd51e235f48eccda5b854f8e8">xdisk::nphot</a></div><div class="ttdeci">int nphot[NRINGS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00615">python.h:615</a></div></div>
<div class="ttc" id="python_8h_html_a466538c019bc48c22053d7807c5ac843"><div class="ttname"><a href="python_8h.html#a466538c019bc48c22053d7807c5ac843">NWAVE</a></div><div class="ttdeci">#define NWAVE</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00096">python.h:96</a></div></div>
<div class="ttc" id="foo_8h_html_aa943bd857500a1f2937d8b97d84ff633"><div class="ttname"><a href="foo_8h.html#aa943bd857500a1f2937d8b97d84ff633">define_phot</a></div><div class="ttdeci">int define_phot(PhotPtr p, double f1, double f2, long nphot_tot, int ioniz_or_final, int iwind, int freq_sampling)</div><div class="ttdoc">the controlling routine for creating the underlying photon distribution. </div><div class="ttdef"><b>Definition:</b> <a href="photon__gen_8c_source.html#l00075">photon_gen.c:75</a></div></div>
<div class="ttc" id="python_8h_html_a58b428706c49233f4580ed387c4820c6"><div class="ttname"><a href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a></div><div class="ttdeci">int np_mpi_global</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00007">python.h:7</a></div></div>
<div class="ttc" id="python_8h_html"><div class="ttname"><a href="python_8h.html">python.h</a></div></div>
<div class="ttc" id="get__atomicdata_8c_html_a10e8c7b8458375c3dbfbb4010a2aba8c"><div class="ttname"><a href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a></div><div class="ttdeci">#define LINELENGTH</div><div class="ttdef"><b>Definition:</b> <a href="get__atomicdata_8c_source.html#l00159">get_atomicdata.c:159</a></div></div>
<div class="ttc" id="python_8h_html_a48632b55b333d2627f6a1ddd87b3d7ea"><div class="ttname"><a href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a></div><div class="ttdeci">int rank_global</div><div class="ttdoc">Global variable which holds the number of MPI processes. </div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00009">python.h:9</a></div></div>
<div class="ttc" id="structgeometry_html_aff6d34b209264b154fa7bd36266f70de"><div class="ttname"><a href="structgeometry.html#aff6d34b209264b154fa7bd36266f70de">geometry::wind_radiation</a></div><div class="ttdeci">int wind_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00401">python.h:401</a></div></div>
<div class="ttc" id="structfilenames_html_aa5f57d0dd0cd0bb983889cff1a2de34c"><div class="ttname"><a href="structfilenames.html#aa5f57d0dd0cd0bb983889cff1a2de34c">filenames::wspec</a></div><div class="ttdeci">char wspec[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01379">python.h:1379</a></div></div>
<div class="ttc" id="structgeometry_html_ab344978ef2535435535587ec5d5a3d6e"><div class="ttname"><a href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">geometry::wcycle</a></div><div class="ttdeci">int wcycle</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00336">python.h:336</a></div></div>
<div class="ttc" id="structfilenames_html_a79368c322d08dbd2e3fa460d364ed3a0"><div class="ttname"><a href="structfilenames.html#a79368c322d08dbd2e3fa460d364ed3a0">filenames::lwspec</a></div><div class="ttdeci">char lwspec[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01380">python.h:1380</a></div></div>
<div class="ttc" id="structgeometry_html_a15530f8a501f4fad4572e8e751707af9"><div class="ttname"><a href="structgeometry.html#a15530f8a501f4fad4572e8e751707af9">geometry::nangles</a></div><div class="ttdeci">int nangles</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00344">python.h:344</a></div></div>
<div class="ttc" id="log_8h_html_a4f4caa375f1c3a9def422000f305cce5"><div class="ttname"><a href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="ttdeci">int Error(char *format,...)</div><div class="ttdoc">Print/write out an error message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00402">xlog.c:402</a></div></div>
<div class="ttc" id="atomic_8h_html"><div class="ttname"><a href="atomic_8h.html">atomic.h</a></div></div>
<div class="ttc" id="structgeometry_html_a1cdd3c658ff714b9504c7ada69ae1f0d"><div class="ttname"><a href="structgeometry.html#a1cdd3c658ff714b9504c7ada69ae1f0d">geometry::ioniz_or_extract</a></div><div class="ttdeci">int ioniz_or_extract</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00419">python.h:419</a></div></div>
<div class="ttc" id="structgeometry_html_af65bb6689e1945e975f6787825d2c5b8"><div class="ttname"><a href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">geometry::run_type</a></div><div class="ttdeci">int run_type</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00396">python.h:396</a></div></div>
<div class="ttc" id="python_8h_html_a269192868359259c3fb4fad8d9f7b669"><div class="ttname"><a href="python_8h.html#a269192868359259c3fb4fad8d9f7b669">DENSITY_PHOT_MIN</a></div><div class="ttdeci">double DENSITY_PHOT_MIN</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00061">python.h:61</a></div></div>
<div class="ttc" id="foo_8h_html_a1a5d1633d95cf4e242e41401a1dd5fc5"><div class="ttname"><a href="foo_8h.html#a1a5d1633d95cf4e242e41401a1dd5fc5">wind_rad_init</a></div><div class="ttdeci">int wind_rad_init(void)</div><div class="ttdoc">zeros those portions of the wind which contain the radiation properties of the wind, i.e those portions which should be set to zeroed when the structure of the wind has been changed or when you simply want to start off a calculation in a known state </div><div class="ttdef"><b>Definition:</b> <a href="wind__updates2d_8c_source.html#l01013">wind_updates2d.c:1013</a></div></div>
<div class="ttc" id="foo_8h_html_aa067770b0286b11ebb3282166d941c85"><div class="ttname"><a href="foo_8h.html#aa067770b0286b11ebb3282166d941c85">check_time</a></div><div class="ttdeci">int check_time(char *root)</div><div class="ttdoc">check whether the elapsed time is greater than the max_time and terminate the program if that is the ...</div><div class="ttdef"><b>Definition:</b> <a href="signal_8c_source.html#l00261">signal.c:261</a></div></div>
<div class="ttc" id="foo_8h_html_a768f0a037ecfb93227eda643e247b219"><div class="ttname"><a href="foo_8h.html#a768f0a037ecfb93227eda643e247b219">pop_kappa_ff_array</a></div><div class="ttdeci">double pop_kappa_ff_array(void)</div><div class="ttdoc">populates the multiplicative constant, including a gaunt factor, to be used in the calculating free f...</div><div class="ttdef"><b>Definition:</b> <a href="radiation_8c_source.html#l00984">radiation.c:984</a></div></div>
<div class="ttc" id="atomic_8h_html_ac4cf4b2ab929bd23951a8676eeac086b"><div class="ttname"><a href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div><div class="ttdeci">#define C</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00011">atomic.h:11</a></div></div>
<div class="ttc" id="structgeometry_html_abe1f88e34b47518ef744a2345c518f5a"><div class="ttname"><a href="structgeometry.html#abe1f88e34b47518ef744a2345c518f5a">geometry::n_ioniz</a></div><div class="ttdeci">double n_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00568">python.h:568</a></div></div>
<div class="ttc" id="log_8h_html_aaadbb20af7b628f26e81e4e49b1a379f"><div class="ttname"><a href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a></div><div class="ttdeci">int sane_check(double x)</div><div class="ttdoc">Check that a variable is valid double precision number. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00528">xlog.c:528</a></div></div>
<div class="ttc" id="disk_8c_html_a7c88d034953bdd81d94f7b4834f455cb"><div class="ttname"><a href="disk_8c.html#a7c88d034953bdd81d94f7b4834f455cb">qdisk_save</a></div><div class="ttdeci">int qdisk_save(char *diskfile, double ztot)</div><div class="ttdoc">Save the information in the qdisk structure to a file. </div><div class="ttdef"><b>Definition:</b> <a href="disk_8c_source.html#l00724">disk.c:724</a></div></div>
<div class="ttc" id="python_8h_html_a940291848296c285c722ed248863afc1"><div class="ttname"><a href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a></div><div class="ttdeci">WindPtr wmain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00724">python.h:724</a></div></div>
<div class="ttc" id="structgeometry_html_a140530983e750dba228f9cd27d12000f"><div class="ttname"><a href="structgeometry.html#a140530983e750dba228f9cd27d12000f">geometry::swavemax</a></div><div class="ttdeci">double swavemax</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00348">python.h:348</a></div></div>
<div class="ttc" id="log_8h_html_aed844368416d95992f0bbeb9f7fec55b"><div class="ttname"><a href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b">Log_silent</a></div><div class="ttdeci">int Log_silent(char *format,...)</div><div class="ttdoc">Write a message to the diagnostic file. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00364">xlog.c:364</a></div></div>
<div class="ttc" id="structgeometry_html_aaede16ca055dbc6f8297e4ed58c4082d"><div class="ttname"><a href="structgeometry.html#aaede16ca055dbc6f8297e4ed58c4082d">geometry::scat_select</a></div><div class="ttdeci">int scat_select[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00346">python.h:346</a></div></div>
<div class="ttc" id="structxbands_html_a4822266ca02ed8a4b214e5efcd79256c"><div class="ttname"><a href="structxbands.html#a4822266ca02ed8a4b214e5efcd79256c">xbands::f1</a></div><div class="ttdeci">double f1[NBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01264">python.h:1264</a></div></div>
<div class="ttc" id="foo_8h_html_a7d7a0bd03f273ab50a2eabadb685b585"><div class="ttname"><a href="foo_8h.html#a7d7a0bd03f273ab50a2eabadb685b585">kbf_need</a></div><div class="ttdeci">int kbf_need(double fmin, double fmax)</div><div class="ttdoc">computes and stores the set of bound-free processes which make significiant contributions to the opac...</div><div class="ttdef"><b>Definition:</b> <a href="resonate_8c_source.html#l00682">resonate.c:682</a></div></div>
<div class="ttc" id="python_8h_html_af8b02d1bed15b59f7062901b55c4d123"><div class="ttname"><a href="python_8h.html#af8b02d1bed15b59f7062901b55c4d123">NRINGS</a></div><div class="ttdeci">#define NRINGS</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00600">python.h:600</a></div></div>
<div class="ttc" id="structgeometry_html_a27207d7b4e1bef1c57a659354ff5cee9"><div class="ttname"><a href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">geometry::rt_mode</a></div><div class="ttdeci">int rt_mode</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00458">python.h:458</a></div></div>
<div class="ttc" id="structxbands_html_aad6fe819267976ae85b61e65e0b70f75"><div class="ttname"><a href="structxbands.html#aad6fe819267976ae85b61e65e0b70f75">xbands::nbands</a></div><div class="ttdeci">int nbands</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01273">python.h:1273</a></div></div>
<div class="ttc" id="structfilenames_html_a06c80950019150200d964f62ff9417f1"><div class="ttname"><a href="structfilenames.html#a06c80950019150200d964f62ff9417f1">filenames::wspec_wind</a></div><div class="ttdeci">char wspec_wind[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01381">python.h:1381</a></div></div>
<div class="ttc" id="balance__templates_8h_html_a620388e1c4a8e38f192c5a0ce42af389"><div class="ttname"><a href="balance__templates_8h.html#a620388e1c4a8e38f192c5a0ce42af389">trans_phot</a></div><div class="ttdeci">int trans_phot(WindPtr w, PhotPtr p, int iextract)</div><div class="ttdoc">int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons </div><div class="ttdef"><b>Definition:</b> <a href="trans__phot_8c_source.html#l00085">trans_phot.c:85</a></div></div>
<div class="ttc" id="structfilenames_html_a1532ac6d7bebce60d86774d552e0c078"><div class="ttname"><a href="structfilenames.html#a1532ac6d7bebce60d86774d552e0c078">filenames::spec</a></div><div class="ttdeci">char spec[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01383">python.h:1383</a></div></div>
<div class="ttc" id="structgeometry_html_afbde871884638b579979cc55b7e7871d"><div class="ttname"><a href="structgeometry.html#afbde871884638b579979cc55b7e7871d">geometry::phase</a></div><div class="ttdeci">double phase[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00345">python.h:345</a></div></div>
<div class="ttc" id="python_8h_html_a05d53c168b71c14071a82ac0c1d31ab8"><div class="ttname"><a href="python_8h.html#a05d53c168b71c14071a82ac0c1d31ab8">SPECTYPE_RAW</a></div><div class="ttdeci">#define SPECTYPE_RAW</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01126">python.h:1126</a></div></div>
<div class="ttc" id="structgeometry_html_a7ec4db1a56c0b84abac1c2d5411e05b0"><div class="ttname"><a href="structgeometry.html#a7ec4db1a56c0b84abac1c2d5411e05b0">geometry::top_bot_select</a></div><div class="ttdeci">int top_bot_select[NSPEC]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00346">python.h:346</a></div></div>
<div class="ttc" id="foo_8h_html_a835e66c48118aa52e1903512ed676f20"><div class="ttname"><a href="foo_8h.html#a835e66c48118aa52e1903512ed676f20">delay_dump_finish</a></div><div class="ttdeci">int delay_dump_finish(void)</div><div class="ttdoc">Finishes dumping tracked photons to file. </div><div class="ttdef"><b>Definition:</b> <a href="reverb_8c_source.html#l00133">reverb.c:133</a></div></div>
<div class="ttc" id="python_8h_html_a6fc0e71b62cf70fae8b25bc22652a9a1"><div class="ttname"><a href="python_8h.html#a6fc0e71b62cf70fae8b25bc22652a9a1">qdisk</a></div><div class="ttdeci">struct xdisk qdisk</div></div>
<div class="ttc" id="structgeometry_html_a4b97dc16b54fd49d53a06ff8896596a6"><div class="ttname"><a href="structgeometry.html#a4b97dc16b54fd49d53a06ff8896596a6">geometry::matom_radiation</a></div><div class="ttdeci">int matom_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00403">python.h:403</a></div></div>
<div class="ttc" id="structfilenames_html_a5bf5e6c9f50e525d5df91800b2c1becc"><div class="ttname"><a href="structfilenames.html#a5bf5e6c9f50e525d5df91800b2c1becc">filenames::disk</a></div><div class="ttdeci">char disk[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01387">python.h:1387</a></div></div>
<div class="ttc" id="structgeometry_html_abc10c324e776f2bf8c809096402ecb75"><div class="ttname"><a href="structgeometry.html#abc10c324e776f2bf8c809096402ecb75">geometry::swavemin</a></div><div class="ttdeci">double swavemin</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00348">python.h:348</a></div></div>
<div class="ttc" id="foo_8h_html_a663f46d36d6962c7993e4c002442c23b"><div class="ttname"><a href="foo_8h.html#a663f46d36d6962c7993e4c002442c23b">photon_checks</a></div><div class="ttdeci">int photon_checks(PhotPtr p, double freqmin, double freqmax, char *comment)</div><div class="ttdoc">Perform some simple checks on the photon distribution just produced. </div><div class="ttdef"><b>Definition:</b> <a href="photon__gen_8c_source.html#l01286">photon_gen.c:1286</a></div></div>
<div class="ttc" id="foo_8h_html_a4dfd9797e2dca42842f8082b5f8e96c4"><div class="ttname"><a href="foo_8h.html#a4dfd9797e2dca42842f8082b5f8e96c4">spectrum_init</a></div><div class="ttdeci">int spectrum_init(double f1, double f2, int nangle, double angle[], double phase[], int scat_select[], int top_bot_select[], int select_extract, double rho_select[], double z_select[], double az_select[], double r_select[])</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="run_8c.html">run.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
