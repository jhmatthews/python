<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/matrix_ion.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('matrix__ion_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">matrix_ion.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains routines which compute the ionization state using a matrix inversion technique.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
<code>#include &lt;gsl/gsl_block.h&gt;</code><br />
<code>#include &lt;gsl/gsl_vector.h&gt;</code><br />
<code>#include &lt;gsl/gsl_matrix.h&gt;</code><br />
<code>#include &quot;<a class="el" href="my__linalg_8h_source.html">my_linalg.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for matrix_ion.c:</div>
<div class="dyncontent">
<div class="center"><img src="matrix__ion_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2matrix__ion_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2matrix__ion_8c" id="_2_users_2mhewitt_2python_2source_2matrix__ion_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node15" href="my__linalg_8h.html" title="my_linalg.h" alt="" coords="697,95,769,121"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="228,169,272,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="296,169,359,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="383,169,456,196"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="480,169,543,196"/>
</map>
</div>
</div>
<p><a href="matrix__ion_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1e569c92136f73f8643f20d8fb43f544"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__ion_8c.html#a1e569c92136f73f8643f20d8fb43f544">matrix_ion_populations</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode)</td></tr>
<tr class="memdesc:a1e569c92136f73f8643f20d8fb43f544"><td class="mdescLeft">&#160;</td><td class="mdescRight">A matrix solver for the ionization state in a cell.  <a href="#a1e569c92136f73f8643f20d8fb43f544">More...</a><br /></td></tr>
<tr class="separator:a1e569c92136f73f8643f20d8fb43f544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa690e0a23766160c4cb48aa99783ead"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__ion_8c.html#aaa690e0a23766160c4cb48aa99783ead">populate_ion_rate_matrix</a> (rate_matrix, pi_rates, inner_rates, rr_rates, b_temp, double xne)</td></tr>
<tr class="memdesc:aaa690e0a23766160c4cb48aa99783ead"><td class="mdescLeft">&#160;</td><td class="mdescRight">populates a rate_matrix  <a href="#aaa690e0a23766160c4cb48aa99783ead">More...</a><br /></td></tr>
<tr class="separator:aaa690e0a23766160c4cb48aa99783ead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b054a7922fd8ef0a3c003f01b0aa2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__ion_8c.html#a37b054a7922fd8ef0a3c003f01b0aa2d">solve_matrix</a> (double *a_data, double *b_data, int nrows, double *<a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, int nplasma)</td></tr>
<tr class="memdesc:a37b054a7922fd8ef0a3c003f01b0aa2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">solves the matrix equation A x = b for the vector x.  <a href="#a37b054a7922fd8ef0a3c003f01b0aa2d">More...</a><br /></td></tr>
<tr class="separator:a37b054a7922fd8ef0a3c003f01b0aa2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains routines which compute the ionization state using a matrix inversion technique. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018</dd></dl>
<p>??? </p>

<p class="definition">Definition in file <a class="el" href="matrix__ion_8c_source.html">matrix_ion.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1e569c92136f73f8643f20d8fb43f544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e569c92136f73f8643f20d8fb43f544">&#9670;&nbsp;</a></span>matrix_ion_populations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int matrix_ion_populations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A matrix solver for the ionization state in a cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] PlasmaPtr xplasma The plasma cell we are working on </td></tr>
    <tr><td class="paramname">[in</td><td>out] int mode What type of model to use for J_nu - 1=fitted model 2=blackbody </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful</dd></dl>
<p>modes: 1 - use a power law and or exponential model for J 2 - use a dilute BB model for J defined by t_r and w The general structure of matrix_ion_populations is as follows: First we compute all of the rates that we have data for linking all ionization stages We make an initial guess at the electron density We attempt to solve the ionization rates matrix, and produce a new guess at the electron density We then calculate new rates, re-solve and proceed until the electron density converges. We solve the matrix equation A x = b for the vector x, where A is a square rate matrix linking each state with each other state (often containing zeros if the ions arent linked) b is a vector containing the total density of each element arranged in a certain way (see later) and x is a vector containing the relative ion populations. We invert A to get x=bA^-1</p>
<h3>Notes</h3>
<p>Uses a relative abundance scheme - reduces large number issues </p>

<p class="definition">Definition at line <a class="el" href="matrix__ion_8c_source.html#l00057">57</a> of file <a class="el" href="matrix__ion_8c_source.html">matrix_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_cgraph.png" border="0" usemap="#matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_cgraph" alt=""/></div>
<map name="matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_cgraph" id="matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_cgraph">
<area shape="rect" id="node2" href="dielectronic_8c.html#aa2bd15d3acbd24b94a78d7a55fbd4bb6" title="returns the volumetric dielectronic rate coefficients for a given temperature. " alt="" coords="372,68,479,95"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="552,246,596,272"/>
<area shape="rect" id="node10" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="373,575,478,602"/>
<area shape="rect" id="node13" href="direct__ion_8c.html#a2cd4b2739e1ba69e646c63e7e327583c" title="computes the rate coefficient for three body recombination from Dere data. " alt="" coords="179,474,316,500"/>
<area shape="rect" id="node15" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="536,464,612,491"/>
<area shape="rect" id="node16" href="foo_8h.html#ab1050097e6dcebb3469479d4fd5ff6c0" title="get the total rediative recombination rate " alt="" coords="214,626,281,652"/>
<area shape="rect" id="node17" href="foo_8h.html#ae8bab77755879541eaede60436cfbda2" title="int calculates the photoionization rate coefficient for an ion in a given cell " alt="" coords="209,676,285,703"/>
<area shape="rect" id="node18" href="balance__templates_8h.html#a37c9b91e3450874eb15cef76079f344d" title="calculates the partition functions for a single cell in the grid (and then calls a routine that calcu..." alt="" coords="196,727,299,754"/>
<area shape="rect" id="node19" href="foo_8h.html#a573805cfa8fb135c23fc2f9e97dcf687" title="get_ne" alt="" coords="221,778,273,804"/>
<area shape="rect" id="node20" href="matrix__ion_8c.html#aaa690e0a23766160c4cb48aa99783ead" title="populates a rate_matrix " alt="" coords="180,828,315,855"/>
<area shape="rect" id="node21" href="matrix__ion_8c.html#a37b054a7922fd8ef0a3c003f01b0aa2d" title="solves the matrix equation A x = b for the vector x. " alt="" coords="208,296,287,323"/>
<area shape="rect" id="node26" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="209,879,286,906"/>
<area shape="rect" id="node27" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="679,62,717,88"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1031,347,1088,374"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="661,360,735,387"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="783,347,872,374"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="805,398,849,424"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="932,347,971,374"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="920,296,983,323"/>
<area shape="rect" id="node11" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="535,515,613,542"/>
<area shape="rect" id="node12" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="664,504,732,531"/>
<area shape="rect" id="node14" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="379,474,471,500"/>
<area shape="rect" id="node22" href="my__linalg_8h.html#aebe6bfb27686aa253011d63d40bc96af" title="gsl_linalg_LU_decomp" alt="" coords="364,271,487,298"/>
<area shape="rect" id="node23" href="my__linalg_8h.html#a96ea8b8b7eb571269acbdc064a72ee94" title="gsl_linalg_LU_lndet" alt="" coords="371,322,480,348"/>
<area shape="rect" id="node24" href="my__linalg_8h.html#a46c239e2ef7d873ef94eaf9d174dfbaf" title="gsl_linalg_LU_solve" alt="" coords="370,372,481,399"/>
<area shape="rect" id="node25" href="my__linalg_8h.html#ae75ae29cba0f1bf3c9293e4a993d4cd9" title="gsl_blas_dgemv" alt="" coords="378,220,473,247"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_icgraph.png" border="0" usemap="#matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_icgraph" alt=""/></div>
<map name="matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_icgraph" id="matrix__ion_8c_a1e569c92136f73f8643f20d8fb43f544_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="179,5,304,32"/>
</map>
</div>

</div>
</div>
<a id="aaa690e0a23766160c4cb48aa99783ead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa690e0a23766160c4cb48aa99783ead">&#9670;&nbsp;</a></span>populate_ion_rate_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int populate_ion_rate_matrix </td>
          <td>(</td>
          <td class="paramtype">rate_matrix&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pi_rates&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">inner_rates&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rr_rates&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">b_temp&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xne</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>populates a rate_matrix </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>rate_matrix[nions][nions] - the rate matrix that will be filled by this array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>pi_rates[nions] - vector of photionization rates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>inner_rates[n_inner_tot] - vector of inner shell photoionization rates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>rr_rates[nions] - vector of radiative recobination rates </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>b_temp[nions] - the vector of total elemental densities that we also fill here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>xne - current electron density </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- zero if successful</dd></dl>
<p>populate_ion_rate_matrix populates a rate_matrix of shape nions x nions with the pi_rates and rr_rates supplied at the density xne in question. It also populates the b matrix - that is the total elemental abundance - we use relative abundances so this is just a set of 1s and 0s.</p>
<h3>Notes</h3>
<p>This routine includes the process of replacing the first row of the matrix with 1s in order to make the problem soluble. </p>

<p class="definition">Definition at line <a class="el" href="matrix__ion_8c_source.html#l00420">420</a> of file <a class="el" href="matrix__ion_8c_source.html">matrix_ion.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="matrix__ion_8c_aaa690e0a23766160c4cb48aa99783ead_icgraph.png" border="0" usemap="#matrix__ion_8c_aaa690e0a23766160c4cb48aa99783ead_icgraph" alt=""/></div>
<map name="matrix__ion_8c_aaa690e0a23766160c4cb48aa99783ead_icgraph" id="matrix__ion_8c_aaa690e0a23766160c4cb48aa99783ead_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="188,5,313,32"/>
</map>
</div>

</div>
</div>
<a id="a37b054a7922fd8ef0a3c003f01b0aa2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37b054a7922fd8ef0a3c003f01b0aa2d">&#9670;&nbsp;</a></span>solve_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int solve_matrix </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>a_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>b_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nplasma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>solves the matrix equation A x = b for the vector x. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>a_data - the square rate matric </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>b_data - the vector of total elemental abundances </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nrows - the number of rows (and columns) in the a matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>x - the ionic abundances calculated here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nplasma - the index of the plasma cell we are working on - only used for reporting errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int ierr - a number defining any error state</dd></dl>
<p>Performs a matrix inversion to solve Ax=b for x. Most of the algorithms used for this are from the gsl library</p>
<h3>Notes</h3>
<p>??? NOTES ??? </p>

<p class="definition">Definition at line <a class="el" href="matrix__ion_8c_source.html#l00632">632</a> of file <a class="el" href="matrix__ion_8c_source.html">matrix_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_cgraph.png" border="0" usemap="#matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_cgraph" alt=""/></div>
<map name="matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_cgraph" id="matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_cgraph">
<area shape="rect" id="node2" href="my__linalg_8h.html#aebe6bfb27686aa253011d63d40bc96af" title="gsl_linalg_LU_decomp" alt="" coords="132,5,255,32"/>
<area shape="rect" id="node3" href="my__linalg_8h.html#a96ea8b8b7eb571269acbdc064a72ee94" title="gsl_linalg_LU_lndet" alt="" coords="139,56,248,83"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="171,107,215,133"/>
<area shape="rect" id="node11" href="my__linalg_8h.html#a46c239e2ef7d873ef94eaf9d174dfbaf" title="gsl_linalg_LU_solve" alt="" coords="138,157,249,184"/>
<area shape="rect" id="node12" href="my__linalg_8h.html#ae75ae29cba0f1bf3c9293e4a993d4cd9" title="gsl_blas_dgemv" alt="" coords="146,208,241,235"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="672,120,729,147"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="303,145,376,172"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="424,132,513,159"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="447,183,491,209"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="573,120,612,147"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="561,171,624,197"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_icgraph.png" border="0" usemap="#matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_icgraph" alt=""/></div>
<map name="matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_icgraph" id="matrix__ion_8c_a37b054a7922fd8ef0a3c003f01b0aa2d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="156,5,233,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="132,56,257,83"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="matrix__ion_8c.html">matrix_ion.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
