<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/bands.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('bands_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bands.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Setup the frequency bands used for stratified sampling and for recording spectra in wind cells.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for bands.c:</div>
<div class="dyncontent">
<div class="center"><img src="bands_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2bands_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2bands_8c" id="_2_users_2mhewitt_2python_2source_2bands_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="bands_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3513a64162c15d3d3d101c3d5ea2367f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bands_8c.html#a3513a64162c15d3d3d101c3d5ea2367f">bands_init</a> (int imode, struct <a class="el" href="structxbands.html">xbands</a> *band)</td></tr>
<tr class="memdesc:a3513a64162c15d3d3d101c3d5ea2367f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the routine that initializes the bands.  <a href="#a3513a64162c15d3d3d101c3d5ea2367f">More...</a><br /></td></tr>
<tr class="separator:a3513a64162c15d3d3d101c3d5ea2367f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a900ff3bb7a80569abf42be1e2b00fd36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bands_8c.html#a900ff3bb7a80569abf42be1e2b00fd36">freqs_init</a> (double freqmin, double freqmax)</td></tr>
<tr class="memdesc:a900ff3bb7a80569abf42be1e2b00fd36"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the routine where the frequency boundaries for course spectra are established.  <a href="#a900ff3bb7a80569abf42be1e2b00fd36">More...</a><br /></td></tr>
<tr class="separator:a900ff3bb7a80569abf42be1e2b00fd36"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Setup the frequency bands used for stratified sampling and for recording spectra in wind cells. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March , 2018</dd></dl>
<p>The subroutines here deal with two related issues, how to choose how many photons or photon bundles to create in various wavelength ranges, and how to record the spectrum that pass through individual cells.</p>
<p>Photons, or photon bundles, in Python are created with certain frequency and carry a certain amount of energy. Without any kind of stratified sampling all of the photons would be createed with the same energy content and frequencies which sample the spectrum in equal energy entervals. The sum of energies of all of the photons bundles originating in, for example, a stellar photosphere would eqaul that of the luminostiy of the star.</p>
<p>Normally, however, Python uses a form of stratified sampling to assure we have photons in various energy bands. This is important, especially for calculating ionization rates since one needs enough photons above ionization edges to estimate the rate accurately. In banding, one choses a number of photons in a given frequency range and changes the energy of the photon bundle so that the proper normalization is obtained.</p>
<p>Once one has decided how many photons in what wave bands to generate one also needs to capture a crude spectrum in each cell of the grid at least for many of the ionization modes we use. The resolution needs to be good enough to allow for various important ionization edges, but not so fine that one cannot characterize the slope of the spectrum in each interval.</p>
<p>The routines init_bands in this file sets up the bands to for creating photons based on various user inputs; it then calls freqs_init that sets up the frequency boundaries for recoding the spectra. </p>

<p class="definition">Definition in file <a class="el" href="bands_8c_source.html">bands.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3513a64162c15d3d3d101c3d5ea2367f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3513a64162c15d3d3d101c3d5ea2367f">&#9670;&nbsp;</a></span>bands_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bands_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>imode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structxbands.html">xbands</a> *&#160;</td>
          <td class="paramname"><em>band</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the routine that initializes the bands. </p>
<p>Python uses a form of stratified sampling in an attempt to assure that there are photon bundles at (high, generally) frequencies</p>
<p>This is the routine that initializes the bands. There are a number of possiblilities for setting up the bands</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>imode A switch used for determining how the bands are to be populated </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">struct</td><td>xbands * band The structure that is populated with the band information </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The routine itself simply returns 0 on success</dd></dl>
<p>The outputs are passed to other routines through the pointer to xbands.</p>
<p>The currently allow modes are *0 Use temperature to define a single band *1 Use f1 and f2 to define a single band *2 Use t,f1 and f2, and hardwired bands to define multiple bands which have been tuned to be relevent to CVs and other systems where a hot disk (T_eff of about 100,000 K is assumed</p><ul>
<li>3 Bands tuned for yso</li>
<li>4 Query the user to specify an arbitrary set of bands</li>
<li>5 Hardwired very wide bands for testing *6 Bands set up by nsh to test cloudy *7 Bands hardwired for AGN paper1 by nsh *8 Define bands in logarithmic intervals</li>
</ul>
<h3>Notes</h3>
<p>10nov - ksl - XXX Some of the choices have checks to see whether the bands that are being set up lie within f1 and f2. Others do not. This seems like an error.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000003">Bug:</a></b></dt><dd>At some point some of the banding needs to be tested systematically. We have tended to find a setup that we like and just use it.</dd></dl>

<p class="definition">Definition at line <a class="el" href="bands_8c_source.html#l00123">123</a> of file <a class="el" href="bands_8c_source.html">bands.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_cgraph.png" border="0" usemap="#bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_cgraph" alt=""/></div>
<map name="bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_cgraph" id="bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_cgraph">
<area shape="rect" id="node2" href="disk_8c.html#adc2a482ce6c550cd7e5498bf0ee1055b" title="Calculate the reference temperarure for a standard Shakura&#45;Sunyaeev disk. " alt="" coords="131,5,174,32"/>
<area shape="rect" id="node3" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="249,81,288,108"/>
<area shape="rect" id="node5" href="log_8h.html#a3a649b0453ce83dbb1b16de81e08f5af" title="rdint" alt="" coords="132,208,173,235"/>
<area shape="rect" id="node6" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="131,157,175,184"/>
<area shape="rect" id="node12" href="log_8h.html#a84776d33fbdc65228f584debd72e15e0" title="rddoub" alt="" coords="126,259,179,285"/>
<area shape="rect" id="node13" href="bands_8c.html#a900ff3bb7a80569abf42be1e2b00fd36" title="This is the routine where the frequency boundaries for course spectra are established. " alt="" coords="121,107,184,133"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="601,157,659,184"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="232,233,305,260"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="353,208,443,235"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="376,259,420,285"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="503,183,541,209"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="491,233,553,260"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_icgraph.png" border="0" usemap="#bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_icgraph" alt=""/></div>
<map name="bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_icgraph" id="bands_8c_a3513a64162c15d3d3d101c3d5ea2367f_icgraph">
<area shape="rect" id="node2" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="121,5,165,32"/>
</map>
</div>

</div>
</div>
<a id="a900ff3bb7a80569abf42be1e2b00fd36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a900ff3bb7a80569abf42be1e2b00fd36">&#9670;&nbsp;</a></span>freqs_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int freqs_init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the routine where the frequency boundaries for course spectra are established. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>freqmin The minimum frequency </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>freqmax The maximum frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>In addition to setting bands which define the photons that are generated one must define bands that approximated the spectra in a cell. One cannot store all of the photons and their weights. This routine creates boundaries for storring the spectra.</p>
<h3>Notes</h3>
<p>At present everything is hardwired. Two typs of banding are carred out, one for AGN/X-ray bianries, and one for stellar systems</p>
<p>freqmin and freqmax are used inorder to limit the total range of the spectral bands.</p>
<p>The results are stored in geo.xfreq </p>

<p class="definition">Definition at line <a class="el" href="bands_8c_source.html#l00608">608</a> of file <a class="el" href="bands_8c_source.html">bands.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_cgraph.png" border="0" usemap="#bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_cgraph" alt=""/></div>
<map name="bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_cgraph" id="bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="116,5,155,32"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="203,5,260,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_icgraph.png" border="0" usemap="#bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_icgraph" alt=""/></div>
<map name="bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_icgraph" id="bands_8c_a900ff3bb7a80569abf42be1e2b00fd36_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a3513a64162c15d3d3d101c3d5ea2367f" title="This is the routine that initializes the bands. " alt="" coords="116,5,184,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="232,5,276,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="bands_8c.html">bands.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
