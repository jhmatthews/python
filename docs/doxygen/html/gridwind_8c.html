<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/gridwind.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('gridwind_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gridwind.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains routines for allocating space for most of the structures needed by Python. These include Wind and Plasma structures, and if using macro atoms, the various structures rwquired for this. The file also contains a routine that maps grid cells in the wind to those in the Plasma structure, and vice versa.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for gridwind.c:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2gridwind_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2gridwind_8c" id="_2_users_2mhewitt_2python_2source_2gridwind_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="gridwind_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a67af2cd841a922ea1001654449239284"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gridwind_8c.html#a67af2cd841a922ea1001654449239284">create_maps</a> (int ichoice)</td></tr>
<tr class="memdesc:a67af2cd841a922ea1001654449239284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a map between wind and plasma cells.  <a href="#a67af2cd841a922ea1001654449239284">More...</a><br /></td></tr>
<tr class="separator:a67af2cd841a922ea1001654449239284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3449f72ae22aca485dfaa4d2f5ae300"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gridwind_8c.html#af3449f72ae22aca485dfaa4d2f5ae300">calloc_wind</a> (int nelem)</td></tr>
<tr class="memdesc:af3449f72ae22aca485dfaa4d2f5ae300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate space for the wind domain.  <a href="#af3449f72ae22aca485dfaa4d2f5ae300">More...</a><br /></td></tr>
<tr class="separator:af3449f72ae22aca485dfaa4d2f5ae300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a391062d8b219dffc8496bd6fc8128cf6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gridwind_8c.html#a391062d8b219dffc8496bd6fc8128cf6">calloc_plasma</a> (int nelem)</td></tr>
<tr class="memdesc:a391062d8b219dffc8496bd6fc8128cf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for plasmamain, which contains temperature, densities, etc. for cells which are in the wind.  <a href="#a391062d8b219dffc8496bd6fc8128cf6">More...</a><br /></td></tr>
<tr class="separator:a391062d8b219dffc8496bd6fc8128cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74097465c23495e007af69e2c66e8d61"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gridwind_8c.html#a74097465c23495e007af69e2c66e8d61">check_plasma</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, <a class="el" href="rdpar_8c.html#abc6cdcc4db9d9768558d0faa2128c876">message</a>)</td></tr>
<tr class="memdesc:a74097465c23495e007af69e2c66e8d61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that one is not trying to get information from the dummy Plasma element that is associated with wind elements that are not really in the wind.  <a href="#a74097465c23495e007af69e2c66e8d61">More...</a><br /></td></tr>
<tr class="separator:a74097465c23495e007af69e2c66e8d61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b147244ba1a5d54d79a57a8ee665b18"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gridwind_8c.html#a4b147244ba1a5d54d79a57a8ee665b18">calloc_macro</a> (int nelem)</td></tr>
<tr class="memdesc:a4b147244ba1a5d54d79a57a8ee665b18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory to store information for macro atoms for each Plasma element.  <a href="#a4b147244ba1a5d54d79a57a8ee665b18">More...</a><br /></td></tr>
<tr class="separator:a4b147244ba1a5d54d79a57a8ee665b18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43492c595dcd8568e2c14a8496c8fd43"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gridwind_8c.html#a43492c595dcd8568e2c14a8496c8fd43">calloc_estimators</a> (int nelem)</td></tr>
<tr class="memdesc:a43492c595dcd8568e2c14a8496c8fd43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamically allocate various arrays in macromain.  <a href="#a43492c595dcd8568e2c14a8496c8fd43">More...</a><br /></td></tr>
<tr class="separator:a43492c595dcd8568e2c14a8496c8fd43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311078e4d3e5530a996283eaf4c0fb19"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gridwind_8c.html#a311078e4d3e5530a996283eaf4c0fb19">calloc_dyn_plasma</a> (int nelem)</td></tr>
<tr class="memdesc:a311078e4d3e5530a996283eaf4c0fb19"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine allocates space for dynamic arrays in the plasma structure.  <a href="#a311078e4d3e5530a996283eaf4c0fb19">More...</a><br /></td></tr>
<tr class="separator:a311078e4d3e5530a996283eaf4c0fb19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains routines for allocating space for most of the structures needed by Python. These include Wind and Plasma structures, and if using macro atoms, the various structures rwquired for this. The file also contains a routine that maps grid cells in the wind to those in the Plasma structure, and vice versa. </p>
<dl class="section author"><dt>Author</dt><dd>ksl,sss,jm </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April, 2018</dd></dl>
<p>The hierachy of stuctures that describe a model in Python are domains (which describe a region of the wind), wmain which contains basic information about the cells in each domain, and plasmamain which contains more detailed information about cells which are actually in the wind.</p>
<p>The cells in wmain are created on a simple grid, often a cylindrical region, but no all of this region may be in the wind, as the case in a binconical flow. To save memory, one usually only creates elements of plasmamain that correspond to wind cells that are actually in the wind.</p>
<p>The Plasma structure includes space for storing all of the information needed to calculate ionization and equilibrium in the two-level approximation. However, additional structures are required when operating in macro atom mode. Routines for allocating the structures associated with macroatoms are also included here.</p>
<p>Note that a coniderable effort has been made to minimize the total size of the various structures, and so PlasmaMain contains a number of variables that are actually pointers to other structures that are allocated dynamically depeding on the atomic data. This is also true in the case of the main macro atom structure MacroMain.</p>
<p>Note that some structures are allocated in other portions of the code, e.g get_atomic_data, but all of the structures that are needed to set up the wind are here. </p>

<p class="definition">Definition in file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a311078e4d3e5530a996283eaf4c0fb19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a311078e4d3e5530a996283eaf4c0fb19">&#9670;&nbsp;</a></span>calloc_dyn_plasma()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calloc_dyn_plasma </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine allocates space for dynamic arrays in the plasma structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nelem the number of plasma cells (actually NPLASMA+1) to allow for empty cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0, unless the memory cannot be allocated in which case the proram exits</dd></dl>
<p>This subroutine allocates space for variable length arrays in the plasma structure.</p>
<h3>Notes</h3>
<p>Arrays sized to the number of ions are largest, and dominate the size of nplasma, so these were first to be dynamically allocated. </p>

<p class="definition">Definition at line <a class="el" href="gridwind_8c_source.html#l00570">570</a> of file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_cgraph.png" border="0" usemap="#gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_cgraph" alt=""/></div>
<map name="gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_cgraph" id="gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="160,125,204,152"/>
<area shape="rect" id="node9" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="269,176,308,202"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="621,74,679,101"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="252,125,325,152"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="373,74,463,101"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="396,125,440,152"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="523,24,561,50"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="511,74,573,101"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_icgraph.png" border="0" usemap="#gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_icgraph" alt=""/></div>
<map name="gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_icgraph" id="gridwind_8c_a311078e4d3e5530a996283eaf4c0fb19_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="160,5,236,32"/>
<area shape="rect" id="node4" href="windsave_8c.html#a1bf368d85f72b220cc4cba091a5e0702" title="Read back the windsavefile. " alt="" coords="164,56,232,83"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="284,5,328,32"/>
</map>
</div>

</div>
</div>
<a id="a43492c595dcd8568e2c14a8496c8fd43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43492c595dcd8568e2c14a8496c8fd43">&#9670;&nbsp;</a></span>calloc_estimators()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calloc_estimators </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dynamically allocate various arrays in macromain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nelem The number of elements in macromain </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0, unless the desired memory cannot be allocated in which the routine exits after an error message</dd></dl>
<p>To minimize the total amount of memory required by Python in macromode, allocate memory for various arrays in macromain which depend upon the number of ions which are treated as macro atoms</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="gridwind_8c_source.html#l00388">388</a> of file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_cgraph.png" border="0" usemap="#gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_cgraph" alt=""/></div>
<map name="gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_cgraph" id="gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="247,5,315,32"/>
<area shape="rect" id="node4" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="155,56,193,83"/>
<area shape="rect" id="node5" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="152,107,196,133"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="613,107,671,133"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="244,208,317,235"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="365,183,455,209"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="388,233,432,260"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="515,157,553,184"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="503,208,565,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_icgraph.png" border="0" usemap="#gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_icgraph" alt=""/></div>
<map name="gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_icgraph" id="gridwind_8c_a43492c595dcd8568e2c14a8496c8fd43_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="152,5,228,32"/>
<area shape="rect" id="node4" href="windsave_8c.html#a1bf368d85f72b220cc4cba091a5e0702" title="Read back the windsavefile. " alt="" coords="156,56,224,83"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="276,5,320,32"/>
</map>
</div>

</div>
</div>
<a id="a4b147244ba1a5d54d79a57a8ee665b18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b147244ba1a5d54d79a57a8ee665b18">&#9670;&nbsp;</a></span>calloc_macro()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calloc_macro </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory to store information for macro atoms for each Plasma element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nelem The number of cells that are actually included in the wind. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0, unless memory cannot allocate the requested memory in which case the program exits</dd></dl>
<p>This routine allocates memory for the structure macromain, in the situation where the program is being run in macro-atom mode.</p>
<h3>Notes</h3>
<p>The size of calloc macro depends on the number cells in the wind, but many of the elements of macro main are simply stucture pointers that are allocated by calloc_estimators. </p>

<p class="definition">Definition at line <a class="el" href="gridwind_8c_source.html#l00330">330</a> of file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_cgraph.png" border="0" usemap="#gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_cgraph" alt=""/></div>
<map name="gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_cgraph" id="gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="135,125,179,152"/>
<area shape="rect" id="node9" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="244,176,283,202"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="596,74,653,101"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="227,125,300,152"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="348,74,437,101"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="371,125,415,152"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="497,24,536,50"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="485,74,548,101"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_icgraph.png" border="0" usemap="#gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_icgraph" alt=""/></div>
<map name="gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_icgraph" id="gridwind_8c_a4b147244ba1a5d54d79a57a8ee665b18_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="135,5,211,32"/>
<area shape="rect" id="node4" href="windsave_8c.html#a1bf368d85f72b220cc4cba091a5e0702" title="Read back the windsavefile. " alt="" coords="139,56,207,83"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="259,5,303,32"/>
</map>
</div>

</div>
</div>
<a id="a391062d8b219dffc8496bd6fc8128cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a391062d8b219dffc8496bd6fc8128cf6">&#9670;&nbsp;</a></span>calloc_plasma()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calloc_plasma </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory for plasmamain, which contains temperature, densities, etc. for cells which are in the wind. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>nelem The number of elements of plasmamain to allocate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0, unless the program is unable to allocate the requested memory in which case the program exits</dd></dl>
<h3>Notes</h3>
<p>This only allocates elements. It does not populate them with any information.</p>
<p>The routine also allocates space for storing photons associated with each plasma cell. This is used for creating wind photons in a cell in cases where one wants to created multiple photons of a certain type, and generating the cdf for this is time consuming, but generating photons once you have the cdf is not. It is currently used for fb processes only. </p>

<p class="definition">Definition at line <a class="el" href="gridwind_8c_source.html#l00215">215</a> of file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_cgraph.png" border="0" usemap="#gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_cgraph" alt=""/></div>
<map name="gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_cgraph" id="gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="139,125,183,152"/>
<area shape="rect" id="node9" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="248,176,287,202"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="600,74,657,101"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="231,125,304,152"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="352,74,441,101"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="375,125,419,152"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="501,24,540,50"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="489,74,552,101"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_icgraph.png" border="0" usemap="#gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_icgraph" alt=""/></div>
<map name="gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_icgraph" id="gridwind_8c_a391062d8b219dffc8496bd6fc8128cf6_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="139,5,215,32"/>
<area shape="rect" id="node4" href="windsave_8c.html#a1bf368d85f72b220cc4cba091a5e0702" title="Read back the windsavefile. " alt="" coords="143,56,211,83"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="263,5,307,32"/>
</map>
</div>

</div>
</div>
<a id="af3449f72ae22aca485dfaa4d2f5ae300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3449f72ae22aca485dfaa4d2f5ae300">&#9670;&nbsp;</a></span>calloc_wind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calloc_wind </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate space for the wind domain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nelem</td><td>The number of elements in the wind domain to allocate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 unless there is insufficient space, in which case the routine will call the program to exits</dd></dl>
<h3>Notes</h3>
<p>The wind is conisists of grids of cells that paper the active region of the calculation. Each domain has a number of these grid cells. nelem is the total number of such cells. </p>

<p class="definition">Definition at line <a class="el" href="gridwind_8c_source.html#l00158">158</a> of file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_cgraph.png" border="0" usemap="#gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_cgraph" alt=""/></div>
<map name="gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_cgraph" id="gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="127,125,171,152"/>
<area shape="rect" id="node9" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="236,176,275,202"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="588,74,645,101"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="219,125,292,152"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="340,74,429,101"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="363,125,407,152"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="489,24,528,50"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="477,74,540,101"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_icgraph.png" border="0" usemap="#gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_icgraph" alt=""/></div>
<map name="gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_icgraph" id="gridwind_8c_af3449f72ae22aca485dfaa4d2f5ae300_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="127,5,203,32"/>
<area shape="rect" id="node4" href="windsave_8c.html#a1bf368d85f72b220cc4cba091a5e0702" title="Read back the windsavefile. " alt="" coords="131,56,199,83"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="251,5,295,32"/>
</map>
</div>

</div>
</div>
<a id="a74097465c23495e007af69e2c66e8d61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74097465c23495e007af69e2c66e8d61">&#9670;&nbsp;</a></span>check_plasma()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_plasma </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="rdpar_8c.html#abc6cdcc4db9d9768558d0faa2128c876">message</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that one is not trying to get information from the dummy Plasma element that is associated with wind elements that are not really in the wind. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma A pointer to the plasma element </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>message[] A message which is printed out if one has tried to access the dummy Plsma element </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (False) if one is not in the empty plasma cell, 1 (True) if you have gooten there.</dd></dl>
<p>Wind cells that have no associated volume are assigned to the same plasma element. One should never be asked to generate a photon or indeeed have a scattering event in such wind cells. This little routine is just a diagnostic routine that throws an error message if one has gotten into such a situation.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="gridwind_8c_source.html#l00290">290</a> of file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a74097465c23495e007af69e2c66e8d61_cgraph.png" border="0" usemap="#gridwind_8c_a74097465c23495e007af69e2c66e8d61_cgraph" alt=""/></div>
<map name="gridwind_8c_a74097465c23495e007af69e2c66e8d61_cgraph" id="gridwind_8c_a74097465c23495e007af69e2c66e8d61_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="139,32,183,59"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="489,134,552,160"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="600,32,657,59"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="231,32,304,59"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="352,83,441,110"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="375,32,419,59"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="501,83,540,110"/>
</map>
</div>

</div>
</div>
<a id="a67af2cd841a922ea1001654449239284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67af2cd841a922ea1001654449239284">&#9670;&nbsp;</a></span>create_maps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int create_maps </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ichoice</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a map between wind and plasma cells. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ichoice An option which if non-zero indicates that a plasma element exists for each wmain element </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine fills variables, nplasma in wmain, and nwind in plasmamain that map elements of wmain to those in plasmamain anc vice versus</p>
<h3>Notes</h3>
<p>Normally, there are fewer plasma elements than wind elements, since plasma elements are created only for those wind elements which have finite volume in the wind. For each domain, a coordinate grid is created that covers a region of space, e.g a portion of a cylindrical grid. However some cells in this region are empty or matter, e.g in a binconical flow. However if ichoice is non-zero, a plasma cell has been created for all wind cells even if they are empty, something that is done only for diagnostic purposes.</p>
<p>wmain and plasmamain will already have been allocated memory by the time this routine is called. </p>

<p class="definition">Definition at line <a class="el" href="gridwind_8c_source.html#l00088">88</a> of file <a class="el" href="gridwind_8c_source.html">gridwind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a67af2cd841a922ea1001654449239284_cgraph.png" border="0" usemap="#gridwind_8c_a67af2cd841a922ea1001654449239284_cgraph" alt=""/></div>
<map name="gridwind_8c_a67af2cd841a922ea1001654449239284_cgraph" id="gridwind_8c_a67af2cd841a922ea1001654449239284_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="133,25,177,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="595,25,652,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="225,51,299,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="347,37,436,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="369,88,413,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="496,25,535,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="484,76,547,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gridwind_8c_a67af2cd841a922ea1001654449239284_icgraph.png" border="0" usemap="#gridwind_8c_a67af2cd841a922ea1001654449239284_icgraph" alt=""/></div>
<map name="gridwind_8c_a67af2cd841a922ea1001654449239284_icgraph" id="gridwind_8c_a67af2cd841a922ea1001654449239284_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="133,5,209,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="257,5,301,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="gridwind_8c.html">gridwind.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
