<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/wind.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('wind_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">wind.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Except for where_in_wind, these are convenience routines which make it easier to incorporate wind models into Python.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for wind.c:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2wind_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2wind_8c" id="_2_users_2mhewitt_2python_2source_2wind_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="wind_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5f63dccb9b43b11cc312ab51e4d0d0ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind_8c.html#a5f63dccb9b43b11cc312ab51e4d0d0ac">where_in_wind</a> (<a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, int *ndomain)</td></tr>
<tr class="memdesc:a5f63dccb9b43b11cc312ab51e4d0d0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">determines whether a position x is in a wind region.  <a href="#a5f63dccb9b43b11cc312ab51e4d0d0ac">More...</a><br /></td></tr>
<tr class="separator:a5f63dccb9b43b11cc312ab51e4d0d0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae04150c3a36a71098fa438ec9401e40d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind_8c.html#ae04150c3a36a71098fa438ec9401e40d">model_velocity</a> (int ndom, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, <a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>)</td></tr>
<tr class="memdesc:ae04150c3a36a71098fa438ec9401e40d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the wind velocity at a specific point in space from the original usually analytic expressions.  <a href="#ae04150c3a36a71098fa438ec9401e40d">More...</a><br /></td></tr>
<tr class="separator:ae04150c3a36a71098fa438ec9401e40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc0364b3155b294b0590e9900867bfb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind_8c.html#aecc0364b3155b294b0590e9900867bfb">model_vgrad</a> (int ndom, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, v_grad)</td></tr>
<tr class="memdesc:aecc0364b3155b294b0590e9900867bfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the velocity gradient at positions in the flow based on the analytic wind models and imported models.  <a href="#aecc0364b3155b294b0590e9900867bfb">More...</a><br /></td></tr>
<tr class="separator:aecc0364b3155b294b0590e9900867bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6190258be2516eb521132d5a1ec1886f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind_8c.html#a6190258be2516eb521132d5a1ec1886f">model_rho</a> (int ndom, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:a6190258be2516eb521132d5a1ec1886f"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the density of the wind in from the flow based on the analytic wind models.  <a href="#a6190258be2516eb521132d5a1ec1886f">More...</a><br /></td></tr>
<tr class="separator:a6190258be2516eb521132d5a1ec1886f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5de177d6e8fc4d6d0becf0c2898b90d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind_8c.html#aa5de177d6e8fc4d6d0becf0c2898b90d">wind_check</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> www, int n)</td></tr>
<tr class="memdesc:aa5de177d6e8fc4d6d0becf0c2898b90d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple checks of the wind structure for reasonability.  <a href="#aa5de177d6e8fc4d6d0becf0c2898b90d">More...</a><br /></td></tr>
<tr class="separator:aa5de177d6e8fc4d6d0becf0c2898b90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Except for where_in_wind, these are convenience routines which make it easier to incorporate wind models into Python. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April, 2018</dd></dl>
<p>where_in_wind determines whether a position is x is in the wind and if so in what domain. Since grid can overlap, the Python convention is that the domains are overlaid on one another, and the last one is the one that matters at a particular postion. where_in_wind is therefore one of the basic utilites to determine where one is at any time.</p>
<p>In Python, the actual radiative transfer is carried on various grids (domains). During radiative transfer quatnities like velocity and density are obtained by interpolating on values in the grid, and not from the formulae that defince for, e. g. a SV model. The routines, here model_velocity, model_vgrad, model_rho, etc are used to populate the grid.</p>
<h3>Notes</h3>
<p>The file also contains a routine wind_check that probably could be removed altogether, as it has not revealed a problem in a very long time. </p>

<p class="definition">Definition in file <a class="el" href="wind_8c_source.html">wind.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6190258be2516eb521132d5a1ec1886f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6190258be2516eb521132d5a1ec1886f">&#9670;&nbsp;</a></span>model_rho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_rho </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the density of the wind in from the flow based on the analytic wind models. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] A position in the domain </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>rho at the position</dd></dl>
<p>The checks the wind type for this domain, e.g SV, and then calls the appropriate routine to that model, e.g sv_rho, to get the density</p>
<h3>Notes</h3>
<p>This routine is normally only used during the initialization of the wind </p>

<p class="definition">Definition at line <a class="el" href="wind_8c_source.html#l00380">380</a> of file <a class="el" href="wind_8c_source.html">wind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c_a6190258be2516eb521132d5a1ec1886f_cgraph.png" border="0" usemap="#wind_8c_a6190258be2516eb521132d5a1ec1886f_cgraph" alt=""/></div>
<map name="wind_8c_a6190258be2516eb521132d5a1ec1886f_cgraph" id="wind_8c_a6190258be2516eb521132d5a1ec1886f_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a4139b8cafcab2d2d4fb6d4da9c064dd2" title="sv_rho" alt="" coords="145,5,197,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a9376da4eeb7ef89e52a867eef104cc25" title="stellar_rho" alt="" coords="136,56,205,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a96750b1c2362e87438698e24afa56a39" title="hydro_rho" alt="" coords="137,107,204,133"/>
<area shape="rect" id="node5" href="corona_8c.html#a547bb990f8958165c0c4382393910d37" title="double (x) calculates the density of a corona at a position x " alt="" coords="135,157,207,184"/>
<area shape="rect" id="node6" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="267,183,311,209"/>
<area shape="rect" id="node13" href="foo_8h.html#a1a59c30ec7f9020e01e1eb9010be4109" title="kn_rho" alt="" coords="145,259,197,285"/>
<area shape="rect" id="node14" href="foo_8h.html#aeba6d538928fe4fdbe6d0e7a4350f9f8" title="homologous_rho" alt="" coords="123,309,219,336"/>
<area shape="rect" id="node15" href="foo_8h.html#a624115af503ecce9d20d3fc8c3813ca0" title="yso_rho" alt="" coords="142,360,199,387"/>
<area shape="rect" id="node16" href="foo_8h.html#ad6061b2ae811618355cf3d1058b14a65" title="Get the density at an arbitray position in an imported model. " alt="" coords="136,411,205,437"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="728,157,785,184"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="359,208,432,235"/>
<area shape="rect" id="node9" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="480,183,569,209"/>
<area shape="rect" id="node12" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="503,233,547,260"/>
<area shape="rect" id="node10" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="629,157,668,184"/>
<area shape="rect" id="node11" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="617,208,680,235"/>
</map>
</div>

</div>
</div>
<a id="ae04150c3a36a71098fa438ec9401e40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae04150c3a36a71098fa438ec9401e40d">&#9670;&nbsp;</a></span>model_velocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_velocity </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the wind velocity at a specific point in space from the original usually analytic expressions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>ndom The domain of interest </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>x[] A position (nominally in the domain) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>v[] The resulting velicity </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The speed at that postion</dd></dl>
<p>This is a convenience function that allows one to obtain the velocity at any point in space for a given domain. The routine uses the domain number to decide what velocity law is appriate. For models which are defined from a set of parametric equations the velocity will sill be calculated. For models that are read in as a grid, the models will be interpolated from the imported grid</p>
<h3>Notes</h3>
<p>This routine is used to set up the grid of velocities at the corners of grid cells. It is not used later on. </p>

<p class="definition">Definition at line <a class="el" href="wind_8c_source.html#l00236">236</a> of file <a class="el" href="wind_8c_source.html">wind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c_ae04150c3a36a71098fa438ec9401e40d_cgraph.png" border="0" usemap="#wind_8c_ae04150c3a36a71098fa438ec9401e40d_cgraph" alt=""/></div>
<map name="wind_8c_ae04150c3a36a71098fa438ec9401e40d_cgraph" id="wind_8c_ae04150c3a36a71098fa438ec9401e40d_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a065ea7111a89ce368a02ab78addf16dd" title="sv_velocity" alt="" coords="164,5,235,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a8dfc0e90b2ec7d2039a8a72236f3fc8f" title="stellar_velocity" alt="" coords="155,56,243,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a0f1ed208804bc45d2632cb33e9e73b59" title="hydro_velocity" alt="" coords="157,107,242,133"/>
<area shape="rect" id="node5" href="corona_8c.html#aecbe7916dace9e1253a7900f3ebecd80" title="double (x,v) calulates the v the wind at a position r x " alt="" coords="153,157,245,184"/>
<area shape="rect" id="node8" href="foo_8h.html#a5bbb1cf505a61b894ba478c38ce7935e" title="kn_velocity" alt="" coords="163,208,235,235"/>
<area shape="rect" id="node9" href="foo_8h.html#aa79b799560c85bc3b6a750e3bc150873" title="homologous_velocity" alt="" coords="141,259,257,285"/>
<area shape="rect" id="node10" href="foo_8h.html#a1ed063376968bf4fa4d573f19bae7375" title="yso_velocity" alt="" coords="161,309,237,336"/>
<area shape="rect" id="node11" href="foo_8h.html#a3100d6568eff0dee456e0b05042f575e" title="Get the velocity at a position for an imported model. " alt="" coords="155,360,244,387"/>
<area shape="rect" id="node12" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="177,411,221,437"/>
<area shape="rect" id="node6" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="305,132,421,159"/>
<area shape="rect" id="node7" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="337,183,389,209"/>
<area shape="rect" id="node13" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="717,411,775,437"/>
<area shape="rect" id="node14" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="327,461,400,488"/>
<area shape="rect" id="node15" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="469,436,559,463"/>
<area shape="rect" id="node18" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="492,487,536,513"/>
<area shape="rect" id="node16" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="619,411,657,437"/>
<area shape="rect" id="node17" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="607,461,669,488"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c_ae04150c3a36a71098fa438ec9401e40d_icgraph.png" border="0" usemap="#wind_8c_ae04150c3a36a71098fa438ec9401e40d_icgraph" alt=""/></div>
<map name="wind_8c_ae04150c3a36a71098fa438ec9401e40d_icgraph" id="wind_8c_ae04150c3a36a71098fa438ec9401e40d_icgraph">
<area shape="rect" id="node2" href="wind_8c.html#aecc0364b3155b294b0590e9900867bfb" title="calculate the velocity gradient at positions in the flow based on the analytic wind models and import..." alt="" coords="141,5,221,32"/>
</map>
</div>

</div>
</div>
<a id="aecc0364b3155b294b0590e9900867bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc0364b3155b294b0590e9900867bfb">&#9670;&nbsp;</a></span>model_vgrad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_vgrad </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">v_grad&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the velocity gradient at positions in the flow based on the analytic wind models and imported models. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] A position in the domain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>v_grad[][3] The velocity gradient tensor at the postion </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routien calls model_velocity multiple times to calculate the velocity gradient tensor at a particular position.</p>
<h3>Notes</h3>
<p>This routine is normally used only during the initialization of the wind </p>

<p class="definition">Definition at line <a class="el" href="wind_8c_source.html#l00315">315</a> of file <a class="el" href="wind_8c_source.html">wind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c_aecc0364b3155b294b0590e9900867bfb_cgraph.png" border="0" usemap="#wind_8c_aecc0364b3155b294b0590e9900867bfb_cgraph" alt=""/></div>
<map name="wind_8c_aecc0364b3155b294b0590e9900867bfb_cgraph" id="wind_8c_aecc0364b3155b294b0590e9900867bfb_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="156,5,199,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="465,132,517,159"/>
<area shape="rect" id="node4" href="wind_8c.html#ae04150c3a36a71098fa438ec9401e40d" title="Calculate the wind velocity at a specific point in space from the original usually analytic expressio..." alt="" coords="133,309,221,336"/>
<area shape="rect" id="node14" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="305,512,349,539"/>
<area shape="rect" id="node21" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="153,411,202,437"/>
<area shape="rect" id="node22" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="453,563,529,589"/>
<area shape="rect" id="node5" href="foo_8h.html#a065ea7111a89ce368a02ab78addf16dd" title="sv_velocity" alt="" coords="292,107,363,133"/>
<area shape="rect" id="node6" href="foo_8h.html#a8dfc0e90b2ec7d2039a8a72236f3fc8f" title="stellar_velocity" alt="" coords="283,157,371,184"/>
<area shape="rect" id="node7" href="foo_8h.html#a0f1ed208804bc45d2632cb33e9e73b59" title="hydro_velocity" alt="" coords="285,208,370,235"/>
<area shape="rect" id="node8" href="corona_8c.html#aecbe7916dace9e1253a7900f3ebecd80" title="double (x,v) calulates the v the wind at a position r x " alt="" coords="281,259,373,285"/>
<area shape="rect" id="node10" href="foo_8h.html#a5bbb1cf505a61b894ba478c38ce7935e" title="kn_velocity" alt="" coords="291,309,363,336"/>
<area shape="rect" id="node11" href="foo_8h.html#aa79b799560c85bc3b6a750e3bc150873" title="homologous_velocity" alt="" coords="269,360,385,387"/>
<area shape="rect" id="node12" href="foo_8h.html#a1ed063376968bf4fa4d573f19bae7375" title="yso_velocity" alt="" coords="289,411,365,437"/>
<area shape="rect" id="node13" href="foo_8h.html#a3100d6568eff0dee456e0b05042f575e" title="Get the velocity at a position for an imported model. " alt="" coords="283,461,372,488"/>
<area shape="rect" id="node9" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="433,259,549,285"/>
<area shape="rect" id="node15" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="845,487,903,513"/>
<area shape="rect" id="node16" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="455,512,528,539"/>
<area shape="rect" id="node17" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="597,512,687,539"/>
<area shape="rect" id="node20" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="620,563,664,589"/>
<area shape="rect" id="node18" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="747,487,785,513"/>
<area shape="rect" id="node19" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="735,537,797,564"/>
</map>
</div>

</div>
</div>
<a id="a5f63dccb9b43b11cc312ab51e4d0d0ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f63dccb9b43b11cc312ab51e4d0d0ac">&#9670;&nbsp;</a></span>where_in_wind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int where_in_wind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ndomain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determines whether a position x is in a wind region. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] a position </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* ndomain the wind domain that the position lies in, if it does </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>W_ALL_INWIND if the position is in a wind, W_IN_DISK if inside a vertically extended disk, W_NOT_INWIND otherwise</dd></dl>
<p>where_in_wind searches the wind domains in reverse order to decide whether a position in a particular wind domain or not. For most types of wind, where the edges of the wind are defined by wind_cones and by min and max radii etc. For imported models, where the wind_cones are insufficient, we check whether the position is in a cell that is in the wind.</p>
<h3>Notes</h3>
<p>Since domains can overlap in principle, e.g one can have say a bipolar wind which starts at the disk surface and goes to a very large radius, and then a coronal just above the disk, one needs a convention to know which domain to use when there are two possibilities. The Python convention is to lay the grids on top of one another so that the last one matters when there is a conflict. For this reason the grids are searched in reverse order.</p>
<p>Where_in_wind does not tell you whether a position is in the grid or not, just whether he photon is between the two wind cones and/or inside minimum or maximum radius of the wind. </p>

<p class="definition">Definition at line <a class="el" href="wind_8c_source.html#l00078">78</a> of file <a class="el" href="wind_8c_source.html">wind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac_cgraph.png" border="0" usemap="#wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac_cgraph" alt=""/></div>
<map name="wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac_cgraph" id="wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac_cgraph">
<area shape="rect" id="node2" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="163,5,208,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="161,56,210,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="143,107,228,133"/>
</map>
</div>

</div>
</div>
<a id="aa5de177d6e8fc4d6d0becf0c2898b90d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5de177d6e8fc4d6d0becf0c2898b90d">&#9670;&nbsp;</a></span>wind_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wind_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>www</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple checks of the wind structure for reasonability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WindPtr</td><td>www The entire wind </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>n n &gt;= 0 then an element of the array will be checked </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine should be called in a number of ways</p>
<ul>
<li>wind_check(w,-1); to check the entire structure</li>
<li>wind_check(w,50); to check element 50 of the structure</li>
<li>wind_check(w[50],0) to check elemetn 50 of the structure</li>
</ul>
<h3>Notes</h3>
<p>These checks are so basic, just NaN (sane_checks), that they hardly seem worth doing. One would think one would want to stop the program if any of them failed. But this does not take much time.</p>
<p>The checks are made on the wind, without reference to domains </p>

<p class="definition">Definition at line <a class="el" href="wind_8c_source.html#l00460">460</a> of file <a class="el" href="wind_8c_source.html">wind.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_cgraph.png" border="0" usemap="#wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_cgraph" alt=""/></div>
<map name="wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_cgraph" id="wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="361,5,400,32"/>
<area shape="rect" id="node4" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="128,81,204,108"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="252,132,296,159"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="713,81,771,108"/>
<area shape="rect" id="node5" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="252,81,296,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="344,107,417,133"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="465,107,555,133"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="615,107,653,133"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="603,157,665,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_icgraph.png" border="0" usemap="#wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_icgraph" alt=""/></div>
<map name="wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_icgraph" id="wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="128,5,204,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="252,5,296,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="wind_8c.html">wind.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
