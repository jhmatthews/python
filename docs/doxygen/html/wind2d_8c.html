<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/wind2d.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('wind2d_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">wind2d.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines that are used to define the wind initially.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for wind2d.c:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2wind2d_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2wind2d_8c" id="_2_users_2mhewitt_2python_2source_2wind2d_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="wind2d_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac98ab21bbcfcfc326f0b16fabd5587c0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#ac98ab21bbcfcfc326f0b16fabd5587c0">NSTEPS</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:ac98ab21bbcfcfc326f0b16fabd5587c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The routine calculates and then logs the mass loss rate in two ways.  <a href="#ac98ab21bbcfcfc326f0b16fabd5587c0">More...</a><br /></td></tr>
<tr class="separator:ac98ab21bbcfcfc326f0b16fabd5587c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a41ee5cb999f1d4258673b6134394b4cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc">define_wind</a> ()</td></tr>
<tr class="memdesc:a41ee5cb999f1d4258673b6134394b4cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the structures which characterize the wind, including wmain and plasmamain.  <a href="#a41ee5cb999f1d4258673b6134394b4cc">More...</a><br /></td></tr>
<tr class="separator:a41ee5cb999f1d4258673b6134394b4cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b676b9911462eec0740df5f8f0da55"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#ad4b676b9911462eec0740df5f8f0da55">where_in_grid</a> (int ndom, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:ad4b676b9911462eec0740df5f8f0da55"><td class="mdescLeft">&#160;</td><td class="mdescRight">locates the element in wmain associated with a postion  <a href="#ad4b676b9911462eec0740df5f8f0da55">More...</a><br /></td></tr>
<tr class="separator:ad4b676b9911462eec0740df5f8f0da55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ca398a2557e2b63247eac4366bc2e4f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (int ndom, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, <a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>)</td></tr>
<tr class="memdesc:a7ca398a2557e2b63247eac4366bc2e4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p.  <a href="#a7ca398a2557e2b63247eac4366bc2e4f">More...</a><br /></td></tr>
<tr class="separator:a7ca398a2557e2b63247eac4366bc2e4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad47569135f21d4ce22504b0ad5b0b221"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221">wind_div_v</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w)</td></tr>
<tr class="separator:ad47569135f21d4ce22504b0ad5b0b221"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a078472458c0ac73f723c094fc2121c14"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:a078472458c0ac73f723c094fc2121c14"><td class="mdescLeft">&#160;</td><td class="mdescRight">find the density of the wind at x  <a href="#a078472458c0ac73f723c094fc2121c14">More...</a><br /></td></tr>
<tr class="separator:a078472458c0ac73f723c094fc2121c14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a558bbf4d12656ab12c2a03f6475b0eee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee">mdot_wind</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, double <a class="el" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a>, double rmax)</td></tr>
<tr class="separator:a558bbf4d12656ab12c2a03f6475b0eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8f7fd3a6d5f7872ee87beb27dcba899"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#af8f7fd3a6d5f7872ee87beb27dcba899">get_random_location</a> (int n, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:af8f7fd3a6d5f7872ee87beb27dcba899"><td class="mdescLeft">&#160;</td><td class="mdescRight">is simply will produce a postion at a random place in a cell n  <a href="#af8f7fd3a6d5f7872ee87beb27dcba899">More...</a><br /></td></tr>
<tr class="separator:af8f7fd3a6d5f7872ee87beb27dcba899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a675b4d912b5b505f099fc17031660393"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a675b4d912b5b505f099fc17031660393">zero_scatters</a> ()</td></tr>
<tr class="memdesc:a675b4d912b5b505f099fc17031660393"><td class="mdescLeft">&#160;</td><td class="mdescRight">zero out the portion of plasmamain that records the number of scatters in each cell  <a href="#a675b4d912b5b505f099fc17031660393">More...</a><br /></td></tr>
<tr class="separator:a675b4d912b5b505f099fc17031660393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e38cc8054ee669104c30986700d508"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a80e38cc8054ee669104c30986700d508">check_corners_inwind</a> (int n)</td></tr>
<tr class="memdesc:a80e38cc8054ee669104c30986700d508"><td class="mdescLeft">&#160;</td><td class="mdescRight">The routine basically just calls where_in_wind for each of the 4 corners of the cell.  <a href="#a80e38cc8054ee669104c30986700d508">More...</a><br /></td></tr>
<tr class="separator:a80e38cc8054ee669104c30986700d508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a980ea04ae2c501a6df12080eb698a851"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a980ea04ae2c501a6df12080eb698a851">check_grid</a> ()</td></tr>
<tr class="memdesc:a980ea04ae2c501a6df12080eb698a851"><td class="mdescLeft">&#160;</td><td class="mdescRight">check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might wish to have smaller grid cells  <a href="#a980ea04ae2c501a6df12080eb698a851">More...</a><br /></td></tr>
<tr class="separator:a980ea04ae2c501a6df12080eb698a851"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae1705b3b8167c7d811573af4a3bd063d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#ae1705b3b8167c7d811573af4a3bd063d">wig_n</a></td></tr>
<tr class="separator:ae1705b3b8167c7d811573af4a3bd063d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85d6497ec425ae7ad645123ecd08851b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a85d6497ec425ae7ad645123ecd08851b">wig_x</a></td></tr>
<tr class="separator:a85d6497ec425ae7ad645123ecd08851b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ecbd1b141d80e28463cf7da2bc94c7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a44ecbd1b141d80e28463cf7da2bc94c7">wig_y</a></td></tr>
<tr class="separator:a44ecbd1b141d80e28463cf7da2bc94c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab087c671695d8b903dc431a91b0d85da"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#ab087c671695d8b903dc431a91b0d85da">wig_z</a></td></tr>
<tr class="separator:ab087c671695d8b903dc431a91b0d85da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad318f8972d3832930303d84e94599a89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#ad318f8972d3832930303d84e94599a89">ierr_vwind</a> = 0</td></tr>
<tr class="separator:ad318f8972d3832930303d84e94599a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fe8eb8bacb888783ada9dd32b523e1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wind2d_8c.html#a8fe8eb8bacb888783ada9dd32b523e1a">wind_div_err</a> = (-3)</td></tr>
<tr class="memdesc:a8fe8eb8bacb888783ada9dd32b523e1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the divergence of the velocity at the center of all the grid cells.  <a href="#a8fe8eb8bacb888783ada9dd32b523e1a">More...</a><br /></td></tr>
<tr class="separator:a8fe8eb8bacb888783ada9dd32b523e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines that are used to define the wind initially. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May, 2018</dd></dl>
<p>The file also contains a number of utility routines, several of which are steering routines to coordinate system specific routines. </p>

<p class="definition">Definition in file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ac98ab21bbcfcfc326f0b16fabd5587c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac98ab21bbcfcfc326f0b16fabd5587c0">&#9670;&nbsp;</a></span>NSTEPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NSTEPS&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The routine calculates and then logs the mass loss rate in two ways. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w The entire wind domain </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>z A zheight above the disk to calculate the mass loss rate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>rmax A radius at which to calculate the mass loss rate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always retruns 0</dd></dl>
<p>The routine calculates the mass loss rate in two ways, one in a plane with a zheight of 0 above the disk (out to a distance rmax, and one at a spherical radius rmax</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000064">Bug:</a></b></dt><dd>This routine has errors. It is only correct if there is a single domain. In particular rho(w,x) gives the correct answer for rho regardless of domains, but nodom is set to 0 for vind(ndom,&amp;p,v). This should be fixed.</dd></dl>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l01008">1008</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a80e38cc8054ee669104c30986700d508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80e38cc8054ee669104c30986700d508">&#9670;&nbsp;</a></span>check_corners_inwind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_corners_inwind </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The routine basically just calls where_in_wind for each of the 4 corners of the cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>n the cell number in wmain </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of corners of the cell that are in the wind</dd></dl>
<p>This is really just a driver routine which calls coordinate system specific routines</p>
<p>It is intended to standardize this check so that one can use such a routine in the volumes calculations.</p>
<h3>Notes</h3>
<p>This is one of the routines that makes explicity assumptions about guard cells, and it is not entirely clear why </p>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l01245">1245</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a80e38cc8054ee669104c30986700d508_cgraph.png" border="0" usemap="#wind2d_8c_a80e38cc8054ee669104c30986700d508_cgraph" alt=""/></div>
<map name="wind2d_8c_a80e38cc8054ee669104c30986700d508_cgraph" id="wind2d_8c_a80e38cc8054ee669104c30986700d508_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530" title="Translate a cell number in the wind to the two&#45;d grid position in a specific domain. " alt="" coords="181,5,258,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="175,56,264,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a80e38cc8054ee669104c30986700d508_icgraph.png" border="0" usemap="#wind2d_8c_a80e38cc8054ee669104c30986700d508_icgraph" alt=""/></div>
<map name="wind2d_8c_a80e38cc8054ee669104c30986700d508_icgraph" id="wind2d_8c_a80e38cc8054ee669104c30986700d508_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#aa06d3901560706877fe1b434a657e3d1" title="Check whether this cell is in the wind or not. " alt="" coords="175,5,295,32"/>
<area shape="rect" id="node4" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="481,31,557,57"/>
<area shape="rect" id="node6" href="templates_8h.html#a6a70fbae6e163ad01aec40a2354ed674" title="Check whether a cell in an rtheta coordiante system is in the wind. " alt="" coords="175,107,295,133"/>
<area shape="rect" id="node3" href="templates_8h.html#a13144d35b1d57cfa570b6e59d225f474" title="Calculates the wind volume for cells in a cylindrical domain allowing for the fact that some cells ar..." alt="" coords="343,5,433,32"/>
<area shape="rect" id="node5" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="605,31,649,57"/>
<area shape="rect" id="node7" href="templates_8h.html#a16377719f4171d75f5aa983c79476590" title="rtheta_volume(w) calculates the wind volume of a cell in rtheta coordinate sysem allowing for the fac..." alt="" coords="343,107,433,133"/>
</map>
</div>

</div>
</div>
<a id="a980ea04ae2c501a6df12080eb698a851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a980ea04ae2c501a6df12080eb698a851">&#9670;&nbsp;</a></span>check_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_grid </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might wish to have smaller grid cells </p>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The results are logged.</p>
<p>loops over the entire wind points and checks quantities like velocity gradients and optical depths across cells for large changes. If there are large changes in cells, it tells the user how many cells and suggests that the grid may need to be modified.</p>
<h3>Notes</h3>
<p>Must be called after define wind so NPLASMA and densities are set up.</p>
<p>The information that is checked is very basic and it is clear that someone was thinking about doing somewhat better checks.</p>
<p>Errors are not generated, or rather have been commented out, and so one needs to consider whether this is useful or not. If so there should be errors. </p>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l01313">1313</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a980ea04ae2c501a6df12080eb698a851_cgraph.png" border="0" usemap="#wind2d_8c_a980ea04ae2c501a6df12080eb698a851_cgraph" alt=""/></div>
<map name="wind2d_8c_a980ea04ae2c501a6df12080eb698a851_cgraph" id="wind2d_8c_a980ea04ae2c501a6df12080eb698a851_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a9ca1dd624c5f0c6c8a401a0e79d023b5" title="model_velocity" alt="" coords="124,5,212,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="146,56,190,83"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="629,56,687,83"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="260,81,333,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="381,68,471,95"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="404,119,448,145"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="531,56,569,83"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="519,107,581,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a980ea04ae2c501a6df12080eb698a851_icgraph.png" border="0" usemap="#wind2d_8c_a980ea04ae2c501a6df12080eb698a851_icgraph" alt=""/></div>
<map name="wind2d_8c_a980ea04ae2c501a6df12080eb698a851_icgraph" id="wind2d_8c_a980ea04ae2c501a6df12080eb698a851_icgraph">
<area shape="rect" id="node2" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="124,5,168,32"/>
</map>
</div>

</div>
</div>
<a id="a41ee5cb999f1d4258673b6134394b4cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41ee5cb999f1d4258673b6134394b4cc">&#9670;&nbsp;</a></span>define_wind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int define_wind </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes the structures which characterize the wind, including wmain and plasmamain. </p>
<dl class="section return"><dt>Returns</dt><dd>Allways returns 0</dd></dl>
<p>This is the controlling routine for initializing the wind and related structures, calculating the salient properties (e.g. the volume that is in the wind) in each grid cell.</p>
<h3>Notes</h3>
<p>This is a fairly complex routine. In addition ot allocating space, the routine initalizes the wind. In some case the initalization is done "in-line" but more often other routines, many of which coordinate system specifica are clled. </p>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00043">43</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_cgraph.png" border="0" usemap="#wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_cgraph" alt=""/></div>
<map name="wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_cgraph" id="wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#af3449f72ae22aca485dfaa4d2f5ae300" title="Allocate space for the wind domain. " alt="" coords="158,5,231,32"/>
<area shape="rect" id="node3" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="349,917,388,944"/>
<area shape="rect" id="node5" href="foo_8h.html#a757c9acbab0a0377cc2757a853d168df" title="Make the Python grid. " alt="" coords="143,107,246,133"/>
<area shape="rect" id="node6" href="foo_8h.html#a1df8af4539e5836b6a2f8dab9f88572e" title="defines the cells in a thin shell, a special case of a spherical wind. " alt="" coords="147,157,242,184"/>
<area shape="rect" id="node7" href="foo_8h.html#abc3da46eefcdd64c79fd792439a5b53d" title="defines the cells in a spherical grid " alt="" coords="137,208,252,235"/>
<area shape="rect" id="node8" href="cylindrical_8c.html#a56507e563e08709e70d77a7ccd538ee3" title="defines the cells in a cylindrical grid " alt="" coords="145,765,245,792"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="683,1268,727,1295"/>
<area shape="rect" id="node16" href="foo_8h.html#a38134c43cdc9afb2ef078514b06b4f88" title="Defines an r&#45;theta grid to accept a hydro model. " alt="" coords="129,360,260,387"/>
<area shape="rect" id="node17" href="foo_8h.html#a4cb6c91545a34b48e5d6cd74a68665de" title="Set up an rtheta grid. " alt="" coords="145,411,245,437"/>
<area shape="rect" id="node18" href="cylind__var_8c.html#a95a5dd7b17dd91fc7d21b44ee290d256" title="defines the cells in a cylindrical grid when the disk is vertically extended. " alt="" coords="145,309,245,336"/>
<area shape="rect" id="node20" href="foo_8h.html#a9ca1dd624c5f0c6c8a401a0e79d023b5" title="model_velocity" alt="" coords="151,512,239,539"/>
<area shape="rect" id="node21" href="foo_8h.html#a547dbd45aa816e77d574b6bf3deb6b65" title="model_vgrad" alt="" coords="155,563,235,589"/>
<area shape="rect" id="node22" href="foo_8h.html#ad5c30455dbf640e7a5d68132a8e4a5c5" title="A driver routine that calls coordinate&#45;system specific routines that complete the descirption of the ..." alt="" coords="150,613,239,640"/>
<area shape="rect" id="node23" href="foo_8h.html#a1c6dbd2946a218d14cf553a59e41d189" title="spherical_volume(w) calculates the wind volume of cell allowing for the fact that some cells are part..." alt="" coords="142,664,247,691"/>
<area shape="rect" id="node24" href="cylindrical_8c.html#a13144d35b1d57cfa570b6e59d225f474" title="Calculates the wind volume for cells in a cylindrical domain allowing for the fact that some cells ar..." alt="" coords="149,461,240,488"/>
<area shape="rect" id="node27" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530" title="Translate a cell number in the wind to the two&#45;d grid position in a specific domain. " alt="" coords="499,588,577,615"/>
<area shape="rect" id="node30" href="foo_8h.html#a36f04216329e1a6ede98f9f9e0e3989b" title="Computes volumes for cells in an r&#45;theta hydro model. " alt="" coords="134,816,255,843"/>
<area shape="rect" id="node31" href="foo_8h.html#a16377719f4171d75f5aa983c79476590" title="rtheta_volume(w) calculates the wind volume of a cell in rtheta coordinate sysem allowing for the fac..." alt="" coords="149,867,240,893"/>
<area shape="rect" id="node32" href="cylind__var_8c.html#a95334daf522cc6a4ac43e85e759f4a31" title="w) calculates the wind volume of a cylindrical cell allowing for the fact that some cells ..." alt="" coords="149,259,240,285"/>
<area shape="rect" id="node35" href="wind2d_8c.html#a80e38cc8054ee669104c30986700d508" title="The routine basically just calls where_in_wind for each of the 4 corners of the cell. " alt="" coords="308,183,429,209"/>
<area shape="rect" id="node36" href="foo_8h.html#a391062d8b219dffc8496bd6fc8128cf6" title="Allocate memory for plasmamain, which contains temperature, densities, etc. for cells which are in th..." alt="" coords="152,1019,237,1045"/>
<area shape="rect" id="node37" href="foo_8h.html#a311078e4d3e5530a996283eaf4c0fb19" title="This subroutine allocates space for dynamic arrays in the plasma structure. " alt="" coords="141,1069,248,1096"/>
<area shape="rect" id="node38" href="foo_8h.html#a67af2cd841a922ea1001654449239284" title="Create a map between wind and plasma cells. " alt="" coords="155,1120,235,1147"/>
<area shape="rect" id="node39" href="foo_8h.html#a4b147244ba1a5d54d79a57a8ee665b18" title="Allocate memory to store information for macro atoms for each Plasma element. " alt="" coords="154,1171,235,1197"/>
<area shape="rect" id="node40" href="foo_8h.html#a43492c595dcd8568e2c14a8496c8fd43" title="Dynamically allocate various arrays in macromain. " alt="" coords="145,1221,244,1248"/>
<area shape="rect" id="node41" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="343,1576,395,1603"/>
<area shape="rect" id="node42" href="foo_8h.html#a3055ceed3869697bc2a3091fd0663900" title="model_rho" alt="" coords="160,1323,229,1349"/>
<area shape="rect" id="node43" href="foo_8h.html#a9bbb384b23069ca08613aa2396fcbee3" title="hydro_temp" alt="" coords="157,1373,232,1400"/>
<area shape="rect" id="node44" href="foo_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="147,1424,243,1451"/>
<area shape="rect" id="node45" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14" title="find the density of the wind at x " alt="" coords="519,1272,557,1299"/>
<area shape="rect" id="node47" href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221" title="wind_div_v" alt="" coords="159,1525,231,1552"/>
<area shape="rect" id="node51" href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="145,1728,244,1755"/>
<area shape="rect" id="node78" href="foo_8h.html#a655c28bba6dc25187e6173f6787364c4" title="Calculate the direction averaged (and maximum) dv_ds in each grid cell of the wind. " alt="" coords="162,1627,227,1653"/>
<area shape="rect" id="node79" href="foo_8h.html#aa5de177d6e8fc4d6d0becf0c2898b90d" title="Simple checks of the wind structure for reasonability. " alt="" coords="157,1677,232,1704"/>
<area shape="rect" id="node80" href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee" title="mdot_wind" alt="" coords="159,1475,230,1501"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1205,1364,1263,1391"/>
<area shape="rect" id="node9" href="foo_8h.html#a172ddeb06a81951700723a0b02d90557" title="Translate from the 2d element for an individual domain to the wind element number. " alt="" coords="330,385,407,412"/>
<area shape="rect" id="node11" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="821,1361,895,1388"/>
<area shape="rect" id="node12" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="952,1361,1041,1388"/>
<area shape="rect" id="node15" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="975,1412,1019,1439"/>
<area shape="rect" id="node13" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1104,1364,1143,1391"/>
<area shape="rect" id="node14" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1092,1313,1155,1340"/>
<area shape="rect" id="node19" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="346,335,391,361"/>
<area shape="rect" id="node25" href="foo_8h.html#af8c5f231035fc1a85000b9849b4fb0ed" title="fraction" alt="" coords="341,588,396,615"/>
<area shape="rect" id="node26" href="cylindrical_8c.html#aa06d3901560706877fe1b434a657e3d1" title="Check whether this cell is in the wind or not. " alt="" coords="309,537,429,564"/>
<area shape="rect" id="node29" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="661,436,750,463"/>
<area shape="rect" id="node28" href="foo_8h.html#a80e38cc8054ee669104c30986700d508" title="The routine basically just calls where_in_wind for each of the 4 corners of the cell. " alt="" coords="477,639,599,665"/>
<area shape="rect" id="node33" href="bilinear_8c.html#a0d7059db01a063789ca5b78386eb2889" title="calculates the fractional position in the coordinate grid of a 2d vector x. " alt="" coords="349,284,389,311"/>
<area shape="rect" id="node34" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="504,284,572,311"/>
<area shape="rect" id="node46" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3" title="coord_fraction" alt="" coords="663,1344,748,1371"/>
<area shape="rect" id="node48" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f" title="finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p..." alt="" coords="335,1475,403,1501"/>
<area shape="rect" id="node49" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="513,1424,563,1451"/>
<area shape="rect" id="node50" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="500,1576,576,1603"/>
<area shape="rect" id="node52" href="cooling_8c.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="342,1728,395,1755"/>
<area shape="rect" id="node53" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="678,1892,733,1919"/>
<area shape="rect" id="node54" href="direct__ion_8c.html#a56f9a736ea5fdd9b253e4a7fa07103ce" title="computes the total cooling due collisional ionization " alt="" coords="511,1627,565,1653"/>
<area shape="rect" id="node58" href="compton_8c.html#a560f4bd0619fdb29b85891d46ce63a48" title="computes the cooling in the cell due to inverse compton scattering. " alt="" coords="503,1677,573,1704"/>
<area shape="rect" id="node64" href="cooling_8c.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="493,1740,583,1767"/>
<area shape="rect" id="node55" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="653,1500,758,1527"/>
<area shape="rect" id="node56" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="957,1588,1036,1615"/>
<area shape="rect" id="node57" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="1089,1501,1157,1528"/>
<area shape="rect" id="node59" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="680,1639,731,1665"/>
<area shape="rect" id="node60" href="compton_8c.html#a2f793ca07e9f7ec0220090b8f6b73634" title="The integrand in the integral to obtain the total cooling rate due to inverse compton scattering..." alt="" coords="647,1588,764,1615"/>
<area shape="rect" id="node61" href="compton_8c.html#a5bffcc1725b11f5b35c37b406aaec263" title="The &#39;cooling&#39; cross section correction to Thompson. " alt="" coords="837,1588,879,1615"/>
<area shape="rect" id="node63" href="foo_8h.html#a687aa0dcc49f512e562c1e0afddc0263" title="returns a value for the mean intensity " alt="" coords="813,1513,903,1540"/>
<area shape="rect" id="node62" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="973,1537,1020,1564"/>
<area shape="rect" id="node65" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="657,1740,753,1767"/>
<area shape="rect" id="node69" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="658,1791,753,1817"/>
<area shape="rect" id="node75" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="673,1841,737,1868"/>
<area shape="rect" id="node77" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="652,1689,759,1716"/>
<area shape="rect" id="node66" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="831,1639,885,1665"/>
<area shape="rect" id="node67" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="823,1740,893,1767"/>
<area shape="rect" id="node68" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="827,1689,889,1716"/>
<area shape="rect" id="node70" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="839,1841,877,1868"/>
<area shape="rect" id="node71" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="812,1892,904,1919"/>
<area shape="rect" id="node72" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="839,1943,877,1969"/>
<area shape="rect" id="node73" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="839,1993,877,2020"/>
<area shape="rect" id="node74" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="825,1791,891,1817"/>
<area shape="rect" id="node76" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="829,2044,887,2071"/>
<area shape="rect" id="node81" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="349,1424,388,1451"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_icgraph.png" border="0" usemap="#wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_icgraph" alt=""/></div>
<map name="wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_icgraph" id="wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_icgraph">
<area shape="rect" id="node2" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="129,5,173,32"/>
</map>
</div>

</div>
</div>
<a id="af8f7fd3a6d5f7872ee87beb27dcba899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8f7fd3a6d5f7872ee87beb27dcba899">&#9670;&nbsp;</a></span>get_random_location()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_random_location </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>is simply will produce a postion at a random place in a cell n </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>n An element number in the wind structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>x[] The random location that is calculaed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This is really just a driver routine for coordinate system specific routines</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l01098">1098</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899_cgraph.png" border="0" usemap="#wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899_cgraph" alt=""/></div>
<map name="wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899_cgraph" id="wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899_cgraph">
<area shape="rect" id="node2" href="cylindrical_8c.html#ab19f6786630fce8ae46bbd702d80d59b" title="Generate a position at a random location within a specific cell of a domain with cylindrical coordina..." alt="" coords="169,56,316,83"/>
<area shape="rect" id="node7" href="foo_8h.html#a00bbfc05ca86bbb87a4c69019564af5d" title="rtheta_get_random_location" alt="" coords="169,157,316,184"/>
<area shape="rect" id="node8" href="foo_8h.html#a01eb12e765998d3b9b350b3d8834347f" title="spherical_get_random\l_location" alt="" coords="182,209,303,250"/>
<area shape="rect" id="node9" href="cylind__var_8c.html#a352d864e752cc2b9041a5e2ad1e5ffff" title="Generate a position at a random location within a specific cell of a domain with modified&#45;cylindrical..." alt="" coords="169,107,316,133"/>
<area shape="rect" id="node11" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="221,275,265,301"/>
<area shape="rect" id="node3" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="393,157,431,184"/>
<area shape="rect" id="node4" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530" title="Translate a cell number in the wind to the two&#45;d grid position in a specific domain. " alt="" coords="373,5,451,32"/>
<area shape="rect" id="node5" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="364,56,460,83"/>
<area shape="rect" id="node6" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="367,107,457,133"/>
<area shape="rect" id="node10" href="foo_8h.html#a829a331b30311e6768f4cc16a70fdab5" title="where_in_2dcell" alt="" coords="365,208,459,235"/>
<area shape="rect" id="node12" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="756,317,813,344"/>
<area shape="rect" id="node13" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="375,317,449,344"/>
<area shape="rect" id="node14" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="508,368,597,395"/>
<area shape="rect" id="node17" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="531,317,575,344"/>
<area shape="rect" id="node15" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="657,419,696,445"/>
<area shape="rect" id="node16" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="645,368,708,395"/>
</map>
</div>

</div>
</div>
<a id="a558bbf4d12656ab12c2a03f6475b0eee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a558bbf4d12656ab12c2a03f6475b0eee">&#9670;&nbsp;</a></span>mdot_wind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mdot_wind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l01011">1011</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_cgraph.png" border="0" usemap="#wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_cgraph" alt=""/></div>
<map name="wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_cgraph" id="wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_cgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14" title="find the density of the wind at x " alt="" coords="245,157,284,184"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="360,107,404,133"/>
<area shape="rect" id="node12" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="139,107,177,133"/>
<area shape="rect" id="node13" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="245,5,284,32"/>
<area shape="rect" id="node14" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f" title="finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p..." alt="" coords="124,208,192,235"/>
<area shape="rect" id="node3" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="337,157,427,184"/>
<area shape="rect" id="node11" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3" title="coord_fraction" alt="" coords="339,233,425,260"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="847,132,904,159"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="476,195,549,221"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="599,183,688,209"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="621,233,665,260"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="748,183,787,209"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="736,132,799,159"/>
<area shape="rect" id="node15" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="240,208,289,235"/>
<area shape="rect" id="node16" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="475,259,551,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_icgraph.png" border="0" usemap="#wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_icgraph" alt=""/></div>
<map name="wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_icgraph" id="wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="124,5,200,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="248,5,292,32"/>
</map>
</div>

</div>
</div>
<a id="a078472458c0ac73f723c094fc2121c14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a078472458c0ac73f723c094fc2121c14">&#9670;&nbsp;</a></span>rho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double rho </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find the density of the wind at x </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WindPtr</td><td>w The entire wind </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>x[] A position </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The density at x, if the postion is in the active region of the wind. If the postion is not in the active region of one of the domains, then 0 is returned. No error is reported for this</dd></dl>
<p>The routine first determines what domain the position is located in, and then intepolates to find the density at a specific position</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00941">941</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a078472458c0ac73f723c094fc2121c14_cgraph.png" border="0" usemap="#wind2d_8c_a078472458c0ac73f723c094fc2121c14_cgraph" alt=""/></div>
<map name="wind2d_8c_a078472458c0ac73f723c094fc2121c14_cgraph" id="wind2d_8c_a078472458c0ac73f723c094fc2121c14_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="92,5,181,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="115,56,159,83"/>
<area shape="rect" id="node10" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3" title="coord_fraction" alt="" coords="94,107,179,133"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="599,69,656,96"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="229,95,303,121"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="351,81,440,108"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="373,132,417,159"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="500,69,539,96"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="488,120,551,147"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a078472458c0ac73f723c094fc2121c14_icgraph.png" border="0" usemap="#wind2d_8c_a078472458c0ac73f723c094fc2121c14_icgraph" alt=""/></div>
<map name="wind2d_8c_a078472458c0ac73f723c094fc2121c14_icgraph" id="wind2d_8c_a078472458c0ac73f723c094fc2121c14_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="328,28,404,54"/>
<area shape="rect" id="node4" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f" title="finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p..." alt="" coords="92,28,160,54"/>
<area shape="rect" id="node6" href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee" title="mdot_wind" alt="" coords="209,78,279,105"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="452,28,496,54"/>
<area shape="rect" id="node5" href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221" title="wind_div_v" alt="" coords="208,28,280,54"/>
</map>
</div>

</div>
</div>
<a id="a7ca398a2557e2b63247eac4366bc2e4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ca398a2557e2b63247eac4366bc2e4f">&#9670;&nbsp;</a></span>vwind_xyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vwind_xyz </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p A photon </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>v[] The velocity at the postion given by phtoon??? </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on successful completion, or a negative number if photon position is not in the in the grid for the domain of interest.</dd></dl>
<p>This routine carries out a bilinear interpolation of the wind velocity. The velocities at the edges of the grid cells must have been defined elsewhere (e.g in wind_define).</p>
<p>If the position is outside the wind grid, then the velocities will be returned as 0.</p>
<h3>Notes</h3>
<p>For all of the 2d coordinate systems, the positions in the WindPtr array are calculated in the xz plane. As a result, the velocities in that array are calcuated there as well. Hence, to obtain the velocity in cartesion coordinates one needs to do a simple rotation of the velocity vector.</p>
<p>For spherical (1d) coordinates the situation is complex, the philosopy that has been adopted is to let the program run as if the wind model is intrinsically 2d. The xyz positions of the grid are defined are defined so that are in the xz plane at an angle of 45 degrees to the x axis. This was done so that if one used, say an sv wind, in spherical coordinates, one would select the wind velocities at a plausible location. But it implies that the velocities that have been accepted are not purely radial as one might expect. The choice that has been made is to assume that v[1] is preserved as a non zero value in making the projection. An alternative might have been to preserve the angular rotation rate.</p>
<p>If we ever implement a real 3d coordinate system, one will need to look at this routine again. </p>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00742">742</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_cgraph.png" border="0" usemap="#wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_cgraph" alt=""/></div>
<map name="wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_cgraph" id="wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_cgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14" title="find the density of the wind at x " alt="" coords="127,107,165,133"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="241,157,285,184"/>
<area shape="rect" id="node11" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3" title="coord_fraction" alt="" coords="221,56,306,83"/>
<area shape="rect" id="node12" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="121,157,171,184"/>
<area shape="rect" id="node13" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="356,5,432,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="219,107,308,133"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="728,107,785,133"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="357,56,431,83"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="480,56,569,83"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="503,5,547,32"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="629,107,668,133"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="617,56,680,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_icgraph.png" border="0" usemap="#wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_icgraph" alt=""/></div>
<map name="wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_icgraph" id="wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221" title="wind_div_v" alt="" coords="121,5,193,32"/>
<area shape="rect" id="node5" href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee" title="mdot_wind" alt="" coords="122,56,193,83"/>
<area shape="rect" id="node3" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="241,31,317,57"/>
<area shape="rect" id="node4" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="365,31,409,57"/>
</map>
</div>

</div>
</div>
<a id="ad4b676b9911462eec0740df5f8f0da55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b676b9911462eec0740df5f8f0da55">&#9670;&nbsp;</a></span>where_in_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int where_in_grid </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>locates the element in wmain associated with a postion </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain number for the search </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] The position </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>where_in_grid normally returns the element in wmain associated with a position. If the positions is in the grid (of one of the domains) this will be a positive integer. If the position is not in the grid of one of the domains, a negative number -1 will be returned if the position is inside athe grid, -2 if it is outside the grid for that domain</dd></dl>
<h3>Notes</h3>
<p>where in grid is mainly a steering routine that calls other various coordinate system specific routines.</p>
<p>Where_in grid does not tell you whether the position is in the wind!.</p>
<p>What one means by inside or outside the grid may well be different for different coordinate systems.</p>
<p>This is one of the routines in Python that has a long history, in that it existed prior to the implementation of domains. This is why it returns the position in wmain, rather than the position in one of the plasma domains. It would make sense to revise this. </p>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00593">593</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_ad4b676b9911462eec0740df5f8f0da55_cgraph.png" border="0" usemap="#wind2d_8c_ad4b676b9911462eec0740df5f8f0da55_cgraph" alt=""/></div>
<map name="wind2d_8c_ad4b676b9911462eec0740df5f8f0da55_cgraph" id="wind2d_8c_ad4b676b9911462eec0740df5f8f0da55_cgraph">
<area shape="rect" id="node2" href="cylindrical_8c.html#a88a4510bced469b493b0a16a8b2308ba" title="locates the grid position of the vector, when one is using cylindrical coordinates. " alt="" coords="146,56,262,83"/>
<area shape="rect" id="node5" href="foo_8h.html#a711aa1dc0e92eff62111bf90e2a6b89e" title="rtheta_where_in_grid" alt="" coords="146,208,262,235"/>
<area shape="rect" id="node6" href="foo_8h.html#a7406e8182dece78e2612793e400d1540" title="spherical_where_in_grid" alt="" coords="139,259,269,285"/>
<area shape="rect" id="node7" href="cylind__var_8c.html#a32c03e10ad1712cb98a72b444cca5499" title="locates the grid position of the vector, when one is using modified cylindrical coordinates, with the z heights varying. " alt="" coords="146,107,262,133"/>
<area shape="rect" id="node9" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="343,157,387,184"/>
<area shape="rect" id="node3" href="foo_8h.html#af8c5f231035fc1a85000b9849b4fb0ed" title="fraction" alt="" coords="337,5,392,32"/>
<area shape="rect" id="node4" href="foo_8h.html#a172ddeb06a81951700723a0b02d90557" title="Translate from the 2d element for an individual domain to the wind element number. " alt="" coords="326,56,403,83"/>
<area shape="rect" id="node8" href="foo_8h.html#a829a331b30311e6768f4cc16a70fdab5" title="where_in_2dcell" alt="" coords="317,107,412,133"/>
<area shape="rect" id="node10" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="829,132,887,159"/>
<area shape="rect" id="node11" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="460,183,533,209"/>
<area shape="rect" id="node12" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="581,157,671,184"/>
<area shape="rect" id="node15" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="604,208,648,235"/>
<area shape="rect" id="node13" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="731,132,769,159"/>
<area shape="rect" id="node14" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="719,183,781,209"/>
</map>
</div>

</div>
</div>
<a id="ad47569135f21d4ce22504b0ad5b0b221"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad47569135f21d4ce22504b0ad5b0b221">&#9670;&nbsp;</a></span>wind_div_v()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wind_div_v </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00846">846</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_cgraph.png" border="0" usemap="#wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_cgraph" alt=""/></div>
<map name="wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_cgraph" id="wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="133,5,185,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="361,107,405,133"/>
<area shape="rect" id="node10" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f" title="finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p..." alt="" coords="125,183,193,209"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="848,157,905,184"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="477,220,551,247"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="600,208,689,235"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="623,259,667,285"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="749,157,788,184"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="737,208,800,235"/>
<area shape="rect" id="node11" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14" title="find the density of the wind at x " alt="" coords="247,157,285,184"/>
<area shape="rect" id="node13" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3" title="coord_fraction" alt="" coords="341,208,426,235"/>
<area shape="rect" id="node14" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="241,259,291,285"/>
<area shape="rect" id="node15" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="476,284,552,311"/>
<area shape="rect" id="node12" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="339,157,428,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_icgraph.png" border="0" usemap="#wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_icgraph" alt=""/></div>
<map name="wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_icgraph" id="wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="125,5,201,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="249,5,293,32"/>
</map>
</div>

</div>
</div>
<a id="a675b4d912b5b505f099fc17031660393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a675b4d912b5b505f099fc17031660393">&#9670;&nbsp;</a></span>zero_scatters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zero_scatters </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>zero out the portion of plasmamain that records the number of scatters in each cell </p>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<h3>Notes</h3>
<p>The routine is called at the point where we begin to calculate the detailed spectrum. It's a little unclear why it is simply not incorporated into spectrum_init </p>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l01151">1151</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="wind2d_8c_a675b4d912b5b505f099fc17031660393_icgraph.png" border="0" usemap="#wind2d_8c_a675b4d912b5b505f099fc17031660393_icgraph" alt=""/></div>
<map name="wind2d_8c_a675b4d912b5b505f099fc17031660393_icgraph" id="wind2d_8c_a675b4d912b5b505f099fc17031660393_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="136,5,221,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad318f8972d3832930303d84e94599a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad318f8972d3832930303d84e94599a89">&#9670;&nbsp;</a></span>ierr_vwind</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ierr_vwind = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00699">699</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>

</div>
</div>
<a id="ae1705b3b8167c7d811573af4a3bd063d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1705b3b8167c7d811573af4a3bd063d">&#9670;&nbsp;</a></span>wig_n</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wig_n</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00558">558</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>

</div>
</div>
<a id="a85d6497ec425ae7ad645123ecd08851b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85d6497ec425ae7ad645123ecd08851b">&#9670;&nbsp;</a></span>wig_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double wig_x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00559">559</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>

</div>
</div>
<a id="a44ecbd1b141d80e28463cf7da2bc94c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ecbd1b141d80e28463cf7da2bc94c7">&#9670;&nbsp;</a></span>wig_y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double wig_y</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00559">559</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>

</div>
</div>
<a id="ab087c671695d8b903dc431a91b0d85da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab087c671695d8b903dc431a91b0d85da">&#9670;&nbsp;</a></span>wig_z</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double wig_z</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00559">559</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>

</div>
</div>
<a id="a8fe8eb8bacb888783ada9dd32b523e1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fe8eb8bacb888783ada9dd32b523e1a">&#9670;&nbsp;</a></span>wind_div_err</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wind_div_err = (-3)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the divergence of the velocity at the center of all the grid cells. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WindPtr</td><td>w The entire wind domain </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The results are stored in wmain[].div_v</p>
<p>This is one of the initialization routines for the wind. The divergence of velocity of the wind is used to calculated PdV cooling of a grid cell</p>
<h3>Notes</h3>
<p>Because the routine calls vwind_xyz, one must have previously populated w[].v. Also as a result of this fact, the routine is not tightly tied to any particular wind model.</p>
<p>The divergence, like othe scalar quantities, does not need to be "rotated" differently in different coordinate systems</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000063">Bug:</a></b></dt><dd>This routine mixes wmain (which is passed externally) and w which is passed by calling it. While this does not generate an error it should be cleaned up, proably to use only wmain</dd></dl>

<p class="definition">Definition at line <a class="el" href="wind2d_8c_source.html#l00843">843</a> of file <a class="el" href="wind2d_8c_source.html">wind2d.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="wind2d_8c.html">wind2d.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
