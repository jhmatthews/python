<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/wind_updates2d.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('wind__updates2d_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">wind_updates2d.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="wind__updates2d_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/***********************************************************/</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="atomic_8h.html">atomic.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="python_8h.html">python.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="wind__updates2d_8c.html#a764eaf37b6117ac7a17b1c049c1d2d16">   22</a></span>&#160;<span class="preprocessor">#define LINELEN 256</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="wind__updates2d_8c.html#a3c086b2e71aab221283031cdd9ae00ba">   26</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="wind__updates2d_8c.html#a3c086b2e71aab221283031cdd9ae00ba">num_updates</a> = 0;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="wind__updates2d_8c.html#a33b6675f8fdb790ed332fd9f5df994d3">   62</a></span>&#160;<a class="code" href="wind__updates2d_8c.html#a33b6675f8fdb790ed332fd9f5df994d3">wind_update</a> (<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<a class="code" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> (<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">int</span> n, <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>, <a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">double</span> trad, nh;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">/*1108 NSH csum added to sum compton heating 1204 NSH icsum added to sum induced compton heating */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordtype">double</span> wtest, xsum, psum, fsum, lsum, csum, icsum, ausum;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordtype">double</span> cool_sum,lum_sum; <span class="comment">//1706 - the total cooling and luminosity of the wind</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">double</span> apsum,aausum,abstot; <span class="comment">//Absorbed photon energy from PI and auger</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">double</span> c_rec, n_rec, o_rec, fe_rec;   <span class="comment">//1701- NSH more outputs to show cooling from a few other elements</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">double</span> c_lum, n_lum, o_lum, fe_lum;   <span class="comment">//1708- NSH and luminosities as well</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">double</span> cool_dr_metals;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">int</span> nn;                       <span class="comment">//1701 - loop variable to compute recomb cooling</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">double</span> volume;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">double</span> vol;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">char</span> <span class="keywordtype">string</span>[<a class="code" href="wind__updates2d_8c.html#a764eaf37b6117ac7a17b1c049c1d2d16">LINELEN</a>];</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">double</span> t_r_old, t_e_old, dt_r, dt_e;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">double</span> t_r_ave_old, t_r_ave, t_e_ave_old, t_e_ave;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">int</span> iave, nmax_r, nmax_e;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">int</span> nplasma, nstart;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">int</span> nwind;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> first, last, m;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">double</span> tot, agn_ip;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">double</span> lum_h_line,lum_he_line,lum_c_line,lum_n_line,lum_o_line,lum_fe_line;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">double</span> h_dr,he_dr,c_dr,n_dr,o_dr,fe_dr;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> my_nmin, my_nmax;         <span class="comment">//Note that these variables are still used even without MPI on</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> ndom;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  FILE *fptr, *fopen ();        <span class="comment">/*This is the file to communicate with zeus */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span> num_mpi_cells, num_mpi_extra, position, ndo, n_mpi, num_comm, n_mpi2;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">int</span> size_of_commbuffer;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">char</span> *commbuffer;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">/* JM 1409 -- Added for issue #110 to ensure correct reporting in parallel */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> nmax_r_temp, nmax_e_temp;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">double</span> dt_e_temp, dt_r_temp;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">/* the commbuffer needs to be larger enough to pack all variables in MPI_Pack and MPI_Unpack routines NSH 1407 - the</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">     NIONS changed to nions for the 12 arrays in plasma that are now dynamically allocated</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  NSH 1703 changed NLTE_LEVELS to nlte_levels  and NTOP_PHOT to nphot_tot since they are dynamically allocated now */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  size_of_commbuffer =</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//OLD    8 * (13 * nions + nlte_levels + 2 * nphot_total + 12 * NXBANDS + 2 * LPDF + NAUGER + 113) * (floor (NPLASMA / np_mpi_global) + 1);</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    8 * (13 * <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a> + <a class="code" href="atomic_8h.html#a28554dc87ad01f4e71464455b2a3f31d">nlte_levels</a> + 2 * <a class="code" href="atomic_8h.html#a15a303809550342a407548de2ef7c245">nphot_total</a> + 12 * <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a> + 113) * (floor (<a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a> / <a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a>) + 1);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  commbuffer = (<span class="keywordtype">char</span> *) malloc (size_of_commbuffer * <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">/* JM 1409 -- Initialise parallel only variables */</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  nmax_r_temp = nmax_e_temp = -1;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  dt_e_temp = dt_r_temp = 0.0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  dt_r = dt_e = 0.0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  iave = 0;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  nmax_r = nmax_e = -1;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  t_r_ave_old = t_r_ave = t_e_ave_old = t_e_ave = 0.0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">/* For MPI parallelisation, the following loop will be distributed over mutiple tasks.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">     Note that the mynmim and mynmax variables are still used even without MPI on */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  my_nmin = 0;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  my_nmax = <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  num_mpi_cells = floor (<a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a> / <a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  num_mpi_extra = <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a> - (<a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a> * num_mpi_cells);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">/* this section distributes the remainder over the threads if the cells</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">     do not divide evenly by thread */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> &lt; num_mpi_extra)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    my_nmin = <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> * (num_mpi_cells + 1);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    my_nmax = (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> + 1) * (num_mpi_cells + 1);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    my_nmin = num_mpi_extra * (num_mpi_cells + 1) + (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> - num_mpi_extra) * (num_mpi_cells);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    my_nmax = num_mpi_extra * (num_mpi_cells + 1) + (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> - num_mpi_extra + 1) * (num_mpi_cells);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  ndo = my_nmax - my_nmin;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">/* Before we do anything let&#39;s record the average tr and te from the last cycle */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">/* JM 1409 -- Added for issue #110 to ensure correct reporting in parallel */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; n++)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    t_r_ave_old += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    t_e_ave_old += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">/* we now know how many cells this thread has to process - note this will be</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">     0-NPLASMA in serial mode */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">for</span> (n = my_nmin; n &lt; my_nmax; n++)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    nwind = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">nwind</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    volume = <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[nwind].vol;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">/* Start with a call to the routine which normalises all the macro atom</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">       monte carlo radiation field estimators. It&#39;s best to do this first since</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">       some of the estimators include temperature terms (stimulated correction</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">       terms) which were included during the monte carlo simulation so we want</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">       to be sure that the SAME temperatures are used here. (SS - Mar 2004). */</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">rt_mode</a> == <a class="code" href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a> &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac453ab1a6ed3b90674cd6552c0185bff">macro_simple</a> == 0)      <span class="comment">//test for macro atoms</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="estimators_8c.html#a0b0bdb47e266cd31f1c381bb2410fa80">mc_estimator_normalise</a> (nwind);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#a22a281cdcc628db94cb49e1596802c2f">kpkt_rates_known</a> = -1;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">/* Store some information so one can determine how much the temps are changing */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    t_r_old = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    t_e_old = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    iave++;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot &lt; 100)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        (<span class="stringliteral">&quot;!!wind_update: Cell %4d Dom %d  Vol. %8.2e r %8.2e theta %8.2e has only %4d photons\n&quot;</span>,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;         n, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[nwind].ndom, volume, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[nwind].rcen, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[nwind].thetacen, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot &gt; 0)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      wtest = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9ef4bb2909c072cb6155880d3114c95f">ave_freq</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9ef4bb2909c072cb6155880d3114c95f">ave_freq</a> /= <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a81aa2849c8ad883b8b23ca7a5e7b7c2f">j</a>;        <span class="comment">/* Normalization to frequency moment */</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ave_freq))</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check %d ave_freq %e j %e ntot %d\n&quot;</span>, n, wtest, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a81aa2849c8ad883b8b23ca7a5e7b7c2f">j</a> /= (4. * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * volume);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a3a6771031add8ed4970ea0a051ae3751">j_direct</a> /= (4. * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * volume);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ab48f9178fc1c8be99c96d9a33d19f2a9">j_scatt</a> /= (4. * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * volume);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      trad = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a> = <a class="code" href="atomic_8h.html#abec92cc72a096640b821b8cd56a02495">H</a> * <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9ef4bb2909c072cb6155880d3114c95f">ave_freq</a> / (<a class="code" href="atomic_8h.html#aa1487dae81baa2e0a5643e7b571633a0">BOLTZMANN</a> * 3.832);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#adbf9689b61e3df7611084d858b3115c0">w</a> = <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a81aa2849c8ad883b8b23ca7a5e7b7c2f">j</a> / (<a class="code" href="atomic_8h.html#ad4e561a62bce83b8233ceb954b7c8988">STEFAN_BOLTZMANN</a> * trad * trad * trad * trad);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a> &gt; 1e10)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update: Huge w %8.2e in cell %d trad %10.2e j %8.2e\n&quot;</span>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>, n, trad, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (trad) || <a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>))</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check %d trad %8.2e w %8.2g\n&quot;</span>, n, trad, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].w);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update: ave_freq %8.2e j %8.2e\n&quot;</span>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ave_freq, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        exit (0);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    {                           <span class="comment">/* It is not clear what to do with no photons in a cell */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a81aa2849c8ad883b8b23ca7a5e7b7c2f">j</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a3a6771031add8ed4970ea0a051ae3751">j_direct</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ab48f9178fc1c8be99c96d9a33d19f2a9">j_scatt</a> = 0;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      trad = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a> *= 0.7;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e &lt; <a class="code" href="python_8h.html#a2522d2568f63855838c3ecfb44084710">MIN_TEMP</a>)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a> = <a class="code" href="python_8h.html#a2522d2568f63855838c3ecfb44084710">MIN_TEMP</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#adbf9689b61e3df7611084d858b3115c0">w</a> = 0;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">/* Calculate the frequency banded j and ave_freq variables */</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ae7fb58fc78cd9fa02941f1996777efeb">nxfreq</a>; i++)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {                           <span class="comment">/*loop over number of bands */</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nxtot[i] &gt; 0)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      {                         <span class="comment">/*Check we actually have some photons in the cell in this band */</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ae72cc720bc175444504be8f75d02e4c4">xave_freq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] /= <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#abded068048bfaf274478a65b26388ed5">xj</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>];      <span class="comment">/*Normalise the average frequency */</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af6eca6f64a123edc0389b42ace886569">xsd_freq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] /= <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#abded068048bfaf274478a65b26388ed5">xj</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>];       <span class="comment">/*Normalise the mean square frequency */</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af6eca6f64a123edc0389b42ace886569">xsd_freq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = sqrt (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xsd_freq[i] - (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xave_freq[i] * <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xave_freq[i]));       <span class="comment">/*Compute standard deviation */</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#abded068048bfaf274478a65b26388ed5">xj</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] /= (4 * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * volume);       <span class="comment">/*Convert to radiation density */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#abded068048bfaf274478a65b26388ed5">xj</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0;        <span class="comment">/*If no photons, set both radiation estimators to zero */</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ae72cc720bc175444504be8f75d02e4c4">xave_freq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af6eca6f64a123edc0389b42ace886569">xsd_freq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0;  <span class="comment">/*NSH 120815 and also the SD ???? */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">/* 1108 NSH End of loop */</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    nh = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> * <a class="code" href="atomic_8h.html#a9dc9286373de87e475724fbd5e8c0435">rho2nh</a>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">/* 1110 NSH Normalise IP, which at this point should be</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> * the number of photons in a cell by dividing by volume</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> * and number density of hydrogen in the cell</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> * */</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a1ac56fc73e1242bfa9cbb9bfa04e6d38">ip</a> /= (<a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> * volume * nh);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#acf74d2b82ce1f94cd72b38b432f68774">ip_direct</a> /= (<a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> * volume * nh);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ac2985029f1cc2e4bd9a511c7c4ff5db9">ip_scatt</a> /= (<a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> * volume * nh);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">/* 1510 NSH Normalise xi, which at this point should be the luminosity of ionizing photons in a cell (just the sum of photon weights) */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af8986403a916d5a9f4330ae70aa5e798">xi</a> *= 4. * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af8986403a916d5a9f4330ae70aa5e798">xi</a> /= (volume * nh);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">/* If geo.adiabatic is true, then alculate the adiabatic cooling using the current, i.e</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">     * previous value of t_e.  Note that this may not be  best way to determien the cooling.</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">     * Changes made here should also be reflected in wind2d.c.  At present, adiabatic colling</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">     * is not included in updates to the temperature, even if the adiabatic cooling is calculated</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">     * here. 04nov -- ksl</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">     * 05apr -- ksl -- The index being used was incorrect.  This has been fixed now</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">     * 11sep -- nsh -- The index for the wind (&amp;w) for adiabatic cooling was incorrect -</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">     * was being called with the plasma cell rather than the approriate wind cell - fixed</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">     * old: adiabatic_cooling (&amp;w[n], plasmamain[n].t_e);</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a4f5794e0b4b6ed3e93a1cbd284132a17">adiabatic</a>)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#acf37090e0b83fe81d058f21229a90018">cool_adiabatic</a> = <a class="code" href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604">adiabatic_cooling</a> (&amp;<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[nwind], <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#acf37090e0b83fe81d058f21229a90018">cool_adiabatic</a> = 0.0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">/* Calculate the densities in various ways depending on the ioniz_mode */</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="foo_8h.html#a626b1882e2533441cdf2daabd36e8a8b">ion_abundances</a> (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n], <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a98d8096a2c1b3144efd5899f25402f7d">ioniz_mode</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">/* Perform checks to see how much temperatures have changed in this iteration */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> ((fabs (t_r_old - <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_r)) &gt; fabs (dt_r))</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      dt_r = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a> - t_r_old;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      nmax_r = n;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span> ((fabs (t_e_old - <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e)) &gt; fabs (dt_e))</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      dt_e = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a> - t_e_old;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      nmax_e = n;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    t_r_ave += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    t_e_ave += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">/*This is the end of the update loop that is parallised. We now need to exchange data between the tasks. */</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">for</span> (n_mpi = 0; n_mpi &lt; <a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a>; n_mpi++)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    position = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> == n_mpi)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;MPI task %d is working on cells %d to max %d (total size %d).\n&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>, my_nmin, my_nmax, NPLASMA);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      MPI_Pack (&amp;ndo, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">for</span> (n = my_nmin; n &lt; my_nmax; n++)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        MPI_Pack (&amp;n, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nwind, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nplasma, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ne, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="import__cylindrical_8c.html#adfeea8320d4abaf47212f89ee8f52582">rho</a>, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].vol, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].density, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].partition, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].levden, <a class="code" href="atomic_8h.html#a28554dc87ad01f4e71464455b2a3f31d">nlte_levels</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWdenom, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWdtemp, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWnumer, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWntemp, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kappa_ff_factor, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nscat_es, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].recomb_simple, <a class="code" href="atomic_8h.html#a15a303809550342a407548de2ef7c245">nphot_total</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kpkt_emiss, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kpkt_abs, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kbf_use, <a class="code" href="atomic_8h.html#a15a303809550342a407548de2ef7c245">nphot_total</a>, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kbf_nuse, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_r, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_r_old, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e_old, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].dt_e, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].dt_e_old, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_tot, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].abs_tot, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_tot_old, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_lines, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_ff, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_comp, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_ind_comp, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_lines_macro, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_photo_macro, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_photo, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_auger, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].abs_photo, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].abs_auger, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_z, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_star, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_bl, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_disk, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_wind, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_agn, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].mean_ds, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].n_ds, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nrad, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nioniz, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ioniz, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].recomb, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].scatters, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xscatters, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_ion, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_ion, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr_ion, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j_direct, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j_scatt, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ave_freq, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_tot, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xj, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xave_freq, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xsd_freq, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nxtot, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].max_freq, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="foo_8h.html#a0018131577a59a5142e3677785504d37">lum_lines</a>, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_ff, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_adiabatic, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].comp_nujnu, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_comp, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_dr, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_di, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_metals, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr_metals, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_tot, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_tot_old, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_tot_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_lines_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_ff_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_adiabatic_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_comp_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_dr_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_di_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_metals_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_tot_ioniz, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].dmo_dt, 3, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//OLD        MPI_Pack (&amp;plasmamain[n].npdf, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">//OLD        MPI_Pack (plasmamain[n].pdf_x, LPDF, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">//OLD        MPI_Pack (plasmamain[n].pdf_y, LPDF, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].gain, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_t_r, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_t_e, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_hc, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].trcheck, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].techeck, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].hccheck, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_whole, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converging, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">//OLD        MPI_Pack (plasmamain[n].gamma_inshl, NAUGER, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].spec_mod_type, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].pl_alpha, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="foo_8h.html#abba07de067655328106ec96798c4794d">pl_log_w</a>, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].exp_temp, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="foo_8h.html#ad6d1b9b9650b2f9e2f3bd72bfb5e5382">exp_w</a>, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].fmin_mod, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        MPI_Pack (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].fmax_mod, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">//OLD        MPI_Pack (&amp;plasmamain[n].sim_ip, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">//OLD        MPI_Pack (&amp;plasmamain[n].ferland_ip, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ip, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ip_direct, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ip_scatt, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        MPI_Pack (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xi, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        MPI_Pack (&amp;dt_e, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        MPI_Pack (&amp;dt_r, 1, MPI_DOUBLE, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        MPI_Pack (&amp;nmax_e, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        MPI_Pack (&amp;nmax_r, 1, MPI_INT, commbuffer, size_of_commbuffer, &amp;position, MPI_COMM_WORLD);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;MPI task %d broadcasting plasma update information.\n&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    MPI_Barrier (MPI_COMM_WORLD);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    MPI_Bcast (commbuffer, size_of_commbuffer, MPI_PACKED, n_mpi, MPI_COMM_WORLD);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    MPI_Barrier (MPI_COMM_WORLD);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;MPI task %d survived broadcasting plasma update information.\n&quot;</span>, <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    position = 0;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> != n_mpi)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;num_comm, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">for</span> (n_mpi2 = 0; n_mpi2 &lt; num_comm; n_mpi2++)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;n, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nwind, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nplasma, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ne, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="import__cylindrical_8c.html#adfeea8320d4abaf47212f89ee8f52582">rho</a>, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].vol, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].density, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].partition, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].levden, <a class="code" href="atomic_8h.html#a28554dc87ad01f4e71464455b2a3f31d">nlte_levels</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWdenom, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWdtemp, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWnumer, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].PWntemp, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kappa_ff_factor, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nscat_es, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].recomb_simple, <a class="code" href="atomic_8h.html#a15a303809550342a407548de2ef7c245">nphot_total</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kpkt_emiss, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kpkt_abs, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kbf_use, <a class="code" href="atomic_8h.html#a15a303809550342a407548de2ef7c245">nphot_total</a>, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].kbf_nuse, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_r, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_r_old, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e_old, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].dt_e, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].dt_e_old, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_tot, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].abs_tot, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_tot_old, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_lines, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_ff, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_comp, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_ind_comp, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_lines_macro, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_photo_macro, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_photo, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_auger, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].abs_photo, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].abs_auger, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_z, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_star, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_bl, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_disk, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_wind, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ntot_agn, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].mean_ds, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].n_ds, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nrad, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nioniz, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ioniz, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].recomb, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].scatters, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xscatters, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].heat_ion, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_ion, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr_ion, <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j_direct, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].j_scatt, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ave_freq, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_tot, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xj, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xave_freq, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xsd_freq, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].nxtot, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].max_freq, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="foo_8h.html#a0018131577a59a5142e3677785504d37">lum_lines</a>, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_ff, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_adiabatic, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].comp_nujnu, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_comp, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_dr, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_di, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_metals, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr_metals, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_tot, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_tot_old, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_tot_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_lines_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_ff_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_adiabatic_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_comp_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_dr_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_di_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_rr_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].cool_rr_metals_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].lum_tot_ioniz, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].dmo_dt, 3, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">//OLD        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;plasmamain[n].npdf, 1, MPI_INT, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">//OLD        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, plasmamain[n].pdf_x, LPDF, MPI_INT, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">//OLD        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, plasmamain[n].pdf_y, LPDF, MPI_DOUBLE, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].gain, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_t_r, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_t_e, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_hc, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].trcheck, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].techeck, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].hccheck, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converge_whole, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].converging, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">//OLD        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, plasmamain[n].gamma_inshl, NAUGER, MPI_DOUBLE, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].spec_mod_type, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].pl_alpha, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="foo_8h.html#abba07de067655328106ec96798c4794d">pl_log_w</a>, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].exp_temp, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="foo_8h.html#ad6d1b9b9650b2f9e2f3bd72bfb5e5382">exp_w</a>, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].fmin_mod, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].fmax_mod, <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">//OLD        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;plasmamain[n].sim_ip, 1, MPI_DOUBLE, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">//OLD        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;plasmamain[n].ferland_ip, 1, MPI_DOUBLE, MPI_COMM_WORLD);</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ip, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ip_direct, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].ip_scatt, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].xi, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;dt_e_temp, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;dt_r_temp, 1, MPI_DOUBLE, MPI_COMM_WORLD);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;nmax_e_temp, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        MPI_Unpack (commbuffer, size_of_commbuffer, &amp;position, &amp;nmax_r_temp, 1, MPI_INT, MPI_COMM_WORLD);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment">/* JM 1409 -- Altered for issue #110 to ensure correct reporting in parallel */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">if</span> (fabs (dt_e_temp) &gt;= fabs (dt_e))</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="comment">/* Check if any other threads found a higher maximum for te */</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          dt_e = dt_e_temp;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          nmax_e = nmax_e_temp;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span> (fabs (dt_r_temp) &gt;= fabs (dt_r))</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          <span class="comment">/* Check if any other threads found a higher maximum for tr */</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          dt_r = dt_r_temp;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          nmax_r = nmax_r_temp;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        t_r_ave += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        t_e_ave += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        iave++;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  free (commbuffer);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">/* Now we need to updated the densities immediately outside the wind so that the density interpolation in resonate will work.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">     In this case all we have done is to copy the densities from the cell which is just in the wind (as one goes outward) to the</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">     cell that is just inside (or outside) the wind.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">     SS asked whether we should also be extending the wind for other parameters, especially ne.  At present we do not interpolate</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">     on ne so this is not necessary.  If we did do that it would be required.</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">     In cylindrical coordinates, the fast dimension is z; grid positions increase up in z, and then out in r.</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">     In spherical polar coordinates, the fast dimension is theta; the grid increases in theta (measured)</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">     from the z axis), and then in r.</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">     In spherical coordinates, the grid increases as one might expect in r..</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a>)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="cylindrical_8c.html#ac1669c1045ab41daf35de34f56dd9737">cylind_extend_density</a> (ndom, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495">RTHETA</a>)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <a class="code" href="foo_8h.html#ad06961b0435b7c8b175189291537c20c">rtheta_extend_density</a> (ndom, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>)</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="foo_8h.html#a6c5300254db561924aba1c13186be975">spherical_extend_density</a> (ndom, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3">CYLVAR</a>)</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <a class="code" href="cylind__var_8c.html#a2ec3f5fd8390071adf98cdaee7afb064">cylvar_extend_density</a> (ndom, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;Wind_update2d: Unknown coordinate type %d for domain %d \n&quot;</span>, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type, ndom);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      exit (0);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">/* Finished updating region outside of wind */</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="wind__updates2d_8c.html#a3c086b2e71aab221283031cdd9ae00ba">num_updates</a>++;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  strcpy (<span class="keywordtype">string</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  sprintf (<span class="keywordtype">string</span>, <span class="stringliteral">&quot;# Wind update: Number %d&quot;</span>, <a class="code" href="wind__updates2d_8c.html#a3c086b2e71aab221283031cdd9ae00ba">num_updates</a>);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">zeus_connect</a> == 1 &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9e4e74de249210566125f8254f468184">hydro_domain_number</a> &gt; -1)  <span class="comment">//If we are running in zeus connect mode - we open a file for heatcool rates</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Outputting heatcool file for connecting to zeus\n&quot;</span>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    fptr = fopen (<span class="stringliteral">&quot;py_heatcool.dat&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    fprintf (fptr, <span class="stringliteral">&quot;i j rcen thetacen vol temp xi ne heat_xray heat_comp heat_lines heat_ff cool_comp cool_lines cool_ff rho n_h\n&quot;</span>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">/* Check the balance between the absorbed and the emitted flux */</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">//NSH 0717 - first we need to ensure the cooling and luminosities reflect the current temperature</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  cool_sum = <a class="code" href="cooling_8c.html#a2a31b4c75dc8f482609abe7b1618a97b">wind_cooling</a> (0.0, <a class="code" href="atomic_8h.html#ad8512644399ac6ec00af8f727bb4fac6">VERY_BIG</a>);       <span class="comment">/*We call wind_cooling here to obtain an up to date set of cooling rates */</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  lum_sum = <a class="code" href="emission_8c.html#ae1d27b840ad2ff21462921fc2aab975c">wind_luminosity</a> (0.0, <a class="code" href="atomic_8h.html#ad8512644399ac6ec00af8f727bb4fac6">VERY_BIG</a>);       <span class="comment">/*and we also call wind_luminosity to get the luminosities */</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  xsum = psum = ausum = lsum = fsum = csum = icsum = apsum = aausum = abstot = 0; <span class="comment">//1108 NSH zero the new csum counter for compton heating</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">for</span> (nplasma = 0; nplasma &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; nplasma++)</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_tot))</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_tot is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_tot);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_photo))</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_photo is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_photo);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_auger))</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_auger is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_auger);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_photo_macro))</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_photo_macro is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_photo_macro);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_ff))</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_ff is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_ff);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_lines))</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_lines is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_lines);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_lines_macro))</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_lines_macro is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_lines_macro);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">/* 1108 NSH extra Sane check for compton heating */</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_comp))</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_update:sane_check w(%d).heat_comp is %e\n&quot;</span>, nplasma, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_comp);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    abstot += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a671e4d660694e4fef07580536f729bfb">abs_tot</a>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    xsum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a2ed3e67409c1f55ca66cb0cbfbc39ac2">heat_tot</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    psum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a2878212449ef25989225a975f81679fd">heat_photo</a>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    ausum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a878263d85482a81865eb7619b3b2a20e">heat_auger</a>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    fsum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#aadd0d71f61d6ed95a48af999a14784e0">heat_ff</a>;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    lsum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ab2b017d6fa0e646a4a1d880d49914ef2">heat_lines</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    csum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ac6e1f1f8827b1bc1a68a437e1e58b001">heat_comp</a>;      <span class="comment">//1108 NSH Increment the compton heating counter</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    icsum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#af28aff5f32398a703d1423c56a4599c2">heat_ind_comp</a>; <span class="comment">//1205 NSH Increment the induced compton heating counter</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    apsum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ab5ee24fc4d7c3533aafdde5591bdc0c4">abs_photo</a>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    aausum += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#aa3d84ccfae03d00a3c23d4096e35d942">abs_auger</a>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">/* JM130621- bugfix for windsave bug- needed so that we have the luminosities from ionization</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">       cycles in the windsavefile even if the spectral cycles are run */</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ae0379496a0c22546580980cccfabf0c2">cool_tot_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a5f4abbbb9eab15f11e28ab7f26421482">cool_tot</a>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ab206d43d8bc66c44371da287b69fd5da">lum_ff_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ae9f6828f63719a3dc2f172573293c4a1">lum_ff</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a247ec26b8304ce5ef0f0489a9a4b6332">cool_rr_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a7bafaea3d058631613ebd1c8a8b8eacc">cool_rr</a>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#acc048dd6ede76041e2a872cdca2ebb8f">lum_rr_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a7c1a796efafeae5c9aacfbea4e6a79c3">lum_rr</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a1ded6465a492ddef36a6ef7a555359ec">cool_rr_metals_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a59f1e6f2bf27227a52d45f5c5bff07f6">cool_rr_metals</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ae8458741703e0a2a71f1b425600b1694">lum_lines_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a2c31ecbd91d20cf9f4112db1d6150764">lum_lines</a>;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a90c93c3a8fb77ca113fa5837491fe967">cool_comp_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a0af59963361b8b69b3f29c31a303b7c6">cool_comp</a>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a5a044a5991244d771cf0937a322bff4f">cool_dr_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a2e449de44ae3c3c3b7fec875b2e55e72">cool_dr</a>;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#ae7cfeaf05f9b888e57e0dd66b1d393bc">cool_di_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a5505637faee8b3d92778c1948e8b0e35">cool_di</a>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#af27d3aeeb9b6c87198ebe89c7990ff48">lum_tot_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a9e5f8826f902ac5154fc3c4c67f404e1">lum_tot</a>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a7030de50e435921b13630ea339eb13e9">cool_adiabatic_ioniz</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#acf37090e0b83fe81d058f21229a90018">cool_adiabatic</a>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">/* JM130621- bugfix for windsave bug- needed so that we have the luminosities from ionization</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">     cycles in the windsavefile even if the spectral cycles are run */</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#acb6781f4d383d99af45505d46f4084de">lum_ff_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac1f5d7e27d5cddc6c531e1b1e8e235ef">lum_ff</a>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab5427d941546abbd887844d9d8c454b8">cool_rr_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ace50a76a1673ac116e8a4f8021da250d">cool_rr</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#abde7c45d81870a67bd2ac1126a528228">lum_rr_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0ac777645064d9406dba3e396f533e49">lum_rr</a>;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a86b41ec449fc7d2f4ad5532de701481d">lum_lines_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18e62e654ed4ff9814d48494cba520de">lum_lines</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a6421e78e4c1922edc8d8db92f4f58bf8">cool_comp_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac01c81c77767f085d2b7b6c15196d512">cool_comp</a>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af38b024cd6a58bb82576d5766f08b554">cool_dr_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a034193beb526716a679e7d7b54cf975b">cool_dr</a>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a03ad5494da00808b0c30accc3ae14985">cool_di_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a490f2f429fa56a02a488924e669df079">cool_di</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a2f26439a939e5204b627b2f254d64611">cool_adiabatic_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af35206adaff2df187ea036302db44248">cool_adiabatic</a>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a582d41699eec31287462c428fdddc794">lum_disk_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aaf19a215b47f87b86755371bf9e1f6ce">lum_disk</a>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a2d755a63918d9ad1b454fadb61704ea8">lum_star_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#acb8d45c71d7042bd1af56bafe158a10a">lum_star</a>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a1fb10589781d4853f13cebc8a3731de7">lum_bl_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa2ea17f8b23e8e3785c3685c9261a8bf">lum_bl</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a55e4a3bbbfd77b3c28361c304fbf3f9c">lum_wind_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a12cbfe61b17a74b174a5c7eb8d9dc633">lum_wind</a>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a92919e08f4d71df33037c81013754c9d">lum_tot_ioniz</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0da2350b57744503e3459adb9e511366">lum_tot</a>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">/* Added this system which counts number of times two situations occur (See #91)</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">     We only report these every 100,000 times (one can typically get ) */</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;wind_update: note, errors from mean intensity can be high in a working model\n&quot;</span>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    (<span class="stringliteral">&quot;wind_update: can be a problem with photon numbers if there are also errors from spectral_estimators and low photon number warnings\n&quot;</span>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;wind_update: mean_intensity: %8.4e occurrences, this cycle, this thread of &#39;no model exists in a band&#39;\n&quot;</span>, (1.0 * <a class="code" href="python_8h.html#a052ca1b9e5f22b4f5ad1b3cc8d07cb1c">nerr_no_Jmodel</a>));</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    (<span class="stringliteral">&quot;wind_update: mean intensity: %8.4e occurrences, this cycle, this thread of &#39;photon freq is outside frequency range of spectral model&#39;\n&quot;</span>,</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;     (1.0 * <a class="code" href="python_8h.html#afcc4509571e87828cae153a1eeda870a">nerr_Jmodel_wrong_freq</a>));</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">/* zero the counters which record diagnositics from mean_intensity */</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <a class="code" href="python_8h.html#afcc4509571e87828cae153a1eeda870a">nerr_Jmodel_wrong_freq</a> = 0;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <a class="code" href="python_8h.html#a052ca1b9e5f22b4f5ad1b3cc8d07cb1c">nerr_no_Jmodel</a> = 0;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">zeus_connect</a> == 1 &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9e4e74de249210566125f8254f468184">hydro_domain_number</a> &gt; -1)  <span class="comment">//If we are running in zeus connect mode, we output heating and cooling rates.</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">for</span> (nplasma = 0; nplasma &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; nplasma++)</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9e4e74de249210566125f8254f468184">hydro_domain_number</a>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">nwind</a>, &amp;i, &amp;j);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      i = i - 1;                <span class="comment">//There is a radial &#39;ghost zone&#39; in python, we need to make our i,j agree with zeus</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      vol = <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">nwind</a>].vol;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%d %d %e %e %e &quot;</span>, i, j, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].nwind].rcen, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].nwind].thetacen / <a class="code" href="atomic_8h.html#a090430b65ca8e2355a86e3883133638a">RADIAN</a>, vol);  <span class="comment">//output geometric things</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e %e %e &quot;</span>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].t_e, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].xi, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].ne);     <span class="comment">//output temp, xi and ne to ease plotting of heating rates</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_photo + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_auger) / vol);   <span class="comment">//Xray heating - or photoionization</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_comp) / vol);     <span class="comment">//Compton heating</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_lines) / vol);    <span class="comment">//Line heating 28/10/15 - not currently used in zeus</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].heat_ff) / vol);       <span class="comment">//FF heating 28/10/15 - not currently used in zeus</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].cool_comp) / vol);      <span class="comment">//Compton cooling</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="foo_8h.html#a0018131577a59a5142e3677785504d37">lum_lines</a> + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].cool_rr + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].cool_dr) / vol);   <span class="comment">//Line cooling must include all recombination cooling</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].lum_ff) / vol);        <span class="comment">//ff cooling</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e &quot;</span>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="import__cylindrical_8c.html#adfeea8320d4abaf47212f89ee8f52582">rho</a>);   <span class="comment">//density</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      fprintf (fptr, <span class="stringliteral">&quot;%e\n&quot;</span>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="import__cylindrical_8c.html#adfeea8320d4abaf47212f89ee8f52582">rho</a> * <a class="code" href="atomic_8h.html#a9dc9286373de87e475724fbd5e8c0435">rho2nh</a>); <span class="comment">//hydrogen number density</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    fclose (fptr);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">zeus_connect</a> == 1 &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9e4e74de249210566125f8254f468184">hydro_domain_number</a> &lt; 0)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;wind_updates2d:  Attempting to access a hydro domain in a non hydro run - not writing out hydro file\n&quot;</span>);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="comment">/* The lines differ only in that Wind_heating adds mechanical heating, that is adiabatic heating */</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    (<span class="stringliteral">&quot;!!wind_update: Absorbed flux    %8.2e  (photo %8.2e ff %8.2e compton %8.2e auger %8.2e induced_compton %8.2e lines %8.2e)\n&quot;</span>,</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;     abstot, apsum, fsum, csum, aausum, icsum, lsum);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    (<span class="stringliteral">&quot;!!wind_update: Wind heating     %8.2e  (photo %8.2e ff %8.2e compton %8.2e auger %8.2e induced_compton %8.2e lines %8.2e adiabatic %8.2e)\n&quot;</span>,</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;     xsum + <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5da14a1eb85f3dca6863b6acb86bef12">heat_adiabatic</a>, psum, fsum, csum, ausum, icsum, lsum, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5da14a1eb85f3dca6863b6acb86bef12">heat_adiabatic</a>);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="comment">/* 1108 NSH added commands to report compton cooling 1110 removed,</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">   * As was the case above, there are two almost identical lines.  Wind_cooling includes processes that do not produce photons,</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">   * not-only adiabatic cooling, but also goe.cool_comp, geo_cool_dr and geo.cool_di */</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    (<span class="stringliteral">&quot;!!wind_update: Wind luminosity  %8.2e (recomb %8.2e ff %8.2e lines %8.2e) after update\n&quot;</span>,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;     lum_sum, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0ac777645064d9406dba3e396f533e49">lum_rr</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac1f5d7e27d5cddc6c531e1b1e8e235ef">lum_ff</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18e62e654ed4ff9814d48494cba520de">lum_lines</a>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    (<span class="stringliteral">&quot;!!wind_update: Wind cooling     %8.2e (recomb %8.2e ff %8.2e compton %8.2e DR %8.2e DI %8.2e lines %8.2e adiabatic %8.2e) after update\n&quot;</span>,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;     cool_sum,</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;     <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ace50a76a1673ac116e8a4f8021da250d">cool_rr</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac1f5d7e27d5cddc6c531e1b1e8e235ef">lum_ff</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac01c81c77767f085d2b7b6c15196d512">cool_comp</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a034193beb526716a679e7d7b54cf975b">cool_dr</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a490f2f429fa56a02a488924e669df079">cool_di</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18e62e654ed4ff9814d48494cba520de">lum_lines</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af35206adaff2df187ea036302db44248">cool_adiabatic</a>);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">/* Print out some diagnositics of the changes in the wind update */</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">zeus_connect</a> == 1 || <a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#aad0ff1589062988053354087930055bb">fixed_temp</a> == 1) <span class="comment">//There is no point in computing temperature changes, because we have fixed them!</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!wind_update: We are running in fixed temperature mode - no temperature report\n&quot;</span>);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    t_r_ave_old /= iave;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    t_e_ave_old /= iave;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    t_r_ave /= iave;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    t_e_ave /= iave;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> (nmax_r != -1)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <a class="code" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a> (<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[nmax_r].ndom, nmax_r, &amp;i, &amp;j);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!wind_update: Max change in t_r %6.0f at cell %4d (%d,%d)\n&quot;</span>, dt_r, nmax_r, i, j);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!wind_update: Ave change in t_r %6.0f from %6.0f to %6.0f\n&quot;</span>, (t_r_ave - t_r_ave_old), t_r_ave_old, t_r_ave);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!wind_update: t_r did not change in any cells this cycle\n&quot;</span>);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span> (nmax_e != -1)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <a class="code" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a> (<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[nmax_e].ndom, nmax_e, &amp;i, &amp;j);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!wind_update: Max change in t_e %6.0f at cell %4d (%d,%d)\n&quot;</span>, dt_e, nmax_e, i, j);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!wind_update: Ave change in t_e %6.0f from %6.0f to %6.0f\n&quot;</span>, (t_e_ave - t_e_ave_old), t_e_ave_old, t_e_ave);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!wind_update: t_e did not change in any cells this cycle\n&quot;</span>);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Summary  t_r  %6.0f   %6.0f  #t_r and dt_r on this update\n&quot;</span>, t_r_ave, (t_r_ave - t_r_ave_old));</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Summary  t_e  %6.0f   %6.0f  #t_e and dt_e on this update\n&quot;</span>, t_e_ave, (t_e_ave - t_e_ave_old));</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <a class="code" href="foo_8h.html#a834b9001d849a521f4dbf7a0dcb0d012">check_convergence</a> ();</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">/* Summarize the radiative temperatures (ksl 04 mar) */</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <a class="code" href="foo_8h.html#ad0ff63710a78f84604f2adc60d4b1c32">xtemp_rad</a> (<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">/* This next block is to allow the output of data relating to the abundances of ions when python is being tested</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"> * with thin shell mode.We will only want this to run if the wind mode is 9, for test or thin shell mode.</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type == <a class="code" href="python_8h.html#a0db8a9b5ad5a66e4adc36d0ba68735c8">SHELL</a>)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    {</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      nstart = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#aeddcae5f993efc8142ee84f461cfcda1">nstart</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      n = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">nwind</a>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ae7fb58fc78cd9fa02941f1996777efeb">nxfreq</a>; i++)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      {                         <span class="comment">/*loop over number of bands */</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          (<span class="stringliteral">&quot;Band %i f1 %e f2 %e model %i pl_alpha %f pl_log_w %e exp_t %e exp_w %e\n&quot;</span>,</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;           i, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aaf647ea9c7e3521a4063a0966cbe35e7">xfreq</a>[i], <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aaf647ea9c7e3521a4063a0966cbe35e7">xfreq</a>[i + 1],</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;           <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a110b6efdc5fa932c21dc021047b35eea">spec_mod_type</a>[i],</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;           <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a0dbad3f32ea372492eb73eda0f123899">pl_alpha</a>[i], <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#aae85efc36fb767cfec53df4cd3327fe8">pl_log_w</a>[i], <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a30222105e41ccde304250f41d25b5ad7">exp_temp</a>[i], <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a9b46e8bed0dfadca5cf9966301ecec6d">exp_w</a>[i]);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      }</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="comment">/* Get some line diagnostics */</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      lum_h_line = 0.0;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      lum_he_line = 0.0;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      lum_c_line = 0.0;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      lum_n_line = 0.0;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      lum_o_line = 0.0;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      lum_fe_line  = 0.0;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="atomic_8h.html#af69ee38d2c862dbc6769fa27c5320b96">nlines</a>; i++)</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[i]-&gt;<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 1)</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;          lum_h_line = lum_h_line + <a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>]-&gt;<a class="code" href="structlines.html#a3a0d7a9e793ec94dea8247160927062d">pow</a>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[i]-&gt;<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 2)</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            lum_he_line = lum_he_line + <a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>]-&gt;<a class="code" href="structlines.html#a3a0d7a9e793ec94dea8247160927062d">pow</a>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[i]-&gt;<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 6)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            lum_c_line = lum_c_line + <a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>]-&gt;<a class="code" href="structlines.html#a3a0d7a9e793ec94dea8247160927062d">pow</a>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[i]-&gt;<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 7)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            lum_n_line = lum_n_line + <a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>]-&gt;<a class="code" href="structlines.html#a3a0d7a9e793ec94dea8247160927062d">pow</a>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[i]-&gt;<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 8)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            lum_o_line = lum_o_line + <a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>]-&gt;<a class="code" href="structlines.html#a3a0d7a9e793ec94dea8247160927062d">pow</a>;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[i]-&gt;<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 26)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            lum_fe_line = lum_fe_line + <a class="code" href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>]-&gt;<a class="code" href="structlines.html#a3a0d7a9e793ec94dea8247160927062d">pow</a>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      agn_ip = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a944d56aa7928d99d6e86d355e90e4c3e">const_agn</a> * (((pow (50000 / <a class="code" href="atomic_8h.html#a3a1abcee874b9a925a5e62f58827fb0f">HEV</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9a16f5c129fc954fd15b38e3cab8e12d">alpha_agn</a> + 1.0)) - pow (100 / <a class="code" href="atomic_8h.html#a3a1abcee874b9a925a5e62f58827fb0f">HEV</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9a16f5c129fc954fd15b38e3cab8e12d">alpha_agn</a> + 1.0)) / (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9a16f5c129fc954fd15b38e3cab8e12d">alpha_agn</a> + 1.0));</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      agn_ip /= (<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].r * <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].r);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      agn_ip /= <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> * <a class="code" href="atomic_8h.html#a9dc9286373de87e475724fbd5e8c0435">rho2nh</a>;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="comment">/* Report luminosities, IP and other diagnositic quantities */</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        (<span class="stringliteral">&quot;OUTPUT Lum_agn= %e T_e= %e N_h= %e N_e= %e alpha= %f IP(sim_2010)= %e Measured_IP(cloudy)= %e Measured_Xi= %e distance= %e volume= %e mean_ds=%e\n&quot;</span>,</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;         <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#afc49d7aa9f0e9c5792dc2ba38a66a0ab">lum_agn</a>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a>,</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;         <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> * <a class="code" href="atomic_8h.html#a9dc9286373de87e475724fbd5e8c0435">rho2nh</a>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#ac1d38c3e4cc4ef2a1e4d83d7f8b71d22">ne</a>,</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9a16f5c129fc954fd15b38e3cab8e12d">alpha_agn</a>, agn_ip, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a1ac56fc73e1242bfa9cbb9bfa04e6d38">ip</a>,</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;         <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#af8986403a916d5a9f4330ae70aa5e798">xi</a>, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].r, <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a50251baa932d22c94584c04ce0398a36">mean_ds</a> / <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a579b07a98a0b0692e5e6e2465c2ab425">n_ds</a>);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="comment">/* 1108 NSH Added commands to report compton heating */</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        (<span class="stringliteral">&quot;OUTPUT Absorbed_flux(ergs-1cm-3)    %8.2e  (photo %8.2e ff %8.2e compton %8.2e induced_compton %8.2e lines %8.2e auger %8.2e )\n&quot;</span>,</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;         xsum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, psum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, fsum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, csum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, icsum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, lsum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, ausum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="comment">/* 1110 NSH Added this line to report all cooling mechanisms, including those that do not generate photons. */</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        (<span class="stringliteral">&quot;OUTPUT Wind_cooling(ergs-1cm-3)     %8.2e (recomb %8.2e ff %8.2e compton %8.2e DR %8.2e DI %8.2e adiabatic %8.2e lines %8.2e ) after update\n&quot;</span>,</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;         cool_sum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ace50a76a1673ac116e8a4f8021da250d">cool_rr</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;         <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac1f5d7e27d5cddc6c531e1b1e8e235ef">lum_ff</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac01c81c77767f085d2b7b6c15196d512">cool_comp</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;         <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a034193beb526716a679e7d7b54cf975b">cool_dr</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a490f2f429fa56a02a488924e669df079">cool_di</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af35206adaff2df187ea036302db44248">cool_adiabatic</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18e62e654ed4ff9814d48494cba520de">lum_lines</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;         <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;           (<span class="stringliteral">&quot;OUTPUT Wind_luminosity(ergs-1cm-3)     %8.2e (recomb %8.2e ff %8.2e lines %8.2e ) after update\n&quot;</span>,</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            lum_sum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0ac777645064d9406dba3e396f533e49">lum_rr</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac1f5d7e27d5cddc6c531e1b1e8e235ef">lum_ff</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a18e62e654ed4ff9814d48494cba520de">lum_lines</a> / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="comment">/* NSH 1701 calculate the recombination cooling for other elements */</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      c_rec = n_rec = o_rec = fe_rec = 0.0;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      c_lum = n_lum = o_lum = fe_lum = 0.0;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      h_dr= he_dr = c_dr = n_dr = o_dr = fe_dr = 0.0;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      cool_dr_metals=0.0;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">for</span> (nn = 0; nn &lt; <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>; nn++)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#ae721a9114e3cf54f9bcc3dab31072273">ion</a>[nn].<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 6)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          c_dr  = c_dr + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#ad69c6b875d8b97df4e10569a06085107">cool_dr_ion</a>[nn];</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;          c_rec = c_rec + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a0d74b5ee435184a0bf1f2dbdecc16a2d">cool_rr_ion</a>[nn];</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          c_lum = c_lum + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a82db22eb07618b0844344790fc875166">lum_rr_ion</a>[nn];</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#ae721a9114e3cf54f9bcc3dab31072273">ion</a>[nn].<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 7)</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        {</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          n_dr  = n_dr + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#ad69c6b875d8b97df4e10569a06085107">cool_dr_ion</a>[nn];</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          n_rec = n_rec + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a0d74b5ee435184a0bf1f2dbdecc16a2d">cool_rr_ion</a>[nn];</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          n_lum = n_lum + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a82db22eb07618b0844344790fc875166">lum_rr_ion</a>[nn];</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#ae721a9114e3cf54f9bcc3dab31072273">ion</a>[nn].<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 8)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          o_dr  = o_dr + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#ad69c6b875d8b97df4e10569a06085107">cool_dr_ion</a>[nn];</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          o_rec = o_rec + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a0d74b5ee435184a0bf1f2dbdecc16a2d">cool_rr_ion</a>[nn];</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          o_lum = o_lum + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a82db22eb07618b0844344790fc875166">lum_rr_ion</a>[nn];</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#ae721a9114e3cf54f9bcc3dab31072273">ion</a>[nn].<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> == 26)</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;          fe_dr  = fe_dr + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#ad69c6b875d8b97df4e10569a06085107">cool_dr_ion</a>[nn];</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          fe_rec = fe_rec + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a0d74b5ee435184a0bf1f2dbdecc16a2d">cool_rr_ion</a>[nn];</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          fe_lum = fe_lum + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#a82db22eb07618b0844344790fc875166">lum_rr_ion</a>[nn];</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#ae721a9114e3cf54f9bcc3dab31072273">ion</a>[nn].<a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a> &gt; 2)</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            cool_dr_metals=cool_dr_metals+<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].<a class="code" href="structplasma.html#ad69c6b875d8b97df4e10569a06085107">cool_dr_ion</a>[nn];</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;OUTPUT Wind_line_cooling(ergs-1cm-3)  H %8.2e He %8.2e C %8.2e N %8.2e O %8.2e Fe %8.2e Metals %8.2e\n&quot;</span>, lum_h_line/<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      lum_he_line/<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,lum_c_line/<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,lum_n_line/<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,lum_o_line/<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,lum_fe_line/<a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;OUTPUT Wind_recomb_cooling(ergs-1cm-3)  H %8.2e He %8.2e C %8.2e N %8.2e O %8.2e Fe %8.2e Metals %8.2e\n&quot;</span>,</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;           <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].cool_rr_ion[0] / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].cool_rr_ion[2] + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].cool_rr_ion[3]) / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;           c_rec / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, n_rec / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, o_rec / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, fe_rec / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].cool_rr_metals / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;OUTPUT Wind_recomb_lum(ergs-1cm-3)  H %8.2e He %8.2e C %8.2e N %8.2e O %8.2e Fe %8.2e Metals %8.2e\n&quot;</span>,</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].lum_rr_ion[0] / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].lum_rr_ion[2] + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].lum_rr_ion[3]) / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                c_lum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, n_lum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, o_lum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, fe_lum / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].lum_rr_metals / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;OUTPUT Wind_dr_cooling(ergs-1cm-3)  H %8.2e He %8.2e C %8.2e N %8.2e O %8.2e Fe %8.2e Metals %8.2e\n&quot;</span>,</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].cool_dr_ion[0] / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].cool_dr_ion[2] + <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].cool_dr_ion[3]) / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol,</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                        c_dr / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, n_dr / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, o_dr / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, fe_dr / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol, cool_dr_metals / <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>[n].vol);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="comment">/* 1110 NSH Added this line to report all cooling mechanisms, including those that do not generate photons. */</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        (<span class="stringliteral">&quot;OUTPUT Balance      Cooling=%8.2e Heating=%8.2e Lum=%8.2e T_e=%e after update\n&quot;</span>,</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;         cool_sum, xsum, lum_sum, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].t_e);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="atomic_8h.html#a23ae6a00bed19d2ad34d439636e797da">nelements</a>; n++)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        first = <a class="code" href="atomic_8h.html#a5696fba91c25a0a9593747ac3ca6ebf1">ele</a>[n].<a class="code" href="structelements.html#a309aeae50d0264cd963f1a1815ce604e">firstion</a>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        last = first + <a class="code" href="atomic_8h.html#a5696fba91c25a0a9593747ac3ca6ebf1">ele</a>[n].<a class="code" href="structelements.html#a90866d4e99cc142553839ad5e8f13dbc">nions</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;OUTPUT %-5s &quot;</span>, <a class="code" href="atomic_8h.html#a5696fba91c25a0a9593747ac3ca6ebf1">ele</a>[n].name);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        tot = 0;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">for</span> (m = first; m &lt; last; m++)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;          tot += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].density[m];</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordflow">for</span> (m = first; m &lt; last; m++)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot; %8.2e&quot;</span>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nstart].density[m] / tot);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;}</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l01013"></a><span class="lineno"><a class="line" href="wind__updates2d_8c.html#aa1f75e088856c1c47527ce62bea5c913"> 1013</a></span>&#160;<a class="code" href="wind__updates2d_8c.html#aa1f75e088856c1c47527ce62bea5c913">wind_rad_init</a> ()</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;{</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordtype">int</span> n, <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keywordtype">int</span> njump;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; n++)</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a81aa2849c8ad883b8b23ca7a5e7b7c2f">j</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9ef4bb2909c072cb6155880d3114c95f">ave_freq</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aa22c8b26e65db4f93a14fa183d7e09e6">ntot</a> = 0;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a3a6771031add8ed4970ea0a051ae3751">j_direct</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ab48f9178fc1c8be99c96d9a33d19f2a9">j_scatt</a> = 0.0;       <span class="comment">//NSH 1309 zero j banded by number of scatters</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a1ac56fc73e1242bfa9cbb9bfa04e6d38">ip</a> = 0.0;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af8986403a916d5a9f4330ae70aa5e798">xi</a> = 0.0;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#acf74d2b82ce1f94cd72b38b432f68774">ip_direct</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ac2985029f1cc2e4bd9a511c7c4ff5db9">ip_scatt</a> = 0.0;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a50251baa932d22c94584c04ce0398a36">mean_ds</a> = 0.0;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a579b07a98a0b0692e5e6e2465c2ab425">n_ds</a> = 0;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a0c76211532161bfdd92ccde2b4aacffd">ntot_disk</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aacb5d70931f73523be11b5bb9bb051a6">ntot_agn</a> = 0;       <span class="comment">//NSH 15/4/11 counters to see where photons come from</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a2e85980821d61738e7b5b6455604066b">ntot_star</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aec5dcc811c48f5b8f8d195accbdb7813">ntot_bl</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a94bce860bda9cee5964584ca552b256a">ntot_wind</a> = 0;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a2ed3e67409c1f55ca66cb0cbfbc39ac2">heat_tot</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aadd0d71f61d6ed95a48af999a14784e0">heat_ff</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a2878212449ef25989225a975f81679fd">heat_photo</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ab2b017d6fa0e646a4a1d880d49914ef2">heat_lines</a> = 0.0;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a671e4d660694e4fef07580536f729bfb">abs_tot</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aa3d84ccfae03d00a3c23d4096e35d942">abs_auger</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ab5ee24fc4d7c3533aafdde5591bdc0c4">abs_photo</a> =  0.0;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a5748c6ee35ca4d9458a8bf20d1930b55">heat_z</a> = 0.0;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ac6f1afeb2ed92f59b12ca628a4e75eff">max_freq</a> = 0.0;       <span class="comment">//NSH 120814 Zero the counter which works out the maximum frequency seen in a cell and hence the maximum applicable frequency of the power law estimators.</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a5f4abbbb9eab15f11e28ab7f26421482">cool_tot</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9e5f8826f902ac5154fc3c4c67f404e1">lum_tot</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a2c31ecbd91d20cf9f4112db1d6150764">lum_lines</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ae9f6828f63719a3dc2f172573293c4a1">lum_ff</a> = 0.0;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a7bafaea3d058631613ebd1c8a8b8eacc">cool_rr</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a59f1e6f2bf27227a52d45f5c5bff07f6">cool_rr_metals</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a7c1a796efafeae5c9aacfbea4e6a79c3">lum_rr</a> = 0.0;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ab2eba1f8343e4767fd32dc914fb95397">nrad</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ada72c65c218f315e543710ce8808e225">nioniz</a> = 0;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a57a290ba7730852666e194dcd1d594e6">comp_nujnu</a> = -1e99;   <span class="comment">//1701 NSH Zero the integrated specific intensity for the cell</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a0af59963361b8b69b3f29c31a303b7c6">cool_comp</a> = 0.0;       <span class="comment">//1108 NSH Zero the compton luminosity for the cell</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ac6e1f1f8827b1bc1a68a437e1e58b001">heat_comp</a> = 0.0;      <span class="comment">//1108 NSH Zero the compton heating for the cell</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af28aff5f32398a703d1423c56a4599c2">heat_ind_comp</a> = 0.0;  <span class="comment">//1108 NSH Zero the induced compton heating for the cell</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a878263d85482a81865eb7619b3b2a20e">heat_auger</a> = 0.0;     <span class="comment">//1108 NSH Zero the auger heating for the cell</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="atomic_8h.html#a258a69e883c6cbadd396857a37d8d85b">nlevels_macro</a> &gt; 1 &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac453ab1a6ed3b90674cd6552c0185bff">macro_simple</a> == 0)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#a22a281cdcc628db94cb49e1596802c2f">kpkt_rates_known</a> = -1;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">/* 1108 NSH Loop to zero the frequency banded radiation estimators */</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">/* 71 - 111279 - ksl - Small modification to reflect the fact that nxfreq has been moved into the geo structure */</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ae7fb58fc78cd9fa02941f1996777efeb">nxfreq</a>; i++)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    {</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#abded068048bfaf274478a65b26388ed5">xj</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ae72cc720bc175444504be8f75d02e4c4">xave_freq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a8f5a30977d126bd3ec95bb175056e9c2">nxtot</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#af6eca6f64a123edc0389b42ace886569">xsd_freq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0.0;  <span class="comment">/* NSH 120815 Zero the standard deviation counter */</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ac4d25da8ffad12c810a2be5baf12c9a0">fmin</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aaf647ea9c7e3521a4063a0966cbe35e7">xfreq</a>[i + 1]; <span class="comment">/* Set the minium frequency to the max frequency in the band */</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a21e7b17fa73a2521fe95247ac0d52d36">fmax</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aaf647ea9c7e3521a4063a0966cbe35e7">xfreq</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>];     <span class="comment">/* Set the maximum frequency to the min frequency in the band */</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>; i++)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ad5797671f1fe6d9e2a638df668ea51df">ioniz</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#abfec36000559630caf4ec85917950a1e">recomb</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a1cff49185ad30a6734089a2d2c949fbc">heat_ion</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a0d74b5ee435184a0bf1f2dbdecc16a2d">cool_rr_ion</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a82db22eb07618b0844344790fc875166">lum_rr_ion</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0.0;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    }</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">/*Block added (Dec 08) to zero the auger rate estimators */</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">/* commented out by NSH 2018 - removed code */</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">//    for (i = 0; i &lt; nauger; i++)</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">//      plasmamain[n].gamma_inshl[i] = 0.0;</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">/* Next blocks added by SS Mar 2004 to zero the Macro Atom estimators. */</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">/* 57h -- 0608 -- These sections actually involve enough calculations that</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">       they are noticeable in term sof the overall speed.  One would if possible</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">       like to avoid this section, since it requires the creation of macromain,</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">       even though macromain is not used -- ksl */</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="atomic_8h.html#a258a69e883c6cbadd396857a37d8d85b">nlevels_macro</a>; i++) <span class="comment">//57h</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keywordflow">for</span> (njump = 0; njump &lt; <a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#a9e1d8406fcb5d8d371e61e11750653a7">n_bbu_jump</a>; njump++)</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#ae726f77ad64bda6f946406ee648bfeb7">jbar</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#a006c163c0458412401d44aca2d8b228d">bbu_indx_first</a> + njump] = 0.0;      <span class="comment">// mean intensity</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">for</span> (njump = 0; njump &lt; <a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#aeab07933f8fe82391d5c8f3e4113d1bd">n_bfu_jump</a>; njump++)</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      {</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#acc6db9c38b22c6e664567d2a46b9b3aa">gamma</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#a8942d3fe089878881187ced90e2ccc5e">bfu_indx_first</a> + njump] = 0.0;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#a594afc421f440fb2cab4b3a8ef59f582">gamma_e</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#a8942d3fe089878881187ced90e2ccc5e">bfu_indx_first</a> + njump] = 0.0;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#a0e9447fef9f2b3b67cf7ca5a8d8dc4e9">alpha_st</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#abc158a8d23c5630e6eedf3a1866af30c">bfd_indx_first</a> + njump] = 0.0;  <span class="comment">//stimulated recombination</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#ae3484a034eeddcfd15b61073421412ab">alpha_st_e</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#abc158a8d23c5630e6eedf3a1866af30c">bfd_indx_first</a> + njump] = 0.0;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="comment">/* Next block to set spontaneous recombination rates for next iteration. (SS July 04) */</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <span class="keywordflow">for</span> (njump = 0; njump &lt; <a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#acfee0b128e4e7c2a4e6aea0687a233d9">n_bfd_jump</a>; njump++)</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e &gt; 1.0)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          <span class="comment">//04Jul--ksl-modified these calls to reflect changed alpha_sp</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#aa33a4e57be212a9a8f49edf6660350cb">recomb_sp</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#abc158a8d23c5630e6eedf3a1866af30c">bfd_indx_first</a> + njump] = <a class="code" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1">alpha_sp</a> (&amp;<a class="code" href="atomic_8h.html#aed5961eebbc0ca048e57fe2ad4cdfab8">phot_top</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[i].bfd_jump[njump]], &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n], 0);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#a13217cd83bb2aff404860f1eea75d18e">recomb_sp_e</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#abc158a8d23c5630e6eedf3a1866af30c">bfd_indx_first</a> + njump] = <a class="code" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1">alpha_sp</a> (&amp;<a class="code" href="atomic_8h.html#aed5961eebbc0ca048e57fe2ad4cdfab8">phot_top</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[i].bfd_jump[njump]], &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n], 2);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#aa33a4e57be212a9a8f49edf6660350cb">recomb_sp</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#abc158a8d23c5630e6eedf3a1866af30c">bfd_indx_first</a> + njump] = 0.0;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;          <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#a13217cd83bb2aff404860f1eea75d18e">recomb_sp_e</a>[<a class="code" href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structconfigurations.html#abc158a8d23c5630e6eedf3a1866af30c">bfd_indx_first</a> + njump] = 0.0;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      }</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    }</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="atomic_8h.html#a127eafbd8b58ca000d85e777f7a58027">ntop_phot</a>; i++)</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    {</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="comment">/* 57h -- recomb_simple is only required for we are using a macro atom approach, and only non-zero when</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">         this particular phot_tob xsection is treated as a simple x-section. Stuart, is this correct?? I&#39;ve added</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">         checks so that macro_info is only 0 (false) or true (1), and so the logic of the next section can be</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">         simplified.  0608-ksl */</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ac453ab1a6ed3b90674cd6552c0185bff">macro_simple</a> || <a class="code" href="atomic_8h.html#aed5961eebbc0ca048e57fe2ad4cdfab8">phot_top</a>[i].<a class="code" href="structtopbase__phot.html#a0552ae390dbc87aa64fdd05d32227006">macro_info</a>)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ae4b9e1c0afc70066b36d896e8122513b">recomb_simple</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0.0;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      {                         <span class="comment">//we want a macro approach, but not for this ion so need recomb_simple</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ae4b9e1c0afc70066b36d896e8122513b">recomb_simple</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1">alpha_sp</a> (&amp;<a class="code" href="atomic_8h.html#aed5961eebbc0ca048e57fe2ad4cdfab8">phot_top</a>[i], &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n], 2);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      }</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    }</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">//zero the emissivities that are needed for the spectral synthesis step.</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a3a7cb2d0cfcfe01e21e43f7e4fe4e9a8">kpkt_emiss</a> = 0.0;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aa9ee2846f568c0a0de1f7848ff747301">kpkt_abs</a> = 0.0;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="atomic_8h.html#a258a69e883c6cbadd396857a37d8d85b">nlevels_macro</a>; i++) <span class="comment">//57h</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    {</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#a5a30021fa093059f407675bfde840b34">matom_abs</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0.0;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <a class="code" href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a>[n].<a class="code" href="structmacro.html#af1f77da4f0d619ccdf0721133c93a5e8">matom_emiss</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = 0.0;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">/* End of added material. */</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  }</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;}</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">//OLD /**********************************************************/</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">//OLD /** @name      wind_ip</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">//OLD  * @brief      calculates a version of the ionization parameter using Ferland&#39;s definition, but one that also assumes that the</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">//OLD  * wind is optically thin everywhere, and that all photons arise for the central source.</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">//OLD  *</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">//OLD  * @return     Always retrusn 0</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">//OLD  *</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">//OLD  * @details</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">//OLD  *</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">//OLD  * ### Notes ###</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">//OLD  * @bug It is likely that this routine should simply be deleted. According to Nick it was</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">//OLD  * just an experiment.  There is a git issue for this.</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">//OLD  *</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">//OLD  **********************************************************/</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">//OLD int</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">//OLD wind_ip ()</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">//OLD {</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">//OLD   int n;</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">//OLD   float r;</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">//OLD   for (n = 0; n &lt; NPLASMA; n++)</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">//OLD   {</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">//OLD     r = sqrt ((wmain[plasmamain[n].nwind].xcen[0] *</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">//OLD                wmain[plasmamain[n].nwind].xcen[0] +</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">//OLD                wmain[plasmamain[n].nwind].xcen[1] *</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">//OLD                wmain[plasmamain[n].nwind].xcen[1] + wmain[plasmamain[n].nwind].xcen[2] * wmain[plasmamain[n].nwind].xcen[2]));</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">//OLD    plasmamain[n].ferland_ip = geo.n_ioniz / (4 * PI * C * plasmamain[n].rho * rho2nh * (r * r));</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">//OLD     r = sqrt ((wmain[plasmamain[n].nwind].x[0] *</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">//OLD                wmain[plasmamain[n].nwind].x[0] +</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">//OLD                wmain[plasmamain[n].nwind].x[1] *</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">//OLD                wmain[plasmamain[n].nwind].x[1] + wmain[plasmamain[n].nwind].x[2] * wmain[plasmamain[n].nwind].x[2]));</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">//OLD     plasmamain[n].ferland_ip = geo.n_ioniz / (4 * PI * C * plasmamain[n].rho * rho2nh * (r * r));</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">//OLD   }</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">//OLD   return (0);</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">//OLD }</span></div><div class="ttc" id="structconfigurations_html_a8942d3fe089878881187ced90e2ccc5e"><div class="ttname"><a href="structconfigurations.html#a8942d3fe089878881187ced90e2ccc5e">configurations::bfu_indx_first</a></div><div class="ttdeci">int bfu_indx_first</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00208">atomic.h:208</a></div></div>
<div class="ttc" id="atomic_8h_html_ad4e561a62bce83b8233ceb954b7c8988"><div class="ttname"><a href="atomic_8h.html#ad4e561a62bce83b8233ceb954b7c8988">STEFAN_BOLTZMANN</a></div><div class="ttdeci">#define STEFAN_BOLTZMANN</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00016">atomic.h:16</a></div></div>
<div class="ttc" id="structplasma_html_a3a6771031add8ed4970ea0a051ae3751"><div class="ttname"><a href="structplasma.html#a3a6771031add8ed4970ea0a051ae3751">plasma::j_direct</a></div><div class="ttdeci">double j_direct</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00835">python.h:835</a></div></div>
<div class="ttc" id="foo_8h_html_ad0ff63710a78f84604f2adc60d4b1c32"><div class="ttname"><a href="foo_8h.html#ad0ff63710a78f84604f2adc60d4b1c32">xtemp_rad</a></div><div class="ttdeci">int xtemp_rad(WindPtr w)</div><div class="ttdoc">Prints out t_r and t_e and the total number of photons in a subsample of the the grid that fits on a ...</div><div class="ttdef"><b>Definition:</b> <a href="wind__sum_8c_source.html#l00058">wind_sum.c:58</a></div></div>
<div class="ttc" id="structmacro_html_ae726f77ad64bda6f946406ee648bfeb7"><div class="ttname"><a href="structmacro.html#ae726f77ad64bda6f946406ee648bfeb7">macro::jbar</a></div><div class="ttdeci">double * jbar</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00925">python.h:925</a></div></div>
<div class="ttc" id="structplasma_html_a0d74b5ee435184a0bf1f2dbdecc16a2d"><div class="ttname"><a href="structplasma.html#a0d74b5ee435184a0bf1f2dbdecc16a2d">plasma::cool_rr_ion</a></div><div class="ttdeci">double * cool_rr_ion</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00819">python.h:819</a></div></div>
<div class="ttc" id="structplasma_html_a110b6efdc5fa932c21dc021047b35eea"><div class="ttname"><a href="structplasma.html#a110b6efdc5fa932c21dc021047b35eea">plasma::spec_mod_type</a></div><div class="ttdeci">enum plasma::spec_mod_type_enum spec_mod_type[NXBANDS]</div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00134">python.h:134</a></div></div>
<div class="ttc" id="structplasma_html_ac2985029f1cc2e4bd9a511c7c4ff5db9"><div class="ttname"><a href="structplasma.html#ac2985029f1cc2e4bd9a511c7c4ff5db9">plasma::ip_scatt</a></div><div class="ttdeci">double ip_scatt</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00836">python.h:836</a></div></div>
<div class="ttc" id="structplasma_html_ab48f9178fc1c8be99c96d9a33d19f2a9"><div class="ttname"><a href="structplasma.html#ab48f9178fc1c8be99c96d9a33d19f2a9">plasma::j_scatt</a></div><div class="ttdeci">double j_scatt</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00835">python.h:835</a></div></div>
<div class="ttc" id="structphoton_html_a5fa87a07a9ceef33dd79aa5cdd7856cb"><div class="ttname"><a href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">photon::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01039">python.h:1039</a></div></div>
<div class="ttc" id="cylindrical_8c_html_ac1669c1045ab41daf35de34f56dd9737"><div class="ttname"><a href="cylindrical_8c.html#ac1669c1045ab41daf35de34f56dd9737">cylind_extend_density</a></div><div class="ttdeci">int cylind_extend_density(ndom, WindPtr w)</div><div class="ttdoc">extends the density to regions just outside the wind regiions so that extrapolations of density can b...</div><div class="ttdef"><b>Definition:</b> <a href="cylindrical_8c_source.html#l00675">cylindrical.c:675</a></div></div>
<div class="ttc" id="python_8h_html_ad957272e4ddecfb558775b2aeddf2ac4"><div class="ttname"><a href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a></div><div class="ttdeci">struct wind * WindPtr</div></div>
<div class="ttc" id="atomic_8h_html_af69ee38d2c862dbc6769fa27c5320b96"><div class="ttname"><a href="atomic_8h.html#af69ee38d2c862dbc6769fa27c5320b96">nlines</a></div><div class="ttdeci">int nlines</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00065">atomic.h:65</a></div></div>
<div class="ttc" id="structplasma_html_adbf9689b61e3df7611084d858b3115c0"><div class="ttname"><a href="structplasma.html#adbf9689b61e3df7611084d858b3115c0">plasma::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00791">python.h:791</a></div></div>
<div class="ttc" id="structplasma_html_a2e449de44ae3c3c3b7fec875b2e55e72"><div class="ttname"><a href="structplasma.html#a2e449de44ae3c3c3b7fec875b2e55e72">plasma::cool_dr</a></div><div class="ttdeci">double cool_dr</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00847">python.h:847</a></div></div>
<div class="ttc" id="structadvanced__modes_html_a9a1d48d878cdb6a4ef9c0f08f3f42f12"><div class="ttname"><a href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">advanced_modes::zeus_connect</a></div><div class="ttdeci">int zeus_connect</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01358">python.h:1358</a></div></div>
<div class="ttc" id="log_8h_html_a9a25be4f0d7d13fccc8457774d74167f"><div class="ttname"><a href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="ttdeci">int Log(char *format,...)</div><div class="ttdoc">Print/write an informational message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00325">xlog.c:325</a></div></div>
<div class="ttc" id="structplasma_html_ab206d43d8bc66c44371da287b69fd5da"><div class="ttname"><a href="structplasma.html#ab206d43d8bc66c44371da287b69fd5da">plasma::lum_ff_ioniz</a></div><div class="ttdeci">double lum_ff_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00853">python.h:853</a></div></div>
<div class="ttc" id="atomic_8h_html_a090430b65ca8e2355a86e3883133638a"><div class="ttname"><a href="atomic_8h.html#a090430b65ca8e2355a86e3883133638a">RADIAN</a></div><div class="ttdeci">#define RADIAN</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00033">atomic.h:33</a></div></div>
<div class="ttc" id="python_8h_html_a4d5c68b263c929465c5ce25903ab1773"><div class="ttname"><a href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a></div><div class="ttdeci">#define RT_MODE_MACRO</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00456">python.h:456</a></div></div>
<div class="ttc" id="atomic_8h_html_ad8512644399ac6ec00af8f727bb4fac6"><div class="ttname"><a href="atomic_8h.html#ad8512644399ac6ec00af8f727bb4fac6">VERY_BIG</a></div><div class="ttdeci">#define VERY_BIG</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00003">atomic.h:3</a></div></div>
<div class="ttc" id="structmacro_html_a13217cd83bb2aff404860f1eea75d18e"><div class="ttname"><a href="structmacro.html#a13217cd83bb2aff404860f1eea75d18e">macro::recomb_sp_e</a></div><div class="ttdeci">double * recomb_sp_e</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00958">python.h:958</a></div></div>
<div class="ttc" id="atomic_8h_html_a8c1d70d2c39e64a6cc16b6132d86c044"><div class="ttname"><a href="atomic_8h.html#a8c1d70d2c39e64a6cc16b6132d86c044">lin_ptr</a></div><div class="ttdeci">LinePtr lin_ptr[NLINES]</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00253">atomic.h:253</a></div></div>
<div class="ttc" id="atomic_8h_html_a127eafbd8b58ca000d85e777f7a58027"><div class="ttname"><a href="atomic_8h.html#a127eafbd8b58ca000d85e777f7a58027">ntop_phot</a></div><div class="ttdeci">int ntop_phot</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00326">atomic.h:326</a></div></div>
<div class="ttc" id="structgeometry_html_aaf647ea9c7e3521a4063a0966cbe35e7"><div class="ttname"><a href="structgeometry.html#aaf647ea9c7e3521a4063a0966cbe35e7">geometry::xfreq</a></div><div class="ttdeci">double xfreq[NXBANDS+1]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00476">python.h:476</a></div></div>
<div class="ttc" id="structplasma_html_ae7cfeaf05f9b888e57e0dd66b1d393bc"><div class="ttname"><a href="structplasma.html#ae7cfeaf05f9b888e57e0dd66b1d393bc">plasma::cool_di_ioniz</a></div><div class="ttdeci">double cool_di_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00856">python.h:856</a></div></div>
<div class="ttc" id="atomic_8h_html_a15a303809550342a407548de2ef7c245"><div class="ttname"><a href="atomic_8h.html#a15a303809550342a407548de2ef7c245">nphot_total</a></div><div class="ttdeci">int nphot_total</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00327">atomic.h:327</a></div></div>
<div class="ttc" id="structgeometry_html_ac1f5d7e27d5cddc6c531e1b1e8e235ef"><div class="ttname"><a href="structgeometry.html#ac1f5d7e27d5cddc6c531e1b1e8e235ef">geometry::lum_ff</a></div><div class="ttdeci">double lum_ff</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00519">python.h:519</a></div></div>
<div class="ttc" id="structplasma_html_aa3d84ccfae03d00a3c23d4096e35d942"><div class="ttname"><a href="structplasma.html#aa3d84ccfae03d00a3c23d4096e35d942">plasma::abs_auger</a></div><div class="ttdeci">double abs_auger</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00790">python.h:790</a></div></div>
<div class="ttc" id="atomic_8h_html_a28554dc87ad01f4e71464455b2a3f31d"><div class="ttname"><a href="atomic_8h.html#a28554dc87ad01f4e71464455b2a3f31d">nlte_levels</a></div><div class="ttdeci">int nlte_levels</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00061">atomic.h:61</a></div></div>
<div class="ttc" id="structgeometry_html_abde7c45d81870a67bd2ac1126a528228"><div class="ttname"><a href="structgeometry.html#abde7c45d81870a67bd2ac1126a528228">geometry::lum_rr_ioniz</a></div><div class="ttdeci">double lum_rr_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00531">python.h:531</a></div></div>
<div class="ttc" id="structplasma_html_a94bce860bda9cee5964584ca552b256a"><div class="ttname"><a href="structplasma.html#a94bce860bda9cee5964584ca552b256a">plasma::ntot_wind</a></div><div class="ttdeci">int ntot_wind</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00800">python.h:800</a></div></div>
<div class="ttc" id="structplasma_html_ac4d25da8ffad12c810a2be5baf12c9a0"><div class="ttname"><a href="structplasma.html#ac4d25da8ffad12c810a2be5baf12c9a0">plasma::fmin</a></div><div class="ttdeci">double fmin[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00828">python.h:828</a></div></div>
<div class="ttc" id="structmacro_html_acc6db9c38b22c6e664567d2a46b9b3aa"><div class="ttname"><a href="structmacro.html#acc6db9c38b22c6e664567d2a46b9b3aa">macro::gamma</a></div><div class="ttdeci">double * gamma</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00933">python.h:933</a></div></div>
<div class="ttc" id="structgeometry_html_a03ad5494da00808b0c30accc3ae14985"><div class="ttname"><a href="structgeometry.html#a03ad5494da00808b0c30accc3ae14985">geometry::cool_di_ioniz</a></div><div class="ttdeci">double cool_di_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00534">python.h:534</a></div></div>
<div class="ttc" id="cooling_8c_html_a2a31b4c75dc8f482609abe7b1618a97b"><div class="ttname"><a href="cooling_8c.html#a2a31b4c75dc8f482609abe7b1618a97b">wind_cooling</a></div><div class="ttdeci">double wind_cooling(double f1, double f2)</div><div class="ttdoc">calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non-radiative p...</div><div class="ttdef"><b>Definition:</b> <a href="cooling_8c_source.html#l00329">cooling.c:329</a></div></div>
<div class="ttc" id="structgeometry_html_ace50a76a1673ac116e8a4f8021da250d"><div class="ttname"><a href="structgeometry.html#ace50a76a1673ac116e8a4f8021da250d">geometry::cool_rr</a></div><div class="ttdeci">double cool_rr</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00520">python.h:520</a></div></div>
<div class="ttc" id="structmacro_html_a5a30021fa093059f407675bfde840b34"><div class="ttname"><a href="structmacro.html#a5a30021fa093059f407675bfde840b34">macro::matom_abs</a></div><div class="ttdeci">double * matom_abs</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00965">python.h:965</a></div></div>
<div class="ttc" id="python_8h_html_a0453c2160b73529f8d858dccfc85aad5"><div class="ttname"><a href="python_8h.html#a0453c2160b73529f8d858dccfc85aad5">macromain</a></div><div class="ttdeci">MacroPtr macromain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00986">python.h:986</a></div></div>
<div class="ttc" id="structplasma_html_abded068048bfaf274478a65b26388ed5"><div class="ttname"><a href="structplasma.html#abded068048bfaf274478a65b26388ed5">plasma::xj</a></div><div class="ttdeci">double xj[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00827">python.h:827</a></div></div>
<div class="ttc" id="structplasma_html_aae85efc36fb767cfec53df4cd3327fe8"><div class="ttname"><a href="structplasma.html#aae85efc36fb767cfec53df4cd3327fe8">plasma::pl_log_w</a></div><div class="ttdeci">double pl_log_w[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00893">python.h:893</a></div></div>
<div class="ttc" id="structplasma_html_ae9f6828f63719a3dc2f172573293c4a1"><div class="ttname"><a href="structplasma.html#ae9f6828f63719a3dc2f172573293c4a1">plasma::lum_ff</a></div><div class="ttdeci">double lum_ff</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00843">python.h:843</a></div></div>
<div class="ttc" id="structconfigurations_html_acfee0b128e4e7c2a4e6aea0687a233d9"><div class="ttname"><a href="structconfigurations.html#acfee0b128e4e7c2a4e6aea0687a233d9">configurations::n_bfd_jump</a></div><div class="ttdeci">int n_bfd_jump</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00198">atomic.h:198</a></div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00133">python.h:133</a></div></div>
<div class="ttc" id="structplasma_html_a432a1f85db9000aac743588736fb6048"><div class="ttname"><a href="structplasma.html#a432a1f85db9000aac743588736fb6048">plasma::t_r</a></div><div class="ttdeci">double t_r</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00778">python.h:778</a></div></div>
<div class="ttc" id="structplasma_html_abfec36000559630caf4ec85917950a1e"><div class="ttname"><a href="structplasma.html#abfec36000559630caf4ec85917950a1e">plasma::recomb</a></div><div class="ttdeci">double * recomb</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00811">python.h:811</a></div></div>
<div class="ttc" id="structgeometry_html_a0da2350b57744503e3459adb9e511366"><div class="ttname"><a href="structgeometry.html#a0da2350b57744503e3459adb9e511366">geometry::lum_tot</a></div><div class="ttdeci">double lum_tot</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00504">python.h:504</a></div></div>
<div class="ttc" id="structgeometry_html_a944d56aa7928d99d6e86d355e90e4c3e"><div class="ttname"><a href="structgeometry.html#a944d56aa7928d99d6e86d355e90e4c3e">geometry::const_agn</a></div><div class="ttdeci">double const_agn</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00561">python.h:561</a></div></div>
<div class="ttc" id="foo_8h_html_a6c5300254db561924aba1c13186be975"><div class="ttname"><a href="foo_8h.html#a6c5300254db561924aba1c13186be975">spherical_extend_density</a></div><div class="ttdeci">int spherical_extend_density(int ndom, WindPtr w)</div><div class="ttdoc">extends the density to regions just outside the wind regiions so that extrapolations of density can b...</div><div class="ttdef"><b>Definition:</b> <a href="spherical_8c_source.html#l00516">spherical.c:516</a></div></div>
<div class="ttc" id="structconfigurations_html_abc158a8d23c5630e6eedf3a1866af30c"><div class="ttname"><a href="structconfigurations.html#abc158a8d23c5630e6eedf3a1866af30c">configurations::bfd_indx_first</a></div><div class="ttdeci">int bfd_indx_first</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00209">atomic.h:209</a></div></div>
<div class="ttc" id="structconfigurations_html_a9e1d8406fcb5d8d371e61e11750653a7"><div class="ttname"><a href="structconfigurations.html#a9e1d8406fcb5d8d371e61e11750653a7">configurations::n_bbu_jump</a></div><div class="ttdeci">int n_bbu_jump</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00197">atomic.h:197</a></div></div>
<div class="ttc" id="foo_8h_html_abba07de067655328106ec96798c4794d"><div class="ttname"><a href="foo_8h.html#abba07de067655328106ec96798c4794d">pl_log_w</a></div><div class="ttdeci">double pl_log_w(double j, double alpha, double lnumin, double lnumax)</div><div class="ttdoc">works out the scaling factor for a power law representation of a cell spectrum </div><div class="ttdef"><b>Definition:</b> <a href="spectral__estimators_8c_source.html#l00432">spectral_estimators.c:432</a></div></div>
<div class="ttc" id="structplasma_html_a57a290ba7730852666e194dcd1d594e6"><div class="ttname"><a href="structplasma.html#a57a290ba7730852666e194dcd1d594e6">plasma::comp_nujnu</a></div><div class="ttdeci">double comp_nujnu</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00862">python.h:862</a></div></div>
<div class="ttc" id="structplasma_html_a9b217285a754e1533f95d92972b6afd6"><div class="ttname"><a href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">plasma::t_e</a></div><div class="ttdeci">double t_e</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00779">python.h:779</a></div></div>
<div class="ttc" id="structplasma_html_af8986403a916d5a9f4330ae70aa5e798"><div class="ttname"><a href="structplasma.html#af8986403a916d5a9f4330ae70aa5e798">plasma::xi</a></div><div class="ttdeci">double xi</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00901">python.h:901</a></div></div>
<div class="ttc" id="python_8h_html_a2522d2568f63855838c3ecfb44084710"><div class="ttname"><a href="python_8h.html#a2522d2568f63855838c3ecfb44084710">MIN_TEMP</a></div><div class="ttdeci">#define MIN_TEMP</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01008">python.h:1008</a></div></div>
<div class="ttc" id="python_8h_html_afcc4509571e87828cae153a1eeda870a"><div class="ttname"><a href="python_8h.html#afcc4509571e87828cae153a1eeda870a">nerr_Jmodel_wrong_freq</a></div><div class="ttdeci">int nerr_Jmodel_wrong_freq</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01335">python.h:1335</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_ab47e1e72aea1af4158c96f38ee80b8f7"><div class="ttname"><a href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a></div><div class="ttdeci">int i[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00031">import_cylindrical.c:31</a></div></div>
<div class="ttc" id="structgeometry_html_a12cbfe61b17a74b174a5c7eb8d9dc633"><div class="ttname"><a href="structgeometry.html#a12cbfe61b17a74b174a5c7eb8d9dc633">geometry::lum_wind</a></div><div class="ttdeci">double lum_wind</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00504">python.h:504</a></div></div>
<div class="ttc" id="structplasma_html_a21e7b17fa73a2521fe95247ac0d52d36"><div class="ttname"><a href="structplasma.html#a21e7b17fa73a2521fe95247ac0d52d36">plasma::fmax</a></div><div class="ttdeci">double fmax[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00829">python.h:829</a></div></div>
<div class="ttc" id="structgeometry_html_a9e4e74de249210566125f8254f468184"><div class="ttname"><a href="structgeometry.html#a9e4e74de249210566125f8254f468184">geometry::hydro_domain_number</a></div><div class="ttdeci">int hydro_domain_number</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00330">python.h:330</a></div></div>
<div class="ttc" id="python_8h_html_a33f8696ebd56cd4158a5b519ec627fc5"><div class="ttname"><a href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a></div><div class="ttdeci">struct advanced_modes modes</div></div>
<div class="ttc" id="structgeometry_html_a781ad48d18a8d675b84414f1ba7a352d"><div class="ttname"><a href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">geometry::ndomain</a></div><div class="ttdeci">int ndomain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00312">python.h:312</a></div></div>
<div class="ttc" id="structplasma_html_a1cff49185ad30a6734089a2d2c949fbc"><div class="ttname"><a href="structplasma.html#a1cff49185ad30a6734089a2d2c949fbc">plasma::heat_ion</a></div><div class="ttdeci">double * heat_ion</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00817">python.h:817</a></div></div>
<div class="ttc" id="foo_8h_html_a53e97649d5cd9a1fab024ab99489ddb1"><div class="ttname"><a href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1">alpha_sp</a></div><div class="ttdeci">double alpha_sp(struct topbase_phot *cont_ptr, PlasmaPtr xplasma, int ichoice)</div><div class="ttdef"><b>Definition:</b> <a href="matom_8c_source.html#l00584">matom.c:584</a></div></div>
<div class="ttc" id="cooling_8c_html_acbbafed45b10980bb86fe7950daa0604"><div class="ttname"><a href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604">adiabatic_cooling</a></div><div class="ttdeci">double adiabatic_cooling(WindPtr one, double t)</div><div class="ttdoc">determines the amount of adiabatic cooling in a cell, in units of luminosity. </div><div class="ttdef"><b>Definition:</b> <a href="cooling_8c_source.html#l00270">cooling.c:270</a></div></div>
<div class="ttc" id="structelements_html_a90866d4e99cc142553839ad5e8f13dbc"><div class="ttname"><a href="structelements.html#a90866d4e99cc142553839ad5e8f13dbc">elements::nions</a></div><div class="ttdeci">int nions</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00089">atomic.h:89</a></div></div>
<div class="ttc" id="structplasma_html_a2ed3e67409c1f55ca66cb0cbfbc39ac2"><div class="ttname"><a href="structplasma.html#a2ed3e67409c1f55ca66cb0cbfbc39ac2">plasma::heat_tot</a></div><div class="ttdeci">double heat_tot</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00781">python.h:781</a></div></div>
<div class="ttc" id="structgeometry_html_a5da14a1eb85f3dca6863b6acb86bef12"><div class="ttname"><a href="structgeometry.html#a5da14a1eb85f3dca6863b6acb86bef12">geometry::heat_adiabatic</a></div><div class="ttdeci">double heat_adiabatic</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00525">python.h:525</a></div></div>
<div class="ttc" id="python_8h_html_a3a571e0bd4220490c5c5bd86f51c83ba"><div class="ttname"><a href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a></div><div class="ttdeci">struct geometry geo</div></div>
<div class="ttc" id="structplasma_html_aa9ee2846f568c0a0de1f7848ff747301"><div class="ttname"><a href="structplasma.html#aa9ee2846f568c0a0de1f7848ff747301">plasma::kpkt_abs</a></div><div class="ttdeci">double kpkt_abs</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00770">python.h:770</a></div></div>
<div class="ttc" id="structplasma_html_a9e5f8826f902ac5154fc3c4c67f404e1"><div class="ttname"><a href="structplasma.html#a9e5f8826f902ac5154fc3c4c67f404e1">plasma::lum_tot</a></div><div class="ttdeci">double lum_tot</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00849">python.h:849</a></div></div>
<div class="ttc" id="structmacro_html_a594afc421f440fb2cab4b3a8ef59f582"><div class="ttname"><a href="structmacro.html#a594afc421f440fb2cab4b3a8ef59f582">macro::gamma_e</a></div><div class="ttdeci">double * gamma_e</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00939">python.h:939</a></div></div>
<div class="ttc" id="structgeometry_html_a86b41ec449fc7d2f4ad5532de701481d"><div class="ttname"><a href="structgeometry.html#a86b41ec449fc7d2f4ad5532de701481d">geometry::lum_lines_ioniz</a></div><div class="ttdeci">double lum_lines_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00531">python.h:531</a></div></div>
<div class="ttc" id="wind__updates2d_8c_html_a3c086b2e71aab221283031cdd9ae00ba"><div class="ttname"><a href="wind__updates2d_8c.html#a3c086b2e71aab221283031cdd9ae00ba">num_updates</a></div><div class="ttdeci">int num_updates</div><div class="ttdef"><b>Definition:</b> <a href="wind__updates2d_8c_source.html#l00026">wind_updates2d.c:26</a></div></div>
<div class="ttc" id="structmacro_html_ae3484a034eeddcfd15b61073421412ab"><div class="ttname"><a href="structmacro.html#ae3484a034eeddcfd15b61073421412ab">macro::alpha_st_e</a></div><div class="ttdeci">double * alpha_st_e</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00950">python.h:950</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_adfeea8320d4abaf47212f89ee8f52582"><div class="ttname"><a href="import__cylindrical_8c.html#adfeea8320d4abaf47212f89ee8f52582">rho</a></div><div class="ttdeci">double rho[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00036">import_cylindrical.c:36</a></div></div>
<div class="ttc" id="foo_8h_html_ad06961b0435b7c8b175189291537c20c"><div class="ttname"><a href="foo_8h.html#ad06961b0435b7c8b175189291537c20c">rtheta_extend_density</a></div><div class="ttdeci">int rtheta_extend_density(int ndom, WindPtr w)</div><div class="ttdoc">extends the density to regions just outside the wind regiions so that extrapolations of density can b...</div><div class="ttdef"><b>Definition:</b> <a href="rtheta_8c_source.html#l00842">rtheta.c:842</a></div></div>
<div class="ttc" id="structplasma_html_ab2b017d6fa0e646a4a1d880d49914ef2"><div class="ttname"><a href="structplasma.html#ab2b017d6fa0e646a4a1d880d49914ef2">plasma::heat_lines</a></div><div class="ttdeci">double heat_lines</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00783">python.h:783</a></div></div>
<div class="ttc" id="structplasma_html_a5748c6ee35ca4d9458a8bf20d1930b55"><div class="ttname"><a href="structplasma.html#a5748c6ee35ca4d9458a8bf20d1930b55">plasma::heat_z</a></div><div class="ttdeci">double heat_z</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00788">python.h:788</a></div></div>
<div class="ttc" id="structplasma_html_a0af59963361b8b69b3f29c31a303b7c6"><div class="ttname"><a href="structplasma.html#a0af59963361b8b69b3f29c31a303b7c6">plasma::cool_comp</a></div><div class="ttdeci">double cool_comp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00845">python.h:845</a></div></div>
<div class="ttc" id="structplasma_html_a878263d85482a81865eb7619b3b2a20e"><div class="ttname"><a href="structplasma.html#a878263d85482a81865eb7619b3b2a20e">plasma::heat_auger</a></div><div class="ttdeci">double heat_auger</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00789">python.h:789</a></div></div>
<div class="ttc" id="structgeometry_html_acb8d45c71d7042bd1af56bafe158a10a"><div class="ttname"><a href="structgeometry.html#acb8d45c71d7042bd1af56bafe158a10a">geometry::lum_star</a></div><div class="ttdeci">double lum_star</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00504">python.h:504</a></div></div>
<div class="ttc" id="structplasma_html_a8f5a30977d126bd3ec95bb175056e9c2"><div class="ttname"><a href="structplasma.html#a8f5a30977d126bd3ec95bb175056e9c2">plasma::nxtot</a></div><div class="ttdeci">int nxtot[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00838">python.h:838</a></div></div>
<div class="ttc" id="structplasma_html_af27d3aeeb9b6c87198ebe89c7990ff48"><div class="ttname"><a href="structplasma.html#af27d3aeeb9b6c87198ebe89c7990ff48">plasma::lum_tot_ioniz</a></div><div class="ttdeci">double lum_tot_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00859">python.h:859</a></div></div>
<div class="ttc" id="structmacro_html_a0e9447fef9f2b3b67cf7ca5a8d8dc4e9"><div class="ttname"><a href="structmacro.html#a0e9447fef9f2b3b67cf7ca5a8d8dc4e9">macro::alpha_st</a></div><div class="ttdeci">double * alpha_st</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00945">python.h:945</a></div></div>
<div class="ttc" id="structgeometry_html_acb6781f4d383d99af45505d46f4084de"><div class="ttname"><a href="structgeometry.html#acb6781f4d383d99af45505d46f4084de">geometry::lum_ff_ioniz</a></div><div class="ttdeci">double lum_ff_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00531">python.h:531</a></div></div>
<div class="ttc" id="atomic_8h_html_a3a1abcee874b9a925a5e62f58827fb0f"><div class="ttname"><a href="atomic_8h.html#a3a1abcee874b9a925a5e62f58827fb0f">HEV</a></div><div class="ttdeci">#define HEV</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00009">atomic.h:9</a></div></div>
<div class="ttc" id="python_8h_html_aa9036711b4d1f8345faed617d50f57aa"><div class="ttname"><a href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a></div><div class="ttdeci">int NPLASMA</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00032">python.h:32</a></div></div>
<div class="ttc" id="structplasma_html_a9b46e8bed0dfadca5cf9966301ecec6d"><div class="ttname"><a href="structplasma.html#a9b46e8bed0dfadca5cf9966301ecec6d">plasma::exp_w</a></div><div class="ttdeci">double exp_w[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00897">python.h:897</a></div></div>
<div class="ttc" id="structplasma_html_ac1d38c3e4cc4ef2a1e4d83d7f8b71d22"><div class="ttname"><a href="structplasma.html#ac1d38c3e4cc4ef2a1e4d83d7f8b71d22">plasma::ne</a></div><div class="ttdeci">double ne</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00741">python.h:741</a></div></div>
<div class="ttc" id="structplasma_html_ae8458741703e0a2a71f1b425600b1694"><div class="ttname"><a href="structplasma.html#ae8458741703e0a2a71f1b425600b1694">plasma::lum_lines_ioniz</a></div><div class="ttdeci">double lum_lines_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00853">python.h:853</a></div></div>
<div class="ttc" id="wind__updates2d_8c_html_aa1f75e088856c1c47527ce62bea5c913"><div class="ttname"><a href="wind__updates2d_8c.html#aa1f75e088856c1c47527ce62bea5c913">wind_rad_init</a></div><div class="ttdeci">int wind_rad_init()</div><div class="ttdoc">zeros those portions of the wind which contain the radiation properties of the wind, i.e those portions which should be set to zeroed when the structure of the wind has been changed or when you simply want to start off a calculation in a known state </div><div class="ttdef"><b>Definition:</b> <a href="wind__updates2d_8c_source.html#l01013">wind_updates2d.c:1013</a></div></div>
<div class="ttc" id="structplasma_html_a7bafaea3d058631613ebd1c8a8b8eacc"><div class="ttname"><a href="structplasma.html#a7bafaea3d058631613ebd1c8a8b8eacc">plasma::cool_rr</a></div><div class="ttdeci">double cool_rr</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00848">python.h:848</a></div></div>
<div class="ttc" id="python_8h_html_ac640b7fc429348ef2f6781704d3c5163"><div class="ttname"><a href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a></div><div class="ttdeci">#define NXBANDS</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00473">python.h:473</a></div></div>
<div class="ttc" id="atomic_8h_html_abec92cc72a096640b821b8cd56a02495"><div class="ttname"><a href="atomic_8h.html#abec92cc72a096640b821b8cd56a02495">H</a></div><div class="ttdeci">#define H</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00007">atomic.h:7</a></div></div>
<div class="ttc" id="structplasma_html_aa22c8b26e65db4f93a14fa183d7e09e6"><div class="ttname"><a href="structplasma.html#aa22c8b26e65db4f93a14fa183d7e09e6">plasma::ntot</a></div><div class="ttdeci">int ntot</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00793">python.h:793</a></div></div>
<div class="ttc" id="structplasma_html_a59f1e6f2bf27227a52d45f5c5bff07f6"><div class="ttname"><a href="structplasma.html#a59f1e6f2bf27227a52d45f5c5bff07f6">plasma::cool_rr_metals</a></div><div class="ttdeci">double cool_rr_metals</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00848">python.h:848</a></div></div>
<div class="ttc" id="structplasma_html_acc048dd6ede76041e2a872cdca2ebb8f"><div class="ttname"><a href="structplasma.html#acc048dd6ede76041e2a872cdca2ebb8f">plasma::lum_rr_ioniz</a></div><div class="ttdeci">double lum_rr_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00854">python.h:854</a></div></div>
<div class="ttc" id="structmacro_html_aa33a4e57be212a9a8f49edf6660350cb"><div class="ttname"><a href="structmacro.html#aa33a4e57be212a9a8f49edf6660350cb">macro::recomb_sp</a></div><div class="ttdeci">double * recomb_sp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00955">python.h:955</a></div></div>
<div class="ttc" id="atomic_8h_html_a23ae6a00bed19d2ad34d439636e797da"><div class="ttname"><a href="atomic_8h.html#a23ae6a00bed19d2ad34d439636e797da">nelements</a></div><div class="ttdeci">int nelements</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00055">atomic.h:55</a></div></div>
<div class="ttc" id="structplasma_html_a3a7cb2d0cfcfe01e21e43f7e4fe4e9a8"><div class="ttname"><a href="structplasma.html#a3a7cb2d0cfcfe01e21e43f7e4fe4e9a8">plasma::kpkt_emiss</a></div><div class="ttdeci">double kpkt_emiss</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00767">python.h:767</a></div></div>
<div class="ttc" id="structgeometry_html_aa2ea17f8b23e8e3785c3685c9261a8bf"><div class="ttname"><a href="structgeometry.html#aa2ea17f8b23e8e3785c3685c9261a8bf">geometry::lum_bl</a></div><div class="ttdeci">double lum_bl</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00504">python.h:504</a></div></div>
<div class="ttc" id="structgeometry_html_a034193beb526716a679e7d7b54cf975b"><div class="ttname"><a href="structgeometry.html#a034193beb526716a679e7d7b54cf975b">geometry::cool_dr</a></div><div class="ttdeci">double cool_dr</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00523">python.h:523</a></div></div>
<div class="ttc" id="wind__updates2d_8c_html_a764eaf37b6117ac7a17b1c049c1d2d16"><div class="ttname"><a href="wind__updates2d_8c.html#a764eaf37b6117ac7a17b1c049c1d2d16">LINELEN</a></div><div class="ttdeci">#define LINELEN</div><div class="ttdef"><b>Definition:</b> <a href="wind__updates2d_8c_source.html#l00022">wind_updates2d.c:22</a></div></div>
<div class="ttc" id="foo_8h_html_a626b1882e2533441cdf2daabd36e8a8b"><div class="ttname"><a href="foo_8h.html#a626b1882e2533441cdf2daabd36e8a8b">ion_abundances</a></div><div class="ttdeci">int ion_abundances(PlasmaPtr xplasma, int mode)</div><div class="ttdoc">ionization routines for the wind one cell at a time </div><div class="ttdef"><b>Definition:</b> <a href="ionization_8c_source.html#l00039">ionization.c:39</a></div></div>
<div class="ttc" id="python_8h_html_a052ca1b9e5f22b4f5ad1b3cc8d07cb1c"><div class="ttname"><a href="python_8h.html#a052ca1b9e5f22b4f5ad1b3cc8d07cb1c">nerr_no_Jmodel</a></div><div class="ttdeci">int nerr_no_Jmodel</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01334">python.h:1334</a></div></div>
<div class="ttc" id="python_8h_html_a58b428706c49233f4580ed387c4820c6"><div class="ttname"><a href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a></div><div class="ttdeci">int np_mpi_global</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00007">python.h:7</a></div></div>
<div class="ttc" id="python_8h_html"><div class="ttname"><a href="python_8h.html">python.h</a></div></div>
<div class="ttc" id="structgeometry_html_aaf19a215b47f87b86755371bf9e1f6ce"><div class="ttname"><a href="structgeometry.html#aaf19a215b47f87b86755371bf9e1f6ce">geometry::lum_disk</a></div><div class="ttdeci">double lum_disk</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00504">python.h:504</a></div></div>
<div class="ttc" id="structgeometry_html_a1fb10589781d4853f13cebc8a3731de7"><div class="ttname"><a href="structgeometry.html#a1fb10589781d4853f13cebc8a3731de7">geometry::lum_bl_ioniz</a></div><div class="ttdeci">double lum_bl_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00537">python.h:537</a></div></div>
<div class="ttc" id="structplasma_html_a5505637faee8b3d92778c1948e8b0e35"><div class="ttname"><a href="structplasma.html#a5505637faee8b3d92778c1948e8b0e35">plasma::cool_di</a></div><div class="ttdeci">double cool_di</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00846">python.h:846</a></div></div>
<div class="ttc" id="python_8h_html_a48632b55b333d2627f6a1ddd87b3d7ea"><div class="ttname"><a href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a></div><div class="ttdeci">int rank_global</div><div class="ttdoc">Global variable which holds the number of MPI processes. </div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00009">python.h:9</a></div></div>
<div class="ttc" id="structplasma_html_ae0379496a0c22546580980cccfabf0c2"><div class="ttname"><a href="structplasma.html#ae0379496a0c22546580980cccfabf0c2">plasma::cool_tot_ioniz</a></div><div class="ttdeci">double cool_tot_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00852">python.h:852</a></div></div>
<div class="ttc" id="atomic_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00018">atomic.h:18</a></div></div>
<div class="ttc" id="structgeometry_html_ac01c81c77767f085d2b7b6c15196d512"><div class="ttname"><a href="structgeometry.html#ac01c81c77767f085d2b7b6c15196d512">geometry::cool_comp</a></div><div class="ttdeci">double cool_comp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00521">python.h:521</a></div></div>
<div class="ttc" id="structgeometry_html_af35206adaff2df187ea036302db44248"><div class="ttname"><a href="structgeometry.html#af35206adaff2df187ea036302db44248">geometry::cool_adiabatic</a></div><div class="ttdeci">double cool_adiabatic</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00524">python.h:524</a></div></div>
<div class="ttc" id="atomic_8h_html_a9dc9286373de87e475724fbd5e8c0435"><div class="ttname"><a href="atomic_8h.html#a9dc9286373de87e475724fbd5e8c0435">rho2nh</a></div><div class="ttdeci">double rho2nh</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00096">atomic.h:96</a></div></div>
<div class="ttc" id="structplasma_html_ad5797671f1fe6d9e2a638df668ea51df"><div class="ttname"><a href="structplasma.html#ad5797671f1fe6d9e2a638df668ea51df">plasma::ioniz</a></div><div class="ttdeci">double * ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00811">python.h:811</a></div></div>
<div class="ttc" id="structplasma_html_aec5dcc811c48f5b8f8d195accbdb7813"><div class="ttname"><a href="structplasma.html#aec5dcc811c48f5b8f8d195accbdb7813">plasma::ntot_bl</a></div><div class="ttdeci">int ntot_bl</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00798">python.h:798</a></div></div>
<div class="ttc" id="structplasma_html_acf74d2b82ce1f94cd72b38b432f68774"><div class="ttname"><a href="structplasma.html#acf74d2b82ce1f94cd72b38b432f68774">plasma::ip_direct</a></div><div class="ttdeci">double ip_direct</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00836">python.h:836</a></div></div>
<div class="ttc" id="structplasma_html_a5a044a5991244d771cf0937a322bff4f"><div class="ttname"><a href="structplasma.html#a5a044a5991244d771cf0937a322bff4f">plasma::cool_dr_ioniz</a></div><div class="ttdeci">double cool_dr_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00857">python.h:857</a></div></div>
<div class="ttc" id="structplasma_html_ab2eba1f8343e4767fd32dc914fb95397"><div class="ttname"><a href="structplasma.html#ab2eba1f8343e4767fd32dc914fb95397">plasma::nrad</a></div><div class="ttdeci">int nrad</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00809">python.h:809</a></div></div>
<div class="ttc" id="structconfigurations_html_a006c163c0458412401d44aca2d8b228d"><div class="ttname"><a href="structconfigurations.html#a006c163c0458412401d44aca2d8b228d">configurations::bbu_indx_first</a></div><div class="ttdeci">int bbu_indx_first</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00207">atomic.h:207</a></div></div>
<div class="ttc" id="structplasma_html_aadd0d71f61d6ed95a48af999a14784e0"><div class="ttname"><a href="structplasma.html#aadd0d71f61d6ed95a48af999a14784e0">plasma::heat_ff</a></div><div class="ttdeci">double heat_ff</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00783">python.h:783</a></div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3">CYLVAR</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00136">python.h:136</a></div></div>
<div class="ttc" id="log_8h_html_a4f4caa375f1c3a9def422000f305cce5"><div class="ttname"><a href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="ttdeci">int Error(char *format,...)</div><div class="ttdoc">Print/write out an error message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00402">xlog.c:402</a></div></div>
<div class="ttc" id="atomic_8h_html"><div class="ttname"><a href="atomic_8h.html">atomic.h</a></div></div>
<div class="ttc" id="atomic_8h_html_a684683fca9c02a1eb50bd3125efdaa2c"><div class="ttname"><a href="atomic_8h.html#a684683fca9c02a1eb50bd3125efdaa2c">config</a></div><div class="ttdeci">ConfigPtr config</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00214">atomic.h:214</a></div></div>
<div class="ttc" id="structplasma_html_ada72c65c218f315e543710ce8808e225"><div class="ttname"><a href="structplasma.html#ada72c65c218f315e543710ce8808e225">plasma::nioniz</a></div><div class="ttdeci">int nioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00810">python.h:810</a></div></div>
<div class="ttc" id="structplasma_html_a9ef4bb2909c072cb6155880d3114c95f"><div class="ttname"><a href="structplasma.html#a9ef4bb2909c072cb6155880d3114c95f">plasma::ave_freq</a></div><div class="ttdeci">double ave_freq</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00825">python.h:825</a></div></div>
<div class="ttc" id="structgeometry_html_a18e62e654ed4ff9814d48494cba520de"><div class="ttname"><a href="structgeometry.html#a18e62e654ed4ff9814d48494cba520de">geometry::lum_lines</a></div><div class="ttdeci">double lum_lines</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00519">python.h:519</a></div></div>
<div class="ttc" id="structgeometry_html_a98d8096a2c1b3144efd5899f25402f7d"><div class="ttname"><a href="structgeometry.html#a98d8096a2c1b3144efd5899f25402f7d">geometry::ioniz_mode</a></div><div class="ttdeci">int ioniz_mode</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00406">python.h:406</a></div></div>
<div class="ttc" id="foo_8h_html_a834b9001d849a521f4dbf7a0dcb0d012"><div class="ttname"><a href="foo_8h.html#a834b9001d849a521f4dbf7a0dcb0d012">check_convergence</a></div><div class="ttdeci">int check_convergence(void)</div><div class="ttdoc">The routien summarizes the how well the wind converging to a solution as a whole. ...</div><div class="ttdef"><b>Definition:</b> <a href="ionization_8c_source.html#l00278">ionization.c:278</a></div></div>
<div class="ttc" id="structplasma_html_a0dbad3f32ea372492eb73eda0f123899"><div class="ttname"><a href="structplasma.html#a0dbad3f32ea372492eb73eda0f123899">plasma::pl_alpha</a></div><div class="ttdeci">double pl_alpha[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00892">python.h:892</a></div></div>
<div class="ttc" id="structplasma_html_a2e85980821d61738e7b5b6455604066b"><div class="ttname"><a href="structplasma.html#a2e85980821d61738e7b5b6455604066b">plasma::ntot_star</a></div><div class="ttdeci">int ntot_star</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00797">python.h:797</a></div></div>
<div class="ttc" id="structplasma_html_a50251baa932d22c94584c04ce0398a36"><div class="ttname"><a href="structplasma.html#a50251baa932d22c94584c04ce0398a36">plasma::mean_ds</a></div><div class="ttdeci">double mean_ds</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00807">python.h:807</a></div></div>
<div class="ttc" id="structgeometry_html_a4f5794e0b4b6ed3e93a1cbd284132a17"><div class="ttname"><a href="structgeometry.html#a4f5794e0b4b6ed3e93a1cbd284132a17">geometry::adiabatic</a></div><div class="ttdeci">int adiabatic</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00493">python.h:493</a></div></div>
<div class="ttc" id="foo_8h_html_a0018131577a59a5142e3677785504d37"><div class="ttname"><a href="foo_8h.html#a0018131577a59a5142e3677785504d37">lum_lines</a></div><div class="ttdeci">double lum_lines(WindPtr one, int nmin, int nmax)</div><div class="ttdoc">Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines...</div><div class="ttdef"><b>Definition:</b> <a href="lines_8c_source.html#l00103">lines.c:103</a></div></div>
<div class="ttc" id="atomic_8h_html_ae721a9114e3cf54f9bcc3dab31072273"><div class="ttname"><a href="atomic_8h.html#ae721a9114e3cf54f9bcc3dab31072273">ion</a></div><div class="ttdeci">IonPtr ion</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00174">atomic.h:174</a></div></div>
<div class="ttc" id="structplasma_html_a5f4abbbb9eab15f11e28ab7f26421482"><div class="ttname"><a href="structplasma.html#a5f4abbbb9eab15f11e28ab7f26421482">plasma::cool_tot</a></div><div class="ttdeci">double cool_tot</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00840">python.h:840</a></div></div>
<div class="ttc" id="structplasma_html_a30222105e41ccde304250f41d25b5ad7"><div class="ttname"><a href="structplasma.html#a30222105e41ccde304250f41d25b5ad7">plasma::exp_temp</a></div><div class="ttdeci">double exp_temp[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00896">python.h:896</a></div></div>
<div class="ttc" id="structconfigurations_html_aeab07933f8fe82391d5c8f3e4113d1bd"><div class="ttname"><a href="structconfigurations.html#aeab07933f8fe82391d5c8f3e4113d1bd">configurations::n_bfu_jump</a></div><div class="ttdeci">int n_bfu_jump</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00198">atomic.h:198</a></div></div>
<div class="ttc" id="atomic_8h_html_aed5961eebbc0ca048e57fe2ad4cdfab8"><div class="ttname"><a href="atomic_8h.html#aed5961eebbc0ca048e57fe2ad4cdfab8">phot_top</a></div><div class="ttdeci">Topbase_phot phot_top[NLEVELS]</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00360">atomic.h:360</a></div></div>
<div class="ttc" id="python_8h_html_a6e3bf2cbb457970f2ae23c746e8f8ea5"><div class="ttname"><a href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a></div><div class="ttdeci">DomainPtr zdom</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00275">python.h:275</a></div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495">RTHETA</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00135">python.h:135</a></div></div>
<div class="ttc" id="cylind__var_8c_html_a2ec3f5fd8390071adf98cdaee7afb064"><div class="ttname"><a href="cylind__var_8c.html#a2ec3f5fd8390071adf98cdaee7afb064">cylvar_extend_density</a></div><div class="ttdeci">int cylvar_extend_density(int ndom, WindPtr w)</div><div class="ttdoc">extends the density to regions just outside the wind regiions so that extrapolations of density can b...</div><div class="ttdef"><b>Definition:</b> <a href="cylind__var_8c_source.html#l01040">cylind_var.c:1040</a></div></div>
<div class="ttc" id="estimators_8c_html_a0b0bdb47e266cd31f1c381bb2410fa80"><div class="ttname"><a href="estimators_8c.html#a0b0bdb47e266cd31f1c381bb2410fa80">mc_estimator_normalise</a></div><div class="ttdeci">int mc_estimator_normalise(int n)</div><div class="ttdoc">the routine to normalise the matom bb and bf estimators. </div><div class="ttdef"><b>Definition:</b> <a href="estimators_8c_source.html#l00427">estimators.c:427</a></div></div>
<div class="ttc" id="structgeometry_html_ac453ab1a6ed3b90674cd6552c0185bff"><div class="ttname"><a href="structgeometry.html#ac453ab1a6ed3b90674cd6552c0185bff">geometry::macro_simple</a></div><div class="ttdeci">int macro_simple</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00424">python.h:424</a></div></div>
<div class="ttc" id="structgeometry_html_afc49d7aa9f0e9c5792dc2ba38a66a0ab"><div class="ttname"><a href="structgeometry.html#afc49d7aa9f0e9c5792dc2ba38a66a0ab">geometry::lum_agn</a></div><div class="ttdeci">double lum_agn</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00506">python.h:506</a></div></div>
<div class="ttc" id="structadvanced__modes_html_aad0ff1589062988053354087930055bb"><div class="ttname"><a href="structadvanced__modes.html#aad0ff1589062988053354087930055bb">advanced_modes::fixed_temp</a></div><div class="ttdeci">int fixed_temp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01357">python.h:1357</a></div></div>
<div class="ttc" id="atomic_8h_html_ac4cf4b2ab929bd23951a8676eeac086b"><div class="ttname"><a href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div><div class="ttdeci">#define C</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00011">atomic.h:11</a></div></div>
<div class="ttc" id="structplasma_html_af28aff5f32398a703d1423c56a4599c2"><div class="ttname"><a href="structplasma.html#af28aff5f32398a703d1423c56a4599c2">plasma::heat_ind_comp</a></div><div class="ttdeci">double heat_ind_comp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00785">python.h:785</a></div></div>
<div class="ttc" id="atomic_8h_html_aa1487dae81baa2e0a5643e7b571633a0"><div class="ttname"><a href="atomic_8h.html#aa1487dae81baa2e0a5643e7b571633a0">BOLTZMANN</a></div><div class="ttdeci">#define BOLTZMANN</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00013">atomic.h:13</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_a136f2755339206755ab0c02f8e53c5fc"><div class="ttname"><a href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a></div><div class="ttdeci">double z[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00033">import_cylindrical.c:33</a></div></div>
<div class="ttc" id="structlines_html_a3a0d7a9e793ec94dea8247160927062d"><div class="ttname"><a href="structlines.html#a3a0d7a9e793ec94dea8247160927062d">lines::pow</a></div><div class="ttdeci">double pow</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00239">atomic.h:239</a></div></div>
<div class="ttc" id="structplasma_html_a2c31ecbd91d20cf9f4112db1d6150764"><div class="ttname"><a href="structplasma.html#a2c31ecbd91d20cf9f4112db1d6150764">plasma::lum_lines</a></div><div class="ttdeci">double lum_lines</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00843">python.h:843</a></div></div>
<div class="ttc" id="structplasma_html_a247ec26b8304ce5ef0f0489a9a4b6332"><div class="ttname"><a href="structplasma.html#a247ec26b8304ce5ef0f0489a9a4b6332">plasma::cool_rr_ioniz</a></div><div class="ttdeci">double cool_rr_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00858">python.h:858</a></div></div>
<div class="ttc" id="structplasma_html_ac6f1afeb2ed92f59b12ca628a4e75eff"><div class="ttname"><a href="structplasma.html#ac6f1afeb2ed92f59b12ca628a4e75eff">plasma::max_freq</a></div><div class="ttdeci">double max_freq</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00839">python.h:839</a></div></div>
<div class="ttc" id="log_8h_html_aaadbb20af7b628f26e81e4e49b1a379f"><div class="ttname"><a href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a></div><div class="ttdeci">int sane_check(double x)</div><div class="ttdoc">Check that a variable is valid double precision number. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00528">xlog.c:528</a></div></div>
<div class="ttc" id="structplasma_html_a0c76211532161bfdd92ccde2b4aacffd"><div class="ttname"><a href="structplasma.html#a0c76211532161bfdd92ccde2b4aacffd">plasma::ntot_disk</a></div><div class="ttdeci">int ntot_disk</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00799">python.h:799</a></div></div>
<div class="ttc" id="structgeometry_html_a0ac777645064d9406dba3e396f533e49"><div class="ttname"><a href="structgeometry.html#a0ac777645064d9406dba3e396f533e49">geometry::lum_rr</a></div><div class="ttdeci">double lum_rr</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00519">python.h:519</a></div></div>
<div class="ttc" id="structplasma_html_a81aa2849c8ad883b8b23ca7a5e7b7c2f"><div class="ttname"><a href="structplasma.html#a81aa2849c8ad883b8b23ca7a5e7b7c2f">plasma::j</a></div><div class="ttdeci">double j</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00825">python.h:825</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_ad9db47ad8a21025384c0b7f8fc0a61cc"><div class="ttname"><a href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a></div><div class="ttdeci">int j[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00031">import_cylindrical.c:31</a></div></div>
<div class="ttc" id="structgeometry_html_ae7fb58fc78cd9fa02941f1996777efeb"><div class="ttname"><a href="structgeometry.html#ae7fb58fc78cd9fa02941f1996777efeb">geometry::nxfreq</a></div><div class="ttdeci">int nxfreq</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00475">python.h:475</a></div></div>
<div class="ttc" id="python_8h_html_a940291848296c285c722ed248863afc1"><div class="ttname"><a href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a></div><div class="ttdeci">WindPtr wmain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00724">python.h:724</a></div></div>
<div class="ttc" id="structgeometry_html_a2d755a63918d9ad1b454fadb61704ea8"><div class="ttname"><a href="structgeometry.html#a2d755a63918d9ad1b454fadb61704ea8">geometry::lum_star_ioniz</a></div><div class="ttdeci">double lum_star_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00537">python.h:537</a></div></div>
<div class="ttc" id="structgeometry_html_a2f26439a939e5204b627b2f254d64611"><div class="ttname"><a href="structgeometry.html#a2f26439a939e5204b627b2f254d64611">geometry::cool_adiabatic_ioniz</a></div><div class="ttdeci">double cool_adiabatic_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00536">python.h:536</a></div></div>
<div class="ttc" id="structplasma_html_a1ac56fc73e1242bfa9cbb9bfa04e6d38"><div class="ttname"><a href="structplasma.html#a1ac56fc73e1242bfa9cbb9bfa04e6d38">plasma::ip</a></div><div class="ttdeci">double ip</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00900">python.h:900</a></div></div>
<div class="ttc" id="structdomain_html_aeddcae5f993efc8142ee84f461cfcda1"><div class="ttname"><a href="structdomain.html#aeddcae5f993efc8142ee84f461cfcda1">domain::nstart</a></div><div class="ttdeci">int nstart</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00205">python.h:205</a></div></div>
<div class="ttc" id="structgeometry_html_a490f2f429fa56a02a488924e669df079"><div class="ttname"><a href="structgeometry.html#a490f2f429fa56a02a488924e669df079">geometry::cool_di</a></div><div class="ttdeci">double cool_di</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00522">python.h:522</a></div></div>
<div class="ttc" id="structplasma_html_ad69c6b875d8b97df4e10569a06085107"><div class="ttname"><a href="structplasma.html#ad69c6b875d8b97df4e10569a06085107">plasma::cool_dr_ion</a></div><div class="ttdeci">double * cool_dr_ion</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00824">python.h:824</a></div></div>
<div class="ttc" id="wind__updates2d_8c_html_a33b6675f8fdb790ed332fd9f5df994d3"><div class="ttname"><a href="wind__updates2d_8c.html#a33b6675f8fdb790ed332fd9f5df994d3">wind_update</a></div><div class="ttdeci">int wind_update(w)</div><div class="ttdoc">updates the parameters in the wind that are affected by radiation, including ion densities. </div><div class="ttdef"><b>Definition:</b> <a href="wind__updates2d_8c_source.html#l00062">wind_updates2d.c:62</a></div></div>
<div class="ttc" id="structplasma_html_aeffd93110218aa8876f074488b026390"><div class="ttname"><a href="structplasma.html#aeffd93110218aa8876f074488b026390">plasma::rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00742">python.h:742</a></div></div>
<div class="ttc" id="structplasma_html_aacb5d70931f73523be11b5bb9bb051a6"><div class="ttname"><a href="structplasma.html#aacb5d70931f73523be11b5bb9bb051a6">plasma::ntot_agn</a></div><div class="ttdeci">int ntot_agn</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00801">python.h:801</a></div></div>
<div class="ttc" id="structplasma_html_a56c7e960c18e2fc47a147877bc9e5fe8"><div class="ttname"><a href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">plasma::nwind</a></div><div class="ttdeci">int nwind</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00739">python.h:739</a></div></div>
<div class="ttc" id="structplasma_html_ae72cc720bc175444504be8f75d02e4c4"><div class="ttname"><a href="structplasma.html#ae72cc720bc175444504be8f75d02e4c4">plasma::xave_freq</a></div><div class="ttdeci">double xave_freq[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00827">python.h:827</a></div></div>
<div class="ttc" id="structgeometry_html_ab5427d941546abbd887844d9d8c454b8"><div class="ttname"><a href="structgeometry.html#ab5427d941546abbd887844d9d8c454b8">geometry::cool_rr_ioniz</a></div><div class="ttdeci">double cool_rr_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00532">python.h:532</a></div></div>
<div class="ttc" id="structgeometry_html_a27207d7b4e1bef1c57a659354ff5cee9"><div class="ttname"><a href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">geometry::rt_mode</a></div><div class="ttdeci">int rt_mode</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00458">python.h:458</a></div></div>
<div class="ttc" id="structmacro_html_af1f77da4f0d619ccdf0721133c93a5e8"><div class="ttname"><a href="structmacro.html#af1f77da4f0d619ccdf0721133c93a5e8">macro::matom_emiss</a></div><div class="ttdeci">double * matom_emiss</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00961">python.h:961</a></div></div>
<div class="ttc" id="structgeometry_html_af38b024cd6a58bb82576d5766f08b554"><div class="ttname"><a href="structgeometry.html#af38b024cd6a58bb82576d5766f08b554">geometry::cool_dr_ioniz</a></div><div class="ttdeci">double cool_dr_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00535">python.h:535</a></div></div>
<div class="ttc" id="foo_8h_html_ad6d1b9b9650b2f9e2f3bd72bfb5e5382"><div class="ttname"><a href="foo_8h.html#ad6d1b9b9650b2f9e2f3bd72bfb5e5382">exp_w</a></div><div class="ttdeci">double exp_w(double j, double exp_temp, double numin, double numax)</div><div class="ttdoc">This program works out the scaling factor for an exponential representation of a spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="spectral__estimators_8c_source.html#l00600">spectral_estimators.c:600</a></div></div>
<div class="ttc" id="structplasma_html_a7c1a796efafeae5c9aacfbea4e6a79c3"><div class="ttname"><a href="structplasma.html#a7c1a796efafeae5c9aacfbea4e6a79c3">plasma::lum_rr</a></div><div class="ttdeci">double lum_rr</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00844">python.h:844</a></div></div>
<div class="ttc" id="structgeometry_html_a6421e78e4c1922edc8d8db92f4f58bf8"><div class="ttname"><a href="structgeometry.html#a6421e78e4c1922edc8d8db92f4f58bf8">geometry::cool_comp_ioniz</a></div><div class="ttdeci">double cool_comp_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00533">python.h:533</a></div></div>
<div class="ttc" id="atomic_8h_html_a5696fba91c25a0a9593747ac3ca6ebf1"><div class="ttname"><a href="atomic_8h.html#a5696fba91c25a0a9593747ac3ca6ebf1">ele</a></div><div class="ttdeci">ElemPtr ele</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00094">atomic.h:94</a></div></div>
<div class="ttc" id="structmacro_html_a22a281cdcc628db94cb49e1596802c2f"><div class="ttname"><a href="structmacro.html#a22a281cdcc628db94cb49e1596802c2f">macro::kpkt_rates_known</a></div><div class="ttdeci">int kpkt_rates_known</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00970">python.h:970</a></div></div>
<div class="ttc" id="python_8h_html_a0db8a9b5ad5a66e4adc36d0ba68735c8"><div class="ttname"><a href="python_8h.html#a0db8a9b5ad5a66e4adc36d0ba68735c8">SHELL</a></div><div class="ttdeci">#define SHELL</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00154">python.h:154</a></div></div>
<div class="ttc" id="structplasma_html_af6eca6f64a123edc0389b42ace886569"><div class="ttname"><a href="structplasma.html#af6eca6f64a123edc0389b42ace886569">plasma::xsd_freq</a></div><div class="ttdeci">double xsd_freq[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00837">python.h:837</a></div></div>
<div class="ttc" id="python_8h_html_af5711847369600743b86dd27343fab7a"><div class="ttname"><a href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a></div><div class="ttdeci">PlasmaPtr plasmamain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00904">python.h:904</a></div></div>
<div class="ttc" id="structplasma_html_ab5ee24fc4d7c3533aafdde5591bdc0c4"><div class="ttname"><a href="structplasma.html#ab5ee24fc4d7c3533aafdde5591bdc0c4">plasma::abs_photo</a></div><div class="ttdeci">double abs_photo</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00790">python.h:790</a></div></div>
<div class="ttc" id="structplasma_html_ac6e1f1f8827b1bc1a68a437e1e58b001"><div class="ttname"><a href="structplasma.html#ac6e1f1f8827b1bc1a68a437e1e58b001">plasma::heat_comp</a></div><div class="ttdeci">double heat_comp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00784">python.h:784</a></div></div>
<div class="ttc" id="emission_8c_html_ae1d27b840ad2ff21462921fc2aab975c"><div class="ttname"><a href="emission_8c.html#ae1d27b840ad2ff21462921fc2aab975c">wind_luminosity</a></div><div class="ttdeci">double wind_luminosity(double f1, double f2)</div><div class="ttdoc">calculate the luminosity of the entire wind between freqencies f1 and f2 </div><div class="ttdef"><b>Definition:</b> <a href="emission_8c_source.html#l00047">emission.c:47</a></div></div>
<div class="ttc" id="structgeometry_html_a9a16f5c129fc954fd15b38e3cab8e12d"><div class="ttname"><a href="structgeometry.html#a9a16f5c129fc954fd15b38e3cab8e12d">geometry::alpha_agn</a></div><div class="ttdeci">double alpha_agn</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00558">python.h:558</a></div></div>
<div class="ttc" id="structplasma_html_a579b07a98a0b0692e5e6e2465c2ab425"><div class="ttname"><a href="structplasma.html#a579b07a98a0b0692e5e6e2465c2ab425">plasma::n_ds</a></div><div class="ttdeci">int n_ds</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00808">python.h:808</a></div></div>
<div class="ttc" id="structelements_html_a309aeae50d0264cd963f1a1815ce604e"><div class="ttname"><a href="structelements.html#a309aeae50d0264cd963f1a1815ce604e">elements::firstion</a></div><div class="ttdeci">int firstion</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00088">atomic.h:88</a></div></div>
<div class="ttc" id="structplasma_html_a7030de50e435921b13630ea339eb13e9"><div class="ttname"><a href="structplasma.html#a7030de50e435921b13630ea339eb13e9">plasma::cool_adiabatic_ioniz</a></div><div class="ttdeci">double cool_adiabatic_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00853">python.h:853</a></div></div>
<div class="ttc" id="structplasma_html_a82db22eb07618b0844344790fc875166"><div class="ttname"><a href="structplasma.html#a82db22eb07618b0844344790fc875166">plasma::lum_rr_ion</a></div><div class="ttdeci">double * lum_rr_ion</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00821">python.h:821</a></div></div>
<div class="ttc" id="atomic_8h_html_a69a2ae3d514b40bbc28d389b2cebe4dd"><div class="ttname"><a href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a></div><div class="ttdeci">int nions</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00057">atomic.h:57</a></div></div>
<div class="ttc" id="structplasma_html_acf37090e0b83fe81d058f21229a90018"><div class="ttname"><a href="structplasma.html#acf37090e0b83fe81d058f21229a90018">plasma::cool_adiabatic</a></div><div class="ttdeci">double cool_adiabatic</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00843">python.h:843</a></div></div>
<div class="ttc" id="structgeometry_html_a582d41699eec31287462c428fdddc794"><div class="ttname"><a href="structgeometry.html#a582d41699eec31287462c428fdddc794">geometry::lum_disk_ioniz</a></div><div class="ttdeci">double lum_disk_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00537">python.h:537</a></div></div>
<div class="ttc" id="structplasma_html_a2878212449ef25989225a975f81679fd"><div class="ttname"><a href="structplasma.html#a2878212449ef25989225a975f81679fd">plasma::heat_photo</a></div><div class="ttdeci">double heat_photo</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00788">python.h:788</a></div></div>
<div class="ttc" id="structgeometry_html_a55e4a3bbbfd77b3c28361c304fbf3f9c"><div class="ttname"><a href="structgeometry.html#a55e4a3bbbfd77b3c28361c304fbf3f9c">geometry::lum_wind_ioniz</a></div><div class="ttdeci">double lum_wind_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00537">python.h:537</a></div></div>
<div class="ttc" id="structplasma_html_a90c93c3a8fb77ca113fa5837491fe967"><div class="ttname"><a href="structplasma.html#a90c93c3a8fb77ca113fa5837491fe967">plasma::cool_comp_ioniz</a></div><div class="ttdeci">double cool_comp_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00855">python.h:855</a></div></div>
<div class="ttc" id="structplasma_html_a1ded6465a492ddef36a6ef7a555359ec"><div class="ttname"><a href="structplasma.html#a1ded6465a492ddef36a6ef7a555359ec">plasma::cool_rr_metals_ioniz</a></div><div class="ttdeci">double cool_rr_metals_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00858">python.h:858</a></div></div>
<div class="ttc" id="atomic_8h_html_a258a69e883c6cbadd396857a37d8d85b"><div class="ttname"><a href="atomic_8h.html#a258a69e883c6cbadd396857a37d8d85b">nlevels_macro</a></div><div class="ttdeci">int nlevels_macro</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00063">atomic.h:63</a></div></div>
<div class="ttc" id="structplasma_html_a671e4d660694e4fef07580536f729bfb"><div class="ttname"><a href="structplasma.html#a671e4d660694e4fef07580536f729bfb">plasma::abs_tot</a></div><div class="ttdeci">double abs_tot</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00782">python.h:782</a></div></div>
<div class="ttc" id="structtopbase__phot_html_a0552ae390dbc87aa64fdd05d32227006"><div class="ttname"><a href="structtopbase__phot.html#a0552ae390dbc87aa64fdd05d32227006">topbase_phot::macro_info</a></div><div class="ttdeci">int macro_info</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00344">atomic.h:344</a></div></div>
<div class="ttc" id="structgeometry_html_a92919e08f4d71df33037c81013754c9d"><div class="ttname"><a href="structgeometry.html#a92919e08f4d71df33037c81013754c9d">geometry::lum_tot_ioniz</a></div><div class="ttdeci">double lum_tot_ioniz</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00537">python.h:537</a></div></div>
<div class="ttc" id="structplasma_html_ae4b9e1c0afc70066b36d896e8122513b"><div class="ttname"><a href="structplasma.html#ae4b9e1c0afc70066b36d896e8122513b">plasma::recomb_simple</a></div><div class="ttdeci">double * recomb_simple</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00764">python.h:764</a></div></div>
<div class="ttc" id="foo_8h_html_aed64e9379499a741e8a7c42376e20530"><div class="ttname"><a href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a></div><div class="ttdeci">int wind_n_to_ij(int ndom, int n, int *i, int *j)</div><div class="ttdoc">Translate a cell number in the wind to the two-d grid position in a specific domain. </div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00539">util.c:539</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="wind__updates2d_8c.html">wind_updates2d.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
