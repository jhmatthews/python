<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/get_atomicdata.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('get__atomicdata_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">get_atomicdata.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Read in all of the atomic data for use with Python.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for get_atomicdata.c:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2get__atomicdata_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2get__atomicdata_8c" id="_2_users_2mhewitt_2python_2source_2get__atomicdata_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="399,95,443,121"/>
</map>
</div>
</div>
<p><a href="get__atomicdata_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a10e8c7b8458375c3dbfbb4010a2aba8c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#a10e8c7b8458375c3dbfbb4010a2aba8c">LINELENGTH</a>&#160;&#160;&#160;400</td></tr>
<tr class="separator:a10e8c7b8458375c3dbfbb4010a2aba8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6b319146daf33409da1bbe4194553dc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#aa6b319146daf33409da1bbe4194553dc">MAXWORDS</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:aa6b319146daf33409da1bbe4194553dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae8afa865c507915363062a5abd9c32b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#ae8afa865c507915363062a5abd9c32b7">get_atomic_data</a> (masterfile)</td></tr>
<tr class="memdesc:ae8afa865c507915363062a5abd9c32b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">generalized subroutine for reading atomic data into a set of structures defined in "atomic.h"  <a href="#ae8afa865c507915363062a5abd9c32b7">More...</a><br /></td></tr>
<tr class="separator:ae8afa865c507915363062a5abd9c32b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc99f9b470fbc92f6639124ac0063544"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#abc99f9b470fbc92f6639124ac0063544">index_lines</a> ()</td></tr>
<tr class="memdesc:abc99f9b470fbc92f6639124ac0063544"><td class="mdescLeft">&#160;</td><td class="mdescRight">sort the lines into frequency order  <a href="#abc99f9b470fbc92f6639124ac0063544">More...</a><br /></td></tr>
<tr class="separator:abc99f9b470fbc92f6639124ac0063544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae59f3a5d2afc543ec30ab6b7bce2c4a6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#ae59f3a5d2afc543ec30ab6b7bce2c4a6">index_phot_top</a> ()</td></tr>
<tr class="memdesc:ae59f3a5d2afc543ec30ab6b7bce2c4a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index the topbase photoionzation crossections by frequency.  <a href="#ae59f3a5d2afc543ec30ab6b7bce2c4a6">More...</a><br /></td></tr>
<tr class="separator:ae59f3a5d2afc543ec30ab6b7bce2c4a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa7775c752a4d5b3ea08fbd4f6395c40"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#aaa7775c752a4d5b3ea08fbd4f6395c40">index_inner_cross</a> ()</td></tr>
<tr class="memdesc:aaa7775c752a4d5b3ea08fbd4f6395c40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index inner shell xsections in frequency order.  <a href="#aaa7775c752a4d5b3ea08fbd4f6395c40">More...</a><br /></td></tr>
<tr class="separator:aaa7775c752a4d5b3ea08fbd4f6395c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af383eba7daf26143d507e52d54ea5253"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#af383eba7daf26143d507e52d54ea5253">index_collisions</a> ()</td></tr>
<tr class="memdesc:af383eba7daf26143d507e52d54ea5253"><td class="mdescLeft">&#160;</td><td class="mdescRight">sorts the collisional lines into frequency order  <a href="#af383eba7daf26143d507e52d54ea5253">More...</a><br /></td></tr>
<tr class="separator:af383eba7daf26143d507e52d54ea5253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b5d80d6f35b55e30551b5ae6b5cc269"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#a8b5d80d6f35b55e30551b5ae6b5cc269">indexx</a> (int n, arrin, indx)</td></tr>
<tr class="memdesc:a8b5d80d6f35b55e30551b5ae6b5cc269"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numerical recipes routine used by various routines to sort the atomic data.  <a href="#a8b5d80d6f35b55e30551b5ae6b5cc269">More...</a><br /></td></tr>
<tr class="separator:a8b5d80d6f35b55e30551b5ae6b5cc269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cf338374390539709c962c60a953c3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#a8cf338374390539709c962c60a953c3d">limit_lines</a> (double freqmin, double freqmax)</td></tr>
<tr class="memdesc:a8cf338374390539709c962c60a953c3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">(freqmin,freqmax) sets the the current values of line_min and line_max in <a class="el" href="atomic_8h.html">atomic.h</a> which can be used to limit the lines searched for resonances to a specific frequency range.  <a href="#a8cf338374390539709c962c60a953c3d">More...</a><br /></td></tr>
<tr class="separator:a8cf338374390539709c962c60a953c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bf9a7561e34466897cf3261381d56eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__atomicdata_8c.html#a7bf9a7561e34466897cf3261381d56eb">check_xsections</a> ()</td></tr>
<tr class="memdesc:a7bf9a7561e34466897cf3261381d56eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform sanity checks on xsection data.  <a href="#a7bf9a7561e34466897cf3261381d56eb">More...</a><br /></td></tr>
<tr class="separator:a7bf9a7561e34466897cf3261381d56eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Read in all of the atomic data for use with Python. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a10e8c7b8458375c3dbfbb4010a2aba8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10e8c7b8458375c3dbfbb4010a2aba8c">&#9670;&nbsp;</a></span>LINELENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LINELENGTH&#160;&#160;&#160;400</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l00159">159</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>

</div>
</div>
<a id="aa6b319146daf33409da1bbe4194553dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6b319146daf33409da1bbe4194553dc">&#9670;&nbsp;</a></span>MAXWORDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXWORDS&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l00160">160</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7bf9a7561e34466897cf3261381d56eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bf9a7561e34466897cf3261381d56eb">&#9670;&nbsp;</a></span>check_xsections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_xsections </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform sanity checks on xsection data. </p>
<dl class="section return"><dt>Returns</dt><dd>Alway returns 0; errors are written to the log file</dd></dl>
<p>Results are written to the log file</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000030">Bug:</a></b></dt><dd>A careful look at this routine is warranted as get_atomic_data has changed over the years.</dd></dl>

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l03779">3779</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_cgraph.png" border="0" usemap="#get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_cgraph" alt=""/></div>
<map name="get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_cgraph" id="get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa" title="Print/write to a file a special message for debugging. " alt="" coords="252,5,304,32"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="149,56,193,83"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="611,81,668,108"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="241,157,315,184"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="363,132,452,159"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="385,183,429,209"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="512,107,551,133"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="500,157,563,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_icgraph.png" border="0" usemap="#get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_icgraph" alt=""/></div>
<map name="get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_icgraph" id="get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_icgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#ae8afa865c507915363062a5abd9c32b7" title="generalized subroutine for reading atomic data into a set of structures defined in &quot;atomic..." alt="" coords="149,5,245,32"/>
</map>
</div>

</div>
</div>
<a id="ae8afa865c507915363062a5abd9c32b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8afa865c507915363062a5abd9c32b7">&#9670;&nbsp;</a></span>get_atomic_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_atomic_data </td>
          <td>(</td>
          <td class="paramtype">masterfile&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generalized subroutine for reading atomic data into a set of structures defined in "atomic.h" </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>masterfile[] The name of the "masterfile" which refers to other files which contain the data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>get_atomic_data reads in all the atomic data. It also converts the data to cgs units unless otherwise noted, e.g ionization potentials are converted to ergs.</p>
<p>The masterfile is a list of other files, which contain atomic data for specific puruposes.</p>
<p>All of the files are ascii. The information is keyword based.</p>
<p>The order of the data is important. Elements should be defined before ions; ions before levels, levels before lines etc. In most if not all cases, one can either define all of the elements first, all of the ions, etc ... or the first element and its ions, the second element and its ions etc. Commenting out an element in the datafile has the effect of eliminating all of the data associated with that element, e.g ions, lines, etc.</p>
<p>The program assumes that the ions for a given element are grouped together, that the levels for a given element are grouped together, etc.</p>
<p>If one wants to read both Topbase and VFKY photoionization x-sections, then the topbase x-sections should be read first. The routine will ignore data in the VFKY list if there is a pre-existing Topbase data. The routine will stop if you but a VFKY x-section first on the assumption that Topbase data should trump VFKY data. (Making the program more flexible would be difficult because you would have to drop various bits of Topbase data out of the middle of the structure or mark it NG or something.)</p>
<p>Similarly, as a general rule the macro information should be provided before the simple ions are described, and the macro lines should be presented before simple lines.</p>
<p>The only data which can be mixed up completely is the line array.</p>
<p>Finally, get_atomic_data creates a pointer array to lines, which has the lines in frequency ascending order. This is actually done by a small subroutine index_lines which in turn calls a Numerical Recipes routine.</p>
<h3>Notes</h3>
<p>get_atomic data is intended to be stand-alone, that is one should be able to use it for routines other than Python, e.g for another routine intended to calculate the ionization state of a plasma in colissional equlibrium</p>
<p>To this end, the routines populate stuctures in <a class="el" href="atomic_8h.html">atomic.h</a>, which are not part of <a class="el" href="python_8h.html">python.h</a>. It's imporant that future modificatiosn to get_atomic_data maintain this indepence.. </p>
<h1><a class="anchor" id="Elements"></a>
Elements</h1>
<p>A typical element has the following format</p>
<p>Element 6 C 8.56</p>
<p>where 6 here refers to z of the elemnt, C is the name, and 8.56 is the abundance relative to H at 12</p>
<h1><a class="anchor" id="Ions"></a>
Ions</h1>
<p>Ions are specified with the keyword Ion. A typical entry for ions looks like</p>
<pre class="fragment">*  IonV    C   6   4   2   64.49400 1000   10     1s^22s(2S_{1/2})
*  </pre><p>where C is the elment name, 6 is the elemnt z, 4 is the ionization state (in conventional astrophysics notation, 2 is the mulitplicity of the ground state, and 1000 and 10 refer to maximum number of allowed LTE and nLTE configurations. The configuration is not actually required and is for information only.</p>
<p>Note that keyword parsing is done only on the first 3 letters, so Ion and IonV are equivlalent</p>
<p>The routine still supports an earlier format which comisists of the first 6 "words" in which case default values are assigned to for the maximum number of LTE/simple and nLTE/macro atom configurations.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000026">Bug:</a></b></dt><dd>Exactly what is meant by LTE here needs clarification.</dd></dl>
<h1><a class="anchor" id="levels"></a>
Levels or Configurations</h1>
<p>This version of get_atomicdata can read various types of configuration inputs, some of which should gradually be exsized from the program. Originally, the idea was that Levels would immediately follow an ion, and in that case all that was need to describe a level, was a level number, a multiplicity, and an energy for the level. An example of this type of line follows:</p>
<pre class="fragment">*  Ion  He  2   1   1   24.587  6 2
*  Level 1 1 0.0
*  Level 2 3 19.819
*  </pre><p>It is a requirement that when an OLDSTYLE line is used, it must immediately follow the ion.</p>
<p>The second type of LEVEL style was developed solely to allow the levels to be disjoint from the ions. Disjoint in this case implies that the level must follow the ion, but it does not have to be immediately after the ion line.</p>
<p>It was developed to allow one to use levels developed from the Kurucz line list, and the new Verner level file.</p>
<p>A typical KURUCZSTYLE record would look like:</p>
<pre class="fragment">*  Comment-- Ion H  1
*  \# There are 17 unique levels for 1 1
*  Level   1   1   0    2   0.000000
*  Level   1   1   1    2  10.200121
*  Level   1   1   2    4  10.200166
*  Level   1   1   3    2  12.089051
*  </pre><p> where the colums are z, istate (in conventianal notation), a unique level no, the multiplicity of the level and the exitation energy of the level in eV</p>
<p>The new Topbase style records (created by py_parse_levels) look like this:</p>
<pre class="fragment">*  ======================================================================================
*  #      i NZ NE iSLP iLV iCONF                 E(RYD)      TE(RYD)   gi     EQN    RL(NS)
*  # ======================================================================================
*  # ======================================================================================
*  LevTop  1  1  200  1 -13.605698   0.000000  2  1.0000 1.00e+21 () 1s
*  LevTop  1  1  200  2  -3.401425  10.204273  2  2.0000 1.00e+21 () 2s
*  LevTop  1  1  211  1  -3.401425  10.204273  6  2.0000 1.60e-09 () 2p
*  LevTop  1  1  220  1  -1.511743  12.093955 10  3.0000 1.55e-08 () 3d
*  LevTop  1  1  200  3  -1.511743  12.093955  2  3.0000 1.59e-07 () 3s
*  LevTop  1  1  211  2  -1.511743  12.093955  6  3.0000 5.28e-09 () 3p
*  LevTop  2  1  100  1 -24.310389   0.000000  1  0.7481 1.00e+21 1s2
*  LevTop  2  1  300  1  -4.766334  19.544041  3  1.6895 1.00e+21 1s 2s
*  LevTop  2  1  100  2  -3.941516  20.368818  1  1.8579 1.00e+21 1s 2s
*  </pre><p>The details are:</p>
<table class="doxtable">
<tr>
<th>Col </th><th>Name </th><th>Description  </th></tr>
<tr>
<td>2 </td><td>NZ </td><td>the atomic number of the level </td></tr>
<tr>
<td>3 </td><td>NE </td><td>the ionization state according to the usual astronomical convention. </td></tr>
<tr>
<td></td><td></td><td>Note that Topbase uses the number of electrons but this is fixed in my reformatting program. </td></tr>
<tr>
<td>4 </td><td>iSLP </td><td>A coded version of the angular momentum </td></tr>
<tr>
<td>5 </td><td>iLV </td><td>The level number (starts with 1) </td></tr>
<tr>
<td>6 </td><td><a class="el" href="atomic_8h.html#a07484107e6d9fdf38b53edf631d6511d">E(Ryd)</a> </td><td>The energy in eV relative to the continuum </td></tr>
<tr>
<td>7 </td><td>TE(Ryd) </td><td>The energy in ev realative to the ground state </td></tr>
<tr>
<td>8 </td><td>gi </td><td>The multiplicity </td></tr>
<tr>
<td>9 </td><td>eqn </td><td>The equivalent quantum number (Not necessarily an integer) </td></tr>
<tr>
<td>10 </td><td>rl </td><td>The radiative lifetime </td></tr>
<tr>
<td>11 </td><td>config </td><td>A string showing the configuration </td></tr>
</table>
<h2><a class="anchor" id="matoms"></a>
Macro Atoms (SS)</h2>
<p>When the macro atom method is to be used the level data should look like: e.g.</p>
<pre class="fragment">*  #         z ion lvl ion_pot   ex_energy  g  rad_rate
*  LevMacro  1  1  1 -13.605698   0.000000  2  1.00e+21 () n=1
*  LevMacro  1  1  2  -3.401425  10.204273  8  1.60e-09 () n=2
*  LevMacro  1  1  3  -1.511743  12.093955 18  1.00e-08 () n=3
*  LevMacro  1  1  4  -0.850356  12.755342 32  1.00e-08 () n=4
*  LevMacro  1  2  1   0.000000  13.605698  1  1.00e+21 () cnt
*  </pre><p>The details are:</p>
<table class="doxtable">
<tr>
<th>Col </th><th>Name </th><th>Description  </th></tr>
<tr>
<td>2 </td><td>z </td><td>Atomic number </td></tr>
<tr>
<td>3 </td><td>ion </td><td>Ionisation state (usual astronomical convention: neutral=1) </td></tr>
<tr>
<td>4 </td><td>lvl </td><td>An index for the level: this index must be assigned consistently in all the macro input files </td></tr>
<tr>
<td></td><td></td><td>(i.e. also in photoionisation data). Each level index in a particular ion must be unique. </td></tr>
<tr>
<td>5 </td><td>ion_pot </td><td>Ionisation potential (electron volts) </td></tr>
<tr>
<td>6 </td><td>ex_energy </td><td>Excitation energy (electron volts). A consistent definition of energy=0 must be used for all ions of the same element: </td></tr>
<tr>
<td></td><td></td><td>ground state energy for the neutral species = 0. </td></tr>
<tr>
<td>7 </td><td>g </td><td>Statistical weight </td></tr>
<tr>
<td>8 </td><td>rad_rate </td><td>Radiative lifetime </td></tr>
<tr>
<td>9 </td><td></td><td>A string giving a name for the level (not used by code) </td></tr>
</table>
<h1><a class="anchor" id="Photoionization"></a>
Photoionization</h1>
<p>Until at least Oct 2001, Python used photoionization crossections from Verner, Ferland, Korista, and Yakolev (DFKY) The routine sigma_phot(xptr, freq) calculates the crossection based on this.</p>
<p>The original topbase records look like this</p>
<pre class="fragment">*  ================================================
*        I  NZ  NE  ISLP  ILV        E(RYD)      NP
*  ================================================
*        1   2   1   200    1  -4.00000E+00     101
*   3.960000E+00 1.619E+00
*   4.000000E+00 1.576E+00
*   4.101260E+00 1.474E+00
*   4.205084E+00 1.379E+00
*   4.311536E+00 1.289E+00
*   4.420684E+00 1.206E+00
* </pre><p>They are converted to something that is more compatible with Topbase by py_top_phot</p>
<p>The new topbase style records look like this.</p>
<pre class="fragment">* PhotTopS  2  1 200    1    54.422791 101
* PhotTop    54.422791 1.576e-18
* PhotTop    66.508772 9.197e-19
* PhotTop    78.594753 5.817e-19
* PhotTop    90.680734 3.906e-19
* PhotTop   102.766715 2.746e-19
* PhotTop   114.852696 2.001e-19
* PhotTop   126.938677 1.502e-19
* PhotTop   139.024658 1.155e-19
* PhotTop   151.110639 9.057e-20
* </pre><p>The main changes from the original records are that energy levels have been converted to eV, cross sections to cm**2, and the electron number has been converted to conventional astronomical notiation for the ionstate.</p>
<h3>Macro atoms (SS)</h3>
<p>For the Macro Atom method the input photoionisation data should look like (one entry for every photoionisation process):</p>
<pre class="fragment">* z  ion ll ul   threshold  npts
* PhotMacS  1  1  1  1    13.605698  50
* PhotMac    13.605698 6.304e-18
* PhotMac    16.627193 3.679e-18
* PhotMac    19.648688 2.327e-18
* PhotMac    22.670183 1.563e-18
* PhotMac    25.691679 1.098e-18
* PhotMac    28.713174 8.004e-19
* PhotMac    31.734669 6.006e-19
* PhotMac    34.756165 4.618e-19
* </pre><p>Details for the first row of each entry: </p><table class="doxtable">
<tr>
<th>Col </th><th>Name </th><th>Description  </th></tr>
<tr>
<td>2 </td><td>z </td><td>Atomic number </td></tr>
<tr>
<td>3 </td><td>ion </td><td>Ionisation stage (astronomical convention): LOWER ION (i.e. the one that GETS IONISED) </td></tr>
<tr>
<td></td><td></td><td>it is always assumed that the upper stage is this+1! </td></tr>
<tr>
<td>4 </td><td>ll </td><td>index for the level in the LOWER ION (must match the index given to the level in input level data) </td></tr>
<tr>
<td>5 </td><td>ul </td><td>index for the level in the UPPER ION (must match the index given to the level in the input level data) </td></tr>
<tr>
<td>6 </td><td>thresh</td><td>threshold energy of edge (in eV) </td></tr>
<tr>
<td>7 </td><td>npts </td><td>number of data points in the following table </td></tr>
</table>
<ul>
<li>Then follows the table of energy and cross-section values (same as TopBase above)</li>
<li>04dec ksl Modified this section so that "unknown" level information is skipped so that one need modify only the higher level elements_ions file</li>
</ul>
<h1><a class="anchor" id="Auger"></a>
Auger</h1>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000027">Bug:</a></b></dt><dd>Needs description - this is a type of data that is no longer used </dd></dl>
<h1><a class="anchor" id="Lines"></a>
Lines</h1>
<p>here are various types of line files which get_atomicdata must parse This is the original format</p>
<pre class="fragment">* Line 1 1 1215.673584 0.139000  2  2
* Line 1 1 1215.668213 0.277000  2  4
* </pre><p>This is the first format developed for including excited state lines. It adds the energy of the lower and upper level</p>
<pre class="fragment">* Line  6  3 1174.933000    0.115845   3   5    6.496462   17.050273
* Line  6  3 1175.263000    0.282488   1   3    6.493525   17.044369
* Line  6  3 1175.590000    0.069804   3   3    6.496462   17.044369
* </pre><p>Finally there is a new format developed to link lines to configurations.</p>
<pre class="fragment">* Line  1  1 1215.673584  0.139000   2   2     0.000000    10.200121    0    1
* Line  1  1 1215.668213  0.277000   2   4     0.000000    10.200166    0    2
* </pre><h3>Macro Atoms (SS)</h3>
<p>For the macro atom method the lines are input in the following format:</p>
<pre class="fragment">* # z = element, ion= ionstage, f = osc. str., gl(gu) = stat. we. lower(upper) level
* # el(eu) = energy lower(upper) level (eV), ll(lu) = lvl index lower(upper) level
* #          z ion lambda      f         gl  gu    el          eu          ll   lu
* LinMacro  1  1 1215.671021  0.416200   2   8     0.000000    10.200143    1    2
* LinMacro  1  1 1025.722046  0.079100   2  18     0.000000    12.089062    1    3
* LinMacro  1  1  972.540000  0.028990   2  32     0.000000    12.755342    1    4
* LinMacro  1  1 6562.800000  0.640700   8  18    10.200143    12.089062    2    3
* LinMacro  1  1 4861.320000  0.119300   8  32    10.200143    12.755342    2    4
* LinMacro  1  1 18751.00000  0.842100  18  32    12.089062    12.755342    3    4
* </pre><p>Details:</p>
<table class="doxtable">
<tr>
<th>Col </th><th>Description  </th></tr>
<tr>
<td>2 </td><td>Atomic Number </td></tr>
<tr>
<td>3 </td><td>Ionisation stage (astronomical convention) </td></tr>
<tr>
<td>4 </td><td>Wavelength of transition (AA) </td></tr>
<tr>
<td>5 </td><td>oscillator strength </td></tr>
<tr>
<td>6 </td><td>stat. weight for lower level of transition </td></tr>
<tr>
<td>7 </td><td>stat. weight for upper level of transition </td></tr>
<tr>
<td>8 </td><td>energy of lower level of transition (eV) </td></tr>
<tr>
<td>9 </td><td>energy of upper level of transition (eV) </td></tr>
<tr>
<td>10 </td><td>index for lower level of transition (MUST match the index assigned to this level in level data </td></tr>
<tr>
<td>11 </td><td>index for upper level of transition (MUST match the index assigned to this level in level data </td></tr>
</table>
<p>04dec ksl &ndash; I have modified the next section to try to conform to the "philosophy" of get_atomic_data which is that one does not need to modify the more detailed files, e.g the LinMacro file, if one has eliminated a particular level in the elements ion file. Basically this was accomplished by checking both the upper and lower level and breaking out if either was not accounted for.</p>
<h1><a class="anchor" id="Ground"></a>
state fractions</h1>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000028">Bug:</a></b></dt><dd>This needs a description - it is very old - CK's ground state recombination tables used to compute the zeta term. </dd></dl>
<h1><a class="anchor" id="Collision"></a>
strengths</h1>
<p>@ bug This needs a description</p>
<h1><a class="anchor" id="Dielectronic"></a>
Recombination - type 1</h1>
<p>This section reads in dielectronic recombination rates. The data comes from Chianti, and there are two types of dielectronic data. This is type 1 - which has fis decribed by Arnaud &amp; Raymond (1992) There are two fitting parameters, E and C which represent different degrees in the fit - one sums over a set of parameters.</p>
<p>A typical ion data would look like this</p>
<pre class="fragment">* DR_BADNL E 2 2 4.5560e+05 5.5520e+05 8.9820e+05 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 
* DR_BADNL C 2 2 5.9660e-04 1.6130e-04 -2.2230e-05 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 
</pre><p>where there are two lines for a given ion - this is for helium (z=2) 2 (istate=2)</p>
<h1><a class="anchor" id="Dielectronic"></a>
Recombination - type 1</h1>
<p>This section reads in type 2 dielectronic recombination rates. The data comes from Chianti, and there are two types of dielectronic data. This is type 2 - which has a fit decribed by Shull &amp; van Steenberg (1982) There are four fitting parameters. A typical ion data would look like this</p>
<pre class="fragment">* DR_SHULL 17 2 2.6510e-03 2.9300e-02 2.4120e+05 4.9410e+05 
</pre><p>where there are two lines for a given ion - this is for z=17 (istate=2)</p>
<h1><a class="anchor" id="total"></a>
radiative Recombination rates from Chianti - type 1 and 2</h1>
<p>!RR RATE COEFFICIENT FITS (C)20110412 N. R. BADNELL, DEPARTMENT OF PHYSICS, UNIVERSITY OF STRATHCLYDE, GLASGOW G4 0NG, UK. !This is total radiative rate into all possible states or the recombined ion. !This data was downloaded from <a href="http://amdpp.phys.strath.ac.uk/tamoc/DATA/RR/">http://amdpp.phys.strath.ac.uk/tamoc/DATA/RR/</a> on 13/July/2013 !It is described in <a href="http://adsabs.harvard.edu/abs/2006ApJS..167..334B">http://adsabs.harvard.edu/abs/2006ApJS..167..334B</a> !Only modification to original file is to insert the BAD_T_RR label to the front of each line and comments !There are metastable levels in here, M=1 means we are recombining from the ground state, which is what we tend to want. Some of these have one four parameters, a fit introduced by Verner &amp; Ferland (1996) and some have six, which is from Gu (2003). A four parameter data type is shown below</p>
<pre class="fragment">* !  Z  N  M  W      A        B        T0         T1        C        T2
* BAD_T_RR  1  0  1  1  8.318E-11  0.7472  2.965E+00  7.001E+05
* BAD_T_RR  2  0  1  1  1.818E-10  0.7492  1.017E+01  2.786E+06
* BAD_T_RR  3  0  1  1  2.867E-10  0.7493  2.108E+01  6.268E+06
* BAD_T_RR  4  0  1  1  3.375E-10  0.7475  4.628E+01  1.121E+07
* BAD_T_RR  5  0  1  1  4.647E-10  0.7484  6.142E+01  1.753E+07
* </pre><h1><a class="anchor" id="Total"></a>
radiative recombination - type 3</h1>
<p>These are some rare ion recombination rates that have a two parameter fit by Aldrovandi &amp; Pequignot (1973) They have data like </p><pre class="fragment">* RR_SHULL 22 2 1.0965e-11 6.9901e-01 
* RR_SHULL 22 3 1.8600e-11 7.2800e-01 
* </pre><p>For erroneous historical reasons they are referred to as SHULL</p>
<h1><a class="anchor" id="Ground"></a>
state fractions</h1>
<p>!RR RATE COEFFICIENT FITS (C)20110412 N. R. BADNELL, DEPARTMENT OF PHYSICS, UNIVERSITY OF STRATHCLYDE, GLASGOW G4 0NG, UK. !This is resolved radiative rate from ground state to ground state. !This data was downloaded from <a href="http://amdpp.phys.strath.ac.uk/tamoc/DATA/RR/">http://amdpp.phys.strath.ac.uk/tamoc/DATA/RR/</a> on 13/July/2013 !It is described in <a href="http://adsabs.harvard.edu/abs/2006ApJS..167..334B">http://adsabs.harvard.edu/abs/2006ApJS..167..334B</a> !THe data comes as one file for each ion, with many rates. This file contains the first rate line in each file ! which should relate to the ground state of the upper ion recombining into the ground state of the recombined ion. !The data is tabulated in temperature, first line for each ion is temp, second is rate. !As with other Badnell data, first number is z, second is number of remianing electrons.</p>
<pre class="fragment">* BAD_GS_RR T 1 0 1.00E+01 2.00E+01 5.00E+01 1.00E+02 2.00E+02 5.00E+02 1.00E+03 2.00E+03 5.00E+03 1.00E+04 2.00E+04 5.00E+04 1.00E+05 2.00E+05 5.00E+05 1.00E+06 2.00E+06 5.00E+06 1.00E+07
* BAD_GS_RR R 1 0 5.21E-12 3.68E-12 2.33E-12 1.65E-12 1.16E-12 7.35E-13 5.18E-13 3.65E-13 2.28E-13 1.58E-13 1.08E-13 6.21E-14 3.88E-14 2.28E-14 1.01E-14 5.05E-15 2.36E-15 7.90E-16 3.27E-16
* </pre><h1><a class="anchor" id="gaunt"></a>
factor</h1>
<p>The following are lines to read in temperature averaged free-free gaunt factors from the data of Sutherland (1998). The atomic file is basically unchanged from the data on the website, just with the top few lines commented out, and a label prepended to each line The data is a spline fit to the gaunt factor as a function of g - the reduced temperature. </p><pre class="fragment"> * # log(g^2) &lt;gff(g^2)&gt;       s1           s2            s3
 * # ------------------------------------------------------------
 * FF_GAUNT -4.00 1.113883E+00  1.348000E-02  1.047100E-02 -1.854972E-03
 * FF_GAUNT -3.80 1.116983E+00  1.744580E-02  9.358014E-03  5.564917E-03
 * FF_GAUNT -3.60 1.120891E+00  2.185680E-02  1.269696E-02  4.970250E-03
 * FF_GAUNT -3.40 1.125810E+00  2.753201E-02  1.567911E-02  6.429140E-03
* </pre><h1><a class="anchor" id="direct"></a>
(collisional) ionization data from Dere 07.</h1>
<p>#Title: Ionization rate coefficients for elements H to Zn (Dere+, 2007) #Table J_A_A_466_771_table29: #Title: Spline fits, multiplied by a factor of 10^6^, to the scaled ionization rate coefficients #Column Z (I2) [1/30] Nuclear charge [ucd=phys.atmol.element] #Column Ion (I2) [1/30] Ion (spectroscopic notation) [ucd=phys.atmol.ionStage] #Column Nspl (I2) [15/20] Number of splines [ucd=meta.number] #Column I (F9.3) Ionization potential [ucd=phys.energy;phys.atmol.ionization] #Column Tmin (E10.3) Minimum temperature [ucd=phys.temperature] #Column x1-X20 (F7.4) Scaled temperature 1 (1) [ucd=phys.temperature] #Column rho1 -rho20 (F8.4) ? Scaled rate coefficient 1 (2) [ucd=arith.rate;phys.atmol.collisional]</p>
<h1><a class="anchor" id="Electron"></a>
yield - goes with auger ionization rates</h1>
<p>#This is electron yield data from Kaastra &amp; Mewe (1993) -1993A&amp;AS...97..443K #It is processed from data downloaded from <a href="http://vizier.cfa.harvard.edu/viz-bin/VizieR?-source=J/A+AS/97/443">http://vizier.cfa.harvard.edu/viz-bin/VizieR?-source=J/A+AS/97/443</a> #Via the python script kaastra_2_py.py. Example lines of file below # </p><pre class="fragment">* #Label z state n l IP mean_electron_energy Prob_of_1e Prob_of_2e Prob_of_3e ....
* Kelecyield 4 1 1 0 1.1500e+02 9.280e+01 0.000e+00 1.000e+04 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00
* Kelecyield 5 1 1 0 1.9200e+02 1.639e+02 6.000e+00 9.994e+03 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00
* </pre><h1><a class="anchor" id="Fluorescent"></a>
photon yield from inner shell ionization - not currently used but read in.</h1>
<p>#This is fluorescent yield data from Kaastra &amp; Mewe (1993) -1993A&amp;AS...97..443K #It is processed from data downloaded from <a href="http://vizier.cfa.harvard.edu/viz-bin/VizieR?-source=J/A+AS/97/443">http://vizier.cfa.harvard.edu/viz-bin/VizieR?-source=J/A+AS/97/443</a> #Via the python script kaastra_2_py.py. Data format below # </p><pre class="fragment">* #Label z state n l photon_energy yield
* Kphotyield 5 1 1 0 1.837e+02 6.000e-04
* Kphotyield 5 1 1 0 1.690e+01 7.129e-01
* </pre><h1><a class="anchor" id="Chianti"></a>
Collision Strengths</h1>
<p>The lines below read in collision strength data from Chianti (after Burgess and Tully). The original is stored in .scups files in chianti. The python script searches for matches to the lines_linked_ver_2.py data file, on the basis of energy and oscillator strength (and z and state). As a rather hamfisted approach, all of the line data is stored on the same line as the collision strength data in the file, so it is possible to make a very accurate match. It does mean quite a lot is read in from a line, but most is thrown away. Currently the code below matches based on z, state, upper and lower level numbers and oscillator strength Each line is defned with a set of three lines first line is CSTREN - this contains line data to try and match Second two lines are collision strength data from Burgess and Tully 1992A&amp;A...254..436B These are generally 5 pojnt but up to 20 point spline fits of the T vs upsilon data. Typical lines are below </p><pre class="fragment">CSTREN Line  1  1 1215.673584  0.139000   2   2     0.000000    10.200121    0    1       1      3   7.500e-01   2.772e-01   1.478e+00    5    1   1.700e+00
SCT   0.000e+00   2.500e-01   5.000e-01   7.500e-01   1.000e+00
SCUPS    1.132e-01   2.708e-01   5.017e-01   8.519e-01   1.478e+00        
 * </pre><pre class="fragment"></pre>
<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l00223">223</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7_cgraph.png" border="0" usemap="#get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7_cgraph" alt=""/></div>
<map name="get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7_cgraph" id="get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7_cgraph">
<area shape="rect" id="node2" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="313,29,360,56"/>
<area shape="rect" id="node3" href="compton_8c.html#a5bffcc1725b11f5b35c37b406aaec263" title="The &#39;cooling&#39; cross section correction to Thompson. " alt="" coords="180,67,221,93"/>
<area shape="rect" id="node4" href="get__atomicdata_8c.html#af383eba7daf26143d507e52d54ea5253" title="sorts the collisional lines into frequency order " alt="" coords="155,168,247,195"/>
<area shape="rect" id="node6" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="424,269,492,296"/>
<area shape="rect" id="node8" href="get__atomicdata_8c.html#abc99f9b470fbc92f6639124ac0063544" title="sort the lines into frequency order " alt="" coords="165,219,237,245"/>
<area shape="rect" id="node9" href="get__atomicdata_8c.html#ae59f3a5d2afc543ec30ab6b7bce2c4a6" title="Index the topbase photoionzation crossections by frequency. " alt="" coords="155,269,246,296"/>
<area shape="rect" id="node10" href="get__atomicdata_8c.html#aaa7775c752a4d5b3ea08fbd4f6395c40" title="Index inner shell xsections in frequency order. " alt="" coords="149,320,252,347"/>
<area shape="rect" id="node11" href="get__atomicdata_8c.html#a7bf9a7561e34466897cf3261381d56eb" title="Perform sanity checks on xsection data. " alt="" coords="153,421,249,448"/>
<area shape="rect" id="node12" href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa" title="Print/write to a file a special message for debugging. " alt="" coords="311,371,363,397"/>
<area shape="rect" id="node13" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="315,421,359,448"/>
<area shape="rect" id="node19" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="181,624,220,651"/>
<area shape="rect" id="node20" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="439,624,477,651"/>
<area shape="rect" id="node21" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="300,523,373,549"/>
<area shape="rect" id="node5" href="get__atomicdata_8c.html#a8b5d80d6f35b55e30551b5ae6b5cc269" title="Numerical recipes routine used by various routines to sort the atomic data. " alt="" coords="311,269,362,296"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="791,421,848,448"/>
<area shape="rect" id="node14" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="421,421,495,448"/>
<area shape="rect" id="node15" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="543,472,632,499"/>
<area shape="rect" id="node18" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="565,421,609,448"/>
<area shape="rect" id="node16" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="692,523,731,549"/>
<area shape="rect" id="node17" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="680,472,743,499"/>
</map>
</div>

</div>
</div>
<a id="af383eba7daf26143d507e52d54ea5253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af383eba7daf26143d507e52d54ea5253">&#9670;&nbsp;</a></span>index_collisions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int index_collisions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sorts the collisional lines into frequency order </p>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<h3>Notes</h3>
<p>The results are stored in xcol_ptr </p>

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l03506">3506</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_cgraph.png" border="0" usemap="#get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_cgraph" alt=""/></div>
<map name="get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_cgraph" id="get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_cgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#a8b5d80d6f35b55e30551b5ae6b5cc269" title="Numerical recipes routine used by various routines to sort the atomic data. " alt="" coords="145,5,196,32"/>
<area shape="rect" id="node3" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="244,5,312,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="360,5,417,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_icgraph.png" border="0" usemap="#get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_icgraph" alt=""/></div>
<map name="get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_icgraph" id="get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_icgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#ae8afa865c507915363062a5abd9c32b7" title="generalized subroutine for reading atomic data into a set of structures defined in &quot;atomic..." alt="" coords="145,5,241,32"/>
</map>
</div>

</div>
</div>
<a id="aaa7775c752a4d5b3ea08fbd4f6395c40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa7775c752a4d5b3ea08fbd4f6395c40">&#9670;&nbsp;</a></span>index_inner_cross()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int index_inner_cross </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index inner shell xsections in frequency order. </p>
<dl class="section return"><dt>Returns</dt><dd>Alwasy returns 0</dd></dl>
<p>The rusults are stored in inner_cross_ptr</p>
<h3>Notes</h3>
<p>??? NOTES ??? </p>

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l03448">3448</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_cgraph.png" border="0" usemap="#get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_cgraph" alt=""/></div>
<map name="get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_cgraph" id="get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_cgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#a8b5d80d6f35b55e30551b5ae6b5cc269" title="Numerical recipes routine used by various routines to sort the atomic data. " alt="" coords="156,5,207,32"/>
<area shape="rect" id="node3" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="255,5,323,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="371,5,428,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_icgraph.png" border="0" usemap="#get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_icgraph" alt=""/></div>
<map name="get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_icgraph" id="get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_icgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#ae8afa865c507915363062a5abd9c32b7" title="generalized subroutine for reading atomic data into a set of structures defined in &quot;atomic..." alt="" coords="156,5,252,32"/>
</map>
</div>

</div>
</div>
<a id="abc99f9b470fbc92f6639124ac0063544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc99f9b470fbc92f6639124ac0063544">&#9670;&nbsp;</a></span>index_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int index_lines </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sort the lines into frequency order </p>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<h3>Notes</h3>
<p>All use a Numerical recipes routine indexx for this </p>

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l03333">3333</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_cgraph.png" border="0" usemap="#get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_cgraph" alt=""/></div>
<map name="get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_cgraph" id="get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_cgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#a8b5d80d6f35b55e30551b5ae6b5cc269" title="Numerical recipes routine used by various routines to sort the atomic data. " alt="" coords="125,5,176,32"/>
<area shape="rect" id="node3" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="224,5,292,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="340,5,397,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_icgraph.png" border="0" usemap="#get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_icgraph" alt=""/></div>
<map name="get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_icgraph" id="get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_icgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#ae8afa865c507915363062a5abd9c32b7" title="generalized subroutine for reading atomic data into a set of structures defined in &quot;atomic..." alt="" coords="125,5,221,32"/>
</map>
</div>

</div>
</div>
<a id="ae59f3a5d2afc543ec30ab6b7bce2c4a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae59f3a5d2afc543ec30ab6b7bce2c4a6">&#9670;&nbsp;</a></span>index_phot_top()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int index_phot_top </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index the topbase photoionzation crossections by frequency. </p>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The results are stored in phot_top_ptr</p>
<h3>Notes</h3>
<p>Adapted from index_lines as part to topbase addition to python </p>

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l03394">3394</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_cgraph.png" border="0" usemap="#get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_cgraph" alt=""/></div>
<map name="get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_cgraph" id="get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_cgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#a8b5d80d6f35b55e30551b5ae6b5cc269" title="Numerical recipes routine used by various routines to sort the atomic data. " alt="" coords="144,5,195,32"/>
<area shape="rect" id="node3" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="243,5,311,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="359,5,416,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_icgraph.png" border="0" usemap="#get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_icgraph" alt=""/></div>
<map name="get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_icgraph" id="get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_icgraph">
<area shape="rect" id="node2" href="get__atomicdata_8c.html#ae8afa865c507915363062a5abd9c32b7" title="generalized subroutine for reading atomic data into a set of structures defined in &quot;atomic..." alt="" coords="144,5,240,32"/>
</map>
</div>

</div>
</div>
<a id="a8b5d80d6f35b55e30551b5ae6b5cc269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b5d80d6f35b55e30551b5ae6b5cc269">&#9670;&nbsp;</a></span>indexx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void indexx </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">arrin&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">indx&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Numerical recipes routine used by various routines to sort the atomic data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>n The dimension of the array that needs sorting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">float</td><td>arrin[] The array to sort </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>indx[] The array that contains poionters to the sorted array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>N/A</dd></dl>
<h3>Notes</h3>
<p>See nuerical recipes</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000029">Bug:</a></b></dt><dd>Should probably replaces this with the equivalent gsl routine</dd></dl>

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l03570">3570</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_cgraph.png" border="0" usemap="#get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_cgraph" alt=""/></div>
<map name="get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_cgraph" id="get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="104,5,172,32"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="220,5,277,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_icgraph.png" border="0" usemap="#get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_icgraph" alt=""/></div>
<map name="get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_icgraph" id="get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#af2bf62098e21f43ec0e2cdfc378d447c" title="sort the lines into frequency order " alt="" coords="119,5,191,32"/>
<area shape="rect" id="node4" href="templates_8h.html#a86b680cbcd546a5f06c86c6805fc91c9" title="Index the topbase photoionzation crossections by frequency. " alt="" coords="110,56,201,83"/>
<area shape="rect" id="node5" href="templates_8h.html#a129463b5d8256593b8bdce5bf207a079" title="Index inner shell xsections in frequency order. " alt="" coords="104,107,207,133"/>
<area shape="rect" id="node6" href="templates_8h.html#a3d71a4823d0ecd3c4b591d8da3bd63a7" title="sorts the collisional lines into frequency order " alt="" coords="109,157,201,184"/>
<area shape="rect" id="node3" href="get__atomicdata_8c.html#ae8afa865c507915363062a5abd9c32b7" title="generalized subroutine for reading atomic data into a set of structures defined in &quot;atomic..." alt="" coords="255,81,351,108"/>
</map>
</div>

</div>
</div>
<a id="a8cf338374390539709c962c60a953c3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf338374390539709c962c60a953c3d">&#9670;&nbsp;</a></span>limit_lines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int limit_lines </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(freqmin,freqmax) sets the the current values of line_min and line_max in <a class="el" href="atomic_8h.html">atomic.h</a> which can be used to limit the lines searched for resonances to a specific frequency range. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>freqmin The minimum frequency we are interested in </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>freqmax The maximum frequency we are interested in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of lines that are potentially in resonance.</dd></dl>
<p>If limit_lines returns 0 there are no lines of interest and one does not need to worry about any resonances at this frequency. If limit_lines returns a number greater than 0, then the lines of interest are defined by nline_min and nline_max (inclusive) in <a class="el" href="atomic_8h.html">atomic.h</a> nline_delt is also set which is the number of lines that are in the specified range</p>
<p>limit_lines define the lines that are close to a given frequency. The degree of closeness is defined by v. The routine must be used in conjuction with get_atomic_data which will have created an ordered list of the lines.</p>
<h3>Notes</h3>
<p>Limit_lines needs to be used somewhat carefully. Carefully means checking the return value of limit_lines or equivalently nline_delt=0. If nline_delt=0 then there were no lines in the region of interest. Assuming there were lines in thte range, one must sum over lines from nline_min to nline_max inclusive.</p>
<p>One might wonder why nline_max is not set to one larger than the last line which is in range. This is because depending on how the velocity is trending you may want to sum from the highest frequency line to the lowest. </p>

<p class="definition">Definition at line <a class="el" href="get__atomicdata_8c_source.html#l03707">3707</a> of file <a class="el" href="get__atomicdata_8c_source.html">get_atomicdata.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__atomicdata_8c_a8cf338374390539709c962c60a953c3d_icgraph.png" border="0" usemap="#get__atomicdata_8c_a8cf338374390539709c962c60a953c3d_icgraph" alt=""/></div>
<map name="get__atomicdata_8c_a8cf338374390539709c962c60a953c3d_icgraph" id="get__atomicdata_8c_a8cf338374390539709c962c60a953c3d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="119,5,225,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="133,56,211,83"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="get__atomicdata_8c.html">get_atomicdata.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
