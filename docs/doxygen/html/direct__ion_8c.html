<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/direct_ion.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('direct__ion_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">direct_ion.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>direct_ion contains the routines relating to direct (collisional) ionization and threebody recombination  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="recipes_8h_source.html">recipes.h</a>&quot;</code><br />
<code>#include &lt;gsl/gsl_sf_expint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for direct_ion.c:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2direct__ion_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2direct__ion_8c" id="_2_users_2mhewitt_2python_2source_2direct__ion_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="489,169,552,196"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="237,169,281,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="305,169,368,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="392,169,465,196"/>
</map>
</div>
</div>
<p><a href="direct__ion_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abf8e9c4dba2c37614a969357ccfe830d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#abf8e9c4dba2c37614a969357ccfe830d">ALPHABIG_DIRECT_ION</a>&#160;&#160;&#160;100.</td></tr>
<tr class="separator:abf8e9c4dba2c37614a969357ccfe830d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a71e4aa982b912f78d70646462c6a6115"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115">compute_di_coeffs</a> (double T)</td></tr>
<tr class="memdesc:a71e4aa982b912f78d70646462c6a6115"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes the rates due to direct (collisional) ionization from Dere data.  <a href="#a71e4aa982b912f78d70646462c6a6115">More...</a><br /></td></tr>
<tr class="separator:a71e4aa982b912f78d70646462c6a6115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a22ee2c1e95eae27423b95ce1283f71"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71">q_ioniz_dere</a> (int nion, double t_e)</td></tr>
<tr class="memdesc:a6a22ee2c1e95eae27423b95ce1283f71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the collisional ionization rate coefficient for a given ion/temperature.  <a href="#a6a22ee2c1e95eae27423b95ce1283f71">More...</a><br /></td></tr>
<tr class="separator:a6a22ee2c1e95eae27423b95ce1283f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56f9a736ea5fdd9b253e4a7fa07103ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#a56f9a736ea5fdd9b253e4a7fa07103ce">total_di</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, double t_e)</td></tr>
<tr class="memdesc:a56f9a736ea5fdd9b253e4a7fa07103ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes the total cooling due collisional ionization  <a href="#a56f9a736ea5fdd9b253e4a7fa07103ce">More...</a><br /></td></tr>
<tr class="separator:a56f9a736ea5fdd9b253e4a7fa07103ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd4b2739e1ba69e646c63e7e327583c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#a2cd4b2739e1ba69e646c63e7e327583c">compute_qrecomb_coeffs</a> (double T)</td></tr>
<tr class="memdesc:a2cd4b2739e1ba69e646c63e7e327583c"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes the rate coefficient for three body recombination from Dere data.  <a href="#a2cd4b2739e1ba69e646c63e7e327583c">More...</a><br /></td></tr>
<tr class="separator:a2cd4b2739e1ba69e646c63e7e327583c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193d6c4498adc3507b41e79e52a94016"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016">q_recomb_dere</a> (struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *cont_ptr, double electron_temperature)</td></tr>
<tr class="memdesc:a193d6c4498adc3507b41e79e52a94016"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the collisional recombination co-efficient.  <a href="#a193d6c4498adc3507b41e79e52a94016">More...</a><br /></td></tr>
<tr class="separator:a193d6c4498adc3507b41e79e52a94016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33c3a097208fb519a5e779c62e3d1f3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3">q_ioniz</a> (struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *cont_ptr, double electron_temperature)</td></tr>
<tr class="memdesc:ad33c3a097208fb519a5e779c62e3d1f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the collisional ionization rate co-efficient  <a href="#ad33c3a097208fb519a5e779c62e3d1f3">More...</a><br /></td></tr>
<tr class="separator:ad33c3a097208fb519a5e779c62e3d1f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a432a9569392003e4470067b1c44dca5b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="direct__ion_8c.html#a432a9569392003e4470067b1c44dca5b">q_recomb</a> (struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *cont_ptr, double electron_temperature)</td></tr>
<tr class="memdesc:a432a9569392003e4470067b1c44dca5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a collisional recombination rate co-efficient.  <a href="#a432a9569392003e4470067b1c44dca5b">More...</a><br /></td></tr>
<tr class="separator:a432a9569392003e4470067b1c44dca5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>direct_ion contains the routines relating to direct (collisional) ionization and threebody recombination </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="abf8e9c4dba2c37614a969357ccfe830d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf8e9c4dba2c37614a969357ccfe830d">&#9670;&nbsp;</a></span>ALPHABIG_DIRECT_ION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALPHABIG_DIRECT_ION&#160;&#160;&#160;100.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00025">25</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a71e4aa982b912f78d70646462c6a6115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e4aa982b912f78d70646462c6a6115">&#9670;&nbsp;</a></span>compute_di_coeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compute_di_coeffs </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes the rates due to direct (collisional) ionization from Dere data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>T temperature in K of the cell in question </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success</dd></dl>
<p>This routine controls the calculation of the direct ionization coefficients for each ionic species at a temperature T. They are stored in a global array di_coeffs - usually for use in calculating the ionization balance. The actual calculations are done in a seperate routine, q_ioniz_dere Data is from Ionization rate coefficients for elements H to Zn (Dere+, 2007) Table J_A_A_466_771_table29:</p>
<h3>Notes</h3>
<p>??? NOTES ??? </p>

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00051">51</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_cgraph.png" border="0" usemap="#direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_cgraph" alt=""/></div>
<map name="direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_cgraph" id="direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_cgraph">
<area shape="rect" id="node2" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="159,5,237,32"/>
<area shape="rect" id="node3" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="285,5,353,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="401,5,459,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_icgraph.png" border="0" usemap="#direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_icgraph" alt=""/></div>
<map name="direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_icgraph" id="direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a56f9a736ea5fdd9b253e4a7fa07103ce" title="computes the total cooling due collisional ionization " alt="" coords="194,71,249,98"/>
<area shape="rect" id="node15" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="159,122,284,149"/>
<area shape="rect" id="node3" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="332,71,385,98"/>
<area shape="rect" id="node4" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="437,21,528,47"/>
<area shape="rect" id="node5" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="433,71,532,98"/>
<area shape="rect" id="node10" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="443,122,523,149"/>
<area shape="rect" id="node11" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="450,173,515,199"/>
<area shape="rect" id="node6" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="601,5,705,47"/>
<area shape="rect" id="node7" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="580,71,725,98"/>
<area shape="rect" id="node8" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="615,122,691,149"/>
<area shape="rect" id="node9" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="783,122,827,149"/>
<area shape="rect" id="node12" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="773,198,836,225"/>
<area shape="rect" id="node14" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="626,223,679,250"/>
<area shape="rect" id="node13" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="884,198,980,225"/>
</map>
</div>

</div>
</div>
<a id="a2cd4b2739e1ba69e646c63e7e327583c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cd4b2739e1ba69e646c63e7e327583c">&#9670;&nbsp;</a></span>compute_qrecomb_coeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compute_qrecomb_coeffs </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes the rate coefficient for three body recombination from Dere data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>T Temperature in K </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success</dd></dl>
<p>This routine calculates the three body recombination rate coefficient for all ions in a cell at temperature T. The resulting rate coefficients are stored in a global array for use by the calling routine - normally matrix_ion as part of the search for an ionization balance. It works by essentially applying the Milne relation to collisional ionization data. This is a driver routine, the hard work is done in a seperate routine (q_recomb_dere)</p>
<h3>Notes</h3>
<p>1508 JM coded </p>

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00243">243</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_cgraph.png" border="0" usemap="#direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_cgraph" alt=""/></div>
<map name="direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_cgraph" id="direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="348,92,392,119"/>
<area shape="rect" id="node9" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="191,143,283,169"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="829,117,887,144"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="459,92,532,119"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="581,92,671,119"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="604,143,648,169"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="731,92,769,119"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="719,41,781,68"/>
<area shape="rect" id="node10" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="331,193,409,220"/>
<area shape="rect" id="node12" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="457,143,533,169"/>
<area shape="rect" id="node11" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="592,193,660,220"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_icgraph.png" border="0" usemap="#direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_icgraph" alt=""/></div>
<map name="direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_icgraph" id="direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="191,5,316,32"/>
</map>
</div>

</div>
</div>
<a id="ad33c3a097208fb519a5e779c62e3d1f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad33c3a097208fb519a5e779c62e3d1f3">&#9670;&nbsp;</a></span>q_ioniz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double q_ioniz </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *&#160;</td>
          <td class="paramname"><em>cont_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>electron_temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the collisional ionization rate co-efficient </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">struct</td><td><a class="el" href="structtopbase__phot.html">topbase_phot</a> - pointer to a Topbase style cross section - u </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>electron_temperature - electron temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>collisional ionization rate coefficieient</dd></dl>
<p>This returns the collisional ionization co-efficient Calculated following equation 5-79 of Mihalas or from data from Dere 2007.</p>
<h3>Notes</h3>
<p>This is extrememly similar to the routine compute_di_coeffs apart from the fact that it computes just one rate coefficient, and can use an approximate formula in the absence of data. It is an earlier routine used only in macroatom calculations. </p>

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00387">387</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_cgraph.png" border="0" usemap="#direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_cgraph" alt=""/></div>
<map name="direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_cgraph" id="direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_cgraph">
<area shape="rect" id="node2" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="107,5,185,32"/>
<area shape="rect" id="node3" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="233,5,301,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="349,5,407,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_icgraph.png" border="0" usemap="#direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_icgraph" alt=""/></div>
<map name="direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_icgraph" id="direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="128,249,224,275"/>
<area shape="rect" id="node22" href="templates_8h.html#a00d9c108946340fef4c429a9afdeb110" title="sanity check the stimulated recombination rate " alt="" coords="107,299,245,326"/>
<area shape="rect" id="node24" href="templates_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="137,350,215,377"/>
<area shape="rect" id="node25" href="templates_8h.html#a9301eba8fb39302ef3da90cdb52aef4d" title="The core of the implementation of Macro Atoms in python. " alt="" coords="150,401,202,427"/>
<area shape="rect" id="node26" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="156,451,196,478"/>
<area shape="rect" id="node3" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="313,173,404,199"/>
<area shape="rect" id="node15" href="templates_8h.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="316,249,401,275"/>
<area shape="rect" id="node4" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="511,173,565,199"/>
<area shape="rect" id="node5" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="656,122,755,149"/>
<area shape="rect" id="node10" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="665,173,745,199"/>
<area shape="rect" id="node11" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="673,223,738,250"/>
<area shape="rect" id="node6" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="827,5,931,47"/>
<area shape="rect" id="node7" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="807,71,952,98"/>
<area shape="rect" id="node8" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="841,122,917,149"/>
<area shape="rect" id="node9" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="1015,122,1059,149"/>
<area shape="rect" id="node12" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="1006,211,1069,238"/>
<area shape="rect" id="node14" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="853,223,906,250"/>
<area shape="rect" id="node13" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="1123,211,1219,238"/>
<area shape="rect" id="node16" href="templates_8h.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="492,274,584,301"/>
<area shape="rect" id="node21" href="py__wind__ion_8c.html#ad8a35c03a0bfe326d010682816b450c4" title="Get the total emission of the cells. " alt="" coords="472,325,604,351"/>
<area shape="rect" id="node17" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="666,274,745,301"/>
<area shape="rect" id="node20" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="652,325,759,351"/>
<area shape="rect" id="node18" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="1000,287,1075,314"/>
<area shape="rect" id="node19" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="833,325,926,351"/>
<area shape="rect" id="node23" href="templates_8h.html#a0b0bdb47e266cd31f1c381bb2410fa80" title="the routine to normalise the matom bb and bf estimators. " alt="" coords="293,299,424,326"/>
</map>
</div>

</div>
</div>
<a id="a6a22ee2c1e95eae27423b95ce1283f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a22ee2c1e95eae27423b95ce1283f71">&#9670;&nbsp;</a></span>q_ioniz_dere()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double q_ioniz_dere </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the collisional ionization rate coefficient for a given ion/temperature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nion Index into ion structure for current ion under analysis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t_e Electron temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the collisional ionization rate coefficient</dd></dl>
<p>This uses data from Dere 07 to calculate a collisional ionization rate coefficient. Data is provided as spline fits over a range of temperatures and so an interpolation is required to arrive at the correct data for a given temperature. There is also an exponential integral which is done using a gsl routine.</p>
<h3>Notes</h3>
<p>??? NOTES ??? </p>

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00091">91</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_cgraph.png" border="0" usemap="#direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_cgraph" alt=""/></div>
<map name="direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_cgraph" id="direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="132,5,200,32"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="248,5,305,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_icgraph.png" border="0" usemap="#direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_icgraph" alt=""/></div>
<map name="direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_icgraph" id="direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="132,68,237,95"/>
<area shape="rect" id="node17" href="templates_8h.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="139,208,231,235"/>
<area shape="rect" id="node24" href="templates_8h.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="158,284,211,311"/>
<area shape="rect" id="node3" href="templates_8h.html#a56f9a736ea5fdd9b253e4a7fa07103ce" title="computes the total cooling due collisional ionization " alt="" coords="327,17,382,44"/>
<area shape="rect" id="node16" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="472,119,597,145"/>
<area shape="rect" id="node4" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="508,68,561,95"/>
<area shape="rect" id="node5" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="666,165,757,192"/>
<area shape="rect" id="node6" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="662,64,761,91"/>
<area shape="rect" id="node11" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="671,115,751,141"/>
<area shape="rect" id="node12" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="679,321,744,348"/>
<area shape="rect" id="node7" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="846,57,950,98"/>
<area shape="rect" id="node8" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="825,123,971,149"/>
<area shape="rect" id="node9" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="860,5,936,32"/>
<area shape="rect" id="node10" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="1043,5,1087,32"/>
<area shape="rect" id="node13" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="1034,347,1097,373"/>
<area shape="rect" id="node15" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="871,372,925,399"/>
<area shape="rect" id="node14" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="1160,347,1256,373"/>
<area shape="rect" id="node18" href="templates_8h.html#a2cd4b2739e1ba69e646c63e7e327583c" title="computes the rate coefficient for three body recombination from Dere data. " alt="" coords="286,119,423,145"/>
<area shape="rect" id="node19" href="templates_8h.html#a432a9569392003e4470067b1c44dca5b" title="Returns a collisional recombination rate co&#45;efficient. " alt="" coords="321,220,388,247"/>
<area shape="rect" id="node20" href="templates_8h.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="483,372,586,399"/>
<area shape="rect" id="node22" href="templates_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="496,169,573,196"/>
<area shape="rect" id="node23" href="templates_8h.html#a9301eba8fb39302ef3da90cdb52aef4d" title="The core of the implementation of Macro Atoms in python. " alt="" coords="509,220,561,247"/>
<area shape="rect" id="node21" href="templates_8h.html#a0b0bdb47e266cd31f1c381bb2410fa80" title="the routine to normalise the matom bb and bf estimators. " alt="" coords="646,423,777,449"/>
<area shape="rect" id="node25" href="templates_8h.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="307,372,403,399"/>
<area shape="rect" id="node33" href="templates_8h.html#a00d9c108946340fef4c429a9afdeb110" title="sanity check the stimulated recombination rate " alt="" coords="285,423,424,449"/>
<area shape="rect" id="node34" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="335,271,375,297"/>
<area shape="rect" id="node26" href="templates_8h.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="492,321,577,348"/>
<area shape="rect" id="node27" href="templates_8h.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="665,220,757,247"/>
<area shape="rect" id="node32" href="py__wind__ion_8c.html#ad8a35c03a0bfe326d010682816b450c4" title="Get the total emission of the cells. " alt="" coords="645,271,777,297"/>
<area shape="rect" id="node28" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="859,196,937,223"/>
<area shape="rect" id="node31" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="845,247,951,273"/>
<area shape="rect" id="node29" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="1171,196,1245,223"/>
<area shape="rect" id="node30" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="1019,171,1112,197"/>
</map>
</div>

</div>
</div>
<a id="a432a9569392003e4470067b1c44dca5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a432a9569392003e4470067b1c44dca5b">&#9670;&nbsp;</a></span>q_recomb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double q_recomb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *&#160;</td>
          <td class="paramname"><em>cont_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>electron_temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a collisional recombination rate co-efficient. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> - pointer to a topbase style PI cross section </td></tr>
    <tr><td class="paramname">[in</td><td>out] double electron_temperature - electron temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Collisional recombination rate coefficient</dd></dl>
<p>This equation comes from considering TE and getting the expression q_recomb = 2.07e-16 * gl/gu * exp(E/kT) * (T_e**-3/2) * q_ioniz then substituting the above expression for q_ioniz.</p>
<h3>Notes</h3>
<p>This routine is very similar to compute_qrecomb_coeffs apart from the fact that this routine only computes one recomb coefficient and applies an approximate calculation where dere data is missing. It is used in macroatom calculations. </p>

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00450">450</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a432a9569392003e4470067b1c44dca5b_cgraph.png" border="0" usemap="#direct__ion_8c_a432a9569392003e4470067b1c44dca5b_cgraph" alt=""/></div>
<map name="direct__ion_8c_a432a9569392003e4470067b1c44dca5b_cgraph" id="direct__ion_8c_a432a9569392003e4470067b1c44dca5b_cgraph">
<area shape="rect" id="node2" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="120,81,212,108"/>
<area shape="rect" id="node3" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="260,24,339,51"/>
<area shape="rect" id="node6" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="261,81,337,108"/>
<area shape="rect" id="node12" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="387,132,431,159"/>
<area shape="rect" id="node4" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="481,5,549,32"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="848,81,905,108"/>
<area shape="rect" id="node7" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="387,81,431,108"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="479,107,552,133"/>
<area shape="rect" id="node9" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="600,107,689,133"/>
<area shape="rect" id="node10" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="749,107,788,133"/>
<area shape="rect" id="node11" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="737,157,800,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a432a9569392003e4470067b1c44dca5b_icgraph.png" border="0" usemap="#direct__ion_8c_a432a9569392003e4470067b1c44dca5b_icgraph" alt=""/></div>
<map name="direct__ion_8c_a432a9569392003e4470067b1c44dca5b_icgraph" id="direct__ion_8c_a432a9569392003e4470067b1c44dca5b_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="120,56,223,83"/>
<area shape="rect" id="node8" href="templates_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="133,107,210,133"/>
<area shape="rect" id="node9" href="templates_8h.html#a9301eba8fb39302ef3da90cdb52aef4d" title="The core of the implementation of Macro Atoms in python. " alt="" coords="145,157,197,184"/>
<area shape="rect" id="node3" href="templates_8h.html#a0b0bdb47e266cd31f1c381bb2410fa80" title="the routine to normalise the matom bb and bf estimators. " alt="" coords="271,5,401,32"/>
<area shape="rect" id="node4" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="449,56,503,83"/>
<area shape="rect" id="node7" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="303,107,369,133"/>
<area shape="rect" id="node5" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="551,81,613,108"/>
<area shape="rect" id="node6" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="661,81,757,108"/>
</map>
</div>

</div>
</div>
<a id="a193d6c4498adc3507b41e79e52a94016"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a193d6c4498adc3507b41e79e52a94016">&#9670;&nbsp;</a></span>q_recomb_dere()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double q_recomb_dere </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *&#160;</td>
          <td class="paramname"><em>cont_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>electron_temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the collisional recombination co-efficient. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">struct</td><td><a class="el" href="structtopbase__phot.html">topbase_phot</a> a pointer to the topbdae style PI cross section </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>electron_temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>??? RETURNS ???</dd></dl>
<p>This equation comes from considering TE and getting the expression q_recomb = 2.07e-16 * gl/gu * exp(E/kT) * q_ioniz then substituting the above expression for q_ioniz. We get the ionization threshold from the supplied PI cross section.</p>
<h3>Notes</h3>
<p>??? NOTES ??? </p>

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00315">315</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_cgraph.png" border="0" usemap="#direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_cgraph" alt=""/></div>
<map name="direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_cgraph" id="direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_cgraph">
<area shape="rect" id="node2" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="145,24,224,51"/>
<area shape="rect" id="node5" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="147,81,223,108"/>
<area shape="rect" id="node11" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="272,132,316,159"/>
<area shape="rect" id="node3" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="367,5,435,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="733,81,791,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="272,81,316,108"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="364,107,437,133"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="485,107,575,133"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="635,107,673,133"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="623,157,685,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_icgraph.png" border="0" usemap="#direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_icgraph" alt=""/></div>
<map name="direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_icgraph" id="direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a2cd4b2739e1ba69e646c63e7e327583c" title="computes the rate coefficient for three body recombination from Dere data. " alt="" coords="145,19,283,45"/>
<area shape="rect" id="node4" href="templates_8h.html#a432a9569392003e4470067b1c44dca5b" title="Returns a collisional recombination rate co&#45;efficient. " alt="" coords="181,81,247,108"/>
<area shape="rect" id="node3" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="331,5,456,32"/>
<area shape="rect" id="node5" href="templates_8h.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="342,56,445,83"/>
<area shape="rect" id="node11" href="templates_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="355,107,432,133"/>
<area shape="rect" id="node12" href="templates_8h.html#a9301eba8fb39302ef3da90cdb52aef4d" title="The core of the implementation of Macro Atoms in python. " alt="" coords="367,157,419,184"/>
<area shape="rect" id="node6" href="templates_8h.html#a0b0bdb47e266cd31f1c381bb2410fa80" title="the routine to normalise the matom bb and bf estimators. " alt="" coords="504,5,635,32"/>
<area shape="rect" id="node7" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="683,56,736,83"/>
<area shape="rect" id="node10" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="537,107,602,133"/>
<area shape="rect" id="node8" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="784,81,847,108"/>
<area shape="rect" id="node9" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="895,81,991,108"/>
</map>
</div>

</div>
</div>
<a id="a56f9a736ea5fdd9b253e4a7fa07103ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56f9a736ea5fdd9b253e4a7fa07103ce">&#9670;&nbsp;</a></span>total_di()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double total_di </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes the total cooling due collisional ionization </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one pointer to cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t_e electron temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total di cooling</dd></dl>
<p>This routine computes the total cooling rate in a cell due to collisional ionization. This is just the rate, times the ionization thereshold of the state being recombined into.</p>
<h3>Notes</h3>
<p>??? NOTES ??? </p>

<p class="definition">Definition at line <a class="el" href="direct__ion_8c_source.html#l00183">183</a> of file <a class="el" href="direct__ion_8c_source.html">direct_ion.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_cgraph.png" border="0" usemap="#direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_cgraph" alt=""/></div>
<map name="direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_cgraph" id="direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_cgraph">
<area shape="rect" id="node2" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="108,5,213,32"/>
<area shape="rect" id="node3" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="261,5,340,32"/>
<area shape="rect" id="node4" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="388,5,456,32"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="504,5,561,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_icgraph.png" border="0" usemap="#direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_icgraph" alt=""/></div>
<map name="direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_icgraph" id="direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="108,71,161,98"/>
<area shape="rect" id="node3" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="213,21,304,47"/>
<area shape="rect" id="node4" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="209,71,308,98"/>
<area shape="rect" id="node9" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="219,122,299,149"/>
<area shape="rect" id="node10" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="226,173,291,199"/>
<area shape="rect" id="node5" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="377,5,481,47"/>
<area shape="rect" id="node6" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="356,71,501,98"/>
<area shape="rect" id="node7" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="391,122,467,149"/>
<area shape="rect" id="node8" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="559,122,603,149"/>
<area shape="rect" id="node11" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="549,198,612,225"/>
<area shape="rect" id="node13" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="402,223,455,250"/>
<area shape="rect" id="node12" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="660,198,756,225"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="direct__ion_8c.html">direct_ion.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
