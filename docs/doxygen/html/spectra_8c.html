<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/spectra.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('spectra_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">spectra.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The subroutines in this file handle allocating, incrementing, and writing out the spectrum arrays for Python.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for spectra.c:</div>
<div class="dyncontent">
<div class="center"><img src="spectra_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2spectra_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2spectra_8c" id="_2_users_2mhewitt_2python_2source_2spectra_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="283,169,327,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="351,169,413,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="437,169,511,196"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="535,169,597,196"/>
</map>
</div>
</div>
<p><a href="spectra_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a26cbf4a3506fa195892c934fa79275df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spectra_8c.html#a26cbf4a3506fa195892c934fa79275df">spectrum_init</a> (double f1, double f2, int nangle, angle, phase, scat_select, top_bot_select, int select_extract, rho_select, z_select, az_select, r_select)</td></tr>
<tr class="memdesc:a26cbf4a3506fa195892c934fa79275df"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocates space for and initializes the spectrum arrays, storing the criteria that are later used to create each spectrum.  <a href="#a26cbf4a3506fa195892c934fa79275df">More...</a><br /></td></tr>
<tr class="separator:a26cbf4a3506fa195892c934fa79275df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e05df283bba500d0e7a307679b291d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spectra_8c.html#a3e05df283bba500d0e7a307679b291d6">spectrum_create</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double f1, double f2, int nangle, int select_extract)</td></tr>
<tr class="memdesc:a3e05df283bba500d0e7a307679b291d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increments the spectrum arrays after each flight of photons is processed (during ionization cycles and for detailed spectra in the Live or Die option).  <a href="#a3e05df283bba500d0e7a307679b291d6">More...</a><br /></td></tr>
<tr class="separator:a3e05df283bba500d0e7a307679b291d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e26bf475d028c01075ff128c8c80d57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spectra_8c.html#a9e26bf475d028c01075ff128c8c80d57">spectrum_summary</a> (filename, int nspecmin, int nspecmax, int select_spectype, double <a class="el" href="vvector_8c.html#a8f009c8e40535ce9122cb90112b6e88c">renorm</a>, int loglin, int iwind)</td></tr>
<tr class="memdesc:a9e26bf475d028c01075ff128c8c80d57"><td class="mdescLeft">&#160;</td><td class="mdescRight">(writes out the spectrum to a file  <a href="#a9e26bf475d028c01075ff128c8c80d57">More...</a><br /></td></tr>
<tr class="separator:a9e26bf475d028c01075ff128c8c80d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d37ca5473b25832956cb6988e1b4ed5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spectra_8c.html#a6d37ca5473b25832956cb6988e1b4ed5">spectrum_restart_renormalise</a> (int nangle)</td></tr>
<tr class="memdesc:a6d37ca5473b25832956cb6988e1b4ed5"><td class="mdescLeft">&#160;</td><td class="mdescRight">renormalizes the detailed spectra in case of a restart  <a href="#a6d37ca5473b25832956cb6988e1b4ed5">More...</a><br /></td></tr>
<tr class="separator:a6d37ca5473b25832956cb6988e1b4ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad96cdba540104e93e764a980db99ea4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spectra_8c.html#ad96cdba540104e93e764a980db99ea4e">i_spec_start</a> = 0</td></tr>
<tr class="separator:ad96cdba540104e93e764a980db99ea4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The subroutines in this file handle allocating, incrementing, and writing out the spectrum arrays for Python. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="spectra_8c_source.html">spectra.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3e05df283bba500d0e7a307679b291d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e05df283bba500d0e7a307679b291d6">&#9670;&nbsp;</a></span>spectrum_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spectrum_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nangle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>select_extract</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increments the spectrum arrays after each flight of photons is processed (during ionization cycles and for detailed spectra in the Live or Die option). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p A flight of photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequncy in the spectrum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency in the spectrum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nangle The number of different angles and phases for which to create detailed spectra </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>select_extract The integer stating whether the Live or Die option has </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This routine increments the total spectrum arrays based on what has happened to each photon during ionization cycles. In the Live or Die option, the spectra at specific angles are also created here when detailed spectra are created.</p>
<p>The routine is called after each batch of photons has been transported through the wind and prints some intermediate results to assure the user that the program is still running.</p>
<h3>Notes</h3>
<p>Summing up of the spectra in the "extract" option is done in <a class="el" href="extract_8c.html" title="Maing routines for extracting photons during the spectral generation phase. ">extract.c</a></p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000059">Bug:</a></b></dt><dd>To create spectra in the live or die option which are selected on the number of scatters individual photons undergo, there are some additional changes required to this routine. These changes should parallel those now in extract under the normal option. 97aug29</dd></dl>

<p class="definition">Definition at line <a class="el" href="spectra_8c_source.html#l00427">427</a> of file <a class="el" href="spectra_8c_source.html">spectra.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spectra_8c_a3e05df283bba500d0e7a307679b291d6_cgraph.png" border="0" usemap="#spectra_8c_a3e05df283bba500d0e7a307679b291d6_cgraph" alt=""/></div>
<map name="spectra_8c_a3e05df283bba500d0e7a307679b291d6_cgraph" id="spectra_8c_a3e05df283bba500d0e7a307679b291d6_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="149,125,193,152"/>
<area shape="rect" id="node9" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="259,176,297,202"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="611,74,668,101"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="241,125,315,152"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="363,74,452,101"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="385,125,429,152"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="512,24,551,50"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="500,74,563,101"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spectra_8c_a3e05df283bba500d0e7a307679b291d6_icgraph.png" border="0" usemap="#spectra_8c_a3e05df283bba500d0e7a307679b291d6_icgraph" alt=""/></div>
<map name="spectra_8c_a3e05df283bba500d0e7a307679b291d6_icgraph" id="spectra_8c_a3e05df283bba500d0e7a307679b291d6_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="149,5,259,32"/>
<area shape="rect" id="node3" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="161,56,247,83"/>
</map>
</div>

</div>
</div>
<a id="a26cbf4a3506fa195892c934fa79275df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26cbf4a3506fa195892c934fa79275df">&#9670;&nbsp;</a></span>spectrum_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spectrum_init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nangle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">angle&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">phase&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scat_select&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">top_bot_select&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>select_extract</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rho_select&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">z_select&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">az_select&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">r_select&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocates space for and initializes the spectrum arrays, storing the criteria that are later used to create each spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency for the spectra to be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency in the spectra </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nangle The number of different inclination angles (or more properly the number of spectra) to be created </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>angle[] The inclination angles associated with each spectrum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>phase[] The orbital phase associated with each spectrum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>scat_select[] A parameter for each spectrum which allows one to construct spectra with specifid numbers of scatters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>top_bot_select[] A code which allows one to select photons only from below or above the disk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>select_extract 0 for Live or Die option, non-zero fo a normal extraction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>rho_select[] Rho coordinates for extracting only photons in a particualr region </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>z_select[] Z cooordiante for selecting only photons that scattreed or were created in a praticular region </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>az_select[] Aximuthal angle for selecting only photons in a particular region </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>r_select[] Radius of the region from which to select photons </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The first time spectrum_init is called (i.e. if ispec_start=0), it allocates memory for the various spectrum arrays. (This is done one time, so one needs to allocate space for all the arrays even though they are not all used in the ionization step). The total number of spectra created is nangle+MSPEC.</p>
<p>On subsequent calls to spectrum_init, it rezeros all the spectrum information and calculates the other information associated with each spectrum, such as the angle cosines and the names of each spectrum.</p>
<h3>Notes</h3>
<p>angle[],phase[] and scat_select[] only apply to the spectra extracted at specific angles. angle[0], phase[0], and scat_select[0] all affect spec[3]</p>
<p>scat_select allows one to select spectra with a specific number of scattere or range og scatters. If nscat &gt; 999 select all. This is the normal case. The rest are used largely for diagnostic purposes. If 0 &lt;nscat &lt; MAXScat selected only photons which have scattered nscat times. If nscat is negattive, then all photons with more than |nscat| re included.</p>
<p>If top_bot_select is 0, then all photons are counted in the spectrum; if &gt; 0, then only photons above the disk plane are selected, if &lt;0 only those from below the disk plane are selected.</p>
<p>rho_select,z_select,az_select,r_select define a region of space and can be used to create spectra only from photons that scattered or were created in these particular regions. It is normally only used for diagnostic reasons</p>
<p>Warning - Do not put anything in this routine that does anything but initialize or reinitialize the spectrum structure s. This is important because this routine is not accessed if one is continuing an old calculation of the detailed spectrum. It is still use on a restart where the detailed spectral cycles have not begun because in that case the spectra are not saved. </p>

<p class="definition">Definition at line <a class="el" href="spectra_8c_source.html#l00154">154</a> of file <a class="el" href="spectra_8c_source.html">spectra.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spectra_8c_a26cbf4a3506fa195892c934fa79275df_cgraph.png" border="0" usemap="#spectra_8c_a26cbf4a3506fa195892c934fa79275df_cgraph" alt=""/></div>
<map name="spectra_8c_a26cbf4a3506fa195892c934fa79275df_cgraph" id="spectra_8c_a26cbf4a3506fa195892c934fa79275df_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="135,125,179,152"/>
<area shape="rect" id="node9" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="229,176,297,202"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="596,74,653,101"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="227,125,300,152"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="348,74,437,101"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="371,125,415,152"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="497,24,536,50"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="485,74,548,101"/>
</map>
</div>

</div>
</div>
<a id="a6d37ca5473b25832956cb6988e1b4ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d37ca5473b25832956cb6988e1b4ed5">&#9670;&nbsp;</a></span>spectrum_restart_renormalise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spectrum_restart_renormalise </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nangle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>renormalizes the detailed spectra in case of a restart </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nangle The number of discrete angles </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This routine deals with a very special case when one is restarting a previous run, and adding spectral cycles to obtain a detailed spectrum with higher statistics.</p>
<p>In the previous run, the spectral will have been normalized so that one gets the correct flux for the simulation. We are now computing additional spectral cycles, so we have to reduce the fluxes for the spectral cycles that are read in, so we can continue. renorm_factor = (cycles in old pf file) / (cycles in new pf file)</p>
<h3>Notes</h3>
<p>see Issue #134 </p>

<p class="definition">Definition at line <a class="el" href="spectra_8c_source.html#l01019">1019</a> of file <a class="el" href="spectra_8c_source.html">spectra.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spectra_8c_a6d37ca5473b25832956cb6988e1b4ed5_icgraph.png" border="0" usemap="#spectra_8c_a6d37ca5473b25832956cb6988e1b4ed5_icgraph" alt=""/></div>
<map name="spectra_8c_a6d37ca5473b25832956cb6988e1b4ed5_icgraph" id="spectra_8c_a6d37ca5473b25832956cb6988e1b4ed5_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="208,5,293,32"/>
</map>
</div>

</div>
</div>
<a id="a9e26bf475d028c01075ff128c8c80d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e26bf475d028c01075ff128c8c80d57">&#9670;&nbsp;</a></span>spectrum_summary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spectrum_summary </td>
          <td>(</td>
          <td class="paramtype">filename&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nspecmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nspecmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>select_spectype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>renorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loglin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iwind</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(writes out the spectrum to a file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>filename[] The name of the file to write </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nspecmin The number of the first spectrum to write </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nspecmax The number of the last spectrum to write . </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>select_spectype The type of spectral file you want to create </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>renorm This is renormalization which incrementally decreases to one as the detailed spectral calculation goes forward. It was added to allow one to print out the spectrum at the end of each cycle, rather than the end of the entire calculation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>loglin 0 to print the spectrum out in linear units, 1 in log units </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iwind If false (0), print out the normal spectrum; if true (1), print out only photons that were scattered or created in the wind.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0, unless there is a major problem in which case the program exits</dd></dl>
<p>This simple routine simply writes the spectra to a file in an easily interpretable ascii format. Normally one would write all of the spectra in one go, but one can use spectrum summary to write various spectra to various files by using the variables nspecmin and nspecmax..</p>
<p>Normally s[0],s[1],and s[2] will be the escaping, scattered, and absorbed spectrum. The rest will be those which have been "extracted".</p>
<p>It can be called multiple times. In Python, it is currently called twice, once at the end of the ionization stage and once when computation of the detailed spectra are completed.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="spectra_8c_source.html#l00827">827</a> of file <a class="el" href="spectra_8c_source.html">spectra.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spectra_8c_a9e26bf475d028c01075ff128c8c80d57_cgraph.png" border="0" usemap="#spectra_8c_a9e26bf475d028c01075ff128c8c80d57_cgraph" alt=""/></div>
<map name="spectra_8c_a9e26bf475d028c01075ff128c8c80d57_cgraph" id="spectra_8c_a9e26bf475d028c01075ff128c8c80d57_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="177,15,221,41"/>
<area shape="rect" id="node9" href="foo_8h.html#aa3b24089fadbcdf92560f31730390556" title="get_time" alt="" coords="169,65,229,92"/>
<area shape="rect" id="node10" href="log_8h.html#ab752e819a674322c4e6e9f3bf868451b" title="save the actual values input to rdpar to a file " alt="" coords="163,116,235,143"/>
<area shape="rect" id="node11" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="172,167,225,193"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="652,28,709,55"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="283,53,356,80"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="404,40,493,67"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="427,91,471,117"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="553,28,592,55"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="541,79,604,105"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad96cdba540104e93e764a980db99ea4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad96cdba540104e93e764a980db99ea4e">&#9670;&nbsp;</a></span>i_spec_start</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i_spec_start = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spectra_8c_source.html#l00097">97</a> of file <a class="el" href="spectra_8c_source.html">spectra.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="spectra_8c.html">spectra.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
