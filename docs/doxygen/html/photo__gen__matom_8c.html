<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/photo_gen_matom.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('photo__gen__matom_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">photo_gen_matom.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>functions for calculating emissivities and generating photons from macro-atoms and k-packets. during the spectral cycles. The actual functions which do the jumps inside an activated macro-atom are in <a class="el" href="matom_8c.html" title="Macro-atom functions. ">matom.c</a>. This is partly done to prevent overly long files (JM1504)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
<code>#include &lt;gsl/gsl_block.h&gt;</code><br />
<code>#include &lt;gsl/gsl_vector.h&gt;</code><br />
<code>#include &lt;gsl/gsl_matrix.h&gt;</code><br />
<code>#include &quot;<a class="el" href="my__linalg_8h_source.html">my_linalg.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for photo_gen_matom.c:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2photo__gen__matom_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2photo__gen__matom_8c" id="_2_users_2mhewitt_2python_2source_2photo__gen__matom_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node14" href="my__linalg_8h.html" title="my_linalg.h" alt="" coords="618,95,690,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="149,169,193,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="217,169,280,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="304,169,377,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="401,169,464,196"/>
</map>
</div>
</div>
<p><a href="photo__gen__matom_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7cb37d7e97d03e7de67b4def94af9220"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photo__gen__matom_8c.html#a7cb37d7e97d03e7de67b4def94af9220">get_kpkt_f</a> ()</td></tr>
<tr class="memdesc:a7cb37d7e97d03e7de67b4def94af9220"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k-packet -&gt; r-packet in the required wavelength range.  <a href="#a7cb37d7e97d03e7de67b4def94af9220">More...</a><br /></td></tr>
<tr class="separator:a7cb37d7e97d03e7de67b4def94af9220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8797bce5a5f3411f4162dff928b7920"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photo__gen__matom_8c.html#ac8797bce5a5f3411f4162dff928b7920">get_matom_f</a> (int mode)</td></tr>
<tr class="memdesc:ac8797bce5a5f3411f4162dff928b7920"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the specific band-limited luminosity in macro-atoms  <a href="#ac8797bce5a5f3411f4162dff928b7920">More...</a><br /></td></tr>
<tr class="separator:ac8797bce5a5f3411f4162dff928b7920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4541dc581678aaea94bb9bdf0d38dfcf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photo__gen__matom_8c.html#a4541dc581678aaea94bb9bdf0d38dfcf">photo_gen_kpkt</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double weight, int photstart, int nphot)</td></tr>
<tr class="memdesc:a4541dc581678aaea94bb9bdf0d38dfcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">produces photon packets to account for creating of r-packets by k-packets in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles).  <a href="#a4541dc581678aaea94bb9bdf0d38dfcf">More...</a><br /></td></tr>
<tr class="separator:a4541dc581678aaea94bb9bdf0d38dfcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7248f385000ac034fb3f0e3d5f45298f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photo__gen__matom_8c.html#a7248f385000ac034fb3f0e3d5f45298f">photo_gen_matom</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double weight, int photstart, int nphot)</td></tr>
<tr class="memdesc:a7248f385000ac034fb3f0e3d5f45298f"><td class="mdescLeft">&#160;</td><td class="mdescRight">produces photon packets to account for creation of r-packets by deactivation of macro atoms in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles).  <a href="#a7248f385000ac034fb3f0e3d5f45298f">More...</a><br /></td></tr>
<tr class="separator:a7248f385000ac034fb3f0e3d5f45298f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>functions for calculating emissivities and generating photons from macro-atoms and k-packets. during the spectral cycles. The actual functions which do the jumps inside an activated macro-atom are in <a class="el" href="matom_8c.html" title="Macro-atom functions. ">matom.c</a>. This is partly done to prevent overly long files (JM1504) </p>
<dl class="section author"><dt>Author</dt><dd>ksl, ss, jm </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="photo__gen__matom_8c_source.html">photo_gen_matom.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7cb37d7e97d03e7de67b4def94af9220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb37d7e97d03e7de67b4def94af9220">&#9670;&nbsp;</a></span>get_kpkt_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_kpkt_f </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k-packet -&gt; r-packet in the required wavelength range. </p>
<dl class="section return"><dt>Returns</dt><dd>double lum The energy radiated by the process k-packet -&gt; r-packet in the wind in the wavelength range required for the specrum calculation.</dd></dl>
<h3>Notes</h3>
<p>Literally just loops through the kpkt_emiss entries in plasmamain. </p>

<p class="definition">Definition at line <a class="el" href="photo__gen__matom_8c_source.html#l00038">38</a> of file <a class="el" href="photo__gen__matom_8c_source.html">photo_gen_matom.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220_icgraph.png" border="0" usemap="#photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220_icgraph" alt=""/></div>
<map name="photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220_icgraph" id="photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="121,5,200,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="389,5,464,32"/>
<area shape="rect" id="node4" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="248,31,341,57"/>
</map>
</div>

</div>
</div>
<a id="ac8797bce5a5f3411f4162dff928b7920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8797bce5a5f3411f4162dff928b7920">&#9670;&nbsp;</a></span>get_matom_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_matom_f </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the specific band-limited luminosity in macro-atoms </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode vvariable which controls whether or not we need to compute the emissivities (CALCULATE_MATOM_EMISSIVITIES) or use stored ones because we are restarting a spectral cycle (USE_STORED_MATOM_EMISSIVITIES) see #define statements in <a class="el" href="python_8h.html">python.h</a> and code in <a class="el" href="foo_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei...">xdefine_phot()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double lum The energy radiated by the deactivation of macro atoms in the wind in the wavelength range required for the specrum calculation.</dd></dl>
<p>this routine calculates the luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the deactivation of macro atoms in the required wavelength range. This can be a slow process, as there is no priori way (at least with our method) to work out where a photon is going to come out when a macro-atom is generated</p>
<h3>Notes</h3>
<p>Consult Matthews thesis. </p>

<p class="definition">Definition at line <a class="el" href="photo__gen__matom_8c_source.html#l00080">80</a> of file <a class="el" href="photo__gen__matom_8c_source.html">photo_gen_matom.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_cgraph.png" border="0" usemap="#photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_cgraph" alt=""/></div>
<map name="photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_cgraph" id="photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="367,5,405,32"/>
<area shape="rect" id="node4" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="133,81,209,108"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="257,132,301,159"/>
<area shape="rect" id="node11" href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9" title="In addition to writing to the diag file, print a message to the screen from all threads. " alt="" coords="133,183,209,209"/>
<area shape="rect" id="node12" href="foo_8h.html#a7de597169a947d506f6d2210de2080ac" title="is a routine that will sit at a higher level in the code than either matom or kpkt and will govern th..." alt="" coords="135,233,207,260"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="719,81,776,108"/>
<area shape="rect" id="node5" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="257,81,301,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="349,107,423,133"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="471,107,560,133"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="620,107,659,133"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="608,157,671,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_icgraph.png" border="0" usemap="#photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_icgraph" alt=""/></div>
<map name="photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_icgraph" id="photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="133,5,212,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="401,5,476,32"/>
<area shape="rect" id="node4" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="260,31,353,57"/>
</map>
</div>

</div>
</div>
<a id="a4541dc581678aaea94bb9bdf0d38dfcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4541dc581678aaea94bb9bdf0d38dfcf">&#9670;&nbsp;</a></span>photo_gen_kpkt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int photo_gen_kpkt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>photstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nphot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>produces photon packets to account for creating of r-packets by k-packets in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p the ptr to the entire structure for the photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>weight the photon weight </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>photstart The first element of the photon stucure to be populated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nphot the number of photons to be generated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int nphot When it finishes it should have generated nphot photons from k-packet elliminations.</dd></dl>
<p>This routine is closely related to photo_gen_wind from which much of the code has been copied. </p>

<p class="definition">Definition at line <a class="el" href="photo__gen__matom_8c_source.html#l00477">477</a> of file <a class="el" href="photo__gen__matom_8c_source.html">photo_gen_matom.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_cgraph.png" border="0" usemap="#photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_cgraph" alt=""/></div>
<map name="photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_cgraph" id="photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="199,5,237,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="361,107,430,133"/>
<area shape="rect" id="node4" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="367,360,423,387"/>
<area shape="rect" id="node5" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="841,968,880,995"/>
<area shape="rect" id="node7" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="507,411,603,437"/>
<area shape="rect" id="node8" href="foo_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="198,411,238,437"/>
<area shape="rect" id="node9" href="foo_8h.html#a55dba11eab85fa51b5bbf621a3c66b57" title="get_random_location" alt="" coords="160,461,276,488"/>
<area shape="rect" id="node10" href="foo_8h.html#a1881a8f6279e1472e741aab3ee654383" title="randvec" alt="" coords="367,157,424,184"/>
<area shape="rect" id="node11" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="187,664,249,691"/>
<area shape="rect" id="node37" href="anisowind_8c.html#a5cc282e1f3d56ce0f29cb080bc225408" title="is the routine which chooses a new anisotropic direction in geo.scatter_mode = SCATTER_MODE_THERMAL ..." alt="" coords="147,284,289,311"/>
<area shape="rect" id="node39" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="184,765,252,792"/>
<area shape="rect" id="node40" href="foo_8h.html#a376d6bf65b4a156a45f28b56bc4c017d" title="Generates path for a macro&#45;atom line photon. " alt="" coords="161,816,275,843"/>
<area shape="rect" id="node41" href="foo_8h.html#a176ee6debad2930212ca97a2d28794c0" title="Generates path for a wind photon. " alt="" coords="158,867,278,893"/>
<area shape="rect" id="node42" href="foo_8h.html#a7719923b66bf470bc4eeb42c454ebd48" title="Generates path for a &#39;wind&#39; photon in photon mode. " alt="" coords="154,917,282,944"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1316,867,1373,893"/>
<area shape="rect" id="node12" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="376,917,415,944"/>
<area shape="rect" id="node13" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="839,867,883,893"/>
<area shape="rect" id="node19" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="353,1019,438,1045"/>
<area shape="rect" id="node20" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="369,411,421,437"/>
<area shape="rect" id="node21" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="339,968,451,995"/>
<area shape="rect" id="node26" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="823,664,899,691"/>
<area shape="rect" id="node29" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="363,563,428,589"/>
<area shape="rect" id="node30" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="355,613,435,640"/>
<area shape="rect" id="node32" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="337,765,453,792"/>
<area shape="rect" id="node33" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="373,816,418,843"/>
<area shape="rect" id="node34" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="371,867,420,893"/>
<area shape="rect" id="node35" href="foo_8h.html#ab0b1a9d790b71c94f9562c567eeee268" title="create_basis" alt="" coords="356,664,435,691"/>
<area shape="rect" id="node36" href="foo_8h.html#a5672a43b959d7e6d398852cbc41ee6b1" title="project_from" alt="" coords="357,715,434,741"/>
<area shape="rect" id="node14" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="947,765,1020,792"/>
<area shape="rect" id="node15" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1068,791,1157,817"/>
<area shape="rect" id="node18" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1091,740,1135,767"/>
<area shape="rect" id="node16" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1217,841,1256,868"/>
<area shape="rect" id="node17" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1205,791,1268,817"/>
<area shape="rect" id="node22" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="501,917,609,944"/>
<area shape="rect" id="node28" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="682,664,750,691"/>
<area shape="rect" id="node23" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="683,1069,749,1096"/>
<area shape="rect" id="node25" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="657,816,775,843"/>
<area shape="rect" id="node27" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="666,917,766,944"/>
<area shape="rect" id="node24" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="827,1069,895,1096"/>
<area shape="rect" id="node31" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="521,563,589,589"/>
<area shape="rect" id="node38" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="340,259,451,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_icgraph.png" border="0" usemap="#photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_icgraph" alt=""/></div>
<map name="photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_icgraph" id="photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="147,5,223,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="271,5,345,32"/>
</map>
</div>

</div>
</div>
<a id="a7248f385000ac034fb3f0e3d5f45298f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7248f385000ac034fb3f0e3d5f45298f">&#9670;&nbsp;</a></span>photo_gen_matom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int photo_gen_matom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>photstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nphot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>produces photon packets to account for creation of r-packets by deactivation of macro atoms in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p the ptr to the structire for the photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>weight the photon weight </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>photstart The position in the photon structure of the first photon to generate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nphot the number of the photons to be generated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int nphot When it finishes it should have generated nphot photons from macro atom deactivations.</dd></dl>
<p>This routine is closely related to photo_gen_kpkt from which much of the code has been copied.</p>
<h3>Notes</h3>
<p>Consult Matthews thesis. </p>

<p class="definition">Definition at line <a class="el" href="photo__gen__matom_8c_source.html#l00645">645</a> of file <a class="el" href="photo__gen__matom_8c_source.html">photo_gen_matom.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_cgraph.png" border="0" usemap="#photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_cgraph" alt=""/></div>
<map name="photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_cgraph" id="photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="211,5,249,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a9ae82cdebefd0a70326fd37ee0a61fd4" title="a scaled down version of matom which deals with deactivation only for spectral cycles. " alt="" coords="191,56,269,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="373,157,442,184"/>
<area shape="rect" id="node5" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="379,411,435,437"/>
<area shape="rect" id="node6" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="853,1019,892,1045"/>
<area shape="rect" id="node8" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="519,461,615,488"/>
<area shape="rect" id="node9" href="foo_8h.html#a55dba11eab85fa51b5bbf621a3c66b57" title="get_random_location" alt="" coords="172,360,288,387"/>
<area shape="rect" id="node10" href="foo_8h.html#a1881a8f6279e1472e741aab3ee654383" title="randvec" alt="" coords="379,208,436,235"/>
<area shape="rect" id="node11" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="199,715,261,741"/>
<area shape="rect" id="node37" href="anisowind_8c.html#a5cc282e1f3d56ce0f29cb080bc225408" title="is the routine which chooses a new anisotropic direction in geo.scatter_mode = SCATTER_MODE_THERMAL ..." alt="" coords="159,309,301,336"/>
<area shape="rect" id="node39" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="196,816,264,843"/>
<area shape="rect" id="node40" href="foo_8h.html#a376d6bf65b4a156a45f28b56bc4c017d" title="Generates path for a macro&#45;atom line photon. " alt="" coords="173,867,287,893"/>
<area shape="rect" id="node41" href="foo_8h.html#a176ee6debad2930212ca97a2d28794c0" title="Generates path for a wind photon. " alt="" coords="170,917,290,944"/>
<area shape="rect" id="node42" href="foo_8h.html#a7719923b66bf470bc4eeb42c454ebd48" title="Generates path for a &#39;wind&#39; photon in photon mode. " alt="" coords="166,968,294,995"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1328,905,1385,932"/>
<area shape="rect" id="node12" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="388,968,427,995"/>
<area shape="rect" id="node13" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="851,917,895,944"/>
<area shape="rect" id="node19" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="365,1069,450,1096"/>
<area shape="rect" id="node20" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="381,461,433,488"/>
<area shape="rect" id="node21" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="351,1019,463,1045"/>
<area shape="rect" id="node26" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="835,715,911,741"/>
<area shape="rect" id="node29" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="375,613,440,640"/>
<area shape="rect" id="node30" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="367,664,447,691"/>
<area shape="rect" id="node32" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="349,816,465,843"/>
<area shape="rect" id="node33" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="385,867,430,893"/>
<area shape="rect" id="node34" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="383,917,432,944"/>
<area shape="rect" id="node35" href="foo_8h.html#ab0b1a9d790b71c94f9562c567eeee268" title="create_basis" alt="" coords="368,715,447,741"/>
<area shape="rect" id="node36" href="foo_8h.html#a5672a43b959d7e6d398852cbc41ee6b1" title="project_from" alt="" coords="369,765,446,792"/>
<area shape="rect" id="node14" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="959,804,1032,831"/>
<area shape="rect" id="node15" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1080,829,1169,856"/>
<area shape="rect" id="node18" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1103,779,1147,805"/>
<area shape="rect" id="node16" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1229,880,1268,907"/>
<area shape="rect" id="node17" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1217,829,1280,856"/>
<area shape="rect" id="node22" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="513,968,621,995"/>
<area shape="rect" id="node28" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="694,715,762,741"/>
<area shape="rect" id="node23" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="695,1120,761,1147"/>
<area shape="rect" id="node25" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="669,867,787,893"/>
<area shape="rect" id="node27" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="678,968,778,995"/>
<area shape="rect" id="node24" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="839,1120,907,1147"/>
<area shape="rect" id="node31" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="533,613,601,640"/>
<area shape="rect" id="node38" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="352,309,463,336"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_icgraph.png" border="0" usemap="#photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_icgraph" alt=""/></div>
<map name="photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_icgraph" id="photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="159,5,235,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="283,5,357,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="photo__gen__matom_8c.html">photo_gen_matom.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
