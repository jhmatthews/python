<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/trans_phot.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('trans__phot_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">trans_phot.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains high level routines which carry out the propagation of photons through the wind/wind domains both for ionization and spectrum (extract) cycles.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for trans_phot.c:</div>
<div class="dyncontent">
<div class="center"><img src="trans__phot_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2trans__phot_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2trans__phot_8c" id="_2_users_2mhewitt_2python_2source_2trans__phot_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="trans__phot_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a620388e1c4a8e38f192c5a0ce42af389"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389">trans_phot</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, int iextract)</td></tr>
<tr class="memdesc:a620388e1c4a8e38f192c5a0ce42af389"><td class="mdescLeft">&#160;</td><td class="mdescRight">int (w,p,iextract) oversees the propagation of a "flight" of photons  <a href="#a620388e1c4a8e38f192c5a0ce42af389">More...</a><br /></td></tr>
<tr class="separator:a620388e1c4a8e38f192c5a0ce42af389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7b8208c76fe2718f45f46c9dc3a813"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813">trans_phot_single</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, int iextract)</td></tr>
<tr class="memdesc:a2f7b8208c76fe2718f45f46c9dc3a813"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transport a single photon photon through the wind.  <a href="#a2f7b8208c76fe2718f45f46c9dc3a813">More...</a><br /></td></tr>
<tr class="separator:a2f7b8208c76fe2718f45f46c9dc3a813"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a67e1c9923b347ff54c2515cce727e62f"><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trans__phot_8c.html#a67e1c9923b347ff54c2515cce727e62f">pltptr</a></td></tr>
<tr class="separator:a67e1c9923b347ff54c2515cce727e62f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0539753df48490e5b774668a65af9fce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trans__phot_8c.html#a0539753df48490e5b774668a65af9fce">plinit</a> = 0</td></tr>
<tr class="separator:a0539753df48490e5b774668a65af9fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09209ddd6e40362291feaaafc3dd989b"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="trans__phot_8c.html#a09209ddd6e40362291feaaafc3dd989b">n_lost_to_dfudge</a> = 0</td></tr>
<tr class="separator:a09209ddd6e40362291feaaafc3dd989b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains high level routines which carry out the propagation of photons through the wind/wind domains both for ionization and spectrum (extract) cycles. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April, 2018</dd></dl>
<h3>Notes</h3>
<p>The routines contained here are central to Python, and anyone who wants to understand Python in general should spend time understanding how they work</p>
<p>There are two basic options associated with the routines.</p>
<ul>
<li>live or die is the case in which one is only concerned with how a photon goes through the wind and random numbers are used to generate the scattering directions. The photon is followed until it leaves the system. This is the only option used in ionization cycles (currently).</li>
<li>extract is the mode where whenever a photon scatters we also calculate what the photon weight would be if it scattered in a set of certain directions. When this happens the weight of the photon is changed to reflect the fact that the direction is not random.</li>
</ul>
<p>The extract option is used normaly during the spectral extraction cycles. However, as an advanced option one can use the live or die to construct the detailed spectrum. One would not normally want to do this, as many photons are "wasted" since they don't scatter at the desired angle. With sufficient numbers of photons however the results of the two methods should (by construction) be identical (or at least very very similar). </p>

<p class="definition">Definition in file <a class="el" href="trans__phot_8c_source.html">trans_phot.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a620388e1c4a8e38f192c5a0ce42af389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a620388e1c4a8e38f192c5a0ce42af389">&#9670;&nbsp;</a></span>trans_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int trans_phot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iextract</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>int (w,p,iextract) oversees the propagation of a "flight" of photons </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w The entire wind domain </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p A pointer to a "fligh" of photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iextract An integer controlling whether we are to process the flight in the live or die option (0) or whether we also need to extract photons in specific directions (which is usually the case in constructing spectra </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Normally returns 0</dd></dl>
<p>This routine oversees the propagation of individual photons. The main loop covers an entire "flight" of photons. The routine generates the random optical depth a photon can travel before scattering and monitors the progress of the photon through the grid.</p>
<p>The real physics is done elsewhere, in lower level routines.</p>
<h3>Notes</h3>
<p>At the end of the routine the position for each of the photons in p is the last point where the photon was in the wind, * not the outer boundary of the radiative transfer </p>

<p class="definition">Definition at line <a class="el" href="trans__phot_8c_source.html#l00085">85</a> of file <a class="el" href="trans__phot_8c_source.html">trans_phot.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_cgraph.png" border="0" usemap="#trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_cgraph" alt=""/></div>
<map name="trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_cgraph" id="trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1291,199,1329,225"/>
<area shape="rect" id="node4" href="log_8h.html#a762beaa59cb344fbb45e3458b86c95ce" title="Flush the diagnostic file to assure that one has an up&#45;to&#45;date version of the log file..." alt="" coords="1396,184,1461,211"/>
<area shape="rect" id="node5" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="1272,781,1348,808"/>
<area shape="rect" id="node11" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1288,477,1332,504"/>
<area shape="rect" id="node12" href="foo_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="306,245,358,272"/>
<area shape="rect" id="node13" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="812,296,877,323"/>
<area shape="rect" id="node14" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="817,1689,873,1716"/>
<area shape="rect" id="node15" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="277,1867,387,1893"/>
<area shape="rect" id="node16" href="extract_8c.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="306,524,358,551"/>
<area shape="rect" id="node49" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="123,1259,224,1285"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1879,528,1936,555"/>
<area shape="rect" id="node6" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1407,604,1451,631"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="1509,579,1583,605"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1631,579,1720,605"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1780,579,1819,605"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1768,528,1831,555"/>
<area shape="rect" id="node17" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="820,1259,869,1285"/>
<area shape="rect" id="node18" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="823,397,866,424"/>
<area shape="rect" id="node19" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="819,1512,871,1539"/>
<area shape="rect" id="node20" href="disk_8c.html#a29076b6a07403d62872baf4dc9bf9346" title="Calculate the speed and velocity v at which material given specific position in the disk..." alt="" coords="477,1360,523,1387"/>
<area shape="rect" id="node24" href="foo_8h.html#a792efbef440470b9aad57a0d687a8915" title="doppler" alt="" coords="472,296,528,323"/>
<area shape="rect" id="node25" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="466,347,534,373"/>
<area shape="rect" id="node26" href="diag_8c.html#ad9812264d4df596406d5878299e8b7e5" title="saves informations about phtoons in a particulare wavelength gange " alt="" coords="440,448,560,475"/>
<area shape="rect" id="node27" href="extract_8c.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="463,803,537,829"/>
<area shape="rect" id="node48" href="poltest_8c.html#ae9b9c59a63a9198ee9a8ff81c1daa922" title="poltest" alt="" coords="474,499,526,525"/>
<area shape="rect" id="node21" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="649,1360,698,1387"/>
<area shape="rect" id="node22" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="651,1411,696,1437"/>
<area shape="rect" id="node23" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="647,1208,700,1235"/>
<area shape="rect" id="node28" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="825,853,864,880"/>
<area shape="rect" id="node29" href="anisowind_8c.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="633,803,713,829"/>
<area shape="rect" id="node39" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="639,651,708,677"/>
<area shape="rect" id="node40" href="foo_8h.html#adc18086c9912f51dae0f13aef98278de" title="p) attempts to assure that a photon is not scattered a second time inappropriately by the same transi..." alt="" coords="641,1107,706,1133"/>
<area shape="rect" id="node41" href="foo_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="631,701,715,728"/>
<area shape="rect" id="node42" href="foo_8h.html#a56bcc4eb80e38e626fe58bb5c989eafd" title="Record the history of a single photon bundle, in terms of a series of photon structures that are popu..." alt="" coords="642,499,705,525"/>
<area shape="rect" id="node43" href="balance__templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="643,1157,703,1184"/>
<area shape="rect" id="node44" href="balance__templates_8h.html#a56740476af61734dee90b4090f004971" title="walls" alt="" coords="651,1056,695,1083"/>
<area shape="rect" id="node45" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="968,1816,1041,1843"/>
<area shape="rect" id="node46" href="foo_8h.html#a30c0a9051caebba27b5ef5583d38ad0c" title="Preps a single photon to be dumped. " alt="" coords="619,549,727,576"/>
<area shape="rect" id="node47" href="foo_8h.html#ac53d695fcce14d5ae685028c7e7280ce" title="The next routine is designed to update a portion of the PlasmaPtr to reflect where photons along the ..." alt="" coords="608,600,739,627"/>
<area shape="rect" id="node30" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="787,639,903,665"/>
<area shape="rect" id="node31" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="802,1588,887,1615"/>
<area shape="rect" id="node32" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="789,689,901,716"/>
<area shape="rect" id="node38" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="971,744,1039,771"/>
<area shape="rect" id="node33" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="951,477,1059,504"/>
<area shape="rect" id="node34" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="1132,224,1199,251"/>
<area shape="rect" id="node36" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="1107,427,1224,453"/>
<area shape="rect" id="node37" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="1115,528,1215,555"/>
<area shape="rect" id="node35" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="1276,249,1344,276"/>
<area shape="rect" id="node50" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="284,955,380,981"/>
<area shape="rect" id="node51" href="foo_8h.html#ac5e9ac55fb4bf0dbb108c006f509b32b" title="randvcos" alt="" coords="301,1005,363,1032"/>
<area shape="rect" id="node52" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="296,1056,368,1083"/>
<area shape="rect" id="node53" href="foo_8h.html#a7fe8e6139b53b931c68d444216bfd0fe" title="Registers a photon passage with a wind cell. " alt="" coords="272,1107,392,1133"/>
<area shape="rect" id="node54" href="diag_8c.html#a36a9f5603f59602831695269c056cbe4" title="track_scatters" alt="" coords="290,1411,374,1437"/>
<area shape="rect" id="node55" href="foo_8h.html#a08e6e02acfd4d2fb6b31cf9bfdc7b258" title="calculates the amount of line heating that during a resonance. " alt="" coords="301,1461,363,1488"/>
<area shape="rect" id="node56" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="287,1512,377,1539"/>
<area shape="rect" id="node57" href="diag_8c.html#a852eb08f6a48973ca3dfd61567803ee8" title="save_photon " alt="" coords="290,1613,374,1640"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_icgraph.png" border="0" usemap="#trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_icgraph" alt=""/></div>
<map name="trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_icgraph" id="trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="123,5,232,32"/>
<area shape="rect" id="node3" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="135,56,220,83"/>
</map>
</div>

</div>
</div>
<a id="a2f7b8208c76fe2718f45f46c9dc3a813"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f7b8208c76fe2718f45f46c9dc3a813">&#9670;&nbsp;</a></span>trans_phot_single()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int trans_phot_single </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iextract</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transport a single photon photon through the wind. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w The entire wind </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p A single photon </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iextract If 0, then process this photon in the live or die option, without calling extract</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This routine oversees the propagation of an individual photon through the wind. As the photon moves through the wind, its position, direction and weight are updated. In reverberation mode, the flight time is also tracked.</p>
<p>Basically what the routine does is generate a random number whihc is used to determine the optical depth to a scatter, and then it calles translate multiple times. translate involves moving the photon only a single cell (or alternatively a single tranfer in the windless region), and returns a status. Depending on what this status is, trans_phot_single calls trans_phot again doing nothing, but if the scattering depth has been reached, then trans_phot_single causes the photon to scatter, which changes its direction. This process continues until the photon exits the system or hits a barrier. If the photon hits a radiating surface, the disk or star, then the photon may either be absorbed, or scattered depending on the reflection/absorption mode.</p>
<h3>Notes</h3>
<p>This routine is called by trans_phot once for each photon in a flight of photons </p>

<p class="definition">Definition at line <a class="el" href="trans__phot_8c_source.html#l00302">302</a> of file <a class="el" href="trans__phot_8c_source.html">trans_phot.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_cgraph.png" border="0" usemap="#trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_cgraph" alt=""/></div>
<map name="trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_cgraph" id="trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="695,777,760,804"/>
<area shape="rect" id="node3" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="167,119,263,145"/>
<area shape="rect" id="node4" href="balance__templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="526,245,586,272"/>
<area shape="rect" id="node5" href="balance__templates_8h.html#a56740476af61734dee90b4090f004971" title="walls" alt="" coords="534,347,578,373"/>
<area shape="rect" id="node6" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="851,43,924,69"/>
<area shape="rect" id="node13" href="foo_8h.html#ac5e9ac55fb4bf0dbb108c006f509b32b" title="randvcos" alt="" coords="183,347,246,373"/>
<area shape="rect" id="node14" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="179,397,251,424"/>
<area shape="rect" id="node15" href="extract_8c.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="189,1056,241,1083"/>
<area shape="rect" id="node18" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="701,1461,753,1488"/>
<area shape="rect" id="node27" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="708,448,747,475"/>
<area shape="rect" id="node30" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="685,1309,770,1336"/>
<area shape="rect" id="node31" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="699,549,755,576"/>
<area shape="rect" id="node35" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1171,625,1215,652"/>
<area shape="rect" id="node36" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1173,275,1212,301"/>
<area shape="rect" id="node39" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="1155,955,1231,981"/>
<area shape="rect" id="node43" href="foo_8h.html#adc18086c9912f51dae0f13aef98278de" title="p) attempts to assure that a photon is not scattered a second time inappropriately by the same transi..." alt="" coords="523,1208,589,1235"/>
<area shape="rect" id="node49" href="foo_8h.html#a7fe8e6139b53b931c68d444216bfd0fe" title="Registers a photon passage with a wind cell. " alt="" coords="155,1715,275,1741"/>
<area shape="rect" id="node50" href="foo_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="189,1765,241,1792"/>
<area shape="rect" id="node51" href="diag_8c.html#a36a9f5603f59602831695269c056cbe4" title="track_scatters" alt="" coords="173,1816,257,1843"/>
<area shape="rect" id="node52" href="foo_8h.html#a08e6e02acfd4d2fb6b31cf9bfdc7b258" title="calculates the amount of line heating that during a resonance. " alt="" coords="183,1867,246,1893"/>
<area shape="rect" id="node53" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="159,1917,270,1944"/>
<area shape="rect" id="node54" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="170,1968,259,1995"/>
<area shape="rect" id="node55" href="diag_8c.html#a852eb08f6a48973ca3dfd61567803ee8" title="save_photon " alt="" coords="173,2019,257,2045"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1648,401,1705,428"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="1279,452,1352,479"/>
<area shape="rect" id="node9" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1400,351,1489,377"/>
<area shape="rect" id="node12" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1423,452,1467,479"/>
<area shape="rect" id="node10" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1549,351,1588,377"/>
<area shape="rect" id="node11" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1537,300,1600,327"/>
<area shape="rect" id="node16" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="703,1157,752,1184"/>
<area shape="rect" id="node17" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="706,1093,749,1120"/>
<area shape="rect" id="node19" href="disk_8c.html#a29076b6a07403d62872baf4dc9bf9346" title="Calculate the speed and velocity v at which material given specific position in the disk..." alt="" coords="360,1335,405,1361"/>
<area shape="rect" id="node23" href="foo_8h.html#a792efbef440470b9aad57a0d687a8915" title="doppler" alt="" coords="355,980,411,1007"/>
<area shape="rect" id="node24" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="349,1031,417,1057"/>
<area shape="rect" id="node25" href="diag_8c.html#ad9812264d4df596406d5878299e8b7e5" title="saves informations about phtoons in a particulare wavelength gange " alt="" coords="323,1081,443,1108"/>
<area shape="rect" id="node26" href="extract_8c.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="345,701,420,728"/>
<area shape="rect" id="node48" href="poltest_8c.html#ae9b9c59a63a9198ee9a8ff81c1daa922" title="poltest" alt="" coords="357,879,409,905"/>
<area shape="rect" id="node20" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="531,1360,581,1387"/>
<area shape="rect" id="node21" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="533,1411,579,1437"/>
<area shape="rect" id="node22" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="529,1259,583,1285"/>
<area shape="rect" id="node28" href="anisowind_8c.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="516,1005,596,1032"/>
<area shape="rect" id="node42" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="521,600,591,627"/>
<area shape="rect" id="node44" href="foo_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="514,651,598,677"/>
<area shape="rect" id="node45" href="foo_8h.html#a56bcc4eb80e38e626fe58bb5c989eafd" title="Record the history of a single photon bundle, in terms of a series of photon structures that are popu..." alt="" coords="525,701,587,728"/>
<area shape="rect" id="node46" href="foo_8h.html#a30c0a9051caebba27b5ef5583d38ad0c" title="Preps a single photon to be dumped. " alt="" coords="502,752,610,779"/>
<area shape="rect" id="node47" href="foo_8h.html#ac53d695fcce14d5ae685028c7e7280ce" title="The next routine is designed to update a portion of the PlasmaPtr to reflect where photons along the ..." alt="" coords="491,803,621,829"/>
<area shape="rect" id="node29" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="669,828,785,855"/>
<area shape="rect" id="node32" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="671,929,783,956"/>
<area shape="rect" id="node41" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="853,980,921,1007"/>
<area shape="rect" id="node33" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="833,777,941,804"/>
<area shape="rect" id="node34" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="1015,161,1081,188"/>
<area shape="rect" id="node38" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="989,777,1107,804"/>
<area shape="rect" id="node40" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="998,727,1098,753"/>
<area shape="rect" id="node37" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="1159,161,1227,188"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_icgraph.png" border="0" usemap="#trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_icgraph" alt=""/></div>
<map name="trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_icgraph" id="trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_icgraph">
<area shape="rect" id="node2" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="155,31,224,57"/>
<area shape="rect" id="node3" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="272,5,381,32"/>
<area shape="rect" id="node4" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="284,56,369,83"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a09209ddd6e40362291feaaafc3dd989b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09209ddd6e40362291feaaafc3dd989b">&#9670;&nbsp;</a></span>n_lost_to_dfudge</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long n_lost_to_dfudge = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trans__phot_8c_source.html#l00053">53</a> of file <a class="el" href="trans__phot_8c_source.html">trans_phot.c</a>.</p>

</div>
</div>
<a id="a0539753df48490e5b774668a65af9fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0539753df48490e5b774668a65af9fce">&#9670;&nbsp;</a></span>plinit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int plinit = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trans__phot_8c_source.html#l00052">52</a> of file <a class="el" href="trans__phot_8c_source.html">trans_phot.c</a>.</p>

</div>
</div>
<a id="a67e1c9923b347ff54c2515cce727e62f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67e1c9923b347ff54c2515cce727e62f">&#9670;&nbsp;</a></span>pltptr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* pltptr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="trans__phot_8c_source.html#l00051">51</a> of file <a class="el" href="trans__phot_8c_source.html">trans_phot.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="trans__phot_8c.html">trans_phot.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
