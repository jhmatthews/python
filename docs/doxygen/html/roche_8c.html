<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/roche.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('roche_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">roche.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>These routines are used to describe the Roche geometry and are intended to allow one to calculate whether a photon intersects the surface of the star.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for roche.c:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2roche_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2roche_8c" id="_2_users_2mhewitt_2python_2source_2roche_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="roche_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6ebf6899d6c1c8b7b9d09be872c05aae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a6ebf6899d6c1c8b7b9d09be872c05aae">EPS</a>&#160;&#160;&#160;10000.</td></tr>
<tr class="separator:a6ebf6899d6c1c8b7b9d09be872c05aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6a3c682535c3baaeb7c0e56ba18fe9da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a6a3c682535c3baaeb7c0e56ba18fe9da">binary_basics</a> ()</td></tr>
<tr class="memdesc:a6a3c682535c3baaeb7c0e56ba18fe9da"><td class="mdescLeft">&#160;</td><td class="mdescRight">From the masses and period, setup the information one needs to calculate the position of the Roche lobe of the secondary to calculate whether a photon intersects the surface of the star.  <a href="#a6a3c682535c3baaeb7c0e56ba18fe9da">More...</a><br /></td></tr>
<tr class="separator:a6a3c682535c3baaeb7c0e56ba18fe9da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff5a3156ec26863e37ff61073bb97ca4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#aff5a3156ec26863e37ff61073bb97ca4">ds_to_roche_2</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p)</td></tr>
<tr class="memdesc:aff5a3156ec26863e37ff61073bb97ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the distance to the Roche surface for a photon.  <a href="#aff5a3156ec26863e37ff61073bb97ca4">More...</a><br /></td></tr>
<tr class="separator:aff5a3156ec26863e37ff61073bb97ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4ca36cf5f0eaaa3fb044a982d922fb3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#ad4ca36cf5f0eaaa3fb044a982d922fb3">hit_secondary</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p)</td></tr>
<tr class="memdesc:ad4ca36cf5f0eaaa3fb044a982d922fb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find out whether a photon will hit the secondary, but don't actually calculate the point where it hits.  <a href="#ad4ca36cf5f0eaaa3fb044a982d922fb3">More...</a><br /></td></tr>
<tr class="separator:ad4ca36cf5f0eaaa3fb044a982d922fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6359a23f10596d6bb51c80905c1c88"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a3a6359a23f10596d6bb51c80905c1c88">pillbox</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double *smin, double *smax)</td></tr>
<tr class="memdesc:a3a6359a23f10596d6bb51c80905c1c88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary.  <a href="#a3a6359a23f10596d6bb51c80905c1c88">More...</a><br /></td></tr>
<tr class="separator:a3a6359a23f10596d6bb51c80905c1c88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a0210aea098f52ca60dfbc90de4ecee"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee">phi</a> (double s)</td></tr>
<tr class="memdesc:a4a0210aea098f52ca60dfbc90de4ecee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the Roche potential at position indicated by the photon p_roche and the length s.  <a href="#a4a0210aea098f52ca60dfbc90de4ecee">More...</a><br /></td></tr>
<tr class="separator:a4a0210aea098f52ca60dfbc90de4ecee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa85d6bb7bef49e7e4b18d238eb2e6430"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#aa85d6bb7bef49e7e4b18d238eb2e6430">dphi_ds</a> (double s)</td></tr>
<tr class="memdesc:aa85d6bb7bef49e7e4b18d238eb2e6430"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the gradient of the Roche potential as the photon travels.  <a href="#aa85d6bb7bef49e7e4b18d238eb2e6430">More...</a><br /></td></tr>
<tr class="separator:aa85d6bb7bef49e7e4b18d238eb2e6430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0bed5d82ce2310bbd039704b3567cd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a7b0bed5d82ce2310bbd039704b3567cd">d2phi_ds2</a> (double s)</td></tr>
<tr class="memdesc:a7b0bed5d82ce2310bbd039704b3567cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the second derivative of the Roche potential of the secondary.  <a href="#a7b0bed5d82ce2310bbd039704b3567cd">More...</a><br /></td></tr>
<tr class="separator:a7b0bed5d82ce2310bbd039704b3567cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6c77132d4fe5cdf4cb3d66186981228"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#aa6c77132d4fe5cdf4cb3d66186981228">roche_width</a> (double <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:aa6c77132d4fe5cdf4cb3d66186981228"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the width of the Roche potentiil at a position x along the x axis.  <a href="#aa6c77132d4fe5cdf4cb3d66186981228">More...</a><br /></td></tr>
<tr class="separator:aa6c77132d4fe5cdf4cb3d66186981228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47fd8875ad403d2b3b7c51b3ce2e0937"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a47fd8875ad403d2b3b7c51b3ce2e0937">roche2_width_max</a> ()</td></tr>
<tr class="memdesc:a47fd8875ad403d2b3b7c51b3ce2e0937"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the half width of the secondary Roche lobe.  <a href="#a47fd8875ad403d2b3b7c51b3ce2e0937">More...</a><br /></td></tr>
<tr class="separator:a47fd8875ad403d2b3b7c51b3ce2e0937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c51519f54c26122775ef8eaca1806d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a9c51519f54c26122775ef8eaca1806d8">roche</a> (double s, double *value, double *derivative)</td></tr>
<tr class="memdesc:a9c51519f54c26122775ef8eaca1806d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the value of the Roche potential and its derivative along a particular lien of sight.  <a href="#a9c51519f54c26122775ef8eaca1806d8">More...</a><br /></td></tr>
<tr class="separator:a9c51519f54c26122775ef8eaca1806d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72cfd7beaead2acdb08bb12eafa3197"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#aa72cfd7beaead2acdb08bb12eafa3197">roche_deriv</a> (double s, double *value, double *derivative)</td></tr>
<tr class="memdesc:aa72cfd7beaead2acdb08bb12eafa3197"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the first and second derivative of the roche potential along a specific line of sight.  <a href="#aa72cfd7beaead2acdb08bb12eafa3197">More...</a><br /></td></tr>
<tr class="separator:aa72cfd7beaead2acdb08bb12eafa3197"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a18146e93d3e11a3c0fae56976057c12f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structphoton.html">photon</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a18146e93d3e11a3c0fae56976057c12f">p_roche</a></td></tr>
<tr class="separator:a18146e93d3e11a3c0fae56976057c12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc09e0999f545c5536ae23fb5af7d6af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#adc09e0999f545c5536ae23fb5af7d6af">phi_init</a> = 0</td></tr>
<tr class="separator:adc09e0999f545c5536ae23fb5af7d6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa745f36e93f2d6e087104c461c0d8299"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#aa745f36e93f2d6e087104c461c0d8299">phi_gm1</a></td></tr>
<tr class="separator:aa745f36e93f2d6e087104c461c0d8299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3c00f91fc3b74caefda51e0b780164a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#ac3c00f91fc3b74caefda51e0b780164a">phi_gm2</a></td></tr>
<tr class="separator:ac3c00f91fc3b74caefda51e0b780164a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c49fe0824ac783b653795bdec304d52"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a5c49fe0824ac783b653795bdec304d52">phi_3</a></td></tr>
<tr class="separator:a5c49fe0824ac783b653795bdec304d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb4d1a2dda34ad3175ec3102efbbe55"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="roche_8c.html#a0fb4d1a2dda34ad3175ec3102efbbe55">phi_4</a></td></tr>
<tr class="separator:a0fb4d1a2dda34ad3175ec3102efbbe55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>These routines are used to describe the Roche geometry and are intended to allow one to calculate whether a photon intersects the surface of the star. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018</dd></dl>
<p>The important routines are</p>
<ul>
<li>binary_basics which uses the masses of the primary and the secondary to calculate the position of various Lagrange points, etc, and the size of a pillbox which encloses the Roche lobe of the secondary. It must be called before the other routines can be used!</li>
<li>ds_to_roche2 calculates the distance a photon defined by p_roche has to travel before it will encounter the secondary. If it misses, ds_to_roche2 returns VERY_BIG.</li>
<li>hit_secondary determines whether a photon defined by p_roche will hit the secondary or not. If it misses, hit_secondary returns 0, if it hits, the return is P_SEC (or hit secondary as contained in <a class="el" href="python_8h.html">python.h</a>).</li>
</ul>
<h3>Notes</h3>
<p>The secondary is located along the x, i.e. 0, axis</p>
<p>To utilize the routines you must stuff the photon of interest into the external photon "p_roche". This is necessary because the program makes use of two Numerical Recipes Routines rtsafe and golden to find zeroes and minima respectively. Note that it is possible (likely) that these are not the very best choices of Numerical Recipes routines to use. In particular it is possible that BRENT could replace both routines.</p>
<p>The routines adopt the same approach as in Keith Horne's routines dealing with the Roche geometry, that is a pillbox is defined around the secondary. The radius of the pillbox is determined by the maximum size of the secondary perpendicular to the line of sight between the two stars. One end of the pillbox is defined by the L1 point. The other end of the pillbox is defined by the backside of the secondary. One first tests to find out whether a photon intersects the pillbox, and then one checks more carefully to see whether the photon actually hits the secondary (using the intersections with the pillbox to define the limits of the careful search.</p>
<p>Note: ds_to_roche2 is not actually used by Python. It would be used if one wanted to calculate the heating of the secondary. </p>

<p class="definition">Definition in file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6ebf6899d6c1c8b7b9d09be872c05aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ebf6899d6c1c8b7b9d09be872c05aae">&#9670;&nbsp;</a></span>EPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EPS&#160;&#160;&#160;10000.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00499">499</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6a3c682535c3baaeb7c0e56ba18fe9da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3c682535c3baaeb7c0e56ba18fe9da">&#9670;&nbsp;</a></span>binary_basics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int binary_basics </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>From the masses and period, setup the information one needs to calculate the position of the Roche lobe of the secondary to calculate whether a photon intersects the surface of the star. </p>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00081">81</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_cgraph.png" border="0" usemap="#roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_cgraph" alt=""/></div>
<map name="roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_cgraph" id="roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="413,195,460,222"/>
<area shape="rect" id="node3" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="655,88,693,115"/>
<area shape="rect" id="node7" href="roche_8c.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="516,100,573,127"/>
<area shape="rect" id="node8" href="roche_8c.html#aa72cfd7beaead2acdb08bb12eafa3197" title="Calculate the first and second derivative of the roche potential along a specific line of sight..." alt="" coords="151,94,226,120"/>
<area shape="rect" id="node9" href="roche_8c.html#a7b0bed5d82ce2310bbd039704b3567cd" title="Calculate the second derivative of the Roche potential of the secondary. " alt="" coords="293,43,361,70"/>
<area shape="rect" id="node10" href="foo_8h.html#aabcf91dd6a4e633b1beb48978f9a71c1" title="A routine that mimimizes a function f. " alt="" coords="413,271,460,298"/>
<area shape="rect" id="node11" href="roche_8c.html#a47fd8875ad403d2b3b7c51b3ce2e0937" title="Find the half width of the secondary Roche lobe. " alt="" coords="136,308,241,335"/>
<area shape="rect" id="node21" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="293,398,361,424"/>
<area shape="rect" id="node4" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="778,38,827,64"/>
<area shape="rect" id="node5" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="770,88,835,115"/>
<area shape="rect" id="node6" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="767,139,839,166"/>
<area shape="rect" id="node12" href="roche_8c.html#aa6c77132d4fe5cdf4cb3d66186981228" title="Calculate the width of the Roche potentiil at a position x along the x axis. " alt="" coords="289,347,365,374"/>
<area shape="rect" id="node20" href="foo_8h.html#aac9129f52275f2d4c2469699cbcf3833" title="A routine that mimimizes a function f. " alt="" coords="301,296,353,323"/>
<area shape="rect" id="node13" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="415,347,459,374"/>
<area shape="rect" id="node14" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="887,322,944,348"/>
<area shape="rect" id="node15" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="508,296,581,323"/>
<area shape="rect" id="node16" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="629,246,719,272"/>
<area shape="rect" id="node19" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="652,296,696,323"/>
<area shape="rect" id="node17" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="783,195,822,222"/>
<area shape="rect" id="node18" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="771,246,834,272"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_icgraph.png" border="0" usemap="#roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_icgraph" alt=""/></div>
<map name="roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_icgraph" id="roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_icgraph">
<area shape="rect" id="node2" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="136,5,180,32"/>
</map>
</div>

</div>
</div>
<a id="a7b0bed5d82ce2310bbd039704b3567cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b0bed5d82ce2310bbd039704b3567cd">&#9670;&nbsp;</a></span>d2phi_ds2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double d2phi_ds2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the second derivative of the Roche potential of the secondary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>s The distance the phtoon has traveled from its inital postiion </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The second deritave</dd></dl>
<h3>Notes</h3>
<p>This is a brute force calculation of the derivative </p>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00549">549</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_cgraph.png" border="0" usemap="#roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_cgraph" alt=""/></div>
<map name="roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_cgraph" id="roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="121,56,160,83"/>
<area shape="rect" id="node3" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="219,5,269,32"/>
<area shape="rect" id="node4" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="211,56,277,83"/>
<area shape="rect" id="node5" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="208,107,280,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_icgraph.png" border="0" usemap="#roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_icgraph" alt=""/></div>
<map name="roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_icgraph" id="roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="257,22,340,48"/>
<area shape="rect" id="node3" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="121,22,209,48"/>
<area shape="rect" id="node4" href="templates_8h.html#aa72cfd7beaead2acdb08bb12eafa3197" title="Calculate the first and second derivative of the roche potential along a specific line of sight..." alt="" coords="128,72,203,99"/>
</map>
</div>

</div>
</div>
<a id="aa85d6bb7bef49e7e4b18d238eb2e6430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa85d6bb7bef49e7e4b18d238eb2e6430">&#9670;&nbsp;</a></span>dphi_ds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dphi_ds </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the gradient of the Roche potential as the photon travels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>s The distance the photon has traveled from its initial position </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the first derivative of the potential</dd></dl>
<p>This is a brute force calculation of the first derivative of the Roche potentail</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00517">517</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_cgraph.png" border="0" usemap="#roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_cgraph" alt=""/></div>
<map name="roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_cgraph" id="roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="111,56,149,83"/>
<area shape="rect" id="node3" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="209,5,258,32"/>
<area shape="rect" id="node4" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="201,56,266,83"/>
<area shape="rect" id="node5" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="197,107,269,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_icgraph.png" border="0" usemap="#roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_icgraph" alt=""/></div>
<map name="roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_icgraph" id="roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="495,98,577,125"/>
<area shape="rect" id="node3" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="205,22,293,49"/>
<area shape="rect" id="node4" href="templates_8h.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="111,73,157,100"/>
<area shape="rect" id="node7" href="templates_8h.html#aa72cfd7beaead2acdb08bb12eafa3197" title="Calculate the first and second derivative of the roche potential along a specific line of sight..." alt="" coords="357,174,431,201"/>
<area shape="rect" id="node5" href="templates_8h.html#aa6c77132d4fe5cdf4cb3d66186981228" title="Calculate the width of the Roche potentiil at a position x along the x axis. " alt="" coords="211,124,287,150"/>
<area shape="rect" id="node6" href="templates_8h.html#ad958df4fd3f6dd7f4ff01882d407c6c6" title="Find the half width of the secondary Roche lobe. " alt="" coords="341,124,447,150"/>
</map>
</div>

</div>
</div>
<a id="aff5a3156ec26863e37ff61073bb97ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff5a3156ec26863e37ff61073bb97ca4">&#9670;&nbsp;</a></span>ds_to_roche_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_roche_2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the distance to the Roche surface for a photon. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p The photon whose path one wishes to track </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the distance to the roche surface of the secondary for photon p, or VERY_BIG if the photon does not intercept the surface</dd></dl>
<p>Instead of simply determining whether the photon hits the Roche surface, this routine determine how far the photon would need to travel to hit the Roche surface.</p>
<h3>Notes</h3>
<p>This routine is currently not used in Python. It would be important if one actually wished to calculate the heating of the secondary.</p>
<p>If it were used for this purpose, one should confirm that it is working correctly </p>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00186">186</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_aff5a3156ec26863e37ff61073bb97ca4_cgraph.png" border="0" usemap="#roche_8c_aff5a3156ec26863e37ff61073bb97ca4_cgraph" alt=""/></div>
<map name="roche_8c_aff5a3156ec26863e37ff61073bb97ca4_cgraph" id="roche_8c_aff5a3156ec26863e37ff61073bb97ca4_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="162,91,209,118"/>
<area shape="rect" id="node3" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="419,142,457,169"/>
<area shape="rect" id="node5" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="535,117,600,143"/>
<area shape="rect" id="node6" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="531,345,603,371"/>
<area shape="rect" id="node7" href="roche_8c.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="287,41,344,67"/>
<area shape="rect" id="node8" href="foo_8h.html#aabcf91dd6a4e633b1beb48978f9a71c1" title="A routine that mimimizes a function f. " alt="" coords="162,573,209,599"/>
<area shape="rect" id="node9" href="roche_8c.html#a7b0bed5d82ce2310bbd039704b3567cd" title="Calculate the second derivative of the Roche potential of the secondary. " alt="" coords="281,142,349,169"/>
<area shape="rect" id="node10" href="foo_8h.html#ae3980e27bb2bae10474bdb798a3e84b1" title="ds_to_sphere2" alt="" coords="141,623,229,650"/>
<area shape="rect" id="node11" href="foo_8h.html#aac9129f52275f2d4c2469699cbcf3833" title="A routine that mimimizes a function f. " alt="" coords="159,674,211,701"/>
<area shape="rect" id="node12" href="roche_8c.html#a3a6359a23f10596d6bb51c80905c1c88" title="Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary..." alt="" coords="160,345,211,371"/>
<area shape="rect" id="node22" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="419,649,457,675"/>
<area shape="rect" id="node4" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="543,167,592,194"/>
<area shape="rect" id="node13" href="foo_8h.html#ae443765b508c1d69ac5249ef9de2bb81" title="calculates the distance of a photon must travel to hit the plane. " alt="" coords="277,395,353,422"/>
<area shape="rect" id="node14" href="foo_8h.html#a0940d7c3ced7e511ec385d4de758b436" title="quadratic" alt="" coords="284,294,347,321"/>
<area shape="rect" id="node15" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="293,497,337,523"/>
<area shape="rect" id="node16" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="771,598,828,625"/>
<area shape="rect" id="node17" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="401,547,475,574"/>
<area shape="rect" id="node18" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="523,598,612,625"/>
<area shape="rect" id="node21" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="545,547,589,574"/>
<area shape="rect" id="node19" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="672,649,711,675"/>
<area shape="rect" id="node20" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="660,598,723,625"/>
</map>
</div>

</div>
</div>
<a id="ad4ca36cf5f0eaaa3fb044a982d922fb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4ca36cf5f0eaaa3fb044a982d922fb3">&#9670;&nbsp;</a></span>hit_secondary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hit_secondary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find out whether a photon will hit the secondary, but don't actually calculate the point where it hits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p A photon, for which we have a possiton and adirection of travel </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the photon would miss the secondary, P_SEC otherwise</dd></dl>
<p>The routine chacks whether a photon hits the Roche lobe of the secondary star.</p>
<h3>Notes</h3>
<p>The routine first checks if the photon encounters a pill_box that surrouds the secondary. Photons that do not encounter this pill box do not hit the secondar. If the photon enters the pill box, then the routine determines whether the photon hits the roche surface of the secondary, by finding the minimum value of the Rooche potential. If this is greater than 0, then the photon has missed the secondary. If less thn zero then it has hit the secondary. </p>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00263">263</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_cgraph.png" border="0" usemap="#roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_cgraph" alt=""/></div>
<map name="roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_cgraph" id="roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#aac9129f52275f2d4c2469699cbcf3833" title="A routine that mimimizes a function f. " alt="" coords="137,5,189,32"/>
<area shape="rect" id="node3" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="144,107,183,133"/>
<area shape="rect" id="node5" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="243,56,308,83"/>
<area shape="rect" id="node7" href="roche_8c.html#a3a6359a23f10596d6bb51c80905c1c88" title="Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary..." alt="" coords="138,157,189,184"/>
<area shape="rect" id="node4" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="251,5,300,32"/>
<area shape="rect" id="node6" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="239,107,311,133"/>
<area shape="rect" id="node8" href="foo_8h.html#ae443765b508c1d69ac5249ef9de2bb81" title="calculates the distance of a photon must travel to hit the plane. " alt="" coords="237,157,313,184"/>
<area shape="rect" id="node9" href="foo_8h.html#a0940d7c3ced7e511ec385d4de758b436" title="quadratic" alt="" coords="244,208,307,235"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="253,259,297,285"/>
<area shape="rect" id="node11" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="731,259,788,285"/>
<area shape="rect" id="node12" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="361,284,435,311"/>
<area shape="rect" id="node13" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="483,271,572,297"/>
<area shape="rect" id="node16" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="505,321,549,348"/>
<area shape="rect" id="node14" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="632,259,671,285"/>
<area shape="rect" id="node15" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="620,309,683,336"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_icgraph.png" border="0" usemap="#roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_icgraph" alt=""/></div>
<map name="roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_icgraph" id="roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="137,31,212,57"/>
<area shape="rect" id="node3" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="260,31,312,57"/>
<area shape="rect" id="node4" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="509,31,579,57"/>
<area shape="rect" id="node7" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="360,56,461,83"/>
<area shape="rect" id="node5" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="627,5,736,32"/>
<area shape="rect" id="node6" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="639,56,724,83"/>
</map>
</div>

</div>
</div>
<a id="a4a0210aea098f52ca60dfbc90de4ecee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a0210aea098f52ca60dfbc90de4ecee">&#9670;&nbsp;</a></span>phi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double phi </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the Roche potential at position indicated by the photon p_roche and the length s. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>s The distance from the current position of the photon to the point where one wishes to calculate the Roche potentail </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The Roche potential at the postiong given by the photon moved by a distance s</dd></dl>
<p>Given a photon stored in p_roche and a distance s to move the photone, phi returns the roche potentail at that point</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00457">457</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_cgraph.png" border="0" usemap="#roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_cgraph" alt=""/></div>
<map name="roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_cgraph" id="roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="103,5,153,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="95,56,161,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="92,107,164,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_icgraph.png" border="0" usemap="#roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_icgraph" alt=""/></div>
<map name="roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_icgraph" id="roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_icgraph">
<area shape="rect" id="node2" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="134,132,197,159"/>
<area shape="rect" id="node9" href="templates_8h.html#a9300319cf99a4a66db3876befda54050" title="computes a random direction for a photon undergoing compton scattering. " alt="" coords="127,183,204,209"/>
<area shape="rect" id="node10" href="cylind__var_8c.html#a352d864e752cc2b9041a5e2ad1e5ffff" title="Generate a position at a random location within a specific cell of a domain with modified&#45;cylindrical..." alt="" coords="92,233,239,260"/>
<area shape="rect" id="node12" href="cylindrical_8c.html#ab19f6786630fce8ae46bbd702d80d59b" title="Generate a position at a random location within a specific cell of a domain with cylindrical coordina..." alt="" coords="92,284,239,311"/>
<area shape="rect" id="node13" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="143,335,187,361"/>
<area shape="rect" id="node14" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="299,5,391,32"/>
<area shape="rect" id="node15" href="random_8c.html#a7f068ecd35b9bfa33543749a6350ce6c" title="randvec" alt="" coords="137,385,194,412"/>
<area shape="rect" id="node16" href="random_8c.html#a773dffa7060439d58d12e63aa47e6945" title="randvcos" alt="" coords="134,436,197,463"/>
<area shape="rect" id="node17" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="740,588,823,615"/>
<area shape="rect" id="node18" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="451,664,539,691"/>
<area shape="rect" id="node19" href="templates_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="123,791,207,817"/>
<area shape="rect" id="node20" href="templates_8h.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="137,588,194,615"/>
<area shape="rect" id="node21" href="templates_8h.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="321,512,368,539"/>
<area shape="rect" id="node25" href="templates_8h.html#a7b0bed5d82ce2310bbd039704b3567cd" title="Calculate the second derivative of the Roche potential of the secondary. " alt="" coords="311,765,379,792"/>
<area shape="rect" id="node26" href="rtheta_8c.html#ac89ea2d29fd2c00fd675f641d98b8b59" title="rtheta_get_random_location" alt="" coords="92,841,239,868"/>
<area shape="rect" id="node27" href="spherical_8c.html#aadfbcaed1dc773ebb991e922722a5267" title="spherical_get_random\l_location" alt="" coords="105,893,226,934"/>
<area shape="rect" id="node3" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="297,157,393,184"/>
<area shape="rect" id="node6" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="298,56,391,83"/>
<area shape="rect" id="node7" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="292,107,397,133"/>
<area shape="rect" id="node8" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="319,208,371,235"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="457,81,533,108"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="602,81,677,108"/>
<area shape="rect" id="node11" href="wind2d_8c.html#af8f7fd3a6d5f7872ee87beb27dcba899" title="is simply will produce a postion at a random place in a cell n " alt="" coords="287,272,403,299"/>
<area shape="rect" id="node24" href="templates_8h.html#aa72cfd7beaead2acdb08bb12eafa3197" title="Calculate the first and second derivative of the roche potential along a specific line of sight..." alt="" coords="457,715,532,741"/>
<area shape="rect" id="node22" href="templates_8h.html#aa6c77132d4fe5cdf4cb3d66186981228" title="Calculate the width of the Roche potentiil at a position x along the x axis. " alt="" coords="457,563,533,589"/>
<area shape="rect" id="node23" href="templates_8h.html#ad958df4fd3f6dd7f4ff01882d407c6c6" title="Find the half width of the secondary Roche lobe. " alt="" coords="587,563,692,589"/>
</map>
</div>

</div>
</div>
<a id="a3a6359a23f10596d6bb51c80905c1c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a6359a23f10596d6bb51c80905c1c88">&#9670;&nbsp;</a></span>pillbox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pillbox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>smin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>smax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p The photon whose trajectory we wish to examine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* smin If the photon, hits the pillbox, this is how far the photon must travel to enter the pillbox </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* smax If the photon, hits the pillbox, this is how far the photon must travel to exit the pillbox </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pillbox returns VERY_BIG if the photon p has not intersected the pillbox. It appears to return the distance to the pillbox if the photon p hits the pillbox. smin and smax contain the entrance and exit distances. It is not obvious that smin &lt; smax.</dd></dl>
<p>The purpose of this routine is to separate photons which may hit the Roche surface and those which certainly do not by seeing if the photon avoids a pillbox surrounding the secondary. If the photons does not enter the pillbox then one dos not have to explore in detail whether the photon hits the Roche surrvace.</p>
<p>If the photon does pass through the secondary, then the routine returns the distances of entry and exit which are used to limit the range of root finding that then must take place.</p>
<h3>Notes</h3>
<p>The pillbox is defined by a plane at L1, a plane on the backside of the star and a cylinder whose radius is the maximum (half) width of the star in the plane of the orbit.</p>
<p>This routine distinguishes two basic types of photons, "normal" and "abnormal" photons. A normal photon is on the WD side of L1 plane; an abnormal one is on the side of the L1 plane with the secondary.</p>
<p>Note: 01jul22 ksl revised this so that it would handle photons coming in all directions for use with plot_roche but this instantiation of pillbox still seems to me not optical. The basic point is that unless the photon is in the pillbox, the only roots that matter are ones which are positive. Only inside the pillbox will there be a positive and a negative root. Here we try to correct this at the end by making sure that both roots are not negative, but one would have thought that one might establish that that photons inside the pillbox are special and dealt with them accordindly </p>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00323">323</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a3a6359a23f10596d6bb51c80905c1c88_cgraph.png" border="0" usemap="#roche_8c_a3a6359a23f10596d6bb51c80905c1c88_cgraph" alt=""/></div>
<map name="roche_8c_a3a6359a23f10596d6bb51c80905c1c88_cgraph" id="roche_8c_a3a6359a23f10596d6bb51c80905c1c88_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#ae443765b508c1d69ac5249ef9de2bb81" title="calculates the distance of a photon must travel to hit the plane. " alt="" coords="104,5,180,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a0940d7c3ced7e511ec385d4de758b436" title="quadratic" alt="" coords="111,56,173,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="109,107,175,133"/>
<area shape="rect" id="node5" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="106,157,178,184"/>
<area shape="rect" id="node6" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="120,208,164,235"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="597,208,655,235"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="228,233,301,260"/>
<area shape="rect" id="node9" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="349,220,439,247"/>
<area shape="rect" id="node12" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="372,271,416,297"/>
<area shape="rect" id="node10" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="499,208,537,235"/>
<area shape="rect" id="node11" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="487,259,549,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a3a6359a23f10596d6bb51c80905c1c88_icgraph.png" border="0" usemap="#roche_8c_a3a6359a23f10596d6bb51c80905c1c88_icgraph" alt=""/></div>
<map name="roche_8c_a3a6359a23f10596d6bb51c80905c1c88_icgraph" id="roche_8c_a3a6359a23f10596d6bb51c80905c1c88_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="104,5,192,32"/>
<area shape="rect" id="node3" href="templates_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="106,56,190,83"/>
</map>
</div>

</div>
</div>
<a id="a9c51519f54c26122775ef8eaca1806d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c51519f54c26122775ef8eaca1806d8">&#9670;&nbsp;</a></span>roche()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void roche </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>derivative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the value of the Roche potential and its derivative along a particular lien of sight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>s The distance s </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* value The value of the Roche potenial at a distance s along the path of the photon </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* derivative The derivative of the roche potential as the photon tavels </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>N/A</dd></dl>
<p>This is the function used by the Recipes routine rtsafe to locate specific surfaces of the Roche potential. Here *value is phi and *derivative is the slope of phi at s along the vector defined by p_roche. The value of phi has to be set in advance through geo.phi and would normally be that of the Roche lobe</p>
<h3>Notes</h3>
<p>The routime simply calls phi and dphi_ds </p>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00677">677</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a9c51519f54c26122775ef8eaca1806d8_cgraph.png" border="0" usemap="#roche_8c_a9c51519f54c26122775ef8eaca1806d8_cgraph" alt=""/></div>
<map name="roche_8c_a9c51519f54c26122775ef8eaca1806d8_cgraph" id="roche_8c_a9c51519f54c26122775ef8eaca1806d8_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="205,56,244,83"/>
<area shape="rect" id="node6" href="roche_8c.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="100,81,157,108"/>
<area shape="rect" id="node3" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="303,5,353,32"/>
<area shape="rect" id="node4" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="295,56,361,83"/>
<area shape="rect" id="node5" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="292,107,364,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a9c51519f54c26122775ef8eaca1806d8_icgraph.png" border="0" usemap="#roche_8c_a9c51519f54c26122775ef8eaca1806d8_icgraph" alt=""/></div>
<map name="roche_8c_a9c51519f54c26122775ef8eaca1806d8_icgraph" id="roche_8c_a9c51519f54c26122775ef8eaca1806d8_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="389,25,472,51"/>
<area shape="rect" id="node3" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="100,25,188,51"/>
<area shape="rect" id="node4" href="templates_8h.html#aa6c77132d4fe5cdf4cb3d66186981228" title="Calculate the width of the Roche potentiil at a position x along the x axis. " alt="" coords="106,75,182,102"/>
<area shape="rect" id="node5" href="templates_8h.html#ad958df4fd3f6dd7f4ff01882d407c6c6" title="Find the half width of the secondary Roche lobe. " alt="" coords="236,50,341,77"/>
</map>
</div>

</div>
</div>
<a id="a47fd8875ad403d2b3b7c51b3ce2e0937"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47fd8875ad403d2b3b7c51b3ce2e0937">&#9670;&nbsp;</a></span>roche2_width_max()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double roche2_width_max </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the half width of the secondary Roche lobe. </p>
<dl class="section return"><dt>Returns</dt><dd>The half width is returned</dd></dl>
<p>Find the maximum half width of the Roche lobe of the secondary. This routine uses the NR routine golden to find the point in x where the Roche lobe is maximized.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00631">631</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_cgraph.png" border="0" usemap="#roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_cgraph" alt=""/></div>
<map name="roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_cgraph" id="roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#aa6c77132d4fe5cdf4cb3d66186981228" title="Calculate the width of the Roche potentiil at a position x along the x axis. " alt="" coords="159,183,235,209"/>
<area shape="rect" id="node17" href="foo_8h.html#aac9129f52275f2d4c2469699cbcf3833" title="A routine that mimimizes a function f. " alt="" coords="171,240,223,267"/>
<area shape="rect" id="node18" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="380,353,448,380"/>
<area shape="rect" id="node3" href="roche_8c.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="283,107,329,133"/>
<area shape="rect" id="node9" href="foo_8h.html#aabcf91dd6a4e633b1beb48978f9a71c1" title="A routine that mimimizes a function f. " alt="" coords="283,157,329,184"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="284,208,328,235"/>
<area shape="rect" id="node4" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="524,56,563,83"/>
<area shape="rect" id="node8" href="roche_8c.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="385,107,443,133"/>
<area shape="rect" id="node5" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="647,5,697,32"/>
<area shape="rect" id="node6" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="639,56,705,83"/>
<area shape="rect" id="node7" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="636,107,708,133"/>
<area shape="rect" id="node11" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="756,259,813,285"/>
<area shape="rect" id="node12" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="377,259,451,285"/>
<area shape="rect" id="node13" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="499,233,588,260"/>
<area shape="rect" id="node16" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="521,284,565,311"/>
<area shape="rect" id="node14" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="653,208,691,235"/>
<area shape="rect" id="node15" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="641,259,703,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_icgraph.png" border="0" usemap="#roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_icgraph" alt=""/></div>
<map name="roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_icgraph" id="roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="159,5,241,32"/>
</map>
</div>

</div>
</div>
<a id="aa72cfd7beaead2acdb08bb12eafa3197"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa72cfd7beaead2acdb08bb12eafa3197">&#9670;&nbsp;</a></span>roche_deriv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void roche_deriv </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>derivative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the first and second derivative of the roche potential along a specific line of sight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>s The distance from the initial photon position at which derivatives are to be calcualted </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* value The first derivative </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* derivative The second derivatiove </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>N/A</dd></dl>
<p>This is the function used by the Recipes routine rtsafe to lacate extrema of the Roche potential. Thus it can be used to find the L1 point, for example. Here *value is the derivative of phi at s along the vector defined by p_roche, and *derivative is the second derivative</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00707">707</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_cgraph.png" border="0" usemap="#roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_cgraph" alt=""/></div>
<map name="roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_cgraph" id="roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="133,31,191,57"/>
<area shape="rect" id="node7" href="roche_8c.html#a7b0bed5d82ce2310bbd039704b3567cd" title="Calculate the second derivative of the Roche potential of the secondary. " alt="" coords="128,81,196,108"/>
<area shape="rect" id="node3" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="244,56,283,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="342,5,391,32"/>
<area shape="rect" id="node5" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="334,56,399,83"/>
<area shape="rect" id="node6" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="331,107,403,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_icgraph.png" border="0" usemap="#roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_icgraph" alt=""/></div>
<map name="roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_icgraph" id="roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="128,5,211,32"/>
</map>
</div>

</div>
</div>
<a id="aa6c77132d4fe5cdf4cb3d66186981228"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6c77132d4fe5cdf4cb3d66186981228">&#9670;&nbsp;</a></span>roche_width()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double roche_width </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the width of the Roche potentiil at a position x along the x axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>x The distance the phtoon has traveled from its initial position</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the width</dd></dl>
<p>Calculate the half width of the Roche lobe at the position x along the x axis in the plane of the orbit.</p>
<h3>Notes</h3>
<p>There is no real guarantee that this would work if you were outside L2 or L3. </p>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00586">586</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_cgraph.png" border="0" usemap="#roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_cgraph" alt=""/></div>
<map name="roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_cgraph" id="roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_cgraph">
<area shape="rect" id="node2" href="roche_8c.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="129,75,176,101"/>
<area shape="rect" id="node8" href="foo_8h.html#aabcf91dd6a4e633b1beb48978f9a71c1" title="A routine that mimimizes a function f. " alt="" coords="129,125,176,152"/>
<area shape="rect" id="node9" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="131,176,175,203"/>
<area shape="rect" id="node3" href="roche_8c.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="371,56,409,83"/>
<area shape="rect" id="node7" href="roche_8c.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="232,100,289,127"/>
<area shape="rect" id="node4" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="494,5,543,32"/>
<area shape="rect" id="node5" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="486,56,551,83"/>
<area shape="rect" id="node6" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="483,107,555,133"/>
<area shape="rect" id="node10" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="603,213,660,240"/>
<area shape="rect" id="node11" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="224,264,297,291"/>
<area shape="rect" id="node12" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="345,239,435,265"/>
<area shape="rect" id="node15" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="368,289,412,316"/>
<area shape="rect" id="node13" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="499,213,538,240"/>
<area shape="rect" id="node14" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="487,264,550,291"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_icgraph.png" border="0" usemap="#roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_icgraph" alt=""/></div>
<map name="roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_icgraph" id="roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ad958df4fd3f6dd7f4ff01882d407c6c6" title="Find the half width of the secondary Roche lobe. " alt="" coords="129,5,235,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="283,5,365,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a18146e93d3e11a3c0fae56976057c12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18146e93d3e11a3c0fae56976057c12f">&#9670;&nbsp;</a></span>p_roche</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structphoton.html">photon</a> p_roche</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p_roche provides a way to pass a photon structure to <a class="el" href="roche_8c.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight...">roche()</a> and roche_derive which are in turn used by the Numerical Recipes Routine rtsafe to find the zero either to dphi_ds or to phi along the path lenght of the photon </p>

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00065">65</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>

</div>
</div>
<a id="a5c49fe0824ac783b653795bdec304d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c49fe0824ac783b653795bdec304d52">&#9670;&nbsp;</a></span>phi_3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double phi_3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00439">439</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>

</div>
</div>
<a id="a0fb4d1a2dda34ad3175ec3102efbbe55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fb4d1a2dda34ad3175ec3102efbbe55">&#9670;&nbsp;</a></span>phi_4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double phi_4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00439">439</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>

</div>
</div>
<a id="aa745f36e93f2d6e087104c461c0d8299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa745f36e93f2d6e087104c461c0d8299">&#9670;&nbsp;</a></span>phi_gm1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double phi_gm1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00439">439</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>

</div>
</div>
<a id="ac3c00f91fc3b74caefda51e0b780164a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3c00f91fc3b74caefda51e0b780164a">&#9670;&nbsp;</a></span>phi_gm2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double phi_gm2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00439">439</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>

</div>
</div>
<a id="adc09e0999f545c5536ae23fb5af7d6af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc09e0999f545c5536ae23fb5af7d6af">&#9670;&nbsp;</a></span>phi_init</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int phi_init = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="roche_8c_source.html#l00438">438</a> of file <a class="el" href="roche_8c_source.html">roche.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="roche_8c.html">roche.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
