<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/get_models.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('get__models_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">get_models.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The routines here provide a way to read grids of models and then to interpolate between them.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;strings.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="models_8h_source.html">models.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for get_models.c:</div>
<div class="dyncontent">
<div class="center"><img src="get__models_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2get__models_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2get__models_8c" id="_2_users_2mhewitt_2python_2source_2get__models_8c">
<area shape="rect" id="node7" href="atomic_8h.html" title="atomic.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node8" href="python_8h.html" title="python.h" alt="" coords="483,95,543,121"/>
<area shape="rect" id="node13" href="models_8h.html" title="models.h" alt="" coords="567,95,629,121"/>
<area shape="rect" id="node9" href="log_8h.html" title="log.h" alt="" coords="367,169,411,196"/>
<area shape="rect" id="node10" href="version_8h.html" title="version.h" alt="" coords="435,169,497,196"/>
<area shape="rect" id="node11" href="templates_8h.html" title="templates.h" alt="" coords="521,169,595,196"/>
<area shape="rect" id="node12" href="recipes_8h.html" title="recipes.h" alt="" coords="619,169,681,196"/>
</map>
</div>
</div>
<p><a href="get__models_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a38eb76aa0a9a1bb1dac30c75be4a05b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__models_8c.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>&#160;&#160;&#160;1e32</td></tr>
<tr class="separator:a38eb76aa0a9a1bb1dac30c75be4a05b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a59b857f2f3debe87e91f33a5e01be07c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__models_8c.html#a59b857f2f3debe87e91f33a5e01be07c">get_models</a> (modellist, int npars, int *spectype)</td></tr>
<tr class="memdesc:a59b857f2f3debe87e91f33a5e01be07c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine reads in a set of models for use in generation of spectra, e.g. a set of Kurucz stellar atmospheres which can used to simulate a disk, given a run of temperature and gravity.  <a href="#a59b857f2f3debe87e91f33a5e01be07c">More...</a><br /></td></tr>
<tr class="separator:a59b857f2f3debe87e91f33a5e01be07c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c22576993d87a5e2ca959c5ca662e70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__models_8c.html#a1c22576993d87a5e2ca959c5ca662e70">get_one_model</a> (filename, struct <a class="el" href="struct_model.html">Model</a> *onemod)</td></tr>
<tr class="memdesc:a1c22576993d87a5e2ca959c5ca662e70"><td class="mdescLeft">&#160;</td><td class="mdescRight">reads a single model file from disk and puts the result into the structure onemod  <a href="#a1c22576993d87a5e2ca959c5ca662e70">More...</a><br /></td></tr>
<tr class="separator:a1c22576993d87a5e2ca959c5ca662e70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17cbe892d03676c0123c4b578d6534d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0">model</a> (int spectype, par)</td></tr>
<tr class="memdesc:a17cbe892d03676c0123c4b578d6534d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">interpolates between spectra in a grid placing the results in comp[spectype].xmod  <a href="#a17cbe892d03676c0123c4b578d6534d0">More...</a><br /></td></tr>
<tr class="separator:a17cbe892d03676c0123c4b578d6534d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6c2d8e607e9d5955c71062389ea8c7e9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__models_8c.html#a6c2d8e607e9d5955c71062389ea8c7e9">get_models_init</a> = 0</td></tr>
<tr class="memdesc:a6c2d8e607e9d5955c71062389ea8c7e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Needed so can initialize nmods_tot the first time this routine is called.  <a href="#a6c2d8e607e9d5955c71062389ea8c7e9">More...</a><br /></td></tr>
<tr class="separator:a6c2d8e607e9d5955c71062389ea8c7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af44ef37e3c3faa319a9786405fba5b2a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__models_8c.html#af44ef37e3c3faa319a9786405fba5b2a">nmodel_error</a> = 0</td></tr>
<tr class="separator:af44ef37e3c3faa319a9786405fba5b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a025ef5f25888471473393860af969739"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="get__models_8c.html#a025ef5f25888471473393860af969739">nmodel_terror</a> = 0</td></tr>
<tr class="separator:a025ef5f25888471473393860af969739"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The routines here provide a way to read grids of models and then to interpolate between them. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March, 2018</dd></dl>
<pre class="fragment">There are two main routines

    get_models (modellist, npars, spectype)

which reads a list of models

and

    model (spectype, par)

which given a set of parameters will interpolate between modles
given the set of models one wants to interpolate betwee, which
is determined by spectype, and the set of parameters (par) that
define the models
</pre><h3>Notes</h3>
<p>A detailed understanding of these routines requires an understandig of the associated data structures which are in <a class="el" href="models_8h.html">models.h</a></p>
<p>The individual models are contained in a stucture called Models</p>
<p>A summary of a set of models is contained in <a class="el" href="struct_mod_sum.html">ModSum</a>, along with a interpolated model generated by the routine model</p>
<p>get_models is called as part of the initialization process.</p>
<p>model is called as one generates photons for specific raddiation sources, e.g the disk. It stores a spectrum/cdf of that spectrum in <a class="el" href="struct_mod_sum.html">ModSum</a>, which can be used to genreate photons for that spectrum. </p>

<p class="definition">Definition in file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a38eb76aa0a9a1bb1dac30c75be4a05b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38eb76aa0a9a1bb1dac30c75be4a05b6">&#9670;&nbsp;</a></span>BIG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BIG&#160;&#160;&#160;1e32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="get__models_8c_source.html#l00056">56</a> of file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a59b857f2f3debe87e91f33a5e01be07c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b857f2f3debe87e91f33a5e01be07c">&#9670;&nbsp;</a></span>get_models()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_models </td>
          <td>(</td>
          <td class="paramtype">modellist&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>spectype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This routine reads in a set of models for use in generation of spectra, e.g. a set of Kurucz stellar atmospheres which can used to simulate a disk, given a run of temperature and gravity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>modellist[] filename containing location and associated parameters of models </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>npars Number of parameters which vary for these models </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* spectype spectype an integer that is incremented each time a new set of models is read in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>*spectype is also returned</dd></dl>
<p>These are a generic set of routines to read a grid or grids of models, e.g. a set of Kurucz stellar atmospheres which can used to simulate a disk, given a run of temperature and gravity</p>
<p>The grid can be any reasonable number of dimension</p>
<h3>Notes</h3>
<p>Basically, the way this works is as followsL</p>
<p>modellist is a file that cantains a list of models, and the parameters that are associated with each model. (There can be mulitple parameters associated with each file. Typically these are temperature, and gravity, but these routines are generic, and so one could image that the the spectra are organized quite differently</p>
<p>Each model, that is read in contains a list of wavelengths and a flux, that should be proportional to flambda.</p>
<p>There are some assumptions that are made in terms of the order in the modellist file. Specifically"</p>
<pre class="fragment">For 1d models we assume the models are read in increasing order of
the parameter of interest.

2 or more parameter models can be read in any order.  Bilinear interpolation
is done for the 2 parameter models (as long as the grid is fully filled).


To deal with cases in which the grid is not fully filled, we follow
the same approach as for get_hub, i.e. for parameters t and g (i.e.
the first parameter being t, and the second g., we first search the grid
for all models with t just below (above) the desired value.  We then
interpolate on g for the model just below, and on g for the model just
above, and finally interpolate between these two.
The algorithm for interpolating between models


Note that each time a new set of models is read in, the spectype is
incremented.</pre> 
<p class="definition">Definition at line <a class="el" href="get__models_8c_source.html#l00124">124</a> of file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_cgraph.png" border="0" usemap="#get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_cgraph" alt=""/></div>
<map name="get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_cgraph" id="get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_cgraph">
<area shape="rect" id="node2" href="get__models_8c.html#a1c22576993d87a5e2ca959c5ca662e70" title="reads a single model file from disk and puts the result into the structure onemod ..." alt="" coords="127,86,217,113"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="265,86,309,113"/>
<area shape="rect" id="node10" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="268,188,307,214"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="727,86,784,113"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="357,86,431,113"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="479,61,568,88"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="501,112,545,138"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="628,36,667,62"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="616,86,679,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_icgraph.png" border="0" usemap="#get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_icgraph" alt=""/></div>
<map name="get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_icgraph" id="get__models_8c_a59b857f2f3debe87e91f33a5e01be07c_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ab358cbada062a9acccdf184b57630305" title="Generalized routine to get the spectrum type for a radiation source and if necessary read a set of pr..." alt="" coords="127,5,208,32"/>
</map>
</div>

</div>
</div>
<a id="a1c22576993d87a5e2ca959c5ca662e70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c22576993d87a5e2ca959c5ca662e70">&#9670;&nbsp;</a></span>get_one_model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_one_model </td>
          <td>(</td>
          <td class="paramtype">filename&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct_model.html">Model</a> *&#160;</td>
          <td class="paramname"><em>onemod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reads a single model file from disk and puts the result into the structure onemod </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>filename[] The name of the file containing the model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">struct</td><td><a class="el" href="struct_model.html">Model</a> * onemod A pointer to the structure where the model is to be stored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of wavelengths and fluxes read from the file</dd></dl>
<p>This is simply a utility routine called by get_models to read in a single model into the modle stucture </p>

<p class="definition">Definition at line <a class="el" href="get__models_8c_source.html#l00290">290</a> of file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_cgraph.png" border="0" usemap="#get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_cgraph" alt=""/></div>
<map name="get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_cgraph" id="get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="144,25,188,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="605,25,663,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="236,51,309,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="357,37,447,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="380,88,424,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="507,25,545,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="495,76,557,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_icgraph.png" border="0" usemap="#get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_icgraph" alt=""/></div>
<map name="get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_icgraph" id="get__models_8c_a1c22576993d87a5e2ca959c5ca662e70_icgraph">
<area shape="rect" id="node2" href="get__models_8c.html#a59b857f2f3debe87e91f33a5e01be07c" title="This routine reads in a set of models for use in generation of spectra, e.g. a set of Kurucz stellar ..." alt="" coords="144,5,217,32"/>
<area shape="rect" id="node3" href="templates_8h.html#ab358cbada062a9acccdf184b57630305" title="Generalized routine to get the spectrum type for a radiation source and if necessary read a set of pr..." alt="" coords="265,5,347,32"/>
</map>
</div>

</div>
</div>
<a id="a17cbe892d03676c0123c4b578d6534d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17cbe892d03676c0123c4b578d6534d0">&#9670;&nbsp;</a></span>model()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spectype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">par&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>interpolates between spectra in a grid placing the results in comp[spectype].xmod </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>spectype A number which refers to a specific collecton of models, which were read in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>par[] An array that contains the parameters for the models we want to interpoalted, e.g [T, grav] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns nwaves in the the spectrum if a new spectrum was calculated 0 if it was the old spectrum.</dd></dl>
<p>This is an intepolation routine. Having previously read in a set of models which are associated with a set of parameter, e.g T and g, we want the spectrum at some t and g, which is not necessaily in the grid. This routien does the interpolation and stores the result in comp[spectype].mod</p>
<p>The routine is generic as long as the requested parameters are within the grid of models, but the routine makes the assumption that the first parameter is a temperature if the value of the first parameter outside the range of that parameter.</p>
<h3>Notes</h3>
<p>If the parameters for the interpolated routine are within the grid of models, and the grid is fully filled, then a straighfoward interpolation is carried out.</p>
<p>If models are missing from the grid or if the requested model has parameters which are outside the grid, an "interpolated" model is still returned but assumptions are made which are intended to provide a reasonable solution for the case, where the first parameter is a temperature, and the second parameter is a gravity.</p>
<p>Specfically, for a missing model, the first thing that happens is that the routine first ignores the missing model treating each of the others as if bi-linear interpolation was being used, and then renormalizing to make sure the weights of the models that one does have sum to 1. The solution is "practical" because it always gives a result, and because it gives the an appropriate answer when the grid is filled. It is also easily extensible to more than two dimensions. But it should be noted, the approach is also dangerous.</p>
<p>Lastly, if the first parameter is out of range, it assumes that the first parameter was a temperature, and it modifies the spectrum by the ratio of a BB speccturm for the desired spectrum to the temperature of the max/min temperature in the grid. So for example, suppose the models which were read in were for Kuruce models, which run out a temperature of about 50,000k and you wnat the spectrum of a star which is 100,000K. Then the routine will deliver a spectrum which has line features of a 50,000K star, but an overall specturm which has the shape of a 100,000 K BB. This is not a good situation for this extreme case, but may be reasonable if the temperature differences are less extreme. </p>

<p class="definition">Definition at line <a class="el" href="get__models_8c_source.html#l00383">383</a> of file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__models_8c_a17cbe892d03676c0123c4b578d6534d0_cgraph.png" border="0" usemap="#get__models_8c_a17cbe892d03676c0123c4b578d6534d0_cgraph" alt=""/></div>
<map name="get__models_8c_a17cbe892d03676c0123c4b578d6534d0_cgraph" id="get__models_8c_a17cbe892d03676c0123c4b578d6534d0_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="103,25,147,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="564,25,621,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="195,51,268,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="316,37,405,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="339,88,383,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="465,25,504,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="453,76,516,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="get__models_8c_a17cbe892d03676c0123c4b578d6534d0_icgraph.png" border="0" usemap="#get__models_8c_a17cbe892d03676c0123c4b578d6534d0_icgraph" alt=""/></div>
<map name="get__models_8c_a17cbe892d03676c0123c4b578d6534d0_icgraph" id="get__models_8c_a17cbe892d03676c0123c4b578d6534d0_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="116,95,207,121"/>
<area shape="rect" id="node8" href="templates_8h.html#a9d1648c5fc65c0c98f2cdf51dfaee558" title="get the surface flux for Hubeny/Kurucz like stellar models " alt="" coords="103,171,220,197"/>
<area shape="rect" id="node3" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="268,5,360,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="268,56,360,83"/>
<area shape="rect" id="node7" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="268,107,360,133"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="409,81,485,108"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="676,145,751,172"/>
<area shape="rect" id="node9" href="templates_8h.html#ab6c8e4e9577a9edb71a9a5900d43964c" title="Calculates the total luminosity of an AGN type source. " alt="" coords="285,157,343,184"/>
<area shape="rect" id="node12" href="templates_8h.html#a0bc15d347d507f21da65e37f659de349" title="(r, tstar, freqmin, freqmax, ioniz_or_final, f) " alt="" coords="285,208,343,235"/>
<area shape="rect" id="node13" href="templates_8h.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="285,259,343,285"/>
<area shape="rect" id="node10" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="408,196,487,223"/>
<area shape="rect" id="node11" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="535,196,628,223"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6c2d8e607e9d5955c71062389ea8c7e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c2d8e607e9d5955c71062389ea8c7e9">&#9670;&nbsp;</a></span>get_models_init</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_models_init = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Needed so can initialize nmods_tot the first time this routine is called. </p>

<p class="definition">Definition at line <a class="el" href="get__models_8c_source.html#l00062">62</a> of file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>

</div>
</div>
<a id="af44ef37e3c3faa319a9786405fba5b2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af44ef37e3c3faa319a9786405fba5b2a">&#9670;&nbsp;</a></span>nmodel_error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nmodel_error = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="get__models_8c_source.html#l00330">330</a> of file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>

</div>
</div>
<a id="a025ef5f25888471473393860af969739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a025ef5f25888471473393860af969739">&#9670;&nbsp;</a></span>nmodel_terror</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nmodel_terror = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="get__models_8c_source.html#l00331">331</a> of file <a class="el" href="get__models_8c_source.html">get_models.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="get__models_8c.html">get_models.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
