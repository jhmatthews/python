<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/photon_gen.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('photon__gen_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">photon_gen.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Primary routines for creating photons for use in the radiative transfer calculation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for photon_gen.c:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2photon__gen_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2photon__gen_8c" id="_2_users_2mhewitt_2python_2source_2photon__gen_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="photon__gen_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1ca9f64427b2bc5b538fe2fa2501c639"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a1ca9f64427b2bc5b538fe2fa2501c639">STEPS</a>&#160;&#160;&#160;100000</td></tr>
<tr class="separator:a1ca9f64427b2bc5b538fe2fa2501c639"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa943bd857500a1f2937d8b97d84ff633"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#aa943bd857500a1f2937d8b97d84ff633">define_phot</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double f1, double f2, long nphot_tot, int ioniz_or_final, int iwind, int freq_sampling)</td></tr>
<tr class="memdesc:aa943bd857500a1f2937d8b97d84ff633"><td class="mdescLeft">&#160;</td><td class="mdescRight">the controlling routine for creating the underlying photon distribution.  <a href="#aa943bd857500a1f2937d8b97d84ff633">More...</a><br /></td></tr>
<tr class="separator:aa943bd857500a1f2937d8b97d84ff633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addfbba966a4d69bdc71b771e0d7f3cdf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#addfbba966a4d69bdc71b771e0d7f3cdf">populate_bands</a> (double f1, double f2, int ioniz_or_final, int iwind, struct <a class="el" href="structxbands.html">xbands</a> *band)</td></tr>
<tr class="memdesc:addfbba966a4d69bdc71b771e0d7f3cdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine how many photons to allocate to each band.  <a href="#addfbba966a4d69bdc71b771e0d7f3cdf">More...</a><br /></td></tr>
<tr class="separator:addfbba966a4d69bdc71b771e0d7f3cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0acf2d461c665dc0302defa95ded65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a9a0acf2d461c665dc0302defa95ded65">xdefine_phot</a> (double f1, double f2, int ioniz_or_final, int iwind)</td></tr>
<tr class="memdesc:a9a0acf2d461c665dc0302defa95ded65"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by reinitializing the disk, among other things).  <a href="#a9a0acf2d461c665dc0302defa95ded65">More...</a><br /></td></tr>
<tr class="separator:a9a0acf2d461c665dc0302defa95ded65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f1c9362f29a0b44f41cff21494b6df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#ab7f1c9362f29a0b44f41cff21494b6df">xmake_phot</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double f1, double f2, int ioniz_or_final, int iwind, double weight, int iphot_start, int nphotons)</td></tr>
<tr class="memdesc:ab7f1c9362f29a0b44f41cff21494b6df"><td class="mdescLeft">&#160;</td><td class="mdescRight">just makes photons  <a href="#ab7f1c9362f29a0b44f41cff21494b6df">More...</a><br /></td></tr>
<tr class="separator:ab7f1c9362f29a0b44f41cff21494b6df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bc15d347d507f21da65e37f659de349"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a0bc15d347d507f21da65e37f659de349">star_init</a> (double freqmin, double freqmax, int ioniz_or_final, double *f)</td></tr>
<tr class="memdesc:a0bc15d347d507f21da65e37f659de349"><td class="mdescLeft">&#160;</td><td class="mdescRight">(r, tstar, freqmin, freqmax, ioniz_or_final, f)  <a href="#a0bc15d347d507f21da65e37f659de349">More...</a><br /></td></tr>
<tr class="separator:a0bc15d347d507f21da65e37f659de349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e1b27b1fe040ccadcd39a5783c4d60"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a19e1b27b1fe040ccadcd39a5783c4d60">photo_gen_star</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double <a class="el" href="import__spherical_8c.html#a83175ac8fd9d924ff2bce40c99e88870">r</a>, double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, double weight, double f1, double f2, int spectype, int istart, int nphot)</td></tr>
<tr class="memdesc:a19e1b27b1fe040ccadcd39a5783c4d60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate nphot photons from the star in the frequency interval f1 to f2.  <a href="#a19e1b27b1fe040ccadcd39a5783c4d60">More...</a><br /></td></tr>
<tr class="separator:a19e1b27b1fe040ccadcd39a5783c4d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c3ee1b7657b6c1bc4e6c1e6d8300020"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020">disk_init</a> (double rmin, double rmax, double m, double mdot, double freqmin, double freqmax, int ioniz_or_final, double *ftot)</td></tr>
<tr class="memdesc:a3c3ee1b7657b6c1bc4e6c1e6d8300020"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk. More importantly divides the disk into annulae such that each annulus contributes and equal amount to the lumionosity of the disk (within the frequency limits). Thus initializes the structure "disk".  <a href="#a3c3ee1b7657b6c1bc4e6c1e6d8300020">More...</a><br /></td></tr>
<tr class="separator:a3c3ee1b7657b6c1bc4e6c1e6d8300020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e59fd8ed9979322e86a14ed34c2851"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#ac6e59fd8ed9979322e86a14ed34c2851">photo_gen_disk</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double weight, double f1, double f2, int spectype, int istart, int nphot)</td></tr>
<tr class="memdesc:ac6e59fd8ed9979322e86a14ed34c2851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate disk photons.  <a href="#ac6e59fd8ed9979322e86a14ed34c2851">More...</a><br /></td></tr>
<tr class="separator:ac6e59fd8ed9979322e86a14ed34c2851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c7b56c161732c7397e69c4ff4bdb31"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a07c7b56c161732c7397e69c4ff4bdb31">phot_gen_sum</a> (filename, mode)</td></tr>
<tr class="memdesc:a07c7b56c161732c7397e69c4ff4bdb31"><td class="mdescLeft">&#160;</td><td class="mdescRight">write information about the disk to a file  <a href="#a07c7b56c161732c7397e69c4ff4bdb31">More...</a><br /></td></tr>
<tr class="separator:a07c7b56c161732c7397e69c4ff4bdb31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb47deaf80a8f3a6f07ab91d843d960e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#afb47deaf80a8f3a6f07ab91d843d960e">bl_init</a> (double lum_bl, double t_bl, double freqmin, double freqmax, int ioniz_or_final, double *f)</td></tr>
<tr class="memdesc:afb47deaf80a8f3a6f07ab91d843d960e"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate parameters need to intialize the boundary layer (namely the band-liminted luminoisity)  <a href="#afb47deaf80a8f3a6f07ab91d843d960e">More...</a><br /></td></tr>
<tr class="separator:afb47deaf80a8f3a6f07ab91d843d960e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a663f46d36d6962c7993e4c002442c23b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a663f46d36d6962c7993e4c002442c23b">photon_checks</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double freqmin, double freqmax, char *comment)</td></tr>
<tr class="memdesc:a663f46d36d6962c7993e4c002442c23b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform some simple checks on the photon distribution just produced.  <a href="#a663f46d36d6962c7993e4c002442c23b">More...</a><br /></td></tr>
<tr class="separator:a663f46d36d6962c7993e4c002442c23b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab21ea56600a6e1eb09e89816449e09f9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#ab21ea56600a6e1eb09e89816449e09f9">f1_old</a> = 0</td></tr>
<tr class="separator:ab21ea56600a6e1eb09e89816449e09f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d422c86ec453018368d16aa7c079cd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#a40d422c86ec453018368d16aa7c079cd">f2_old</a> = 0</td></tr>
<tr class="separator:a40d422c86ec453018368d16aa7c079cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa454ec9a17879579643258a3855270c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="photon__gen_8c.html#aa454ec9a17879579643258a3855270c3">iwind_old</a> = 0</td></tr>
<tr class="separator:aa454ec9a17879579643258a3855270c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Primary routines for creating photons for use in the radiative transfer calculation. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1ca9f64427b2bc5b538fe2fa2501c639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ca9f64427b2bc5b538fe2fa2501c639">&#9670;&nbsp;</a></span>STEPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STEPS&#160;&#160;&#160;100000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00801">801</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afb47deaf80a8f3a6f07ab91d843d960e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb47deaf80a8f3a6f07ab91d843d960e">&#9670;&nbsp;</a></span>bl_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double bl_init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lum_bl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_bl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ioniz_or_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate parameters need to intialize the boundary layer (namely the band-liminted luminoisity) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] double lum_bl The desired luminosity for the boundary layaer </td></tr>
    <tr><td class="paramname">[in</td><td>out] double t_bl The temperature </td></tr>
    <tr><td class="paramname">[in</td><td>out] double freqmin The minimum freqency in the band </td></tr>
    <tr><td class="paramname">[in</td><td>out] double freqmax The maximum freqency in the band </td></tr>
    <tr><td class="paramname">[in</td><td>out] int ioniz_or_final The spectral type to use in the calucation (NOT USED) but see below </td></tr>
    <tr><td class="paramname">[in</td><td>out] double * f The band limited luminosity </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total luminosity</dd></dl>
<p>The only thing that is actually calculated here is f, the luminosity within the frequency range that is specified.</p>
<p>This routine calculates the luminosity of the bl within the frequency boundaries. BB functions are assumed. It was derived from the same routine for a star, but here we have assumed that the temperature and the luminosity are known</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000045">Bug:</a></b></dt><dd>At present bl_init assumes a BB regardless of the spectrum. This is not really correct, and is different for what is done in initializing the star</dd></dl>
<p>0703 - ksl - This is rather an odd little routine. As noted all that is calculated is f. ioniz_or_final is not used, and lum_bl which is returned is only the luminosity that was passed. </p>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l01244">1244</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_cgraph.png" border="0" usemap="#photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_cgraph" alt=""/></div>
<map name="photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_cgraph" id="photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_cgraph">
<area shape="rect" id="node2" href="bb_8c.html#af5c48487242ab8760a1893e385d3e11b" title="Obtains the integral of the dimensionless blackbody function between alphamin and alphamax..." alt="" coords="101,55,191,81"/>
<area shape="rect" id="node3" href="bb_8c.html#aa67b840e2ff05fc474799c42178b392e" title="calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in a..." alt="" coords="239,55,347,81"/>
<area shape="rect" id="node4" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="395,29,457,56"/>
<area shape="rect" id="node6" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="401,80,451,107"/>
<area shape="rect" id="node5" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="505,29,552,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_icgraph.png" border="0" usemap="#photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_icgraph" alt=""/></div>
<map name="photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_icgraph" id="photon__gen_8c_afb47deaf80a8f3a6f07ab91d843d960e_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="101,5,180,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="369,5,444,32"/>
<area shape="rect" id="node4" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="228,31,321,57"/>
</map>
</div>

</div>
</div>
<a id="aa943bd857500a1f2937d8b97d84ff633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa943bd857500a1f2937d8b97d84ff633">&#9670;&nbsp;</a></span>define_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int define_phot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nphot_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ioniz_or_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iwind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq_sampling</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the controlling routine for creating the underlying photon distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">PhotPtr</td><td>p The structure where all photons are stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The mininum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency if a uniform distribution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">long</td><td>nphot_tot The total number of photons that need to be generated to reach the total luminosity, not necessarilly the number of photons which will be generated by the call to define_phot, which instead is defined by NPHOT </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ioniz_or_final 0 -&gt; this is for the wind ionization calculation, 1-&gt; it is for the final spectrum calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iwind A variable (see below) that controls the generation of phtons for the wind </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>freq_sampling If 0, generate photons over the full frequency range without banding, else use banding </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This routine oversees the generation of photons for the radiative transfer calculation. Most of the actual work is done in other routines, particularly xdefine_phot). There can be multiple radiation sources (e.g the star and a disk)</p>
<p>There are two basic approaches to generating photons. One can sample the entire wavelength interval in which case all photons have the same weight, but photon frequencies are selected based on the the specific luminiosty. In the banded approach, one defines bands in which photons are generated. Specific numbers of photons are are generated in each band, and within a band the photons are selected according the the specific luminosity, but the weights of photons in different bands differ. still used for detailed spectrum calculation. Which of this choices to use is controlled by freq_sampling (The weights are established here)</p>
<p>iwind is a variable that determines how or whether to create photons from the wind:</p><ul>
<li>-1-&gt; Do not consider wind photons under any circumstances</li>
<li>0 -&gt;Consider wind photons. There is no need to recalculate the relative contribution to number of photons from the wind unless the frequencies have changed</li>
<li>1 -&gt; Force a recalculation of the fraction of photons from the wind. This is necessary because after each ionization recalculation one needs to recalculate the flux fraction from the wind.</li>
</ul>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000043">Bug:</a></b></dt><dd>Is this correct, have subcycles been removed.</dd></dl>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00075">75</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_cgraph.png" border="0" usemap="#photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_cgraph" alt=""/></div>
<map name="photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_cgraph" id="photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_cgraph">
<area shape="rect" id="node2" href="photon__gen_8c.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="269,765,348,792"/>
<area shape="rect" id="node53" href="photon__gen_8c.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="271,2120,347,2147"/>
<area shape="rect" id="node100" href="foo_8h.html#a7719923b66bf470bc4eeb42c454ebd48" title="Generates path for a &#39;wind&#39; photon in photon mode. " alt="" coords="567,3577,695,3604"/>
<area shape="rect" id="node109" href="photon__gen_8c.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="128,1157,221,1184"/>
<area shape="rect" id="node3" href="photon__gen_8c.html#a0bc15d347d507f21da65e37f659de349" title="(r, tstar, freqmin, freqmax, ioniz_or_final, f) " alt="" coords="425,867,483,893"/>
<area shape="rect" id="node19" href="photon__gen_8c.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="425,1196,483,1223"/>
<area shape="rect" id="node26" href="photon__gen_8c.html#afb47deaf80a8f3a6f07ab91d843d960e" title="calculate parameters need to intialize the boundary layer (namely the band&#45;liminted luminoisity) ..." alt="" coords="430,563,478,589"/>
<area shape="rect" id="node27" href="agn_8c.html#ab6c8e4e9577a9edb71a9a5900d43964c" title="Calculates the total luminosity of an AGN type source. " alt="" coords="425,816,483,843"/>
<area shape="rect" id="node30" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1259,1424,1297,1451"/>
<area shape="rect" id="node32" href="emission_8c.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="408,208,500,235"/>
<area shape="rect" id="node50" href="foo_8h.html#ac8797bce5a5f3411f4162dff928b7920" title="returns the specific band&#45;limited luminosity in macro&#45;atoms " alt="" coords="414,613,494,640"/>
<area shape="rect" id="node51" href="foo_8h.html#ab250057e4381b5be827dcf4cd35fb3fe" title="returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k&#45;packet &#45;&gt; r&#45;packet in the required wavelength range. " alt="" coords="420,664,488,691"/>
<area shape="rect" id="node52" href="foo_8h.html#a5fc061a271cdb55a6e05db67fafd504c" title="a routine which reports the matom level and kpkt emissivities summed over all cells. It is called in define_phot() in the spectral cycles, after get_matom_f() " alt="" coords="396,715,512,741"/>
<area shape="rect" id="node4" href="bb_8c.html#a337db7e010442d30f7c4b45f3e41fa5c" title="Calculate the emittance of a bb between freqmin and freqmax. " alt="" coords="590,816,673,843"/>
<area shape="rect" id="node10" href="continuum_8c.html#a9d1648c5fc65c0c98f2cdf51dfaee558" title="get the surface flux for Hubeny/Kurucz like stellar models " alt="" coords="573,1069,690,1096"/>
<area shape="rect" id="node5" href="bb_8c.html#af5c48487242ab8760a1893e385d3e11b" title="Obtains the integral of the dimensionless blackbody function between alphamin and alphamax..." alt="" coords="764,563,853,589"/>
<area shape="rect" id="node7" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="1102,613,1165,640"/>
<area shape="rect" id="node9" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="1108,816,1159,843"/>
<area shape="rect" id="node6" href="bb_8c.html#aa67b840e2ff05fc474799c42178b392e" title="calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in a..." alt="" coords="917,613,1025,640"/>
<area shape="rect" id="node8" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="1255,968,1301,995"/>
<area shape="rect" id="node11" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="946,1880,995,1907"/>
<area shape="rect" id="node12" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1256,2564,1300,2591"/>
<area shape="rect" id="node13" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1733,1525,1791,1552"/>
<area shape="rect" id="node14" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="1364,1627,1437,1653"/>
<area shape="rect" id="node15" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1485,1576,1575,1603"/>
<area shape="rect" id="node18" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1508,1627,1552,1653"/>
<area shape="rect" id="node16" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1635,1576,1673,1603"/>
<area shape="rect" id="node17" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1623,1525,1685,1552"/>
<area shape="rect" id="node20" href="disk_8c.html#a3440890f45c87b4c79fef37820f87487" title="Calculate the temperature of the disk at a normalised distance x. " alt="" coords="1114,1728,1153,1755"/>
<area shape="rect" id="node21" href="disk_8c.html#adc2a482ce6c550cd7e5498bf0ee1055b" title="Calculate the reference temperarure for a standard Shakura&#45;Sunyaeev disk. " alt="" coords="610,1171,653,1197"/>
<area shape="rect" id="node22" href="disk_8c.html#aa4eb3da682e26e1705216d977de95a0a" title="Calculate the effective gravity at a specfic position in the disk. " alt="" coords="612,1221,651,1248"/>
<area shape="rect" id="node23" href="disk_8c.html#a2d9e855352fbd6de6a7ed1cd79ac4a64" title="Calculate a reference gravity for the disk. " alt="" coords="609,1272,654,1299"/>
<area shape="rect" id="node24" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="1244,1171,1312,1197"/>
<area shape="rect" id="node25" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="772,1880,845,1907"/>
<area shape="rect" id="node28" href="agn_8c.html#ab172924888b8579c4acdd737732edce1" title="The luminosity of a power law over a frerquency range. " alt="" coords="1089,968,1178,995"/>
<area shape="rect" id="node29" href="agn_8c.html#a9bd7eb064b17d9b352e044d5e417a649" title="Works out the luminosity of a broken power law. " alt="" coords="923,867,1018,893"/>
<area shape="rect" id="node31" href="brem_8c.html#aaf2a9843cc170d6b01b75a1704f8c4fb" title="The integrand used in qromb to compute the luminosity of a bremstrahlung source. " alt="" coords="595,917,667,944"/>
<area shape="rect" id="node33" href="foo_8h.html#a0018131577a59a5142e3677785504d37" title="Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines..." alt="" coords="599,5,663,32"/>
<area shape="rect" id="node34" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="589,208,674,235"/>
<area shape="rect" id="node35" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="761,208,857,235"/>
<area shape="rect" id="node40" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="781,107,836,133"/>
<area shape="rect" id="node41" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="761,309,856,336"/>
<area shape="rect" id="node47" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="777,411,841,437"/>
<area shape="rect" id="node49" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="755,157,862,184"/>
<area shape="rect" id="node36" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="944,157,997,184"/>
<area shape="rect" id="node38" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="935,208,1006,235"/>
<area shape="rect" id="node39" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="939,107,1002,133"/>
<area shape="rect" id="node37" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="1094,335,1173,361"/>
<area shape="rect" id="node42" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="951,360,990,387"/>
<area shape="rect" id="node43" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="925,411,1017,437"/>
<area shape="rect" id="node44" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="951,461,990,488"/>
<area shape="rect" id="node45" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="951,259,990,285"/>
<area shape="rect" id="node46" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="938,309,1003,336"/>
<area shape="rect" id="node48" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="1104,1981,1163,2008"/>
<area shape="rect" id="node54" href="photon__gen_8c.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="585,2311,677,2337"/>
<area shape="rect" id="node75" href="emission_8c.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="406,2741,502,2768"/>
<area shape="rect" id="node101" href="photon__gen_8c.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="585,2412,677,2439"/>
<area shape="rect" id="node104" href="agn_8c.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="585,2120,677,2147"/>
<area shape="rect" id="node107" href="foo_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="407,2792,501,2819"/>
<area shape="rect" id="node108" href="foo_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="401,1728,507,1755"/>
<area shape="rect" id="node55" href="bb_8c.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="783,2159,834,2185"/>
<area shape="rect" id="node58" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="1085,2488,1181,2515"/>
<area shape="rect" id="node68" href="continuum_8c.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="763,2488,854,2515"/>
<area shape="rect" id="node72" href="foo_8h.html#a1881a8f6279e1472e741aab3ee654383" title="randvec" alt="" coords="780,2539,837,2565"/>
<area shape="rect" id="node73" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="786,2387,831,2413"/>
<area shape="rect" id="node74" href="foo_8h.html#ac5e9ac55fb4bf0dbb108c006f509b32b" title="randvcos" alt="" coords="777,2336,840,2363"/>
<area shape="rect" id="node56" href="cdf_8c.html#ab79e837935267ae9f6061620404f000e" title="get a random number for a cdf inside limits set by cdf_limit. " alt="" coords="919,2235,1023,2261"/>
<area shape="rect" id="node59" href="bb_8c.html#a6bae7f74815dfcf783a7dafade8faeca" title="obtains a random number between x1 and x2 for a power law densiity distribution with index alpha ..." alt="" coords="928,2032,1013,2059"/>
<area shape="rect" id="node60" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="917,2792,1025,2819"/>
<area shape="rect" id="node62" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="1244,3197,1312,3224"/>
<area shape="rect" id="node66" href="cdf_8c.html#aecb77ca29971f4b21ea483ab1672e652" title="sets limit1 and limit2 so that one can generate distributions from a limited range within a previousl..." alt="" coords="941,2083,1000,2109"/>
<area shape="rect" id="node67" href="bb_8c.html#af2d9c9e4094a425824f269ef22163048" title="obtain a random number between alpha_min and alpha_max from an distribution of the form e**&#45;alpha ..." alt="" coords="929,2336,1012,2363"/>
<area shape="rect" id="node57" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="1099,2323,1167,2349"/>
<area shape="rect" id="node61" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="1100,2691,1167,2717"/>
<area shape="rect" id="node63" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="1075,2640,1192,2667"/>
<area shape="rect" id="node65" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="1083,2792,1183,2819"/>
<area shape="rect" id="node64" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="1240,3349,1316,3376"/>
<area shape="rect" id="node69" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="946,3147,995,3173"/>
<area shape="rect" id="node70" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="915,2843,1027,2869"/>
<area shape="rect" id="node71" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="931,2640,1011,2667"/>
<area shape="rect" id="node76" href="emission_8c.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="784,2640,833,2667"/>
<area shape="rect" id="node78" href="foo_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="605,2944,657,2971"/>
<area shape="rect" id="node79" href="emission_8c.html#a8a9a281cba993682e32c78c93f264f35" title="gets the frequency of a single collisionally excited line photon in a particular cell of the wind..." alt="" coords="941,2995,1001,3021"/>
<area shape="rect" id="node80" href="foo_8h.html#a55dba11eab85fa51b5bbf621a3c66b57" title="get_random_location" alt="" coords="573,2640,689,2667"/>
<area shape="rect" id="node81" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="600,3223,663,3249"/>
<area shape="rect" id="node94" href="anisowind_8c.html#a5cc282e1f3d56ce0f29cb080bc225408" title="is the routine which chooses a new anisotropic direction in geo.scatter_mode = SCATTER_MODE_THERMAL ..." alt="" coords="560,3527,703,3553"/>
<area shape="rect" id="node97" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="597,2691,665,2717"/>
<area shape="rect" id="node98" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="789,3552,828,3579"/>
<area shape="rect" id="node99" href="foo_8h.html#a176ee6debad2930212ca97a2d28794c0" title="Generates path for a wind photon. " alt="" coords="571,2741,691,2768"/>
<area shape="rect" id="node77" href="emission_8c.html#ade7eab896d4188a5b8a4ed6845d33150" title="calculate f_nu for ff emisssion " alt="" coords="951,2184,990,2211"/>
<area shape="rect" id="node82" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="789,3400,828,3427"/>
<area shape="rect" id="node83" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="766,3147,851,3173"/>
<area shape="rect" id="node84" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="781,3755,837,3781"/>
<area shape="rect" id="node85" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="945,3653,997,3680"/>
<area shape="rect" id="node86" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="753,3603,865,3629"/>
<area shape="rect" id="node88" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="776,3197,841,3224"/>
<area shape="rect" id="node89" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="751,2995,867,3021"/>
<area shape="rect" id="node90" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="948,3299,993,3325"/>
<area shape="rect" id="node91" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="946,3400,995,3427"/>
<area shape="rect" id="node92" href="foo_8h.html#ab0b1a9d790b71c94f9562c567eeee268" title="create_basis" alt="" coords="769,3045,848,3072"/>
<area shape="rect" id="node93" href="foo_8h.html#a5672a43b959d7e6d398852cbc41ee6b1" title="project_from" alt="" coords="770,3096,847,3123"/>
<area shape="rect" id="node87" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="1099,3501,1167,3528"/>
<area shape="rect" id="node95" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="753,3957,864,3984"/>
<area shape="rect" id="node96" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="774,3907,843,3933"/>
<area shape="rect" id="node102" href="disk_8c.html#a29076b6a07403d62872baf4dc9bf9346" title="Calculate the speed and velocity v at which material given specific position in the disk..." alt="" coords="786,3349,831,3376"/>
<area shape="rect" id="node103" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="944,3349,997,3376"/>
<area shape="rect" id="node105" href="brem_8c.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="764,2083,853,2109"/>
<area shape="rect" id="node106" href="brem_8c.html#ab308d8424a5b2ab066577630b7150e7b" title="The integrand for integrating a dimensionless bremstrahlung spectrum. " alt="" coords="1105,1120,1161,1147"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_icgraph.png" border="0" usemap="#photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_icgraph" alt=""/></div>
<map name="photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_icgraph" id="photon__gen_8c_aa943bd857500a1f2937d8b97d84ff633_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="128,5,237,32"/>
<area shape="rect" id="node3" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="140,56,225,83"/>
</map>
</div>

</div>
</div>
<a id="a3c3ee1b7657b6c1bc4e6c1e6d8300020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c3ee1b7657b6c1bc4e6c1e6d8300020">&#9670;&nbsp;</a></span>disk_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double disk_init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mdot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ioniz_or_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ftot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk. More importantly divides the disk into annulae such that each annulus contributes and equal amount to the lumionosity of the disk (within the frequency limits). Thus initializes the structure "disk". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>rmin The minimum radius of the disk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>rmax The maximum radius of the disk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>m mass of central object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>mdot mass accretion rate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmin The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmax The maximum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ioniz_or_final A flag indicating whether this is an ionization or a detailed spectral cycle (used to determine the spectral type to use) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* ftot The band limited luminosity in the freqency interval </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the total luminosity of the disk</dd></dl>
<p>This routine assumes the temperature distribution for the disk is that of a simple Shakura-Sunyaev disk, and uses this to determine the band limited luminosity of the disk. Additionally, it divides the disk in the rings of the same band-limited luminosity, so that equal numbers of photons can be generated from each ring. (The reason the disk has to be initilaized mulitple times is because the rings are different for different freqency intervals.)</p>
<h3>Notes</h3>
<p>The information needed to generate photons from the disk is stored in the disk structure. The positional parameters x and v are at the edge of the ring, but many of the other parameters (like temperature) are at the mid point. </p>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00842">842</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_cgraph.png" border="0" usemap="#photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_cgraph" alt=""/></div>
<map name="photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_cgraph" id="photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_cgraph">
<area shape="rect" id="node2" href="disk_8c.html#a3440890f45c87b4c79fef37820f87487" title="Calculate the temperature of the disk at a normalised distance x. " alt="" coords="303,308,341,335"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="447,384,491,411"/>
<area shape="rect" id="node10" href="disk_8c.html#adc2a482ce6c550cd7e5498bf0ee1055b" title="Calculate the reference temperarure for a standard Shakura&#45;Sunyaeev disk. " alt="" coords="149,207,192,233"/>
<area shape="rect" id="node11" href="disk_8c.html#aa4eb3da682e26e1705216d977de95a0a" title="Calculate the effective gravity at a specfic position in the disk. " alt="" coords="151,257,190,284"/>
<area shape="rect" id="node12" href="disk_8c.html#a2d9e855352fbd6de6a7ed1cd79ac4a64" title="Calculate a reference gravity for the disk. " alt="" coords="148,308,193,335"/>
<area shape="rect" id="node13" href="bb_8c.html#a337db7e010442d30f7c4b45f3e41fa5c" title="Calculate the emittance of a bb between freqmin and freqmax. " alt="" coords="129,80,212,107"/>
<area shape="rect" id="node19" href="continuum_8c.html#a9d1648c5fc65c0c98f2cdf51dfaee558" title="get the surface flux for Hubeny/Kurucz like stellar models " alt="" coords="112,409,229,436"/>
<area shape="rect" id="node21" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="829,472,897,499"/>
<area shape="rect" id="node22" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="432,207,505,233"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="945,359,1003,385"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="571,359,644,385"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="692,308,781,335"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="715,359,759,385"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="844,308,883,335"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="832,257,895,284"/>
<area shape="rect" id="node14" href="bb_8c.html#af5c48487242ab8760a1893e385d3e11b" title="Obtains the integral of the dimensionless blackbody function between alphamin and alphamax..." alt="" coords="277,55,367,81"/>
<area shape="rect" id="node16" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="576,29,639,56"/>
<area shape="rect" id="node18" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="582,93,633,120"/>
<area shape="rect" id="node15" href="bb_8c.html#aa67b840e2ff05fc474799c42178b392e" title="calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in a..." alt="" coords="415,55,523,81"/>
<area shape="rect" id="node17" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="713,29,760,56"/>
<area shape="rect" id="node20" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="297,359,347,385"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_icgraph.png" border="0" usemap="#photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_icgraph" alt=""/></div>
<map name="photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_icgraph" id="photon__gen_8c_a3c3ee1b7657b6c1bc4e6c1e6d8300020_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="112,5,191,32"/>
<area shape="rect" id="node5" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="129,56,173,83"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="380,5,455,32"/>
<area shape="rect" id="node4" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="239,31,332,57"/>
</map>
</div>

</div>
</div>
<a id="a07c7b56c161732c7397e69c4ff4bdb31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c7b56c161732c7397e69c4ff4bdb31">&#9670;&nbsp;</a></span>phot_gen_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int phot_gen_sum </td>
          <td>(</td>
          <td class="paramtype">filename&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write information about the disk to a file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] char filename[] The name of the file </td></tr>
    <tr><td class="paramname">[in</td><td>out] char mode[] A switch to determine whther to write a new file or append to an existing file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine normal writes the disk.diag file. It provides infomration not only about the rings used, but also about the number of photons that hit each ring,</p>
<h3>Notes</h3>
<p>This routine is now well-named </p>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l01181">1181</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>

</div>
</div>
<a id="ac6e59fd8ed9979322e86a14ed34c2851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e59fd8ed9979322e86a14ed34c2851">&#9670;&nbsp;</a></span>photo_gen_disk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int photo_gen_disk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spectype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>istart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nphot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate disk photons. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">PhotPtr</td><td>p The entire photon structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>weight The weight of photons to generate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maxnimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>spectype The spectrum type to generate: 0 is bb </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>istart The starting point in p for generating photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nphot The number of photons to generate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l01019">1019</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_cgraph.png" border="0" usemap="#photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_cgraph" alt=""/></div>
<map name="photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_cgraph" id="photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_cgraph">
<area shape="rect" id="node2" href="bb_8c.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="165,372,216,399"/>
<area shape="rect" id="node7" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="455,397,551,424"/>
<area shape="rect" id="node8" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="625,651,669,677"/>
<area shape="rect" id="node26" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="171,448,210,475"/>
<area shape="rect" id="node27" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="736,144,804,171"/>
<area shape="rect" id="node28" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="168,549,213,576"/>
<area shape="rect" id="node29" href="foo_8h.html#ac5e9ac55fb4bf0dbb108c006f509b32b" title="randvcos" alt="" coords="159,600,222,627"/>
<area shape="rect" id="node30" href="continuum_8c.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="145,727,236,753"/>
<area shape="rect" id="node35" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="611,1019,684,1045"/>
<area shape="rect" id="node36" href="disk_8c.html#a29076b6a07403d62872baf4dc9bf9346" title="Calculate the speed and velocity v at which material given specific position in the disk..." alt="" coords="168,1208,213,1235"/>
<area shape="rect" id="node41" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="171,1259,210,1285"/>
<area shape="rect" id="node3" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="479,195,526,221"/>
<area shape="rect" id="node4" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="309,195,371,221"/>
<area shape="rect" id="node5" href="cdf_8c.html#ab79e837935267ae9f6061620404f000e" title="get a random number for a cdf inside limits set by cdf_limit. " alt="" coords="288,549,392,576"/>
<area shape="rect" id="node15" href="bb_8c.html#a6bae7f74815dfcf783a7dafade8faeca" title="obtains a random number between x1 and x2 for a power law densiity distribution with index alpha ..." alt="" coords="297,296,383,323"/>
<area shape="rect" id="node16" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="286,651,394,677"/>
<area shape="rect" id="node19" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="613,968,681,995"/>
<area shape="rect" id="node23" href="cdf_8c.html#aecb77ca29971f4b21ea483ab1672e652" title="sets limit1 and limit2 so that one can generate distributions from a limited range within a previousl..." alt="" coords="473,107,532,133"/>
<area shape="rect" id="node24" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="315,347,365,373"/>
<area shape="rect" id="node25" href="bb_8c.html#af2d9c9e4094a425824f269ef22163048" title="obtain a random number between alpha_min and alpha_max from an distribution of the form e**&#45;alpha ..." alt="" coords="299,397,381,424"/>
<area shape="rect" id="node6" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="469,499,537,525"/>
<area shape="rect" id="node9" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1103,752,1160,779"/>
<area shape="rect" id="node10" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="733,701,807,728"/>
<area shape="rect" id="node11" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="855,752,944,779"/>
<area shape="rect" id="node14" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="877,701,921,728"/>
<area shape="rect" id="node12" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1004,803,1043,829"/>
<area shape="rect" id="node13" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="992,752,1055,779"/>
<area shape="rect" id="node17" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="469,904,536,931"/>
<area shape="rect" id="node20" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="444,651,561,677"/>
<area shape="rect" id="node22" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="453,803,553,829"/>
<area shape="rect" id="node18" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="628,892,667,919"/>
<area shape="rect" id="node21" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="609,600,685,627"/>
<area shape="rect" id="node31" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="478,701,527,728"/>
<area shape="rect" id="node32" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="315,1157,365,1184"/>
<area shape="rect" id="node33" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="284,879,396,905"/>
<area shape="rect" id="node34" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="300,600,380,627"/>
<area shape="rect" id="node37" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="314,1208,366,1235"/>
<area shape="rect" id="node38" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="315,1259,365,1285"/>
<area shape="rect" id="node39" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="317,1309,363,1336"/>
<area shape="rect" id="node40" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="313,1360,367,1387"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_icgraph.png" border="0" usemap="#photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_icgraph" alt=""/></div>
<map name="photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_icgraph" id="photon__gen_8c_ac6e59fd8ed9979322e86a14ed34c2851_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="145,5,221,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="269,5,344,32"/>
</map>
</div>

</div>
</div>
<a id="a19e1b27b1fe040ccadcd39a5783c4d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19e1b27b1fe040ccadcd39a5783c4d60">&#9670;&nbsp;</a></span>photo_gen_star()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int photo_gen_star </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spectype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>istart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nphot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate nphot photons from the star in the frequency interval f1 to f2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">PhotPtr</td><td>p The entire photon structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>r The radiius at which to generate photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t The effective temperature of the stat </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>weight The weight of photons to generate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequencey </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequencey </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>spectype The type of spectrum (bb or spectral model) to use in generating photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>istart The positions in the photon structure where the first photons will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nphot The nubmer of photons to generate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine generates photons emergying from a sphere. It uses randvcos to determine the direction of the photon.</p>
<h3>Notes</h3>
<p>This routine is also used in generating photons from a boundary layer</p>
<p>The routine allows for the possibility that part of the star will be covered by a vertically extended disk and avoids generating photons there. </p>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00722">722</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_cgraph.png" border="0" usemap="#photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_cgraph" alt=""/></div>
<map name="photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_cgraph" id="photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="625,651,669,677"/>
<area shape="rect" id="node9" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="736,100,804,127"/>
<area shape="rect" id="node10" href="bb_8c.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="165,423,216,449"/>
<area shape="rect" id="node15" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="455,321,551,348"/>
<area shape="rect" id="node27" href="continuum_8c.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="145,777,236,804"/>
<area shape="rect" id="node32" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="611,448,684,475"/>
<area shape="rect" id="node33" href="foo_8h.html#a1881a8f6279e1472e741aab3ee654383" title="randvec" alt="" coords="162,929,219,956"/>
<area shape="rect" id="node34" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="168,980,213,1007"/>
<area shape="rect" id="node35" href="foo_8h.html#ac5e9ac55fb4bf0dbb108c006f509b32b" title="randvcos" alt="" coords="159,1031,222,1057"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1103,549,1160,576"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="733,549,807,576"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="855,549,944,576"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="877,499,921,525"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1004,600,1043,627"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="992,549,1055,576"/>
<area shape="rect" id="node11" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="479,144,526,171"/>
<area shape="rect" id="node12" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="309,144,371,171"/>
<area shape="rect" id="node13" href="cdf_8c.html#ab79e837935267ae9f6061620404f000e" title="get a random number for a cdf inside limits set by cdf_limit. " alt="" coords="288,499,392,525"/>
<area shape="rect" id="node16" href="bb_8c.html#a6bae7f74815dfcf783a7dafade8faeca" title="obtains a random number between x1 and x2 for a power law densiity distribution with index alpha ..." alt="" coords="297,195,383,221"/>
<area shape="rect" id="node17" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="286,676,394,703"/>
<area shape="rect" id="node20" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="613,1031,681,1057"/>
<area shape="rect" id="node24" href="cdf_8c.html#aecb77ca29971f4b21ea483ab1672e652" title="sets limit1 and limit2 so that one can generate distributions from a limited range within a previousl..." alt="" coords="473,575,532,601"/>
<area shape="rect" id="node25" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="315,448,365,475"/>
<area shape="rect" id="node26" href="bb_8c.html#af2d9c9e4094a425824f269ef22163048" title="obtain a random number between alpha_min and alpha_max from an distribution of the form e**&#45;alpha ..." alt="" coords="299,245,381,272"/>
<area shape="rect" id="node14" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="469,473,537,500"/>
<area shape="rect" id="node18" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="469,980,536,1007"/>
<area shape="rect" id="node21" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="444,625,561,652"/>
<area shape="rect" id="node23" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="453,828,553,855"/>
<area shape="rect" id="node19" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="628,828,667,855"/>
<area shape="rect" id="node22" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="609,499,685,525"/>
<area shape="rect" id="node28" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="478,777,527,804"/>
<area shape="rect" id="node29" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="315,879,365,905"/>
<area shape="rect" id="node30" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="284,980,396,1007"/>
<area shape="rect" id="node31" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="300,549,380,576"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_icgraph.png" border="0" usemap="#photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_icgraph" alt=""/></div>
<map name="photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_icgraph" id="photon__gen_8c_a19e1b27b1fe040ccadcd39a5783c4d60_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="145,5,221,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="269,5,344,32"/>
</map>
</div>

</div>
</div>
<a id="a663f46d36d6962c7993e4c002442c23b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a663f46d36d6962c7993e4c002442c23b">&#9670;&nbsp;</a></span>photon_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int photon_checks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>comment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform some simple checks on the photon distribution just produced. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p The photon structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmin The minimum fequency that was used to generate the photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmax The maximum fequency that was used to generate the photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>* comment A comment that accompanies this particular call </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine checks photons to see if they are "reasonable". The checks mostly have to do with the frequency of the photons. The program will exit is too many photons fail the checks</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000046">Bug:</a></b></dt><dd>The routine also a few numbers that summarize some aspects of the the distribution. Some of these have to do with the Ferland definition of IP, which we are discussing deleting</dd></dl>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l01286">1286</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_cgraph.png" border="0" usemap="#photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_cgraph" alt=""/></div>
<map name="photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_cgraph" id="photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa" title="Print/write to a file a special message for debugging. " alt="" coords="369,5,421,32"/>
<area shape="rect" id="node4" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="143,132,219,159"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="267,183,311,209"/>
<area shape="rect" id="node11" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="505,259,544,285"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="728,107,785,133"/>
<area shape="rect" id="node5" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="267,132,311,159"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="359,132,432,159"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="480,132,569,159"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="629,107,668,133"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="617,157,680,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_icgraph.png" border="0" usemap="#photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_icgraph" alt=""/></div>
<map name="photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_icgraph" id="photon__gen_8c_a663f46d36d6962c7993e4c002442c23b_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="143,5,252,32"/>
</map>
</div>

</div>
</div>
<a id="addfbba966a4d69bdc71b771e0d7f3cdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addfbba966a4d69bdc71b771e0d7f3cdf">&#9670;&nbsp;</a></span>populate_bands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double populate_bands </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ioniz_or_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iwind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structxbands.html">xbands</a> *&#160;</td>
          <td class="paramname"><em>band</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine how many photons to allocate to each band. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 A minimum frequency (NOT USED) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 A maximum frequency (NOT USED) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ioniz_or_final indicate whether this is for an ioniz_or_final </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iwind indicates where wind photons are created </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td>xbands * band is a pointer to the band sturctue where everythin is </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ftot which is the sum of the band limited luminosities</dd></dl>
<p>This routine determines how many photons to allocate to each band. Inputs determine a minimum fraction to allocate to each band, but these need not sum to 1, and so the rest of the photons are allocated naturally (that is to say) by the luminosities within the bands.</p>
<p>Much of the actual work is carried out in xdefine_phot.</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000044">Bug:</a></b></dt><dd>f1 and f2 do not appear to be used and should be removed from the call.</dd></dl>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00188">188</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_cgraph.png" border="0" usemap="#photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_cgraph" alt=""/></div>
<map name="photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_cgraph" id="photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_cgraph">
<area shape="rect" id="node2" href="photon__gen_8c.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="147,754,225,781"/>
<area shape="rect" id="node3" href="photon__gen_8c.html#a0bc15d347d507f21da65e37f659de349" title="(r, tstar, freqmin, freqmax, ioniz_or_final, f) " alt="" coords="303,349,360,376"/>
<area shape="rect" id="node19" href="photon__gen_8c.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="302,526,361,553"/>
<area shape="rect" id="node26" href="photon__gen_8c.html#afb47deaf80a8f3a6f07ab91d843d960e" title="calculate parameters need to intialize the boundary layer (namely the band&#45;liminted luminoisity) ..." alt="" coords="307,45,355,72"/>
<area shape="rect" id="node27" href="agn_8c.html#ab6c8e4e9577a9edb71a9a5900d43964c" title="Calculates the total luminosity of an AGN type source. " alt="" coords="303,222,360,249"/>
<area shape="rect" id="node30" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="637,653,675,680"/>
<area shape="rect" id="node32" href="emission_8c.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="285,805,377,832"/>
<area shape="rect" id="node50" href="foo_8h.html#ac8797bce5a5f3411f4162dff928b7920" title="returns the specific band&#45;limited luminosity in macro&#45;atoms " alt="" coords="291,856,371,882"/>
<area shape="rect" id="node51" href="foo_8h.html#ab250057e4381b5be827dcf4cd35fb3fe" title="returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k&#45;packet &#45;&gt; r&#45;packet in the required wavelength range. " alt="" coords="297,906,365,933"/>
<area shape="rect" id="node52" href="foo_8h.html#a5fc061a271cdb55a6e05db67fafd504c" title="a routine which reports the matom level and kpkt emissivities summed over all cells. It is called in define_phot() in the spectral cycles, after get_matom_f() " alt="" coords="273,957,389,984"/>
<area shape="rect" id="node4" href="bb_8c.html#a337db7e010442d30f7c4b45f3e41fa5c" title="Calculate the emittance of a bb between freqmin and freqmax. " alt="" coords="455,146,537,173"/>
<area shape="rect" id="node10" href="continuum_8c.html#a9d1648c5fc65c0c98f2cdf51dfaee558" title="get the surface flux for Hubeny/Kurucz like stellar models " alt="" coords="437,349,555,376"/>
<area shape="rect" id="node5" href="bb_8c.html#af5c48487242ab8760a1893e385d3e11b" title="Obtains the integral of the dimensionless blackbody function between alphamin and alphamax..." alt="" coords="611,45,701,72"/>
<area shape="rect" id="node7" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="921,146,984,173"/>
<area shape="rect" id="node9" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="927,45,978,72"/>
<area shape="rect" id="node6" href="bb_8c.html#aa67b840e2ff05fc474799c42178b392e" title="calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in a..." alt="" coords="757,45,865,72"/>
<area shape="rect" id="node8" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="1061,222,1108,249"/>
<area shape="rect" id="node11" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="631,400,681,426"/>
<area shape="rect" id="node12" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="789,400,833,426"/>
<area shape="rect" id="node13" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1288,577,1345,604"/>
<area shape="rect" id="node14" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="916,552,989,578"/>
<area shape="rect" id="node15" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1040,501,1129,528"/>
<area shape="rect" id="node18" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1063,552,1107,578"/>
<area shape="rect" id="node16" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1189,501,1228,528"/>
<area shape="rect" id="node17" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1177,450,1240,477"/>
<area shape="rect" id="node20" href="disk_8c.html#a3440890f45c87b4c79fef37820f87487" title="Calculate the temperature of the disk at a normalised distance x. " alt="" coords="637,450,675,477"/>
<area shape="rect" id="node21" href="disk_8c.html#adc2a482ce6c550cd7e5498bf0ee1055b" title="Calculate the reference temperarure for a standard Shakura&#45;Sunyaeev disk. " alt="" coords="475,501,517,528"/>
<area shape="rect" id="node22" href="disk_8c.html#aa4eb3da682e26e1705216d977de95a0a" title="Calculate the effective gravity at a specfic position in the disk. " alt="" coords="477,602,515,629"/>
<area shape="rect" id="node23" href="disk_8c.html#a2d9e855352fbd6de6a7ed1cd79ac4a64" title="Calculate a reference gravity for the disk. " alt="" coords="473,653,519,680"/>
<area shape="rect" id="node24" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="1051,704,1119,730"/>
<area shape="rect" id="node25" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="775,552,848,578"/>
<area shape="rect" id="node28" href="agn_8c.html#ab172924888b8579c4acdd737732edce1" title="The luminosity of a power law over a frerquency range. " alt="" coords="611,248,701,274"/>
<area shape="rect" id="node29" href="agn_8c.html#a9bd7eb064b17d9b352e044d5e417a649" title="Works out the luminosity of a broken power law. " alt="" coords="449,298,543,325"/>
<area shape="rect" id="node31" href="brem_8c.html#aaf2a9843cc170d6b01b75a1704f8c4fb" title="The integrand used in qromb to compute the luminosity of a bremstrahlung source. " alt="" coords="460,96,532,122"/>
<area shape="rect" id="node33" href="foo_8h.html#a0018131577a59a5142e3677785504d37" title="Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines..." alt="" coords="464,856,528,882"/>
<area shape="rect" id="node34" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="453,805,539,832"/>
<area shape="rect" id="node35" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="608,805,704,832"/>
<area shape="rect" id="node40" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="629,754,683,781"/>
<area shape="rect" id="node41" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="609,957,703,984"/>
<area shape="rect" id="node47" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="624,1084,688,1110"/>
<area shape="rect" id="node49" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="603,856,709,882"/>
<area shape="rect" id="node36" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="785,754,838,781"/>
<area shape="rect" id="node38" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="776,856,847,882"/>
<area shape="rect" id="node39" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="780,805,843,832"/>
<area shape="rect" id="node37" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="913,754,992,781"/>
<area shape="rect" id="node42" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="792,957,831,984"/>
<area shape="rect" id="node43" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="765,1008,857,1034"/>
<area shape="rect" id="node44" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="792,1058,831,1085"/>
<area shape="rect" id="node45" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="792,1109,831,1136"/>
<area shape="rect" id="node46" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="779,906,844,933"/>
<area shape="rect" id="node48" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="782,1160,841,1186"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_icgraph.png" border="0" usemap="#photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_icgraph" alt=""/></div>
<map name="photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_icgraph" id="photon__gen_8c_addfbba966a4d69bdc71b771e0d7f3cdf_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="147,5,221,32"/>
</map>
</div>

</div>
</div>
<a id="a0bc15d347d507f21da65e37f659de349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bc15d347d507f21da65e37f659de349">&#9670;&nbsp;</a></span>star_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int star_init </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ioniz_or_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(r, tstar, freqmin, freqmax, ioniz_or_final, f) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmin The minimum freqency for the band </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmax The maximum freqency for the band </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">[in</td><td>out] int ioniz_or_final A flag indicating whether this is for an ionization cycle or a detailed spectrum cycle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* f The baand limited luminosity of the star </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This routine calculates the luminosity of the star and the luminosity within the frequency boundaries.</p>
<h3>Notes</h3>
<p>The routine allows for backscattering of light onto the star assuming the user has opted to include this in the determination of the effective temperature of the star </p>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00648">648</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a0bc15d347d507f21da65e37f659de349_cgraph.png" border="0" usemap="#photon__gen_8c_a0bc15d347d507f21da65e37f659de349_cgraph" alt=""/></div>
<map name="photon__gen_8c_a0bc15d347d507f21da65e37f659de349_cgraph" id="photon__gen_8c_a0bc15d347d507f21da65e37f659de349_cgraph">
<area shape="rect" id="node2" href="bb_8c.html#a337db7e010442d30f7c4b45f3e41fa5c" title="Calculate the emittance of a bb between freqmin and freqmax. " alt="" coords="128,103,211,129"/>
<area shape="rect" id="node8" href="continuum_8c.html#a9d1648c5fc65c0c98f2cdf51dfaee558" title="get the surface flux for Hubeny/Kurucz like stellar models " alt="" coords="111,179,228,205"/>
<area shape="rect" id="node3" href="bb_8c.html#af5c48487242ab8760a1893e385d3e11b" title="Obtains the integral of the dimensionless blackbody function between alphamin and alphamax..." alt="" coords="276,77,365,104"/>
<area shape="rect" id="node5" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="575,29,637,56"/>
<area shape="rect" id="node7" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="581,81,631,108"/>
<area shape="rect" id="node4" href="bb_8c.html#aa67b840e2ff05fc474799c42178b392e" title="calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in a..." alt="" coords="413,77,521,104"/>
<area shape="rect" id="node6" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="712,29,759,56"/>
<area shape="rect" id="node9" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="296,179,345,205"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="445,204,489,231"/>
<area shape="rect" id="node11" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="939,165,996,192"/>
<area shape="rect" id="node12" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="569,141,643,168"/>
<area shape="rect" id="node13" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="691,160,780,187"/>
<area shape="rect" id="node16" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="713,109,757,136"/>
<area shape="rect" id="node14" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="840,165,879,192"/>
<area shape="rect" id="node15" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="828,115,891,141"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a0bc15d347d507f21da65e37f659de349_icgraph.png" border="0" usemap="#photon__gen_8c_a0bc15d347d507f21da65e37f659de349_icgraph" alt=""/></div>
<map name="photon__gen_8c_a0bc15d347d507f21da65e37f659de349_icgraph" id="photon__gen_8c_a0bc15d347d507f21da65e37f659de349_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="111,5,189,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="379,5,453,32"/>
<area shape="rect" id="node4" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="237,31,331,57"/>
</map>
</div>

</div>
</div>
<a id="a9a0acf2d461c665dc0302defa95ded65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0acf2d461c665dc0302defa95ded65">&#9670;&nbsp;</a></span>xdefine_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int xdefine_phot </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ioniz_or_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iwind</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by reinitializing the disk, among other things). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum freqeuncy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ioniz_or_final 0 -&gt; this is for the wind ionization calculation; 1-&gt; it is for the final spectrum calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iwind if 0, include wind photons; if 1 include wind photons and force a recalcuation of ion denisities, if -1, ignore the possibility of wind photons </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This is a routine that initilizes things. It does not generate photons itself.</p>
<p>The routine calls various other routines to calcuate the band limited luminosities of various radiation sources (which is used in allocating how many photons to create from each). The results are stored in elements of the geo structure.</p>
<h3>Notes</h3>
<p>Note: This routine is something of a kluge. Information is passed back to the calling routine through the geo structure, rather than a more obvious method. The routine was created when a banded approach was defined, but the whole section might be more obvious. </p>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00286">286</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_cgraph.png" border="0" usemap="#photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_cgraph" alt=""/></div>
<map name="photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_cgraph" id="photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_cgraph">
<area shape="rect" id="node2" href="photon__gen_8c.html#a0bc15d347d507f21da65e37f659de349" title="(r, tstar, freqmin, freqmax, ioniz_or_final, f) " alt="" coords="161,349,219,376"/>
<area shape="rect" id="node18" href="photon__gen_8c.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="161,526,219,553"/>
<area shape="rect" id="node25" href="photon__gen_8c.html#afb47deaf80a8f3a6f07ab91d843d960e" title="calculate parameters need to intialize the boundary layer (namely the band&#45;liminted luminoisity) ..." alt="" coords="166,45,214,72"/>
<area shape="rect" id="node26" href="agn_8c.html#ab6c8e4e9577a9edb71a9a5900d43964c" title="Calculates the total luminosity of an AGN type source. " alt="" coords="161,222,219,249"/>
<area shape="rect" id="node29" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="495,653,534,680"/>
<area shape="rect" id="node31" href="emission_8c.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="144,805,236,832"/>
<area shape="rect" id="node49" href="foo_8h.html#ac8797bce5a5f3411f4162dff928b7920" title="returns the specific band&#45;limited luminosity in macro&#45;atoms " alt="" coords="150,856,230,882"/>
<area shape="rect" id="node50" href="foo_8h.html#ab250057e4381b5be827dcf4cd35fb3fe" title="returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k&#45;packet &#45;&gt; r&#45;packet in the required wavelength range. " alt="" coords="156,906,224,933"/>
<area shape="rect" id="node51" href="foo_8h.html#a5fc061a271cdb55a6e05db67fafd504c" title="a routine which reports the matom level and kpkt emissivities summed over all cells. It is called in define_phot() in the spectral cycles, after get_matom_f() " alt="" coords="132,957,248,984"/>
<area shape="rect" id="node3" href="bb_8c.html#a337db7e010442d30f7c4b45f3e41fa5c" title="Calculate the emittance of a bb between freqmin and freqmax. " alt="" coords="313,146,396,173"/>
<area shape="rect" id="node9" href="continuum_8c.html#a9d1648c5fc65c0c98f2cdf51dfaee558" title="get the surface flux for Hubeny/Kurucz like stellar models " alt="" coords="296,349,413,376"/>
<area shape="rect" id="node4" href="bb_8c.html#af5c48487242ab8760a1893e385d3e11b" title="Obtains the integral of the dimensionless blackbody function between alphamin and alphamax..." alt="" coords="470,45,559,72"/>
<area shape="rect" id="node6" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="780,146,843,173"/>
<area shape="rect" id="node8" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="786,45,837,72"/>
<area shape="rect" id="node5" href="bb_8c.html#aa67b840e2ff05fc474799c42178b392e" title="calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in a..." alt="" coords="616,45,724,72"/>
<area shape="rect" id="node7" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="920,222,967,249"/>
<area shape="rect" id="node10" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="490,400,539,426"/>
<area shape="rect" id="node11" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="648,400,692,426"/>
<area shape="rect" id="node12" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1147,577,1204,604"/>
<area shape="rect" id="node13" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="775,552,848,578"/>
<area shape="rect" id="node14" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="899,501,988,528"/>
<area shape="rect" id="node17" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="921,552,965,578"/>
<area shape="rect" id="node15" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1048,501,1087,528"/>
<area shape="rect" id="node16" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1036,450,1099,477"/>
<area shape="rect" id="node19" href="disk_8c.html#a3440890f45c87b4c79fef37820f87487" title="Calculate the temperature of the disk at a normalised distance x. " alt="" coords="495,450,534,477"/>
<area shape="rect" id="node20" href="disk_8c.html#adc2a482ce6c550cd7e5498bf0ee1055b" title="Calculate the reference temperarure for a standard Shakura&#45;Sunyaeev disk. " alt="" coords="333,501,376,528"/>
<area shape="rect" id="node21" href="disk_8c.html#aa4eb3da682e26e1705216d977de95a0a" title="Calculate the effective gravity at a specfic position in the disk. " alt="" coords="335,602,374,629"/>
<area shape="rect" id="node22" href="disk_8c.html#a2d9e855352fbd6de6a7ed1cd79ac4a64" title="Calculate a reference gravity for the disk. " alt="" coords="332,653,377,680"/>
<area shape="rect" id="node23" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="909,704,977,730"/>
<area shape="rect" id="node24" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="633,552,707,578"/>
<area shape="rect" id="node27" href="agn_8c.html#ab172924888b8579c4acdd737732edce1" title="The luminosity of a power law over a frerquency range. " alt="" coords="470,248,559,274"/>
<area shape="rect" id="node28" href="agn_8c.html#a9bd7eb064b17d9b352e044d5e417a649" title="Works out the luminosity of a broken power law. " alt="" coords="307,298,402,325"/>
<area shape="rect" id="node30" href="brem_8c.html#aaf2a9843cc170d6b01b75a1704f8c4fb" title="The integrand used in qromb to compute the luminosity of a bremstrahlung source. " alt="" coords="319,96,391,122"/>
<area shape="rect" id="node32" href="foo_8h.html#a0018131577a59a5142e3677785504d37" title="Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines..." alt="" coords="323,856,387,882"/>
<area shape="rect" id="node33" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="312,805,397,832"/>
<area shape="rect" id="node34" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="467,805,563,832"/>
<area shape="rect" id="node39" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="487,754,542,781"/>
<area shape="rect" id="node40" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="467,957,562,984"/>
<area shape="rect" id="node46" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="483,1084,547,1110"/>
<area shape="rect" id="node48" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="461,856,568,882"/>
<area shape="rect" id="node35" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="643,754,697,781"/>
<area shape="rect" id="node37" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="635,856,705,882"/>
<area shape="rect" id="node38" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="639,805,701,832"/>
<area shape="rect" id="node36" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="772,754,851,781"/>
<area shape="rect" id="node41" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="651,957,689,984"/>
<area shape="rect" id="node42" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="624,1008,716,1034"/>
<area shape="rect" id="node43" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="651,1058,689,1085"/>
<area shape="rect" id="node44" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="651,1109,689,1136"/>
<area shape="rect" id="node45" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="637,906,703,933"/>
<area shape="rect" id="node47" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="641,1160,699,1186"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_icgraph.png" border="0" usemap="#photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_icgraph" alt=""/></div>
<map name="photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_icgraph" id="photon__gen_8c_a9a0acf2d461c665dc0302defa95ded65_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="273,5,348,32"/>
<area shape="rect" id="node3" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="132,31,225,57"/>
</map>
</div>

</div>
</div>
<a id="ab7f1c9362f29a0b44f41cff21494b6df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f1c9362f29a0b44f41cff21494b6df">&#9670;&nbsp;</a></span>xmake_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int xmake_phot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ioniz_or_final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iwind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iphot_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nphotons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>just makes photons </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">PhotPtr</td><td>p The entire photon structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency for generating photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency for generating photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ioniz_or_final A flag indicating whether this if for an ionization or detailed spectral cycle (Used to determine what underlying spectrum, e.g bb or detailed models) to sample </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iwind A flag indicating whether or not to genrate any wind photons. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>weight The weight of photons to generate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>iphot_start The position in the photon structure to start storing photons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nphotons The number of photons to generate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>make_phot controls the actual generation of photons. All of the initializations should have been done previously (xdefine_phot). xmake_phot cycles throght the various possible sources of the wind, including for example, the disk, the central object, and the wind, and creates photons for each, using the ratio of the band limited luminosites to the total band limited luminosity to determine how many photons to select from each source.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00422">422</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_cgraph.png" border="0" usemap="#photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_cgraph" alt=""/></div>
<map name="photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_cgraph" id="photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="981,600,1020,627"/>
<area shape="rect" id="node4" href="photon__gen_8c.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="308,1031,400,1057"/>
<area shape="rect" id="node5" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="979,1208,1023,1235"/>
<area shape="rect" id="node37" href="emission_8c.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="134,1487,230,1513"/>
<area shape="rect" id="node64" href="photon__gen_8c.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="308,1132,400,1159"/>
<area shape="rect" id="node67" href="agn_8c.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="308,853,400,880"/>
<area shape="rect" id="node70" href="foo_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="135,2728,229,2755"/>
<area shape="rect" id="node71" href="foo_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="129,2779,235,2805"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1456,777,1513,804"/>
<area shape="rect" id="node11" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="497,701,565,728"/>
<area shape="rect" id="node12" href="bb_8c.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="506,803,557,829"/>
<area shape="rect" id="node17" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="808,1157,904,1184"/>
<area shape="rect" id="node28" href="continuum_8c.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="486,1107,577,1133"/>
<area shape="rect" id="node33" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="495,1208,568,1235"/>
<area shape="rect" id="node34" href="foo_8h.html#a1881a8f6279e1472e741aab3ee654383" title="randvec" alt="" coords="503,1309,560,1336"/>
<area shape="rect" id="node35" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="509,904,554,931"/>
<area shape="rect" id="node36" href="foo_8h.html#ac5e9ac55fb4bf0dbb108c006f509b32b" title="randvcos" alt="" coords="500,1005,563,1032"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="1087,1208,1160,1235"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1208,929,1297,956"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1231,1208,1275,1235"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1357,929,1396,956"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1345,879,1408,905"/>
<area shape="rect" id="node13" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="833,271,879,297"/>
<area shape="rect" id="node14" href="bb_8c.html#ad6196c3c4ec0bdeda06aa797af259d81" title="The value of the dimensioless BB function at alpha. " alt="" coords="662,448,725,475"/>
<area shape="rect" id="node15" href="cdf_8c.html#ab79e837935267ae9f6061620404f000e" title="get a random number for a cdf inside limits set by cdf_limit. " alt="" coords="641,955,745,981"/>
<area shape="rect" id="node18" href="bb_8c.html#a6bae7f74815dfcf783a7dafade8faeca" title="obtains a random number between x1 and x2 for a power law densiity distribution with index alpha ..." alt="" coords="651,296,736,323"/>
<area shape="rect" id="node19" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="639,752,747,779"/>
<area shape="rect" id="node21" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="967,499,1035,525"/>
<area shape="rect" id="node25" href="cdf_8c.html#aecb77ca29971f4b21ea483ab1672e652" title="sets limit1 and limit2 so that one can generate distributions from a limited range within a previousl..." alt="" coords="664,701,723,728"/>
<area shape="rect" id="node26" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="668,347,719,373"/>
<area shape="rect" id="node27" href="bb_8c.html#af2d9c9e4094a425824f269ef22163048" title="obtain a random number between alpha_min and alpha_max from an distribution of the form e**&#45;alpha ..." alt="" coords="652,853,735,880"/>
<area shape="rect" id="node16" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="822,1563,890,1589"/>
<area shape="rect" id="node20" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="823,600,889,627"/>
<area shape="rect" id="node22" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="797,853,915,880"/>
<area shape="rect" id="node24" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="806,803,906,829"/>
<area shape="rect" id="node23" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="963,2044,1039,2071"/>
<area shape="rect" id="node29" href="get__models_8c.html#a17cbe892d03676c0123c4b578d6534d0" title="interpolates between spectra in a grid placing the results in comp[spectype].xmod ..." alt="" coords="831,1335,881,1361"/>
<area shape="rect" id="node30" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="669,1664,718,1691"/>
<area shape="rect" id="node31" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="637,600,749,627"/>
<area shape="rect" id="node32" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="653,1563,733,1589"/>
<area shape="rect" id="node38" href="emission_8c.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="507,1664,556,1691"/>
<area shape="rect" id="node41" href="foo_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="328,1309,380,1336"/>
<area shape="rect" id="node42" href="emission_8c.html#a8a9a281cba993682e32c78c93f264f35" title="gets the frequency of a single collisionally excited line photon in a particular cell of the wind..." alt="" coords="663,1512,723,1539"/>
<area shape="rect" id="node43" href="foo_8h.html#a55dba11eab85fa51b5bbf621a3c66b57" title="get_random_location" alt="" coords="296,1360,412,1387"/>
<area shape="rect" id="node44" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="323,2044,385,2071"/>
<area shape="rect" id="node57" href="anisowind_8c.html#a5cc282e1f3d56ce0f29cb080bc225408" title="is the routine which chooses a new anisotropic direction in geo.scatter_mode = SCATTER_MODE_THERMAL ..." alt="" coords="283,2399,425,2425"/>
<area shape="rect" id="node60" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="320,1512,388,1539"/>
<area shape="rect" id="node61" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="512,1360,551,1387"/>
<area shape="rect" id="node62" href="foo_8h.html#a176ee6debad2930212ca97a2d28794c0" title="Generates path for a wind photon. " alt="" coords="294,1563,414,1589"/>
<area shape="rect" id="node63" href="foo_8h.html#a7719923b66bf470bc4eeb42c454ebd48" title="Generates path for a &#39;wind&#39; photon in photon mode. " alt="" coords="290,1664,418,1691"/>
<area shape="rect" id="node39" href="emission_8c.html#ade7eab896d4188a5b8a4ed6845d33150" title="calculate f_nu for ff emisssion " alt="" coords="674,1816,713,1843"/>
<area shape="rect" id="node40" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="827,1816,885,1843"/>
<area shape="rect" id="node45" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="512,1512,551,1539"/>
<area shape="rect" id="node46" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="489,1968,574,1995"/>
<area shape="rect" id="node47" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="503,2475,559,2501"/>
<area shape="rect" id="node48" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="667,2120,719,2147"/>
<area shape="rect" id="node49" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="475,2373,587,2400"/>
<area shape="rect" id="node51" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="499,2019,564,2045"/>
<area shape="rect" id="node52" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="473,2069,589,2096"/>
<area shape="rect" id="node53" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="671,2019,716,2045"/>
<area shape="rect" id="node54" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="669,2069,718,2096"/>
<area shape="rect" id="node55" href="foo_8h.html#ab0b1a9d790b71c94f9562c567eeee268" title="create_basis" alt="" coords="492,2221,571,2248"/>
<area shape="rect" id="node56" href="foo_8h.html#a5672a43b959d7e6d398852cbc41ee6b1" title="project_from" alt="" coords="493,1917,570,1944"/>
<area shape="rect" id="node50" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="822,2272,890,2299"/>
<area shape="rect" id="node58" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="476,2627,587,2653"/>
<area shape="rect" id="node59" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="497,2576,566,2603"/>
<area shape="rect" id="node65" href="disk_8c.html#a29076b6a07403d62872baf4dc9bf9346" title="Calculate the speed and velocity v at which material given specific position in the disk..." alt="" coords="509,1867,554,1893"/>
<area shape="rect" id="node66" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="667,1968,720,1995"/>
<area shape="rect" id="node68" href="brem_8c.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="487,752,576,779"/>
<area shape="rect" id="node69" href="brem_8c.html#ab308d8424a5b2ab066577630b7150e7b" title="The integrand for integrating a dimensionless bremstrahlung spectrum. " alt="" coords="665,195,721,221"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_icgraph.png" border="0" usemap="#photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_icgraph" alt=""/></div>
<map name="photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_icgraph" id="photon__gen_8c_ab7f1c9362f29a0b44f41cff21494b6df_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="129,5,204,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab21ea56600a6e1eb09e89816449e09f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab21ea56600a6e1eb09e89816449e09f9">&#9670;&nbsp;</a></span>f1_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double f1_old = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00024">24</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>

</div>
</div>
<a id="a40d422c86ec453018368d16aa7c079cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d422c86ec453018368d16aa7c079cd">&#9670;&nbsp;</a></span>f2_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double f2_old = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00025">25</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>

</div>
</div>
<a id="aa454ec9a17879579643258a3855270c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa454ec9a17879579643258a3855270c3">&#9670;&nbsp;</a></span>iwind_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iwind_old = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="photon__gen_8c_source.html#l00026">26</a> of file <a class="el" href="photon__gen_8c_source.html">photon_gen.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="photon__gen_8c.html">photon_gen.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
