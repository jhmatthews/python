<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/disk.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('disk_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">disk.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Various routines related setting up the disk and calculating when a photon encounters the disk surface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for disk.c:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2disk_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2disk_8c" id="_2_users_2mhewitt_2python_2source_2disk_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="disk_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adc2a482ce6c550cd7e5498bf0ee1055b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#adc2a482ce6c550cd7e5498bf0ee1055b">tdisk</a> (double m, double mdot, double <a class="el" href="import__spherical_8c.html#a83175ac8fd9d924ff2bce40c99e88870">r</a>)</td></tr>
<tr class="memdesc:adc2a482ce6c550cd7e5498bf0ee1055b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the reference temperarure for a standard Shakura-Sunyaeev disk.  <a href="#adc2a482ce6c550cd7e5498bf0ee1055b">More...</a><br /></td></tr>
<tr class="separator:adc2a482ce6c550cd7e5498bf0ee1055b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3440890f45c87b4c79fef37820f87487"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a3440890f45c87b4c79fef37820f87487">teff</a> (double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, double <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:a3440890f45c87b4c79fef37820f87487"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the temperature of the disk at a normalised distance x.  <a href="#a3440890f45c87b4c79fef37820f87487">More...</a><br /></td></tr>
<tr class="separator:a3440890f45c87b4c79fef37820f87487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d9e855352fbd6de6a7ed1cd79ac4a64"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a2d9e855352fbd6de6a7ed1cd79ac4a64">gdisk</a> (double mass, double mdot, double rmin)</td></tr>
<tr class="memdesc:a2d9e855352fbd6de6a7ed1cd79ac4a64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a reference gravity for the disk.  <a href="#a2d9e855352fbd6de6a7ed1cd79ac4a64">More...</a><br /></td></tr>
<tr class="separator:a2d9e855352fbd6de6a7ed1cd79ac4a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4eb3da682e26e1705216d977de95a0a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#aa4eb3da682e26e1705216d977de95a0a">geff</a> (double g0, double <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:aa4eb3da682e26e1705216d977de95a0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the effective gravity at a specfic position in the disk.  <a href="#aa4eb3da682e26e1705216d977de95a0a">More...</a><br /></td></tr>
<tr class="separator:aa4eb3da682e26e1705216d977de95a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29076b6a07403d62872baf4dc9bf9346"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a29076b6a07403d62872baf4dc9bf9346">vdisk</a> (<a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, <a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>)</td></tr>
<tr class="memdesc:a29076b6a07403d62872baf4dc9bf9346"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the speed and velocity v at which material given specific position in the disk.  <a href="#a29076b6a07403d62872baf4dc9bf9346">More...</a><br /></td></tr>
<tr class="separator:a29076b6a07403d62872baf4dc9bf9346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4027a82b7c3df9474704080c8b3137cc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc">zdisk</a> (double <a class="el" href="import__spherical_8c.html#a83175ac8fd9d924ff2bce40c99e88870">r</a>)</td></tr>
<tr class="memdesc:a4027a82b7c3df9474704080c8b3137cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the height of the disk at a certain radius.  <a href="#a4027a82b7c3df9474704080c8b3137cc">More...</a><br /></td></tr>
<tr class="separator:a4027a82b7c3df9474704080c8b3137cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afff91fbd2e4ab430bad432ecb529a28a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#afff91fbd2e4ab430bad432ecb529a28a">ds_to_disk</a> (struct <a class="el" href="structphoton.html">photon</a> *p, int allow_negative)</td></tr>
<tr class="memdesc:afff91fbd2e4ab430bad432ecb529a28a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the distance that a photon would need to travel from its current position to hit disk.  <a href="#afff91fbd2e4ab430bad432ecb529a28a">More...</a><br /></td></tr>
<tr class="separator:afff91fbd2e4ab430bad432ecb529a28a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625372b64e082ea4b46de6f8be0e385f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a625372b64e082ea4b46de6f8be0e385f">disk_deriv</a> (double s, double *value, double *derivative)</td></tr>
<tr class="memdesc:a625372b64e082ea4b46de6f8be0e385f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the change in disk height as s function of s.  <a href="#a625372b64e082ea4b46de6f8be0e385f">More...</a><br /></td></tr>
<tr class="separator:a625372b64e082ea4b46de6f8be0e385f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6a40a92905dcccfe3f17bb046182bc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a8c6a40a92905dcccfe3f17bb046182bc">qdisk_init</a> ()</td></tr>
<tr class="memdesc:a8c6a40a92905dcccfe3f17bb046182bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a structure (qdisk) for recording information about photons/energy impinging on the disk, which is stored in a disk structure called qdisk.  <a href="#a8c6a40a92905dcccfe3f17bb046182bc">More...</a><br /></td></tr>
<tr class="separator:a8c6a40a92905dcccfe3f17bb046182bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c88d034953bdd81d94f7b4834f455cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a7c88d034953bdd81d94f7b4834f455cb">qdisk_save</a> (char *diskfile, double ztot)</td></tr>
<tr class="memdesc:a7c88d034953bdd81d94f7b4834f455cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the information in the qdisk structure to a file.  <a href="#a7c88d034953bdd81d94f7b4834f455cb">More...</a><br /></td></tr>
<tr class="separator:a7c88d034953bdd81d94f7b4834f455cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5d5c91372291204ba0255184ce1f87"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#ada5d5c91372291204ba0255184ce1f87">read_non_standard_disk_profile</a> (char *tprofile)</td></tr>
<tr class="memdesc:ada5d5c91372291204ba0255184ce1f87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the temperature profile from a file.  <a href="#ada5d5c91372291204ba0255184ce1f87">More...</a><br /></td></tr>
<tr class="separator:ada5d5c91372291204ba0255184ce1f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afaba31659717b807b58fa7b80c4847a1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#afaba31659717b807b58fa7b80c4847a1">north</a> [] = { 0.0, 0.0, 1.0 }</td></tr>
<tr class="separator:afaba31659717b807b58fa7b80c4847a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb53135f3a02cc9e70a2cb6efd14d935"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#afb53135f3a02cc9e70a2cb6efd14d935">ds_to_disk_init</a> = 0</td></tr>
<tr class="separator:afb53135f3a02cc9e70a2cb6efd14d935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad63152416eeae502d325c1b83ab88d0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structphoton.html">photon</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#aad63152416eeae502d325c1b83ab88d0">ds_to_disk_photon</a></td></tr>
<tr class="separator:aad63152416eeae502d325c1b83ab88d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e6fe84d8cd3c84f810c729edfb8f4ac"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structplane.html">plane</a> diskplane disktop&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="disk_8c.html#a9e6fe84d8cd3c84f810c729edfb8f4ac">diskbottom</a></td></tr>
<tr class="separator:a9e6fe84d8cd3c84f810c729edfb8f4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Various routines related setting up the disk and calculating when a photon encounters the disk surface. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a625372b64e082ea4b46de6f8be0e385f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a625372b64e082ea4b46de6f8be0e385f">&#9670;&nbsp;</a></span>disk_deriv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void disk_deriv </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>derivative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the change in disk height as s function of s. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>s A distance along the path of a photon </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* value the disk height at s </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* derivative the derivative of the disk heith at s </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>N/A</dd></dl>
<p>Used in ds_to_disk by rtsafe as part of the procedure to locate the place a photon hits a vertically extended disk</p>
<h3>Notes</h3>
<p>The function we are trying to zero is the difference between the height of the disk and the z height of the photon. </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00630">630</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a625372b64e082ea4b46de6f8be0e385f_cgraph.png" border="0" usemap="#disk_8c_a625372b64e082ea4b46de6f8be0e385f_cgraph" alt=""/></div>
<map name="disk_8c_a625372b64e082ea4b46de6f8be0e385f_cgraph" id="disk_8c_a625372b64e082ea4b46de6f8be0e385f_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="123,5,189,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="120,56,192,83"/>
<area shape="rect" id="node4" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="133,107,179,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a625372b64e082ea4b46de6f8be0e385f_icgraph.png" border="0" usemap="#disk_8c_a625372b64e082ea4b46de6f8be0e385f_icgraph" alt=""/></div>
<map name="disk_8c_a625372b64e082ea4b46de6f8be0e385f_icgraph" id="disk_8c_a625372b64e082ea4b46de6f8be0e385f_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#afff91fbd2e4ab430bad432ecb529a28a" title="Calculates the distance that a photon would need to travel from its current position to hit disk..." alt="" coords="120,132,189,159"/>
<area shape="rect" id="node3" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="251,5,323,32"/>
<area shape="rect" id="node4" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="389,31,441,57"/>
<area shape="rect" id="node5" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="237,107,337,133"/>
<area shape="rect" id="node7" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="265,157,309,184"/>
<area shape="rect" id="node8" href="sv_8c.html#a2e62e3c36e76963e8e9f69b82329d447" title="Calulate the v of a Schlossman Vitello wind at a position x. " alt="" coords="252,208,323,235"/>
<area shape="rect" id="node9" href="sv_8c.html#abde80034508a0a977d22a060696a8b7e" title="Calculate the density of an sv_wind at a position x. " alt="" coords="389,233,441,260"/>
<area shape="rect" id="node6" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="385,107,445,133"/>
</map>
</div>

</div>
</div>
<a id="afff91fbd2e4ab430bad432ecb529a28a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afff91fbd2e4ab430bad432ecb529a28a">&#9670;&nbsp;</a></span>ds_to_disk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_disk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structphoton.html">photon</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allow_negative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the distance that a photon would need to travel from its current position to hit disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">struct</td><td>photon * p a photon pointer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>allow_negative permits a negative number to be returned in certain circumstances </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The distance to the disk.</dd></dl>
<p>Usually, ds_to_disk returns the distance along the line of sight to the disk in the direction a photon is currently travelling.</p>
<p>Usually, if the photon misses the disk going in the positive direction, a very large number is returned.</p>
<p>If allow_negative is non-zero (true), then ds_to_disk returns a negative distance if it has not hit the disk going in the positive direction.</p>
<p>The routine allows both for a flat disk, and a vertically extended disk</p>
<h3>Notes</h3>
<p>The need to allow for negative distances arises because several of the parameterization for the wind (SV, KWD) depend on the distance between the current position and footpoint along a streamline. (It is not clear that this was a good approach, but that is the rationale)</p>
<p>Generally, there should not be an issue with this, though one can imagine that one might get into trouble for a very flared (bowl-shaped) disk.</p>
<p>Significant portions of the routine were rewritten in 1802 by ksl to better handle flared disks. </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00370">370</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_afff91fbd2e4ab430bad432ecb529a28a_cgraph.png" border="0" usemap="#disk_8c_afff91fbd2e4ab430bad432ecb529a28a_cgraph" alt=""/></div>
<map name="disk_8c_afff91fbd2e4ab430bad432ecb529a28a_cgraph" id="disk_8c_afff91fbd2e4ab430bad432ecb529a28a_cgraph">
<area shape="rect" id="node2" href="disk_8c.html#a625372b64e082ea4b46de6f8be0e385f" title="Calculate the change in disk height as s function of s. " alt="" coords="131,56,197,83"/>
<area shape="rect" id="node3" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="257,5,322,32"/>
<area shape="rect" id="node4" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="253,107,325,133"/>
<area shape="rect" id="node6" href="foo_8h.html#ae443765b508c1d69ac5249ef9de2bb81" title="calculates the distance of a photon must travel to hit the plane. " alt="" coords="126,157,202,184"/>
<area shape="rect" id="node7" href="foo_8h.html#a67e3cb7a7d0cd3d55277fc4f3373fe2e" title="Calculate the pathlenth along a line of sight defined by a photon p to a sphere centered on the origi..." alt="" coords="123,208,205,235"/>
<area shape="rect" id="node8" href="foo_8h.html#aabcf91dd6a4e633b1beb48978f9a71c1" title="A routine that mimimizes a function f. " alt="" coords="141,259,187,285"/>
<area shape="rect" id="node5" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="267,56,312,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_afff91fbd2e4ab430bad432ecb529a28a_icgraph.png" border="0" usemap="#disk_8c_afff91fbd2e4ab430bad432ecb529a28a_icgraph" alt=""/></div>
<map name="disk_8c_afff91fbd2e4ab430bad432ecb529a28a_icgraph" id="disk_8c_afff91fbd2e4ab430bad432ecb529a28a_icgraph">
<area shape="rect" id="node2" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="137,5,209,32"/>
<area shape="rect" id="node3" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="275,31,327,57"/>
<area shape="rect" id="node4" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="123,107,223,133"/>
<area shape="rect" id="node6" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="151,157,195,184"/>
<area shape="rect" id="node7" href="sv_8c.html#a2e62e3c36e76963e8e9f69b82329d447" title="Calulate the v of a Schlossman Vitello wind at a position x. " alt="" coords="137,208,208,235"/>
<area shape="rect" id="node8" href="sv_8c.html#abde80034508a0a977d22a060696a8b7e" title="Calculate the density of an sv_wind at a position x. " alt="" coords="275,233,327,260"/>
<area shape="rect" id="node5" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="271,107,331,133"/>
</map>
</div>

</div>
</div>
<a id="a2d9e855352fbd6de6a7ed1cd79ac4a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d9e855352fbd6de6a7ed1cd79ac4a64">&#9670;&nbsp;</a></span>gdisk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gdisk </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mdot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rmin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a reference gravity for the disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>mass Mass of the central object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>mdot Mass accretion rate of the disk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>rmin Minimum radius for the disk </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A fiducial gravity for the disk</dd></dl>
<p>The gravity is needed when one constructs a disk spectrum from spectra from a grid of stellar atmospheres</p>
<p>The input units are all cgs</p>
<h3>Notes</h3>
<p>See Long &amp; Knigge for details </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00189">189</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64_icgraph.png" border="0" usemap="#disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64_icgraph" alt=""/></div>
<map name="disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64_icgraph" id="disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="99,5,157,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="205,5,284,32"/>
<area shape="rect" id="node4" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="473,5,548,32"/>
<area shape="rect" id="node5" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="332,31,425,57"/>
</map>
</div>

</div>
</div>
<a id="aa4eb3da682e26e1705216d977de95a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4eb3da682e26e1705216d977de95a0a">&#9670;&nbsp;</a></span>geff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double geff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the effective gravity at a specfic position in the disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>g0 reference gravity in cm s**-2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x distance from center in units of r/rmin </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>gravity at x in cm s**-2</dd></dl>
<p>The gravity is needed when one constructs a disk spectrum from spectra from a grid of stellar atmospheres</p>
<h3>Notes</h3>
<p>See Long &amp; Knigge for details </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00220">220</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_aa4eb3da682e26e1705216d977de95a0a_icgraph.png" border="0" usemap="#disk_8c_aa4eb3da682e26e1705216d977de95a0a_icgraph" alt=""/></div>
<map name="disk_8c_aa4eb3da682e26e1705216d977de95a0a_icgraph" id="disk_8c_aa4eb3da682e26e1705216d977de95a0a_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="92,5,151,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="199,5,277,32"/>
<area shape="rect" id="node4" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="467,5,541,32"/>
<area shape="rect" id="node5" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="325,31,419,57"/>
</map>
</div>

</div>
</div>
<a id="a8c6a40a92905dcccfe3f17bb046182bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6a40a92905dcccfe3f17bb046182bc">&#9670;&nbsp;</a></span>qdisk_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qdisk_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a structure (qdisk) for recording information about photons/energy impinging on the disk, which is stored in a disk structure called qdisk. </p>
<dl class="section return"><dt>Returns</dt><dd>Always return zero</dd></dl>
<h3>Notes</h3>
<p>The information stored in qdisk can be used to modify the effective temperature of the disk</p>
<p>The reason the qdisk is needed as well as disk structure is that whenever the wavelength bands are changed the radii in the disk structure are recalibratied. We want qdisk to have fixed boundaries when this happens. </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00681">681</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a8c6a40a92905dcccfe3f17bb046182bc_icgraph.png" border="0" usemap="#disk_8c_a8c6a40a92905dcccfe3f17bb046182bc_icgraph" alt=""/></div>
<map name="disk_8c_a8c6a40a92905dcccfe3f17bb046182bc_icgraph" id="disk_8c_a8c6a40a92905dcccfe3f17bb046182bc_icgraph">
<area shape="rect" id="node2" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="117,5,161,32"/>
</map>
</div>

</div>
</div>
<a id="a7c88d034953bdd81d94f7b4834f455cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c88d034953bdd81d94f7b4834f455cb">&#9670;&nbsp;</a></span>qdisk_save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qdisk_save </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>diskfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ztot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the information in the qdisk structure to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>* diskfile Name of the file whihc is writteen </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>ztot The total luminosity of the disk as calculate over multiple cycles </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine reformats the data about disk heating which has been accumulated and writes it to a file</p>
<h3>Notes</h3>
<p>The data concerning heating by the disk is built up during a the ionization cycles</p>
<p>The file that is produced should be readable as an astropy table </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00724">724</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a7c88d034953bdd81d94f7b4834f455cb_cgraph.png" border="0" usemap="#disk_8c_a7c88d034953bdd81d94f7b4834f455cb_cgraph" alt=""/></div>
<map name="disk_8c_a7c88d034953bdd81d94f7b4834f455cb_cgraph" id="disk_8c_a7c88d034953bdd81d94f7b4834f455cb_cgraph">
<area shape="rect" id="node2" href="disk_8c.html#a4027a82b7c3df9474704080c8b3137cc" title="Calculate the height of the disk at a certain radius. " alt="" coords="125,5,171,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a7c88d034953bdd81d94f7b4834f455cb_icgraph.png" border="0" usemap="#disk_8c_a7c88d034953bdd81d94f7b4834f455cb_icgraph" alt=""/></div>
<map name="disk_8c_a7c88d034953bdd81d94f7b4834f455cb_icgraph" id="disk_8c_a7c88d034953bdd81d94f7b4834f455cb_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="125,5,235,32"/>
</map>
</div>

</div>
</div>
<a id="ada5d5c91372291204ba0255184ce1f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada5d5c91372291204ba0255184ce1f87">&#9670;&nbsp;</a></span>read_non_standard_disk_profile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_non_standard_disk_profile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>tprofile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the temperature profile from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">char</td><td>* tprofile Name of the input file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The input format for the file to be read in is quite spefic The first line should contina the number of points n the profile</p>
<p>Subsequent lines should contian a radius and a temperarue</p>
<p>The radius values shoule be in units of 1e11 cm The temperature should be in units of 1000K</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000020">Bug:</a></b></dt><dd>This routine which was written for the YSO study needs to be made less YSO centric. It should also be retested.</dd></dl>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00795">795</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_ada5d5c91372291204ba0255184ce1f87_cgraph.png" border="0" usemap="#disk_8c_ada5d5c91372291204ba0255184ce1f87_cgraph" alt=""/></div>
<map name="disk_8c_ada5d5c91372291204ba0255184ce1f87_cgraph" id="disk_8c_ada5d5c91372291204ba0255184ce1f87_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="185,25,229,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="647,25,704,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="277,51,351,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="399,37,488,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="421,88,465,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="548,25,587,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="536,76,599,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_ada5d5c91372291204ba0255184ce1f87_icgraph.png" border="0" usemap="#disk_8c_ada5d5c91372291204ba0255184ce1f87_icgraph" alt=""/></div>
<map name="disk_8c_ada5d5c91372291204ba0255184ce1f87_icgraph" id="disk_8c_ada5d5c91372291204ba0255184ce1f87_icgraph">
<area shape="rect" id="node2" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="185,13,229,39"/>
</map>
</div>

</div>
</div>
<a id="adc2a482ce6c550cd7e5498bf0ee1055b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc2a482ce6c550cd7e5498bf0ee1055b">&#9670;&nbsp;</a></span>tdisk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tdisk </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mdot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the reference temperarure for a standard Shakura-Sunyaeev disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>m mass of the central object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>mdot mass accretion rate of the disk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>r radiis of the central object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The reference temperature for the disk</dd></dl>
<p>All of the inputs are in cgs units</p>
<h3>Notes</h3>
<p>For an SS disk, The maximum temperature actuallly seen in the disk is 0.488 tdisk </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00041">41</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b_icgraph.png" border="0" usemap="#disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b_icgraph" alt=""/></div>
<map name="disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b_icgraph" id="disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a3513a64162c15d3d3d101c3d5ea2367f" title="This is the routine that initializes the bands. " alt="" coords="125,31,193,57"/>
<area shape="rect" id="node4" href="templates_8h.html#a62c27981e9cc187028480ec2752923d3" title="Calculate the sound speed (launch speed) of the wind at r. " alt="" coords="127,107,190,133"/>
<area shape="rect" id="node7" href="templates_8h.html#a28ecd56d18384623466c728d74cee061" title="Calculate rho at the base of the wind. " alt="" coords="299,157,376,184"/>
<area shape="rect" id="node8" href="templates_8h.html#ab4a7a07fd07176e2d8723e16fd7b619d" title="the integrand of KWD model for mdot as a function of radius " alt="" coords="96,208,221,235"/>
<area shape="rect" id="node10" href="templates_8h.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="129,259,188,285"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="315,5,359,32"/>
<area shape="rect" id="node5" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="301,56,373,83"/>
<area shape="rect" id="node6" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="474,107,526,133"/>
<area shape="rect" id="node9" href="templates_8h.html#abc35742eeeb50cc9cda997c3de567f20" title="get the input data that is necessary to define KWD&#45;type model description of the wind ..." alt="" coords="269,208,405,235"/>
<area shape="rect" id="node11" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="298,259,377,285"/>
<area shape="rect" id="node12" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="595,259,669,285"/>
<area shape="rect" id="node13" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="453,284,547,311"/>
</map>
</div>

</div>
</div>
<a id="a3440890f45c87b4c79fef37820f87487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3440890f45c87b4c79fef37820f87487">&#9670;&nbsp;</a></span>teff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double teff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the temperature of the disk at a normalised distance x. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t reference temperature of the disk in degrees </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x distance from center of disk in units of r/rmin </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The temperature</dd></dl>
<p>The routine returns the effective temperature for the disk as a distance which is measured in terms of the ratio of the actual distance to the inner edge of the disk (rmin).</p>
<p>A number of modifications to a simple steady state disk are possible, depending on the variable geo.disk_tprofile:</p>
<ul>
<li>DISK_TPROFILE_READIN the returned temperature is interpolated from values that been read in</li>
<li>DISK_TPROFILE_YSO an analytic profile implemented for YSOs</li>
</ul>
<p>In addition for a standard profile, this is where disk heading can optionally be taken into account</p>
<h3>Notes</h3>
<p>A reference for the standard steady state disk is Wade, 1984 MNRAS 208, 381 </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00083">83</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a3440890f45c87b4c79fef37820f87487_cgraph.png" border="0" usemap="#disk_8c_a3440890f45c87b4c79fef37820f87487_cgraph" alt=""/></div>
<map name="disk_8c_a3440890f45c87b4c79fef37820f87487_cgraph" id="disk_8c_a3440890f45c87b4c79fef37820f87487_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="92,25,136,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="553,25,611,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="184,51,257,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="305,37,395,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="328,88,372,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="455,25,493,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="443,76,505,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a3440890f45c87b4c79fef37820f87487_icgraph.png" border="0" usemap="#disk_8c_a3440890f45c87b4c79fef37820f87487_icgraph" alt=""/></div>
<map name="disk_8c_a3440890f45c87b4c79fef37820f87487_icgraph" id="disk_8c_a3440890f45c87b4c79fef37820f87487_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a62c27981e9cc187028480ec2752923d3" title="Calculate the sound speed (launch speed) of the wind at r. " alt="" coords="123,56,186,83"/>
<area shape="rect" id="node5" href="templates_8h.html#a28ecd56d18384623466c728d74cee061" title="Calculate rho at the base of the wind. " alt="" coords="295,107,372,133"/>
<area shape="rect" id="node6" href="templates_8h.html#ab4a7a07fd07176e2d8723e16fd7b619d" title="the integrand of KWD model for mdot as a function of radius " alt="" coords="92,157,217,184"/>
<area shape="rect" id="node8" href="templates_8h.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020" title="calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk..." alt="" coords="125,208,184,235"/>
<area shape="rect" id="node3" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="297,5,369,32"/>
<area shape="rect" id="node4" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="470,56,522,83"/>
<area shape="rect" id="node7" href="templates_8h.html#abc35742eeeb50cc9cda997c3de567f20" title="get the input data that is necessary to define KWD&#45;type model description of the wind ..." alt="" coords="265,157,401,184"/>
<area shape="rect" id="node9" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="294,208,373,235"/>
<area shape="rect" id="node10" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="591,208,665,235"/>
<area shape="rect" id="node11" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="449,233,543,260"/>
</map>
</div>

</div>
</div>
<a id="a29076b6a07403d62872baf4dc9bf9346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29076b6a07403d62872baf4dc9bf9346">&#9670;&nbsp;</a></span>vdisk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double vdisk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the speed and velocity v at which material given specific position in the disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] A position in the disk </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>v[] The velocity at that position </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The speed</dd></dl>
<p>This routine interpolates the velocities from a grid which gives the run of velocity with radius. Although the we generally assume keplerian velocities for the disk those velocities are not calculated here.</p>
<h3>Notes</h3>
<p>The routine projects the input variable x on to the xy plane before it calculates velocities</p>
<p>It then takes the xproduct of a unit vector pointing north and the position, to determine the direction of motion at this point in the disk</p>
<p>Finally it rescales this to get the actual velocity. </p>

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00266">266</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a29076b6a07403d62872baf4dc9bf9346_cgraph.png" border="0" usemap="#disk_8c_a29076b6a07403d62872baf4dc9bf9346_cgraph" alt=""/></div>
<map name="disk_8c_a29076b6a07403d62872baf4dc9bf9346_cgraph" id="disk_8c_a29076b6a07403d62872baf4dc9bf9346_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="99,5,151,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="101,56,150,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="101,107,150,133"/>
<area shape="rect" id="node5" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="103,157,148,184"/>
<area shape="rect" id="node6" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="99,208,152,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a29076b6a07403d62872baf4dc9bf9346_icgraph.png" border="0" usemap="#disk_8c_a29076b6a07403d62872baf4dc9bf9346_icgraph" alt=""/></div>
<map name="disk_8c_a29076b6a07403d62872baf4dc9bf9346_icgraph" id="disk_8c_a29076b6a07403d62872baf4dc9bf9346_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="119,56,171,83"/>
<area shape="rect" id="node7" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="99,107,191,133"/>
<area shape="rect" id="node3" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="391,31,460,57"/>
<area shape="rect" id="node6" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="239,56,340,83"/>
<area shape="rect" id="node4" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="511,5,620,32"/>
<area shape="rect" id="node5" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="523,56,608,83"/>
<area shape="rect" id="node8" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="251,107,327,133"/>
<area shape="rect" id="node9" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="388,107,463,133"/>
</map>
</div>

</div>
</div>
<a id="a4027a82b7c3df9474704080c8b3137cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4027a82b7c3df9474704080c8b3137cc">&#9670;&nbsp;</a></span>zdisk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double zdisk </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the height of the disk at a certain radius. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>r a radial position in the disk. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The vertical height of the disk at that point in the xy plane.</dd></dl>
<p>If the disk is vertically extended then the disk surface is defined in terms of the h the fraction of the disk radius at the edge of the disk, and a power law exponent. So a disk thst us a sunoke wedgge wiykd gave an exponent of 1. A flat but thick disk would have an exponent of 0. A flared disk wouuld generally have an exponent greater than 1.</p>
<h3>Notes</h3>
<pre class="fragment">zdisk returns a number that will positive or zero, so one
often needs to take this account if for example one has
a photon that hits the disk below the z=0 plane.</pre> 
<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00311">311</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="disk_8c_a4027a82b7c3df9474704080c8b3137cc_icgraph.png" border="0" usemap="#disk_8c_a4027a82b7c3df9474704080c8b3137cc_icgraph" alt=""/></div>
<map name="disk_8c_a4027a82b7c3df9474704080c8b3137cc_icgraph" id="disk_8c_a4027a82b7c3df9474704080c8b3137cc_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="121,335,213,361"/>
<area shape="rect" id="node5" href="templates_8h.html#a95a5dd7b17dd91fc7d21b44ee290d256" title="defines the cells in a cylindrical grid when the disk is vertically extended. " alt="" coords="117,100,217,127"/>
<area shape="rect" id="node8" href="templates_8h.html#a625372b64e082ea4b46de6f8be0e385f" title="Calculate the change in disk height as s function of s. " alt="" coords="133,183,200,209"/>
<area shape="rect" id="node14" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="468,309,512,336"/>
<area shape="rect" id="node17" href="templates_8h.html#a7c88d034953bdd81d94f7b4834f455cb" title="Save the information in the qdisk structure to a file. " alt="" coords="131,284,203,311"/>
<area shape="rect" id="node19" href="templates_8h.html#abc35742eeeb50cc9cda997c3de567f20" title="get the input data that is necessary to define KWD&#45;type model description of the wind ..." alt="" coords="99,385,235,412"/>
<area shape="rect" id="node20" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="121,436,213,463"/>
<area shape="rect" id="node21" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="121,487,213,513"/>
<area shape="rect" id="node22" href="wind_8c.html#a5f63dccb9b43b11cc312ab51e4d0d0ac" title="determines whether a position x is in a wind region. " alt="" coords="122,537,211,564"/>
<area shape="rect" id="node23" href="yso_8c.html#aae3509585172ef791e8112e146a86f46" title="gets input data that are necessary for a YSO comprising a region that resembles a KWD wind and a regi..." alt="" coords="105,588,228,615"/>
<area shape="rect" id="node3" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="299,436,375,463"/>
<area shape="rect" id="node4" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="453,436,527,463"/>
<area shape="rect" id="node6" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="299,69,375,96"/>
<area shape="rect" id="node7" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="468,5,512,32"/>
<area shape="rect" id="node9" href="templates_8h.html#afff91fbd2e4ab430bad432ecb529a28a" title="Calculates the distance that a photon would need to travel from its current position to hit disk..." alt="" coords="303,183,372,209"/>
<area shape="rect" id="node10" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="454,208,526,235"/>
<area shape="rect" id="node11" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="592,233,644,260"/>
<area shape="rect" id="node12" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="440,56,540,83"/>
<area shape="rect" id="node15" href="sv_8c.html#a2e62e3c36e76963e8e9f69b82329d447" title="Calulate the v of a Schlossman Vitello wind at a position x. " alt="" coords="455,107,525,133"/>
<area shape="rect" id="node16" href="sv_8c.html#abde80034508a0a977d22a060696a8b7e" title="Calculate the density of an sv_wind at a position x. " alt="" coords="592,132,644,159"/>
<area shape="rect" id="node13" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="588,56,648,83"/>
<area shape="rect" id="node18" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="283,284,392,311"/>
<area shape="rect" id="node24" href="templates_8h.html#a156f40c5dd5b2c76f1002d05f712b0a0" title="Get detailed particular component of the wind. " alt="" coords="287,588,388,615"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9e6fe84d8cd3c84f810c729edfb8f4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e6fe84d8cd3c84f810c729edfb8f4ac">&#9670;&nbsp;</a></span>diskbottom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structplane.html">plane</a> diskplane disktop diskbottom</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00323">323</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>

</div>
</div>
<a id="afb53135f3a02cc9e70a2cb6efd14d935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb53135f3a02cc9e70a2cb6efd14d935">&#9670;&nbsp;</a></span>ds_to_disk_init</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ds_to_disk_init = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00321">321</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>

</div>
</div>
<a id="aad63152416eeae502d325c1b83ab88d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad63152416eeae502d325c1b83ab88d0">&#9670;&nbsp;</a></span>ds_to_disk_photon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structphoton.html">photon</a> ds_to_disk_photon</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00322">322</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>

</div>
</div>
<a id="afaba31659717b807b58fa7b80c4847a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaba31659717b807b58fa7b80c4847a1">&#9670;&nbsp;</a></span>north</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double north[] = { 0.0, 0.0, 1.0 }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="disk_8c_source.html#l00231">231</a> of file <a class="el" href="disk_8c_source.html">disk.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="disk_8c.html">disk.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
