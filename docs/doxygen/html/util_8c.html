<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/util.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('util_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">util.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>These are very simple utilities within Python that do not fall into a larger catergory like those in vector.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util.c:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2util_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2util_8c" id="_2_users_2mhewitt_2python_2source_2util_8c">
<area shape="rect" id="node5" href="log_8h.html" title="log.h" alt="" coords="228,169,272,196"/>
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="288,95,348,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="372,95,432,121"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="296,169,359,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="383,169,456,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="480,169,543,196"/>
</map>
</div>
</div>
<p><a href="util_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adb5b0074d608e468f0d9a9f8493d4154"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#adb5b0074d608e468f0d9a9f8493d4154">fraction</a> (double value, array, int npts, int *ival, double *f, int mode)</td></tr>
<tr class="memdesc:adb5b0074d608e468f0d9a9f8493d4154"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform linear/logarithmic interpolation of an array.  <a href="#adb5b0074d608e468f0d9a9f8493d4154">More...</a><br /></td></tr>
<tr class="separator:adb5b0074d608e468f0d9a9f8493d4154"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fac68a4c0528ac8613fcaf975ddfd58"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#a1fac68a4c0528ac8613fcaf975ddfd58">linterp</a> (double <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, xarray, yarray, int xdim, double *y, int mode)</td></tr>
<tr class="memdesc:a1fac68a4c0528ac8613fcaf975ddfd58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a linear interpolation on two parallel arrays, the fist of which contains a set of values to be interpolated and the second of which has the function at those values.  <a href="#a1fac68a4c0528ac8613fcaf975ddfd58">More...</a><br /></td></tr>
<tr class="separator:a1fac68a4c0528ac8613fcaf975ddfd58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58278ee8209899477833e9415625667b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#a58278ee8209899477833e9415625667b">coord_fraction</a> (int ndom, int ichoice, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, ii, frac, int *nelem)</td></tr>
<tr class="memdesc:a58278ee8209899477833e9415625667b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the fractional contributions in interpolations of values of quantities, such as electron density, by various cells in the grid in a coordinate system independent way.  <a href="#a58278ee8209899477833e9415625667b">More...</a><br /></td></tr>
<tr class="separator:a58278ee8209899477833e9415625667b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e07bac9d1bcabdcca0c8f77e164309"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#ad7e07bac9d1bcabdcca0c8f77e164309">where_in_2dcell</a> (int ichoice, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, int n, double *fx, double *fz)</td></tr>
<tr class="memdesc:ad7e07bac9d1bcabdcca0c8f77e164309"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the fractional location of a position in any 2d grid.  <a href="#ad7e07bac9d1bcabdcca0c8f77e164309">More...</a><br /></td></tr>
<tr class="separator:ad7e07bac9d1bcabdcca0c8f77e164309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed64e9379499a741e8a7c42376e20530"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a> (int ndom, int n, int *<a class="el" href="import__rtheta_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>, int *<a class="el" href="import__rtheta_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>)</td></tr>
<tr class="memdesc:aed64e9379499a741e8a7c42376e20530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate a cell number in the wind to the two-d grid position in a specific domain.  <a href="#aed64e9379499a741e8a7c42376e20530">More...</a><br /></td></tr>
<tr class="separator:aed64e9379499a741e8a7c42376e20530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a172ddeb06a81951700723a0b02d90557"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#a172ddeb06a81951700723a0b02d90557">wind_ij_to_n</a> (int ndom, int <a class="el" href="import__rtheta_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>, int <a class="el" href="import__rtheta_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>, int *n)</td></tr>
<tr class="memdesc:a172ddeb06a81951700723a0b02d90557"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate from the 2d element for an individual domain to the wind element number.  <a href="#a172ddeb06a81951700723a0b02d90557">More...</a><br /></td></tr>
<tr class="separator:a172ddeb06a81951700723a0b02d90557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2938cb78e3414274491d2d778843db3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#ad2938cb78e3414274491d2d778843db3">wind_x_to_n</a> (double <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[], int *n)</td></tr>
<tr class="memdesc:ad2938cb78e3414274491d2d778843db3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the wind domain element number from a postion.  <a href="#ad2938cb78e3414274491d2d778843db3">More...</a><br /></td></tr>
<tr class="separator:ad2938cb78e3414274491d2d778843db3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8c064433c3cb416cc54ca16016f1f580"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#a8c064433c3cb416cc54ca16016f1f580">ierr_coord_fraction</a> = 0</td></tr>
<tr class="separator:a8c064433c3cb416cc54ca16016f1f580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f0c8239c80e4ad569d9c18782b6f5cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8c.html#a0f0c8239c80e4ad569d9c18782b6f5cc">ierr_where_in_2dcell</a> = 0</td></tr>
<tr class="separator:a0f0c8239c80e4ad569d9c18782b6f5cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>These are very simple utilities within Python that do not fall into a larger catergory like those in vector. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April, 2018</dd></dl>
<h3>Notes</h3>
<p>These routines should probably be refactored into other routines</p>
<p>It may be useful to rethink them in addition, as they were all written prior to the existence of domains, and domains are just grafted on. </p>

<p class="definition">Definition in file <a class="el" href="util_8c_source.html">util.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a58278ee8209899477833e9415625667b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58278ee8209899477833e9415625667b">&#9670;&nbsp;</a></span>coord_fraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int coord_fraction </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ichoice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ii&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">frac&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the fractional contributions in interpolations of values of quantities, such as electron density, by various cells in the grid in a coordinate system independent way. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain in where the interpolation will take place </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ichoice interpolate on vertices (0), interpolate on centers (1)&gt; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] the 3-vector position for which you want the fractinal position </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>ii[] an array that contains the 1-d element numbers that must be summed </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>frac[] the array that contains the fractional contribution of the corresponding element </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* nelem the number of elements that must be summed, nominally 2 for a spherical grid and 4 for a two dimensional grid. (For a 3 d grid it would be 6, but we have not implemented this.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if inside the grid -2 if outside the grid -1 if inside the grid</dd></dl>
<h3>Notes</h3>
<p>There are numerous times when one wants the value of an interpoalted variable in the wind. There is no easy way to interpolate the variable easily. What this routine does is calculate the fractional contributions of elements in the array to that position. Then one must sum up the actual variable else where</p>
<p>If positions are outside the grid, coord_fraction attempts to give you the value at the edge of the grid.</p>
<p>It's possible that coord_fraction could be used to interpolate beyond the edge of the grid where a variable is defined, although this is not done at present! </p>

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00277">277</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_a58278ee8209899477833e9415625667b_cgraph.png" border="0" usemap="#util_8c_a58278ee8209899477833e9415625667b_cgraph" alt=""/></div>
<map name="util_8c_a58278ee8209899477833e9415625667b_cgraph" id="util_8c_a58278ee8209899477833e9415625667b_cgraph">
<area shape="rect" id="node2" href="cylind__var_8c.html#a3185dc024d7c8bf77fe0be0dc128a272" title="calculate the fractional position of a position in the 2d grid in a coordinate for modified cylindric..." alt="" coords="139,109,256,136"/>
<area shape="rect" id="node7" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="493,173,537,200"/>
<area shape="rect" id="node14" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="324,21,400,48"/>
<area shape="rect" id="node15" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="173,275,222,301"/>
<area shape="rect" id="node16" href="util_8c.html#adb5b0074d608e468f0d9a9f8493d4154" title="Perform linear/logarithmic interpolation of an array. " alt="" coords="335,173,389,200"/>
<area shape="rect" id="node3" href="cylind__var_8c.html#a32c03e10ad1712cb98a72b444cca5499" title="locates the grid position of the vector, when one is using modified cylindrical coordinates, with the z heights varying. " alt="" coords="304,72,420,99"/>
<area shape="rect" id="node4" href="foo_8h.html#af8c5f231035fc1a85000b9849b4fb0ed" title="fraction" alt="" coords="488,123,543,149"/>
<area shape="rect" id="node5" href="foo_8h.html#a172ddeb06a81951700723a0b02d90557" title="Translate from the 2d element for an individual domain to the wind element number. " alt="" coords="477,21,554,48"/>
<area shape="rect" id="node6" href="foo_8h.html#a829a331b30311e6768f4cc16a70fdab5" title="where_in_2dcell" alt="" coords="468,72,563,99"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="980,123,1037,149"/>
<area shape="rect" id="node9" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="611,47,684,73"/>
<area shape="rect" id="node10" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="732,72,821,99"/>
<area shape="rect" id="node13" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="755,21,799,48"/>
<area shape="rect" id="node11" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="881,123,920,149"/>
<area shape="rect" id="node12" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="869,72,932,99"/>
</map>
</div>

</div>
</div>
<a id="adb5b0074d608e468f0d9a9f8493d4154"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb5b0074d608e468f0d9a9f8493d4154">&#9670;&nbsp;</a></span>fraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fraction </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ival</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform linear/logarithmic interpolation of an array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>value The value used for interpoaltion </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>array[] An array containing a set of asceding values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>npts The size of the array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* ival The lower index to use in the interpolation of the array which need to be used to interpolate on </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* f The fraction of the upper point to use in the interpolation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A switch to choose linear(0) or lograrithmic(1) interpolation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Usually returns 0, but returns -1 if the input value is less than the first elememnt in the array, and 1 if it is greater than the last element int he array. In either of these cases, the fractions are set up only to access one array element</dd></dl>
<p>Typically one has two parallel arrays, one containing a set of values, in the original case frequencies, and another containing some function of those values. This routine finds the fraction of the function at two point in the data array to interpolate.</p>
<p>The values for the input array can be interpolated linear or logarithmically. that is the fraction that is returned are based on the values in the array or the logarithm of them.</p>
<p>The routine uses bisection</p>
<h3>Notes</h3>
<p>fraction is a utility written to speed up the search for the bracketing topbase photionization x-sections, but in principle it should work in other situations within python (which at one time at least contributed significantly to the runtime for Python).</p>
<p>Today, fraction is called directly in the routines that are used to set up coordinate systems, and indirectly through linterp (below) which should be inspected to see how the logarithmic interpolation is supposed to work.</p>
<p>The routine is similar to the numerical * recipes routine locate. There may be a gsl routine as well. The routine should probably be replaced. </p>

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00087">87</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_adb5b0074d608e468f0d9a9f8493d4154_cgraph.png" border="0" usemap="#util_8c_adb5b0074d608e468f0d9a9f8493d4154_cgraph" alt=""/></div>
<map name="util_8c_adb5b0074d608e468f0d9a9f8493d4154_cgraph" id="util_8c_adb5b0074d608e468f0d9a9f8493d4154_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="108,25,152,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="569,25,627,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="200,51,273,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="321,37,411,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="344,88,388,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="471,25,509,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="459,76,521,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_adb5b0074d608e468f0d9a9f8493d4154_icgraph.png" border="0" usemap="#util_8c_adb5b0074d608e468f0d9a9f8493d4154_icgraph" alt=""/></div>
<map name="util_8c_adb5b0074d608e468f0d9a9f8493d4154_icgraph" id="util_8c_adb5b0074d608e468f0d9a9f8493d4154_icgraph">
<area shape="rect" id="node2" href="util_8c.html#a1fac68a4c0528ac8613fcaf975ddfd58" title="Perform a linear interpolation on two parallel arrays, the fist of which contains a set of values to ..." alt="" coords="126,5,175,32"/>
<area shape="rect" id="node3" href="util_8c.html#a58278ee8209899477833e9415625667b" title="calculate the fractional contributions in interpolations of values of quantities, such as electron de..." alt="" coords="108,56,193,83"/>
</map>
</div>

</div>
</div>
<a id="a1fac68a4c0528ac8613fcaf975ddfd58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fac68a4c0528ac8613fcaf975ddfd58">&#9670;&nbsp;</a></span>linterp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int linterp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">xarray&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">yarray&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a linear interpolation on two parallel arrays, the fist of which contains a set of values to be interpolated and the second of which has the function at those values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x A value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>xarray[] The array that is interplated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>yarray[] The array that contains a function of the values in xaray </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>xdim The length of the two arrays </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* y The resulting intepolated value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A switch to choose linear(0) or "logarithmic" (1) interpolation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of the array element that is used for the lower of the two elements taht are intepolated on.</dd></dl>
<p>Given a number x, and an array of x's in xarray, and functional values y = f(x) in yarray and the dimension of xarray and yarray, linterp calculates y, the linearly interpolated value of y(x). It also returns the element in the xarray so that one can consider not doing a search to find the right array element in certain circumstances</p>
<h3>Notes</h3>
<p>For mode 0, the value that is retuned is</p>
<p>(1-f)*y[nelem]+f*[nelem+1)</p>
<p>For mode 1, the value returned is exp ((1. - f) * log (y[nelem]) + f * log (y[nelem + 1])) </p>

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00194">194</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_a1fac68a4c0528ac8613fcaf975ddfd58_cgraph.png" border="0" usemap="#util_8c_a1fac68a4c0528ac8613fcaf975ddfd58_cgraph" alt=""/></div>
<map name="util_8c_a1fac68a4c0528ac8613fcaf975ddfd58_cgraph" id="util_8c_a1fac68a4c0528ac8613fcaf975ddfd58_cgraph">
<area shape="rect" id="node2" href="util_8c.html#adb5b0074d608e468f0d9a9f8493d4154" title="Perform linear/logarithmic interpolation of an array. " alt="" coords="103,24,157,50"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="205,49,249,76"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="667,24,724,50"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="297,74,371,101"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="419,49,508,76"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="441,100,485,126"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="568,24,607,50"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="556,74,619,101"/>
</map>
</div>

</div>
</div>
<a id="ad7e07bac9d1bcabdcca0c8f77e164309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e07bac9d1bcabdcca0c8f77e164309">&#9670;&nbsp;</a></span>where_in_2dcell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int where_in_2dcell </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ichoice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the fractional location of a position in any 2d grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ichoice interpolate on vertices (0) or centers (1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] the 3-vector position for which you want the fractinal position </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>n The cell number in wmain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* fx Fractional position in the x (1st) direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* fz fracitionl postion in the z (2nd) direction </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the positiion is within the cell as defined, non-zero otherwise</dd></dl>
<p>The routine provides the fractions need to interpopolate variables, such as ne, in the wind. It is called when one already knows what cell one is in. Like many other routines one can intepolate using the boundaries of the wind cell for values which are defined there (like velocity), and values defined at the cell centeres (like densities)</p>
<h3>Notes</h3>
<p>This routine is general. It does not rely on the predefined arrays that just contain the grid vertices and centers. On the other hand, it does not calculate which grid cell x lies in. It only tells you that x is not in a particular cell if that is the case.</p>
<p>A cell is organized as follows:</p>
<ul>
<li>x01 x11</li>
<li>x00 x10</li>
</ul>
<p>This routine was written to account for cylind_var coordiantes </p>

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00443">443</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_ad7e07bac9d1bcabdcca0c8f77e164309_cgraph.png" border="0" usemap="#util_8c_ad7e07bac9d1bcabdcca0c8f77e164309_cgraph" alt=""/></div>
<map name="util_8c_ad7e07bac9d1bcabdcca0c8f77e164309_cgraph" id="util_8c_ad7e07bac9d1bcabdcca0c8f77e164309_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="248,26,292,52"/>
<area shape="rect" id="node9" href="bilinear_8c.html#a0d7059db01a063789ca5b78386eb2889" title="calculates the fractional position in the coordinate grid of a 2d vector x. " alt="" coords="148,76,188,103"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="721,26,779,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="352,76,425,103"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="473,51,563,78"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="496,102,540,128"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="623,26,661,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="611,76,673,103"/>
<area shape="rect" id="node10" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="236,76,304,103"/>
</map>
</div>

</div>
</div>
<a id="a172ddeb06a81951700723a0b02d90557"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a172ddeb06a81951700723a0b02d90557">&#9670;&nbsp;</a></span>wind_ij_to_n()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wind_ij_to_n </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Translate from the 2d element for an individual domain to the wind element number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>ndom The domain of interest </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>i The element number for the first (x) dimension </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>j The element number fro the second (z or theta) dimension </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>* n The element number in the wind </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The element number is returned</dd></dl>
<p>This is just a simple translation to find the wind domain element number</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00575">575</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_a172ddeb06a81951700723a0b02d90557_cgraph.png" border="0" usemap="#util_8c_a172ddeb06a81951700723a0b02d90557_cgraph" alt=""/></div>
<map name="util_8c_a172ddeb06a81951700723a0b02d90557_cgraph" id="util_8c_a172ddeb06a81951700723a0b02d90557_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="131,25,175,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="592,25,649,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="223,51,296,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="344,37,433,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="367,88,411,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="493,25,532,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="481,76,544,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_a172ddeb06a81951700723a0b02d90557_icgraph.png" border="0" usemap="#util_8c_a172ddeb06a81951700723a0b02d90557_icgraph" alt=""/></div>
<map name="util_8c_a172ddeb06a81951700723a0b02d90557_icgraph" id="util_8c_a172ddeb06a81951700723a0b02d90557_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a95a5dd7b17dd91fc7d21b44ee290d256" title="defines the cells in a cylindrical grid when the disk is vertically extended. " alt="" coords="321,56,421,83"/>
<area shape="rect" id="node5" href="templates_8h.html#a99c605bb65f5950301b4adf1ff09eb8d" title="Completes the definition of some of the positonal variables in the wind, and creates some subidiary a..." alt="" coords="137,5,257,32"/>
<area shape="rect" id="node8" href="templates_8h.html#a95334daf522cc6a4ac43e85e759f4a31" title="w) calculates the wind volume of a cylindrical cell allowing for the fact that some cells ..." alt="" coords="325,157,416,184"/>
<area shape="rect" id="node9" href="cylind__var_8c.html#a32c03e10ad1712cb98a72b444cca5499" title="locates the grid position of the vector, when one is using modified cylindrical coordinates, with the z heights varying. " alt="" coords="139,259,255,285"/>
<area shape="rect" id="node13" href="templates_8h.html#a2ec3f5fd8390071adf98cdaee7afb064" title="extends the density to regions just outside the wind regiions so that extrapolations of density can b..." alt="" coords="137,360,258,387"/>
<area shape="rect" id="node14" href="templates_8h.html#a56507e563e08709e70d77a7ccd538ee3" title="defines the cells in a cylindrical grid " alt="" coords="321,208,421,235"/>
<area shape="rect" id="node15" href="templates_8h.html#a13144d35b1d57cfa570b6e59d225f474" title="Calculates the wind volume for cells in a cylindrical domain allowing for the fact that some cells ar..." alt="" coords="325,107,416,133"/>
<area shape="rect" id="node16" href="cylindrical_8c.html#a88a4510bced469b493b0a16a8b2308ba" title="locates the grid position of the vector, when one is using cylindrical coordinates. " alt="" coords="139,309,255,336"/>
<area shape="rect" id="node17" href="cylindrical_8c.html#ac1669c1045ab41daf35de34f56dd9737" title="extends the density to regions just outside the wind regiions so that extrapolations of density can b..." alt="" coords="137,411,257,437"/>
<area shape="rect" id="node18" href="templates_8h.html#a38134c43cdc9afb2ef078514b06b4f88" title="Defines an r&#45;theta grid to accept a hydro model. " alt="" coords="132,461,263,488"/>
<area shape="rect" id="node19" href="templates_8h.html#a36f04216329e1a6ede98f9f9e0e3989b" title="Computes volumes for cells in an r&#45;theta hydro model. " alt="" coords="137,512,258,539"/>
<area shape="rect" id="node20" href="templates_8h.html#afe381010f3abbac0bcdba71d37f95bef" title="Use the imported data to initialize various portions of the Wind and Domain structures. " alt="" coords="138,563,257,605"/>
<area shape="rect" id="node21" href="templates_8h.html#a8b3c1f6c4930f2daf2e4b20af1956787" title="Use the imported data to initialize various portions of the Wind and Domain structures. " alt="" coords="131,629,264,656"/>
<area shape="rect" id="node22" href="templates_8h.html#ad7572cd8c842aa9c3ee2476a89888ec4" title="Outputs wind path information to vtk. " alt="" coords="135,680,259,707"/>
<area shape="rect" id="node24" href="templates_8h.html#a4cb6c91545a34b48e5d6cd74a68665de" title="Set up an rtheta grid. " alt="" coords="147,731,247,757"/>
<area shape="rect" id="node25" href="templates_8h.html#a16377719f4171d75f5aa983c79476590" title="rtheta_volume(w) calculates the wind volume of a cell in rtheta coordinate sysem allowing for the fac..." alt="" coords="152,781,243,808"/>
<area shape="rect" id="node26" href="rtheta_8c.html#a4526cc1605a2fd32d6d0106ac1a1e25d" title="locates the grid position of the vector, when one is using rtheta coordinates. " alt="" coords="139,832,255,859"/>
<area shape="rect" id="node27" href="templates_8h.html#ad06961b0435b7c8b175189291537c20c" title="extends the density to regions just outside the wind regiions so that extrapolations of density can b..." alt="" coords="137,883,257,909"/>
<area shape="rect" id="node28" href="util_8c.html#ad2938cb78e3414274491d2d778843db3" title="Determine the wind domain element number from a postion. " alt="" coords="158,933,237,960"/>
<area shape="rect" id="node3" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="482,107,558,133"/>
<area shape="rect" id="node4" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="611,107,655,133"/>
<area shape="rect" id="node6" href="windsave_8c.html#ad5c30455dbf640e7a5d68132a8e4a5c5" title="A driver routine that calls coordinate&#45;system specific routines that complete the descirption of the ..." alt="" coords="326,5,415,32"/>
<area shape="rect" id="node7" href="windsave_8c.html#a1bf368d85f72b220cc4cba091a5e0702" title="Read back the windsavefile. " alt="" coords="486,5,554,32"/>
<area shape="rect" id="node10" href="cylind__var_8c.html#a3185dc024d7c8bf77fe0be0dc128a272" title="calculate the fractional position of a position in the 2d grid in a coordinate for modified cylindric..." alt="" coords="312,259,429,285"/>
<area shape="rect" id="node12" href="wind2d_8c.html#ad4b676b9911462eec0740df5f8f0da55" title="locates the element in wmain associated with a postion " alt="" coords="328,309,413,336"/>
<area shape="rect" id="node11" href="util_8c.html#a58278ee8209899477833e9415625667b" title="calculate the fractional contributions in interpolations of values of quantities, such as electron de..." alt="" coords="477,259,563,285"/>
<area shape="rect" id="node23" href="templates_8h.html#a210e77beda2c9c25b9008de9107a17f8" title="Evaluates wind path details for a cycle. " alt="" coords="313,680,429,707"/>
<area shape="rect" id="node29" href="templates_8h.html#a782f80aab666cb86b3a296856d1f34e6" title="Initialises everything for reverb mapping. " alt="" coords="336,933,405,960"/>
</map>
</div>

</div>
</div>
<a id="aed64e9379499a741e8a7c42376e20530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed64e9379499a741e8a7c42376e20530">&#9670;&nbsp;</a></span>wind_n_to_ij()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wind_n_to_ij </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Translate a cell number in the wind to the two-d grid position in a specific domain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>n The 1-d position in the wind domain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* i The first index for a 2d position in a given domain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* j The second index for a 2d postion in a given domain </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>i,j position in a given domain</dd></dl>
<p>wmain contains elements for the entire winds. This routine translates from a wmain index to the two-d index of a specific domain so that one can interpolate.</p>
<h3>Notes</h3>
<p>For 2d, the underlying 1-d grid is organized so that as n increases, one goes up in z, and then steps out in rho., or in theta and then z as the case may be.</p>
<p>With domains, this routine has to be used carefully, and a better statement would be that these routines map to and from the element in wmain to the normally 2d element in an individual domain.</p>
<p>So this means that if you want to get the ith and jth element of domain 1, then one needs to give nstart+whatever to wind_n_to_ij </p>

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00539">539</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_aed64e9379499a741e8a7c42376e20530_icgraph.png" border="0" usemap="#util_8c_aed64e9379499a741e8a7c42376e20530_icgraph" alt=""/></div>
<map name="util_8c_aed64e9379499a741e8a7c42376e20530_icgraph" id="util_8c_aed64e9379499a741e8a7c42376e20530_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a52b5367a4a1a8d1bbe9446a5571a81fd" title="cylin_ds_in_cell calculates the distance to the far boundary of the cell in which the photon bundle r..." alt="" coords="157,56,255,83"/>
<area shape="rect" id="node7" href="cylind__var_8c.html#a352d864e752cc2b9041a5e2ad1e5ffff" title="Generate a position at a random location within a specific cell of a domain with modified&#45;cylindrical..." alt="" coords="133,157,279,184"/>
<area shape="rect" id="node9" href="templates_8h.html#a924a75177a13600d1838067dccd80aa0" title="calculate the distance to the far boundary of the cell in which the photon bundle when dealing with a..." alt="" coords="157,5,255,32"/>
<area shape="rect" id="node10" href="cylindrical_8c.html#ab19f6786630fce8ae46bbd702d80d59b" title="Generate a position at a random location within a specific cell of a domain with cylindrical coordina..." alt="" coords="133,107,279,133"/>
<area shape="rect" id="node11" href="templates_8h.html#aa06d3901560706877fe1b434a657e3d1" title="Check whether this cell is in the wind or not. " alt="" coords="329,221,449,248"/>
<area shape="rect" id="node13" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="655,272,731,299"/>
<area shape="rect" id="node15" href="templates_8h.html#a83eeb6fe319aa5af7c8400e921273323" title="wind_element" alt="" coords="164,309,248,336"/>
<area shape="rect" id="node16" href="py__wind__sub_8c.html#a25fe0a921c950a05a1c8e51ad24b153b" title="complete_physical_summary" alt="" coords="131,360,281,387"/>
<area shape="rect" id="node17" href="py__wind__write_8c.html#a7c9aa3c558eb4b666dac6d80aa7a80c5" title="writes out the arrays in a way which can be read easily into a routine which can do contouring ..." alt="" coords="170,411,242,437"/>
<area shape="rect" id="node18" href="templates_8h.html#a68cff92e2a36ec9073dbecabffa5543b" title="calculates the distance to the far boundary of the cell in which the photon bundle resides..." alt="" coords="157,461,255,488"/>
<area shape="rect" id="node19" href="rtheta_8c.html#ac89ea2d29fd2c00fd675f641d98b8b59" title="rtheta_get_random_location" alt="" coords="133,512,279,539"/>
<area shape="rect" id="node20" href="templates_8h.html#a6a70fbae6e163ad01aec40a2354ed674" title="Check whether a cell in an rtheta coordiante system is in the wind. " alt="" coords="329,443,449,469"/>
<area shape="rect" id="node22" href="spherical_8c.html#aadfbcaed1dc773ebb991e922722a5267" title="spherical_get_random\l_location" alt="" coords="145,614,267,655"/>
<area shape="rect" id="node23" href="wind2d_8c.html#a80e38cc8054ee669104c30986700d508" title="The routine basically just calls where_in_wind for each of the 4 corners of the cell. " alt="" coords="145,259,267,285"/>
<area shape="rect" id="node24" href="windsave2table__sub_8c.html#afe3772325272c41a36f31deb1e2de602" title="writes a specific variables of a windsaave which are intended to be of general interest to file which..." alt="" coords="149,832,263,859"/>
<area shape="rect" id="node28" href="windsave2table__sub_8c.html#a57cbceef71e198c504c6a29b6717cd5a" title="writes a selected variables related to heating and cooling processes to an ascii file which can be re..." alt="" coords="155,731,257,757"/>
<area shape="rect" id="node29" href="windsave2table__sub_8c.html#a9f0c3036f941fc90a710ab34d104956b" title="makes an astropy table containing the relative abundances of a given element as a function of the pos..." alt="" coords="158,781,254,808"/>
<area shape="rect" id="node3" href="templates_8h.html#afee395233fbca5e632fd3ef51106f74c" title="calculates the distance photon can travel within the cell that it is currently in. " alt="" coords="356,31,423,57"/>
<area shape="rect" id="node4" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="499,5,605,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="502,56,602,83"/>
<area shape="rect" id="node5" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="663,31,723,57"/>
<area shape="rect" id="node8" href="wind2d_8c.html#af8f7fd3a6d5f7872ee87beb27dcba899" title="is simply will produce a postion at a random place in a cell n " alt="" coords="331,145,447,172"/>
<area shape="rect" id="node12" href="templates_8h.html#a13144d35b1d57cfa570b6e59d225f474" title="Calculates the wind volume for cells in a cylindrical domain allowing for the fact that some cells ar..." alt="" coords="507,221,597,248"/>
<area shape="rect" id="node14" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="779,272,823,299"/>
<area shape="rect" id="node21" href="templates_8h.html#a16377719f4171d75f5aa983c79476590" title="rtheta_volume(w) calculates the wind volume of a cell in rtheta coordinate sysem allowing for the fac..." alt="" coords="507,443,597,469"/>
<area shape="rect" id="node25" href="windsave2table__sub_8c.html#a435ccfb2aea5f873c9508368e974eced" title="The main routine associated with windsave2table, this routine calls various other routines which writ..." alt="" coords="335,781,443,808"/>
<area shape="rect" id="node26" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="497,756,607,783"/>
<area shape="rect" id="node27" href="windsave2table_8c.html#afced8478b91af5c169926dfa4426333d" title="windsave2table writes key variables in a windsave file to an astropy table calculated Python..." alt="" coords="530,807,574,833"/>
</map>
</div>

</div>
</div>
<a id="ad2938cb78e3414274491d2d778843db3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2938cb78e3414274491d2d778843db3">&#9670;&nbsp;</a></span>wind_x_to_n()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wind_x_to_n </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the wind domain element number from a postion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] A three vector describing a position </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* n The element number in the wind domain </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Also retruns the element number in the wind domain</dd></dl>
<p>The routine simply cycles through the various domains until if finds one in where x is in that domain.</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000061">Bug:</a></b></dt><dd>There are no checks for whether x is within the wind. This seems very dangerous.</dd></dl>

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00610">610</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_ad2938cb78e3414274491d2d778843db3_cgraph.png" border="0" usemap="#util_8c_ad2938cb78e3414274491d2d778843db3_cgraph" alt=""/></div>
<map name="util_8c_ad2938cb78e3414274491d2d778843db3_cgraph" id="util_8c_ad2938cb78e3414274491d2d778843db3_cgraph">
<area shape="rect" id="node2" href="util_8c.html#a172ddeb06a81951700723a0b02d90557" title="Translate from the 2d element for an individual domain to the wind element number. " alt="" coords="132,25,209,52"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="257,25,301,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="719,25,776,52"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="349,51,423,77"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="471,37,560,64"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="493,88,537,115"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="620,25,659,52"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="608,76,671,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8c_ad2938cb78e3414274491d2d778843db3_icgraph.png" border="0" usemap="#util_8c_ad2938cb78e3414274491d2d778843db3_icgraph" alt=""/></div>
<map name="util_8c_ad2938cb78e3414274491d2d778843db3_icgraph" id="util_8c_ad2938cb78e3414274491d2d778843db3_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a782f80aab666cb86b3a296856d1f34e6" title="Initialises everything for reverb mapping. " alt="" coords="132,5,201,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8c064433c3cb416cc54ca16016f1f580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c064433c3cb416cc54ca16016f1f580">&#9670;&nbsp;</a></span>ierr_coord_fraction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ierr_coord_fraction = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00223">223</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>

</div>
</div>
<a id="a0f0c8239c80e4ad569d9c18782b6f5cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f0c8239c80e4ad569d9c18782b6f5cc">&#9670;&nbsp;</a></span>ierr_where_in_2dcell</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ierr_where_in_2dcell = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="util_8c_source.html#l00401">401</a> of file <a class="el" href="util_8c_source.html">util.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="util_8c.html">util.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
