<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/emission.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('emission_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">emission.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Subroutines having to do with radiation from the wind, including those that generate photons for the wind.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for emission.c:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2emission_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2emission_8c" id="_2_users_2mhewitt_2python_2source_2emission_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="emission_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9d591a3cd1b7fe6340a64d33141764e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a9d591a3cd1b7fe6340a64d33141764e0">BREMS_CONSTANT</a>&#160;&#160;&#160;6.85e-38</td></tr>
<tr class="separator:a9d591a3cd1b7fe6340a64d33141764e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae1d27b840ad2ff21462921fc2aab975c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#ae1d27b840ad2ff21462921fc2aab975c">wind_luminosity</a> (double f1, double f2)</td></tr>
<tr class="memdesc:ae1d27b840ad2ff21462921fc2aab975c"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the luminosity of the entire wind between freqencies f1 and f2  <a href="#ae1d27b840ad2ff21462921fc2aab975c">More...</a><br /></td></tr>
<tr class="separator:ae1d27b840ad2ff21462921fc2aab975c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c4eca39f3573084c0a1ff2d9f22209"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209">total_emission</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, double f1, double f2)</td></tr>
<tr class="memdesc:af6c4eca39f3573084c0a1ff2d9f22209"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the band-limited total emission of a single cell.  <a href="#af6c4eca39f3573084c0a1ff2d9f22209">More...</a><br /></td></tr>
<tr class="separator:af6c4eca39f3573084c0a1ff2d9f22209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9038968dd801ac73806fcc16fc1f0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a5b9038968dd801ac73806fcc16fc1f0c">photo_gen_wind</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double weight, double freqmin, double freqmax, int photstart, int nphot)</td></tr>
<tr class="memdesc:a5b9038968dd801ac73806fcc16fc1f0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">generates photons within the wind between two freqencies and stores them in the photon array  <a href="#a5b9038968dd801ac73806fcc16fc1f0c">More...</a><br /></td></tr>
<tr class="separator:a5b9038968dd801ac73806fcc16fc1f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a9a281cba993682e32c78c93f264f35"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a8a9a281cba993682e32c78c93f264f35">one_line</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, int *<a class="el" href="python_8h.html#ac1f90b11b79f8d2c9a25f12643063ee7">nres</a>)</td></tr>
<tr class="memdesc:a8a9a281cba993682e32c78c93f264f35"><td class="mdescLeft">&#160;</td><td class="mdescRight">gets the frequency of a single collisionally excited line photon in a particular cell of the wind.  <a href="#a8a9a281cba993682e32c78c93f264f35">More...</a><br /></td></tr>
<tr class="separator:a8a9a281cba993682e32c78c93f264f35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d">total_free</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, double t_e, double f1, double f2)</td></tr>
<tr class="memdesc:a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the band-limited ff luminosity of a cell.  <a href="#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d">More...</a><br /></td></tr>
<tr class="separator:a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade7eab896d4188a5b8a4ed6845d33150"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#ade7eab896d4188a5b8a4ed6845d33150">ff</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, double t_e, double freq)</td></tr>
<tr class="memdesc:ade7eab896d4188a5b8a4ed6845d33150"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate f_nu for ff emisssion  <a href="#ade7eab896d4188a5b8a4ed6845d33150">More...</a><br /></td></tr>
<tr class="separator:ade7eab896d4188a5b8a4ed6845d33150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59091ae76131213b5c23a085d88eb1d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#af59091ae76131213b5c23a085d88eb1d">one_ff</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, double f1, double f2)</td></tr>
<tr class="memdesc:af59091ae76131213b5c23a085d88eb1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">randomly generate the frequency of a ff photon within the frequency interval f1 and f2  <a href="#af59091ae76131213b5c23a085d88eb1d">More...</a><br /></td></tr>
<tr class="separator:af59091ae76131213b5c23a085d88eb1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad109a8ae79883e98e2dee88d65bd4e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e">gaunt_ff</a> (double gsquared)</td></tr>
<tr class="memdesc:aaad109a8ae79883e98e2dee88d65bd4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (1988).  <a href="#aaad109a8ae79883e98e2dee88d65bd4e">More...</a><br /></td></tr>
<tr class="separator:aaad109a8ae79883e98e2dee88d65bd4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8428e8b591206e7f8fc83a2616a3a473"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a8428e8b591206e7f8fc83a2616a3a473">ff_x</a> [<a class="el" href="python_8h.html#a88d0d1d859ac6495cd9d8c9b24beb11b">ARRAY_PDF</a>]</td></tr>
<tr class="memdesc:a8428e8b591206e7f8fc83a2616a3a473"><td class="mdescLeft">&#160;</td><td class="mdescRight">We initialise the arrays that will contain the unscaled PDF.  <a href="#a8428e8b591206e7f8fc83a2616a3a473">More...</a><br /></td></tr>
<tr class="separator:a8428e8b591206e7f8fc83a2616a3a473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa03cc18ee5059f6c120a5759b24ba6d5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#aa03cc18ee5059f6c120a5759b24ba6d5">ff_y</a> [<a class="el" href="python_8h.html#a88d0d1d859ac6495cd9d8c9b24beb11b">ARRAY_PDF</a>]</td></tr>
<tr class="separator:aa03cc18ee5059f6c120a5759b24ba6d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb99f84951c329c769ae89b0c97e579"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a4eb99f84951c329c769ae89b0c97e579">one_ff_f1</a></td></tr>
<tr class="memdesc:a4eb99f84951c329c769ae89b0c97e579"><td class="mdescLeft">&#160;</td><td class="mdescRight">Old values.  <a href="#a4eb99f84951c329c769ae89b0c97e579">More...</a><br /></td></tr>
<tr class="separator:a4eb99f84951c329c769ae89b0c97e579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56cb538ed747a9d62f8b03e400f370c8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a56cb538ed747a9d62f8b03e400f370c8">one_ff_f2</a></td></tr>
<tr class="separator:a56cb538ed747a9d62f8b03e400f370c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8daf8763c3420fb3ed40ef85da20e6a6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="emission_8c.html#a8daf8763c3420fb3ed40ef85da20e6a6">one_ff_te</a></td></tr>
<tr class="separator:a8daf8763c3420fb3ed40ef85da20e6a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Subroutines having to do with radiation from the wind, including those that generate photons for the wind. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a9d591a3cd1b7fe6340a64d33141764e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d591a3cd1b7fe6340a64d33141764e0">&#9670;&nbsp;</a></span>BREMS_CONSTANT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BREMS_CONSTANT&#160;&#160;&#160;6.85e-38</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Next section deals with bremsstrahlung radiation 4*PI* 8/3* sqrt(2*PI/3)*e**6/m**2/c**3 sqrt(m/kT) or 4*PI times the normal constant to dL_nu/dnu </p>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00464">464</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ade7eab896d4188a5b8a4ed6845d33150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade7eab896d4188a5b8a4ed6845d33150">&#9670;&nbsp;</a></span>ff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate f_nu for ff emisssion </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] WindPtr one A wind cell </td></tr>
    <tr><td class="paramname">[in</td><td>out] double t_e The temperature of the plasma </td></tr>
    <tr><td class="paramname">[in</td><td>out] double freq The frequency at which f_nu is to be calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>f_nu for the specific freqency, temperature requested and densities contained in the cell indicated</dd></dl>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000023">Bug:</a></b></dt><dd>f_nu is set to 0 for t_e less than 100K. It's not clear that this limit is applied to other functions anymore. Was this missed? Not also that the code having to do with the gaunt factor is duplicated from another routine. Should a gaunt_ff routine be created for both?</dd></dl>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00587">587</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_ade7eab896d4188a5b8a4ed6845d33150_cgraph.png" border="0" usemap="#emission_8c_ade7eab896d4188a5b8a4ed6845d33150_cgraph" alt=""/></div>
<map name="emission_8c_ade7eab896d4188a5b8a4ed6845d33150_cgraph" id="emission_8c_ade7eab896d4188a5b8a4ed6845d33150_cgraph">
<area shape="rect" id="node2" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="92,5,151,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_ade7eab896d4188a5b8a4ed6845d33150_icgraph.png" border="0" usemap="#emission_8c_ade7eab896d4188a5b8a4ed6845d33150_icgraph" alt=""/></div>
<map name="emission_8c_ade7eab896d4188a5b8a4ed6845d33150_icgraph" id="emission_8c_ade7eab896d4188a5b8a4ed6845d33150_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="98,31,147,57"/>
<area shape="rect" id="node7" href="py__wind__sub_8c.html#abc455fa6bb461c74a06a423bfe2b6054" title="overview" alt="" coords="92,81,153,108"/>
<area shape="rect" id="node3" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="201,5,297,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="229,56,269,83"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="345,5,421,32"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="469,5,544,32"/>
</map>
</div>

</div>
</div>
<a id="aaad109a8ae79883e98e2dee88d65bd4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaad109a8ae79883e98e2dee88d65bd4e">&#9670;&nbsp;</a></span>gaunt_ff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gaunt_ff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gsquared</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (1988). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>gsquared The variable on which Sutherland's ff gaunt factors are interpolated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An estimate of the Gaunt factor (for a particular ion)</dd></dl>
<p>It interpolates simply interpolates between the tabulated factors from Table 3 of Sutherland.</p>
<h3>Notes</h3>
<p>The reference for this is Sutherland, R.~S. 1998, MNRAS, 300, 321</p>
<p>gsquared is the scaled inverse temperature experienced by an ion, Z**2/kT(Ry). </p>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00754">754</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_aaad109a8ae79883e98e2dee88d65bd4e_icgraph.png" border="0" usemap="#emission_8c_aaad109a8ae79883e98e2dee88d65bd4e_icgraph" alt=""/></div>
<map name="emission_8c_aaad109a8ae79883e98e2dee88d65bd4e_icgraph" id="emission_8c_aaad109a8ae79883e98e2dee88d65bd4e_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="135,293,199,319"/>
<area shape="rect" id="node23" href="templates_8h.html#ade7eab896d4188a5b8a4ed6845d33150" title="calculate f_nu for ff emisssion " alt="" coords="148,369,187,395"/>
<area shape="rect" id="node28" href="templates_8h.html#a768f0a037ecfb93227eda643e247b219" title="populates the multiplicative constant, including a gaunt factor, to be used in the calculating free f..." alt="" coords="112,419,223,446"/>
<area shape="rect" id="node3" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="271,166,361,193"/>
<area shape="rect" id="node15" href="templates_8h.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="273,267,359,294"/>
<area shape="rect" id="node22" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="455,369,495,395"/>
<area shape="rect" id="node4" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="449,166,502,193"/>
<area shape="rect" id="node5" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="593,115,692,142"/>
<area shape="rect" id="node10" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="603,166,683,193"/>
<area shape="rect" id="node11" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="610,217,675,243"/>
<area shape="rect" id="node6" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="765,5,869,47"/>
<area shape="rect" id="node7" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="744,71,889,98"/>
<area shape="rect" id="node8" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="779,122,855,149"/>
<area shape="rect" id="node9" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="953,122,997,149"/>
<area shape="rect" id="node12" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="943,198,1006,225"/>
<area shape="rect" id="node14" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="790,223,843,250"/>
<area shape="rect" id="node13" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="1060,198,1156,225"/>
<area shape="rect" id="node16" href="templates_8h.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="429,267,521,294"/>
<area shape="rect" id="node21" href="py__wind__ion_8c.html#ad8a35c03a0bfe326d010682816b450c4" title="Get the total emission of the cells. " alt="" coords="409,318,541,345"/>
<area shape="rect" id="node17" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="603,271,682,298"/>
<area shape="rect" id="node20" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="589,322,696,349"/>
<area shape="rect" id="node18" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="937,325,1012,351"/>
<area shape="rect" id="node19" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="770,325,863,351"/>
<area shape="rect" id="node24" href="templates_8h.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="291,369,341,395"/>
<area shape="rect" id="node27" href="py__wind__sub_8c.html#abc455fa6bb461c74a06a423bfe2b6054" title="overview" alt="" coords="285,419,347,446"/>
<area shape="rect" id="node25" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="427,419,523,446"/>
<area shape="rect" id="node26" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="779,387,855,414"/>
</map>
</div>

</div>
</div>
<a id="af59091ae76131213b5c23a085d88eb1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af59091ae76131213b5c23a085d88eb1d">&#9670;&nbsp;</a></span>one_ff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_ff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>randomly generate the frequency of a ff photon within the frequency interval f1 and f2 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one A specific wind cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A randomly geneted frequncy for a ff photon given the conditions specified</dd></dl>
<h3>Notes</h3>
<p>one is the windcell where the photon will be created. It is needed only for the temperature. The code would be simplified if simply the temperature were transmitted.</p>
<p>The routine creeates a cdf given the conditions specified and then samples this. When the routine is re-entered it checks if the conditions are the same as previously. Given this it is desirable to generate all of the photons in a single cell in one go. </p>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00680">680</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_af59091ae76131213b5c23a085d88eb1d_cgraph.png" border="0" usemap="#emission_8c_af59091ae76131213b5c23a085d88eb1d_cgraph" alt=""/></div>
<map name="emission_8c_af59091ae76131213b5c23a085d88eb1d_cgraph" id="emission_8c_af59091ae76131213b5c23a085d88eb1d_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="423,202,467,228"/>
<area shape="rect" id="node9" href="emission_8c.html#ade7eab896d4188a5b8a4ed6845d33150" title="calculate f_nu for ff emisssion " alt="" coords="139,430,178,456"/>
<area shape="rect" id="node11" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="103,126,215,152"/>
<area shape="rect" id="node16" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="119,328,199,355"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="896,139,953,166"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="527,164,600,191"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="648,114,737,140"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="671,164,715,191"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="797,114,836,140"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="785,63,848,90"/>
<area shape="rect" id="node10" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="283,455,342,482"/>
<area shape="rect" id="node12" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="263,202,363,228"/>
<area shape="rect" id="node13" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="279,100,346,127"/>
<area shape="rect" id="node14" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="425,12,464,39"/>
<area shape="rect" id="node15" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="411,88,479,115"/>
<area shape="rect" id="node17" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="279,303,347,330"/>
<area shape="rect" id="node18" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="265,404,361,431"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_af59091ae76131213b5c23a085d88eb1d_icgraph.png" border="0" usemap="#emission_8c_af59091ae76131213b5c23a085d88eb1d_icgraph" alt=""/></div>
<map name="emission_8c_af59091ae76131213b5c23a085d88eb1d_icgraph" id="emission_8c_af59091ae76131213b5c23a085d88eb1d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="103,5,199,32"/>
<area shape="rect" id="node5" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="131,56,171,83"/>
<area shape="rect" id="node3" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="247,5,323,32"/>
<area shape="rect" id="node4" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="371,5,445,32"/>
</map>
</div>

</div>
</div>
<a id="a8a9a281cba993682e32c78c93f264f35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a9a281cba993682e32c78c93f264f35">&#9670;&nbsp;</a></span>one_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_line </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gets the frequency of a single collisionally excited line photon in a particular cell of the wind. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one The wind cell </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* nres The number associated with the transition </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The frequency of the transition</dd></dl>
<p>The routine geneerates a random number and uses this to select the transition that was excited</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00419">419</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_a8a9a281cba993682e32c78c93f264f35_cgraph.png" border="0" usemap="#emission_8c_a8a9a281cba993682e32c78c93f264f35_cgraph" alt=""/></div>
<map name="emission_8c_a8a9a281cba993682e32c78c93f264f35_cgraph" id="emission_8c_a8a9a281cba993682e32c78c93f264f35_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="139,15,183,42"/>
<area shape="rect" id="node9" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="113,66,209,93"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="627,29,684,55"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="257,54,331,81"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="379,41,468,67"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="401,91,445,118"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="528,29,567,55"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="516,79,579,106"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_a8a9a281cba993682e32c78c93f264f35_icgraph.png" border="0" usemap="#emission_8c_a8a9a281cba993682e32c78c93f264f35_icgraph" alt=""/></div>
<map name="emission_8c_a8a9a281cba993682e32c78c93f264f35_icgraph" id="emission_8c_a8a9a281cba993682e32c78c93f264f35_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="122,5,218,32"/>
<area shape="rect" id="node5" href="windsave2table__sub_8c.html#afe3772325272c41a36f31deb1e2de602" title="writes a specific variables of a windsaave which are intended to be of general interest to file which..." alt="" coords="113,56,227,83"/>
<area shape="rect" id="node9" href="windsave2table__sub_8c.html#a57cbceef71e198c504c6a29b6717cd5a" title="writes a selected variables related to heating and cooling processes to an ascii file which can be re..." alt="" coords="119,107,221,133"/>
<area shape="rect" id="node10" href="windsave2table__sub_8c.html#a9f0c3036f941fc90a710ab34d104956b" title="makes an astropy table containing the relative abundances of a given element as a function of the pos..." alt="" coords="122,157,218,184"/>
<area shape="rect" id="node3" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="291,5,367,32"/>
<area shape="rect" id="node4" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="448,5,523,32"/>
<area shape="rect" id="node6" href="windsave2table__sub_8c.html#a435ccfb2aea5f873c9508368e974eced" title="The main routine associated with windsave2table, this routine calls various other routines which writ..." alt="" coords="275,107,383,133"/>
<area shape="rect" id="node7" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="431,81,540,108"/>
<area shape="rect" id="node8" href="windsave2table_8c.html#afced8478b91af5c169926dfa4426333d" title="windsave2table writes key variables in a windsave file to an astropy table calculated Python..." alt="" coords="463,132,507,159"/>
</map>
</div>

</div>
</div>
<a id="a5b9038968dd801ac73806fcc16fc1f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b9038968dd801ac73806fcc16fc1f0c">&#9670;&nbsp;</a></span>photo_gen_wind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int photo_gen_wind </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freqmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>photstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nphot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generates photons within the wind between two freqencies and stores them in the photon array </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">PhotPtr</td><td>p The entire photon stucture </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>weight weight of each photon to be generated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmin The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freqmax The maximum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>photstart The place in the photon stucture where the first photon will be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nphot The number of photon bundles to generate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Normally returns the number of photons created.</dd></dl>
<p>When the routine is completed new photons will exist from p[istart] to p[istart+return value].</p>
<p>The routine first generates a random number which is used to determine in which wind cell should be generated, and then determines the type of photon to generate. Once this is doen the routine cycles thourhg the PlasmaCells generatating all of the photons for each cell at once.</p>
<h3>Notes</h3>
<p>This logic was adopted for speed related reasons.</p>
<p>If photo_gen_wind tries to create more photons than exist in the photon structure the program will stop (rather than continue incorrectly or start blasting away memory.)</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000022">Bug:</a></b></dt><dd>This is another example where the iteration might be made over plasma cells instead of looking for wind cells with positive volume </dd></dl>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00213">213</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_cgraph.png" border="0" usemap="#emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_cgraph" alt=""/></div>
<map name="emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_cgraph" id="emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="956,11,1024,37"/>
<area shape="rect" id="node4" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="512,499,608,525"/>
<area shape="rect" id="node5" href="emission_8c.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="196,195,245,221"/>
<area shape="rect" id="node6" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="845,448,889,475"/>
<area shape="rect" id="node21" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="831,93,904,120"/>
<area shape="rect" id="node22" href="foo_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="195,1107,247,1133"/>
<area shape="rect" id="node23" href="emission_8c.html#a8a9a281cba993682e32c78c93f264f35" title="gets the frequency of a single collisionally excited line photon in a particular cell of the wind..." alt="" coords="368,955,428,981"/>
<area shape="rect" id="node24" href="foo_8h.html#a55dba11eab85fa51b5bbf621a3c66b57" title="get_random_location" alt="" coords="163,1157,279,1184"/>
<area shape="rect" id="node25" href="foo_8h.html#a1881a8f6279e1472e741aab3ee654383" title="randvec" alt="" coords="369,1360,427,1387"/>
<area shape="rect" id="node26" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="189,727,252,753"/>
<area shape="rect" id="node42" href="anisowind_8c.html#a5cc282e1f3d56ce0f29cb080bc225408" title="is the routine which chooses a new anisotropic direction in geo.scatter_mode = SCATTER_MODE_THERMAL ..." alt="" coords="149,1005,292,1032"/>
<area shape="rect" id="node45" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="187,1208,255,1235"/>
<area shape="rect" id="node46" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="201,1259,240,1285"/>
<area shape="rect" id="node47" href="foo_8h.html#a176ee6debad2930212ca97a2d28794c0" title="Generates path for a wind photon. " alt="" coords="161,1309,281,1336"/>
<area shape="rect" id="node48" href="foo_8h.html#a7719923b66bf470bc4eeb42c454ebd48" title="Generates path for a &#39;wind&#39; photon in photon mode. " alt="" coords="157,1360,285,1387"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1323,245,1380,272"/>
<area shape="rect" id="node12" href="emission_8c.html#ade7eab896d4188a5b8a4ed6845d33150" title="calculate f_nu for ff emisssion " alt="" coords="379,93,417,120"/>
<area shape="rect" id="node14" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="504,144,616,171"/>
<area shape="rect" id="node19" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="358,296,438,323"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="953,347,1027,373"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1075,296,1164,323"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1097,347,1141,373"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1224,296,1263,323"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1212,245,1275,272"/>
<area shape="rect" id="node13" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="531,93,589,120"/>
<area shape="rect" id="node15" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="673,347,773,373"/>
<area shape="rect" id="node16" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="689,195,756,221"/>
<area shape="rect" id="node17" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="848,195,887,221"/>
<area shape="rect" id="node18" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="833,144,901,171"/>
<area shape="rect" id="node20" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="526,296,594,323"/>
<area shape="rect" id="node27" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="379,448,417,475"/>
<area shape="rect" id="node28" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="355,499,441,525"/>
<area shape="rect" id="node29" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="370,1107,426,1133"/>
<area shape="rect" id="node30" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="372,1157,424,1184"/>
<area shape="rect" id="node31" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="342,1005,454,1032"/>
<area shape="rect" id="node34" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="829,867,905,893"/>
<area shape="rect" id="node36" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="365,549,431,576"/>
<area shape="rect" id="node37" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="340,600,456,627"/>
<area shape="rect" id="node38" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="375,651,421,677"/>
<area shape="rect" id="node39" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="373,701,423,728"/>
<area shape="rect" id="node40" href="foo_8h.html#ab0b1a9d790b71c94f9562c567eeee268" title="create_basis" alt="" coords="359,752,437,779"/>
<area shape="rect" id="node41" href="foo_8h.html#a5672a43b959d7e6d398852cbc41ee6b1" title="project_from" alt="" coords="359,803,437,829"/>
<area shape="rect" id="node32" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="506,651,614,677"/>
<area shape="rect" id="node35" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="689,867,757,893"/>
<area shape="rect" id="node33" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="664,701,781,728"/>
<area shape="rect" id="node43" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="343,1309,453,1336"/>
<area shape="rect" id="node44" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="363,1259,433,1285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_icgraph.png" border="0" usemap="#emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_icgraph" alt=""/></div>
<map name="emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_icgraph" id="emission_8c_a5b9038968dd801ac73806fcc16fc1f0c_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="149,5,225,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="273,5,348,32"/>
</map>
</div>

</div>
</div>
<a id="af6c4eca39f3573084c0a1ff2d9f22209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6c4eca39f3573084c0a1ff2d9f22209">&#9670;&nbsp;</a></span>total_emission()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double total_emission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the band-limited total emission of a single cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one The wind cell of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency for the calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency for the calculation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>It returns the total luminosity, but also stores the luminosity due to various types of emssion, e.g ff, fb, lines, compton into the Plasms cells</dd></dl>
<h3>Notes</h3>
<p>Total emission gives the total enery loss due to photons. It does not include other cooling sources, e. g. adiabatic expansion.</p>
<p>It returns the total luminosity, but also stores the luminosity due to various types of emssion, e.g ff, fb, lines, compton into the Plasms cell assocatied with the wind cell.</p>
<p>Comment: Compton cooling is not included here. </p>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00110">110</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_cgraph.png" border="0" usemap="#emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_cgraph" alt=""/></div>
<map name="emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_cgraph" id="emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_cgraph">
<area shape="rect" id="node2" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="144,95,240,121"/>
<area shape="rect" id="node9" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="165,171,219,197"/>
<area shape="rect" id="node10" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="145,221,239,248"/>
<area shape="rect" id="node16" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="160,272,224,299"/>
<area shape="rect" id="node18" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="139,323,245,349"/>
<area shape="rect" id="node3" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="313,5,366,32"/>
<area shape="rect" id="node7" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="304,107,375,133"/>
<area shape="rect" id="node8" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="308,56,371,83"/>
<area shape="rect" id="node4" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="433,5,512,32"/>
<area shape="rect" id="node5" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="560,5,628,32"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="676,5,733,32"/>
<area shape="rect" id="node11" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="320,157,359,184"/>
<area shape="rect" id="node12" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="293,208,385,235"/>
<area shape="rect" id="node13" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="320,259,359,285"/>
<area shape="rect" id="node14" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="320,309,359,336"/>
<area shape="rect" id="node15" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="307,360,372,387"/>
<area shape="rect" id="node17" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="310,411,369,437"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_icgraph.png" border="0" usemap="#emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_icgraph" alt=""/></div>
<map name="emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_icgraph" id="emission_8c_af6c4eca39f3573084c0a1ff2d9f22209_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="159,56,251,83"/>
<area shape="rect" id="node7" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="172,107,237,133"/>
<area shape="rect" id="node11" href="py__wind__ion_8c.html#ad8a35c03a0bfe326d010682816b450c4" title="Get the total emission of the cells. " alt="" coords="139,157,271,184"/>
<area shape="rect" id="node3" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="333,5,411,32"/>
<area shape="rect" id="node6" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="319,56,425,83"/>
<area shape="rect" id="node4" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="625,5,700,32"/>
<area shape="rect" id="node5" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="473,31,567,57"/>
<area shape="rect" id="node8" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="489,132,551,159"/>
<area shape="rect" id="node10" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="345,157,399,184"/>
<area shape="rect" id="node9" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="615,132,711,159"/>
</map>
</div>

</div>
</div>
<a id="a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d">&#9670;&nbsp;</a></span>total_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double total_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the band-limited ff luminosity of a cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one A wind cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t_e The electron temperature to use </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The free-free luminosity between f1 and f2</dd></dl>
<h3>Notes</h3>
<p>The program uses an integral formula rather than integrating on the fly which is not ideal but saves time</p>
<p>The gaunt factor used depends on whether data for this is read in from the atomic data files. If it is, then the gaunt factor determined using data from Sutherland (1998). If not, the gaunt factor is set to 1. </p>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00491">491</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_cgraph.png" border="0" usemap="#emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_cgraph" alt=""/></div>
<map name="emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_cgraph" id="emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_cgraph">
<area shape="rect" id="node2" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="117,5,176,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_icgraph.png" border="0" usemap="#emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_icgraph" alt=""/></div>
<map name="emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_icgraph" id="emission_8c_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="117,173,208,199"/>
<area shape="rect" id="node14" href="templates_8h.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="120,249,205,275"/>
<area shape="rect" id="node21" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="143,299,183,326"/>
<area shape="rect" id="node3" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="295,173,349,199"/>
<area shape="rect" id="node4" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="440,122,539,149"/>
<area shape="rect" id="node9" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="449,173,529,199"/>
<area shape="rect" id="node10" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="457,223,522,250"/>
<area shape="rect" id="node5" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="611,5,715,47"/>
<area shape="rect" id="node6" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="591,71,736,98"/>
<area shape="rect" id="node7" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="625,122,701,149"/>
<area shape="rect" id="node8" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="799,122,843,149"/>
<area shape="rect" id="node11" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="790,211,853,238"/>
<area shape="rect" id="node13" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="637,223,690,250"/>
<area shape="rect" id="node12" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="907,211,1003,238"/>
<area shape="rect" id="node15" href="templates_8h.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="276,274,368,301"/>
<area shape="rect" id="node20" href="py__wind__ion_8c.html#ad8a35c03a0bfe326d010682816b450c4" title="Get the total emission of the cells. " alt="" coords="256,325,388,351"/>
<area shape="rect" id="node16" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="450,274,529,301"/>
<area shape="rect" id="node19" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="436,325,543,351"/>
<area shape="rect" id="node17" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="784,287,859,314"/>
<area shape="rect" id="node18" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="617,325,710,351"/>
</map>
</div>

</div>
</div>
<a id="ae1d27b840ad2ff21462921fc2aab975c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1d27b840ad2ff21462921fc2aab975c">&#9670;&nbsp;</a></span>wind_luminosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double wind_luminosity </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the luminosity of the entire wind between freqencies f1 and f2 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] double f1 The minimum frequency for the calculation </td></tr>
    <tr><td class="paramname">[in</td><td>out] double f2 The maximum frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The luminosity of the entire wind</dd></dl>
<p>The routine simply calls total_emission for each wind cell with a positive volume in the wind</p>
<p>The routine also populates several luminosity related variables in geo, which give the luminosity for separate processes, e.g free-free and free_ound emission.</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000021">Bug:</a></b></dt><dd>The do loop might be simpler if made over the plasma cells instead of the wind, but one should be careful of the dummy cell</dd></dl>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00047">47</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_ae1d27b840ad2ff21462921fc2aab975c_cgraph.png" border="0" usemap="#emission_8c_ae1d27b840ad2ff21462921fc2aab975c_cgraph" alt=""/></div>
<map name="emission_8c_ae1d27b840ad2ff21462921fc2aab975c_cgraph" id="emission_8c_ae1d27b840ad2ff21462921fc2aab975c_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a0018131577a59a5142e3677785504d37" title="Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines..." alt="" coords="156,171,220,197"/>
<area shape="rect" id="node3" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="145,221,231,248"/>
<area shape="rect" id="node4" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="284,95,380,121"/>
<area shape="rect" id="node11" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="305,171,359,197"/>
<area shape="rect" id="node12" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="285,221,379,248"/>
<area shape="rect" id="node18" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="300,272,364,299"/>
<area shape="rect" id="node20" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="279,323,385,349"/>
<area shape="rect" id="node5" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="453,5,506,32"/>
<area shape="rect" id="node9" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="444,107,515,133"/>
<area shape="rect" id="node10" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="448,56,511,83"/>
<area shape="rect" id="node6" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="573,5,652,32"/>
<area shape="rect" id="node7" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="700,5,768,32"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="816,5,873,32"/>
<area shape="rect" id="node13" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="460,157,499,184"/>
<area shape="rect" id="node14" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="433,208,525,235"/>
<area shape="rect" id="node15" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="460,259,499,285"/>
<area shape="rect" id="node16" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="460,309,499,336"/>
<area shape="rect" id="node17" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="447,360,512,387"/>
<area shape="rect" id="node19" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="450,411,509,437"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="emission_8c_ae1d27b840ad2ff21462921fc2aab975c_icgraph.png" border="0" usemap="#emission_8c_ae1d27b840ad2ff21462921fc2aab975c_icgraph" alt=""/></div>
<map name="emission_8c_ae1d27b840ad2ff21462921fc2aab975c_icgraph" id="emission_8c_ae1d27b840ad2ff21462921fc2aab975c_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="159,5,238,32"/>
<area shape="rect" id="node5" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="145,56,252,83"/>
<area shape="rect" id="node3" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="441,5,516,32"/>
<area shape="rect" id="node4" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="300,31,393,57"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8428e8b591206e7f8fc83a2616a3a473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8428e8b591206e7f8fc83a2616a3a473">&#9670;&nbsp;</a></span>ff_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ff_x[<a class="el" href="python_8h.html#a88d0d1d859ac6495cd9d8c9b24beb11b">ARRAY_PDF</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We initialise the arrays that will contain the unscaled PDF. </p>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00648">648</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>

</div>
</div>
<a id="aa03cc18ee5059f6c120a5759b24ba6d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa03cc18ee5059f6c120a5759b24ba6d5">&#9670;&nbsp;</a></span>ff_y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ff_y[<a class="el" href="python_8h.html#a88d0d1d859ac6495cd9d8c9b24beb11b">ARRAY_PDF</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00648">648</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>

</div>
</div>
<a id="a4eb99f84951c329c769ae89b0c97e579"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb99f84951c329c769ae89b0c97e579">&#9670;&nbsp;</a></span>one_ff_f1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_ff_f1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Old values. </p>

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00651">651</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>

</div>
</div>
<a id="a56cb538ed747a9d62f8b03e400f370c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56cb538ed747a9d62f8b03e400f370c8">&#9670;&nbsp;</a></span>one_ff_f2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_ff_f2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00651">651</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>

</div>
</div>
<a id="a8daf8763c3420fb3ed40ef85da20e6a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8daf8763c3420fb3ed40ef85da20e6a6">&#9670;&nbsp;</a></span>one_ff_te</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_ff_te</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="emission_8c_source.html#l00651">651</a> of file <a class="el" href="emission_8c_source.html">emission.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="emission_8c.html">emission.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
