<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/recomb.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('recomb_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">recomb.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The routines in this file all have to do with photoionization and/or recombination rates and emissivities.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="recipes_8h_source.html">recipes.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for recomb.c:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2recomb_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2recomb_8c" id="_2_users_2mhewitt_2python_2source_2recomb_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="489,169,552,196"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="237,169,281,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="305,169,368,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="392,169,465,196"/>
</map>
</div>
</div>
<p><a href="recomb_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a06ce3976dc892f3d6e3aba0464c3e465"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a06ce3976dc892f3d6e3aba0464c3e465">FBEMISS</a>&#160;&#160;&#160;7.67413e-62</td></tr>
<tr class="separator:a06ce3976dc892f3d6e3aba0464c3e465"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4afaeaee23214405bf4d30a7d2eb06b6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6">fb_topbase_partial</a> (double freq)</td></tr>
<tr class="memdesc:a4afaeaee23214405bf4d30a7d2eb06b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms of Topbase photoionization x-sections.  <a href="#a4afaeaee23214405bf4d30a7d2eb06b6">More...</a><br /></td></tr>
<tr class="separator:a4afaeaee23214405bf4d30a7d2eb06b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef12badd64f5bb47d6fccbb217ba805"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a7ef12badd64f5bb47d6fccbb217ba805">integ_fb</a> (double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, double f1, double f2, int nion, int fb_choice, int mode)</td></tr>
<tr class="memdesc:a7ef12badd64f5bb47d6fccbb217ba805"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the integrated emissivity of the plasma, or the number of recombinations per second of a particular ion within defined frequency bands.  <a href="#a7ef12badd64f5bb47d6fccbb217ba805">More...</a><br /></td></tr>
<tr class="separator:a7ef12badd64f5bb47d6fccbb217ba805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d0d69b33092d06a7174d71c3082d2a6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a9d0d69b33092d06a7174d71c3082d2a6">total_fb</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, double f1, double f2, int fb_choice, int mode)</td></tr>
<tr class="memdesc:a9d0d69b33092d06a7174d71c3082d2a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t between the frequncy limits f1 and f2. The energy lost is just the kinetic energy lost from the plasma because it does not include the ionization potential associated with each recombination. Python tracks effectively the kinetic energy of the plasma (not the potential energy available if everything recombined).  <a href="#a9d0d69b33092d06a7174d71c3082d2a6">More...</a><br /></td></tr>
<tr class="separator:a9d0d69b33092d06a7174d71c3082d2a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3f4af5624039f9a4937939331b5219"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a1e3f4af5624039f9a4937939331b5219">one_fb</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, double f1, double f2)</td></tr>
<tr class="memdesc:a1e3f4af5624039f9a4937939331b5219"><td class="mdescLeft">&#160;</td><td class="mdescRight">generates one free bound photon with specific frequency limits  <a href="#a1e3f4af5624039f9a4937939331b5219">More...</a><br /></td></tr>
<tr class="separator:a1e3f4af5624039f9a4937939331b5219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c21266df7327fbc81b2c5cf6b5e067f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a7c21266df7327fbc81b2c5cf6b5e067f">num_recomb</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, double t_e, int mode)</td></tr>
<tr class="memdesc:a7c21266df7327fbc81b2c5cf6b5e067f"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the total number of recombinations for all of the ions in a cell  <a href="#a7c21266df7327fbc81b2c5cf6b5e067f">More...</a><br /></td></tr>
<tr class="separator:a7c21266df7327fbc81b2c5cf6b5e067f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c153b5e0d982b2debddf4523274d159"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a9c153b5e0d982b2debddf4523274d159">fb</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, double freq, int ion_choice, int fb_choice)</td></tr>
<tr class="memdesc:a9c153b5e0d982b2debddf4523274d159"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates either the free_bound emissivity at a specific frequency or depending on inputs, the recombination rate  <a href="#a9c153b5e0d982b2debddf4523274d159">More...</a><br /></td></tr>
<tr class="separator:a9c153b5e0d982b2debddf4523274d159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d223ebd7563467934af71d1d8e4552"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a86d223ebd7563467934af71d1d8e4552">init_freebound</a> (double t1, double t2, double f1, double f2)</td></tr>
<tr class="memdesc:a86d223ebd7563467934af71d1d8e4552"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the structure fb_struc as well as some associated arrays and variables (found in <a class="el" href="python_8h.html">python.h</a>) that describe recombination rates and band-limited luminosities.  <a href="#a86d223ebd7563467934af71d1d8e4552">More...</a><br /></td></tr>
<tr class="separator:a86d223ebd7563467934af71d1d8e4552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac492018c209163236776675dbf5c7e7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#aac492018c209163236776675dbf5c7e7">get_nrecomb</a> (double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, int nion, int mode)</td></tr>
<tr class="memdesc:aac492018c209163236776675dbf5c7e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the recombination coefficient.  <a href="#aac492018c209163236776675dbf5c7e7">More...</a><br /></td></tr>
<tr class="separator:aac492018c209163236776675dbf5c7e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c3eb3f3d0a8eecbbdee02b8988f17d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#aa7c3eb3f3d0a8eecbbdee02b8988f17d">get_fb</a> (double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, int nion, int narray, int fb_choice, int mode)</td></tr>
<tr class="memdesc:aa7c3eb3f3d0a8eecbbdee02b8988f17d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate from a set of stored emissivities.  <a href="#aa7c3eb3f3d0a8eecbbdee02b8988f17d">More...</a><br /></td></tr>
<tr class="separator:aa7c3eb3f3d0a8eecbbdee02b8988f17d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbfb58b40faa368dabec2eb9f4b51c89"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#abbfb58b40faa368dabec2eb9f4b51c89">xinteg_fb</a> (double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, double f1, double f2, int nion, int fb_choice)</td></tr>
<tr class="memdesc:abbfb58b40faa368dabec2eb9f4b51c89"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the integrated emissivity of an ion in the plasma.  <a href="#abbfb58b40faa368dabec2eb9f4b51c89">More...</a><br /></td></tr>
<tr class="separator:abbfb58b40faa368dabec2eb9f4b51c89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250e063dde090c67146f51ea71371bfc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a250e063dde090c67146f51ea71371bfc">xinteg_inner_fb</a> (double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>, double f1, double f2, int nion, int fb_choice)</td></tr>
<tr class="memdesc:a250e063dde090c67146f51ea71371bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature  <a href="#a250e063dde090c67146f51ea71371bfc">More...</a><br /></td></tr>
<tr class="separator:a250e063dde090c67146f51ea71371bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1050097e6dcebb3469479d4fd5ff6c0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#ab1050097e6dcebb3469479d4fd5ff6c0">total_rrate</a> (int nion, double T)</td></tr>
<tr class="memdesc:ab1050097e6dcebb3469479d4fd5ff6c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the total rediative recombination rate  <a href="#ab1050097e6dcebb3469479d4fd5ff6c0">More...</a><br /></td></tr>
<tr class="separator:ab1050097e6dcebb3469479d4fd5ff6c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a942292d67abfae3c22d1bbf5ed6fbc3c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a942292d67abfae3c22d1bbf5ed6fbc3c">gs_rrate</a> (int nion, double T)</td></tr>
<tr class="memdesc:a942292d67abfae3c22d1bbf5ed6fbc3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the recombination rate to the ground state for an ion at a particular temperature  <a href="#a942292d67abfae3c22d1bbf5ed6fbc3c">More...</a><br /></td></tr>
<tr class="separator:a942292d67abfae3c22d1bbf5ed6fbc3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8012f489c5fe73ae85b4e317f8bb6059"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a8012f489c5fe73ae85b4e317f8bb6059">sort_and_compress</a> (double *array_in, double *array_out, int npts)</td></tr>
<tr class="memdesc:a8012f489c5fe73ae85b4e317f8bb6059"><td class="mdescLeft">&#160;</td><td class="mdescRight">sort an array into numerical order elimination duplicates  <a href="#a8012f489c5fe73ae85b4e317f8bb6059">More...</a><br /></td></tr>
<tr class="separator:a8012f489c5fe73ae85b4e317f8bb6059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14b7f5dc01c12685f12b0909b19c44c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#ab14b7f5dc01c12685f12b0909b19c44c">compare_doubles</a> (const void *a, const void *b)</td></tr>
<tr class="memdesc:ab14b7f5dc01c12685f12b0909b19c44c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A routine used by qsort in sort_and_compress.  <a href="#ab14b7f5dc01c12685f12b0909b19c44c">More...</a><br /></td></tr>
<tr class="separator:ab14b7f5dc01c12685f12b0909b19c44c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a117ad9d70df29904483bbfd9806a309a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a117ad9d70df29904483bbfd9806a309a">nfb</a> = 0</td></tr>
<tr class="separator:a117ad9d70df29904483bbfd9806a309a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e952830acfd72d94f766bdc91bbf491"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a8e952830acfd72d94f766bdc91bbf491">fb_xtop</a></td></tr>
<tr class="memdesc:a8e952830acfd72d94f766bdc91bbf491"><td class="mdescLeft">&#160;</td><td class="mdescRight">Topbase description of a photoionization x-section.  <a href="#a8e952830acfd72d94f766bdc91bbf491">More...</a><br /></td></tr>
<tr class="separator:a8e952830acfd72d94f766bdc91bbf491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a0b6fb88bea4c0aefe51c2450811b13"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a5a0b6fb88bea4c0aefe51c2450811b13">fbt</a></td></tr>
<tr class="memdesc:a5a0b6fb88bea4c0aefe51c2450811b13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temperature at which thee emissivity is calculated.  <a href="#a5a0b6fb88bea4c0aefe51c2450811b13">More...</a><br /></td></tr>
<tr class="separator:a5a0b6fb88bea4c0aefe51c2450811b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac916b517ddc336331a78e357a6202e51"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#ac916b517ddc336331a78e357a6202e51">fbfr</a></td></tr>
<tr class="memdesc:ac916b517ddc336331a78e357a6202e51"><td class="mdescLeft">&#160;</td><td class="mdescRight">fb_choice (see above)  <a href="#ac916b517ddc336331a78e357a6202e51">More...</a><br /></td></tr>
<tr class="separator:ac916b517ddc336331a78e357a6202e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8c6474c3951256fbf41d3d22d31677a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#ab8c6474c3951256fbf41d3d22d31677a">fb_x</a> [<a class="el" href="python_8h.html#a8fcad90a1005b8d2b876efbafa401305">NCDF</a>]</td></tr>
<tr class="separator:ab8c6474c3951256fbf41d3d22d31677a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d256704fefe06d3279a1c8b0a2f7bd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a63d256704fefe06d3279a1c8b0a2f7bd">fb_y</a> [<a class="el" href="python_8h.html#a8fcad90a1005b8d2b876efbafa401305">NCDF</a>]</td></tr>
<tr class="separator:a63d256704fefe06d3279a1c8b0a2f7bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f4da9e35aa663669e0d79d99828761"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a69f4da9e35aa663669e0d79d99828761">fb_jumps</a> [<a class="el" href="atomic_8h.html#a9acf4287226016eea5e934e8bd6d624b">NLEVELS</a>]</td></tr>
<tr class="memdesc:a69f4da9e35aa663669e0d79d99828761"><td class="mdescLeft">&#160;</td><td class="mdescRight">There is at most one jump per level.  <a href="#a69f4da9e35aa663669e0d79d99828761">More...</a><br /></td></tr>
<tr class="separator:a69f4da9e35aa663669e0d79d99828761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06ea38515f7ca3b10e17fa80d46d8f7d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a06ea38515f7ca3b10e17fa80d46d8f7d">xfb_jumps</a> [<a class="el" href="atomic_8h.html#a9acf4287226016eea5e934e8bd6d624b">NLEVELS</a>]</td></tr>
<tr class="memdesc:a06ea38515f7ca3b10e17fa80d46d8f7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is just a dummy array that parallels fb_jumpts.  <a href="#a06ea38515f7ca3b10e17fa80d46d8f7d">More...</a><br /></td></tr>
<tr class="separator:a06ea38515f7ca3b10e17fa80d46d8f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb831b6df6893db2eb3ac7730194c060"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#abb831b6df6893db2eb3ac7730194c060">fb_njumps</a> = (-1)</td></tr>
<tr class="separator:abb831b6df6893db2eb3ac7730194c060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74efea186ec16a1ae177b0bcc988537"><td class="memItemLeft" align="right" valign="top"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#ac74efea186ec16a1ae177b0bcc988537">ww_fb</a></td></tr>
<tr class="separator:ac74efea186ec16a1ae177b0bcc988537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeb0e362d7909391fc024b6b86ee5c79"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#aaeb0e362d7909391fc024b6b86ee5c79">one_fb_f1</a></td></tr>
<tr class="separator:aaeb0e362d7909391fc024b6b86ee5c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71e7b5af5a9405f96b962586ccbbd53"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#ac71e7b5af5a9405f96b962586ccbbd53">one_fb_f2</a></td></tr>
<tr class="separator:ac71e7b5af5a9405f96b962586ccbbd53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af02ce05060879ddcac97e53d4a2c2cb4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#af02ce05060879ddcac97e53d4a2c2cb4">one_fb_te</a></td></tr>
<tr class="separator:af02ce05060879ddcac97e53d4a2c2cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46df0c72a985a6734d8fb62d2d7774b0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="recomb_8c.html#a46df0c72a985a6734d8fb62d2d7774b0">init_freebound_nfb</a></td></tr>
<tr class="separator:a46df0c72a985a6734d8fb62d2d7774b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The routines in this file all have to do with photoionization and/or recombination rates and emissivities. </p>
<dl class="section author"><dt>Author</dt><dd>ksl,nsh </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018</dd></dl>
<h3>Notes</h3>
<p>These routines are quite complex representing a lot of work by various of us over a long period of time, and it is not entirely clear that they are quite what we want at present. It would be worthwhile to think about their structure the next time we make consider adding a physical process involving recombination.</p>
<p>Some of the complication associated with these routines arises from run time considerations which may no longer be very relevant today with parallel processing etc. </p>

<p class="definition">Definition in file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a06ce3976dc892f3d6e3aba0464c3e465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06ce3976dc892f3d6e3aba0464c3e465">&#9670;&nbsp;</a></span>FBEMISS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FBEMISS&#160;&#160;&#160;7.67413e-62</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>FBEMISS was calculated as follows: x= 2. * PI * MELEC * BOLTZMANN / (H*H); x=pow(x,-1.5); x*=8. * PI / (C*C); x*= H; </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00050">50</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab14b7f5dc01c12685f12b0909b19c44c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14b7f5dc01c12685f12b0909b19c44c">&#9670;&nbsp;</a></span>compare_doubles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compare_doubles </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A routine used by qsort in sort_and_compress. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">const</td><td>void * a A double precision number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">const</td><td>void * b A second double precision nubmer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if a is greater than b, 0 otherwise</dd></dl>
<p>This routine just compares two double precision numbers and returns 1 if a is greate than b, and 0 otherwise. It is needed by qsort which sorts a double precision array into numberical order.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01759">1759</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c_icgraph.png" border="0" usemap="#recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c_icgraph" alt=""/></div>
<map name="recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c_icgraph" id="recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a8012f489c5fe73ae85b4e317f8bb6059" title="sort an array into numerical order elimination duplicates " alt="" coords="155,5,264,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="312,5,364,32"/>
</map>
</div>

</div>
</div>
<a id="a9c153b5e0d982b2debddf4523274d159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c153b5e0d982b2debddf4523274d159">&#9670;&nbsp;</a></span>fb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ion_choice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fb_choice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates either the free_bound emissivity at a specific frequency or depending on inputs, the recombination rate </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma A plasma cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t The temperature at which to calculate the emisivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq The frequency at which to calculate the emissivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ion_choice Either the total or the emissivity for a specific ion </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>fb_choice determines whether what is returned is the emissivity a specific frecuency 0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The returns depend on fb_choice</dd></dl>
<p>If ion_choice is a number less than the number of ions then the value returned for that specific ion. However if ion_choice is set to the number of ions or greater, the the value returned is for the sum of all the ions.</p>
<p>The choices are:</p><ul>
<li>FB_FULL Calculate fb emissivity including energy associated with the threshold</li>
<li>FB_REDUCED Calculate the fb emissivity without the threshold energy</li>
<li>FB_RATE Calulate the fb recombination rate</li>
</ul>
<h3>Notes</h3>
<p>This routine calls subroutines that have variablew which are are transmitted externally, e.g fbt,fbfr, rather than though calls. The reason for this is some of the routines are also used as integrands where only one variable can be transimitted directly.</p>
<p>This routine does not have choices associated with inner shell recombination. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00840">840</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a9c153b5e0d982b2debddf4523274d159_cgraph.png" border="0" usemap="#recomb_8c_a9c153b5e0d982b2debddf4523274d159_cgraph" alt=""/></div>
<map name="recomb_8c_a9c153b5e0d982b2debddf4523274d159_cgraph" id="recomb_8c_a9c153b5e0d982b2debddf4523274d159_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="259,26,303,53"/>
<area shape="rect" id="node9" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="92,77,196,103"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="735,26,792,53"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="365,77,439,103"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="487,51,576,78"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="509,102,553,129"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="636,26,675,53"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="624,77,687,103"/>
<area shape="rect" id="node10" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="244,77,317,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a9c153b5e0d982b2debddf4523274d159_icgraph.png" border="0" usemap="#recomb_8c_a9c153b5e0d982b2debddf4523274d159_icgraph" alt=""/></div>
<map name="recomb_8c_a9c153b5e0d982b2debddf4523274d159_icgraph" id="recomb_8c_a9c153b5e0d982b2debddf4523274d159_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a8c30fbf58d7a0b5789604f00c96bedb6" title="A routine that finds the rooot of a function f. " alt="" coords="93,5,143,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="92,56,144,83"/>
</map>
</div>

</div>
</div>
<a id="a4afaeaee23214405bf4d30a7d2eb06b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4afaeaee23214405bf4d30a7d2eb06b6">&#9670;&nbsp;</a></span>fb_topbase_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fb_topbase_partial </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms of Topbase photoionization x-sections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq The freqeuncy of interest </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An emissivity or a recombination rate</dd></dl>
<p>What the routine returns depends on the external variable fbfr. The choices are:</p>
<ul>
<li>FB_FULL Calculate fb emissivity including energy associated with the threshold</li>
<li>FB_REDUCED Calculate the fb emissivity without the threshold energy</li>
<li>FB_RATE Calulate the fb recombinarion rate</li>
</ul>
<h3>Notes</h3>
<p>Generally speaiking this routine is integrated over frequency using a NR reciepes routine for that purpsoe. For that reason, much of the information has to be passed externally </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00100">100</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_cgraph.png" border="0" usemap="#recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_cgraph" alt=""/></div>
<map name="recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_cgraph" id="recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="172,15,216,42"/>
<area shape="rect" id="node9" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="157,66,231,92"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="648,28,705,55"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="279,54,352,80"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="400,40,489,67"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="423,91,467,118"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="549,28,588,55"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="537,79,600,106"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_icgraph.png" border="0" usemap="#recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_icgraph" alt=""/></div>
<map name="recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_icgraph" id="recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9c153b5e0d982b2debddf4523274d159" title="calculates either the free_bound emissivity at a specific frequency or depending on inputs..." alt="" coords="183,5,222,32"/>
<area shape="rect" id="node4" href="templates_8h.html#abbfb58b40faa368dabec2eb9f4b51c89" title="calculates the integrated emissivity of an ion in the plasma. " alt="" coords="171,107,234,133"/>
<area shape="rect" id="node10" href="templates_8h.html#a250e063dde090c67146f51ea71371bfc" title="calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature ..." alt="" coords="157,56,248,83"/>
<area shape="rect" id="node11" href="templates_8h.html#a942292d67abfae3c22d1bbf5ed6fbc3c" title="get the recombination rate to the ground state for an ion at a particular temperature ..." alt="" coords="173,157,232,184"/>
<area shape="rect" id="node3" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="313,5,365,32"/>
<area shape="rect" id="node5" href="templates_8h.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="310,56,367,83"/>
<area shape="rect" id="node8" href="templates_8h.html#a86d223ebd7563467934af71d1d8e4552" title="initializes the structure fb_struc as well as some associated arrays and variables (found in python..." alt="" coords="296,107,381,133"/>
<area shape="rect" id="node9" href="templates_8h.html#ab1050097e6dcebb3469479d4fd5ff6c0" title="get the total rediative recombination rate " alt="" coords="305,157,372,184"/>
<area shape="rect" id="node6" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="557,56,612,83"/>
<area shape="rect" id="node7" href="templates_8h.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="429,5,509,32"/>
</map>
</div>

</div>
</div>
<a id="aa7c3eb3f3d0a8eecbbdee02b8988f17d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7c3eb3f3d0a8eecbbdee02b8988f17d">&#9670;&nbsp;</a></span>get_fb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_fb </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>narray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fb_choice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate from a set of stored emissivities. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t The temperure of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nion The ion of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>narray The number of the array calculated for a particular frequency range </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>fb_choice A switch used only in the case of normal recombination </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A switch which indicates whether one is interested in normal (OUTER_SHELL) or innershell (INNER_SHELL) recombination </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The program generally returns an emissivity or a cooling rate, and the choices are determined by the combination of fb_choice and mode</dd></dl>
<p>if the mode is set for normal recombiantion, then the possiblities are:</p><ul>
<li>FB_FULL Calculate fb emissivity including energy associated with the threshold</li>
<li>FB_REDUCED Calculate the fb emissivity without the threshold energy</li>
</ul>
<p>if the mode is set for inner shell then the cooling rate (effectively FB_FULL) is returned.</p>
<p>In an effort to save time, information needed to calculate free-bound emissivities and cooling are calculated when a freqency interval is defined, and this routine is used to retrieve these values. The fb structures are populated by init_freebound</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01184">1184</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_cgraph.png" border="0" usemap="#recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_cgraph" alt=""/></div>
<map name="recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_cgraph" id="recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="103,5,152,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="105,56,149,83"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="569,56,627,83"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="200,81,273,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="321,68,411,95"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="344,119,388,145"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="471,56,509,83"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="459,107,521,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_icgraph.png" border="0" usemap="#recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_icgraph" alt=""/></div>
<map name="recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_icgraph" id="recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="103,5,160,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="336,5,391,32"/>
<area shape="rect" id="node4" href="templates_8h.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="208,31,288,57"/>
</map>
</div>

</div>
</div>
<a id="aac492018c209163236776675dbf5c7e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac492018c209163236776675dbf5c7e7">&#9670;&nbsp;</a></span>get_nrecomb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_nrecomb </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the recombination coefficient. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>t The temperature </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>nion The ion of interest </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>mode A switch to choose normal (OUTER_SHELL) or inner shell (INNER_SHELL) recombiantion </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The recombination coefficient</dd></dl>
<p>Uses data from Badnell or another source to get a recombination rate</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01133">1133</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_aac492018c209163236776675dbf5c7e7_cgraph.png" border="0" usemap="#recomb_8c_aac492018c209163236776675dbf5c7e7_cgraph" alt=""/></div>
<map name="recomb_8c_aac492018c209163236776675dbf5c7e7_cgraph" id="recomb_8c_aac492018c209163236776675dbf5c7e7_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="133,5,183,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="136,56,180,83"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="600,56,657,83"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="231,81,304,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="352,68,441,95"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="375,119,419,145"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="501,56,540,83"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="489,107,552,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_aac492018c209163236776675dbf5c7e7_icgraph.png" border="0" usemap="#recomb_8c_aac492018c209163236776675dbf5c7e7_icgraph" alt=""/></div>
<map name="recomb_8c_aac492018c209163236776675dbf5c7e7_icgraph" id="recomb_8c_aac492018c209163236776675dbf5c7e7_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="133,5,191,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="367,5,421,32"/>
<area shape="rect" id="node4" href="templates_8h.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="239,31,319,57"/>
</map>
</div>

</div>
</div>
<a id="a942292d67abfae3c22d1bbf5ed6fbc3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a942292d67abfae3c22d1bbf5ed6fbc3c">&#9670;&nbsp;</a></span>gs_rrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gs_rrate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the recombination rate to the ground state for an ion at a particular temperature </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nion The ion of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>T A temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the rate</dd></dl>
<p>This routine generates a recombination rate to the ground state for a given ion at a given temperature using data from Badnell or other sources (with similar data formats).</p>
<p>If these recombination rates a are not available for the given ion the Milne relation is used.</p>
<h3>Notes</h3>
<p>nion is the ion that is recombining to a less ionizaed state. There is thus no rate for HI or He I, etc.</p>
<p>The routine is used to produce recombination rate coefficients for the matrix ionization </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01576">1576</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_cgraph.png" border="0" usemap="#recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_cgraph" alt=""/></div>
<map name="recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_cgraph" id="recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="388,5,456,32"/>
<area shape="rect" id="node4" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="139,56,189,83"/>
<area shape="rect" id="node5" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="112,107,216,133"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="755,81,812,108"/>
<area shape="rect" id="node6" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="279,81,323,108"/>
<area shape="rect" id="node12" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="264,132,337,159"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="385,157,459,184"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="507,132,596,159"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="529,183,573,209"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="656,107,695,133"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="644,157,707,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_icgraph.png" border="0" usemap="#recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_icgraph" alt=""/></div>
<map name="recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_icgraph" id="recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_icgraph">
<area shape="rect" id="node2" href="zeta_8c.html#a54a60a3cfc21ceae39f7c529519c25ae" title="calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equa..." alt="" coords="112,48,197,74"/>
<area shape="rect" id="node3" href="saha_8c.html#a389fdf4d9e9d542a78a25229ce259927" title="calculates ion densities of a single element (defined by nelem) according to a modified on the spot a..." alt="" coords="245,22,331,49"/>
<area shape="rect" id="node6" href="variable__temperature_8c.html#a72d9769510683e30aeef87c2a255ebe4" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="379,73,495,100"/>
<area shape="rect" id="node4" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="543,22,668,49"/>
<area shape="rect" id="node5" href="templates_8h.html#aa8ede21a14cf7e763909094555c5240d" title="Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances con..." alt="" coords="417,22,457,49"/>
</map>
</div>

</div>
</div>
<a id="a86d223ebd7563467934af71d1d8e4552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86d223ebd7563467934af71d1d8e4552">&#9670;&nbsp;</a></span>init_freebound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_freebound </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes the structure fb_struc as well as some associated arrays and variables (found in <a class="el" href="python_8h.html">python.h</a>) that describe recombination rates and band-limited luminosities. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t1 A lower limit for the temperature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t2 An upper limit for the temperature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The lower limit for a frequency interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The upper limit for the frequency interval </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The routine generally returns 0</dd></dl>
<p>Python typically calculates photons in frequency ranges (in order to enable stratified sampling). For this to work, one needs freebound emissivities and cooling rates corresponding to these freqency ranges. Since we retrun to the same frequency ranges every cycle, Python stores the necessary information in structures.</p>
<p>This routine is responsible for populating these structures, so that they can be accessed later via the routine get_fb.</p>
<h3>Notes</h3>
<p>The first time the routine is called, both recombination rates and band-limited luminosities are calculated. On subsequent calls the routine checks to see whether it has already calculated the band-limited freebound emissivities, and if so returns without redoing the calculation. However, if a new frequency interval is provided, the new luminosities are added to the free-bound structure. To force a re-initialization nfb must be set to 0.</p>
<p>The routine allows for the possibility that there are more frequency intervals than place to store data and will recylce the structure if this occurs (indicating this with several error messages). This allows the program to proceed, but if this happens often then the variable NFB in <a class="el" href="python_8h.html">python.h</a> should be increased. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00977">977</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a86d223ebd7563467934af71d1d8e4552_cgraph.png" border="0" usemap="#recomb_8c_a86d223ebd7563467934af71d1d8e4552_cgraph" alt=""/></div>
<map name="recomb_8c_a86d223ebd7563467934af71d1d8e4552_cgraph" id="recomb_8c_a86d223ebd7563467934af71d1d8e4552_cgraph">
<area shape="rect" id="node2" href="recomb_8c.html#abbfb58b40faa368dabec2eb9f4b51c89" title="calculates the integrated emissivity of an ion in the plasma. " alt="" coords="153,107,215,133"/>
<area shape="rect" id="node5" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="444,157,488,184"/>
<area shape="rect" id="node14" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="568,259,607,285"/>
<area shape="rect" id="node15" href="recomb_8c.html#a250e063dde090c67146f51ea71371bfc" title="calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature ..." alt="" coords="139,56,229,83"/>
<area shape="rect" id="node3" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="294,5,365,32"/>
<area shape="rect" id="node4" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="304,56,355,83"/>
<area shape="rect" id="node12" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="277,107,381,133"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="920,183,977,209"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="551,132,624,159"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="672,145,761,172"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="695,95,739,121"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="821,157,860,184"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="809,107,872,133"/>
<area shape="rect" id="node13" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="429,107,503,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a86d223ebd7563467934af71d1d8e4552_icgraph.png" border="0" usemap="#recomb_8c_a86d223ebd7563467934af71d1d8e4552_icgraph" alt=""/></div>
<map name="recomb_8c_a86d223ebd7563467934af71d1d8e4552_icgraph" id="recomb_8c_a86d223ebd7563467934af71d1d8e4552_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="139,5,193,32"/>
</map>
</div>

</div>
</div>
<a id="a7ef12badd64f5bb47d6fccbb217ba805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef12badd64f5bb47d6fccbb217ba805">&#9670;&nbsp;</a></span>integ_fb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double integ_fb </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fb_choice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the integrated emissivity of the plasma, or the number of recombinations per second of a particular ion within defined frequency bands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t The temperature at which the emissivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>nion The ion for which the emissivity is returned </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>fb_choice A switch which determines exactly what is to be returned </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>mode A switch which indicates whether one is interested in normal radiative recombination (OUTER_SHELL) or inner shell recombinaiton (INNER_SHELL) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The routine returns the specific emissivity, e.g. the emissivity and or recombination rate per electron and per ion.</dd></dl>
<p>The options are as follows:</p>
<ul>
<li>FB_FULL Calculate fb emissivity including energy associated with the threshold</li>
<li>FB_REDUCED Calculate the fb emissivity without the threshold energy</li>
<li>FB_RATE Calulate the fb recombinarion rate</li>
</ul>
<p>The routine returns the integral of the emissivity (or recombination rate) over the frequency interval. The routine uses pre-calculated values if that is possible, or calculate a new values if that is not possible. (In that case xinteg_fb updates the set of pre-calculated values so that they can be used in a future call.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00242">242</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_cgraph.png" border="0" usemap="#recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_cgraph" alt=""/></div>
<map name="recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_cgraph" id="recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_cgraph">
<area shape="rect" id="node2" href="recomb_8c.html#aa7c3eb3f3d0a8eecbbdee02b8988f17d" title="Interpolate from a set of stored emissivities. " alt="" coords="131,32,181,58"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="416,133,460,160"/>
<area shape="rect" id="node11" href="recomb_8c.html#abbfb58b40faa368dabec2eb9f4b51c89" title="calculates the integrated emissivity of an ion in the plasma. " alt="" coords="125,234,187,261"/>
<area shape="rect" id="node16" href="recomb_8c.html#aac492018c209163236776675dbf5c7e7" title="Return the recombination coefficient. " alt="" coords="116,82,196,109"/>
<area shape="rect" id="node17" href="recomb_8c.html#a250e063dde090c67146f51ea71371bfc" title="calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature ..." alt="" coords="111,285,201,312"/>
<area shape="rect" id="node3" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="277,32,326,58"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="892,133,949,160"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="523,184,596,210"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="644,158,733,185"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="667,209,711,236"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="793,133,832,160"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="781,184,844,210"/>
<area shape="rect" id="node12" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="266,285,337,312"/>
<area shape="rect" id="node13" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="276,336,327,362"/>
<area shape="rect" id="node14" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="249,234,353,261"/>
<area shape="rect" id="node15" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="401,234,475,261"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_icgraph.png" border="0" usemap="#recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_icgraph" alt=""/></div>
<map name="recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_icgraph" id="recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="239,5,293,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="111,31,191,57"/>
</map>
</div>

</div>
</div>
<a id="a7c21266df7327fbc81b2c5cf6b5e067f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c21266df7327fbc81b2c5cf6b5e067f">&#9670;&nbsp;</a></span>num_recomb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int num_recomb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the total number of recombinations for all of the ions in a cell </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma The plasma cell of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t_e The temperarture of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A switch indicating whether one wants normal radiative recombination (OUTER_SHELL) or dielectronic recombination (INNER_SHELL) rates to be calculated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0; the results are stored in xplasma-&gt;recomb or xplasma-&gt;inner_recomb, depending on the mode</dd></dl>
<p>The routine calculates recombination rates for all the ions in a single cell. It stores the recombination rates in the arrays recomb (for normal recombination) or inner_recomb (for dielectronic recombination)</p>
<h3>Notes</h3>
<p>The calculation is made purely direct recombination using the photoionization x-sections.</p>
<p>The units are #/cm**3/s </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00738">738</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_cgraph.png" border="0" usemap="#recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_cgraph" alt=""/></div>
<map name="recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_cgraph" id="recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_cgraph">
<area shape="rect" id="node2" href="recomb_8c.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="133,133,191,160"/>
<area shape="rect" id="node3" href="recomb_8c.html#aa7c3eb3f3d0a8eecbbdee02b8988f17d" title="Interpolate from a set of stored emissivities. " alt="" coords="259,32,309,58"/>
<area shape="rect" id="node5" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="544,133,588,160"/>
<area shape="rect" id="node12" href="recomb_8c.html#abbfb58b40faa368dabec2eb9f4b51c89" title="calculates the integrated emissivity of an ion in the plasma. " alt="" coords="253,234,315,261"/>
<area shape="rect" id="node17" href="recomb_8c.html#aac492018c209163236776675dbf5c7e7" title="Return the recombination coefficient. " alt="" coords="244,82,324,109"/>
<area shape="rect" id="node18" href="recomb_8c.html#a250e063dde090c67146f51ea71371bfc" title="calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature ..." alt="" coords="239,285,329,312"/>
<area shape="rect" id="node4" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="405,32,454,58"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1020,133,1077,160"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="651,184,724,210"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="772,158,861,185"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="795,209,839,236"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="921,133,960,160"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="909,184,972,210"/>
<area shape="rect" id="node13" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="394,285,465,312"/>
<area shape="rect" id="node14" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="404,336,455,362"/>
<area shape="rect" id="node15" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="377,234,481,261"/>
<area shape="rect" id="node16" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="529,234,603,261"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_icgraph.png" border="0" usemap="#recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_icgraph" alt=""/></div>
<map name="recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_icgraph" id="recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_icgraph">
<area shape="rect" id="node2" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="133,5,237,47"/>
<area shape="rect" id="node3" href="py__wind__sub_8c.html#afe61bcd47610656c4bc08af99c1c6c0f" title="recomb_summary" alt="" coords="134,71,237,98"/>
<area shape="rect" id="node4" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="158,122,213,149"/>
</map>
</div>

</div>
</div>
<a id="a1e3f4af5624039f9a4937939331b5219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3f4af5624039f9a4937939331b5219">&#9670;&nbsp;</a></span>one_fb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_fb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generates one free bound photon with specific frequency limits </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one The wind cell in which the photon is being </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The frequency limits </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The frequency of the fb photon that was generated.</dd></dl>
<pre class="fragment">Although the routine returns only a single photon, it stores more
that one for the same conditions. If the routine is called mulitiple
times from the same cell with the same frequency limits it will use the pre-
stored values.  This was intended to avoid the process of having to
generate cdfs multiple times
</pre><h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000049">Bug:</a></b></dt><dd>This routine contains questions from Stuart in May 04 that have never been addressed. Furthemore, the routine has a parameter delta which is used to decide whether one is close enough in temperature to a previously generated DCF. This is set to 500, which is probably OK if the temperatures are high, but in appropriate if T is of order 1000 K.</dd></dl>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00533">533</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a1e3f4af5624039f9a4937939331b5219_cgraph.png" border="0" usemap="#recomb_8c_a1e3f4af5624039f9a4937939331b5219_cgraph" alt=""/></div>
<map name="recomb_8c_a1e3f4af5624039f9a4937939331b5219_cgraph" id="recomb_8c_a1e3f4af5624039f9a4937939331b5219_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="432,208,476,235"/>
<area shape="rect" id="node9" href="recomb_8c.html#a8012f489c5fe73ae85b4e317f8bb6059" title="sort an array into numerical order elimination duplicates " alt="" coords="107,499,216,525"/>
<area shape="rect" id="node11" href="recomb_8c.html#a9c153b5e0d982b2debddf4523274d159" title="calculates either the free_bound emissivity at a specific frequency or depending on inputs..." alt="" coords="142,321,181,348"/>
<area shape="rect" id="node14" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="105,107,217,133"/>
<area shape="rect" id="node19" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="121,372,201,399"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="908,183,965,209"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="539,208,612,235"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="660,259,749,285"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="683,208,727,235"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="809,309,848,336"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="797,259,860,285"/>
<area shape="rect" id="node10" href="recomb_8c.html#ab14b7f5dc01c12685f12b0909b19c44c" title="A routine used by qsort in sort_and_compress. " alt="" coords="267,537,368,564"/>
<area shape="rect" id="node12" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="265,385,369,412"/>
<area shape="rect" id="node13" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="417,385,491,412"/>
<area shape="rect" id="node15" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="267,132,367,159"/>
<area shape="rect" id="node16" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="284,81,351,108"/>
<area shape="rect" id="node17" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="435,81,473,108"/>
<area shape="rect" id="node18" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="420,5,488,32"/>
<area shape="rect" id="node20" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="283,487,351,513"/>
<area shape="rect" id="node21" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="269,436,365,463"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a1e3f4af5624039f9a4937939331b5219_icgraph.png" border="0" usemap="#recomb_8c_a1e3f4af5624039f9a4937939331b5219_icgraph" alt=""/></div>
<map name="recomb_8c_a1e3f4af5624039f9a4937939331b5219_icgraph" id="recomb_8c_a1e3f4af5624039f9a4937939331b5219_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="105,5,201,32"/>
<area shape="rect" id="node3" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="249,5,325,32"/>
<area shape="rect" id="node4" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="373,5,448,32"/>
</map>
</div>

</div>
</div>
<a id="a8012f489c5fe73ae85b4e317f8bb6059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8012f489c5fe73ae85b4e317f8bb6059">&#9670;&nbsp;</a></span>sort_and_compress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sort_and_compress </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>array_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>array_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sort an array into numerical order elimination duplicates </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>* array_in The input array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* array_out The output array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>npts The number of points in the input array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of valid element in the output array</dd></dl>
<p>The routine uses the GSL routine qsort to sort the array in place, and then copies unique elements of the sorted array into the output array.</p>
<h3>Notes</h3>
<p>The routine is used in the creation of cdfs, which need arrays which are sorted into numerical order, and for which one really does not wish duplicated values. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01703">1703</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_cgraph.png" border="0" usemap="#recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_cgraph" alt=""/></div>
<map name="recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_cgraph" id="recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_cgraph">
<area shape="rect" id="node2" href="recomb_8c.html#ab14b7f5dc01c12685f12b0909b19c44c" title="A routine used by qsort in sort_and_compress. " alt="" coords="163,5,264,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_icgraph.png" border="0" usemap="#recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_icgraph" alt=""/></div>
<map name="recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_icgraph" id="recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="163,5,215,32"/>
</map>
</div>

</div>
</div>
<a id="a9d0d69b33092d06a7174d71c3082d2a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d0d69b33092d06a7174d71c3082d2a6">&#9670;&nbsp;</a></span>total_fb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double total_fb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fb_choice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t between the frequncy limits f1 and f2. The energy lost is just the kinetic energy lost from the plasma because it does not include the ionization potential associated with each recombination. Python tracks effectively the kinetic energy of the plasma (not the potential energy available if everything recombined). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one The wind cell of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t The temperature of the cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>fb_choice A switch controlling whether emissivites or rates are returned </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A switch denoting whether normal recombination (OUTER_SHELL) or inner shell recombination (INNER_SHELL) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The routine calculates an emissivity for nommal recombination or a cooling rate for normal or dielectronic recombination</dd></dl>
<p>If OUTER_SHELL is chosen then the options are</p>
<ul>
<li>FB_FULL Calculate fb emissivity including energy associated with the threshold</li>
<li>FB_REDUCED Calculate the fb emissivity without the threshold energy</li>
</ul>
<p>If INNER_SHELL is chosen the recombination rate is returned.</p>
<h3>Notes</h3>
<p>The results in this routine are all based on the Milne relation</p>
<p>The routine is unusual in that one passes a the wind cell and not the plasma cell. This probably should be changed.</p>
<p>Note that FB_REDUCED is not an option for this routine</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000048">Bug:</a></b></dt><dd>What is preventing us from calculating a dielectronic emission rate?</dd></dl>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00428">428</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_cgraph.png" border="0" usemap="#recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_cgraph" alt=""/></div>
<map name="recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_cgraph" id="recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_cgraph">
<area shape="rect" id="node2" href="recomb_8c.html#a86d223ebd7563467934af71d1d8e4552" title="initializes the structure fb_struc as well as some associated arrays and variables (found in python..." alt="" coords="236,145,321,172"/>
<area shape="rect" id="node17" href="recomb_8c.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="108,233,188,260"/>
<area shape="rect" id="node18" href="recomb_8c.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="250,284,307,311"/>
<area shape="rect" id="node3" href="recomb_8c.html#abbfb58b40faa368dabec2eb9f4b51c89" title="calculates the integrated emissivity of an ion in the plasma. " alt="" coords="383,196,446,223"/>
<area shape="rect" id="node6" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="675,247,719,273"/>
<area shape="rect" id="node15" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="799,5,837,32"/>
<area shape="rect" id="node16" href="recomb_8c.html#a250e063dde090c67146f51ea71371bfc" title="calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature ..." alt="" coords="369,145,460,172"/>
<area shape="rect" id="node4" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="525,95,595,121"/>
<area shape="rect" id="node5" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="535,196,585,223"/>
<area shape="rect" id="node13" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="508,145,612,172"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1151,120,1208,147"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="781,247,855,273"/>
<area shape="rect" id="node9" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="903,196,992,223"/>
<area shape="rect" id="node12" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="925,247,969,273"/>
<area shape="rect" id="node10" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1052,145,1091,172"/>
<area shape="rect" id="node11" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1040,196,1103,223"/>
<area shape="rect" id="node14" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="660,145,733,172"/>
<area shape="rect" id="node19" href="recomb_8c.html#aa7c3eb3f3d0a8eecbbdee02b8988f17d" title="Interpolate from a set of stored emissivities. " alt="" coords="390,348,439,375"/>
<area shape="rect" id="node21" href="recomb_8c.html#aac492018c209163236776675dbf5c7e7" title="Return the recombination coefficient. " alt="" coords="375,399,455,425"/>
<area shape="rect" id="node20" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="535,399,585,425"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_icgraph.png" border="0" usemap="#recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_icgraph" alt=""/></div>
<map name="recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_icgraph" id="recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="124,122,177,149"/>
<area shape="rect" id="node3" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="262,71,353,98"/>
<area shape="rect" id="node14" href="templates_8h.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="108,249,193,275"/>
<area shape="rect" id="node4" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="258,122,357,149"/>
<area shape="rect" id="node9" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="267,173,347,199"/>
<area shape="rect" id="node10" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="275,223,340,250"/>
<area shape="rect" id="node5" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="442,5,546,47"/>
<area shape="rect" id="node6" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="421,71,567,98"/>
<area shape="rect" id="node7" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="456,122,532,149"/>
<area shape="rect" id="node8" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="639,122,683,149"/>
<area shape="rect" id="node11" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="630,198,693,225"/>
<area shape="rect" id="node13" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="467,223,521,250"/>
<area shape="rect" id="node12" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="756,198,852,225"/>
<area shape="rect" id="node15" href="templates_8h.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="261,274,353,301"/>
<area shape="rect" id="node20" href="py__wind__ion_8c.html#ad8a35c03a0bfe326d010682816b450c4" title="Get the total emission of the cells. " alt="" coords="241,325,373,351"/>
<area shape="rect" id="node16" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="455,274,533,301"/>
<area shape="rect" id="node19" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="441,325,547,351"/>
<area shape="rect" id="node17" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="767,274,841,301"/>
<area shape="rect" id="node18" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="615,299,708,326"/>
</map>
</div>

</div>
</div>
<a id="ab1050097e6dcebb3469479d4fd5ff6c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1050097e6dcebb3469479d4fd5ff6c0">&#9670;&nbsp;</a></span>total_rrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double total_rrate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the total rediative recombination rate </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nion The ion number of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>T The temperature for which the rate is calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total recombination rate for this ion for this temperature</dd></dl>
<p>Generates a total recombination rate for a given ion at a given temperature using data, obtained from sources such as Badnell or Shull.</p>
<p>If these are not present, an error is generated, and a value using the Milne relation is returned.</p>
<h3>Notes</h3>
<p>Recombination rates can be calculated from the Milne relation but in most cases this does not give one the most accurate recombination rate because one does not have all of the relevant levels. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01479">1479</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_cgraph.png" border="0" usemap="#recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_cgraph" alt=""/></div>
<map name="recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_cgraph" id="recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="397,26,441,53"/>
<area shape="rect" id="node9" href="recomb_8c.html#abbfb58b40faa368dabec2eb9f4b51c89" title="calculates the integrated emissivity of an ion in the plasma. " alt="" coords="120,77,183,103"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="873,26,931,53"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="504,77,577,103"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="625,51,715,78"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="648,102,692,129"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="775,26,813,53"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="763,77,825,103"/>
<area shape="rect" id="node10" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="247,77,318,103"/>
<area shape="rect" id="node11" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="257,127,308,154"/>
<area shape="rect" id="node12" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="231,178,335,205"/>
<area shape="rect" id="node13" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="383,178,456,205"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_icgraph.png" border="0" usemap="#recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_icgraph" alt=""/></div>
<map name="recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_icgraph" id="recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="120,5,245,32"/>
<area shape="rect" id="node3" href="zeta_8c.html#a54a60a3cfc21ceae39f7c529519c25ae" title="calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equa..." alt="" coords="140,56,225,83"/>
<area shape="rect" id="node4" href="saha_8c.html#a389fdf4d9e9d542a78a25229ce259927" title="calculates ion densities of a single element (defined by nelem) according to a modified on the spot a..." alt="" coords="293,31,379,57"/>
<area shape="rect" id="node7" href="variable__temperature_8c.html#a72d9769510683e30aeef87c2a255ebe4" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="427,81,543,108"/>
<area shape="rect" id="node5" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="591,31,716,57"/>
<area shape="rect" id="node6" href="templates_8h.html#aa8ede21a14cf7e763909094555c5240d" title="Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances con..." alt="" coords="465,31,505,57"/>
</map>
</div>

</div>
</div>
<a id="abbfb58b40faa368dabec2eb9f4b51c89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbfb58b40faa368dabec2eb9f4b51c89">&#9670;&nbsp;</a></span>xinteg_fb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xinteg_fb </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fb_choice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the integrated emissivity of an ion in the plasma. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>t The temperature of interest </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>f2 The maximum frequency </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>nion The ion of interest </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>fb_choice A switch which determined exactly what is returned </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integrated emissivity, depending on the fb_choice. The possibilites are</dd></dl>
<ul>
<li>FB_FULL Calculate fb emissivity including energy associated with the threshold</li>
<li>FB_REDUCED Calculate the fb emissivity without the threshold energy</li>
<li>FB_RATE Calulate the fb recombinarion rate</li>
</ul>
<p>The routine preforms a numberical integration over the partial emissivities</p>
<h3>Notes</h3>
<p>This routine is called by integ_fb. It is not intended to be called directly, which uses a Numerical Recipes routine to integrate over frequncy. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01249">1249</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_cgraph.png" border="0" usemap="#recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_cgraph" alt=""/></div>
<map name="recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_cgraph" id="recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="133,5,203,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="143,56,193,83"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="283,107,327,133"/>
<area shape="rect" id="node11" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="116,157,220,184"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="759,107,816,133"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="389,157,463,184"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="511,132,600,159"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="533,183,577,209"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="660,107,699,133"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="648,157,711,184"/>
<area shape="rect" id="node12" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="268,157,341,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_icgraph.png" border="0" usemap="#recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_icgraph" alt=""/></div>
<map name="recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_icgraph" id="recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="121,22,178,48"/>
<area shape="rect" id="node5" href="templates_8h.html#a86d223ebd7563467934af71d1d8e4552" title="initializes the structure fb_struc as well as some associated arrays and variables (found in python..." alt="" coords="231,72,316,99"/>
<area shape="rect" id="node6" href="templates_8h.html#ab1050097e6dcebb3469479d4fd5ff6c0" title="get the total rediative recombination rate " alt="" coords="116,123,183,150"/>
<area shape="rect" id="node3" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="364,22,419,48"/>
<area shape="rect" id="node4" href="templates_8h.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="233,22,313,48"/>
</map>
</div>

</div>
</div>
<a id="a250e063dde090c67146f51ea71371bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a250e063dde090c67146f51ea71371bfc">&#9670;&nbsp;</a></span>xinteg_inner_fb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xinteg_inner_fb </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fb_choice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t The temperarure of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f1 The minimum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>f2 The maximum frequency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nion The ion of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>fb_choice ??? </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Exactly what the the routine returns is determined by fb_choice, which is passed as an an external variable to fb_topbase_partial</dd></dl>
<p>The possibilites are</p>
<ul>
<li>FB_FULL Calculate fb emissivity including energy associated with the threshold</li>
<li>FB_REDUCED Calculate the fb emissivity without the threshold energy</li>
<li>FB_RATE Calulate the fb recombinarion rate</li>
</ul>
<h3>Notes</h3>
<p>This routine is virtual copy of xinteg_fb but considers only inner shells . The integration that is requied to integrate over frequencies is carried out using the Numerical Recipes routine qromb. This is why a number of variables are passed as external variables, include fb_choice, fmin and fmax. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l01375">1375</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a250e063dde090c67146f51ea71371bfc_cgraph.png" border="0" usemap="#recomb_8c_a250e063dde090c67146f51ea71371bfc_cgraph" alt=""/></div>
<map name="recomb_8c_a250e063dde090c67146f51ea71371bfc_cgraph" id="recomb_8c_a250e063dde090c67146f51ea71371bfc_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="161,5,231,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="171,56,221,83"/>
<area shape="rect" id="node4" href="recomb_8c.html#a4afaeaee23214405bf4d30a7d2eb06b6" title="returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms..." alt="" coords="144,107,248,133"/>
<area shape="rect" id="node5" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="311,81,355,108"/>
<area shape="rect" id="node12" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="296,132,369,159"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="787,95,844,121"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="417,120,491,147"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="539,107,628,133"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="561,157,605,184"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="688,95,727,121"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="676,145,739,172"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="recomb_8c_a250e063dde090c67146f51ea71371bfc_icgraph.png" border="0" usemap="#recomb_8c_a250e063dde090c67146f51ea71371bfc_icgraph" alt=""/></div>
<map name="recomb_8c_a250e063dde090c67146f51ea71371bfc_icgraph" id="recomb_8c_a250e063dde090c67146f51ea71371bfc_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="144,22,201,49"/>
<area shape="rect" id="node5" href="templates_8h.html#a86d223ebd7563467934af71d1d8e4552" title="initializes the structure fb_struc as well as some associated arrays and variables (found in python..." alt="" coords="249,73,335,99"/>
<area shape="rect" id="node3" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="383,22,437,49"/>
<area shape="rect" id="node4" href="templates_8h.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="252,22,332,49"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a69f4da9e35aa663669e0d79d99828761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69f4da9e35aa663669e0d79d99828761">&#9670;&nbsp;</a></span>fb_jumps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fb_jumps[<a class="el" href="atomic_8h.html#a9acf4287226016eea5e934e8bd6d624b">NLEVELS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>There is at most one jump per level. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00495">495</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="abb831b6df6893db2eb3ac7730194c060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb831b6df6893db2eb3ac7730194c060">&#9670;&nbsp;</a></span>fb_njumps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fb_njumps = (-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00498">498</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="ab8c6474c3951256fbf41d3d22d31677a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8c6474c3951256fbf41d3d22d31677a">&#9670;&nbsp;</a></span>fb_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fb_x[<a class="el" href="python_8h.html#a8fcad90a1005b8d2b876efbafa401305">NCDF</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00493">493</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="a8e952830acfd72d94f766bdc91bbf491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e952830acfd72d94f766bdc91bbf491">&#9670;&nbsp;</a></span>fb_xtop</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a>* fb_xtop</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Topbase description of a photoionization x-section. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00058">58</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="a63d256704fefe06d3279a1c8b0a2f7bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63d256704fefe06d3279a1c8b0a2f7bd">&#9670;&nbsp;</a></span>fb_y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fb_y[<a class="el" href="python_8h.html#a8fcad90a1005b8d2b876efbafa401305">NCDF</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00493">493</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="ac916b517ddc336331a78e357a6202e51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac916b517ddc336331a78e357a6202e51">&#9670;&nbsp;</a></span>fbfr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fbfr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fb_choice (see above) </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00064">64</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="a5a0b6fb88bea4c0aefe51c2450811b13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a0b6fb88bea4c0aefe51c2450811b13">&#9670;&nbsp;</a></span>fbt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fbt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Temperature at which thee emissivity is calculated. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00061">61</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="a46df0c72a985a6734d8fb62d2d7774b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46df0c72a985a6734d8fb62d2d7774b0">&#9670;&nbsp;</a></span>init_freebound_nfb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_freebound_nfb</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Indicates the total number of freebound sets that could be used </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00931">931</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="a117ad9d70df29904483bbfd9806a309a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a117ad9d70df29904483bbfd9806a309a">&#9670;&nbsp;</a></span>nfb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nfb = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Next line is required for proper initialization Actual number of freqency intervals calculated </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00042">42</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="aaeb0e362d7909391fc024b6b86ee5c79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeb0e362d7909391fc024b6b86ee5c79">&#9670;&nbsp;</a></span>one_fb_f1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_fb_f1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00501">501</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="ac71e7b5af5a9405f96b962586ccbbd53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71e7b5af5a9405f96b962586ccbbd53">&#9670;&nbsp;</a></span>one_fb_f2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_fb_f2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00501">501</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="af02ce05060879ddcac97e53d4a2c2cb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af02ce05060879ddcac97e53d4a2c2cb4">&#9670;&nbsp;</a></span>one_fb_te</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_fb_te</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00501">501</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="ac74efea186ec16a1ae177b0bcc988537"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac74efea186ec16a1ae177b0bcc988537">&#9670;&nbsp;</a></span>ww_fb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> ww_fb</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00500">500</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
<a id="a06ea38515f7ca3b10e17fa80d46d8f7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06ea38515f7ca3b10e17fa80d46d8f7d">&#9670;&nbsp;</a></span>xfb_jumps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xfb_jumps[<a class="el" href="atomic_8h.html#a9acf4287226016eea5e934e8bd6d624b">NLEVELS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is just a dummy array that parallels fb_jumpts. </p>

<p class="definition">Definition at line <a class="el" href="recomb_8c_source.html#l00497">497</a> of file <a class="el" href="recomb_8c_source.html">recomb.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="recomb_8c.html">recomb.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
