<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/para_update.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('para__update_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">para_update.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>routines for communicating MC estimators and spectra between MPI threads.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for para_update.c:</div>
<div class="dyncontent">
<div class="center"><img src="para__update_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2para__update_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2para__update_8c" id="_2_users_2mhewitt_2python_2source_2para__update_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="283,169,327,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="351,169,413,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="437,169,511,196"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="535,169,597,196"/>
</map>
</div>
</div>
<p><a href="para__update_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8524049a103b57e15825aa63f08e667e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="para__update_8c.html#a8524049a103b57e15825aa63f08e667e">communicate_estimators_para</a> ()</td></tr>
<tr class="memdesc:a8524049a103b57e15825aa63f08e667e"><td class="mdescLeft">&#160;</td><td class="mdescRight">communicates the MC estimators between tasks  <a href="#a8524049a103b57e15825aa63f08e667e">More...</a><br /></td></tr>
<tr class="separator:a8524049a103b57e15825aa63f08e667e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7869aa7674de4defa57e532b23d3a2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="para__update_8c.html#ab7869aa7674de4defa57e532b23d3a2d">gather_spectra_para</a> (int nspec_helper, int nspecs)</td></tr>
<tr class="memdesc:ab7869aa7674de4defa57e532b23d3a2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">sum up the synthetic spectra between threads.  <a href="#ab7869aa7674de4defa57e532b23d3a2d">More...</a><br /></td></tr>
<tr class="separator:ab7869aa7674de4defa57e532b23d3a2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f23b6db628c0b7e87354f1007ac3a77"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="para__update_8c.html#a3f23b6db628c0b7e87354f1007ac3a77">communicate_matom_estimators_para</a> ()</td></tr>
<tr class="separator:a3f23b6db628c0b7e87354f1007ac3a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>routines for communicating MC estimators and spectra between MPI threads. </p>
<dl class="section author"><dt>Author</dt><dd>ksl, jm </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="para__update_8c_source.html">para_update.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8524049a103b57e15825aa63f08e667e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8524049a103b57e15825aa63f08e667e">&#9670;&nbsp;</a></span>communicate_estimators_para()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int communicate_estimators_para </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>communicates the MC estimators between tasks </p>
<p>communicates the MC estimators between tasks relating to spectral models, heating and cooling and cell diagnostics like IP. In the case of some variables, the quantities are maxima and minima so the flag MPI_MAX or MPI_MIN is used in MPI_Reduce. For summed quantities like heating we use MPI_SUM.</p>
<p>This routine should only do anything if the MPI_ON flag was present in compilation. It communicates all the information required for the spectral model ionization scheme, and also heating and cooling quantities in cells. </p>

<p class="definition">Definition at line <a class="el" href="para__update_8c_source.html#l00035">35</a> of file <a class="el" href="para__update_8c_source.html">para_update.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="para__update_8c_a8524049a103b57e15825aa63f08e667e_cgraph.png" border="0" usemap="#para__update_8c_a8524049a103b57e15825aa63f08e667e_cgraph" alt=""/></div>
<map name="para__update_8c_a8524049a103b57e15825aa63f08e667e_cgraph" id="para__update_8c_a8524049a103b57e15825aa63f08e667e_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9" title="In addition to writing to the diag file, print a message to the screen from all threads. " alt="" coords="212,5,288,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="para__update_8c_a8524049a103b57e15825aa63f08e667e_icgraph.png" border="0" usemap="#para__update_8c_a8524049a103b57e15825aa63f08e667e_icgraph" alt=""/></div>
<map name="para__update_8c_a8524049a103b57e15825aa63f08e667e_icgraph" id="para__update_8c_a8524049a103b57e15825aa63f08e667e_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="212,5,321,32"/>
</map>
</div>

</div>
</div>
<a id="a3f23b6db628c0b7e87354f1007ac3a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f23b6db628c0b7e87354f1007ac3a77">&#9670;&nbsp;</a></span>communicate_matom_estimators_para()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int communicate_matom_estimators_para </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>averages the macro-atom estimators between tasks using MPI_Reduce. It should only be called if the MPI_ON flag was present in compilation, and returns 0 immediately if no macro atom levels. This should probably be improved by working out exactly what is needed in simple-ion only mode. </p>

<p class="definition">Definition at line <a class="el" href="para__update_8c_source.html#l00349">349</a> of file <a class="el" href="para__update_8c_source.html">para_update.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_cgraph.png" border="0" usemap="#para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_cgraph" alt=""/></div>
<map name="para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_cgraph" id="para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="267,5,305,32"/>
<area shape="rect" id="node4" href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9" title="In addition to writing to the diag file, print a message to the screen from all threads. " alt="" coords="248,56,324,83"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="372,5,429,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_icgraph.png" border="0" usemap="#para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_icgraph" alt=""/></div>
<map name="para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_icgraph" id="para__update_8c_a3f23b6db628c0b7e87354f1007ac3a77_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="248,5,357,32"/>
</map>
</div>

</div>
</div>
<a id="ab7869aa7674de4defa57e532b23d3a2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7869aa7674de4defa57e532b23d3a2d">&#9670;&nbsp;</a></span>gather_spectra_para()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gather_spectra_para </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nspec_helper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nspecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sum up the synthetic spectra between threads. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nspecs number of spectra to compute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nspec_helper the length of the big arrays to help with the MPI reductions of the spectra equal to 2 * number of spectra (NSPEC) * number of wavelengths.</td></tr>
  </table>
  </dd>
</dl>
<p>sum up the synthetic spectra between threads. Does an MPI_Reduce then an MPI_Bcast for each element of the linear and log spectra arrays (xxspec) </p>

<p class="definition">Definition at line <a class="el" href="para__update_8c_source.html#l00286">286</a> of file <a class="el" href="para__update_8c_source.html">para_update.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="para__update_8c_ab7869aa7674de4defa57e532b23d3a2d_icgraph.png" border="0" usemap="#para__update_8c_ab7869aa7674de4defa57e532b23d3a2d_icgraph" alt=""/></div>
<map name="para__update_8c_ab7869aa7674de4defa57e532b23d3a2d_icgraph" id="para__update_8c_ab7869aa7674de4defa57e532b23d3a2d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="168,5,277,32"/>
<area shape="rect" id="node3" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="180,56,265,83"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="para__update_8c.html">para_update.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
