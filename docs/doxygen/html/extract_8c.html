<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/extract.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('extract_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">extract.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Maing routines for extracting photons during the spectral generation phase.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for extract.c:</div>
<div class="dyncontent">
<div class="center"><img src="extract_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2extract_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2extract_8c" id="_2_users_2mhewitt_2python_2source_2extract_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="extract_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a280fcbb3dddfaf58a73b2a8d6fd61c76"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="extract_8c.html#a280fcbb3dddfaf58a73b2a8d6fd61c76">extract</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, int itype)</td></tr>
<tr class="memdesc:a280fcbb3dddfaf58a73b2a8d6fd61c76"><td class="mdescLeft">&#160;</td><td class="mdescRight">A supervisory routine called to builds detailed spectra in the normal (extract) mode.  <a href="#a280fcbb3dddfaf58a73b2a8d6fd61c76">More...</a><br /></td></tr>
<tr class="separator:a280fcbb3dddfaf58a73b2a8d6fd61c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aaecc045729b48d2ede700108567dcd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="extract_8c.html#a1aaecc045729b48d2ede700108567dcd">extract_one</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> pp, int itype, int nspec)</td></tr>
<tr class="memdesc:a1aaecc045729b48d2ede700108567dcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">(w,pp,itype,nspec)  <a href="#a1aaecc045729b48d2ede700108567dcd">More...</a><br /></td></tr>
<tr class="separator:a1aaecc045729b48d2ede700108567dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Maing routines for extracting photons during the spectral generation phase. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="extract_8c_source.html">extract.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a280fcbb3dddfaf58a73b2a8d6fd61c76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a280fcbb3dddfaf58a73b2a8d6fd61c76">&#9670;&nbsp;</a></span>extract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int extract </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>itype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A supervisory routine called to builds detailed spectra in the normal (extract) mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WindPtr</td><td>w The entire wind </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p The photon to extract </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>itype An integer representing the type of photon for the purpose of being extracted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>extract is called when a photon begins it's flight and every time that photon scatters, unless the user has exercised the "live or die" option, in which case it is not called.</p>
<p>extract carries out several preperatory steps for the extraction and for each spectrum one wants to build, it calls extract_one, where the actual incrementing of the spectrum is done.</p>
<p>itype takes on the following values:</p><ul>
<li>PTYPE_STAR-&gt;the photon came for the star</li>
<li>PTYPE_BL-&gt;the photon came from the boundary layer</li>
<li>PTYPE_DISK-&gt;the photon being redirected arose in the disk,</li>
<li>PTYPE_WIND-&gt;the photon being redirected arose in the wind,</li>
</ul>
<p>extract uses the types to prepare the photon for extraction, including doppler shifting the photon if is of PTYPE_WIND or PTYPE_STAR</p>
<p>Usually, Python constructs a spectrum of all photons, but there are advanced options which allone to restict the spectrum created to those produced with a certain number of scatters or from photons that arise from the above or below the disk. extract enforces those choices before calling extract_one. The parameters for this option all come in through <a class="el" href="python_8h.html">python.h</a>, and are contained in the spectrum structure.</p>
<p>The basic choices, some of which can be used in tandom are as follows:</p>
<ul>
<li>If s[n].nscat&gt;999; then one obtains the entire spectrum</li>
<li>if s[n].nscat is a positive number, then the spectrum is composed just of photons with that number of scatters</li>
<li>if s[n].nscat is a negative number, then the spectrum contains all photons with &gt;= the absolute value of s[n].nscat</li>
<li>s[n].top_bot=0 -&gt; accept all photons</li>
<li>s[n].top_bot &gt;0 -&gt; accept photons last above the disk</li>
<li>s[n].top_bot &lt;0 -&gt; accept photons below the disk</li>
<li>One can also select photons that are to be extracted from a particular spherical region. <h3>Notes</h3>
</li>
</ul>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000024">Bug:</a></b></dt><dd>This routine as well as extract_one have options for tracking the photon history. The routines are in <a class="el" href="diag_8c.html" title="consolidates an approach to providing extra diagnositcs for debugging python, Some of the diagnostics...">diag.c</a> It is not clear that they have been used in a long time and so it may be worthwhile to remove them. Furthermore, we have established a new mechanism save_phot for essentially this same task. This really should be consolidated. </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000025">Bug:</a></b></dt><dd>This is also commented in the text, but there is a rather bizarre separation for where the photon frequency is updated and where the weight is update. The former is done in extract, while the latter is done in extract_one. This is not an error precisely but makes the code more confusing than it needs to be.</dd></dl>

<p class="definition">Definition at line <a class="el" href="extract_8c_source.html#l00149">149</a> of file <a class="el" href="extract_8c_source.html">extract.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_cgraph.png" border="0" usemap="#extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_cgraph" alt=""/></div>
<map name="extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_cgraph" id="extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="485,7,535,33"/>
<area shape="rect" id="node3" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="489,260,531,287"/>
<area shape="rect" id="node4" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="477,311,543,337"/>
<area shape="rect" id="node5" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="484,209,536,236"/>
<area shape="rect" id="node6" href="disk_8c.html#a29076b6a07403d62872baf4dc9bf9346" title="Calculate the speed and velocity v at which material given specific position in the disk..." alt="" coords="143,133,188,160"/>
<area shape="rect" id="node10" href="foo_8h.html#a792efbef440470b9aad57a0d687a8915" title="doppler" alt="" coords="137,665,193,692"/>
<area shape="rect" id="node11" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="131,716,199,743"/>
<area shape="rect" id="node12" href="diag_8c.html#ad9812264d4df596406d5878299e8b7e5" title="saves informations about phtoons in a particulare wavelength gange " alt="" coords="105,767,225,793"/>
<area shape="rect" id="node13" href="extract_8c.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="128,615,203,641"/>
<area shape="rect" id="node44" href="poltest_8c.html#ae9b9c59a63a9198ee9a8ff81c1daa922" title="poltest" alt="" coords="139,817,191,844"/>
<area shape="rect" id="node7" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="314,159,363,185"/>
<area shape="rect" id="node8" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="316,57,361,84"/>
<area shape="rect" id="node9" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="312,311,365,337"/>
<area shape="rect" id="node14" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="491,665,529,692"/>
<area shape="rect" id="node15" href="anisowind_8c.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="299,513,379,540"/>
<area shape="rect" id="node18" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="482,767,538,793"/>
<area shape="rect" id="node22" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="953,513,997,540"/>
<area shape="rect" id="node35" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="304,665,373,692"/>
<area shape="rect" id="node36" href="foo_8h.html#adc18086c9912f51dae0f13aef98278de" title="p) attempts to assure that a photon is not scattered a second time inappropriately by the same transi..." alt="" coords="306,716,371,743"/>
<area shape="rect" id="node37" href="foo_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="297,817,381,844"/>
<area shape="rect" id="node38" href="foo_8h.html#a56bcc4eb80e38e626fe58bb5c989eafd" title="Record the history of a single photon bundle, in terms of a series of photon structures that are popu..." alt="" coords="307,868,370,895"/>
<area shape="rect" id="node39" href="balance__templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="309,969,369,996"/>
<area shape="rect" id="node40" href="balance__templates_8h.html#a56740476af61734dee90b4090f004971" title="walls" alt="" coords="317,1020,361,1047"/>
<area shape="rect" id="node41" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="939,665,1012,692"/>
<area shape="rect" id="node42" href="foo_8h.html#a30c0a9051caebba27b5ef5583d38ad0c" title="Preps a single photon to be dumped. " alt="" coords="285,1071,393,1097"/>
<area shape="rect" id="node43" href="foo_8h.html#ac53d695fcce14d5ae685028c7e7280ce" title="The next routine is designed to update a portion of the PlasmaPtr to reflect where photons along the ..." alt="" coords="273,1121,404,1148"/>
<area shape="rect" id="node16" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="452,513,568,540"/>
<area shape="rect" id="node17" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="467,564,553,591"/>
<area shape="rect" id="node19" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="454,463,566,489"/>
<area shape="rect" id="node32" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="937,311,1013,337"/>
<area shape="rect" id="node34" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="636,260,704,287"/>
<area shape="rect" id="node20" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="616,463,724,489"/>
<area shape="rect" id="node21" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="797,412,864,439"/>
<area shape="rect" id="node31" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="772,361,889,388"/>
<area shape="rect" id="node33" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="781,513,881,540"/>
<area shape="rect" id="node29" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="956,361,995,388"/>
<area shape="rect" id="node30" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="941,412,1009,439"/>
<area shape="rect" id="node23" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1431,513,1488,540"/>
<area shape="rect" id="node24" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="1061,513,1135,540"/>
<area shape="rect" id="node25" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1183,564,1272,591"/>
<area shape="rect" id="node28" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1205,513,1249,540"/>
<area shape="rect" id="node26" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1332,615,1371,641"/>
<area shape="rect" id="node27" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1320,564,1383,591"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_icgraph.png" border="0" usemap="#extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_icgraph" alt=""/></div>
<map name="extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_icgraph" id="extract_8c_a280fcbb3dddfaf58a73b2a8d6fd61c76_icgraph">
<area shape="rect" id="node2" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="255,31,324,57"/>
<area shape="rect" id="node5" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="105,56,207,83"/>
<area shape="rect" id="node3" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="372,5,481,32"/>
<area shape="rect" id="node4" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="384,56,469,83"/>
</map>
</div>

</div>
</div>
<a id="a1aaecc045729b48d2ede700108567dcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aaecc045729b48d2ede700108567dcd">&#9670;&nbsp;</a></span>extract_one()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int extract_one </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>itype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nspec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(w,pp,itype,nspec) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w The entire wind </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>pp The photon to be extracted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>itype The type of photon (star, disk, wind, etc) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nspec the spectrum which will be incremented </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The photon status after translation</dd></dl>
<p>extract_one is analogous to the detailed portion of transphot except here the basic point is to calculate the optical depth through the plasma in a certain direction, and to increment the appropriate spectrum.</p>
<p>Unlike trans_phot, this routine also checks to see if whether the photon hits the secondary star, if one exists.</p>
<h3>Notes</h3>
<p>The logic behind the weighting of the photons is described in Christian Knigge's thesis in section 2.3.4. According to equation 2.19 Pc/Pw=12 cos(theta)*(1+b cos(theta)/(3+2b) where b=1.5 corresponds to the Eddington approximation.</p>
<p>In Python, and in extract and transphot in particular, tau generally refers to the tau associated with scattering processes, and the weight contains the effect of dimunition of the energy of the photon bundle due to pure absorption processes. So, in extract, we add pp-&gt;w * exp(-tau) to the spectrum.</p>
<p>Note that both linearly and logarithmically spaced spectra are produced. </p>

<p class="definition">Definition at line <a class="el" href="extract_8c_source.html#l00307">307</a> of file <a class="el" href="extract_8c_source.html">extract.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="extract_8c_a1aaecc045729b48d2ede700108567dcd_cgraph.png" border="0" usemap="#extract_8c_a1aaecc045729b48d2ede700108567dcd_cgraph" alt=""/></div>
<map name="extract_8c_a1aaecc045729b48d2ede700108567dcd_cgraph" id="extract_8c_a1aaecc045729b48d2ede700108567dcd_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="332,99,397,126"/>
<area shape="rect" id="node3" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="339,150,391,176"/>
<area shape="rect" id="node4" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="167,99,220,126"/>
<area shape="rect" id="node5" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="345,200,384,227"/>
<area shape="rect" id="node6" href="anisowind_8c.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="153,302,233,328"/>
<area shape="rect" id="node11" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="337,656,393,683"/>
<area shape="rect" id="node15" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="808,302,852,328"/>
<area shape="rect" id="node28" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="159,352,228,379"/>
<area shape="rect" id="node29" href="foo_8h.html#adc18086c9912f51dae0f13aef98278de" title="p) attempts to assure that a photon is not scattered a second time inappropriately by the same transi..." alt="" coords="161,403,226,430"/>
<area shape="rect" id="node30" href="foo_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="151,454,235,480"/>
<area shape="rect" id="node31" href="foo_8h.html#a56bcc4eb80e38e626fe58bb5c989eafd" title="Record the history of a single photon bundle, in terms of a series of photon structures that are popu..." alt="" coords="162,504,225,531"/>
<area shape="rect" id="node32" href="balance__templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="163,555,223,582"/>
<area shape="rect" id="node33" href="balance__templates_8h.html#a56740476af61734dee90b4090f004971" title="walls" alt="" coords="171,606,215,632"/>
<area shape="rect" id="node34" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="793,200,867,227"/>
<area shape="rect" id="node35" href="foo_8h.html#a30c0a9051caebba27b5ef5583d38ad0c" title="Preps a single photon to be dumped. " alt="" coords="139,707,247,734"/>
<area shape="rect" id="node36" href="foo_8h.html#ac53d695fcce14d5ae685028c7e7280ce" title="The next routine is designed to update a portion of the PlasmaPtr to reflect where photons along the ..." alt="" coords="128,758,259,784"/>
<area shape="rect" id="node7" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="307,454,423,480"/>
<area shape="rect" id="node8" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="343,504,386,531"/>
<area shape="rect" id="node9" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="322,251,407,278"/>
<area shape="rect" id="node10" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="340,302,389,328"/>
<area shape="rect" id="node12" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="309,403,421,430"/>
<area shape="rect" id="node25" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="792,504,868,531"/>
<area shape="rect" id="node27" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="491,555,559,582"/>
<area shape="rect" id="node13" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="471,403,579,430"/>
<area shape="rect" id="node14" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="652,403,719,430"/>
<area shape="rect" id="node24" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="627,454,744,480"/>
<area shape="rect" id="node26" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="635,302,735,328"/>
<area shape="rect" id="node22" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="811,454,849,480"/>
<area shape="rect" id="node23" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="796,403,864,430"/>
<area shape="rect" id="node16" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1285,352,1343,379"/>
<area shape="rect" id="node17" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="916,302,989,328"/>
<area shape="rect" id="node18" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1037,302,1127,328"/>
<area shape="rect" id="node21" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1060,352,1104,379"/>
<area shape="rect" id="node19" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1187,302,1225,328"/>
<area shape="rect" id="node20" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1175,251,1237,278"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="extract_8c_a1aaecc045729b48d2ede700108567dcd_icgraph.png" border="0" usemap="#extract_8c_a1aaecc045729b48d2ede700108567dcd_icgraph" alt=""/></div>
<map name="extract_8c_a1aaecc045729b48d2ede700108567dcd_icgraph" id="extract_8c_a1aaecc045729b48d2ede700108567dcd_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="128,31,180,57"/>
<area shape="rect" id="node3" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="377,31,447,57"/>
<area shape="rect" id="node6" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="228,56,329,83"/>
<area shape="rect" id="node4" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="495,5,604,32"/>
<area shape="rect" id="node5" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="507,56,592,83"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="extract_8c.html">extract.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
