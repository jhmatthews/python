<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/spherical.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('spherical_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">spherical.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>These are generic routines for setting up 1d spherical coordinate system, as well as a special case of this the so-called shell-wind model.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for spherical.c:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2spherical_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2spherical_8c" id="_2_users_2mhewitt_2python_2source_2spherical_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="spherical_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a95d55ebfa2f2f1bd14867ad6a6cc9bfb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#a95d55ebfa2f2f1bd14867ad6a6cc9bfb">RESOLUTION</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:a95d55ebfa2f2f1bd14867ad6a6cc9bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3810d91d16158ce91d1247c4df1ede09"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#a3810d91d16158ce91d1247c4df1ede09">spherical_ds_in_cell</a> (int ndom, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p)</td></tr>
<tr class="memdesc:a3810d91d16158ce91d1247c4df1ede09"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the distance to the far boundary of the cell in which the photon bundle resides.  <a href="#a3810d91d16158ce91d1247c4df1ede09">More...</a><br /></td></tr>
<tr class="separator:a3810d91d16158ce91d1247c4df1ede09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc3da46eefcdd64c79fd792439a5b53d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#abc3da46eefcdd64c79fd792439a5b53d">spherical_make_grid</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, int ndom)</td></tr>
<tr class="memdesc:abc3da46eefcdd64c79fd792439a5b53d"><td class="mdescLeft">&#160;</td><td class="mdescRight">defines the cells in a spherical grid  <a href="#abc3da46eefcdd64c79fd792439a5b53d">More...</a><br /></td></tr>
<tr class="separator:abc3da46eefcdd64c79fd792439a5b53d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223201f3c894676560fbd4d94e71c167"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#a223201f3c894676560fbd4d94e71c167">spherical_wind_complete</a> (int ndom, <a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w)</td></tr>
<tr class="memdesc:a223201f3c894676560fbd4d94e71c167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize some arrays in a domain for a spherical system that are used in various interpolation routines.  <a href="#a223201f3c894676560fbd4d94e71c167">More...</a><br /></td></tr>
<tr class="separator:a223201f3c894676560fbd4d94e71c167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6dbd2946a218d14cf553a59e41d189"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#a1c6dbd2946a218d14cf553a59e41d189">spherical_volumes</a> (int ndom, <a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w)</td></tr>
<tr class="memdesc:a1c6dbd2946a218d14cf553a59e41d189"><td class="mdescLeft">&#160;</td><td class="mdescRight">spherical_volume(w) calculates the wind volume of cell allowing for the fact that some cells are partially in the wind  <a href="#a1c6dbd2946a218d14cf553a59e41d189">More...</a><br /></td></tr>
<tr class="separator:a1c6dbd2946a218d14cf553a59e41d189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8f81bf23594ec53e0dad81c86d7e3c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#af8f81bf23594ec53e0dad81c86d7e3c5">spherical_where_in_grid</a> (int ndom, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="memdesc:af8f81bf23594ec53e0dad81c86d7e3c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">locates the element in wmain corrosponding to a position when one is using spherical coordinates.  <a href="#af8f81bf23594ec53e0dad81c86d7e3c5">More...</a><br /></td></tr>
<tr class="separator:af8f81bf23594ec53e0dad81c86d7e3c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadfbcaed1dc773ebb991e922722a5267"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#aadfbcaed1dc773ebb991e922722a5267">spherical_get_random_location</a> (int n, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</td></tr>
<tr class="separator:aadfbcaed1dc773ebb991e922722a5267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5300254db561924aba1c13186be975"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#a6c5300254db561924aba1c13186be975">spherical_extend_density</a> (int ndom, <a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w)</td></tr>
<tr class="memdesc:a6c5300254db561924aba1c13186be975"><td class="mdescLeft">&#160;</td><td class="mdescRight">extends the density to regions just outside the wind regiions so that extrapolations of density can be made there  <a href="#a6c5300254db561924aba1c13186be975">More...</a><br /></td></tr>
<tr class="separator:a6c5300254db561924aba1c13186be975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df8af4539e5836b6a2f8dab9f88572e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spherical_8c.html#a1df8af4539e5836b6a2f8dab9f88572e">shell_make_grid</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, int ndom)</td></tr>
<tr class="memdesc:a1df8af4539e5836b6a2f8dab9f88572e"><td class="mdescLeft">&#160;</td><td class="mdescRight">defines the cells in a thin shell, a special case of a spherical wind.  <a href="#a1df8af4539e5836b6a2f8dab9f88572e">More...</a><br /></td></tr>
<tr class="separator:a1df8af4539e5836b6a2f8dab9f88572e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>These are generic routines for setting up 1d spherical coordinate system, as well as a special case of this the so-called shell-wind model. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a95d55ebfa2f2f1bd14867ad6a6cc9bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d55ebfa2f2f1bd14867ad6a6cc9bfb">&#9670;&nbsp;</a></span>RESOLUTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESOLUTION&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00245">245</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1df8af4539e5836b6a2f8dab9f88572e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1df8af4539e5836b6a2f8dab9f88572e">&#9670;&nbsp;</a></span>shell_make_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shell_make_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>defines the cells in a thin shell, a special case of a spherical wind. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WindPtr</td><td>w The structure which defines the wind in Python </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>ndom The domain number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always retunrs 0</dd></dl>
<p>The shell wind has 3 elements, one inside the shell, one outside, and one outside and one shell exactly fitting the shell.</p>
<h3>Notes</h3>
<p>The shell wind is intended for diagnostic purposes </p>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00585">585</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_cgraph.png" border="0" usemap="#spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_cgraph" alt=""/></div>
<map name="spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_cgraph" id="spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="148,5,187,32"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="235,5,292,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_icgraph.png" border="0" usemap="#spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_icgraph" alt=""/></div>
<map name="spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_icgraph" id="spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="148,5,224,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="272,5,316,32"/>
</map>
</div>

</div>
</div>
<a id="a3810d91d16158ce91d1247c4df1ede09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3810d91d16158ce91d1247c4df1ede09">&#9670;&nbsp;</a></span>spherical_ds_in_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double spherical_ds_in_cell </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the distance to the far boundary of the cell in which the photon bundle resides. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain in which the photon resides </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p Photon pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Distance to the far boundary of the cell in which the photon currently resides. Negative numbers (and zero) should be regarded as errors.</dd></dl>
<p>The routine simply determines which grid cell the photon is in and then solves two quadradic equations for the distance to the inner and outer boundary of the cell. The routine returns the smallest positive distance.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00084">84</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_a3810d91d16158ce91d1247c4df1ede09_cgraph.png" border="0" usemap="#spherical_8c_a3810d91d16158ce91d1247c4df1ede09_cgraph" alt=""/></div>
<map name="spherical_8c_a3810d91d16158ce91d1247c4df1ede09_cgraph" id="spherical_8c_a3810d91d16158ce91d1247c4df1ede09_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="165,5,251,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="186,56,230,83"/>
<area shape="rect" id="node10" href="foo_8h.html#a67e3cb7a7d0cd3d55277fc4f3373fe2e" title="Calculate the pathlenth along a line of sight defined by a photon p to a sphere centered on the origi..." alt="" coords="167,107,249,133"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="668,69,725,96"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="299,95,372,121"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="420,81,509,108"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="443,132,487,159"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="569,69,608,96"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="557,120,620,147"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_a3810d91d16158ce91d1247c4df1ede09_icgraph.png" border="0" usemap="#spherical_8c_a3810d91d16158ce91d1247c4df1ede09_icgraph" alt=""/></div>
<map name="spherical_8c_a3810d91d16158ce91d1247c4df1ede09_icgraph" id="spherical_8c_a3810d91d16158ce91d1247c4df1ede09_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#afee395233fbca5e632fd3ef51106f74c" title="calculates the distance photon can travel within the cell that it is currently in. " alt="" coords="165,31,232,57"/>
<area shape="rect" id="node3" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="280,5,385,32"/>
<area shape="rect" id="node5" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="283,56,383,83"/>
<area shape="rect" id="node4" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="433,31,493,57"/>
</map>
</div>

</div>
</div>
<a id="a6c5300254db561924aba1c13186be975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c5300254db561924aba1c13186be975">&#9670;&nbsp;</a></span>spherical_extend_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spherical_extend_density </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>extends the density to regions just outside the wind regiions so that extrapolations of density can be made there </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w The enetire wind </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>In order for density to be continuous within the grid, and to enable linear interpolation everwhere, we need to define a density in the guard cells inside and outside the wind region.</p>
<p>This routine accomplishes this by assignining an element in the plasma structure to the guard cells.</p>
<h3>Notes</h3>
<p>In principle one could interpolate on any of the prameters in the plasma stucture, but in reality the main thing this is used for is to assure tha ion denisites are continuous. </p>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00516">516</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>

</div>
</div>
<a id="aadfbcaed1dc773ebb991e922722a5267"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadfbcaed1dc773ebb991e922722a5267">&#9670;&nbsp;</a></span>spherical_get_random_location()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spherical_get_random_location </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>n &ndash; Cell in which random position is to be generated </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>x[] A random position in the cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The retine generally returns W_ALL_IN_WIND</dd></dl>
<p>The routine generates random positions within a spherical cell and returns when it finds a position that is in the wind region.</p>
<h3>Notes</h3>
<p>Comment: This routine has no protection against the possibility that the cell is not at least partially in the wind. </p>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00448">448</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_aadfbcaed1dc773ebb991e922722a5267_cgraph.png" border="0" usemap="#spherical_8c_aadfbcaed1dc773ebb991e922722a5267_cgraph" alt=""/></div>
<map name="spherical_8c_aadfbcaed1dc773ebb991e922722a5267_cgraph" id="spherical_8c_aadfbcaed1dc773ebb991e922722a5267_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="203,5,242,32"/>
<area shape="rect" id="node3" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530" title="Translate a cell number in the wind to the two&#45;d grid position in a specific domain. " alt="" coords="184,56,261,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="175,107,271,133"/>
<area shape="rect" id="node5" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="178,157,267,184"/>
</map>
</div>

</div>
</div>
<a id="abc3da46eefcdd64c79fd792439a5b53d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc3da46eefcdd64c79fd792439a5b53d">&#9670;&nbsp;</a></span>spherical_make_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spherical_make_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>defines the cells in a spherical grid </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w The structure which defines the wind in Python </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine defines the boundaries of cells for a spherical grid in the appropriate parts of the wind domain In spherical coordinates w runs from 0 to n.</p>
<h3>Notes</h3>
<p>The centers of the grid cells are defined in the xz plane at a 45 degree angle. This was done so that one would be in a plausible region of a biconical wind. </p>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00144">144</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_cgraph.png" border="0" usemap="#spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_cgraph" alt=""/></div>
<map name="spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_cgraph" id="spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="168,5,236,32"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="284,5,341,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_icgraph.png" border="0" usemap="#spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_icgraph" alt=""/></div>
<map name="spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_icgraph" id="spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="168,5,244,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="292,5,336,32"/>
</map>
</div>

</div>
</div>
<a id="a1c6dbd2946a218d14cf553a59e41d189"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6dbd2946a218d14cf553a59e41d189">&#9670;&nbsp;</a></span>spherical_volumes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spherical_volumes </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>spherical_volume(w) calculates the wind volume of cell allowing for the fact that some cells are partially in the wind </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom the domain number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w the entire wind </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine performs a simple 2d numerical integration to find out what fraction of a shell is in the wind of a specfic domain and uses this to calculate the volume that is in the wind.</p>
<h3>Notes</h3>
<p>The volume of edge cells are all set to 0 </p>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00272">272</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_cgraph.png" border="0" usemap="#spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_cgraph" alt=""/></div>
<map name="spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_cgraph" id="spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#af8c5f231035fc1a85000b9849b4fb0ed" title="fraction" alt="" coords="176,5,231,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99" title="where_in_wind" alt="" coords="159,56,248,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_icgraph.png" border="0" usemap="#spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_icgraph" alt=""/></div>
<map name="spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_icgraph" id="spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="159,5,235,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="283,5,327,32"/>
</map>
</div>

</div>
</div>
<a id="af8f81bf23594ec53e0dad81c86d7e3c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8f81bf23594ec53e0dad81c86d7e3c5">&#9670;&nbsp;</a></span>spherical_where_in_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spherical_where_in_grid </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>locates the element in wmain corrosponding to a position when one is using spherical coordinates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom The domain number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] The postion </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the number of wind element associated with a position.</dd></dl>
<p>If the position is in the grid this will be a positive number. If s is inside the grid -1 will be returned, if x is outsice the domain -2 will be returned</p>
<h3>Notes</h3>
<p>speherical_where_in grid does not tell you whether the x is in the wind or not.</p>
<p>What one means by inside or outside the grid may well be different for different coordinate systems.</p>
<p>This routine is not normally used directly. Instead it is called via where_in_grid which determines the specific where_in_grid routine to call, depending on the coordinate system. </p>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00391">391</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5_cgraph.png" border="0" usemap="#spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5_cgraph" alt=""/></div>
<map name="spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5_cgraph" id="spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="187,5,236,32"/>
<area shape="rect" id="node3" href="foo_8h.html#af8c5f231035fc1a85000b9849b4fb0ed" title="fraction" alt="" coords="184,56,239,83"/>
</map>
</div>

</div>
</div>
<a id="a223201f3c894676560fbd4d94e71c167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223201f3c894676560fbd4d94e71c167">&#9670;&nbsp;</a></span>spherical_wind_complete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spherical_wind_complete </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize some arrays in a domain for a spherical system that are used in various interpolation routines. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>ndom A domain which has a spherical grid defined </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w the entire wind </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Alwasy returns 0</dd></dl>
<p>This simple little routine just populates one dimensional arrays that are used for interpolation.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="spherical_8c_source.html#l00219">219</a> of file <a class="el" href="spherical_8c_source.html">spherical.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="spherical_8c_a223201f3c894676560fbd4d94e71c167_icgraph.png" border="0" usemap="#spherical_8c_a223201f3c894676560fbd4d94e71c167_icgraph" alt=""/></div>
<map name="spherical_8c_a223201f3c894676560fbd4d94e71c167_icgraph" id="spherical_8c_a223201f3c894676560fbd4d94e71c167_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a635decc081c41b8ab55d8b547408970a" title="Use the imported data to initialize various portions of the Wind and Domain structures. " alt="" coords="188,5,303,47"/>
<area shape="rect" id="node3" href="windsave_8c.html#ad5c30455dbf640e7a5d68132a8e4a5c5" title="A driver routine that calls coordinate&#45;system specific routines that complete the descirption of the ..." alt="" coords="201,71,290,98"/>
<area shape="rect" id="node4" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="351,46,427,73"/>
<area shape="rect" id="node6" href="windsave_8c.html#a1bf368d85f72b220cc4cba091a5e0702" title="Read back the windsavefile. " alt="" coords="355,97,423,123"/>
<area shape="rect" id="node5" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="475,46,519,73"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="spherical_8c.html">spherical.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
