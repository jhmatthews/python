<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/cdf.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('cdf_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cdf.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines to create a cumulatimve distribution (CDF) from a function or array, and then to sample that cdf in a fleximble manner.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="models_8h_source.html">models.h</a>&quot;</code><br />
<code>#include &lt;gsl/gsl_sort.h&gt;</code><br />
<code>#include &lt;gsl/gsl_interp.h&gt;</code><br />
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br />
<code>#include &lt;gsl/gsl_randist.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cdf.c:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2cdf_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2cdf_8c" id="_2_users_2mhewitt_2python_2source_2cdf_8c">
<area shape="rect" id="node4" href="atomic_8h.html" title="atomic.h" alt="" coords="160,95,220,121"/>
<area shape="rect" id="node5" href="python_8h.html" title="python.h" alt="" coords="244,95,304,121"/>
<area shape="rect" id="node10" href="models_8h.html" title="models.h" alt="" coords="328,95,391,121"/>
<area shape="rect" id="node6" href="log_8h.html" title="log.h" alt="" coords="128,169,172,196"/>
<area shape="rect" id="node7" href="version_8h.html" title="version.h" alt="" coords="196,169,259,196"/>
<area shape="rect" id="node8" href="templates_8h.html" title="templates.h" alt="" coords="283,169,356,196"/>
<area shape="rect" id="node9" href="recipes_8h.html" title="recipes.h" alt="" coords="380,169,443,196"/>
</map>
</div>
</div>
<p><a href="cdf_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0eb2d38b53bd0577b2f9a302702a765c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a0eb2d38b53bd0577b2f9a302702a765c">PDFSTEPS</a>&#160;&#160;&#160;10000</td></tr>
<tr class="memdesc:a0eb2d38b53bd0577b2f9a302702a765c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the initial value of PDFSTEPS.  <a href="#a0eb2d38b53bd0577b2f9a302702a765c">More...</a><br /></td></tr>
<tr class="separator:a0eb2d38b53bd0577b2f9a302702a765c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0100482896d5d68afe86c8bb601ddba6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a0100482896d5d68afe86c8bb601ddba6">PDF_ARRAY</a>&#160;&#160;&#160;28000</td></tr>
<tr class="separator:a0100482896d5d68afe86c8bb601ddba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a759a0a027603baae4d61eed58031a71b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b">cdf_gen_from_func</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf, double(*)(double) func, double xmin, double xmax, int njumps, <a class="el" href="continuum_8c.html#a47bb97973150c998d469697784328f6e">jump</a>)</td></tr>
<tr class="memdesc:a759a0a027603baae4d61eed58031a71b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a cumulative distrubution function (cdf) from a function.  <a href="#a759a0a027603baae4d61eed58031a71b">More...</a><br /></td></tr>
<tr class="separator:a759a0a027603baae4d61eed58031a71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ee1475eba79ff70c6b97c836df25c7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7">gen_array_from_func</a> (double(*)(double) func, double xmin, double xmax, int pdfsteps)</td></tr>
<tr class="memdesc:a55ee1475eba79ff70c6b97c836df25c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">generates a cdf from a function  <a href="#a55ee1475eba79ff70c6b97c836df25c7">More...</a><br /></td></tr>
<tr class="separator:a55ee1475eba79ff70c6b97c836df25c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6add58a19448dc0dde8f4bc4bbc46cc8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8">cdf_gen_from_array</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, y, int n_xy, double xmin, double xmax)</td></tr>
<tr class="memdesc:a6add58a19448dc0dde8f4bc4bbc46cc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a cumulative distribution function (cdf) from an array of values.  <a href="#a6add58a19448dc0dde8f4bc4bbc46cc8">More...</a><br /></td></tr>
<tr class="separator:a6add58a19448dc0dde8f4bc4bbc46cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd473cda634a93562f9162b5c0c5f06"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06">cdf_get_rand</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf)</td></tr>
<tr class="memdesc:a6cd473cda634a93562f9162b5c0c5f06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a single sample from a cdf.  <a href="#a6cd473cda634a93562f9162b5c0c5f06">More...</a><br /></td></tr>
<tr class="separator:a6cd473cda634a93562f9162b5c0c5f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb77ca29971f4b21ea483ab1672e652"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#aecb77ca29971f4b21ea483ab1672e652">cdf_limit</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf, double xmin, double xmax)</td></tr>
<tr class="memdesc:aecb77ca29971f4b21ea483ab1672e652"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets limit1 and limit2 so that one can generate distributions from a limited range within a previously created cdf.  <a href="#aecb77ca29971f4b21ea483ab1672e652">More...</a><br /></td></tr>
<tr class="separator:aecb77ca29971f4b21ea483ab1672e652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab79e837935267ae9f6061620404f000e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#ab79e837935267ae9f6061620404f000e">cdf_get_rand_limit</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf)</td></tr>
<tr class="memdesc:ab79e837935267ae9f6061620404f000e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a random number for a cdf inside limits set by cdf_limit.  <a href="#ab79e837935267ae9f6061620404f000e">More...</a><br /></td></tr>
<tr class="separator:ab79e837935267ae9f6061620404f000e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e0e0d8ba68a00590abef9754c8ea6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b">cdf_to_file</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf, filename)</td></tr>
<tr class="memdesc:a31e0e0d8ba68a00590abef9754c8ea6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the full structure of the cumulattive distribution function to a file.  <a href="#a31e0e0d8ba68a00590abef9754c8ea6b">More...</a><br /></td></tr>
<tr class="separator:a31e0e0d8ba68a00590abef9754c8ea6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e83990b5cf236827414abe43bee911"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911">cdf_check</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf)</td></tr>
<tr class="memdesc:ac8e83990b5cf236827414abe43bee911"><td class="mdescLeft">&#160;</td><td class="mdescRight">a simple routine to check some basics of the cumulative distribution function.  <a href="#ac8e83990b5cf236827414abe43bee911">More...</a><br /></td></tr>
<tr class="separator:ac8e83990b5cf236827414abe43bee911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30c0717640ef307cbe5489ec9ef911f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5">calc_cdf_gradient</a> (<a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a> cdf)</td></tr>
<tr class="memdesc:a30c0717640ef307cbe5489ec9ef911f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points.  <a href="#a30c0717640ef307cbe5489ec9ef911f5">More...</a><br /></td></tr>
<tr class="separator:a30c0717640ef307cbe5489ec9ef911f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55984373c219b38477d5dafb44c2e336"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a55984373c219b38477d5dafb44c2e336">cdf_array_fixup</a> (double *<a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, double *y, int n_xy)</td></tr>
<tr class="memdesc:a55984373c219b38477d5dafb44c2e336"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given two paralel arrays, x and y, this routine reorders the array in ascending order of x.  <a href="#a55984373c219b38477d5dafb44c2e336">More...</a><br /></td></tr>
<tr class="separator:a55984373c219b38477d5dafb44c2e336"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a343a93e72865e903cfe3ce0f69361db5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a343a93e72865e903cfe3ce0f69361db5">pdf_steps_current</a></td></tr>
<tr class="memdesc:a343a93e72865e903cfe3ce0f69361db5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the value of pdfsteps at this point in time.  <a href="#a343a93e72865e903cfe3ce0f69361db5">More...</a><br /></td></tr>
<tr class="separator:a343a93e72865e903cfe3ce0f69361db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474b5aa096196458745709eb60b2ad20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a474b5aa096196458745709eb60b2ad20">init_pdf</a> = 0</td></tr>
<tr class="memdesc:a474b5aa096196458745709eb60b2ad20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to say whether structures to hold a cdf have been initialised.  <a href="#a474b5aa096196458745709eb60b2ad20">More...</a><br /></td></tr>
<tr class="separator:a474b5aa096196458745709eb60b2ad20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8977edf5d3fd4c68f5627235db8ca564"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a8977edf5d3fd4c68f5627235db8ca564">pdf_array</a></td></tr>
<tr class="memdesc:a8977edf5d3fd4c68f5627235db8ca564"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to pdf_array - made external because it is used in varous routines.  <a href="#a8977edf5d3fd4c68f5627235db8ca564">More...</a><br /></td></tr>
<tr class="separator:a8977edf5d3fd4c68f5627235db8ca564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fde0c6951fb53dc1672b1d6e14efe6f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a8fde0c6951fb53dc1672b1d6e14efe6f">pdf_x</a> [<a class="el" href="cdf_8c.html#a0100482896d5d68afe86c8bb601ddba6">PDF_ARRAY</a>]</td></tr>
<tr class="separator:a8fde0c6951fb53dc1672b1d6e14efe6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd5f32c7826172a1eb9ea2f2ad45ce7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a1bd5f32c7826172a1eb9ea2f2ad45ce7">pdf_y</a> [<a class="el" href="cdf_8c.html#a0100482896d5d68afe86c8bb601ddba6">PDF_ARRAY</a>]</td></tr>
<tr class="separator:a1bd5f32c7826172a1eb9ea2f2ad45ce7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48989ccc668bffbc0f0fc84526341d53"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a48989ccc668bffbc0f0fc84526341d53">pdf_z</a> [<a class="el" href="cdf_8c.html#a0100482896d5d68afe86c8bb601ddba6">PDF_ARRAY</a>]</td></tr>
<tr class="separator:a48989ccc668bffbc0f0fc84526341d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a99ffa2f02388ef6442afddfdef0c31"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdf_8c.html#a7a99ffa2f02388ef6442afddfdef0c31">pdf_n</a></td></tr>
<tr class="separator:a7a99ffa2f02388ef6442afddfdef0c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines to create a cumulatimve distribution (CDF) from a function or array, and then to sample that cdf in a fleximble manner. </p>
<dl class="section author"><dt>Author</dt><dd>ksl,nsh </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March, 2018</dd></dl>
<p>CDFs can be generated either from a function using cdf_gen_from_func or from an array using cdf gen_from_array. The function or the array that is input are used as the proability densities for the cdfs. The cdfs are stored in a <a class="el" href="struct_cdf.html">Cdf</a> structure (See <a class="el" href="python_8h.html">python.h</a>)</p>
<p>The procedure is either to call cdf_gen_from_func if you have a function whose probability distribution you want (as might be the case if you were generating bremsstrahlung photons and you knew the formula) or cdf_gen_from_array (as might be the case if you were trying to generate Monte Carlo spectra from precalculated Kurucz models).</p>
<p>Once the cdfs are generated one can sample the full distribution distritution function with cdf_get_rand, or one can sample a part of the distribution by setting the part that one wants with cdf_limit and then sampling the distribution with cdf_get_rand_limit</p>
<p>There are a number of helper functions that are internal to the generation of the cdfs, and verification that the cdfs are readonable.</p>
<h3>Notes</h3>
<p>In generating the CDFs, one must be careful of places where the pdf is discontinuous, or more generally changing in a way that will not be well represented via linear interpolations. When generating a CDF from a function it is possible to specify positions where one wishes to have points, e.g on either side of a discontinuity. When generating a CDF from a function, the discontinuities should be well sampled in the array that is provided.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000006">Bug:</a></b></dt><dd>For reasons, which are currently unclear there are differences in the number of points maintained in the cdfs for different generation methods.</dd></dl>

<p class="definition">Definition in file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0100482896d5d68afe86c8bb601ddba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0100482896d5d68afe86c8bb601ddba6">&#9670;&nbsp;</a></span>PDF_ARRAY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PDF_ARRAY&#160;&#160;&#160;28000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00366">366</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="a0eb2d38b53bd0577b2f9a302702a765c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eb2d38b53bd0577b2f9a302702a765c">&#9670;&nbsp;</a></span>PDFSTEPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PDFSTEPS&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the initial value of PDFSTEPS. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00053">53</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a30c0717640ef307cbe5489ec9ef911f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30c0717640ef307cbe5489ec9ef911f5">&#9670;&nbsp;</a></span>calc_cdf_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calc_cdf_gradient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CdfPtr</td><td>cdf A ptr to a cdf structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Normally returns 0; a positive return indicates a problem</dd></dl>
<p>Calculate the gradient of a cdf at each point in the cdf array in oder to allow one to calculate a first order correction to a uniform distibution between the points where the gradient has been calculated.</p>
<h3>Notes</h3>
<p>The gradients are calculated by differencing the cdf. Thus this routine should work both for cdf's calculated from functions and from arrays</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000007">Bug:</a></b></dt><dd>XXX NSH - the way that the ends are dealt with is not great - we should really try to come up with an extrapolation rather than just fill in the same gradients for the second and penultimate cells into the first and last cells.</dd></dl>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l01038">1038</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_cgraph.png" border="0" usemap="#cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_cgraph" alt=""/></div>
<map name="cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_cgraph" id="cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="153,25,197,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="615,25,672,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="245,51,319,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="367,37,456,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="389,88,433,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="516,25,555,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="504,76,567,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_icgraph.png" border="0" usemap="#cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_icgraph" alt=""/></div>
<map name="cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_icgraph" id="cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_icgraph">
<area shape="rect" id="node2" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="153,293,261,320"/>
<area shape="rect" id="node24" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="309,344,421,371"/>
<area shape="rect" id="node3" href="templates_8h.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="309,180,421,207"/>
<area shape="rect" id="node18" href="templates_8h.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="489,287,540,313"/>
<area shape="rect" id="node22" href="templates_8h.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="321,420,410,447"/>
<area shape="rect" id="node23" href="random_8c.html#a773dffa7060439d58d12e63aa47e6945" title="randvcos" alt="" coords="334,293,397,320"/>
<area shape="rect" id="node4" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="483,180,546,207"/>
<area shape="rect" id="node11" href="templates_8h.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="475,80,555,107"/>
<area shape="rect" id="node5" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="613,233,709,260"/>
<area shape="rect" id="node8" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="614,183,707,209"/>
<area shape="rect" id="node9" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="608,81,713,108"/>
<area shape="rect" id="node10" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="635,132,687,159"/>
<area shape="rect" id="node6" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="761,360,837,387"/>
<area shape="rect" id="node7" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="899,360,973,387"/>
<area shape="rect" id="node12" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="623,31,698,57"/>
<area shape="rect" id="node13" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="773,31,825,57"/>
<area shape="rect" id="node14" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="1035,31,1104,57"/>
<area shape="rect" id="node17" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="885,56,987,83"/>
<area shape="rect" id="node15" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="1152,5,1261,32"/>
<area shape="rect" id="node16" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="1164,56,1249,83"/>
<area shape="rect" id="node19" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="615,436,707,463"/>
<area shape="rect" id="node20" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="615,385,707,412"/>
<area shape="rect" id="node21" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="615,335,707,361"/>
<area shape="rect" id="node25" href="templates_8h.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="469,388,560,415"/>
<area shape="rect" id="node26" href="templates_8h.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="490,236,539,263"/>
<area shape="rect" id="node28" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="489,337,541,364"/>
<area shape="rect" id="node27" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="641,284,681,311"/>
</map>
</div>

</div>
</div>
<a id="a55984373c219b38477d5dafb44c2e336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55984373c219b38477d5dafb44c2e336">&#9670;&nbsp;</a></span>cdf_array_fixup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cdf_array_fixup </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_xy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given two paralel arrays, x and y, this routine reorders the array in ascending order of x. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>* x The array that is sorted </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>* y The parallel array that is sorted in order of x </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>n_xy The length of the two arrays </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The length of the input array</dd></dl>
<p>This routine is a routine that is intended to fix a potential problem with an input pdf, which one is intending to convert into a cdf. The cdf genearion routines assume that an input routine is in ascending order of the x variable, often a freqency. The y variable is usually an unnormalized pdf. This routine checks that the x variables is indeed in ascending order and if not reorders the two arrays.</p>
<h3>Notes</h3>
<p>The routine makes an assumption about what one wants if the x array contains two x values that are identical. It assumes one wants to the value with the lower corresponding pdf value to be first in the output arrays (as is genearlly the case whn one has a sharp jump for a photoionization x-section. This will generate a at the upper edge of a square wave. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l01114">1114</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="ac8e83990b5cf236827414abe43bee911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e83990b5cf236827414abe43bee911">&#9670;&nbsp;</a></span>cdf_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cdf_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>a simple routine to check some basics of the cumulative distribution function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">CdfPtr</td><td>cdf A ptr to a cdf structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if eveything is OK, a positive number otherwise</dd></dl>
<p>This is a diagnostic designed to see whether a cdf is reasonable</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00916">916</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_ac8e83990b5cf236827414abe43bee911_cgraph.png" border="0" usemap="#cdf_8c_ac8e83990b5cf236827414abe43bee911_cgraph" alt=""/></div>
<map name="cdf_8c_ac8e83990b5cf236827414abe43bee911_cgraph" id="cdf_8c_ac8e83990b5cf236827414abe43bee911_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="132,125,176,152"/>
<area shape="rect" id="node9" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="253,176,292,202"/>
<area shape="rect" id="node10" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="120,226,188,253"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="605,74,663,101"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="236,125,309,152"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="357,74,447,101"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="380,125,424,152"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="507,24,545,50"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="495,74,557,101"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_ac8e83990b5cf236827414abe43bee911_icgraph.png" border="0" usemap="#cdf_8c_ac8e83990b5cf236827414abe43bee911_icgraph" alt=""/></div>
<map name="cdf_8c_ac8e83990b5cf236827414abe43bee911_icgraph" id="cdf_8c_ac8e83990b5cf236827414abe43bee911_icgraph">
<area shape="rect" id="node2" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="120,293,228,320"/>
<area shape="rect" id="node24" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="276,344,388,371"/>
<area shape="rect" id="node3" href="templates_8h.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="276,180,388,207"/>
<area shape="rect" id="node18" href="templates_8h.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="456,287,507,313"/>
<area shape="rect" id="node22" href="templates_8h.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="287,420,377,447"/>
<area shape="rect" id="node23" href="random_8c.html#a773dffa7060439d58d12e63aa47e6945" title="randvcos" alt="" coords="301,293,363,320"/>
<area shape="rect" id="node4" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="450,180,513,207"/>
<area shape="rect" id="node11" href="templates_8h.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="441,80,521,107"/>
<area shape="rect" id="node5" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="579,233,675,260"/>
<area shape="rect" id="node8" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="581,183,674,209"/>
<area shape="rect" id="node9" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="575,81,680,108"/>
<area shape="rect" id="node10" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="601,132,653,159"/>
<area shape="rect" id="node6" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="728,360,804,387"/>
<area shape="rect" id="node7" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="865,360,940,387"/>
<area shape="rect" id="node12" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="590,31,665,57"/>
<area shape="rect" id="node13" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="740,31,792,57"/>
<area shape="rect" id="node14" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="1001,31,1071,57"/>
<area shape="rect" id="node17" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="852,56,953,83"/>
<area shape="rect" id="node15" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="1119,5,1228,32"/>
<area shape="rect" id="node16" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="1131,56,1216,83"/>
<area shape="rect" id="node19" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="581,436,673,463"/>
<area shape="rect" id="node20" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="581,385,673,412"/>
<area shape="rect" id="node21" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="581,335,673,361"/>
<area shape="rect" id="node25" href="templates_8h.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="436,388,527,415"/>
<area shape="rect" id="node26" href="templates_8h.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="457,236,506,263"/>
<area shape="rect" id="node28" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="455,337,507,364"/>
<area shape="rect" id="node27" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="607,284,647,311"/>
</map>
</div>

</div>
</div>
<a id="a6add58a19448dc0dde8f4bc4bbc46cc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6add58a19448dc0dde8f4bc4bbc46cc8">&#9670;&nbsp;</a></span>cdf_gen_from_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cdf_gen_from_array </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">y&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_xy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a cumulative distribution function (cdf) from an array of values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cdf</td><td>Pointer to the cdf that will be populated here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Locations of points in supplied data - usually wavelength or freuency </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Data - e.g. cross section or emissivity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_xy</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xmin</td><td>Lower limit to required cdf </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xmin</td><td>Upper limit to required cdf </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>echeck the reutrn value from cdf_check</dd></dl>
<p>Takes two arrays of some values of a function y at locations x and turns it into a cumlative density function to allow random values to be obtained from the function. There is no resampling.</p>
<h3>Notes</h3>
<p>cdf_gen_from_array does not have the concept of jumps. All of this needs to be taken care of by the routine that generates the array.</p>
<p>In constructing the cdf the routine collapses regions of the pdf that have zero probability of occuring </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00403">403</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_cgraph.png" border="0" usemap="#cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_cgraph" alt=""/></div>
<map name="cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_cgraph" id="cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="325,31,369,57"/>
<area shape="rect" id="node9" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="165,5,265,32"/>
<area shape="rect" id="node10" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="182,107,249,133"/>
<area shape="rect" id="node11" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="328,157,367,184"/>
<area shape="rect" id="node12" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="313,208,381,235"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="799,81,856,108"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="429,31,503,57"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="551,81,640,108"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="573,31,617,57"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="700,132,739,159"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="688,81,751,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_icgraph.png" border="0" usemap="#cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_icgraph" alt=""/></div>
<map name="cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_icgraph" id="cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="165,81,256,108"/>
<area shape="rect" id="node8" href="templates_8h.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="186,157,235,184"/>
<area shape="rect" id="node11" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="185,208,237,235"/>
<area shape="rect" id="node3" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="306,5,398,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="306,56,398,83"/>
<area shape="rect" id="node7" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="306,107,398,133"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="448,81,524,108"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="572,81,647,108"/>
<area shape="rect" id="node9" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="304,157,400,184"/>
<area shape="rect" id="node10" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="332,208,372,235"/>
</map>
</div>

</div>
</div>
<a id="a759a0a027603baae4d61eed58031a71b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a759a0a027603baae4d61eed58031a71b">&#9670;&nbsp;</a></span>cdf_gen_from_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cdf_gen_from_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double (*) (double)&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>njumps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="continuum_8c.html#a47bb97973150c998d469697784328f6e">jump</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a cumulative distrubution function (cdf) from a function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">CdfPtr</td><td>cdf A ptr to a cdf structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>*func The probablility density function to be integrated to create the pdf </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>xmin,xmax The range over which the function is to be integrated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>njumps The number of points at which we want to force a break in the cdf </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>jump an array of points in the x-corrdinates at which we want to force points </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on successful completion,</dd></dl>
<p>This routine allows one to generate a CDF from a function. It is used to make photons from blackbody and bremstrahlung sources and also to sample things like cosine functions for directions of generated photons.</p>
<h3>Notes</h3>
<p>The jumps are used to force points in the CDF at certain values of X. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00090">90</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a759a0a027603baae4d61eed58031a71b_cgraph.png" border="0" usemap="#cdf_8c_a759a0a027603baae4d61eed58031a71b_cgraph" alt=""/></div>
<map name="cdf_8c_a759a0a027603baae4d61eed58031a71b_cgraph" id="cdf_8c_a759a0a027603baae4d61eed58031a71b_cgraph">
<area shape="rect" id="node2" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="187,56,253,83"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="339,157,383,184"/>
<area shape="rect" id="node12" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="161,107,279,133"/>
<area shape="rect" id="node14" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="170,208,270,235"/>
<area shape="rect" id="node10" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="341,56,380,83"/>
<area shape="rect" id="node11" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="327,5,395,32"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="815,157,872,184"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="444,157,517,184"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="567,157,656,184"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="589,107,633,133"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="716,208,755,235"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="704,157,767,184"/>
<area shape="rect" id="node13" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="443,107,519,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a759a0a027603baae4d61eed58031a71b_icgraph.png" border="0" usemap="#cdf_8c_a759a0a027603baae4d61eed58031a71b_icgraph" alt=""/></div>
<map name="cdf_8c_a759a0a027603baae4d61eed58031a71b_icgraph" id="cdf_8c_a759a0a027603baae4d61eed58031a71b_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="161,157,273,184"/>
<area shape="rect" id="node17" href="templates_8h.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="336,335,387,361"/>
<area shape="rect" id="node21" href="templates_8h.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="173,284,262,311"/>
<area shape="rect" id="node22" href="random_8c.html#a773dffa7060439d58d12e63aa47e6945" title="randvcos" alt="" coords="186,385,249,412"/>
<area shape="rect" id="node3" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="330,157,393,184"/>
<area shape="rect" id="node10" href="templates_8h.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="321,69,401,96"/>
<area shape="rect" id="node4" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="454,233,550,260"/>
<area shape="rect" id="node7" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="455,81,549,108"/>
<area shape="rect" id="node8" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="449,132,555,159"/>
<area shape="rect" id="node9" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="476,183,528,209"/>
<area shape="rect" id="node5" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="603,309,679,336"/>
<area shape="rect" id="node6" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="740,309,815,336"/>
<area shape="rect" id="node11" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="465,31,539,57"/>
<area shape="rect" id="node12" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="615,31,667,57"/>
<area shape="rect" id="node13" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="876,31,945,57"/>
<area shape="rect" id="node16" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="727,56,828,83"/>
<area shape="rect" id="node14" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="993,5,1103,32"/>
<area shape="rect" id="node15" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="1005,56,1091,83"/>
<area shape="rect" id="node18" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="456,284,548,311"/>
<area shape="rect" id="node19" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="456,385,548,412"/>
<area shape="rect" id="node20" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="456,335,548,361"/>
</map>
</div>

</div>
</div>
<a id="a6cd473cda634a93562f9162b5c0c5f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd473cda634a93562f9162b5c0c5f06">&#9670;&nbsp;</a></span>cdf_get_rand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cdf_get_rand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a single sample from a cdf. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CdfPtr</td><td>cdf a structure which contains the cumulative distribution function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x a random value fronm the cdf between xmin and xmax</dd></dl>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00652">652</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_cgraph.png" border="0" usemap="#cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_cgraph" alt=""/></div>
<map name="cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_cgraph" id="cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_cgraph">
<area shape="rect" id="node2" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="147,5,215,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="133,56,229,83"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="159,107,203,133"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="647,107,704,133"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="277,132,351,159"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="399,119,488,145"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="421,169,465,196"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="548,107,587,133"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="536,157,599,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_icgraph.png" border="0" usemap="#cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_icgraph" alt=""/></div>
<map name="cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_icgraph" id="cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_icgraph">
<area shape="rect" id="node2" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="147,107,210,133"/>
<area shape="rect" id="node9" href="templates_8h.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="133,259,224,285"/>
<area shape="rect" id="node13" href="templates_8h.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="154,208,203,235"/>
<area shape="rect" id="node15" href="random_8c.html#a773dffa7060439d58d12e63aa47e6945" title="randvcos" alt="" coords="147,309,210,336"/>
<area shape="rect" id="node16" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="153,360,205,387"/>
<area shape="rect" id="node3" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="277,157,373,184"/>
<area shape="rect" id="node6" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="278,107,371,133"/>
<area shape="rect" id="node7" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="272,5,377,32"/>
<area shape="rect" id="node8" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="299,56,351,83"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="425,284,501,311"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="549,284,624,311"/>
<area shape="rect" id="node10" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="279,259,371,285"/>
<area shape="rect" id="node11" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="279,309,371,336"/>
<area shape="rect" id="node12" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="279,360,371,387"/>
<area shape="rect" id="node14" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="305,208,345,235"/>
</map>
</div>

</div>
</div>
<a id="ab79e837935267ae9f6061620404f000e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab79e837935267ae9f6061620404f000e">&#9670;&nbsp;</a></span>cdf_get_rand_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cdf_get_rand_limit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get a random number for a cdf inside limits set by cdf_limit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">CdfPtr</td><td>cdf A ptr to a cdf structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A random number drawn from the <a class="el" href="struct_cdf.html">Cdf</a>, but within inside limits which have been set previously</dd></dl>
<p>The basic idea here is that we have created a cdf that covers a broad range of, for example, frequncy space. At this point we want photons that only cover some portion of the broad range. Instead of creating a new cdf that just covers a desired frequency space, we only sample a portion of the broad range as defined by cdf_limit (for this particular cdf)</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00818">818</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_ab79e837935267ae9f6061620404f000e_cgraph.png" border="0" usemap="#cdf_8c_ab79e837935267ae9f6061620404f000e_cgraph" alt=""/></div>
<map name="cdf_8c_ab79e837935267ae9f6061620404f000e_cgraph" id="cdf_8c_ab79e837935267ae9f6061620404f000e_cgraph">
<area shape="rect" id="node2" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="171,5,239,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="157,56,253,83"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="183,107,227,133"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="671,107,728,133"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="301,132,375,159"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="423,119,512,145"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="445,169,489,196"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="572,107,611,133"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="560,157,623,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_ab79e837935267ae9f6061620404f000e_icgraph.png" border="0" usemap="#cdf_8c_ab79e837935267ae9f6061620404f000e_icgraph" alt=""/></div>
<map name="cdf_8c_ab79e837935267ae9f6061620404f000e_icgraph" id="cdf_8c_ab79e837935267ae9f6061620404f000e_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="177,56,227,83"/>
<area shape="rect" id="node8" href="templates_8h.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="157,5,247,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="295,5,387,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="295,56,387,83"/>
<area shape="rect" id="node7" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="295,107,387,133"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="435,56,511,83"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="559,56,633,83"/>
</map>
</div>

</div>
</div>
<a id="aecb77ca29971f4b21ea483ab1672e652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecb77ca29971f4b21ea483ab1672e652">&#9670;&nbsp;</a></span>cdf_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cdf_limit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets limit1 and limit2 so that one can generate distributions from a limited range within a previously created cdf. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CdfPtr</td><td>cdf A ptr to a cdf structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>xmin The minimum value to return </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>xmax The maximum value to return </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>We have defined the cdf in such a way that one can generate a random number 0 and 1, find the place in the y array that corresponds to this and map back onto the x values (which is what is returned. We now want to limit the range of the returned x values, but we need to know in terms of the original array where these values are and the generate a random number between some minimum (&gt;0) and maximum (&lt;1) whichi will allow one to find the x that corresponds. The point of this routine is to find that minimum and maximum value. Having done this one can call cdf_get_rand_limit</p>
<h3>Notes</h3>
<p>Sometimes it is expensive computationally to recalculate the distribution function every time you change the limits. An example of this is the distribution function for a bb where the distribution function is quite smooth (and can be represented in a dimensionless manner) but calculating the function and the distribution function can be expensive. This routine together with cdf_gen_rand_limit allow one to sample a part of a cdf. Note that cdf_gen-from_func or cdf_gen_from_array should have been called previously!</p>
<p>xmin and xmax will cause cdf[].limit1 and cdf[].limit2 to be set in such a way that when you call pdf_get_rand_limit the distribution will be sampled only between xmin and xmax.</p>
<p>If these routine is called improperly, e.g if xmin and xmax lie outside of the original value of xmin and xmax then the distribution will not extend this far, and the progrem will exit. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00735">735</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_aecb77ca29971f4b21ea483ab1672e652_cgraph.png" border="0" usemap="#cdf_8c_aecb77ca29971f4b21ea483ab1672e652_cgraph" alt=""/></div>
<map name="cdf_8c_aecb77ca29971f4b21ea483ab1672e652_cgraph" id="cdf_8c_aecb77ca29971f4b21ea483ab1672e652_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="112,25,156,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="573,25,631,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="204,51,277,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="325,37,415,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="348,88,392,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="475,25,513,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="463,76,525,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_aecb77ca29971f4b21ea483ab1672e652_icgraph.png" border="0" usemap="#cdf_8c_aecb77ca29971f4b21ea483ab1672e652_icgraph" alt=""/></div>
<map name="cdf_8c_aecb77ca29971f4b21ea483ab1672e652_icgraph" id="cdf_8c_aecb77ca29971f4b21ea483ab1672e652_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="131,56,182,83"/>
<area shape="rect" id="node8" href="templates_8h.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="112,5,201,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="249,5,341,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="249,56,341,83"/>
<area shape="rect" id="node7" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="249,107,341,133"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="389,56,465,83"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="513,56,588,83"/>
</map>
</div>

</div>
</div>
<a id="a31e0e0d8ba68a00590abef9754c8ea6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e0e0d8ba68a00590abef9754c8ea6b">&#9670;&nbsp;</a></span>cdf_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cdf_to_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a14b633e617b31ead523c75ce80cc56e1">CdfPtr</a>&#160;</td>
          <td class="paramname"><em>cdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">filename&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the full structure of the cumulattive distribution function to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CdfPtr</td><td>cdf A ptr to a cdf structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>filename[] The name of the file to which the cdf should be written </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This is a diagnostic routine</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00877">877</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b_icgraph.png" border="0" usemap="#cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b_icgraph" alt=""/></div>
<map name="cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b_icgraph" id="cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="427,284,477,311"/>
<area shape="rect" id="node8" href="cdf_8c.html#a6add58a19448dc0dde8f4bc4bbc46cc8" title="Generate a cumulative distribution function (cdf) from an array of values. " alt="" coords="236,259,348,285"/>
<area shape="rect" id="node14" href="templates_8h.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="121,208,188,235"/>
<area shape="rect" id="node3" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="556,284,648,311"/>
<area shape="rect" id="node6" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="556,335,648,361"/>
<area shape="rect" id="node7" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="556,385,648,412"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="849,309,925,336"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="987,309,1061,336"/>
<area shape="rect" id="node9" href="templates_8h.html#aca0d5b8835f560393ae64306e8f24ce3" title="get a photon frequency from a grid of stored spectra from a continuum grid " alt="" coords="407,385,497,412"/>
<area shape="rect" id="node10" href="templates_8h.html#af59091ae76131213b5c23a085d88eb1d" title="randomly generate the frequency of a ff photon within the frequency interval f1 and f2 ..." alt="" coords="427,183,477,209"/>
<area shape="rect" id="node13" href="templates_8h.html#a1e3f4af5624039f9a4937939331b5219" title="generates one free bound photon with specific frequency limits " alt="" coords="426,335,478,361"/>
<area shape="rect" id="node11" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="701,233,797,260"/>
<area shape="rect" id="node12" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="582,233,622,260"/>
<area shape="rect" id="node15" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="238,208,346,235"/>
<area shape="rect" id="node16" href="templates_8h.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="396,132,508,159"/>
<area shape="rect" id="node28" href="templates_8h.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="407,233,497,260"/>
<area shape="rect" id="node29" href="random_8c.html#a773dffa7060439d58d12e63aa47e6945" title="randvcos" alt="" coords="421,81,483,108"/>
<area shape="rect" id="node17" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="571,132,633,159"/>
<area shape="rect" id="node21" href="templates_8h.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="562,56,642,83"/>
<area shape="rect" id="node18" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="702,81,795,108"/>
<area shape="rect" id="node19" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="696,132,801,159"/>
<area shape="rect" id="node20" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="723,183,775,209"/>
<area shape="rect" id="node22" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="711,31,786,57"/>
<area shape="rect" id="node23" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="861,31,913,57"/>
<area shape="rect" id="node24" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="1123,31,1192,57"/>
<area shape="rect" id="node27" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="973,56,1075,83"/>
<area shape="rect" id="node25" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="1240,5,1349,32"/>
<area shape="rect" id="node26" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="1252,56,1337,83"/>
</map>
</div>

</div>
</div>
<a id="a55ee1475eba79ff70c6b97c836df25c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55ee1475eba79ff70c6b97c836df25c7">&#9670;&nbsp;</a></span>gen_array_from_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gen_array_from_func </td>
          <td>(</td>
          <td class="paramtype">double (*) (double)&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdfsteps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generates a cdf from a function </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>*func The probablility density function to be integrated to create the pdf </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>xmin,xmax; The range over which the function is to be integrated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>pdfsteps; number of steps that are calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>delta - the largest change in the cdf between any two points in the grid.</dd></dl>
<p>This is a routine which is called by cdf_gen_from_func which simply calculates the cumulative distribution of the function in equally spaced steps between xmin and xmax. The CDF is properly normalized.</p>
<h3>Notes</h3>
<p>10oct - ksl -This is rather brute force. An alternative would have been to have increased the density of points only in the region where it was needed. This could be done by looking at the regions where the sampling was poor in the initial calculation and addeding new points in in a new calculations. But this would require one to pass both the values of the CDF and the positions where the values were taken. This would be not be hard but would require more extensive modifications to pdf_gen_from func than currently. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00270">270</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_cgraph.png" border="0" usemap="#cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_cgraph" alt=""/></div>
<map name="cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_cgraph" id="cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="171,86,215,113"/>
<area shape="rect" id="node9" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="263,137,339,164"/>
<area shape="rect" id="node10" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="173,188,212,214"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="635,86,692,113"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="264,86,337,113"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="387,86,476,113"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="409,137,453,164"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="536,36,575,62"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="524,86,587,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_icgraph.png" border="0" usemap="#cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_icgraph" alt=""/></div>
<map name="cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_icgraph" id="cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_icgraph">
<area shape="rect" id="node2" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="171,309,279,336"/>
<area shape="rect" id="node3" href="templates_8h.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="327,157,439,184"/>
<area shape="rect" id="node18" href="templates_8h.html#a5f832b1ef434fdb41eaa62feb7edd710" title="returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits..." alt="" coords="501,335,552,361"/>
<area shape="rect" id="node22" href="templates_8h.html#aea33eee38cf4a6c25978443404ddaf2c" title="Obtain a random frequency photon from a bremstrahlung spectrum. " alt="" coords="338,284,427,311"/>
<area shape="rect" id="node23" href="random_8c.html#a773dffa7060439d58d12e63aa47e6945" title="randvcos" alt="" coords="351,385,414,412"/>
<area shape="rect" id="node4" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="495,157,558,184"/>
<area shape="rect" id="node11" href="templates_8h.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="487,69,567,96"/>
<area shape="rect" id="node5" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="619,233,715,260"/>
<area shape="rect" id="node8" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="621,81,714,108"/>
<area shape="rect" id="node9" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="615,132,720,159"/>
<area shape="rect" id="node10" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="641,183,693,209"/>
<area shape="rect" id="node6" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="768,309,844,336"/>
<area shape="rect" id="node7" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="905,309,980,336"/>
<area shape="rect" id="node12" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="630,31,705,57"/>
<area shape="rect" id="node13" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="780,31,832,57"/>
<area shape="rect" id="node14" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="1041,31,1111,57"/>
<area shape="rect" id="node17" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="892,56,993,83"/>
<area shape="rect" id="node15" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="1159,5,1268,32"/>
<area shape="rect" id="node16" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="1171,56,1256,83"/>
<area shape="rect" id="node19" href="templates_8h.html#a82dbda6e94577f3ecd6e55c085f2aa10" title="Generate a photon from an AGN object. " alt="" coords="621,284,713,311"/>
<area shape="rect" id="node20" href="templates_8h.html#a19e1b27b1fe040ccadcd39a5783c4d60" title="Generate nphot photons from the star in the frequency interval f1 to f2. " alt="" coords="621,385,713,412"/>
<area shape="rect" id="node21" href="templates_8h.html#ac6e59fd8ed9979322e86a14ed34c2851" title="Generate disk photons. " alt="" coords="621,335,713,361"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a474b5aa096196458745709eb60b2ad20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a474b5aa096196458745709eb60b2ad20">&#9670;&nbsp;</a></span>init_pdf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_pdf = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag to say whether structures to hold a cdf have been initialised. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00059">59</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="a8977edf5d3fd4c68f5627235db8ca564"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8977edf5d3fd4c68f5627235db8ca564">&#9670;&nbsp;</a></span>pdf_array</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* pdf_array</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to pdf_array - made external because it is used in varous routines. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00062">62</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="a7a99ffa2f02388ef6442afddfdef0c31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a99ffa2f02388ef6442afddfdef0c31">&#9670;&nbsp;</a></span>pdf_n</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pdf_n</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00369">369</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="a343a93e72865e903cfe3ce0f69361db5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a343a93e72865e903cfe3ce0f69361db5">&#9670;&nbsp;</a></span>pdf_steps_current</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pdf_steps_current</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the value of pdfsteps at this point in time. </p>

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00056">56</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="a8fde0c6951fb53dc1672b1d6e14efe6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fde0c6951fb53dc1672b1d6e14efe6f">&#9670;&nbsp;</a></span>pdf_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pdf_x[<a class="el" href="cdf_8c.html#a0100482896d5d68afe86c8bb601ddba6">PDF_ARRAY</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00368">368</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="a1bd5f32c7826172a1eb9ea2f2ad45ce7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bd5f32c7826172a1eb9ea2f2ad45ce7">&#9670;&nbsp;</a></span>pdf_y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pdf_y[<a class="el" href="cdf_8c.html#a0100482896d5d68afe86c8bb601ddba6">PDF_ARRAY</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00368">368</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
<a id="a48989ccc668bffbc0f0fc84526341d53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48989ccc668bffbc0f0fc84526341d53">&#9670;&nbsp;</a></span>pdf_z</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pdf_z[<a class="el" href="cdf_8c.html#a0100482896d5d68afe86c8bb601ddba6">PDF_ARRAY</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="cdf_8c_source.html#l00368">368</a> of file <a class="el" href="cdf_8c_source.html">cdf.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="cdf_8c.html">cdf.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
