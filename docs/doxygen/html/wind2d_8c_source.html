<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/wind2d.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('wind2d_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">wind2d.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="wind2d_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/***********************************************************/</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="atomic_8h.html">atomic.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="python_8h.html">python.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc">   43</a></span>&#160;<a class="code" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc">define_wind</a> ()</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>, <a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>, n;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> nn;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span> rrstar;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[3];</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">double</span> mdotbase, mdotwind, rr;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">int</span> ierr;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> n_vol, n_inwind, n_part;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> nwind, ndom;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> nstart, <a class="code" href="import__cylindrical_8c.html#a0d9c8cbc461c7cf86cad8e548f195bd1">ndim</a>, <a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> nplasma;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="structwind.html">WindPtr</a> w;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">/* Determine the size of the structure, we need to allocate</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">     from the individual domains and then allocatee the space */</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">     Setup the locations of starting and ending positions of the different</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">     domains for wmain.  The information is placed in zdom for later use.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">     Note that zdom[ndom].ndim, zdom[ndom].mdim, and zdom[ndom].ndim2 shold</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">     have been established in get_grid_params(ndom).</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  n = 0;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#aeddcae5f993efc8142ee84f461cfcda1">nstart</a> = n;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      n += <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ac90e4779abcabc0170d2bfc30a8e1323">ndim</a> * <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#aa557b63d514dffedaf76a635579b3294">mdim</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ab3733bfe4bcdd87edd4f59da33e85d46">nstop</a> = n;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">//PLACEHOLDER  we should not really need to define NDIM and MDIM here, we may need NDIM2</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="comment">/* NDIM2 here is the total dimensions of the grid, summed over all domains</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">         and is used to allocate the wind pointer */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a6f369fbf8e117ef039235b7f20d04e32">ndim2</a> = <a class="code" href="python_8h.html#abd3bd3747823216853035911ad285c91">NDIM2</a> += <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ac90e4779abcabc0170d2bfc30a8e1323">ndim</a> * <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#aa557b63d514dffedaf76a635579b3294">mdim</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="foo_8h.html#af3449f72ae22aca485dfaa4d2f5ae300">calloc_wind</a> (<a class="code" href="python_8h.html#abd3bd3747823216853035911ad285c91">NDIM2</a>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  w = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">/* Assign the domains to each cell */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">for</span> (n = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].nstart; n &lt; <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ab3733bfe4bcdd87edd4f59da33e85d46">nstop</a>; n++)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      w[n].<a class="code" href="structwind.html#aaa7f27e1a93690e4c37878a93c40db22">ndom</a> = ndom; <span class="comment">// Assign each wind cell to a domain</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">/* initialize inwind and dfudge to a known state for all wind cells */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#abd3bd3747823216853035911ad285c91">NDIM2</a>; n++)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      w[n].<a class="code" href="structwind.html#a7f4f2ec3bc9cea1d4dec351b026b9a73">inwind</a> = W_NOT_ASSIGNED;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      w[n].<a class="code" href="structwind.html#a9e48704d3e2881e8cd2fef227c0ba8cd">dfudge</a> = <a class="code" href="python_8h.html#afda1ac6937e9d82232d5d99159e6485d">DFUDGE</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Define wind coord_type %d for domain %d\n&quot;</span>, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type,</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       ndom);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type == <a class="code" href="python_8h.html#a773175d74e73776d69c3e538f17de1ee">IMPORT</a>) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;              <a class="code" href="foo_8h.html#a757c9acbab0a0377cc2757a853d168df">import_make_grid</a>(w,ndom);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;              }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type == <a class="code" href="python_8h.html#a0db8a9b5ad5a66e4adc36d0ba68735c8">SHELL</a>)   <span class="comment">/* nsh: This is the mode where we want the wind and the grid carefully</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">                           controlled to allow a very thin shell. We ensure that the coordinate type is spherical.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        (<span class="stringliteral">&quot;We are making a thin shell type grid to match a thin shell wind. This is totally aphysical and should only be used for testing purposes\n&quot;</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="foo_8h.html#a1df8af4539e5836b6a2f8dab9f88572e">shell_make_grid</a> (w, ndom);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="foo_8h.html#abc3da46eefcdd64c79fd792439a5b53d">spherical_make_grid</a> (w, ndom);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a>)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="cylindrical_8c.html#a56507e563e08709e70d77a7ccd538ee3">cylind_make_grid</a> (ndom, w);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495">RTHETA</a>)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type == <a class="code" href="python_8h.html#af1850805984fe5f20591259a19db6ffd">HYDRO</a>)    <span class="comment">/* 13jun -- nsh - 76 - This is a switch to allow one to use the</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">                           actual zeus grid in the special case of a &#39;proga&#39; wind in rtheta</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">                           coordinates</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <a class="code" href="foo_8h.html#a38134c43cdc9afb2ef078514b06b4f88">rtheta_make_hydro_grid</a> (w, ndom);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <a class="code" href="foo_8h.html#a4cb6c91545a34b48e5d6cd74a68665de">rtheta_make_grid</a> (w, ndom);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3">CYLVAR</a>)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="cylind__var_8c.html#a95a5dd7b17dd91fc7d21b44ee290d256">cylvar_make_grid</a> (w, ndom);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;define_wind: Don&#39;t know how to make coordinate type %d\n&quot;</span>,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">for</span> (n = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].nstart; n &lt; <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ab3733bfe4bcdd87edd4f59da33e85d46">nstop</a>; n++)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">/* For imported models we we have already set the velocities</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">         * at the edges of cells so this should not be done again</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type!=<a class="code" href="python_8h.html#a773175d74e73776d69c3e538f17de1ee">IMPORT</a>){</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <a class="code" href="foo_8h.html#a9ca1dd624c5f0c6c8a401a0e79d023b5">model_velocity</a> (ndom, w[n].x, w[n].<a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="foo_8h.html#a547dbd45aa816e77d574b6bf3deb6b65">model_vgrad</a> (ndom, w[n].x, w[n].v_grad);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="foo_8h.html#ad5c30455dbf640e7a5d68132a8e4a5c5">wind_complete</a> (w);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">/* Now determine the valid volumes of each cell and also determine whether the cells are in all</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">     or partially in the wind.</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="foo_8h.html#a1c6dbd2946a218d14cf553a59e41d189">spherical_volumes</a> (ndom, w);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a>)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="cylindrical_8c.html#a13144d35b1d57cfa570b6e59d225f474">cylind_volumes</a> (ndom, w);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495">RTHETA</a>)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">/* 13jun -- nsh - 76 - This is a switch to allow one to use</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">         the actual zeus grid in the special case of a &#39;proga&#39; wind</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">         in rtheta coordinates We dont need to work out if cells are</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">         in the wind, they are known to be in the wind. */</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type == <a class="code" href="python_8h.html#af1850805984fe5f20591259a19db6ffd">HYDRO</a>)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          <a class="code" href="foo_8h.html#a36f04216329e1a6ede98f9f9e0e3989b">rtheta_hydro_volumes</a> (ndom, w);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <a class="code" href="foo_8h.html#a16377719f4171d75f5aa983c79476590">rtheta_volumes</a> (ndom, w);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3">CYLVAR</a>)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="cylind__var_8c.html#a95334daf522cc6a4ac43e85e759f4a31">cylvar_volumes</a> (ndom, w);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        (<span class="stringliteral">&quot;define_wind: Don&#39;t know how to make volumes for coordinate type %d\n&quot;</span>,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">/* The routines above have established the volumes of the cells that are in the wind</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * and also assigned the variables w[].inwind at least insofar as the wind is concerned.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">/* Perform some consistency checks of the wind */</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a> = 0;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      n_vol = n_inwind = n_part = 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">for</span> (n = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].nstart; n &lt; <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ab3733bfe4bcdd87edd4f59da33e85d46">nstop</a>; n++)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">if</span> (w[n].vol &gt; 0.0)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        n_vol++;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">if</span> (w[n].<a class="code" href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a> == W_ALL_INWIND)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        n_inwind++;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">if</span> (w[n].<a class="code" href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a> == W_PART_INWIND)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        n_part++;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a> += n_vol;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    (<span class="stringliteral">&quot;wind2d: For domain %d there are %3d cells of which %d are in inwind, %d partially in_wind, &amp; %d with pos. vol\n&quot;</span>,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     ndom, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].ndim2, n_inwind, n_part, n_vol);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type != <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a> &amp;&amp; <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type != <a class="code" href="python_8h.html#a773175d74e73776d69c3e538f17de1ee">IMPORT</a>)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">for</span> (n = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].nstart; n &lt; <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ab3733bfe4bcdd87edd4f59da33e85d46">nstop</a>; n++)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          n_inwind = <a class="code" href="wind2d_8c.html#a80e38cc8054ee669104c30986700d508">check_corners_inwind</a> (n);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          <span class="keywordflow">if</span> (w[n].vol == 0 &amp;&amp; n_inwind &gt; 0)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          <a class="code" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a> (ndom, n, &amp;i, &amp;j);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            (<span class="stringliteral">&quot;wind2d: Cell %3d (%2d,%2d) in domain %d has %d corners in wind, but zero volume\n&quot;</span>,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;             n, i, j, ndom, n_inwind);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          w[n].<a class="code" href="structwind.html#a7f4f2ec3bc9cea1d4dec351b026b9a73">inwind</a> = W_IGNORE;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          <span class="keywordflow">if</span> (w[n].<a class="code" href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a> == W_PART_INWIND &amp;&amp; n_inwind == 4)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <a class="code" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a> (ndom, n, &amp;i, &amp;j);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            (<span class="stringliteral">&quot;wind2d: Cell %3d (%2d,%2d) in domain %d has 4 corners in wind, but is only partially in wind\n&quot;</span>,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;             n, i, j, ndom);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        (<span class="stringliteral">&quot;Not checking corners_in_wind for SPHERICAL coordinates used in domain %d\n&quot;</span>,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         ndom);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type == <a class="code" href="python_8h.html#a773175d74e73776d69c3e538f17de1ee">IMPORT</a>)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="comment">/* JM 1711 -- we don&#39;t want to check corners in the case of an imported model */</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        (<span class="stringliteral">&quot;Not checking corners_in_wind for imported model, domain %d\n&quot;</span>,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;         ndom);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">/* Now create the second structure, the one that is sized only to contain cells in the wind */</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">/* CHOICE is defined in the Makefile. XXX Really unclear that this option is needed.  Consider removing  ksl */</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="version_8h.html#a22995efd1bf00d607d61f25430f44db2">CHOICE</a> == 0)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a> = <a class="code" href="python_8h.html#abd3bd3747823216853035911ad285c91">NDIM2</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">/* Allocate space for the plasma arrays */</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="foo_8h.html#a391062d8b219dffc8496bd6fc8128cf6">calloc_plasma</a> (<a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="foo_8h.html#a311078e4d3e5530a996283eaf4c0fb19">calloc_dyn_plasma</a> (<a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>);  <span class="comment">/*78a NSH 1407 - allocate space for dynamically sized arrays */</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="foo_8h.html#a67af2cd841a922ea1001654449239284">create_maps</a> (<a class="code" href="version_8h.html#a22995efd1bf00d607d61f25430f44db2">CHOICE</a>);     <span class="comment">/* Populate the maps from plasmamain &amp; wmain */</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">/* JM 1502 -- we want the macro structure to be allocated in geo.rt_mode = RT_MODE_MACRO. see #138  */</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">rt_mode</a> == <a class="code" href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a>)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="foo_8h.html#a4b147244ba1a5d54d79a57a8ee665b18">calloc_macro</a> (<a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <a class="code" href="foo_8h.html#a43492c595dcd8568e2c14a8496c8fd43">calloc_estimators</a> (<a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">/* 06may -- At this point we have calculated the volumes of all of the cells and it should</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">be optional which variables beyond here are moved to structures othere than Wind */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">/* Now calculate parameters that need to be calculated at the center of the grid cell */</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; n++)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      nwind = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">nwind</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      ndom = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[nwind].<a class="code" href="structwind.html#aaa7f27e1a93690e4c37878a93c40db22">ndom</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340">stuff_v</a> (w[nwind].xcen, x);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="comment">/* Next two lines allow for clumping */</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> = <a class="code" href="foo_8h.html#a3055ceed3869697bc2a3091fd0663900">model_rho</a> (ndom, x) / <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#af919432b7fbe13685cae0fcbc98f4e8f">fill</a>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a469869b2b7b2a822716ac5a3ba58412a">vol</a> = w[nwind].<a class="code" href="structwind.html#a86864abe3bc4d97d1b4c305f085c6c55">vol</a> * <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#af919432b7fbe13685cae0fcbc98f4e8f">fill</a>;   <span class="comment">// Copy volumes</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">/* This is where we initialise the spectral models for the wind. */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">for</span> (nn = 0; nn &lt; <a class="code" href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a>; nn++)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a110b6efdc5fa932c21dc021047b35eea">spec_mod_type</a>[nn] = SPEC_MOD_FAIL;  <span class="comment">/*NSH 120817 - setting this to</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">                                   a negative number means that at the outset, we assume we do not have a</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">                                   suitable model for the cell */</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a30222105e41ccde304250f41d25b5ad7">exp_temp</a>[nn] = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a54d0a2d5699ed4af1353429a7ec652bb">tmax</a>;    <span class="comment">/*NSH 120817 - as an initial guess,</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">                               set this number to the hottest part of the model -</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">                               this should define where any exponential dropoff becomes important */</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b46e8bed0dfadca5cf9966301ecec6d">exp_w</a>[nn] = 0.0;    <span class="comment">/* 120817 Who knows what this should be! */</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a0dbad3f32ea372492eb73eda0f123899">pl_alpha</a>[nn] = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9a16f5c129fc954fd15b38e3cab8e12d">alpha_agn</a>;   <span class="comment">/*As an initial guess we assume the whole wind is</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">                               optically thin and so the spectral index for a PL illumination will be the</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">                               same everywhere.  */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aae85efc36fb767cfec53df4cd3327fe8">pl_log_w</a>[nn] = -1e99;   <span class="comment">/*131114 - a tiny weight - just to fill the variable */</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a79f84fac2bd8b8ee286bf33092531f18">fmin_mod</a>[nn] = 1e99;    <span class="comment">/* Set the minium model frequency to the max frequency in the band - means it will never be used which is correct at this time - there is no model */</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ab5b2a9cf34eb1359961d6783a81ea266">fmax_mod</a>[nn] = 1e-99;   <span class="comment">/* Set the maximum model frequency to the min frequency in the band */</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/* NSH 130530 Next few lines allow the use of the temperature which can be computed from Zeus models to be</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> * used as an initial guess for the wind temperature */</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_type == <a class="code" href="python_8h.html#af1850805984fe5f20591259a19db6ffd">HYDRO</a>)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a> = <a class="code" href="foo_8h.html#a9bbb384b23069ca08613aa2396fcbee3">hydro_temp</a> (x);   <span class="comment">//NSH 151126 - slight tidy up here - we now set t_e and t_r to hydro temp, t_e change is below//</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a> = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#abb5c7c693f6694c7060addeefc8bc9b8">twind_init</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">/* Initialize variables having to do with converence in initial stages */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#abd08d926f7b31dc9ddfaf5bc0c02de8f">gain</a> = 0.5;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a438272ea5c79f26453f113fe023e9c99">dt_e_old</a> = 0.0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a174c204665ec6522d9c1dad57408b577">dt_e</a> = 0.0;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">/* The next lines set the electrom temperature to 0.9 times the radiation temperature (which is a bit</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">      odd since the input is the wind temperature, but is taken to be the radiation temperature). If we have</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">      a fixed temprature calculation,then the wind temperature is set to be the wind temperature so the</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">      user gets what they are expecting */</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#aad0ff1589062988053354087930055bb">fixed_temp</a> == 0 &amp;&amp; <a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">zeus_connect</a> == 0) <span class="comment">//NSH 151126 - dont multply by 0.9 in zeus connect or fixed temp modes</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aefa8d272f5a54cae990359cccd67075d">t_e_old</a> = 0.9 * <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a>;    <span class="comment">//Lucy guess</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aefa8d272f5a54cae990359cccd67075d">t_e_old</a> = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a432a1f85db9000aac743588736fb6048">t_r</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">//If we want to fix the temperature, we set it to tr which has previously been set to twind.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/* Calculate an initial guess for the weight of the PL spectrum (constant / area of a sphere / 4pi) */</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      rrstar =</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    1. - (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7384383e4129a0341c5a1a27a68d7947">rstar</a> * <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7384383e4129a0341c5a1a27a68d7947">rstar</a>) / (x[0] * x[0] + x[1] * x[1] +</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    x[2] * x[2]);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (rrstar &gt; 0)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#adbf9689b61e3df7611084d858b3115c0">w</a> = 0.5 * (1 - sqrt (rrstar));</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#adbf9689b61e3df7611084d858b3115c0">w</a> = 0.5;  <span class="comment">//Modification to allow for possibility that grid point is inside star</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">/* Determine the initial ionizations, either LTE or  fixed_concentrations */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a98d8096a2c1b3144efd5899f25402f7d">ioniz_mode</a> != <a class="code" href="python_8h.html#a3f1d4b496aaedc6d1860048e675006ff">IONMODE_FIXED</a>)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    {           <span class="comment">/* Carry out an LTE determination of the ionization (using T_r */</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      ierr = <a class="code" href="foo_8h.html#a626b1882e2533441cdf2daabd36e8a8b">ion_abundances</a> (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n], <a class="code" href="python_8h.html#a91065d114e136045af17e48baa479753">IONMODE_LTE_TR</a>);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {           <span class="comment">/* Set the concentrations to specified values */</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      ierr = <a class="code" href="foo_8h.html#a626b1882e2533441cdf2daabd36e8a8b">ion_abundances</a> (&amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n], <a class="code" href="python_8h.html#a3f1d4b496aaedc6d1860048e675006ff">IONMODE_FIXED</a>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">if</span> (ierr != 0)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        (<span class="stringliteral">&quot;wind_define after ion_abundances: cell %d rho %8.2e t_r %8.2 t_e %8.2e w %8.2e\n&quot;</span>,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;         n, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a>, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_r, <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].t_e,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;         <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].w);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">/* Initialize arrays for scatters and the pairwise ionization denominator and temperature</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>; j++)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a2b0e1368d0adfd432627a2ceedebb704">PWdenom</a>[<a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>] = 0.0;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a4d5152400f3815e3097ef30ff27aec5c">PWnumer</a>[<a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>] = 0.0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a2651f0307bf16fc9febad1be3c7bbfd0">PWdtemp</a>[<a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>] = 0.0;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#a712f96fb8bc5b68b5b51024043614e53">PWntemp</a>[<a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>] = 0.0;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ada2361ccbc0c5103f58d097af8b5dfe7">scatters</a>[<a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>] = 0;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#aba12a0eea107e923bad5f26cb012e72a">xscatters</a>[<a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>] = 0;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">/* Calculate the the divergence of the wind at the center of each grid cell */</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221">wind_div_v</a> (w);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">/* Now calculate the adiabatic cooling.  Note: adiabatic cooling is not used in</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> * the program at present.  There are issues concerning how to incorporate it</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> * into the macro atom approach, as well as questions concerning the appropriate</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> * calculation.  If changes are made to this, then they must also be made in</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> * the corresponding portion of wind_updates.  04nov -- ksl</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">/*06may -- ksl -- This is awkward because liminosities are now part of plasma structure */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; i++)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a4f5794e0b4b6ed3e93a1cbd284132a17">adiabatic</a>)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      nwind = <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">nwind</a>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structplasma.html#acf37090e0b83fe81d058f21229a90018">cool_adiabatic</a> =</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604">adiabatic_cooling</a> (&amp;w[nwind], <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[i].t_e);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>].<a class="code" href="structplasma.html#acf37090e0b83fe81d058f21229a90018">cool_adiabatic</a> = 0.0;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">/* Calculate one over dvds */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="foo_8h.html#a655c28bba6dc25187e6173f6787364c4">dvds_ave</a> ();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="foo_8h.html#aa5de177d6e8fc4d6d0becf0c2898b90d">wind_check</a> (w, -1);       <span class="comment">// Check the wind for reasonability</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">/* zero the counters which record diagnostics for mean_intensity */</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="python_8h.html#afcc4509571e87828cae153a1eeda870a">nerr_Jmodel_wrong_freq</a> = 0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="python_8h.html#a052ca1b9e5f22b4f5ad1b3cc8d07cb1c">nerr_no_Jmodel</a> = 0;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">     Check that m_dot is correct.  This calculation is very approximate.  It only calculates mdot</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">     flowing up through the grid, i.e. any material that leaks out the side will not be counted.  A</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">     much better approach is needed, e.g. to calculate the mass flow in a spherical shell at the edge</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">     of the disk.  In addition, it uses a very inexact way to determine which grid points are in the</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">     wind.  Today, I simply modified the routine so the flux was calculated mid-way in grid space</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">     through the wind. ??? ksl 01mar15</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">     04aug -- I have not written the routine to do the check that with cooridnate systems</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">     other than spherical, we are getting the correct mdot.  It should be possible to do this</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">     in a coordinate system independent manner simply by inteegrating using interpolated values</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">     and so this would be a good thing to fix.  But it is not used elsewhere so I have skipped</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">     it for now.</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">     05apr -- Looked at this again.  It is clearly a straightforwrd thing to do use the rho function</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">     which is below. One would simply integrate over various surface integrals to make it happen.</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">     15aug -- ksl - It&#39;s not clear this it really correct with dommains, but the following compiles</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">for</span> (ndom = 0; ndom &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; ndom++)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a>)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        (<span class="stringliteral">&quot;Warning: wind2d.c: next lines may not make sense with multiple domains\n&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      ndim = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#ac90e4779abcabc0170d2bfc30a8e1323">ndim</a>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      mdim = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#aa557b63d514dffedaf76a635579b3294">mdim</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      nstart = <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].<a class="code" href="structdomain.html#aeddcae5f993efc8142ee84f461cfcda1">nstart</a>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      mdotwind = 0;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      mdotbase = 0;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; ndim - 1; i++)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          n = nstart + i * mdim + (mdim / 2);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">// rr is router * router - rinner *rinner for this shell</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;          rr =</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        w[n + <a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[0] * w[n + <a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[0] + w[n + <a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[1] * w[n +</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                       <a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>].</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        x[1] - (w[n].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[0] * w[n].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[0] + w[n].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[1] * w[n].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[1]);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;          <span class="keywordflow">if</span> (w[nstart + i * mdim].<a class="code" href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a> == W_ALL_INWIND)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;          nplasma = w[nstart + i * <a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>].<a class="code" href="structwind.html#ae01b6d799a4f0a60142703606c9fea3c">nplasma</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          mdotbase +=</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * rr * w[nstart +</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                              i * <a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>].<a class="code" href="structwind.html#a9e2fcac3826b36b7a4eed3eb74f45ede">v</a>[2];</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="keywordflow">if</span> (w[n].<a class="code" href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a> == W_ALL_INWIND)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          nplasma = w[n].<a class="code" href="structwind.html#ae01b6d799a4f0a60142703606c9fea3c">nplasma</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          mdotwind += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * rr * w[n].<a class="code" href="structwind.html#a9e2fcac3826b36b7a4eed3eb74f45ede">v</a>[2];</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="comment">/* Factor of 2 to allow for wind on both sides of disk */</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;m dot wind: Domain %d Desired %g   Base %g Calculated %g\n&quot;</span>,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;           ndom, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_mdot, 2. * mdotbase, 2. * mdotwind);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee">mdot_wind</a> (w, 1.e6, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].rmax / 2.);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        (<span class="stringliteral">&quot;wind2d.c: Not currently able to calculate mdot wind for coordtype %d in domain %d\n&quot;</span>,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;         <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type, ndom);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">//OLD /***********************************************************</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">//OLD                                        Space Telescope Science Institute</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">//OLD  Synopsis:</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">//OLD   where_in_grid locates the 1-d grid position of the photon.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">//OLD  Arguments:</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">//OLD   ndom        The domain number for the search</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">//OLD   double x[];     The position</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">//OLD  Returns:</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">//OLD   where_in_grid normally  returns element in wmain  associated with</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">//OLD       a position.  If the photon is in the grid this will</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">//OLD       be a positive integer.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">//OLD   photon is inside the grid        -1</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">//OLD   photon is outside the grid       -2</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">//OLD  Description:</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">//OLD  Notes:</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">//OLD   Where_in grid does not tell you whether the photon is in the wind!.</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">//OLD   What one means by inside or outside the grid may well be different</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">//OLD   for different coordinate systems..</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">//OLD  History:</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">//OLD   97jan   ksl Coding on python began.</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//OLD   98jul   ksl Removed WindPtr as one of arguments since not used</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">//OLD   98dec   ksl Modified so that the argument is simply a position</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">//OLD   99jan   ksl Modified to check that we are not trying to short</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">//OLD           circuit if we are asking for where_in_grid of same</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">//OLD           position as previously</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">//OLD   04aug   ksl 52a -- Now almos a shell, as moved to allow</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">//OLD           multiple coordinate systems</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">//OLD   05apr   ksl 55d -- Added spherical as a possiblity</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">//OLD   15aug   ksl Modified so that a domain number is requried</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">//OLD **************************************************************/</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="wind2d_8c.html#ae1705b3b8167c7d811573af4a3bd063d">  558</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="wind2d_8c.html#ae1705b3b8167c7d811573af4a3bd063d">wig_n</a>;</div><div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="wind2d_8c.html#ab087c671695d8b903dc431a91b0d85da">  559</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="wind2d_8c.html#a85d6497ec425ae7ad645123ecd08851b">wig_x</a>, <a class="code" href="wind2d_8c.html#a44ecbd1b141d80e28463cf7da2bc94c7">wig_y</a>, <a class="code" href="wind2d_8c.html#ab087c671695d8b903dc431a91b0d85da">wig_z</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00593"></a><span class="lineno"><a class="line" href="wind2d_8c.html#ad4b676b9911462eec0740df5f8f0da55">  593</a></span>&#160;<a class="code" href="wind2d_8c.html#ad4b676b9911462eec0740df5f8f0da55">where_in_grid</a> (ndom, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;     <span class="keywordtype">int</span> ndom;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[];</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordtype">int</span> n;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordtype">double</span> fx, fz;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="wind2d_8c.html#a85d6497ec425ae7ad645123ecd08851b">wig_x</a> != <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[0] || <a class="code" href="wind2d_8c.html#a44ecbd1b141d80e28463cf7da2bc94c7">wig_y</a> != <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[1] || <a class="code" href="wind2d_8c.html#ab087c671695d8b903dc431a91b0d85da">wig_z</a> != <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[2])  <span class="comment">// Calculate if new position</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a>)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      n = <a class="code" href="cylindrical_8c.html#a88a4510bced469b493b0a16a8b2308ba">cylind_where_in_grid</a> (ndom, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495">RTHETA</a>)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      n = <a class="code" href="foo_8h.html#a711aa1dc0e92eff62111bf90e2a6b89e">rtheta_where_in_grid</a> (ndom, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>)</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      n = <a class="code" href="foo_8h.html#a7406e8182dece78e2612793e400d1540">spherical_where_in_grid</a> (ndom, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3">CYLVAR</a>)</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      n = <a class="code" href="cylind__var_8c.html#a32c03e10ad1712cb98a72b444cca5499">cylvar_where_in_grid</a> (ndom, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, 0, &amp;fx, &amp;fz);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;where_in_grid: Unknown coord_type %d for domain %d\n&quot;</span>,</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;         <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type, ndom);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      exit (0);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="comment">/* Store old positions to short-circuit calculation if asked for same position more</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">         than once */</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <a class="code" href="wind2d_8c.html#a85d6497ec425ae7ad645123ecd08851b">wig_x</a> = <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[0];</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <a class="code" href="wind2d_8c.html#a44ecbd1b141d80e28463cf7da2bc94c7">wig_y</a> = <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[1];</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <a class="code" href="wind2d_8c.html#ab087c671695d8b903dc431a91b0d85da">wig_z</a> = <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[2];</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="wind2d_8c.html#ae1705b3b8167c7d811573af4a3bd063d">wig_n</a> = n;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="wind2d_8c.html#ae1705b3b8167c7d811573af4a3bd063d">wig_n</a>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">//OLD /***********************************************************</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">//OLD                                        Space Telescope Science Institute</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">//OLD  Synopsis:</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">//OLD   vwind_xyz(ndom,p,v) finds the velocity vector v for the wind in cartesian</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">//OLD   coordinates at the position of the photon p.</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">//OLD  Arguments:</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">//OLD   int ndom;</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">//OLD   PhotPtr p;</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">//OLD   double v[];</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">//OLD Returns:</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">//OLD   0   on successful completion</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">//OLD       the value of where in grid if the photon outside the wind grid.</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">//OLD Description:</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">//OLD   This routine carries out a bilinear interpolation of the wind velocity.  The velocities</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">//OLD   at the edges of the grid cells must have been defined elsewhere (e.g in wind_define).</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">//OLD   If the position is outside the wind grid, then the velocities will be returned as 0.</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">//OLD Notes:</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">//OLD   For all of the 2d coordinate systems, the positions in the WindPtr array are</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">//OLD   caclulated in the xz plane.  As a result, the velocities in that array are</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">//OLD   calcuated there as well.  Hence, to obtain the velocity in cartesion coordinates</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">//OLD   one needs to do a simple rotation of the velocity vector.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">//OLD   For spherical (1d) coordinates the situation is complex, the philosopy that</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">//OLD   has been adopted is to let the program run even if the wind model is intrinsically</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">//OLD   2d.   The xyz positions of the grid are defined are defined so that</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">//OLD   are in the xz plane at an angle of 45 degrees to the x axis.  This was done</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">//OLD   so that if one used, say an sv wind, in spherical coordinates, one would select</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">//OLD   the wind velocities at a plausible location.   But it implies that the velocities</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">//OLD   that have been accepted are not purely radial as one might expect.  The choice</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">//OLD   that has been made is to assume that v[1] is preserved as a non zero value in</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">//OLD   making the projection.  An alternative might have been to preserve the angular</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">//OLD   rotation rate.</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">//OLD   Regardless, the fundamental challenge is to make sure the program works correctly</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">//OLD   for the spherically symmetric case, e.g a simple stellar wind, which it did not</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">//OLD   before 56b.</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">//OLD   If we ever implement a real 3d coordinate system, one will need to look at</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">//OLD   this routine again.</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">//OLD History:</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">//OLD   97jan   ksl Coding on python began.</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">//OLD   02feb   ksl Modified to use new general purpose fraction routine.</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">//OLD   04aug   ksl 52a -- Made a shell for choosing what coordinate</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">//OLD           system to calculate this in</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">//OLD   05jun   ksl 56b -- Despite the note above nothing had been done</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">//OLD           to fix vwind_xyz to handle spherical coordinates</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">//OLD           properly.  It was OK for any two-d system.  This</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">//OLD           is now fixed, but see the notes above.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">//OLD   06may   ksl 57+ -- Changed call to elimatnate passing the</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">//OLD           Wind array.  Use wmain instead.</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">//OLD   15aug   ksl Added a variable for the domain</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">//OLD **************************************************************/</span></div><div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="wind2d_8c.html#ad318f8972d3832930303d84e94599a89">  699</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="wind2d_8c.html#ad318f8972d3832930303d84e94599a89">ierr_vwind</a> = 0;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">  742</a></span>&#160;<a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, p, <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;     <span class="keywordtype">int</span> ndom;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;     <a class="code" href="structphoton.html">PhotPtr</a> p;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[];</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;{</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a>, <a class="code" href="import__rtheta_8c.html#af48f2a5d53f764daa5ebf5ca0c72bb01">r</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordtype">double</span> vv[3];</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordtype">double</span> ctheta, stheta;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, frac[4];</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordtype">int</span> nn, nnn[4], nelem;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span> (ndom &lt; 0 || ndom &gt;= <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;vwind_xyz: Received invalid domain  %d\n&quot;</span>, ndom);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <a class="code" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3">coord_fraction</a> (ndom, 0, p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>, nnn, frac, &amp;nelem);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      x = 0;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordflow">for</span> (nn = 0; nn &lt; nelem; nn++)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    x += <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[nnn[nn]].<a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[i] * frac[nn];</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      vv[<a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>] = <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  rho = sqrt (p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[0] * p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[0] + p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[1] * p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[1]);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    {               <span class="comment">// put the velocity into cylindrical coordinates on the xz axis</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      x = sqrt (vv[0] * vv[0] + vv[2] * vv[2]); <span class="comment">//v_r</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      r = <a class="code" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757">length</a> (p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      vv[0] = rho / r * <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      vv[2] = p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[2] / r * <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[2] &lt; 0)     <span class="comment">// For 2d coord syatems, velocity is reversed if the photon is in the lower hemisphere.</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    vv[2] *= -1;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordflow">if</span> (rho == 0)</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    {               <span class="comment">// Then we will not be able to project from a cylindrical ot a cartesian system</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    (<span class="stringliteral">&quot;vwind_xyz: Cannot determine an xyz velocity on z axis. Returnin 0,0,v[2]\n&quot;</span>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[0] = <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[1] = 0;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[2] = vv[2];</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">/* Now we have v in cylindrical coordinates, but we would like it in cartesian coordinates.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">     Note that could use project_from_cyl_xyz(p-&gt;x,vv,v) ?? */</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  ctheta = p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[0] / <a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  stheta = p-&gt;<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[1] / <a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[0] = vv[0] * ctheta - vv[1] * stheta;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[1] = vv[0] * stheta + vv[1] * ctheta;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[2] = vv[2];</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[0]) || <a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[1]) || <a class="code" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a> (<a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[2]))</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;vwind_xyz: %f %f %f\n&quot;</span>, <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[0], <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[1], <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[2]);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a8fe8eb8bacb888783ada9dd32b523e1a">  843</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="wind2d_8c.html#a8fe8eb8bacb888783ada9dd32b523e1a">wind_div_err</a> = (-3);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00846"></a><span class="lineno"><a class="line" href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221">  846</a></span>&#160;<a class="code" href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221">wind_div_v</a> (w)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;     <a class="code" href="structwind.html">WindPtr</a> w;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;{</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordtype">int</span> icell;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordtype">double</span> x_zero[3], v2[3], v1[3];</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keyword">struct </span><a class="code" href="structphoton.html">photon</a> ppp;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordtype">double</span> div, delta;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordtype">double</span> xxx[3];</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordtype">int</span> ndom;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">for</span> (icell = 0; icell &lt; <a class="code" href="python_8h.html#abd3bd3747823216853035911ad285c91">NDIM2</a>; icell++)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    {</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="comment">/* Find the center of the cell */</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <a class="code" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340">stuff_v</a> (w[icell].xcen, x_zero);  <span class="comment">/*Gget the centre of the current cell in the loop */</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      ndom = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[icell].<a class="code" href="structwind.html#aaa7f27e1a93690e4c37878a93c40db22">ndom</a>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      delta = 0.01 * x_zero[2]; <span class="comment">//delta is the distance across which we measure e.g. dv_x/dx</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">if</span> (delta == 0) {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a>(<span class="stringliteral">&quot;wind_div_v: Cell %d has xcen[2]==0.  This is surprising\n&quot;</span>,icell);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          delta=<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[icell].<a class="code" href="structwind.html#a9e48704d3e2881e8cd2fef227c0ba8cd">dfudge</a>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="comment">/* for each of x,y,z we first create a copy of the vector at the center. We then step 0.5*delta</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">         in positive and negative directions and evaluate the difference in velocities. Dividing this by</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">         delta gives the value of dv_x/dx, and the sum of these gives the divergence. If issues arise</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">     see bug report #70. */</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="comment">/* Calculate dv_x/dx at this position */</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <a class="code" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340">stuff_v</a> (x_zero, ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[0] += 0.5 * delta;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;ppp, v2);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[0] -= delta;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;ppp, v1);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      div = xxx[0] = (v2[0] - v1[0]) / delta;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="comment">/* Calculate dv_y/dy */</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <a class="code" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340">stuff_v</a> (x_zero, ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[1] += 0.5 * delta;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;ppp, v2);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[1] -= delta;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;ppp, v1);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      div += xxx[1] = (v2[1] - v1[1]) / delta;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="comment">/* Calculate dv_z/dz */</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <a class="code" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340">stuff_v</a> (x_zero, ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[2] += 0.5 * delta;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;ppp, v2);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      ppp.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[2] -= delta;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;ppp, v1);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      div += xxx[2] = (v2[2] - v1[2]) / delta;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="comment">/* we have now evaluated the divergence, so can store in the wind pointer */</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      w[icell].<a class="code" href="structwind.html#a25a5b831a64c649f280da38e9b8821d9">div_v</a> = div;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keywordflow">if</span> (div &lt; 0 &amp;&amp; (<a class="code" href="wind2d_8c.html#a8fe8eb8bacb888783ada9dd32b523e1a">wind_div_err</a> &lt; 0 || w[icell].<a class="code" href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a> == W_ALL_INWIND))</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        (<span class="stringliteral">&quot;wind_div_v: div v %e negative in cell %d Domain %d. Major problem if inwind (%d) == 0\n&quot;</span>,</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;         div, icell, w[icell].ndom, w[icell].<a class="code" href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a>);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <a class="code" href="wind2d_8c.html#a8fe8eb8bacb888783ada9dd32b523e1a">wind_div_err</a>++;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;}</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="keywordtype">double</span></div><div class="line"><a name="l00941"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">  941</a></span>&#160;<a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a> (w, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;     <a class="code" href="structwind.html">WindPtr</a> <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[];</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;{</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordtype">int</span> n;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordtype">double</span> dd;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordtype">double</span> frac[4];</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordtype">int</span> nn, nnn[4], nelem;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordtype">int</span> nplasma;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordtype">int</span> ndom, ndomain;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99">where_in_wind</a> (<a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, &amp;ndomain) &lt; 0)  <span class="comment">//note that where_in_wind is independent of grid.</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">return</span> (0.0);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">if</span> ((ndom = ndomain) &lt; 0)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;rho: Domain not fournd %d\n&quot;</span>, ndomain);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keywordflow">return</span> (0.0);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  n = <a class="code" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3">coord_fraction</a> (ndom, 1, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, nnn, frac, &amp;nelem);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">if</span> (n &lt; 0)</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      dd = 0;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    {</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      dd = 0;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">for</span> (nn = 0; nn &lt; nelem; nn++)</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      nplasma = w[nnn[nn]].<a class="code" href="structwind.html#ae01b6d799a4f0a60142703606c9fea3c">nplasma</a>;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      dd += <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[nplasma].<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> * frac[nn];</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordflow">return</span> (dd);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;}</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l01008"></a><span class="lineno"><a class="line" href="wind2d_8c.html#ac98ab21bbcfcfc326f0b16fabd5587c0"> 1008</a></span>&#160;<span class="preprocessor">#define NSTEPS 100</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l01011"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee"> 1011</a></span>&#160;<a class="code" href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee">mdot_wind</a> (w, <a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a>, rmax)</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;     <a class="code" href="structwind.html">WindPtr</a> <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a>;          <span class="comment">// The height (usually small) above the disk at which mdot will be calculated</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;     <span class="keywordtype">double</span> rmax;       <span class="comment">// The radius at which mdot will be calculated</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;{</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="keyword">struct </span><a class="code" href="structphoton.html">photon</a> p;      <span class="comment">//needed because vwind_xyz has a call which involves a photon</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="import__rtheta_8c.html#af48f2a5d53f764daa5ebf5ca0c72bb01">r</a>, dr, rmin;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="import__rtheta_8c.html#a378137dbf3ab2f94d79dd3bdcb84379f">theta</a>, dtheta;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordtype">double</span> den, <a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a> ();</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keywordtype">double</span> mdot, mplane, msphere;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[3], <a class="code" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>[3], q[3], <a class="code" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93">dot</a> ();</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordtype">int</span> ndom;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  ndom = 0;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;For simplicity, mdot wind checks only carried out for domain 0\n&quot;</span>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">/* Calculate the mass loss rate immediately above the disk */</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">/* Check that everything is defined sensibly */</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  rmin = <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7384383e4129a0341c5a1a27a68d7947">rstar</a>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">if</span> (rmax &lt;= rmin)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;mdot_wind: rmax %g is less than %g, so returning\n&quot;</span>, rmax,</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;         rmin);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">return</span> (0.0);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  dr = (rmax - rmin) / <a class="code" href="wind2d_8c.html#ac98ab21bbcfcfc326f0b16fabd5587c0">NSTEPS</a>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  mdot = 0;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  p.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[1] = x[1] = 0.0;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  p.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[2] = x[2] = <a class="code" href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">for</span> (r = dr / 2; r &lt; rmax; r += dr)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    {</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      p.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[0] = x[0] = <a class="code" href="import__rtheta_8c.html#af48f2a5d53f764daa5ebf5ca0c72bb01">r</a>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      den = <a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a> (w, x);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;p, v);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      mdot += 2 * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * r * dr * den * v[2];</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  mplane = 2. * mdot;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">/* Calculate the mass loss rate in a sphere */</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  dtheta = <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / (2 * <a class="code" href="wind2d_8c.html#ac98ab21bbcfcfc326f0b16fabd5587c0">NSTEPS</a>);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  mdot = 0;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  p.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[1] = x[1] = 0.0;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  q[1] = 0;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordflow">for</span> (theta = dtheta / 2; theta &lt; (<a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / 2.); theta += dtheta)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      p.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[0] = x[0] = r * sin (theta);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      p.<a class="code" href="structphoton.html#a279232990e041c1535ce72fdd34c359d">x</a>[2] = x[2] = r * cos (theta);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      q[0] = sin (theta);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      q[2] = cos (theta);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      den = <a class="code" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a> (w, x);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <a class="code" href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a> (ndom, &amp;p, v);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      mdot += 2 * <a class="code" href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a> * rmax * rmax * sin (theta) * dtheta * den * <a class="code" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93">dot</a> (v, q);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  msphere = 2 * mdot;       <span class="comment">// Factor of two because wind is in both hemispheres</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Wind Mdot Desired %e Plane %e Sphere(%e) %e\n&quot;</span>, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].wind_mdot,</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;       mplane, rmax, msphere);</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l01098"></a><span class="lineno"><a class="line" href="wind2d_8c.html#af8f7fd3a6d5f7872ee87beb27dcba899"> 1098</a></span>&#160;<a class="code" href="wind2d_8c.html#af8f7fd3a6d5f7872ee87beb27dcba899">get_random_location</a> (n, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>)</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;     <span class="keywordtype">int</span> n;         <span class="comment">// Cell in which to create position</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>[];        <span class="comment">// Returned position</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;{</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordtype">int</span> ndom;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  ndom = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[n].<a class="code" href="structwind.html#aaa7f27e1a93690e4c37878a93c40db22">ndom</a>;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a>)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <a class="code" href="cylindrical_8c.html#ab19f6786630fce8ae46bbd702d80d59b">cylind_get_random_location</a> (n, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495">RTHETA</a>)</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <a class="code" href="foo_8h.html#a00bbfc05ca86bbb87a4c69019564af5d">rtheta_get_random_location</a> (n, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a>)</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    {</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <a class="code" href="foo_8h.html#a01eb12e765998d3b9b350b3d8834347f">spherical_get_random_location</a> (n, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type == <a class="code" href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3">CYLVAR</a>)</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <a class="code" href="cylind__var_8c.html#a352d864e752cc2b9041a5e2ad1e5ffff">cylvar_get_random_location</a> (n, <a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;get_random_location: Don&#39;t know this coord_type %d\n&quot;</span>,</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom].coord_type);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      exit (0);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;}</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a675b4d912b5b505f099fc17031660393"> 1151</a></span>&#160;<a class="code" href="wind2d_8c.html#a675b4d912b5b505f099fc17031660393">zero_scatters</a> ()</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;{</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordtype">int</span> n, <a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; n++) <span class="comment">/*NSH 1107 - changed loop to only run over nions to avoid running over the</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">                   end of the array after the arry was dynamically allocated in 78a */</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a>; j++)</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n].<a class="code" href="structplasma.html#ada2361ccbc0c5103f58d097af8b5dfe7">scatters</a>[<a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>] = 0;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;}</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">//OLD /*************************************************************</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">//OLD                                        Space Telescope Science Institute</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">//OLD   Check how many corners  of a wind cell are in the wind defined by this</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">//OLD   particular domain</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">//OLD Synopsis:</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">//OLD   The routine basically just calls where_in_wind for each of the 4 corners</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">//OLD   of the cell.</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">//OLD Arguments:</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">//OLD   int n where n is the cell number</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">//OLD Returns:</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">//OLD   The routine simply returns the number of corners of the cell that</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">//OLD   is in the wind</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">//OLD Description:</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">//OLD   This is really just a driver routine for coordinate system specific</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">//OLD   routines</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">//OLD   It is intended to standardize this check so that one can</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">//OLD   use such a routin in the volumes calculations.</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">//OLD Notes:</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">//OLD   It has not been implemented for a spherical (1d)</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">//OLD   coordinate system.</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">//OLD   The fact that none of the corners of a cell are in</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">//OLD   the wind is not necessarily a guarantee that the wind</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">//OLD   does not pass through the cell.  This is not only</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">//OLD   a theoretical problem, because we generally use</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">//OLD   a logarithmic spacing for the wind cells and thus</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">//OLD   the dimensions of the cells get quite large as one</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">//OLD   gets far from the center.</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">//OLD   The only way to verify this is to check all four</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">//OLD   surfaces of the wind.</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">//OLD</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">//OLD History</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">//OLD   080403  ksl 68c - Added, or more correctly simply</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">//OLD           moved code into a separate routine so</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">//OLD           could be called from elsewhere</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">//OLD   15sep   ksl Modifidy so that it n_inwind is incremented</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">//OLD           only if we are in the domain associated with</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">//OLD           this particular cell.</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">//OLD *****************************************************/</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l01245"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a80e38cc8054ee669104c30986700d508"> 1245</a></span>&#160;<a class="code" href="wind2d_8c.html#a80e38cc8054ee669104c30986700d508">check_corners_inwind</a> (n)</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;     <span class="keywordtype">int</span> n;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;{</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordtype">int</span> n_inwind;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a>, <a class="code" href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <a class="code" href="structdomain.html">DomainPtr</a> one_dom;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="keywordtype">int</span> ndom, ndomain;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="comment">/* find the domain */</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  ndom = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[n].<a class="code" href="structwind.html#aaa7f27e1a93690e4c37878a93c40db22">ndom</a>;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  one_dom = &amp;<a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[ndom];</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a> (ndom, n, &amp;i, &amp;j);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  n_inwind = 0;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordflow">if</span> (i &lt; (one_dom-&gt;<a class="code" href="structdomain.html#ac90e4779abcabc0170d2bfc30a8e1323">ndim</a> - 2) &amp;&amp; j &lt; (one_dom-&gt;<a class="code" href="structdomain.html#aa557b63d514dffedaf76a635579b3294">mdim</a> - 2))</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    {</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99">where_in_wind</a> (<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[n].<a class="code" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, &amp;ndomain) == W_ALL_INWIND</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      &amp;&amp; ndom == ndomain)</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    n_inwind++;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99">where_in_wind</a> (<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[n + 1].x, &amp;ndomain) == W_ALL_INWIND</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      &amp;&amp; ndom == ndomain)</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    n_inwind++;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99">where_in_wind</a> (<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[n + one_dom-&gt;<a class="code" href="structdomain.html#aa557b63d514dffedaf76a635579b3294">mdim</a>].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>, &amp;ndomain) == W_ALL_INWIND</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      &amp;&amp; ndom == ndomain)</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    n_inwind++;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99">where_in_wind</a> (<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[n + one_dom-&gt;<a class="code" href="structdomain.html#aa557b63d514dffedaf76a635579b3294">mdim</a> + 1].<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>, &amp;ndomain) ==</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      W_ALL_INWIND &amp;&amp; ndom == ndomain)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    n_inwind++;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">return</span> (n_inwind);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l01313"></a><span class="lineno"><a class="line" href="wind2d_8c.html#a980ea04ae2c501a6df12080eb698a851"> 1313</a></span>&#160;<a class="code" href="wind2d_8c.html#a980ea04ae2c501a6df12080eb698a851">check_grid</a> ()</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;{</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordtype">int</span> ndom, n;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="keywordtype">double</span> l_sob, vth, lambda_t, nh;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keywordtype">double</span> delta_r, delta_x, delta_z, delta_vz, delta_vx;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordtype">double</span> v1[3], v2[3];</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <a class="code" href="structwind.html">WindPtr</a> one;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <a class="code" href="structplasma.html">PlasmaPtr</a> <a class="code" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordtype">int</span> n_dv, n_tau;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  n_dv = n_tau = 0;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a>; n++)</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="comment">/* get the relevant pointers for this cell */</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      xplasma = &amp;<a class="code" href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a>[n];</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      one = &amp;<a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>[xplasma-&gt;<a class="code" href="structplasma.html#a8220b5d466addc895b973f092d9b7b15">nplasma</a>];</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      ndom = one-&gt;<a class="code" href="structwind.html#aaa7f27e1a93690e4c37878a93c40db22">ndom</a>;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="comment">/* Hydrogen density, ne should be roughly this */</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      nh = xplasma-&gt;<a class="code" href="structplasma.html#aeffd93110218aa8876f074488b026390">rho</a> * <a class="code" href="atomic_8h.html#a9dc9286373de87e475724fbd5e8c0435">rho2nh</a>;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="comment">/* thermal speed */</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      vth = sqrt (1.5 * <a class="code" href="atomic_8h.html#aa1487dae81baa2e0a5643e7b571633a0">BOLTZMANN</a> * xplasma-&gt;<a class="code" href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">t_e</a> / <a class="code" href="atomic_8h.html#a8592a4c6a82900de74ba738c807293f0">MPROT</a>);</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="comment">/* sobolev length -- this could be used for a check but isn&#39;t yet */</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      l_sob = vth / one-&gt;<a class="code" href="structwind.html#a4d9c9c37e5ea6f91b06918e723217fed">dvds_ave</a>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="comment">/* get approximate cell extents */</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      delta_z = 2.0 * (one-&gt;<a class="code" href="structwind.html#a289fcd4f4c7e344d112785545192cffe">xcen</a>[2] - one-&gt;<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[2]);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      delta_x = 2.0 * (one-&gt;<a class="code" href="structwind.html#a289fcd4f4c7e344d112785545192cffe">xcen</a>[0] - one-&gt;<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>[0]);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      delta_r = sqrt (delta_x * delta_x + delta_z * delta_z);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="comment">/* Thomson mean free path 1/sigma*nh */</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      lambda_t = 1.0 / <a class="code" href="atomic_8h.html#a8bc97ad38b30a4ad622f7ebba5654485">THOMPSON</a> * nh;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="comment">/* get the velocity at cell corner and cell edge in x and z */</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <a class="code" href="foo_8h.html#a9ca1dd624c5f0c6c8a401a0e79d023b5">model_velocity</a> (ndom, one-&gt;<a class="code" href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">x</a>, v1);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <a class="code" href="foo_8h.html#a9ca1dd624c5f0c6c8a401a0e79d023b5">model_velocity</a> (ndom, one-&gt;<a class="code" href="structwind.html#a289fcd4f4c7e344d112785545192cffe">xcen</a>, v2);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      delta_vx = fabs (v1[0] - v2[0]);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      delta_vz = fabs (v1[1] - v2[1]);</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="comment">/* if we have errors then increment the error counters */</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="keywordflow">if</span> (delta_r / lambda_t &gt; 1)</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    {</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      n_tau++;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="comment">//Error(&quot;check_grid: optical depth may be high in cell %i domain %i\n&quot;,</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="comment">//       n, ndom);</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    }</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="keywordflow">if</span> (delta_vx &gt; 1e8 || delta_vz &gt; 1e8)</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    {</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      n_dv++;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="comment">//Error(&quot;check_grid: velocity changes by &gt;1,000 km/s across cell %i domain %i\n&quot;,</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">//       n, ndom);</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    }</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">/* report problems to user in a summary error message */</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">if</span> (n_dv &gt; 0)</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;check_grid: velocity changes by &gt;1,000 km/s in %i cells\n&quot;</span>, n_dv);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordflow">if</span> (n_tau &gt; 0)</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;check_grid: optical depth may be high in %i\n&quot;</span>, n_tau);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">if</span> (n_dv &gt; 0 || n_tau &gt; 0)</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      (<span class="stringliteral">&quot;check_grid: some cells have large changes. Consider modifying zlog_scale or grid dims\n&quot;</span>);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;}</div><div class="ttc" id="cylind__var_8c_html_a95334daf522cc6a4ac43e85e759f4a31"><div class="ttname"><a href="cylind__var_8c.html#a95334daf522cc6a4ac43e85e759f4a31">cylvar_volumes</a></div><div class="ttdeci">int cylvar_volumes(int ndom, WindPtr w)</div><div class="ttdoc">w) calculates the wind volume of a cylindrical cell allowing for the fact that some cells ...</div><div class="ttdef"><b>Definition:</b> <a href="cylind__var_8c_source.html#l00506">cylind_var.c:506</a></div></div>
<div class="ttc" id="python_8h_html_afda1ac6937e9d82232d5d99159e6485d"><div class="ttname"><a href="python_8h.html#afda1ac6937e9d82232d5d99159e6485d">DFUDGE</a></div><div class="ttdeci">double DFUDGE</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00045">python.h:45</a></div></div>
<div class="ttc" id="structplasma_html_a110b6efdc5fa932c21dc021047b35eea"><div class="ttname"><a href="structplasma.html#a110b6efdc5fa932c21dc021047b35eea">plasma::spec_mod_type</a></div><div class="ttdeci">enum plasma::spec_mod_type_enum spec_mod_type[NXBANDS]</div></div>
<div class="ttc" id="structplasma_html_abd08d926f7b31dc9ddfaf5bc0c02de8f"><div class="ttname"><a href="structplasma.html#abd08d926f7b31dc9ddfaf5bc0c02de8f">plasma::gain</a></div><div class="ttdeci">double gain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00868">python.h:868</a></div></div>
<div class="ttc" id="cylind__var_8c_html_a352d864e752cc2b9041a5e2ad1e5ffff"><div class="ttname"><a href="cylind__var_8c.html#a352d864e752cc2b9041a5e2ad1e5ffff">cylvar_get_random_location</a></div><div class="ttdeci">int cylvar_get_random_location(int n, x)</div><div class="ttdoc">Generate a position at a random location within a specific cell of a domain with modified-cylindrical...</div><div class="ttdef"><b>Definition:</b> <a href="cylind__var_8c_source.html#l00892">cylind_var.c:892</a></div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a4e1df4d6feb0aae5e035652b4126cc2c">CYLIND</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00134">python.h:134</a></div></div>
<div class="ttc" id="structphoton_html_a5fa87a07a9ceef33dd79aa5cdd7856cb"><div class="ttname"><a href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">photon::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01039">python.h:1039</a></div></div>
<div class="ttc" id="structplasma_html_adbf9689b61e3df7611084d858b3115c0"><div class="ttname"><a href="structplasma.html#adbf9689b61e3df7611084d858b3115c0">plasma::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00791">python.h:791</a></div></div>
<div class="ttc" id="foo_8h_html_a917f837a1598fc3307b17cceef5f4340"><div class="ttname"><a href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340">stuff_v</a></div><div class="ttdeci">int stuff_v(double vin[], double vout[])</div></div>
<div class="ttc" id="structadvanced__modes_html_a9a1d48d878cdb6a4ef9c0f08f3f42f12"><div class="ttname"><a href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">advanced_modes::zeus_connect</a></div><div class="ttdeci">int zeus_connect</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01358">python.h:1358</a></div></div>
<div class="ttc" id="log_8h_html_a9a25be4f0d7d13fccc8457774d74167f"><div class="ttname"><a href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="ttdeci">int Log(char *format,...)</div><div class="ttdoc">Print/write an informational message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00325">xlog.c:325</a></div></div>
<div class="ttc" id="foo_8h_html_a1df8af4539e5836b6a2f8dab9f88572e"><div class="ttname"><a href="foo_8h.html#a1df8af4539e5836b6a2f8dab9f88572e">shell_make_grid</a></div><div class="ttdeci">int shell_make_grid(WindPtr w, int ndom)</div><div class="ttdoc">defines the cells in a thin shell, a special case of a spherical wind. </div><div class="ttdef"><b>Definition:</b> <a href="spherical_8c_source.html#l00585">spherical.c:585</a></div></div>
<div class="ttc" id="atomic_8h_html_a8592a4c6a82900de74ba738c807293f0"><div class="ttname"><a href="atomic_8h.html#a8592a4c6a82900de74ba738c807293f0">MPROT</a></div><div class="ttdeci">#define MPROT</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00021">atomic.h:21</a></div></div>
<div class="ttc" id="structplasma_html_a8220b5d466addc895b973f092d9b7b15"><div class="ttname"><a href="structplasma.html#a8220b5d466addc895b973f092d9b7b15">plasma::nplasma</a></div><div class="ttdeci">int nplasma</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00740">python.h:740</a></div></div>
<div class="ttc" id="wind2d_8c_html_ab087c671695d8b903dc431a91b0d85da"><div class="ttname"><a href="wind2d_8c.html#ab087c671695d8b903dc431a91b0d85da">wig_z</a></div><div class="ttdeci">double wig_z</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00559">wind2d.c:559</a></div></div>
<div class="ttc" id="wind2d_8c_html_a80e38cc8054ee669104c30986700d508"><div class="ttname"><a href="wind2d_8c.html#a80e38cc8054ee669104c30986700d508">check_corners_inwind</a></div><div class="ttdeci">int check_corners_inwind(int n)</div><div class="ttdoc">The routine basically just calls where_in_wind for each of the 4 corners of the cell. </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01245">wind2d.c:1245</a></div></div>
<div class="ttc" id="python_8h_html_a4d5c68b263c929465c5ce25903ab1773"><div class="ttname"><a href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a></div><div class="ttdeci">#define RT_MODE_MACRO</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00456">python.h:456</a></div></div>
<div class="ttc" id="foo_8h_html_ad5c30455dbf640e7a5d68132a8e4a5c5"><div class="ttname"><a href="foo_8h.html#ad5c30455dbf640e7a5d68132a8e4a5c5">wind_complete</a></div><div class="ttdeci">int wind_complete(WindPtr w)</div><div class="ttdoc">A driver routine that calls coordinate-system specific routines that complete the descirption of the ...</div><div class="ttdef"><b>Definition:</b> <a href="windsave_8c_source.html#l00339">windsave.c:339</a></div></div>
<div class="ttc" id="foo_8h_html_a311078e4d3e5530a996283eaf4c0fb19"><div class="ttname"><a href="foo_8h.html#a311078e4d3e5530a996283eaf4c0fb19">calloc_dyn_plasma</a></div><div class="ttdeci">int calloc_dyn_plasma(int nelem)</div><div class="ttdoc">This subroutine allocates space for dynamic arrays in the plasma structure. </div><div class="ttdef"><b>Definition:</b> <a href="gridwind_8c_source.html#l00570">gridwind.c:570</a></div></div>
<div class="ttc" id="wind2d_8c_html_a85d6497ec425ae7ad645123ecd08851b"><div class="ttname"><a href="wind2d_8c.html#a85d6497ec425ae7ad645123ecd08851b">wig_x</a></div><div class="ttdeci">double wig_x</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00559">wind2d.c:559</a></div></div>
<div class="ttc" id="python_8h_html_a91065d114e136045af17e48baa479753"><div class="ttname"><a href="python_8h.html#a91065d114e136045af17e48baa479753">IONMODE_LTE_TR</a></div><div class="ttdeci">#define IONMODE_LTE_TR</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01012">python.h:1012</a></div></div>
<div class="ttc" id="foo_8h_html_abc3da46eefcdd64c79fd792439a5b53d"><div class="ttname"><a href="foo_8h.html#abc3da46eefcdd64c79fd792439a5b53d">spherical_make_grid</a></div><div class="ttdeci">int spherical_make_grid(WindPtr w, int ndom)</div><div class="ttdoc">defines the cells in a spherical grid </div><div class="ttdef"><b>Definition:</b> <a href="spherical_8c_source.html#l00144">spherical.c:144</a></div></div>
<div class="ttc" id="import__rtheta_8c_html_a378137dbf3ab2f94d79dd3bdcb84379f"><div class="ttname"><a href="import__rtheta_8c.html#a378137dbf3ab2f94d79dd3bdcb84379f">theta</a></div><div class="ttdeci">double theta[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__rtheta_8c_source.html#l00046">import_rtheta.c:46</a></div></div>
<div class="ttc" id="structwind_html_ae01b6d799a4f0a60142703606c9fea3c"><div class="ttname"><a href="structwind.html#ae01b6d799a4f0a60142703606c9fea3c">wind::nplasma</a></div><div class="ttdeci">int nplasma</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00696">python.h:696</a></div></div>
<div class="ttc" id="foo_8h_html_a391062d8b219dffc8496bd6fc8128cf6"><div class="ttname"><a href="foo_8h.html#a391062d8b219dffc8496bd6fc8128cf6">calloc_plasma</a></div><div class="ttdeci">int calloc_plasma(int nelem)</div><div class="ttdoc">Allocate memory for plasmamain, which contains temperature, densities, etc. for cells which are in th...</div><div class="ttdef"><b>Definition:</b> <a href="gridwind_8c_source.html#l00215">gridwind.c:215</a></div></div>
<div class="ttc" id="structplasma_html_a469869b2b7b2a822716ac5a3ba58412a"><div class="ttname"><a href="structplasma.html#a469869b2b7b2a822716ac5a3ba58412a">plasma::vol</a></div><div class="ttdeci">double vol</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00743">python.h:743</a></div></div>
<div class="ttc" id="compton_8c_html_ad65f0d74fe764d3ecae5ec1a89d63f08"><div class="ttname"><a href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a></div><div class="ttdeci">PlasmaPtr xplasma</div><div class="ttdef"><b>Definition:</b> <a href="compton_8c_source.html#l00019">compton.c:19</a></div></div>
<div class="ttc" id="structplasma_html_a712f96fb8bc5b68b5b51024043614e53"><div class="ttname"><a href="structplasma.html#a712f96fb8bc5b68b5b51024043614e53">plasma::PWntemp</a></div><div class="ttdeci">double * PWntemp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00758">python.h:758</a></div></div>
<div class="ttc" id="wind2d_8c_html_ad318f8972d3832930303d84e94599a89"><div class="ttname"><a href="wind2d_8c.html#ad318f8972d3832930303d84e94599a89">ierr_vwind</a></div><div class="ttdeci">int ierr_vwind</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00699">wind2d.c:699</a></div></div>
<div class="ttc" id="wind2d_8c_html_ad4b676b9911462eec0740df5f8f0da55"><div class="ttname"><a href="wind2d_8c.html#ad4b676b9911462eec0740df5f8f0da55">where_in_grid</a></div><div class="ttdeci">int where_in_grid(int ndom, x)</div><div class="ttdoc">locates the element in wmain associated with a postion </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00593">wind2d.c:593</a></div></div>
<div class="ttc" id="structplasma_html_aae85efc36fb767cfec53df4cd3327fe8"><div class="ttname"><a href="structplasma.html#aae85efc36fb767cfec53df4cd3327fe8">plasma::pl_log_w</a></div><div class="ttdeci">double pl_log_w[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00893">python.h:893</a></div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566ae5031a2dca66aec4c071e90aa6bee1ff">SPHERICAL</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00133">python.h:133</a></div></div>
<div class="ttc" id="structplasma_html_a432a1f85db9000aac743588736fb6048"><div class="ttname"><a href="structplasma.html#a432a1f85db9000aac743588736fb6048">plasma::t_r</a></div><div class="ttdeci">double t_r</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00778">python.h:778</a></div></div>
<div class="ttc" id="structplasma_html_aefa8d272f5a54cae990359cccd67075d"><div class="ttname"><a href="structplasma.html#aefa8d272f5a54cae990359cccd67075d">plasma::t_e_old</a></div><div class="ttdeci">double t_e_old</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00779">python.h:779</a></div></div>
<div class="ttc" id="wind2d_8c_html_af8f7fd3a6d5f7872ee87beb27dcba899"><div class="ttname"><a href="wind2d_8c.html#af8f7fd3a6d5f7872ee87beb27dcba899">get_random_location</a></div><div class="ttdeci">int get_random_location(int n, x)</div><div class="ttdoc">is simply will produce a postion at a random place in a cell n </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01098">wind2d.c:1098</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_a4fdcb279e1e2a2ff83edb434cbbbf34a"><div class="ttname"><a href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a></div><div class="ttdeci">int mdim</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00030">import_cylindrical.c:30</a></div></div>
<div class="ttc" id="wind2d_8c_html_a44ecbd1b141d80e28463cf7da2bc94c7"><div class="ttname"><a href="wind2d_8c.html#a44ecbd1b141d80e28463cf7da2bc94c7">wig_y</a></div><div class="ttdeci">double wig_y</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00559">wind2d.c:559</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_ae616f2d5dcba70d50f32c2895905ec09"><div class="ttname"><a href="import__cylindrical_8c.html#ae616f2d5dcba70d50f32c2895905ec09">inwind</a></div><div class="ttdeci">int inwind[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00031">import_cylindrical.c:31</a></div></div>
<div class="ttc" id="foo_8h_html_a711aa1dc0e92eff62111bf90e2a6b89e"><div class="ttname"><a href="foo_8h.html#a711aa1dc0e92eff62111bf90e2a6b89e">rtheta_where_in_grid</a></div><div class="ttdeci">int rtheta_where_in_grid(int ndom, double x[])</div></div>
<div class="ttc" id="structplasma_html_a9b217285a754e1533f95d92972b6afd6"><div class="ttname"><a href="structplasma.html#a9b217285a754e1533f95d92972b6afd6">plasma::t_e</a></div><div class="ttdeci">double t_e</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00779">python.h:779</a></div></div>
<div class="ttc" id="foo_8h_html_a4b147244ba1a5d54d79a57a8ee665b18"><div class="ttname"><a href="foo_8h.html#a4b147244ba1a5d54d79a57a8ee665b18">calloc_macro</a></div><div class="ttdeci">int calloc_macro(int nelem)</div><div class="ttdoc">Allocate memory to store information for macro atoms for each Plasma element. </div><div class="ttdef"><b>Definition:</b> <a href="gridwind_8c_source.html#l00330">gridwind.c:330</a></div></div>
<div class="ttc" id="python_8h_html_afcc4509571e87828cae153a1eeda870a"><div class="ttname"><a href="python_8h.html#afcc4509571e87828cae153a1eeda870a">nerr_Jmodel_wrong_freq</a></div><div class="ttdeci">int nerr_Jmodel_wrong_freq</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01335">python.h:1335</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_ab47e1e72aea1af4158c96f38ee80b8f7"><div class="ttname"><a href="import__cylindrical_8c.html#ab47e1e72aea1af4158c96f38ee80b8f7">i</a></div><div class="ttdeci">int i[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00031">import_cylindrical.c:31</a></div></div>
<div class="ttc" id="structdomain_html"><div class="ttname"><a href="structdomain.html">domain</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00200">python.h:200</a></div></div>
<div class="ttc" id="structwind_html_a4d9c9c37e5ea6f91b06918e723217fed"><div class="ttname"><a href="structwind.html#a4d9c9c37e5ea6f91b06918e723217fed">wind::dvds_ave</a></div><div class="ttdeci">double dvds_ave</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00709">python.h:709</a></div></div>
<div class="ttc" id="foo_8h_html_a9ca1dd624c5f0c6c8a401a0e79d023b5"><div class="ttname"><a href="foo_8h.html#a9ca1dd624c5f0c6c8a401a0e79d023b5">model_velocity</a></div><div class="ttdeci">double model_velocity(int ndom, double x[], double v[])</div></div>
<div class="ttc" id="structwind_html"><div class="ttname"><a href="structwind.html">wind</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00692">python.h:692</a></div></div>
<div class="ttc" id="python_8h_html_a33f8696ebd56cd4158a5b519ec627fc5"><div class="ttname"><a href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a></div><div class="ttdeci">struct advanced_modes modes</div></div>
<div class="ttc" id="foo_8h_html_a3d923b8d7eb460585ecf6885222a69a3"><div class="ttname"><a href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3">coord_fraction</a></div><div class="ttdeci">int coord_fraction(int ndom, int ichoice, double x[], int ii[], double frac[], int *nelem)</div></div>
<div class="ttc" id="import__cylindrical_8c_html_a099bc7b5a9501685180c163c1ffb67d0"><div class="ttname"><a href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a></div><div class="ttdeci">double x[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00033">import_cylindrical.c:33</a></div></div>
<div class="ttc" id="cylindrical_8c_html_a13144d35b1d57cfa570b6e59d225f474"><div class="ttname"><a href="cylindrical_8c.html#a13144d35b1d57cfa570b6e59d225f474">cylind_volumes</a></div><div class="ttdeci">int cylind_volumes(int ndom, WindPtr w)</div><div class="ttdoc">Calculates the wind volume for cells in a cylindrical domain allowing for the fact that some cells ar...</div><div class="ttdef"><b>Definition:</b> <a href="cylindrical_8c_source.html#l00367">cylindrical.c:367</a></div></div>
<div class="ttc" id="structgeometry_html_a781ad48d18a8d675b84414f1ba7a352d"><div class="ttname"><a href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">geometry::ndomain</a></div><div class="ttdeci">int ndomain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00312">python.h:312</a></div></div>
<div class="ttc" id="structphoton_html"><div class="ttname"><a href="structphoton.html">photon</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01034">python.h:1034</a></div></div>
<div class="ttc" id="structwind_html_a9e48704d3e2881e8cd2fef227c0ba8cd"><div class="ttname"><a href="structwind.html#a9e48704d3e2881e8cd2fef227c0ba8cd">wind::dfudge</a></div><div class="ttdeci">double dfudge</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00714">python.h:714</a></div></div>
<div class="ttc" id="structgeometry_html_a6f369fbf8e117ef039235b7f20d04e32"><div class="ttname"><a href="structgeometry.html#a6f369fbf8e117ef039235b7f20d04e32">geometry::ndim2</a></div><div class="ttdeci">int ndim2</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00313">python.h:313</a></div></div>
<div class="ttc" id="foo_8h_html_a00bbfc05ca86bbb87a4c69019564af5d"><div class="ttname"><a href="foo_8h.html#a00bbfc05ca86bbb87a4c69019564af5d">rtheta_get_random_location</a></div><div class="ttdeci">int rtheta_get_random_location(int n, double x[])</div></div>
<div class="ttc" id="cooling_8c_html_acbbafed45b10980bb86fe7950daa0604"><div class="ttname"><a href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604">adiabatic_cooling</a></div><div class="ttdeci">double adiabatic_cooling(WindPtr one, double t)</div><div class="ttdoc">determines the amount of adiabatic cooling in a cell, in units of luminosity. </div><div class="ttdef"><b>Definition:</b> <a href="cooling_8c_source.html#l00270">cooling.c:270</a></div></div>
<div class="ttc" id="structplasma_html_a438272ea5c79f26453f113fe023e9c99"><div class="ttname"><a href="structplasma.html#a438272ea5c79f26453f113fe023e9c99">plasma::dt_e_old</a></div><div class="ttdeci">double dt_e_old</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00780">python.h:780</a></div></div>
<div class="ttc" id="cylindrical_8c_html_a56507e563e08709e70d77a7ccd538ee3"><div class="ttname"><a href="cylindrical_8c.html#a56507e563e08709e70d77a7ccd538ee3">cylind_make_grid</a></div><div class="ttdeci">int cylind_make_grid(int ndom, WindPtr w)</div><div class="ttdoc">defines the cells in a cylindrical grid </div><div class="ttdef"><b>Definition:</b> <a href="cylindrical_8c_source.html#l00157">cylindrical.c:157</a></div></div>
<div class="ttc" id="python_8h_html_af1850805984fe5f20591259a19db6ffd"><div class="ttname"><a href="python_8h.html#af1850805984fe5f20591259a19db6ffd">HYDRO</a></div><div class="ttdeci">#define HYDRO</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00148">python.h:148</a></div></div>
<div class="ttc" id="wind2d_8c_html_a8fe8eb8bacb888783ada9dd32b523e1a"><div class="ttname"><a href="wind2d_8c.html#a8fe8eb8bacb888783ada9dd32b523e1a">wind_div_err</a></div><div class="ttdeci">int wind_div_err</div><div class="ttdoc">calculates the divergence of the velocity at the center of all the grid cells. </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00843">wind2d.c:843</a></div></div>
<div class="ttc" id="python_8h_html_a3a571e0bd4220490c5c5bd86f51c83ba"><div class="ttname"><a href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a></div><div class="ttdeci">struct geometry geo</div></div>
<div class="ttc" id="foo_8h_html_a43492c595dcd8568e2c14a8496c8fd43"><div class="ttname"><a href="foo_8h.html#a43492c595dcd8568e2c14a8496c8fd43">calloc_estimators</a></div><div class="ttdeci">int calloc_estimators(int nelem)</div><div class="ttdoc">Dynamically allocate various arrays in macromain. </div><div class="ttdef"><b>Definition:</b> <a href="gridwind_8c_source.html#l00388">gridwind.c:388</a></div></div>
<div class="ttc" id="wind2d_8c_html_a7ca398a2557e2b63247eac4366bc2e4f"><div class="ttname"><a href="wind2d_8c.html#a7ca398a2557e2b63247eac4366bc2e4f">vwind_xyz</a></div><div class="ttdeci">int vwind_xyz(int ndom, PhotPtr p, v)</div><div class="ttdoc">finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p...</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00742">wind2d.c:742</a></div></div>
<div class="ttc" id="structplasma_html_ab5b2a9cf34eb1359961d6783a81ea266"><div class="ttname"><a href="structplasma.html#ab5b2a9cf34eb1359961d6783a81ea266">plasma::fmax_mod</a></div><div class="ttdeci">double fmax_mod[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00831">python.h:831</a></div></div>
<div class="ttc" id="wind2d_8c_html_ad47569135f21d4ce22504b0ad5b0b221"><div class="ttname"><a href="wind2d_8c.html#ad47569135f21d4ce22504b0ad5b0b221">wind_div_v</a></div><div class="ttdeci">int wind_div_v(WindPtr w)</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00846">wind2d.c:846</a></div></div>
<div class="ttc" id="foo_8h_html_a01eb12e765998d3b9b350b3d8834347f"><div class="ttname"><a href="foo_8h.html#a01eb12e765998d3b9b350b3d8834347f">spherical_get_random_location</a></div><div class="ttdeci">int spherical_get_random_location(int n, double x[])</div></div>
<div class="ttc" id="import__spherical_8c_html_ac2915aad3a05ff2328a7ad7fa6d37e86"><div class="ttname"><a href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a></div><div class="ttdeci">double v[NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__spherical_8c_source.html#l00038">import_spherical.c:38</a></div></div>
<div class="ttc" id="python_8h_html_aa9036711b4d1f8345faed617d50f57aa"><div class="ttname"><a href="python_8h.html#aa9036711b4d1f8345faed617d50f57aa">NPLASMA</a></div><div class="ttdeci">int NPLASMA</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00032">python.h:32</a></div></div>
<div class="ttc" id="structplasma_html_a9b46e8bed0dfadca5cf9966301ecec6d"><div class="ttname"><a href="structplasma.html#a9b46e8bed0dfadca5cf9966301ecec6d">plasma::exp_w</a></div><div class="ttdeci">double exp_w[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00897">python.h:897</a></div></div>
<div class="ttc" id="python_8h_html_ac640b7fc429348ef2f6781704d3c5163"><div class="ttname"><a href="python_8h.html#ac640b7fc429348ef2f6781704d3c5163">NXBANDS</a></div><div class="ttdeci">#define NXBANDS</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00473">python.h:473</a></div></div>
<div class="ttc" id="structplasma_html_a79f84fac2bd8b8ee286bf33092531f18"><div class="ttname"><a href="structplasma.html#a79f84fac2bd8b8ee286bf33092531f18">plasma::fmin_mod</a></div><div class="ttdeci">double fmin_mod[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00830">python.h:830</a></div></div>
<div class="ttc" id="wind2d_8c_html_a078472458c0ac73f723c094fc2121c14"><div class="ttname"><a href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a></div><div class="ttdeci">double rho(WindPtr w, x)</div><div class="ttdoc">find the density of the wind at x </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00941">wind2d.c:941</a></div></div>
<div class="ttc" id="structplasma_html_aba12a0eea107e923bad5f26cb012e72a"><div class="ttname"><a href="structplasma.html#aba12a0eea107e923bad5f26cb012e72a">plasma::xscatters</a></div><div class="ttdeci">double * xscatters</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00816">python.h:816</a></div></div>
<div class="ttc" id="structplasma_html_a2b0e1368d0adfd432627a2ceedebb704"><div class="ttname"><a href="structplasma.html#a2b0e1368d0adfd432627a2ceedebb704">plasma::PWdenom</a></div><div class="ttdeci">double * PWdenom</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00750">python.h:750</a></div></div>
<div class="ttc" id="structdomain_html_ab3733bfe4bcdd87edd4f59da33e85d46"><div class="ttname"><a href="structdomain.html#ab3733bfe4bcdd87edd4f59da33e85d46">domain::nstop</a></div><div class="ttdeci">int nstop</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00205">python.h:205</a></div></div>
<div class="ttc" id="foo_8h_html_a626b1882e2533441cdf2daabd36e8a8b"><div class="ttname"><a href="foo_8h.html#a626b1882e2533441cdf2daabd36e8a8b">ion_abundances</a></div><div class="ttdeci">int ion_abundances(PlasmaPtr xplasma, int mode)</div><div class="ttdoc">ionization routines for the wind one cell at a time </div><div class="ttdef"><b>Definition:</b> <a href="ionization_8c_source.html#l00039">ionization.c:39</a></div></div>
<div class="ttc" id="cylind__var_8c_html_a32c03e10ad1712cb98a72b444cca5499"><div class="ttname"><a href="cylind__var_8c.html#a32c03e10ad1712cb98a72b444cca5499">cylvar_where_in_grid</a></div><div class="ttdeci">int cylvar_where_in_grid(int ndom, x, int ichoice, double *fx, double *fz)</div><div class="ttdoc">locates the grid position of the vector, when one is using modified cylindrical coordinates, with the z heights varying. </div><div class="ttdef"><b>Definition:</b> <a href="cylind__var_8c_source.html#l00712">cylind_var.c:712</a></div></div>
<div class="ttc" id="structplasma_html_a2651f0307bf16fc9febad1be3c7bbfd0"><div class="ttname"><a href="structplasma.html#a2651f0307bf16fc9febad1be3c7bbfd0">plasma::PWdtemp</a></div><div class="ttdeci">double * PWdtemp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00754">python.h:754</a></div></div>
<div class="ttc" id="python_8h_html_a052ca1b9e5f22b4f5ad1b3cc8d07cb1c"><div class="ttname"><a href="python_8h.html#a052ca1b9e5f22b4f5ad1b3cc8d07cb1c">nerr_no_Jmodel</a></div><div class="ttdeci">int nerr_no_Jmodel</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01334">python.h:1334</a></div></div>
<div class="ttc" id="python_8h_html"><div class="ttname"><a href="python_8h.html">python.h</a></div></div>
<div class="ttc" id="atomic_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="atomic_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00018">atomic.h:18</a></div></div>
<div class="ttc" id="structgeometry_html_a7384383e4129a0341c5a1a27a68d7947"><div class="ttname"><a href="structgeometry.html#a7384383e4129a0341c5a1a27a68d7947">geometry::rstar</a></div><div class="ttdeci">double rstar</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00362">python.h:362</a></div></div>
<div class="ttc" id="wind2d_8c_html_a980ea04ae2c501a6df12080eb698a851"><div class="ttname"><a href="wind2d_8c.html#a980ea04ae2c501a6df12080eb698a851">check_grid</a></div><div class="ttdeci">int check_grid()</div><div class="ttdoc">check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might ...</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01313">wind2d.c:1313</a></div></div>
<div class="ttc" id="atomic_8h_html_a9dc9286373de87e475724fbd5e8c0435"><div class="ttname"><a href="atomic_8h.html#a9dc9286373de87e475724fbd5e8c0435">rho2nh</a></div><div class="ttdeci">double rho2nh</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00096">atomic.h:96</a></div></div>
<div class="ttc" id="foo_8h_html_a38134c43cdc9afb2ef078514b06b4f88"><div class="ttname"><a href="foo_8h.html#a38134c43cdc9afb2ef078514b06b4f88">rtheta_make_hydro_grid</a></div><div class="ttdeci">int rtheta_make_hydro_grid(WindPtr w, int ndom)</div><div class="ttdoc">Defines an r-theta grid to accept a hydro model. </div><div class="ttdef"><b>Definition:</b> <a href="hydro__import_8c_source.html#l00702">hydro_import.c:702</a></div></div>
<div class="ttc" id="wind2d_8c_html_ae1705b3b8167c7d811573af4a3bd063d"><div class="ttname"><a href="wind2d_8c.html#ae1705b3b8167c7d811573af4a3bd063d">wig_n</a></div><div class="ttdeci">int wig_n</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00558">wind2d.c:558</a></div></div>
<div class="ttc" id="wind2d_8c_html_a675b4d912b5b505f099fc17031660393"><div class="ttname"><a href="wind2d_8c.html#a675b4d912b5b505f099fc17031660393">zero_scatters</a></div><div class="ttdeci">int zero_scatters()</div><div class="ttdoc">zero out the portion of plasmamain that records the number of scatters in each cell ...</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01151">wind2d.c:1151</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_a0d9c8cbc461c7cf86cad8e548f195bd1"><div class="ttname"><a href="import__cylindrical_8c.html#a0d9c8cbc461c7cf86cad8e548f195bd1">ndim</a></div><div class="ttdeci">int ndim</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00030">import_cylindrical.c:30</a></div></div>
<div class="ttc" id="foo_8h_html_a7406e8182dece78e2612793e400d1540"><div class="ttname"><a href="foo_8h.html#a7406e8182dece78e2612793e400d1540">spherical_where_in_grid</a></div><div class="ttdeci">int spherical_where_in_grid(int ndom, double x[])</div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566a846d4c91b0c7b7726f9e1d60a5aabeb3">CYLVAR</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00136">python.h:136</a></div></div>
<div class="ttc" id="log_8h_html_a4f4caa375f1c3a9def422000f305cce5"><div class="ttname"><a href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="ttdeci">int Error(char *format,...)</div><div class="ttdoc">Print/write out an error message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00402">xlog.c:402</a></div></div>
<div class="ttc" id="atomic_8h_html"><div class="ttname"><a href="atomic_8h.html">atomic.h</a></div></div>
<div class="ttc" id="wind2d_8c_html_ac98ab21bbcfcfc326f0b16fabd5587c0"><div class="ttname"><a href="wind2d_8c.html#ac98ab21bbcfcfc326f0b16fabd5587c0">NSTEPS</a></div><div class="ttdeci">#define NSTEPS</div><div class="ttdoc">The routine calculates and then logs the mass loss rate in two ways. </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01008">wind2d.c:1008</a></div></div>
<div class="ttc" id="structdomain_html_aa557b63d514dffedaf76a635579b3294"><div class="ttname"><a href="structdomain.html#aa557b63d514dffedaf76a635579b3294">domain::mdim</a></div><div class="ttdeci">int mdim</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00204">python.h:204</a></div></div>
<div class="ttc" id="structgeometry_html_a98d8096a2c1b3144efd5899f25402f7d"><div class="ttname"><a href="structgeometry.html#a98d8096a2c1b3144efd5899f25402f7d">geometry::ioniz_mode</a></div><div class="ttdeci">int ioniz_mode</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00406">python.h:406</a></div></div>
<div class="ttc" id="structplasma_html_a0dbad3f32ea372492eb73eda0f123899"><div class="ttname"><a href="structplasma.html#a0dbad3f32ea372492eb73eda0f123899">plasma::pl_alpha</a></div><div class="ttdeci">double pl_alpha[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00892">python.h:892</a></div></div>
<div class="ttc" id="structgeometry_html_a4f5794e0b4b6ed3e93a1cbd284132a17"><div class="ttname"><a href="structgeometry.html#a4f5794e0b4b6ed3e93a1cbd284132a17">geometry::adiabatic</a></div><div class="ttdeci">int adiabatic</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00493">python.h:493</a></div></div>
<div class="ttc" id="structplasma_html_a30222105e41ccde304250f41d25b5ad7"><div class="ttname"><a href="structplasma.html#a30222105e41ccde304250f41d25b5ad7">plasma::exp_temp</a></div><div class="ttdeci">double exp_temp[NXBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00896">python.h:896</a></div></div>
<div class="ttc" id="python_8h_html_a6e3bf2cbb457970f2ae23c746e8f8ea5"><div class="ttname"><a href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a></div><div class="ttdeci">DomainPtr zdom</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00275">python.h:275</a></div></div>
<div class="ttc" id="structwind_html_a289fcd4f4c7e344d112785545192cffe"><div class="ttname"><a href="structwind.html#a289fcd4f4c7e344d112785545192cffe">wind::xcen</a></div><div class="ttdeci">double xcen[3]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00698">python.h:698</a></div></div>
<div class="ttc" id="python_8h_html_a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495"><div class="ttname"><a href="python_8h.html#a0a67e9069ac2a2910ddc33cb34df0566adea6071dc3801da68464b30fa7cfe495">RTHETA</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00135">python.h:135</a></div></div>
<div class="ttc" id="cylindrical_8c_html_ab19f6786630fce8ae46bbd702d80d59b"><div class="ttname"><a href="cylindrical_8c.html#ab19f6786630fce8ae46bbd702d80d59b">cylind_get_random_location</a></div><div class="ttdeci">int cylind_get_random_location(int n, x)</div><div class="ttdoc">Generate a position at a random location within a specific cell of a domain with cylindrical coordina...</div><div class="ttdef"><b>Definition:</b> <a href="cylindrical_8c_source.html#l00587">cylindrical.c:587</a></div></div>
<div class="ttc" id="structdomain_html_ac90e4779abcabc0170d2bfc30a8e1323"><div class="ttname"><a href="structdomain.html#ac90e4779abcabc0170d2bfc30a8e1323">domain::ndim</a></div><div class="ttdeci">int ndim</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00204">python.h:204</a></div></div>
<div class="ttc" id="python_8h_html_a3f1d4b496aaedc6d1860048e675006ff"><div class="ttname"><a href="python_8h.html#a3f1d4b496aaedc6d1860048e675006ff">IONMODE_FIXED</a></div><div class="ttdeci">#define IONMODE_FIXED</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01014">python.h:1014</a></div></div>
<div class="ttc" id="structadvanced__modes_html_aad0ff1589062988053354087930055bb"><div class="ttname"><a href="structadvanced__modes.html#aad0ff1589062988053354087930055bb">advanced_modes::fixed_temp</a></div><div class="ttdeci">int fixed_temp</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01357">python.h:1357</a></div></div>
<div class="ttc" id="structwind_html_a86864abe3bc4d97d1b4c305f085c6c55"><div class="ttname"><a href="structwind.html#a86864abe3bc4d97d1b4c305f085c6c55">wind::vol</a></div><div class="ttdeci">double vol</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00711">python.h:711</a></div></div>
<div class="ttc" id="atomic_8h_html_aa1487dae81baa2e0a5643e7b571633a0"><div class="ttname"><a href="atomic_8h.html#aa1487dae81baa2e0a5643e7b571633a0">BOLTZMANN</a></div><div class="ttdeci">#define BOLTZMANN</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00013">atomic.h:13</a></div></div>
<div class="ttc" id="foo_8h_html_a2c852998cd074100b68f8750a8d8ca99"><div class="ttname"><a href="foo_8h.html#a2c852998cd074100b68f8750a8d8ca99">where_in_wind</a></div><div class="ttdeci">int where_in_wind(double x[], int *ndomain)</div></div>
<div class="ttc" id="import__cylindrical_8c_html_a136f2755339206755ab0c02f8e53c5fc"><div class="ttname"><a href="import__cylindrical_8c.html#a136f2755339206755ab0c02f8e53c5fc">z</a></div><div class="ttdeci">double z[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00033">import_cylindrical.c:33</a></div></div>
<div class="ttc" id="foo_8h_html_a655c28bba6dc25187e6173f6787364c4"><div class="ttname"><a href="foo_8h.html#a655c28bba6dc25187e6173f6787364c4">dvds_ave</a></div><div class="ttdeci">int dvds_ave(void)</div><div class="ttdoc">Calculate the direction averaged (and maximum) dv_ds in each grid cell of the wind. </div><div class="ttdef"><b>Definition:</b> <a href="gradv_8c_source.html#l00191">gradv.c:191</a></div></div>
<div class="ttc" id="atomic_8h_html_a8bc97ad38b30a4ad622f7ebba5654485"><div class="ttname"><a href="atomic_8h.html#a8bc97ad38b30a4ad622f7ebba5654485">THOMPSON</a></div><div class="ttdeci">#define THOMPSON</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00017">atomic.h:17</a></div></div>
<div class="ttc" id="log_8h_html_aaadbb20af7b628f26e81e4e49b1a379f"><div class="ttname"><a href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f">sane_check</a></div><div class="ttdeci">int sane_check(double x)</div><div class="ttdoc">Check that a variable is valid double precision number. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00528">xlog.c:528</a></div></div>
<div class="ttc" id="structphoton_html_a279232990e041c1535ce72fdd34c359d"><div class="ttname"><a href="structphoton.html#a279232990e041c1535ce72fdd34c359d">photon::x</a></div><div class="ttdeci">double x[3]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01036">python.h:1036</a></div></div>
<div class="ttc" id="structplasma_html"><div class="ttname"><a href="structplasma.html">plasma</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00737">python.h:737</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_ad9db47ad8a21025384c0b7f8fc0a61cc"><div class="ttname"><a href="import__cylindrical_8c.html#ad9db47ad8a21025384c0b7f8fc0a61cc">j</a></div><div class="ttdeci">int j[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00031">import_cylindrical.c:31</a></div></div>
<div class="ttc" id="foo_8h_html_a779ccebed86e21a9d217673baf5da757"><div class="ttname"><a href="foo_8h.html#a779ccebed86e21a9d217673baf5da757">length</a></div><div class="ttdeci">double length(double a[])</div></div>
<div class="ttc" id="python_8h_html_a940291848296c285c722ed248863afc1"><div class="ttname"><a href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a></div><div class="ttdeci">WindPtr wmain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00724">python.h:724</a></div></div>
<div class="ttc" id="structdomain_html_aeddcae5f993efc8142ee84f461cfcda1"><div class="ttname"><a href="structdomain.html#aeddcae5f993efc8142ee84f461cfcda1">domain::nstart</a></div><div class="ttdeci">int nstart</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00205">python.h:205</a></div></div>
<div class="ttc" id="structplasma_html_aeffd93110218aa8876f074488b026390"><div class="ttname"><a href="structplasma.html#aeffd93110218aa8876f074488b026390">plasma::rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00742">python.h:742</a></div></div>
<div class="ttc" id="structplasma_html_a174c204665ec6522d9c1dad57408b577"><div class="ttname"><a href="structplasma.html#a174c204665ec6522d9c1dad57408b577">plasma::dt_e</a></div><div class="ttdeci">double dt_e</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00780">python.h:780</a></div></div>
<div class="ttc" id="structplasma_html_a56c7e960c18e2fc47a147877bc9e5fe8"><div class="ttname"><a href="structplasma.html#a56c7e960c18e2fc47a147877bc9e5fe8">plasma::nwind</a></div><div class="ttdeci">int nwind</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00739">python.h:739</a></div></div>
<div class="ttc" id="structwind_html_aa79ef3a918f25e67318af1200ea49bd7"><div class="ttname"><a href="structwind.html#aa79ef3a918f25e67318af1200ea49bd7">wind::x</a></div><div class="ttdeci">double x[3]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00697">python.h:697</a></div></div>
<div class="ttc" id="structgeometry_html_a27207d7b4e1bef1c57a659354ff5cee9"><div class="ttname"><a href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">geometry::rt_mode</a></div><div class="ttdeci">int rt_mode</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00458">python.h:458</a></div></div>
<div class="ttc" id="structgeometry_html_abb5c7c693f6694c7060addeefc8bc9b8"><div class="ttname"><a href="structgeometry.html#abb5c7c693f6694c7060addeefc8bc9b8">geometry::twind_init</a></div><div class="ttdeci">double twind_init</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00366">python.h:366</a></div></div>
<div class="ttc" id="structwind_html_aaa7f27e1a93690e4c37878a93c40db22"><div class="ttname"><a href="structwind.html#aaa7f27e1a93690e4c37878a93c40db22">wind::ndom</a></div><div class="ttdeci">int ndom</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00694">python.h:694</a></div></div>
<div class="ttc" id="structgeometry_html_a54d0a2d5699ed4af1353429a7ec652bb"><div class="ttname"><a href="structgeometry.html#a54d0a2d5699ed4af1353429a7ec652bb">geometry::tmax</a></div><div class="ttdeci">double tmax</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00367">python.h:367</a></div></div>
<div class="ttc" id="foo_8h_html_a9bbb384b23069ca08613aa2396fcbee3"><div class="ttname"><a href="foo_8h.html#a9bbb384b23069ca08613aa2396fcbee3">hydro_temp</a></div><div class="ttdeci">double hydro_temp(double x[])</div></div>
<div class="ttc" id="wind2d_8c_html_a558bbf4d12656ab12c2a03f6475b0eee"><div class="ttname"><a href="wind2d_8c.html#a558bbf4d12656ab12c2a03f6475b0eee">mdot_wind</a></div><div class="ttdeci">int mdot_wind(WindPtr w, double z, double rmax)</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01011">wind2d.c:1011</a></div></div>
<div class="ttc" id="version_8h_html_a22995efd1bf00d607d61f25430f44db2"><div class="ttname"><a href="version_8h.html#a22995efd1bf00d607d61f25430f44db2">CHOICE</a></div><div class="ttdeci">#define CHOICE</div><div class="ttdef"><b>Definition:</b> <a href="version_8h_source.html#l00002">version.h:2</a></div></div>
<div class="ttc" id="foo_8h_html_aa5de177d6e8fc4d6d0becf0c2898b90d"><div class="ttname"><a href="foo_8h.html#aa5de177d6e8fc4d6d0becf0c2898b90d">wind_check</a></div><div class="ttdeci">int wind_check(WindPtr www, int n)</div><div class="ttdoc">Simple checks of the wind structure for reasonability. </div><div class="ttdef"><b>Definition:</b> <a href="wind_8c_source.html#l00460">wind.c:460</a></div></div>
<div class="ttc" id="foo_8h_html_a4cb6c91545a34b48e5d6cd74a68665de"><div class="ttname"><a href="foo_8h.html#a4cb6c91545a34b48e5d6cd74a68665de">rtheta_make_grid</a></div><div class="ttdeci">int rtheta_make_grid(WindPtr w, int ndom)</div><div class="ttdoc">Set up an rtheta grid. </div><div class="ttdef"><b>Definition:</b> <a href="rtheta_8c_source.html#l00135">rtheta.c:135</a></div></div>
<div class="ttc" id="foo_8h_html_a547dbd45aa816e77d574b6bf3deb6b65"><div class="ttname"><a href="foo_8h.html#a547dbd45aa816e77d574b6bf3deb6b65">model_vgrad</a></div><div class="ttdeci">int model_vgrad(int ndom, double x[], double v_grad[][3])</div></div>
<div class="ttc" id="python_8h_html_a0db8a9b5ad5a66e4adc36d0ba68735c8"><div class="ttname"><a href="python_8h.html#a0db8a9b5ad5a66e4adc36d0ba68735c8">SHELL</a></div><div class="ttdeci">#define SHELL</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00154">python.h:154</a></div></div>
<div class="ttc" id="cylindrical_8c_html_a88a4510bced469b493b0a16a8b2308ba"><div class="ttname"><a href="cylindrical_8c.html#a88a4510bced469b493b0a16a8b2308ba">cylind_where_in_grid</a></div><div class="ttdeci">int cylind_where_in_grid(int ndom, x)</div><div class="ttdoc">locates the grid position of the vector, when one is using cylindrical coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="cylindrical_8c_source.html#l00516">cylindrical.c:516</a></div></div>
<div class="ttc" id="python_8h_html_af5711847369600743b86dd27343fab7a"><div class="ttname"><a href="python_8h.html#af5711847369600743b86dd27343fab7a">plasmamain</a></div><div class="ttdeci">PlasmaPtr plasmamain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00904">python.h:904</a></div></div>
<div class="ttc" id="structwind_html_a7f4f2ec3bc9cea1d4dec351b026b9a73"><div class="ttname"><a href="structwind.html#a7f4f2ec3bc9cea1d4dec351b026b9a73">wind::inwind</a></div><div class="ttdeci">enum wind::inwind_enum inwind</div></div>
<div class="ttc" id="cylind__var_8c_html_a95a5dd7b17dd91fc7d21b44ee290d256"><div class="ttname"><a href="cylind__var_8c.html#a95a5dd7b17dd91fc7d21b44ee290d256">cylvar_make_grid</a></div><div class="ttdeci">int cylvar_make_grid(WindPtr w, int ndom)</div><div class="ttdoc">defines the cells in a cylindrical grid when the disk is vertically extended. </div><div class="ttdef"><b>Definition:</b> <a href="cylind__var_8c_source.html#l00220">cylind_var.c:220</a></div></div>
<div class="ttc" id="import__rtheta_8c_html_af48f2a5d53f764daa5ebf5ca0c72bb01"><div class="ttname"><a href="import__rtheta_8c.html#af48f2a5d53f764daa5ebf5ca0c72bb01">r</a></div><div class="ttdeci">double r[NDIM_MAX *NDIM_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="import__rtheta_8c_source.html#l00046">import_rtheta.c:46</a></div></div>
<div class="ttc" id="foo_8h_html_a284ee938adda5964f70e57cf3517bb93"><div class="ttname"><a href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93">dot</a></div><div class="ttdeci">double dot(double a[], double b[])</div></div>
<div class="ttc" id="structgeometry_html_a9a16f5c129fc954fd15b38e3cab8e12d"><div class="ttname"><a href="structgeometry.html#a9a16f5c129fc954fd15b38e3cab8e12d">geometry::alpha_agn</a></div><div class="ttdeci">double alpha_agn</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00558">python.h:558</a></div></div>
<div class="ttc" id="python_8h_html_abd3bd3747823216853035911ad285c91"><div class="ttname"><a href="python_8h.html#abd3bd3747823216853035911ad285c91">NDIM2</a></div><div class="ttdeci">int NDIM2</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00031">python.h:31</a></div></div>
<div class="ttc" id="atomic_8h_html_a69a2ae3d514b40bbc28d389b2cebe4dd"><div class="ttname"><a href="atomic_8h.html#a69a2ae3d514b40bbc28d389b2cebe4dd">nions</a></div><div class="ttdeci">int nions</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00057">atomic.h:57</a></div></div>
<div class="ttc" id="foo_8h_html_a3055ceed3869697bc2a3091fd0663900"><div class="ttname"><a href="foo_8h.html#a3055ceed3869697bc2a3091fd0663900">model_rho</a></div><div class="ttdeci">double model_rho(int ndom, double x[])</div></div>
<div class="ttc" id="structplasma_html_acf37090e0b83fe81d058f21229a90018"><div class="ttname"><a href="structplasma.html#acf37090e0b83fe81d058f21229a90018">plasma::cool_adiabatic</a></div><div class="ttdeci">double cool_adiabatic</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00843">python.h:843</a></div></div>
<div class="ttc" id="structwind_html_a25a5b831a64c649f280da38e9b8821d9"><div class="ttname"><a href="structwind.html#a25a5b831a64c649f280da38e9b8821d9">wind::div_v</a></div><div class="ttdeci">double div_v</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00708">python.h:708</a></div></div>
<div class="ttc" id="structdomain_html_af919432b7fbe13685cae0fcbc98f4e8f"><div class="ttname"><a href="structdomain.html#af919432b7fbe13685cae0fcbc98f4e8f">domain::fill</a></div><div class="ttdeci">double fill</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00271">python.h:271</a></div></div>
<div class="ttc" id="structwind_html_a9e2fcac3826b36b7a4eed3eb74f45ede"><div class="ttname"><a href="structwind.html#a9e2fcac3826b36b7a4eed3eb74f45ede">wind::v</a></div><div class="ttdeci">double v[3]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00705">python.h:705</a></div></div>
<div class="ttc" id="foo_8h_html_a67af2cd841a922ea1001654449239284"><div class="ttname"><a href="foo_8h.html#a67af2cd841a922ea1001654449239284">create_maps</a></div><div class="ttdeci">int create_maps(int ichoice)</div><div class="ttdoc">Create a map between wind and plasma cells. </div><div class="ttdef"><b>Definition:</b> <a href="gridwind_8c_source.html#l00088">gridwind.c:88</a></div></div>
<div class="ttc" id="foo_8h_html_a16377719f4171d75f5aa983c79476590"><div class="ttname"><a href="foo_8h.html#a16377719f4171d75f5aa983c79476590">rtheta_volumes</a></div><div class="ttdeci">int rtheta_volumes(int ndom, WindPtr w)</div><div class="ttdoc">rtheta_volume(w) calculates the wind volume of a cell in rtheta coordinate sysem allowing for the fac...</div><div class="ttdef"><b>Definition:</b> <a href="rtheta_8c_source.html#l00434">rtheta.c:434</a></div></div>
<div class="ttc" id="structplasma_html_ada2361ccbc0c5103f58d097af8b5dfe7"><div class="ttname"><a href="structplasma.html#ada2361ccbc0c5103f58d097af8b5dfe7">plasma::scatters</a></div><div class="ttdeci">int * scatters</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00815">python.h:815</a></div></div>
<div class="ttc" id="structplasma_html_a4d5152400f3815e3097ef30ff27aec5c"><div class="ttname"><a href="structplasma.html#a4d5152400f3815e3097ef30ff27aec5c">plasma::PWnumer</a></div><div class="ttdeci">double * PWnumer</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00755">python.h:755</a></div></div>
<div class="ttc" id="foo_8h_html_a757c9acbab0a0377cc2757a853d168df"><div class="ttname"><a href="foo_8h.html#a757c9acbab0a0377cc2757a853d168df">import_make_grid</a></div><div class="ttdeci">int import_make_grid(WindPtr w, int ndom)</div><div class="ttdoc">Make the Python grid. </div><div class="ttdef"><b>Definition:</b> <a href="import_8c_source.html#l00112">import.c:112</a></div></div>
<div class="ttc" id="wind2d_8c_html_a41ee5cb999f1d4258673b6134394b4cc"><div class="ttname"><a href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc">define_wind</a></div><div class="ttdeci">int define_wind()</div><div class="ttdoc">initializes the structures which characterize the wind, including wmain and plasmamain. </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00043">wind2d.c:43</a></div></div>
<div class="ttc" id="foo_8h_html_a1c6dbd2946a218d14cf553a59e41d189"><div class="ttname"><a href="foo_8h.html#a1c6dbd2946a218d14cf553a59e41d189">spherical_volumes</a></div><div class="ttdeci">int spherical_volumes(int ndom, WindPtr w)</div><div class="ttdoc">spherical_volume(w) calculates the wind volume of cell allowing for the fact that some cells are part...</div><div class="ttdef"><b>Definition:</b> <a href="spherical_8c_source.html#l00272">spherical.c:272</a></div></div>
<div class="ttc" id="foo_8h_html_af3449f72ae22aca485dfaa4d2f5ae300"><div class="ttname"><a href="foo_8h.html#af3449f72ae22aca485dfaa4d2f5ae300">calloc_wind</a></div><div class="ttdeci">int calloc_wind(int nelem)</div><div class="ttdoc">Allocate space for the wind domain. </div><div class="ttdef"><b>Definition:</b> <a href="gridwind_8c_source.html#l00158">gridwind.c:158</a></div></div>
<div class="ttc" id="foo_8h_html_a36f04216329e1a6ede98f9f9e0e3989b"><div class="ttname"><a href="foo_8h.html#a36f04216329e1a6ede98f9f9e0e3989b">rtheta_hydro_volumes</a></div><div class="ttdeci">int rtheta_hydro_volumes(int ndom, WindPtr w)</div><div class="ttdoc">Computes volumes for cells in an r-theta hydro model. </div><div class="ttdef"><b>Definition:</b> <a href="hydro__import_8c_source.html#l00823">hydro_import.c:823</a></div></div>
<div class="ttc" id="python_8h_html_a773175d74e73776d69c3e538f17de1ee"><div class="ttname"><a href="python_8h.html#a773175d74e73776d69c3e538f17de1ee">IMPORT</a></div><div class="ttdeci">#define IMPORT</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00155">python.h:155</a></div></div>
<div class="ttc" id="foo_8h_html_aed64e9379499a741e8a7c42376e20530"><div class="ttname"><a href="foo_8h.html#aed64e9379499a741e8a7c42376e20530">wind_n_to_ij</a></div><div class="ttdeci">int wind_n_to_ij(int ndom, int n, int *i, int *j)</div><div class="ttdoc">Translate a cell number in the wind to the two-d grid position in a specific domain. </div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00539">util.c:539</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="wind2d_8c.html">wind2d.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
