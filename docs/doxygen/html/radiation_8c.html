<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/radiation.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('radiation_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">radiation.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines to update radiation field parameters and to calculate various opacities (free-free, bound-free, etc.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for radiation.c:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2radiation_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2radiation_8c" id="_2_users_2mhewitt_2python_2source_2radiation_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="radiation_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a41275a3aa11c07725ac4e2a98542f23c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a41275a3aa11c07725ac4e2a98542f23c">COLMIN</a>&#160;&#160;&#160;0.01</td></tr>
<tr class="separator:a41275a3aa11c07725ac4e2a98542f23c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adb025e0891ad334d41481551bf785170"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#adb025e0891ad334d41481551bf785170">radiation</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double ds)</td></tr>
<tr class="memdesc:adb025e0891ad334d41481551bf785170"><td class="mdescLeft">&#160;</td><td class="mdescRight">updates the field parameters in the wind and reduces the weight of the photon as a result of the effects of free free, bound-free and Compton scattering. The routine also keeps track of the number of photoionizations for H and He in the cell.  <a href="#adb025e0891ad334d41481551bf785170">More...</a><br /></td></tr>
<tr class="separator:adb025e0891ad334d41481551bf785170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03396c07d161ba11de4a87161c5b6745"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a03396c07d161ba11de4a87161c5b6745">kappa_ff</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, double freq)</td></tr>
<tr class="memdesc:a03396c07d161ba11de4a87161c5b6745"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the free-free opacity allowing for stimulated emission  <a href="#a03396c07d161ba11de4a87161c5b6745">More...</a><br /></td></tr>
<tr class="separator:a03396c07d161ba11de4a87161c5b6745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a426bb5a912e3fd43013ffec072376b4a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a426bb5a912e3fd43013ffec072376b4a">sigma_phot</a> (struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *x_ptr, double freq)</td></tr>
<tr class="memdesc:a426bb5a912e3fd43013ffec072376b4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the photionization crossection due to a Topbase level associated with x_ptr at frequency freq  <a href="#a426bb5a912e3fd43013ffec072376b4a">More...</a><br /></td></tr>
<tr class="separator:a426bb5a912e3fd43013ffec072376b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b943f07de31437e68d5a62c4d007588"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a9b943f07de31437e68d5a62c4d007588">sigma_phot_verner</a> (struct <a class="el" href="structinnershell.html">innershell</a> *x_ptr, double freq)</td></tr>
<tr class="memdesc:a9b943f07de31437e68d5a62c4d007588"><td class="mdescLeft">&#160;</td><td class="mdescRight">double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x_ptr at frequency freq (when the data is in the form of the Verner x-sections  <a href="#a9b943f07de31437e68d5a62c4d007588">More...</a><br /></td></tr>
<tr class="separator:a9b943f07de31437e68d5a62c4d007588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a80c6ec538ad7bf2b546126bac374bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a7a80c6ec538ad7bf2b546126bac374bf">den_config</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int nconf)</td></tr>
<tr class="memdesc:a7a80c6ec538ad7bf2b546126bac374bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the precalculated density of a particular "nlte" level.  <a href="#a7a80c6ec538ad7bf2b546126bac374bf">More...</a><br /></td></tr>
<tr class="separator:a7a80c6ec538ad7bf2b546126bac374bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae75016283af89e14ba37126d5763d2ba"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#ae75016283af89e14ba37126d5763d2ba">pop_kappa_ff_array</a> ()</td></tr>
<tr class="memdesc:ae75016283af89e14ba37126d5763d2ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">populates the multiplicative constant, including a gaunt factor, to be used in the calculating free free emission (and absorption).  <a href="#ae75016283af89e14ba37126d5763d2ba">More...</a><br /></td></tr>
<tr class="separator:ae75016283af89e14ba37126d5763d2ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80900ce2eec0df06ac63c9eb02d93afa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a80900ce2eec0df06ac63c9eb02d93afa">update_banded_estimators</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double ds, double w_ave)</td></tr>
<tr class="memdesc:a80900ce2eec0df06ac63c9eb02d93afa"><td class="mdescLeft">&#160;</td><td class="mdescRight">updates the estimators required for determining crude spectra in each Plasma cell  <a href="#a80900ce2eec0df06ac63c9eb02d93afa">More...</a><br /></td></tr>
<tr class="separator:a80900ce2eec0df06ac63c9eb02d93afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a687aa0dcc49f512e562c1e0afddc0263"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a687aa0dcc49f512e562c1e0afddc0263">mean_intensity</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, double freq, int mode)</td></tr>
<tr class="memdesc:a687aa0dcc49f512e562c1e0afddc0263"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns a value for the mean intensity  <a href="#a687aa0dcc49f512e562c1e0afddc0263">More...</a><br /></td></tr>
<tr class="separator:a687aa0dcc49f512e562c1e0afddc0263"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5ae16091f569647cb54c38a0d745822f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="radiation_8c.html#a5ae16091f569647cb54c38a0d745822f">iicount</a> = 0</td></tr>
<tr class="separator:a5ae16091f569647cb54c38a0d745822f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines to update radiation field parameters and to calculate various opacities (free-free, bound-free, etc. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a41275a3aa11c07725ac4e2a98542f23c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41275a3aa11c07725ac4e2a98542f23c">&#9670;&nbsp;</a></span>COLMIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COLMIN&#160;&#160;&#160;0.01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00119">119</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7a80c6ec538ad7bf2b546126bac374bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a80c6ec538ad7bf2b546126bac374bf">&#9670;&nbsp;</a></span>den_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double den_config </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nconf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the precalculated density of a particular "nlte" level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma The Plasma structure containing information about the cell of interest. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nconf The running index that describes which level we are interested in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The density for a particular level of an ion in the cell</dd></dl>
<p>The first case is when the density of the particular level is in the wind array The second case is when the density of the levels for an ion are not tracked, and hence only the total density for the ion is known. In that case, we assume the ion is in it's ground state.</p>
<p>If levels are not defined for an ion it assumes that all ions of are in the ground state.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00895">895</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_a7a80c6ec538ad7bf2b546126bac374bf_icgraph.png" border="0" usemap="#radiation_8c_a7a80c6ec538ad7bf2b546126bac374bf_icgraph" alt=""/></div>
<map name="radiation_8c_a7a80c6ec538ad7bf2b546126bac374bf_icgraph" id="radiation_8c_a7a80c6ec538ad7bf2b546126bac374bf_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a141c8c8db4119b46cba7dcff5de861b3" title="increment the matom bound&#45;free estimators " alt="" coords="129,5,261,32"/>
<area shape="rect" id="node5" href="templates_8h.html#a0b0bdb47e266cd31f1c381bb2410fa80" title="the routine to normalise the matom bb and bf estimators. " alt="" coords="313,56,444,83"/>
<area shape="rect" id="node6" href="templates_8h.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="147,259,243,285"/>
<area shape="rect" id="node26" href="templates_8h.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="147,309,242,336"/>
<area shape="rect" id="node27" href="templates_8h.html#a1d58fccfac7eec74c69412cfabcc5caf" title="computes the total heating due to matom bb transitions " alt="" coords="142,157,247,184"/>
<area shape="rect" id="node28" href="templates_8h.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="143,208,246,235"/>
<area shape="rect" id="node29" href="templates_8h.html#a00d9c108946340fef4c429a9afdeb110" title="sanity check the stimulated recombination rate " alt="" coords="125,107,264,133"/>
<area shape="rect" id="node30" href="templates_8h.html#a9301eba8fb39302ef3da90cdb52aef4d" title="The core of the implementation of Macro Atoms in python. " alt="" coords="169,360,221,387"/>
<area shape="rect" id="node31" href="templates_8h.html#a16ae068adf1746f09c432de7e245dfb1" title="kpkt" alt="" coords="175,411,215,437"/>
<area shape="rect" id="node32" href="py__wind__ion_8c.html#a40d610932ba1f4b936dc8acc2fab5d77" title="Calculate the luminoisty for a specific line. " alt="" coords="153,461,237,488"/>
<area shape="rect" id="node33" href="templates_8h.html#a74e9a1ed7ffcb66086ca24b9cc1d280f" title="is a routine which prints information about departure coefficients and level populations in a cell..." alt="" coords="143,512,246,539"/>
<area shape="rect" id="node35" href="py__wind__macro_8c.html#aad71ef4970632e72236ffe2ca6095e1a" title="gives populations of nconfig in each cell " alt="" coords="124,563,265,589"/>
<area shape="rect" id="node36" href="py__wind__macro_8c.html#ad6e2a0d37288f7f51afea6c8a0d95347" title="is a routine which prints information about departure coefficients and level populations in a cell..." alt="" coords="140,613,249,640"/>
<area shape="rect" id="node37" href="templates_8h.html#adb025e0891ad334d41481551bf785170" title="updates the field parameters in the wind and reduces the weight of the photon as a result of the effe..." alt="" coords="165,664,225,691"/>
<area shape="rect" id="node38" href="templates_8h.html#abbfb58b40faa368dabec2eb9f4b51c89" title="calculates the integrated emissivity of an ion in the plasma. " alt="" coords="163,765,226,792"/>
<area shape="rect" id="node44" href="templates_8h.html#a250e063dde090c67146f51ea71371bfc" title="calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature ..." alt="" coords="149,715,240,741"/>
<area shape="rect" id="node45" href="templates_8h.html#a983dcec5903b4aacfce1c770b20e4ba9" title="calculates the bf opacity in a specific cell. " alt="" coords="163,816,226,843"/>
<area shape="rect" id="node47" href="templates_8h.html#a7d7a0bd03f273ab50a2eabadb685b585" title="computes and stores the set of bound&#45;free processes which make significiant contributions to the opac..." alt="" coords="163,917,226,944"/>
<area shape="rect" id="node48" href="resonate_8c.html#a836209a9286117cc7b27e3e6fa37ef8d" title="double (p,w,l,dvds) calculates tau associated with a resonance, given the conditions in the wind and ..." alt="" coords="167,867,223,893"/>
<area shape="rect" id="node49" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="169,968,221,995"/>
<area shape="rect" id="node3" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="329,5,429,32"/>
<area shape="rect" id="node4" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="528,5,588,32"/>
<area shape="rect" id="node7" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="333,411,424,437"/>
<area shape="rect" id="node19" href="templates_8h.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="336,309,421,336"/>
<area shape="rect" id="node8" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="531,461,585,488"/>
<area shape="rect" id="node9" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="676,461,775,488"/>
<area shape="rect" id="node14" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="685,512,765,539"/>
<area shape="rect" id="node15" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="693,259,758,285"/>
<area shape="rect" id="node10" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="847,462,951,503"/>
<area shape="rect" id="node11" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="827,528,972,555"/>
<area shape="rect" id="node12" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="861,411,937,437"/>
<area shape="rect" id="node13" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="1035,411,1079,437"/>
<area shape="rect" id="node16" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="1026,247,1089,273"/>
<area shape="rect" id="node18" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="873,208,926,235"/>
<area shape="rect" id="node17" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="1143,247,1239,273"/>
<area shape="rect" id="node20" href="templates_8h.html#ae1d27b840ad2ff21462921fc2aab975c" title="calculate the luminosity of the entire wind between freqencies f1 and f2 " alt="" coords="512,411,604,437"/>
<area shape="rect" id="node25" href="py__wind__ion_8c.html#ad8a35c03a0bfe326d010682816b450c4" title="Get the total emission of the cells. " alt="" coords="492,360,624,387"/>
<area shape="rect" id="node21" href="templates_8h.html#a9a0acf2d461c665dc0302defa95ded65" title="calculates the band limited fluxes &amp; luminosities, and prepares for the producting of photons (by rei..." alt="" coords="686,360,765,387"/>
<area shape="rect" id="node24" href="py__wind__sub_8c.html#a5fbfbb635a9e9fcadb5f07319131e4a6" title="heatcool_summary" alt="" coords="672,411,779,437"/>
<area shape="rect" id="node22" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="1020,323,1095,349"/>
<area shape="rect" id="node23" href="templates_8h.html#addfbba966a4d69bdc71b771e0d7f3cdf" title="Determine how many photons to allocate to each band. " alt="" coords="853,360,946,387"/>
<area shape="rect" id="node34" href="py__wind__macro_8c.html#a6e3344441d509e05ca1c82b37fd88318" title="is a routine intended to allow one to display information about macro atoms. It is the top level rout..." alt="" coords="331,563,427,589"/>
<area shape="rect" id="node39" href="templates_8h.html#a7ef12badd64f5bb47d6fccbb217ba805" title="calculates the integrated emissivity of the plasma, or the number of recombinations per second of a p..." alt="" coords="350,765,407,792"/>
<area shape="rect" id="node42" href="templates_8h.html#a86d223ebd7563467934af71d1d8e4552" title="initializes the structure fb_struc as well as some associated arrays and variables (found in python..." alt="" coords="336,715,421,741"/>
<area shape="rect" id="node43" href="templates_8h.html#ab1050097e6dcebb3469479d4fd5ff6c0" title="get the total rediative recombination rate " alt="" coords="345,816,412,843"/>
<area shape="rect" id="node40" href="templates_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="698,765,753,792"/>
<area shape="rect" id="node41" href="templates_8h.html#a7c21266df7327fbc81b2c5cf6b5e067f" title="calculates the total number of recombinations for all of the ions in a cell " alt="" coords="518,816,598,843"/>
<area shape="rect" id="node46" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="340,867,417,893"/>
</map>
</div>

</div>
</div>
<a id="a03396c07d161ba11de4a87161c5b6745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03396c07d161ba11de4a87161c5b6745">&#9670;&nbsp;</a></span>kappa_ff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kappa_ff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the free-free opacity allowing for stimulated emission </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma The plasma cell where the free-free optacity is to be calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq The frequency at which kappa_ff is to be calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>kappa</dd></dl>
<p>Uses the formula from Allen</p>
<h3>Notes</h3>
<p>The routine originally only includes the effect of singly ionized H and doubly ionized He and did not include a gaunt factor</p>
<p>More recent versions include all ions and a gaunt factor, as calculated in pop_kappa_ff_array and stored in kappa_ff_factor. The gaunt factor as currewntly implemented is a frequency averaged one, and so is approximate (but better than just using 1). A future upgrade would use a more complex implementation where we use the frequency dependant gaunt factor. </p>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00640">640</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_a03396c07d161ba11de4a87161c5b6745_icgraph.png" border="0" usemap="#radiation_8c_a03396c07d161ba11de4a87161c5b6745_icgraph" alt=""/></div>
<map name="radiation_8c_a03396c07d161ba11de4a87161c5b6745_icgraph" id="radiation_8c_a03396c07d161ba11de4a87161c5b6745_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a141c8c8db4119b46cba7dcff5de861b3" title="increment the matom bound&#45;free estimators " alt="" coords="113,5,245,32"/>
<area shape="rect" id="node5" href="templates_8h.html#adb025e0891ad334d41481551bf785170" title="updates the field parameters in the wind and reduces the weight of the photon as a result of the effe..." alt="" coords="149,56,209,83"/>
<area shape="rect" id="node6" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="141,107,218,133"/>
<area shape="rect" id="node3" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="293,5,393,32"/>
<area shape="rect" id="node4" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="441,5,501,32"/>
</map>
</div>

</div>
</div>
<a id="a687aa0dcc49f512e562c1e0afddc0263"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a687aa0dcc49f512e562c1e0afddc0263">&#9670;&nbsp;</a></span>mean_intensity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mean_intensity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns a value for the mean intensity </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma PlasmaPtr for the cell - supplies spectral model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq the frequency at which we want to get a value of J </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode mode 1=use BB if we have not yet completed a cycle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The mean intensity at a specific frequency</dd></dl>
<p>This subroutine returns a value for the mean intensity J at a given frequency, using either a dilute blackbody model or a spectral model depending on the value of geo.ioniz_mode. to avoid code duplication.</p>
<p>For ionization models that make use of the crude spectra accumulated in crude spectral bands, the routine uses these bands to get the mean intensity. If however, one is using one of the other (older) ionization modes, then the input variable mode drives how the mean intensity is calculated.mode appears to be used</p>
<h3>Notes</h3>
<p>This subroutine was produced when we started to use a spectral model to populate the upper state of a two level atom, as well as to calculate induced compton heating.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000047">Bug:</a></b></dt><dd>The routine refers to a mode 5, which does not appear to exist, or at least it is not one that is included in <a class="el" href="python_8h.html">python.h</a> Note also that the logic of this appears overcomplicated, reflecting the evolution of banding, and various ionization modes being added without looking at trying to make this simpler.</dd></dl>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l01263">1263</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_cgraph.png" border="0" usemap="#radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_cgraph" alt=""/></div>
<map name="radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_cgraph" id="radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="143,25,187,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="604,25,661,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="235,51,308,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="356,37,445,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="379,88,423,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="505,25,544,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="493,76,556,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_icgraph.png" border="0" usemap="#radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_icgraph" alt=""/></div>
<map name="radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_icgraph" id="radiation_8c_a687aa0dcc49f512e562c1e0afddc0263_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a3ce17d1882989bac342f4bc4d1e0a7b6" title="Computes the effective opacity in the cell due to induced compton heating. " alt="" coords="152,56,251,83"/>
<area shape="rect" id="node7" href="templates_8h.html#a2f793ca07e9f7ec0220090b8f6b73634" title="The integrand in the integral to obtain the total cooling rate due to inverse compton scattering..." alt="" coords="143,107,260,133"/>
<area shape="rect" id="node21" href="templates_8h.html#abd62705b5006847a8dc70b442bf15332" title="compute dilute matom estimators " alt="" coords="143,157,260,184"/>
<area shape="rect" id="node23" href="templates_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="155,259,247,285"/>
<area shape="rect" id="node3" href="templates_8h.html#a141c8c8db4119b46cba7dcff5de861b3" title="increment the matom bound&#45;free estimators " alt="" coords="308,5,440,32"/>
<area shape="rect" id="node6" href="templates_8h.html#adb025e0891ad334d41481551bf785170" title="updates the field parameters in the wind and reduces the weight of the photon as a result of the effe..." alt="" coords="344,56,404,83"/>
<area shape="rect" id="node4" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="490,5,590,32"/>
<area shape="rect" id="node5" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="659,5,719,32"/>
<area shape="rect" id="node8" href="templates_8h.html#a560f4bd0619fdb29b85891d46ce63a48" title="computes the cooling in the cell due to inverse compton scattering. " alt="" coords="339,107,409,133"/>
<area shape="rect" id="node9" href="templates_8h.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="513,107,567,133"/>
<area shape="rect" id="node10" href="templates_8h.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="644,56,735,83"/>
<area shape="rect" id="node11" href="templates_8h.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="640,107,739,133"/>
<area shape="rect" id="node16" href="templates_8h.html#a2a31b4c75dc8f482609abe7b1618a97b" title="calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non&#45;radiative p..." alt="" coords="649,157,729,184"/>
<area shape="rect" id="node17" href="templates_8h.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="657,208,722,235"/>
<area shape="rect" id="node12" href="py__wind__macro_8c.html#a3b9acb4339c1f7cab252c186f431ff38" title="prints the adiabatic cooling in each cell, and the total adiabatic cooling. " alt="" coords="807,34,911,75"/>
<area shape="rect" id="node13" href="py__wind__sub_8c.html#a78167061f5b9c1298b26572af7c63ae7" title="adiabatic_cooling_summary" alt="" coords="787,100,932,127"/>
<area shape="rect" id="node14" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="821,151,897,177"/>
<area shape="rect" id="node15" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="989,151,1033,177"/>
<area shape="rect" id="node18" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="980,227,1043,253"/>
<area shape="rect" id="node20" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="833,252,886,279"/>
<area shape="rect" id="node19" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="1091,227,1187,253"/>
<area shape="rect" id="node22" href="templates_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="335,157,413,184"/>
<area shape="rect" id="node24" href="templates_8h.html#a0018131577a59a5142e3677785504d37" title="Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines..." alt="" coords="657,296,721,323"/>
<area shape="rect" id="node26" href="templates_8h.html#a8b5f64621f83720e21cb4440830ef473" title="Calculate the total line absorption x&#45;section for a specific transition allowing for stimulated emiss..." alt="" coords="336,284,412,311"/>
<area shape="rect" id="node27" href="templates_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="341,335,407,361"/>
<area shape="rect" id="node25" href="templates_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="806,303,913,329"/>
<area shape="rect" id="node28" href="templates_8h.html#a4a12de5120dbfd2f67d3ac56645cb4e6" title="calculate the fraction of excited state atoms which correspond to scattered photons, i.e. the portion which are excited by radiation and return to the ground state via spontaneous emission. " alt="" coords="488,347,592,373"/>
<area shape="rect" id="node29" href="templates_8h.html#a08e6e02acfd4d2fb6b31cf9bfdc7b258" title="calculates the amount of line heating that during a resonance. " alt="" coords="658,347,721,373"/>
</map>
</div>

</div>
</div>
<a id="ae75016283af89e14ba37126d5763d2ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae75016283af89e14ba37126d5763d2ba">&#9670;&nbsp;</a></span>pop_kappa_ff_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double pop_kappa_ff_array </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>populates the multiplicative constant, including a gaunt factor, to be used in the calculating free free emission (and absorption). </p>
<p>The routine populates plasmamain[].kappa_ff_factor</p>
<p>The free-free multiplicative constant depends only on the densities of ions in the cell, and the electron temperature (which feeds into the gaunt factor) so it saves time to calculate all this just the once.</p>
<h3>Notes</h3>
<p>This routine is called just before the photons are sent through the wind. </p>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00984">984</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_ae75016283af89e14ba37126d5763d2ba_cgraph.png" border="0" usemap="#radiation_8c_ae75016283af89e14ba37126d5763d2ba_cgraph" alt=""/></div>
<map name="radiation_8c_ae75016283af89e14ba37126d5763d2ba_cgraph" id="radiation_8c_ae75016283af89e14ba37126d5763d2ba_cgraph">
<area shape="rect" id="node2" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="173,5,231,32"/>
<area shape="rect" id="node3" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="164,56,240,83"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="288,107,332,133"/>
<area shape="rect" id="node4" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="288,56,332,83"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="749,31,807,57"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="380,56,453,83"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="501,56,591,83"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="651,31,689,57"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="639,81,701,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_ae75016283af89e14ba37126d5763d2ba_icgraph.png" border="0" usemap="#radiation_8c_ae75016283af89e14ba37126d5763d2ba_icgraph" alt=""/></div>
<map name="radiation_8c_ae75016283af89e14ba37126d5763d2ba_icgraph" id="radiation_8c_ae75016283af89e14ba37126d5763d2ba_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="164,5,273,32"/>
</map>
</div>

</div>
</div>
<a id="adb025e0891ad334d41481551bf785170"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb025e0891ad334d41481551bf785170">&#9670;&nbsp;</a></span>radiation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int radiation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>updates the field parameters in the wind and reduces the weight of the photon as a result of the effects of free free, bound-free and Compton scattering. The routine also keeps track of the number of photoionizations for H and He in the cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p the photon </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>ds the distance the photon has travelled in the cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0. The pieces of the wind structure which are updated are j,ave_freq,ntot, heat_photo, heat_ff, heat_h, heat_he1, heat_he2, heat_z, nioniz, and ioniz[].</dd></dl>
<h3>Notes</h3>
<p>The # of ionizations of a specific ion = (w(0)-w(s))*n_i sigma_i/ (h nu * kappa_tot). (The # of ionizations is just given by the integral of n_i sigma_i w(s) / h nu ds, but if the density is assumed to be constant and sigma is also constant [therefy ignoring velocity shifts in a grid cell], then n_i sigma and h nu can be brought outside the integral. Hence the integral is just over w(s), but that is just given by (w(0)-w(smax))/kappa_tot.) The routine calculates the number of ionizations per unit volume. </p>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00152">152</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_adb025e0891ad334d41481551bf785170_cgraph.png" border="0" usemap="#radiation_8c_adb025e0891ad334d41481551bf785170_cgraph" alt=""/></div>
<map name="radiation_8c_adb025e0891ad334d41481551bf785170_cgraph" id="radiation_8c_adb025e0891ad334d41481551bf785170_cgraph">
<area shape="rect" id="node2" href="radiation_8c.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="149,5,220,32"/>
<area shape="rect" id="node3" href="foo_8h.html#aa751e527d76e3ced7d54e260c6ec8cd3" title="check_plasma" alt="" coords="142,56,227,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="151,107,219,133"/>
<area shape="rect" id="node5" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="165,157,204,184"/>
<area shape="rect" id="node6" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="152,208,217,235"/>
<area shape="rect" id="node7" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="149,259,221,285"/>
<area shape="rect" id="node8" href="radiation_8c.html#a03396c07d161ba11de4a87161c5b6745" title="calculates the free&#45;free opacity allowing for stimulated emission " alt="" coords="155,309,215,336"/>
<area shape="rect" id="node9" href="compton_8c.html#a058633208c21e33eb49a33bd82c6327d" title="Pointer to current plasma cell. " alt="" coords="145,360,224,387"/>
<area shape="rect" id="node11" href="compton_8c.html#a3ce17d1882989bac342f4bc4d1e0a7b6" title="Computes the effective opacity in the cell due to induced compton heating. " alt="" coords="135,411,234,437"/>
<area shape="rect" id="node13" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="311,512,387,539"/>
<area shape="rect" id="node20" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="441,436,485,463"/>
<area shape="rect" id="node21" href="radiation_8c.html#a426bb5a912e3fd43013ffec072376b4a" title="calculates the photionization crossection due to a Topbase level associated with x_ptr at frequency f..." alt="" coords="148,563,221,589"/>
<area shape="rect" id="node23" href="diag_8c.html#a1c8114c71c12528c31d3329d1a5a7777" title="prints photon statistics to a file " alt="" coords="132,613,237,640"/>
<area shape="rect" id="node24" href="radiation_8c.html#a80900ce2eec0df06ac63c9eb02d93afa" title="updates the estimators required for determining crude spectra in each Plasma cell ..." alt="" coords="113,664,256,691"/>
<area shape="rect" id="node10" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="325,309,372,336"/>
<area shape="rect" id="node12" href="foo_8h.html#a687aa0dcc49f512e562c1e0afddc0263" title="returns a value for the mean intensity " alt="" coords="304,360,393,387"/>
<area shape="rect" id="node14" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="441,512,485,539"/>
<area shape="rect" id="node15" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="903,524,960,551"/>
<area shape="rect" id="node16" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="533,512,607,539"/>
<area shape="rect" id="node17" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="655,512,744,539"/>
<area shape="rect" id="node18" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="804,524,843,551"/>
<area shape="rect" id="node19" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="792,473,855,500"/>
<area shape="rect" id="node22" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="324,563,373,589"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_adb025e0891ad334d41481551bf785170_icgraph.png" border="0" usemap="#radiation_8c_adb025e0891ad334d41481551bf785170_icgraph" alt=""/></div>
<map name="radiation_8c_adb025e0891ad334d41481551bf785170_icgraph" id="radiation_8c_adb025e0891ad334d41481551bf785170_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="113,5,213,32"/>
<area shape="rect" id="node3" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="261,5,321,32"/>
</map>
</div>

</div>
</div>
<a id="a426bb5a912e3fd43013ffec072376b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a426bb5a912e3fd43013ffec072376b4a">&#9670;&nbsp;</a></span>sigma_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sigma_phot </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *&#160;</td>
          <td class="paramname"><em>x_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the photionization crossection due to a Topbase level associated with x_ptr at frequency freq </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td><a class="el" href="structtopbase__phot.html">topbase_phot</a> * x_ptr The structure that contains TopBase information about the photoionization x-section </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq The frequency where the x-section is to be calculated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The x-section</dd></dl>
<p>sigma_phot uses the Topbase x-sections to calculate the bound free (or photoionization) xsection. The data must have been into the photoionization structures xphot with get_atomic_data and the densities of individual ions must have been calculated previously.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00731">731</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_a426bb5a912e3fd43013ffec072376b4a_cgraph.png" border="0" usemap="#radiation_8c_a426bb5a912e3fd43013ffec072376b4a_cgraph" alt=""/></div>
<map name="radiation_8c_a426bb5a912e3fd43013ffec072376b4a_cgraph" id="radiation_8c_a426bb5a912e3fd43013ffec072376b4a_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a848bdfe987685e5135b3437dc0dec5e7" title="linterp" alt="" coords="127,5,176,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_a426bb5a912e3fd43013ffec072376b4a_icgraph.png" border="0" usemap="#radiation_8c_a426bb5a912e3fd43013ffec072376b4a_icgraph" alt=""/></div>
<map name="radiation_8c_a426bb5a912e3fd43013ffec072376b4a_icgraph" id="radiation_8c_a426bb5a912e3fd43013ffec072376b4a_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#adb025e0891ad334d41481551bf785170" title="updates the field parameters in the wind and reduces the weight of the photon as a result of the effe..." alt="" coords="127,5,187,32"/>
</map>
</div>

</div>
</div>
<a id="a9b943f07de31437e68d5a62c4d007588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b943f07de31437e68d5a62c4d007588">&#9670;&nbsp;</a></span>sigma_phot_verner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sigma_phot_verner </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structinnershell.html">innershell</a> *&#160;</td>
          <td class="paramname"><em>x_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x_ptr at frequency freq (when the data is in the form of the Verner x-sections </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">struct</td><td>innershell * x_ptr The stucture that contains information in the format of Verner for a particular ion level </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>freq The frequency where the x-section is calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The photoinization x-section</dd></dl>
<p>Same as sigma_phot but using the older compilation from Verner that includes inner shells</p>
<h3>Notes</h3>
<p>I (NSH) think this routine has been largely superceeded by the new inner shell formulation of auger ionization. At some poi nt we may wish to expunge the old augerion perts of python. </p>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00815">815</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>

</div>
</div>
<a id="a80900ce2eec0df06ac63c9eb02d93afa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80900ce2eec0df06ac63c9eb02d93afa">&#9670;&nbsp;</a></span>update_banded_estimators()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_banded_estimators </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>w_ave</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>updates the estimators required for determining crude spectra in each Plasma cell </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma PlasmaPtr for the cell of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p Photon pointer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>ds ds travelled </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>w_ave the weight of the photon in the cell.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>Increments the estimators that allow one to construct a crude spectrum in each cell of the wind. The frequency intervals in which the spectra are constructed are in geo.xfreq. This information is used in different ways (or not at all) depending on the ionization mode.</p>
<p>It also records the values of IP.</p>
<h3>Notes</h3>
<p>In non macro atom mode, w_ave this is an average weight (passed as w_ave), but in macro atom mode weights are never reduced (so p-&gt;w is used).</p>
<p>This routine is called from bf_estimators in macro_atom modes and from radiation (above). Although the historical documentation suggests it is only called for certain ionization modes, it appears to be called in all cases, though clearly it is only provides diagnostic information in some of them. </p>

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l01096">1096</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="radiation_8c_a80900ce2eec0df06ac63c9eb02d93afa_icgraph.png" border="0" usemap="#radiation_8c_a80900ce2eec0df06ac63c9eb02d93afa_icgraph" alt=""/></div>
<map name="radiation_8c_a80900ce2eec0df06ac63c9eb02d93afa_icgraph" id="radiation_8c_a80900ce2eec0df06ac63c9eb02d93afa_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a141c8c8db4119b46cba7dcff5de861b3" title="increment the matom bound&#45;free estimators " alt="" coords="196,5,328,32"/>
<area shape="rect" id="node5" href="templates_8h.html#adb025e0891ad334d41481551bf785170" title="updates the field parameters in the wind and reduces the weight of the photon as a result of the effe..." alt="" coords="232,56,292,83"/>
<area shape="rect" id="node3" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="376,5,476,32"/>
<area shape="rect" id="node4" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="524,5,584,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a5ae16091f569647cb54c38a0d745822f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae16091f569647cb54c38a0d745822f">&#9670;&nbsp;</a></span>iicount</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iicount = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="radiation_8c_source.html#l00121">121</a> of file <a class="el" href="radiation_8c_source.html">radiation.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="radiation_8c.html">radiation.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
