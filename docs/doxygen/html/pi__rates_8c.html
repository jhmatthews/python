<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/pi_rates.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pi__rates_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pi_rates.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines associated with calculating photionization rates.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pi_rates.c:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2pi__rates_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2pi__rates_8c" id="_2_users_2mhewitt_2python_2source_2pi__rates_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="283,169,327,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="351,169,413,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="437,169,511,196"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="535,169,597,196"/>
</map>
</div>
</div>
<p><a href="pi__rates_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae8bab77755879541eaede60436cfbda2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#ae8bab77755879541eaede60436cfbda2">calc_pi_rate</a> (int nion, <a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode, int type)</td></tr>
<tr class="memdesc:ae8bab77755879541eaede60436cfbda2"><td class="mdescLeft">&#160;</td><td class="mdescRight">int calculates the photoionization rate coefficient for an ion in a given cell  <a href="#ae8bab77755879541eaede60436cfbda2">More...</a><br /></td></tr>
<tr class="separator:ae8bab77755879541eaede60436cfbda2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e3418a581094a1c02352db778e3d12"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#ae2e3418a581094a1c02352db778e3d12">tb_planck1</a> (double freq)</td></tr>
<tr class="memdesc:ae2e3418a581094a1c02352db778e3d12"><td class="mdescLeft">&#160;</td><td class="mdescRight">The integrand for working out the PI rate in a BB radiation field.  <a href="#ae2e3418a581094a1c02352db778e3d12">More...</a><br /></td></tr>
<tr class="separator:ae2e3418a581094a1c02352db778e3d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab952e8ceb4c53ae59abe06169acce763"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#ab952e8ceb4c53ae59abe06169acce763">tb_logpow1</a> (double freq)</td></tr>
<tr class="memdesc:ab952e8ceb4c53ae59abe06169acce763"><td class="mdescLeft">&#160;</td><td class="mdescRight">The integrand for working out the PI rate in a radiation field modelled by a power law.  <a href="#ab952e8ceb4c53ae59abe06169acce763">More...</a><br /></td></tr>
<tr class="separator:ab952e8ceb4c53ae59abe06169acce763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6baffec2b7a559720f862e50cabec6f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#ac6baffec2b7a559720f862e50cabec6f">tb_exp1</a> (double freq)</td></tr>
<tr class="memdesc:ac6baffec2b7a559720f862e50cabec6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The integrand for working out the PI rate in a radiation field modelled by an exponential.  <a href="#ac6baffec2b7a559720f862e50cabec6f">More...</a><br /></td></tr>
<tr class="separator:ac6baffec2b7a559720f862e50cabec6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a27fa8981c5a8f9cea39f4e0aecc31fe7"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#a27fa8981c5a8f9cea39f4e0aecc31fe7">xtop</a></td></tr>
<tr class="separator:a27fa8981c5a8f9cea39f4e0aecc31fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c172ee9a58f8312e11188e1eb910044"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#a7c172ee9a58f8312e11188e1eb910044">qromb_temp</a></td></tr>
<tr class="separator:a7c172ee9a58f8312e11188e1eb910044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91feb6a16dd3dc36aeb6c975ae44fec3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#a91feb6a16dd3dc36aeb6c975ae44fec3">xpl_alpha</a></td></tr>
<tr class="separator:a91feb6a16dd3dc36aeb6c975ae44fec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bedc638d1ebb9f6243328f57740530c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#a6bedc638d1ebb9f6243328f57740530c">xpl_w</a></td></tr>
<tr class="separator:a6bedc638d1ebb9f6243328f57740530c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5661a175b610bf901bf445da51b964d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#ab5661a175b610bf901bf445da51b964d">xpl_logw</a></td></tr>
<tr class="separator:ab5661a175b610bf901bf445da51b964d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af016d92d32fdb254c98e7792b58cca9a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#af016d92d32fdb254c98e7792b58cca9a">xexp_temp</a></td></tr>
<tr class="separator:af016d92d32fdb254c98e7792b58cca9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ee5826b6c79c1785b5745f215f42f55"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pi__rates_8c.html#a8ee5826b6c79c1785b5745f215f42f55">xexp_w</a></td></tr>
<tr class="separator:a8ee5826b6c79c1785b5745f215f42f55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines associated with calculating photionization rates. </p>
<dl class="section author"><dt>Author</dt><dd>nsh </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Aug, 2014</dd></dl>
<p>??? </p>

<p class="definition">Definition in file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae8bab77755879541eaede60436cfbda2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8bab77755879541eaede60436cfbda2">&#9670;&nbsp;</a></span>calc_pi_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_pi_rate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>int calculates the photoionization rate coefficient for an ion in a given cell </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nion The ion being ionized (or the index to an inner shell cross section) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma The cell in question - note that the details of the model is stored in this strucute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode says whether to use a piecewise model (1) or a blackbody model (2) for J_nu </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">type</td><td>says whether we are computing an outer shell (1) or inner shell (2) rate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The photioinization rate coefficient for the ion.</dd></dl>
<p>calc_pi_rate calculates the photoionization rate coefficient for ion nion, based upon the mean intensity stored in cell xplasma The mode tells the subroutine wether we are modelling the mean intensity as a dilute blackbody (mode2) or as a series of power laws and exponentials (mode1). The type allows for the calculation of inner shell rates - in this case nion is the indenx into an inner shell cross section record - this links to the relvant ion internally. the reason for the difference is that there is exactly one outer rate per ion, but there can be many inner shell rates. Most of the information needed for the calculations is stored in the xplasma structure (e.g. temperature and spectral model)</p>
<h3>Notes</h3>
<p>This was created in Summer 2014 in preparation for matrix ionization solver. Previously, this code was contained in two subroutines bb_correct_2 and pl_correct_2.The functionality of these two have ben combined into one - hence the requirement for the mode parameter.It was further extended to deal with inner shell rates - hence the type parameter </p>

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00063">63</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ae8bab77755879541eaede60436cfbda2_cgraph.png" border="0" usemap="#pi__rates_8c_ae8bab77755879541eaede60436cfbda2_cgraph" alt=""/></div>
<map name="pi__rates_8c_ae8bab77755879541eaede60436cfbda2_cgraph" id="pi__rates_8c_ae8bab77755879541eaede60436cfbda2_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="145,5,189,32"/>
<area shape="rect" id="node9" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="142,56,193,83"/>
<area shape="rect" id="node10" href="pi__rates_8c.html#ab952e8ceb4c53ae59abe06169acce763" title="The integrand for working out the PI rate in a radiation field modelled by a power law..." alt="" coords="131,107,204,133"/>
<area shape="rect" id="node12" href="pi__rates_8c.html#ac6baffec2b7a559720f862e50cabec6f" title="The integrand for working out the PI rate in a radiation field modelled by an exponential. " alt="" coords="139,157,196,184"/>
<area shape="rect" id="node13" href="bb_8c.html#a11871d7df7f3167db92bef8c8ef98926" title="decides whether a maximum frequency requested for an integral is sensible. If it is too far off the e..." alt="" coords="129,208,205,235"/>
<area shape="rect" id="node14" href="pi__rates_8c.html#ae2e3418a581094a1c02352db778e3d12" title="The integrand for working out the PI rate in a BB radiation field. " alt="" coords="132,259,203,285"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="623,37,680,64"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="253,81,327,108"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="375,69,464,96"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="397,120,441,147"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="524,37,563,64"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="512,88,575,115"/>
<area shape="rect" id="node11" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="253,157,327,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ae8bab77755879541eaede60436cfbda2_icgraph.png" border="0" usemap="#pi__rates_8c_ae8bab77755879541eaede60436cfbda2_icgraph" alt=""/></div>
<map name="pi__rates_8c_ae8bab77755879541eaede60436cfbda2_icgraph" id="pi__rates_8c_ae8bab77755879541eaede60436cfbda2_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="129,5,255,32"/>
<area shape="rect" id="node3" href="variable__temperature_8c.html#a7f409d6ca8a15c6c341fdb1853104685" title="calculates the photoionization rate correction factor for the number density of two adjacent ions ..." alt="" coords="159,56,225,83"/>
<area shape="rect" id="node4" href="variable__temperature_8c.html#a72d9769510683e30aeef87c2a255ebe4" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="303,56,419,83"/>
<area shape="rect" id="node5" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="467,56,592,83"/>
</map>
</div>

</div>
</div>
<a id="ac6baffec2b7a559720f862e50cabec6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6baffec2b7a559720f862e50cabec6f">&#9670;&nbsp;</a></span>tb_exp1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tb_exp1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The integrand for working out the PI rate in a radiation field modelled by an exponential. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq the frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of sigma J_nu/nu at nu</dd></dl>
<p>This is the integrand for computing the PI rate coefficient when j_nu is described by an exponential law. The returned value is J_nu x cross section / nu.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00305">305</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_cgraph.png" border="0" usemap="#pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_cgraph" alt=""/></div>
<map name="pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_cgraph" id="pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_cgraph">
<area shape="rect" id="node2" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="111,5,184,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_icgraph.png" border="0" usemap="#pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_icgraph" alt=""/></div>
<map name="pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_icgraph" id="pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ae8bab77755879541eaede60436cfbda2" title="int calculates the photoionization rate coefficient for an ion in a given cell " alt="" coords="111,5,187,32"/>
</map>
</div>

</div>
</div>
<a id="ab952e8ceb4c53ae59abe06169acce763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab952e8ceb4c53ae59abe06169acce763">&#9670;&nbsp;</a></span>tb_logpow1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tb_logpow1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The integrand for working out the PI rate in a radiation field modelled by a power law. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq the frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of sigma J_nu/nu at nu</dd></dl>
<p>This is the integrand for computing the PI rate coefficient when j_nu is described by a power law. The returned value is J_nu x cross section / nu. The power law is computed in log space to allow a larger range of possible values.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00278">278</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_cgraph.png" border="0" usemap="#pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_cgraph" alt=""/></div>
<map name="pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_cgraph" id="pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_cgraph">
<area shape="rect" id="node2" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="127,5,200,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_icgraph.png" border="0" usemap="#pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_icgraph" alt=""/></div>
<map name="pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_icgraph" id="pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ae8bab77755879541eaede60436cfbda2" title="int calculates the photoionization rate coefficient for an ion in a given cell " alt="" coords="127,5,203,32"/>
</map>
</div>

</div>
</div>
<a id="ae2e3418a581094a1c02352db778e3d12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e3418a581094a1c02352db778e3d12">&#9670;&nbsp;</a></span>tb_planck1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tb_planck1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The integrand for working out the PI rate in a BB radiation field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq the frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of sigma B_nu/nu at nu</dd></dl>
<p>tb_planck is the function a and is called by Qromb in order to integrate over the frequency range where the ionisation cross section is significant. This is the function for ions with a topbase cross section NSH</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00246">246</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_cgraph.png" border="0" usemap="#pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_cgraph" alt=""/></div>
<map name="pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_cgraph" id="pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_cgraph">
<area shape="rect" id="node2" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="124,5,197,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_icgraph.png" border="0" usemap="#pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_icgraph" alt=""/></div>
<map name="pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_icgraph" id="pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#ae8bab77755879541eaede60436cfbda2" title="int calculates the photoionization rate coefficient for an ion in a given cell " alt="" coords="124,5,200,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7c172ee9a58f8312e11188e1eb910044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c172ee9a58f8312e11188e1eb910044">&#9670;&nbsp;</a></span>qromb_temp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double qromb_temp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00022">22</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>

</div>
</div>
<a id="af016d92d32fdb254c98e7792b58cca9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af016d92d32fdb254c98e7792b58cca9a">&#9670;&nbsp;</a></span>xexp_temp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xexp_temp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00027">27</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>

</div>
</div>
<a id="a8ee5826b6c79c1785b5745f215f42f55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ee5826b6c79c1785b5745f215f42f55">&#9670;&nbsp;</a></span>xexp_w</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xexp_w</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00027">27</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>

</div>
</div>
<a id="a91feb6a16dd3dc36aeb6c975ae44fec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91feb6a16dd3dc36aeb6c975ae44fec3">&#9670;&nbsp;</a></span>xpl_alpha</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xpl_alpha</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00026">26</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>

</div>
</div>
<a id="ab5661a175b610bf901bf445da51b964d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5661a175b610bf901bf445da51b964d">&#9670;&nbsp;</a></span>xpl_logw</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xpl_logw</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00026">26</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>

</div>
</div>
<a id="a6bedc638d1ebb9f6243328f57740530c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bedc638d1ebb9f6243328f57740530c">&#9670;&nbsp;</a></span>xpl_w</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double xpl_w</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00026">26</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>

</div>
</div>
<a id="a27fa8981c5a8f9cea39f4e0aecc31fe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27fa8981c5a8f9cea39f4e0aecc31fe7">&#9670;&nbsp;</a></span>xtop</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structtopbase__phot.html">topbase_phot</a>* xtop</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pi__rates_8c_source.html#l00020">20</a> of file <a class="el" href="pi__rates_8c_source.html">pi_rates.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="pi__rates_8c.html">pi_rates.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
