<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/ionization.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ionization_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ionization.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines used to calculate and update ion densities.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ionization.c:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2ionization_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2ionization_8c" id="_2_users_2mhewitt_2python_2source_2ionization_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="ionization_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a626b1882e2533441cdf2daabd36e8a8b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ionization_8c.html#a626b1882e2533441cdf2daabd36e8a8b">ion_abundances</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode)</td></tr>
<tr class="memdesc:a626b1882e2533441cdf2daabd36e8a8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">ionization routines for the wind one cell at a time  <a href="#a626b1882e2533441cdf2daabd36e8a8b">More...</a><br /></td></tr>
<tr class="separator:a626b1882e2533441cdf2daabd36e8a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab729c5f4ef31135996b77fb1add8df2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ionization_8c.html#ab729c5f4ef31135996b77fb1add8df2c">convergence</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>)</td></tr>
<tr class="memdesc:ab729c5f4ef31135996b77fb1add8df2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">checks to see whether a single cell is or is not converging  <a href="#ab729c5f4ef31135996b77fb1add8df2c">More...</a><br /></td></tr>
<tr class="separator:ab729c5f4ef31135996b77fb1add8df2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0fefc2866b126097193b3bece2cff7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ionization_8c.html#a7b0fefc2866b126097193b3bece2cff7">check_convergence</a> ()</td></tr>
<tr class="memdesc:a7b0fefc2866b126097193b3bece2cff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The routien summarizes the how well the wind converging to a solution as a whole.  <a href="#a7b0fefc2866b126097193b3bece2cff7">More...</a><br /></td></tr>
<tr class="separator:a7b0fefc2866b126097193b3bece2cff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c0fa3305df1f5c000e0ed0a26d413d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ionization_8c.html#a0c0fa3305df1f5c000e0ed0a26d413d8">one_shot</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode)</td></tr>
<tr class="memdesc:a0c0fa3305df1f5c000e0ed0a26d413d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates new densities of ions in a single element of the wind after (usually) having found the temperature which matches heating and cooling for the previous densities  <a href="#a0c0fa3305df1f5c000e0ed0a26d413d8">More...</a><br /></td></tr>
<tr class="separator:a0c0fa3305df1f5c000e0ed0a26d413d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09cddd089f4a6cc83c34606d125c28a4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ionization_8c.html#a09cddd089f4a6cc83c34606d125c28a4">calc_te</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, double tmin, double tmax)</td></tr>
<tr class="memdesc:a09cddd089f4a6cc83c34606d125c28a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">calc_te determines and returns the electron temperature in the wind such that the energy emitted by the wind is equal to energy emitted (asssuming it is in the interval bracketed by tmin and tmax.)  <a href="#a09cddd089f4a6cc83c34606d125c28a4">More...</a><br /></td></tr>
<tr class="separator:a09cddd089f4a6cc83c34606d125c28a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a866bab53f422c2afa889e5e549df76d1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ionization_8c.html#a866bab53f422c2afa889e5e549df76d1">zero_emit</a> (double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>)</td></tr>
<tr class="memdesc:a866bab53f422c2afa889e5e549df76d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell in the previous ionization cycle.  <a href="#a866bab53f422c2afa889e5e549df76d1">More...</a><br /></td></tr>
<tr class="separator:a866bab53f422c2afa889e5e549df76d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4894abff5157e9a38f8dd34d0d0c2b4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ionization_8c.html#a4894abff5157e9a38f8dd34d0d0c2b4a">xxxplasma</a></td></tr>
<tr class="separator:a4894abff5157e9a38f8dd34d0d0c2b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines used to calculate and update ion densities. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a09cddd089f4a6cc83c34606d125c28a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09cddd089f4a6cc83c34606d125c28a4">&#9670;&nbsp;</a></span>calc_te()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_te </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calc_te determines and returns the electron temperature in the wind such that the energy emitted by the wind is equal to energy emitted (asssuming it is in the interval bracketed by tmin and tmax.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] PlasmaPtr xplasma A plasma cell in the wind </td></tr>
    <tr><td class="paramname">[in</td><td>out] double tmin A bracketing minimum temperature </td></tr>
    <tr><td class="paramname">[in</td><td>out] double tmax A bracketing mxximum temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The temperature where heating and cooling match</dd></dl>
<p>The routine iterates to find the temperature in a cell, where heating and cooling are matched.</p>
<p>calc_te does not modify any abundances. It simply takes the current value of the heating in the cell and attempts to find the value of the electron temperature which will result in cooling which matches the heating.</p>
<h3>Notes</h3>
<p>Ion densities are NOT updated in this process.</p>
<p>xxxplasma is just a way to tranmit information to zero_emit </p>

<p class="definition">Definition at line <a class="el" href="ionization_8c_source.html#l00471">471</a> of file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_cgraph.png" border="0" usemap="#ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_cgraph" alt=""/></div>
<map name="ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_cgraph" id="ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="234,257,311,284"/>
<area shape="rect" id="node3" href="ionization_8c.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="107,409,172,436"/>
<area shape="rect" id="node22" href="estimators_8c.html#a1d58fccfac7eec74c69412cfabcc5caf" title="computes the total heating due to matom bb transitions " alt="" coords="220,460,325,487"/>
<area shape="rect" id="node23" href="estimators_8c.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="221,548,324,575"/>
<area shape="rect" id="node44" href="foo_8h.html#a8c30fbf58d7a0b5789604f00c96bedb6" title="A routine that finds the rooot of a function f. " alt="" coords="115,561,164,588"/>
<area shape="rect" id="node4" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="380,384,465,411"/>
<area shape="rect" id="node33" href="cooling_8c.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="246,308,299,335"/>
<area shape="rect" id="node5" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="531,283,627,309"/>
<area shape="rect" id="node12" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="551,232,606,259"/>
<area shape="rect" id="node13" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="531,384,626,411"/>
<area shape="rect" id="node19" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="547,333,611,360"/>
<area shape="rect" id="node21" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="525,435,632,461"/>
<area shape="rect" id="node6" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="705,232,758,259"/>
<area shape="rect" id="node10" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="696,536,767,563"/>
<area shape="rect" id="node11" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="700,181,763,208"/>
<area shape="rect" id="node7" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="825,396,904,423"/>
<area shape="rect" id="node8" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="1084,500,1152,527"/>
<area shape="rect" id="node9" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1321,663,1379,689"/>
<area shape="rect" id="node14" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="712,485,751,512"/>
<area shape="rect" id="node15" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="685,333,777,360"/>
<area shape="rect" id="node16" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="712,587,751,613"/>
<area shape="rect" id="node17" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="712,384,751,411"/>
<area shape="rect" id="node18" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="699,435,764,461"/>
<area shape="rect" id="node20" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="702,283,761,309"/>
<area shape="rect" id="node24" href="direct__ion_8c.html#a432a9569392003e4470067b1c44dca5b" title="Returns a collisional recombination rate co&#45;efficient. " alt="" coords="389,663,456,689"/>
<area shape="rect" id="node25" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="533,676,625,703"/>
<area shape="rect" id="node26" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="693,739,769,765"/>
<area shape="rect" id="node32" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="843,688,887,715"/>
<area shape="rect" id="node27" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="843,739,887,765"/>
<area shape="rect" id="node28" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="952,713,1025,740"/>
<area shape="rect" id="node29" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1073,713,1163,740"/>
<area shape="rect" id="node30" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1223,713,1261,740"/>
<area shape="rect" id="node31" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1211,663,1273,689"/>
<area shape="rect" id="node34" href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="373,283,472,309"/>
<area shape="rect" id="node35" href="direct__ion_8c.html#a56f9a736ea5fdd9b253e4a7fa07103ce" title="computes the total cooling due collisional ionization " alt="" coords="395,181,450,208"/>
<area shape="rect" id="node37" href="compton_8c.html#a560f4bd0619fdb29b85891d46ce63a48" title="computes the cooling in the cell due to inverse compton scattering. " alt="" coords="387,131,458,157"/>
<area shape="rect" id="node43" href="cooling_8c.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="377,333,468,360"/>
<area shape="rect" id="node36" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="526,181,631,208"/>
<area shape="rect" id="node38" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="553,131,604,157"/>
<area shape="rect" id="node39" href="compton_8c.html#a2f793ca07e9f7ec0220090b8f6b73634" title="The integrand in the integral to obtain the total cooling rate due to inverse compton scattering..." alt="" coords="520,80,637,107"/>
<area shape="rect" id="node40" href="compton_8c.html#a5bffcc1725b11f5b35c37b406aaec263" title="The &#39;cooling&#39; cross section correction to Thompson. " alt="" coords="711,80,752,107"/>
<area shape="rect" id="node42" href="foo_8h.html#a687aa0dcc49f512e562c1e0afddc0263" title="returns a value for the mean intensity " alt="" coords="687,5,776,32"/>
<area shape="rect" id="node41" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="841,80,888,107"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_icgraph.png" border="0" usemap="#ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_icgraph" alt=""/></div>
<map name="ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_icgraph" id="ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="108,5,171,32"/>
<area shape="rect" id="node4" href="py__wind__ion_8c.html#afb46861eb63b3501e06b81ac398e1cc4" title="Find the electron temperature where heating matches the cooling. " alt="" coords="107,56,172,83"/>
<area shape="rect" id="node3" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="220,5,316,32"/>
</map>
</div>

</div>
</div>
<a id="a7b0fefc2866b126097193b3bece2cff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b0fefc2866b126097193b3bece2cff7">&#9670;&nbsp;</a></span>check_convergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_convergence </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The routien summarizes the how well the wind converging to a solution as a whole. </p>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>Basically the routine just looks at the numbers of cells which haave passed/failed the various convergence tests and writes this to the log file</p>
<h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000032">Bug:</a></b></dt><dd>It would make sense to write this information to a separate file so that plots of the rate of convergence could be easily made.</dd></dl>

<p class="definition">Definition at line <a class="el" href="ionization_8c_source.html#l00278">278</a> of file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a7b0fefc2866b126097193b3bece2cff7_cgraph.png" border="0" usemap="#ionization_8c_a7b0fefc2866b126097193b3bece2cff7_cgraph" alt=""/></div>
<map name="ionization_8c_a7b0fefc2866b126097193b3bece2cff7_cgraph" id="ionization_8c_a7b0fefc2866b126097193b3bece2cff7_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="177,5,216,32"/>
<area shape="rect" id="node4" href="log_8h.html#a762beaa59cb344fbb45e3458b86c95ce" title="Flush the diagnostic file to assure that one has an up&#45;to&#45;date version of the log file..." alt="" coords="164,56,229,83"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="277,31,335,57"/>
</map>
</div>

</div>
</div>
<a id="ab729c5f4ef31135996b77fb1add8df2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab729c5f4ef31135996b77fb1add8df2c">&#9670;&nbsp;</a></span>convergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int convergence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>checks to see whether a single cell is or is not converging </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">[in</td><td>out] PlasmaPtr xplasma The cell of interest </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A number which describes the degree to which the cell is converging</dd></dl>
<p>The routine attempts to determine whether a cell is on the track to a final solution by checking whether the electron and radiation temperatures are getting smaller with cycle and whetehr the difference between heating and cooling is drroping.</p>
<p>The routine returns a number between 0 and 3, depending on the number of convergence checks that are passed. If all convergence tests are pssed then the number returned will be 0</p>
<p>The routine also adjust the gain which controls how far the electron temperture can change in a cycle.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="ionization_8c_source.html#l00184">184</a> of file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_ab729c5f4ef31135996b77fb1add8df2c_icgraph.png" border="0" usemap="#ionization_8c_ab729c5f4ef31135996b77fb1add8df2c_icgraph" alt=""/></div>
<map name="ionization_8c_ab729c5f4ef31135996b77fb1add8df2c_icgraph" id="ionization_8c_ab729c5f4ef31135996b77fb1add8df2c_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="132,5,228,32"/>
</map>
</div>

</div>
</div>
<a id="a626b1882e2533441cdf2daabd36e8a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a626b1882e2533441cdf2daabd36e8a8b">&#9670;&nbsp;</a></span>ion_abundances()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ion_abundances </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ionization routines for the wind one cell at a time </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma The cell in which the ioniztion is to be calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A parameter descibing how to calculate the ioniztion </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The routine returns status messages dereived from the individual routines used to calculate the abundances.</dd></dl>
<p>The intent is that the routine ion_abundances is the steering routine for all calculations of the abundances</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="ionization_8c_source.html#l00039">39</a> of file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_cgraph.png" border="0" usemap="#ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_cgraph" alt=""/></div>
<map name="ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_cgraph" id="ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="307,535,432,561"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1083,739,1127,765"/>
<area shape="rect" id="node10" href="foo_8h.html#ad350a11e70a4518fb86b842942575e26" title="sets the concentrations of individual ions assuming hard coded ionization fractions that are read fro..." alt="" coords="153,839,255,865"/>
<area shape="rect" id="node11" href="ionization_8c.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="173,636,235,663"/>
<area shape="rect" id="node49" href="ionization_8c.html#ab729c5f4ef31135996b77fb1add8df2c" title="checks to see whether a single cell is or is not converging " alt="" coords="165,889,243,916"/>
<area shape="rect" id="node50" href="foo_8h.html#abe28dc93125bf28e9c3dcef85428b16a" title="Calculate the parameters of a model for J_nu in a cell. " alt="" coords="149,940,259,967"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1579,663,1636,689"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="1201,713,1275,740"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1325,713,1415,740"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1348,663,1392,689"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1477,713,1516,740"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1465,663,1528,689"/>
<area shape="rect" id="node12" href="ionization_8c.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="480,484,545,511"/>
<area shape="rect" id="node47" href="ionization_8c.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="343,636,396,663"/>
<area shape="rect" id="node13" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="753,335,839,361"/>
<area shape="rect" id="node30" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="607,636,685,663"/>
<area shape="rect" id="node31" href="estimators_8c.html#a1d58fccfac7eec74c69412cfabcc5caf" title="computes the total heating due to matom bb transitions " alt="" coords="593,513,699,540"/>
<area shape="rect" id="node32" href="estimators_8c.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="595,585,697,612"/>
<area shape="rect" id="node36" href="cooling_8c.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="619,259,673,285"/>
<area shape="rect" id="node14" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="904,284,1000,311"/>
<area shape="rect" id="node20" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="925,183,979,209"/>
<area shape="rect" id="node21" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="905,385,999,412"/>
<area shape="rect" id="node27" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="920,233,984,260"/>
<area shape="rect" id="node29" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="899,335,1005,361"/>
<area shape="rect" id="node15" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="1078,181,1131,208"/>
<area shape="rect" id="node18" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="1069,587,1140,613"/>
<area shape="rect" id="node19" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="1073,232,1136,259"/>
<area shape="rect" id="node16" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="1199,523,1277,549"/>
<area shape="rect" id="node17" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="1463,552,1531,579"/>
<area shape="rect" id="node22" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="1085,283,1124,309"/>
<area shape="rect" id="node23" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="1059,333,1151,360"/>
<area shape="rect" id="node24" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="1085,536,1124,563"/>
<area shape="rect" id="node25" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="1085,384,1124,411"/>
<area shape="rect" id="node26" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="1072,435,1137,461"/>
<area shape="rect" id="node28" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="1075,131,1134,157"/>
<area shape="rect" id="node33" href="direct__ion_8c.html#a432a9569392003e4470067b1c44dca5b" title="Returns a collisional recombination rate co&#45;efficient. " alt="" coords="763,655,829,681"/>
<area shape="rect" id="node34" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="906,661,998,688"/>
<area shape="rect" id="node35" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="1200,663,1276,689"/>
<area shape="rect" id="node37" href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="747,183,845,209"/>
<area shape="rect" id="node38" href="direct__ion_8c.html#a56f9a736ea5fdd9b253e4a7fa07103ce" title="computes the total cooling due collisional ionization " alt="" coords="769,412,823,439"/>
<area shape="rect" id="node40" href="compton_8c.html#a560f4bd0619fdb29b85891d46ce63a48" title="computes the cooling in the cell due to inverse compton scattering. " alt="" coords="761,132,831,159"/>
<area shape="rect" id="node46" href="cooling_8c.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="751,284,841,311"/>
<area shape="rect" id="node39" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="899,439,1005,465"/>
<area shape="rect" id="node41" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="927,132,977,159"/>
<area shape="rect" id="node42" href="compton_8c.html#a2f793ca07e9f7ec0220090b8f6b73634" title="The integrand in the integral to obtain the total cooling rate due to inverse compton scattering..." alt="" coords="893,80,1011,107"/>
<area shape="rect" id="node43" href="compton_8c.html#a5bffcc1725b11f5b35c37b406aaec263" title="The &#39;cooling&#39; cross section correction to Thompson. " alt="" coords="1084,80,1125,107"/>
<area shape="rect" id="node45" href="foo_8h.html#a687aa0dcc49f512e562c1e0afddc0263" title="returns a value for the mean intensity " alt="" coords="1060,5,1149,32"/>
<area shape="rect" id="node44" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="1215,80,1261,107"/>
<area shape="rect" id="node48" href="foo_8h.html#a8c30fbf58d7a0b5789604f00c96bedb6" title="A routine that finds the rooot of a function f. " alt="" coords="488,687,537,713"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_icgraph.png" border="0" usemap="#ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_icgraph" alt=""/></div>
<map name="ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_icgraph" id="ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_icgraph">
<area shape="rect" id="node2" href="wind2d_8c.html#a41ee5cb999f1d4258673b6134394b4cc" title="initializes the structures which characterize the wind, including wmain and plasmamain. " alt="" coords="149,5,225,32"/>
<area shape="rect" id="node3" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="273,5,317,32"/>
</map>
</div>

</div>
</div>
<a id="a0c0fa3305df1f5c000e0ed0a26d413d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c0fa3305df1f5c000e0ed0a26d413d8">&#9670;&nbsp;</a></span>one_shot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int one_shot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates new densities of ions in a single element of the wind after (usually) having found the temperature which matches heating and cooling for the previous densities </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma The plasma cell of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A switch describing what approximation to use in determinging the densities </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This routine attempts to match heating and cooling in the wind element! To do this it calls calc_te. Based on the returned value of te, the routine then calculates densities for various ions in the cell. The densities in xplasma are updated.</p>
<h3>Notes</h3>
<p>Special exceptions are made for Zeus; it is not clear why this is necessary</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000033">Bug:</a></b></dt><dd>There are some numbered switches included here. This is because these values are not allowed anymore. But this needs to be cleaned up. Deactivated modes should be captured when the parameters are read in, not at this point. An else statement should provide a sufficent check for any unknown mode.</dd></dl>

<p class="definition">Definition at line <a class="el" href="ionization_8c_source.html#l00358">358</a> of file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_cgraph.png" border="0" usemap="#ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_cgraph" alt=""/></div>
<map name="ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_cgraph" id="ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_cgraph">
<area shape="rect" id="node2" href="ionization_8c.html#a866bab53f422c2afa889e5e549df76d1" title="Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell ..." alt="" coords="289,478,355,504"/>
<area shape="rect" id="node32" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1025,672,1069,699"/>
<area shape="rect" id="node44" href="ionization_8c.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="152,604,205,631"/>
<area shape="rect" id="node46" href="foo_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="116,824,241,851"/>
<area shape="rect" id="node3" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="563,419,648,446"/>
<area shape="rect" id="node21" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="417,503,494,530"/>
<area shape="rect" id="node22" href="estimators_8c.html#a1d58fccfac7eec74c69412cfabcc5caf" title="computes the total heating due to matom bb transitions " alt="" coords="403,566,508,592"/>
<area shape="rect" id="node23" href="estimators_8c.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="404,628,507,655"/>
<area shape="rect" id="node33" href="cooling_8c.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="429,318,482,344"/>
<area shape="rect" id="node4" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="713,520,809,547"/>
<area shape="rect" id="node11" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="734,267,789,294"/>
<area shape="rect" id="node12" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="714,318,809,344"/>
<area shape="rect" id="node18" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="729,368,793,395"/>
<area shape="rect" id="node20" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="708,419,815,446"/>
<area shape="rect" id="node5" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="887,470,941,496"/>
<area shape="rect" id="node9" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="879,571,949,598"/>
<area shape="rect" id="node10" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="883,520,945,547"/>
<area shape="rect" id="node6" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="1008,480,1087,507"/>
<area shape="rect" id="node7" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="1267,508,1335,535"/>
<area shape="rect" id="node8" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1504,647,1561,674"/>
<area shape="rect" id="node13" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="895,216,933,243"/>
<area shape="rect" id="node14" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="868,267,960,294"/>
<area shape="rect" id="node15" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="895,419,933,446"/>
<area shape="rect" id="node16" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="895,318,933,344"/>
<area shape="rect" id="node17" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="881,166,947,192"/>
<area shape="rect" id="node19" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="885,368,943,395"/>
<area shape="rect" id="node24" href="direct__ion_8c.html#a432a9569392003e4470067b1c44dca5b" title="Returns a collisional recombination rate co&#45;efficient. " alt="" coords="572,672,639,699"/>
<area shape="rect" id="node25" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="715,672,807,699"/>
<area shape="rect" id="node26" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="876,723,952,750"/>
<area shape="rect" id="node27" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1025,723,1069,750"/>
<area shape="rect" id="node28" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="1135,698,1208,724"/>
<area shape="rect" id="node29" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1256,698,1345,724"/>
<area shape="rect" id="node30" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1405,698,1444,724"/>
<area shape="rect" id="node31" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1393,647,1456,674"/>
<area shape="rect" id="node34" href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="556,368,655,395"/>
<area shape="rect" id="node35" href="direct__ion_8c.html#a56f9a736ea5fdd9b253e4a7fa07103ce" title="computes the total cooling due collisional ionization " alt="" coords="578,115,633,142"/>
<area shape="rect" id="node37" href="compton_8c.html#a560f4bd0619fdb29b85891d46ce63a48" title="computes the cooling in the cell due to inverse compton scattering. " alt="" coords="570,191,641,218"/>
<area shape="rect" id="node43" href="cooling_8c.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="560,318,651,344"/>
<area shape="rect" id="node36" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="709,27,814,54"/>
<area shape="rect" id="node38" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="736,191,787,218"/>
<area shape="rect" id="node39" href="compton_8c.html#a2f793ca07e9f7ec0220090b8f6b73634" title="The integrand in the integral to obtain the total cooling rate due to inverse compton scattering..." alt="" coords="703,115,820,142"/>
<area shape="rect" id="node40" href="compton_8c.html#a5bffcc1725b11f5b35c37b406aaec263" title="The &#39;cooling&#39; cross section correction to Thompson. " alt="" coords="893,115,935,142"/>
<area shape="rect" id="node42" href="foo_8h.html#a687aa0dcc49f512e562c1e0afddc0263" title="returns a value for the mean intensity " alt="" coords="869,40,959,67"/>
<area shape="rect" id="node41" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="1024,115,1071,142"/>
<area shape="rect" id="node45" href="foo_8h.html#a8c30fbf58d7a0b5789604f00c96bedb6" title="A routine that finds the rooot of a function f. " alt="" coords="297,528,347,555"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_icgraph.png" border="0" usemap="#ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_icgraph" alt=""/></div>
<map name="ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_icgraph" id="ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="116,5,212,32"/>
</map>
</div>

</div>
</div>
<a id="a866bab53f422c2afa889e5e549df76d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a866bab53f422c2afa889e5e549df76d1">&#9670;&nbsp;</a></span>zero_emit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double zero_emit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell in the previous ionization cycle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t A trial temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The difference between the recorded heating and the cooling</dd></dl>
<p>This routine is used to estiamate a new temperature for a cell given the heating of the cell in the previous ionization cycle.</p>
<h3>Notes</h3>
<p>The abundances of ions in the cell are not modified. Results are stored in the cell of interest. This routine is used in connection with a zero finding routine </p>

<p class="definition">Definition at line <a class="el" href="ionization_8c_source.html#l00557">557</a> of file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a866bab53f422c2afa889e5e549df76d1_cgraph.png" border="0" usemap="#ionization_8c_a866bab53f422c2afa889e5e549df76d1_cgraph" alt=""/></div>
<map name="ionization_8c_a866bab53f422c2afa889e5e549df76d1_cgraph" id="ionization_8c_a866bab53f422c2afa889e5e549df76d1_cgraph">
<area shape="rect" id="node2" href="emission_8c.html#af6c4eca39f3573084c0a1ff2d9f22209" title="Calculate the band&#45;limited total emission of a single cell. " alt="" coords="276,409,361,436"/>
<area shape="rect" id="node20" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="131,397,209,424"/>
<area shape="rect" id="node21" href="estimators_8c.html#a1d58fccfac7eec74c69412cfabcc5caf" title="computes the total heating due to matom bb transitions " alt="" coords="422,536,527,563"/>
<area shape="rect" id="node22" href="estimators_8c.html#a6122a3139a25688235ecb8b77e875b0f" title="computes the total heating due to bf transitions for macro atoms. " alt="" coords="119,587,221,613"/>
<area shape="rect" id="node32" href="cooling_8c.html#abf7699b950ec2ef55a4e0087d82d0ab3" title="calculate the total cooling of a cell at a temperature t " alt="" coords="143,257,197,284"/>
<area shape="rect" id="node3" href="estimators_8c.html#ac3d85b1663343d2b268e3bbb09e6dcc6" title="computes the cooling rate due to free&#45;bound recombinations " alt="" coords="427,485,523,512"/>
<area shape="rect" id="node10" href="foo_8h.html#a9d0d69b33092d06a7174d71c3082d2a6" title="returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t b..." alt="" coords="447,283,502,309"/>
<area shape="rect" id="node11" href="estimators_8c.html#ac9b0bd2eb8c4957c99a8c369d02cd169" title="computes the total cooling in matom bb transitions " alt="" coords="427,333,522,360"/>
<area shape="rect" id="node17" href="emission_8c.html#a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d" title="calculates the band&#45;limited ff luminosity of a cell. " alt="" coords="443,435,507,461"/>
<area shape="rect" id="node19" href="foo_8h.html#a0abc40a64ed911b152833da9a675d1b4" title="Calculate the total line emission from a wind cell. " alt="" coords="421,384,528,411"/>
<area shape="rect" id="node4" href="direct__ion_8c.html#ad33c3a097208fb519a5e779c62e3d1f3" title="returns the collisional ionization rate co&#45;efficient " alt="" coords="601,536,654,563"/>
<area shape="rect" id="node8" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="592,587,663,613"/>
<area shape="rect" id="node9" href="foo_8h.html#a53e97649d5cd9a1fab024ab99489ddb1" title="alpha_sp" alt="" coords="596,485,659,512"/>
<area shape="rect" id="node5" href="direct__ion_8c.html#a6a22ee2c1e95eae27423b95ce1283f71" title="Returns the collisional ionization rate coefficient for a given ion/temperature. " alt="" coords="721,561,800,588"/>
<area shape="rect" id="node6" href="log_8h.html#aed844368416d95992f0bbeb9f7fec55b" title="Write a message to the diagnostic file. " alt="" coords="980,580,1048,607"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1217,685,1275,712"/>
<area shape="rect" id="node12" href="foo_8h.html#a277d190575cbdab99ac77d308dc9dfa1" title="Calculate the collisional excitation coefficient for a line. " alt="" coords="608,181,647,208"/>
<area shape="rect" id="node13" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="581,232,673,259"/>
<area shape="rect" id="node14" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="608,384,647,411"/>
<area shape="rect" id="node15" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="608,283,647,309"/>
<area shape="rect" id="node16" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="595,333,660,360"/>
<area shape="rect" id="node18" href="emission_8c.html#aaad109a8ae79883e98e2dee88d65bd4e" title="computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (19..." alt="" coords="598,435,657,461"/>
<area shape="rect" id="node23" href="direct__ion_8c.html#a432a9569392003e4470067b1c44dca5b" title="Returns a collisional recombination rate co&#45;efficient. " alt="" coords="285,649,352,676"/>
<area shape="rect" id="node24" href="direct__ion_8c.html#a193d6c4498adc3507b41e79e52a94016" title="Returns the collisional recombination co&#45;efficient. " alt="" coords="429,663,521,689"/>
<area shape="rect" id="node25" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="589,739,665,765"/>
<area shape="rect" id="node31" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="739,688,783,715"/>
<area shape="rect" id="node26" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="739,739,783,765"/>
<area shape="rect" id="node27" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="848,736,921,763"/>
<area shape="rect" id="node28" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="969,736,1059,763"/>
<area shape="rect" id="node29" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1119,736,1157,763"/>
<area shape="rect" id="node30" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1107,685,1169,712"/>
<area shape="rect" id="node33" href="cooling_8c.html#acbbafed45b10980bb86fe7950daa0604" title="determines the amount of adiabatic cooling in a cell, in units of luminosity. " alt="" coords="269,181,368,208"/>
<area shape="rect" id="node34" href="direct__ion_8c.html#a56f9a736ea5fdd9b253e4a7fa07103ce" title="computes the total cooling due collisional ionization " alt="" coords="291,232,346,259"/>
<area shape="rect" id="node36" href="compton_8c.html#a560f4bd0619fdb29b85891d46ce63a48" title="computes the cooling in the cell due to inverse compton scattering. " alt="" coords="283,131,354,157"/>
<area shape="rect" id="node42" href="cooling_8c.html#af3162ce29644bbfd1d6ef9060d972643" title="calculate the cooling of a single cell due to free free, bound &#45; boound and recombination processes..." alt="" coords="273,333,364,360"/>
<area shape="rect" id="node35" href="direct__ion_8c.html#a71e4aa982b912f78d70646462c6a6115" title="computes the rates due to direct (collisional) ionization from Dere data. " alt="" coords="422,207,527,233"/>
<area shape="rect" id="node37" href="foo_8h.html#a3521f91b62531265426401a6c32fa93f" title="Integrate a function between a and b. " alt="" coords="449,131,500,157"/>
<area shape="rect" id="node38" href="compton_8c.html#a2f793ca07e9f7ec0220090b8f6b73634" title="The integrand in the integral to obtain the total cooling rate due to inverse compton scattering..." alt="" coords="416,80,533,107"/>
<area shape="rect" id="node39" href="compton_8c.html#a5bffcc1725b11f5b35c37b406aaec263" title="The &#39;cooling&#39; cross section correction to Thompson. " alt="" coords="607,80,648,107"/>
<area shape="rect" id="node41" href="foo_8h.html#a687aa0dcc49f512e562c1e0afddc0263" title="returns a value for the mean intensity " alt="" coords="583,5,672,32"/>
<area shape="rect" id="node40" href="compton_8c.html#a89a27f4f3a5c836df75585774ba7a643" title="The &#39;heating&#39; cross section correction to Thompson. " alt="" coords="737,80,784,107"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ionization_8c_a866bab53f422c2afa889e5e549df76d1_icgraph.png" border="0" usemap="#ionization_8c_a866bab53f422c2afa889e5e549df76d1_icgraph" alt=""/></div>
<map name="ionization_8c_a866bab53f422c2afa889e5e549df76d1_icgraph" id="ionization_8c_a866bab53f422c2afa889e5e549df76d1_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="220,5,283,32"/>
<area shape="rect" id="node4" href="templates_8h.html#a09cddd089f4a6cc83c34606d125c28a4" title="calc_te determines and returns the electron temperature in the wind such that the energy emitted by t..." alt="" coords="119,31,172,57"/>
<area shape="rect" id="node3" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="331,5,427,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4894abff5157e9a38f8dd34d0d0c2b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4894abff5157e9a38f8dd34d0d0c2b4a">&#9670;&nbsp;</a></span>xxxplasma</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> xxxplasma</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ionization_8c_source.html#l00324">324</a> of file <a class="el" href="ionization_8c_source.html">ionization.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="ionization_8c.html">ionization.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
