<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/python.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('python_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">python.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="python_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/***********************************************************/</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//OLD /***********************************************************</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//OLD                                        Space Telescope Science Institute</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//OLD  Synopsis:</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//OLD   Python is a program designed to simulate the transfer of radiation in a wind.  It uses the</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//OLD   Sobolev approximation.  It models a wind as a biconical flow.     </span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//OLD   This is the &quot;main&quot; routine for Python.  It&#39;s basic purpose is to gather the input variables </span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//OLD   and to control the flow of the program</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//OLD  </span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//OLD Arguments:        </span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//OLD   Usage:  py [-h] [-r] [-d] [-f] [-t time_max] xxx  or simply py</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//OLD   where xxx is the rootname or full name of a parameter file, e. g. test.pf</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//OLD   and the switches have the following meanings</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//OLD   -h  to get this help message</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//OLD   -r  restart a run of the program reading the file xxx.windsave</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//OLD   -t time_max limit the total time to approximately time_max seconds.  Note that the program checks</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//OLD       for this limit somewhat infrequently, usually at the ends of cycles, because it</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//OLD       is attempting to save the program outputs so that the program can be restarted with</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//OLD       -r if theat is desired.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//OLD   -v num  determines the amount of information that is printed out.  If num is small, then</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//OLD       less information is printed out; if num is large more is printed out.  Setting</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//OLD       v to 5 causes the routine to print out all the information which outputs have</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//OLD       included previously.  The current default is set to 3 which suppresses Debug, Log_silent</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//OLD       and Error_silent</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//OLD   -e nnn  The program stops normally stops after 1e6 errors of any type.  This switch allows one to</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//OLD       adjust this number</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//OLD   -d  Enters detailed or advanced mode. Allows one to access extra diagnositics and some</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//OLD           other advanced commands</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//OLD     -f    Fixed temperature mode - does not attempt to change the temperature of cells.</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//OLD   -i      Diagnostic mode which quits after reading in inputs. Used for Travis test suite.</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//OLD     --dry-run Create a new .pf file and stop (equivalent to -i)</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//OLD   -z      Mode to connect with zeus - it either runs two cycles in this is the first call - in order</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//OLD           to obtain a good starting state, else it runs just one cycle. In both cases, it does</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//OLD           not attempt to seek a new temperature, but it does output heating and cooling rates</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//OLD     --version print out python version, commit hash and if there were files with uncommitted</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//OLD           changes</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//OLD       --rseed set the random number seed to be time based, rather than fixed.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//OLD   if one simply types py or pyZZ where ZZ is the version number one is queried for a name</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//OLD   of the parameter file.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//OLD   NOTE - If this is modified, please also modify the help message in help() below</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//OLD Returns:</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//OLD  </span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//OLD Description:  </span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//OLD   Python is far too complicated to describe.  Basically it simulates the radiative transfer</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//OLD   of photons through the wind of a cataclysmic variable or a star.  The kinematic formulation for</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//OLD   the CV wind is due to Schlossman and Vitello while that of the star is due to Castor &amp; Larmors. </span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//OLD    Radiation from an optically thick disk, the WD star, a boundary layer and the wind itself</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//OLD    may be included</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//OLD   There are 3 basic portions to the program which are easy to see in the main program.</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//OLD   1. A data gathering stage</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//OLD   2. A calculation of the state of ionization of the wind.</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//OLD   3. A calculation of a detailed spectrum in which the ionization is held fixed.</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//OLD       </span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//OLD Notes:</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//OLD   The program has been designed and tested both on Suns and MacIntoshes (with Symentec&#39;s</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//OLD   C compiler).  Some of its peculiarities are due to memory limitations and relatively small </span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//OLD   stack sizes on the Mac.  When compiling, check to see that the global varible MAC is</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//OLD   set properly in python.h.</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//OLD History:</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//OLD   97jan   ksl Coding on python began.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//OLD   97jul   ksl Added capability model the spectrum as a function of orbital phase.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//OLD   97aug   ksl Added boundary layer as additional source of radiation</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//OLD   97aug   ksl Added capability to extract spectra with a specific number of scatters</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//OLD   97nov   ksl Changed error and diagnostic logging</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//OLD   98july  ksl Added radiation from the wind itself</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//OLD   98nov   ksl Added spherical winds and greatly modified I/O  </span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//OLD   99jan   ksl Added ability to enter parameter file (w/out) root on command line</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//OLD   99jul   ksl Begin eliminating MAC dependencies</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//OLD   00sep   ksl Began work on adding a new coronal possibility</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//OLD   01mar   ksl Added a knigge wind</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//OLD         01sept    ksl Added a thierry wind</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//OLD   01dec   ksl Incorporated improved atomic data reading codes, and</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//OLD           made a variety of other major changes to the way in</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//OLD           which many of the subroutines operate.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//OLD   01dec   ksl Revised way in which old windfile option works.  It</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//OLD           was not working at all originally, because of a</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//OLD           change I made in April.  The new method is a bit dangerous</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//OLD           because it does change a good bit of geo, since all of the</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//OLD           input data is read in.  In principle, his can create an inconsistency</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//OLD           between some of the info in geo and some in the wind array.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">//OLD           But it keeps the wind the same, which is what was desired.  </span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//OLD   01dec   ksl Added a general capability to python(40) so that during the</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//OLD           the ionization cycle photons do not necessarily have identical</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//OLD           weights.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//OLD   02jan   ksl Moved specific inputs for KWD wind to knigge.c</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//OLD   02feb   ksl Added anisotropic wind scattering</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//OLD   02feb   ksl 41.1 -- Allowed user to chose between anisotropic and</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">//OLD           isotropic scattering in the wind.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">//OLD   02feb   ksl 41.2 -- Added aditional options for choosing what photons</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">//OLD           to count</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">//OLD   02apr   ksl 43.1 -- Added additional radiative transfer options.  Modified main</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">//OLD           so that a spectrum is printed out after each cycle</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">//OLD   02jul   ksl 43.7 -- Considerable changes associated with photoionization</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">//OLD           and recombination were made.  The initial attemps to allow</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">//OLD           for using a more accurate detailed balance approach were</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">//OLD           included in the ionizatio routines.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">//OLD   03dec   ksl Added back some timing ability</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//OLD         04Mar   SS      Minor changes to set switch for macro atom method.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//OLD                         geo.line_mode=6 switches geo.rt_mode=2 (macro method)</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">//OLD                         and then geo.ine_mode back to =3. (SS)</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">//OLD         04Apr   SS      Minor change to set a switch for geo.line_mode=7 </span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">//OLD                         which is the same as 6 but with anisotropic scattering</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//OLD         04May   SS      geo.line_mode=8 added: this mode is the same as mode 6</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">//OLD                         BUT will treat all ions as simple - it is for </span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">//OLD                         test purposes only.</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//OLD   04Jun   ksl Added new disk + wind model for ysos.  In process, moved</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">//OLD           the variables describing the wind mdots to subroutines</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">//OLD   04Aug   ksl 52 -- Modified input variables to allow a variety of input models</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">//OLD           all ascii-based.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">//OLD   04Aug   ksl 52 -- Modified input variables to allow for various disk illumination</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">//OLD           models</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">//OLD   04Aug   ksl 52 -- Modified to allow for vertically extended disks. Note that some of</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//OLD           the input variables were rearranged in the process.</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">//OLD         04Aug   SS      Minor modifications to cope with finite disk thickness calculations.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">//OLD   04dec   ksl 54a -- Minor mod to calculation of fraction of luminosity that hits</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">//OLD           disk so that correct values are printed out in situation where there</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">//OLD           are multiple subcycles.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//OLD   04dec   ksl 54e -- Minor mod to record master atomic file in geo, and, for the </span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">//OLD           case of fixed concentration to store the file where the concentrations</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">//OLD           are contaned.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">//OLD   05apr   ksl 56 -- Added new variable geo.binary_system to avoid binary system</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">//OLD           questions in cases where one was modelling a single object.  Note</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">//OLD           that I did not remove seemingly superfluous quesions regarding</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">//OLD           phase because one can still extract photons in various azimuthal</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">//OLD           directions, and if we ever move to 3d situations one might want</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">//OLD           to deal with non-axially symmetric systems.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">//OLD   05jul   ksl 56d -- Updated to include new windcone definitions.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">//OLD   05jul   ksl 56d -- Completed basic work to allow vertically extended disk</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">//OLD   06may   ksl 57g -- Began work on modifying structures to lower memory requirments</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">//OLD           At empty wind cells have mostly been eliminated, and macroatoms</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">//OLD           have been split off into a separate structure so this is not </span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">//OLD           used.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">//OLD   06jul   ksl 57h -- Have contined work to speed program up as much as possible</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">//OLD           by giving more control over the parameters that govern the speed</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">//OLD           such as SMAX_FRAC.</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">//OLD   06oct   ksl 58 -- This version is a cleaned up version of py57ib, which differs</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">//OLD           from 57h primarily in bb.c and pdf.c.   In addition, this version</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//OLD           makes it possible to use the SV velocity law in what is otherwise</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">//OLD           a KWD description of the wind.  </span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">//OLD   06nov   ksl 58c -- This version requires and updated version of kpar, that </span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">//OLD           keeps track of all the errors.  </span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">//OLD   07aug   ksl 58f -- Modified the way in which the program handles a situation</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">//OLD           in which one attempts to run with a non-existent .pf file.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">//OLD   08may   ksl 60a -- Significant modifications were made to the main routine</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">//OLD           to make sure we could restart models.  Unfortunaaely rhe point</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">//OLD           at which the user was asked for the atomic data needed to be changed,</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">//OLD           so earlier .pf files will need to be modified.  </span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//OLD   080808  ksl 62 -- Cleaned up wind ionization options</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">//OLD   081110  ksl 67 -- Revised a number of portions of the main python.c routine</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">//OLD           to enable restarts.  There are still inconsistencies in the</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">//OLD           way one reads information from the .pf file after having read</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">//OLD           in the windsave files that could be cleaned up.</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">//OLD   081218  ksl 67c -- Added a switch -h to provide information about usage.</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">//OLD   090202  ksl 68b -- Added switch -v  to control the level of verbosity.  Updated</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">//OLD           Plasma to allow routine to track scatters and absorption during</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">//OLD           generation of detailed spectrum</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">//OLD   090402  ksl NSPEC has been moved to the main routine, as its only remaining</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">//OLD           purpose is to define some arrays in the main routine.  Note that</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//OLD           MSPEC still has meaning as the number of spectra of various types</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">//OLD           that are construced without going through types.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">//OLD   1108    ksl/nsh Adding code to keep track of gross spectra in a cell though xbands,</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">//OLD           xj and xave_freq.  Just set up the frequence limits here.   </span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">//OLD   1112    ksl Moved everything associated with frequency bands into bands_init</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">//OLD   1212    nsh changed the way DFUDGE is defined.</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">//OLD         1302  jm  74b5 introduced double precision variable for photon number for calling </span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">//OLD           define_phot. Fixes Bug JM130302 in photon weights. It has been suggested</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">//OLD           that we should make NPHOT a long integer- at the moment I have not done </span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">//OLD           this and simply comverted to double before calling define_phot (otherwise </span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">//OLD           I believe rdint would have to be redone for long integers).</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">//OLD   1304    ksl 75 rewrote the fix above to use a long, instead of double.  </span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">//OLD           This has plenty of range.  Notge that there is no need to make NPHOT</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">//OLD           a long, as suggested above.  We do not expect it to exceed 2e9,</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">//OLD           although some kind of error check might be reasonble.</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">//OLD   1306    ksl Modified to allow a power law component to a stellar spectrum.  Made</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">//OLD           some changes use DEF variables instead of numbers to make choices</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">//OLD   1307    jm  SS Parallelized Python in June 2013, for release 76a. I have now introduced</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//OLD           slightly altered reporting to allow more succinct reporting in parallel mode.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//OLD   1307    ksl Removed the Thierry &amp; Hubeny O-star models as an option from the code.</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//OLD           This was never tested, and never really used.  Knox no longer even has the </span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">//OLD           models.  Note that Stuart is replacing this with a homologous expansion</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">//OLD           model</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//OLD   1308    nsh Added a call to generate rtheta wind cones - issue #41</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//OLD   1309    nsh Changed the loop around where disk parameters are read in - issue #44</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//OLD   1309    nsh Added commands to write out warning summary - relating to issue #47</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">//OLD       1312    nsh Added a new parameter file command to turn off heating and cooling mechanisms</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">//OLD           at the moment it only does adiabatc</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//OLD           Also some modifications to the parallel communiactions to deal with some new</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">//OLD           plasma variabales, and the min and max frequency photons seen in bands.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">//OLD   1409    ksl Added new switch -d to enable use of a new Debug logging feature</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">//OLD   1411    JM removed photons per cycle in favour of NPHOT. subcycles are now eliminated</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">//OLD   1501    JM moved some parallelization stuff to subroutines in para_update.c</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">//OLD           functions are communicate_estimators_para, communicate_matom_estimators_para,</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">//OLD           and gather_spectra_para</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">//OLD   1502        Major reorganisation of input gathering and setup. See setup.c, #136 and #139</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">//OLD   1508    ksl Instroduction of the concept of domains to handle the disk and wind as separate</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">//OLD           domains</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">//OLD     1711    ksl Removed the Elvis wind option</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">//OLD   </span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//OLD   Look in Readme.c for more text concerning the early history of the program.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//OLD </span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">//OLD **************************************************************/</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="atomic_8h.html">atomic.h</a>&quot;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span>       <span class="comment">//To allow the used of the clock command without errors!!</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="python_8h.html">python.h</a>&quot;</span></div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="python_8c.html#ade1df1cb82ae4ef9a5c0cddb37d9a73b">  241</a></span>&#160;<span class="preprocessor">#define NSPEC   20</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">/**********************************************************/</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="python_8c.html#afced8478b91af5c169926dfa4426333d">  286</a></span>&#160;<a class="code" href="python_8c.html#afced8478b91af5c169926dfa4426333d">main</a> (argc, argv)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     <span class="keywordtype">int</span> argc;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     <span class="keywordtype">char</span> *argv[];</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="structwind.html">WindPtr</a> <a class="code" href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">w</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordtype">double</span> freqmin, freqmax;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">int</span> n;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  FILE *fopen ();</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">int</span> opar_stat, restart_stat;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordtype">double</span> time_max;      <span class="comment">// The maximum time the program is allowed to run before halting</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">double</span> lstar;         <span class="comment">// The luminosity of the star, iv it exists</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="xlog_8c.html#a36683b6f0eb124ab5a7c462b3f3ca1cc">my_rank</a>;          <span class="comment">// these two variables are used regardless of parallel mode</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordtype">int</span> np_mpi;           <span class="comment">// rank and number of processes, 0 and 1 in non-parallel</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  </div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#ifdef MPI_ON</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  MPI_Init (&amp;argc, &amp;argv);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  MPI_Comm_rank (MPI_COMM_WORLD, &amp;my_rank);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  MPI_Comm_size (MPI_COMM_WORLD, &amp;np_mpi);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  my_rank = 0;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  np_mpi = 1;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a> = np_mpi;   <span class="comment">// Global variable which holds the number of MPI processes</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> = <a class="code" href="xlog_8c.html#a36683b6f0eb124ab5a7c462b3f3ca1cc">my_rank</a>;    <span class="comment">// Global variable which holds the rank of the active MPI process</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="log_8h.html#ac8c2622fe84047acf2894bcf91fcef73">Log_set_mpi_rank</a> (my_rank, np_mpi);   <span class="comment">// communicates my_rank to kpar</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  opar_stat = 0;        <span class="comment">/* Initialize opar_stat to indicate that if we do not open a rdpar file, </span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">                   the assumption is that we are reading from the command line */</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  restart_stat = 0;     <span class="comment">/* Assume initially that these is a new run from scratch, and not </span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">                   a restart */</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  time_max = 13.8e9 * 3.2e7;    <span class="comment">/* The maximum time the program will run without stopping.  This</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">                   is initially set to the lifetime of the universe */</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  time_max = -1;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <a class="code" href="foo_8h.html#a53d75807008c96f7053e25e029ed8a95">set_max_time</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, time_max);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">/* Set the verbosity level for logging.  To get more info raise the verbosity level to a higher number. To</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">     get less set the verbosity to a lower level. The verbosity can be reset from the comamnd line */</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="python_8h.html#a1bdcfae3209cbd96db35a2ae356fa15e">verbosity</a> = 3;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="log_8h.html#a6568a4df00f76870b9e36f94c573a4ad">Log_set_verbosity</a> (<a class="code" href="python_8h.html#a1bdcfae3209cbd96db35a2ae356fa15e">verbosity</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">/* initialise the advanced mode flags (all set to 0) which is a structure in python.h */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="foo_8h.html#af01dfd90f1eaaa70104a594dd92bd30c">init_advanced_modes</a> ();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">/* Parse the command line. Get the root. create files.diagfolder + diagfiles */</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  restart_stat = <a class="code" href="foo_8h.html#aa181995d7df5c31711c06ff2657f2f29">parse_command_line</a> (argc, argv);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">/* If the restart flag has been set, we check to see if a windsave file exists.  If it doues we will </span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">     we will restart from that point.  If the windsave file does not exist we will start from scratch */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="foo_8h.html#a3995f2a6ba379027804653e28e4feac1">init_log_and_windsave</a> (restart_stat);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9">Log_parallel</a> (<span class="stringliteral">&quot;Thread %d starting.\n&quot;</span>, my_rank);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">/* Start logging of errors and comments */</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!Python Version %s \n&quot;</span>, <a class="code" href="version_8h.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>);  <span class="comment">//54f -- ksl -- Now read from version.h</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!Git commit hash %s\n&quot;</span>, <a class="code" href="version_8h.html#af4763d53e5a3f37642797fac3ee14564">GIT_COMMIT_HASH</a>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">/* warn the user if there are uncommited changes */</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">int</span> git_diff_status = <a class="code" href="version_8h.html#a352befcd3b5ee44940f2a37db2e325a3">GIT_DIFF_STATUS</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">if</span> (git_diff_status &gt; 0)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      (<span class="stringliteral">&quot;!!Git: This version was compiled with %i files with uncommitted changes.\n&quot;</span>,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;       git_diff_status);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;!!Python is running with %d processors\n&quot;</span>, <a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <a class="code" href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9">Log_parallel</a></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    (<span class="stringliteral">&quot;This is MPI task number %d (a total of %d tasks are running).\n&quot;</span>,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>, <a class="code" href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa">Debug</a> (<span class="stringliteral">&quot;Debug statements are on. To turn off use lower verbosity (&lt; 5).\n&quot;</span>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Initializing variables for %s\n&quot;</span>, <span class="stringliteral">&quot;NOK&quot;</span>,</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;       <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  opar_stat = <a class="code" href="foo_8h.html#ac88fda6c445f7e99eb1238b8132576ad">setup_created_files</a> ();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">/* Allocate the domain structure */</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a> = (<a class="code" href="python_8h.html#ae022cd774d7ee369fc758eff33990847">DomainPtr</a>) calloc (<span class="keyword">sizeof</span> (<a class="code" href="structdomain.html">domain_dummy</a>), <a class="code" href="python_8h.html#a157bd6748b72993519aae76091de0008">MaxDom</a>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">/* BEGIN GATHERING INPUT DATA */</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">/* Describe the basic calculation in terms of the number of iterations which will</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">     be used to calculate the wind parameters and the number of iterations and wavelength</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">     range which will be used for the final spectrom.  Also describe the observer&#39;s views</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">     of the system */</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">if</span> (restart_stat == 1)    <span class="comment">/* We want to continue a run. This is generally used </span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">                   because we had to limit to runtime of python or we decided</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">                   we needed more ionization or spectral cycles */</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;Continuing a previous run of %s \n&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      strcpy (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      strcat (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>, <span class="stringliteral">&quot;.wind_save&quot;</span>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="foo_8h.html#ad72f5c977c7a79152243ba8ba509cccc">wind_read</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>) &lt; 0)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;python: Unable to open %s\n&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>);    <span class="comment">//program will exit if unable to read the file</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      exit (0);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      w = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> = <a class="code" href="python_8h.html#a6941aa4454202b7692e5555b66badd42">RUN_TYPE_RESTART</a>;  <span class="comment">// We are continuing an old run</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Read %s\n&quot;</span>, <span class="stringliteral">&quot;COMMENT&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> &gt; 0)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <a class="code" href="foo_8h.html#abaf08b81d739ed75e14ee5932317af2d">spec_read</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a12010879e17a410582c95418e70fb8f4">specsave</a>);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Read %s\n&quot;</span>, <span class="stringliteral">&quot;COMMENT&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a12010879e17a410582c95418e70fb8f4">specsave</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (restart_stat == 0)   <span class="comment">/* We are starting a new run, which is the normal mode of operation */</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="comment">/* First,  establish the overall system type.  XXX System type should be a physical system,</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">       * to make things easier for the user.  So really want system types to be something like</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">       * CV, YSO, AGN so that defaults can be set. </span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa1d0031436952c2a2fdc2506c137b3d8">system_type</a> = <a class="code" href="python_8h.html#a1fce05260cd94e4bb0908a0b5d2b4e17">SYSTEM_TYPE_STAR</a>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a>=<a class="code" href="python_8h.html#a5775504a597057eb63ccda35871a3c16">RUN_TYPE_NEW</a>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="log_8h.html#a3a649b0453ce83dbb1b16de81e08f5af">rdint</a> (<span class="stringliteral">&quot;System_type(0=star,1=binary,2=agn,3=previous)&quot;</span>,</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;         &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa1d0031436952c2a2fdc2506c137b3d8">system_type</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa1d0031436952c2a2fdc2506c137b3d8">system_type</a> == <a class="code" href="python_8h.html#a96118defc18eccb296450a8b9c474027">SYSTEM_TYPE_PREVIOUS</a>)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="comment">/* This option is for the confusing case where we want to start with a previous wind </span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">         model,(presumably because that run produced a wind close to the one we are looking for, </span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">         but we are going to change some parameters that do not affect the wind geometry,  </span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">         We will write use new filenames for the results, so all of the previous work is still saved,</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      strcpy (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>, <span class="stringliteral">&quot;earlier.run&quot;</span>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="log_8h.html#a84a2c7bd396934f47298859d6019ba8f">rdstr</a> (<span class="stringliteral">&quot;Wind.old_windfile(root_only)&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      strcat (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>, <span class="stringliteral">&quot;.wind_save&quot;</span>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        (<span class="stringliteral">&quot;Starting a new run from scratch starting using a previous windfile\n&quot;</span>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="comment">/* Note that wind_read also reads the atomic data file that was used to create the previous run of the data. */</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="foo_8h.html#ad72f5c977c7a79152243ba8ba509cccc">wind_read</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>) &lt; 0)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a> (<span class="stringliteral">&quot;python: Unable to open %s\n&quot;</span>, <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">old_windsave</a>);    <span class="comment">//program will exit if unable to read the file</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          exit (0);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> = <a class="code" href="python_8h.html#a9bc1d8131e46b327abd573ff73547834">RUN_TYPE_PREVIOUS</a>; <span class="comment">// after wind_read one will have a different wind_type otherwise</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      w = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">wcycle</a> = 0;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">pcycle</a> = 0;   <span class="comment">/* This is a new run of an old windsave file so we set the nunber of cycles already done to 0 */</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> == <a class="code" href="python_8h.html#a5775504a597057eb63ccda35871a3c16">RUN_TYPE_NEW</a> || <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> == <a class="code" href="python_8h.html#a9bc1d8131e46b327abd573ff73547834">RUN_TYPE_PREVIOUS</a>)</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">/* This option is the most common one, where we are starting to define a completely new system.  </span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a>==<a class="code" href="python_8h.html#a5775504a597057eb63ccda35871a3c16">RUN_TYPE_NEW</a>) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <a class="code" href="foo_8h.html#a555f188199cb3346b32e289e64c9d980">init_geo</a> ();      <span class="comment">/* Set values in the geometry structure and the domain stucture to reasonable starting</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">                   values */</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="comment">/* get_stellar_params gets information like mstar, rstar, tstar etc.</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">         it returns the luminosity of the star */</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      lstar = <a class="code" href="foo_8h.html#a5e18aeda5d11190333c93b952b562b04">get_stellar_params</a> ();</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="comment">/* Describe the disk */</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <a class="code" href="foo_8h.html#a611c7cc190ffb8c6494e75ec549191f3">get_disk_params</a> ();</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="comment">/* describe the boundary layer / agn components to the spectrum if they exist. </span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">         So that initial condiditions for the bl and agn are initialized sensibly this has</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">         to come after the disk is defined.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <a class="code" href="foo_8h.html#a897e0ae97c32a481075df9fc45f6e745">get_bl_and_agn_params</a> (lstar);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment">/* At this point we check whether we have any sources of radiation and exit if we do not */</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#afa33aaacf8e2a7956bcea9c4e2257f9b">star_radiation</a> &amp;&amp; !<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a3c382f0f9c6d402381b6faeb5b4f216f">disk_radiation</a> &amp;&amp; !<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a25933883c250dfbd51df9f1df808c6d9">bl_radiation</a></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          &amp;&amp; !<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a25933883c250dfbd51df9f1df808c6d9">bl_radiation</a> &amp;&amp; !<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0be43d0c0f6fd83ef56702359de54512">agn_radiation</a>)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          <a class="code" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        (<span class="stringliteral">&quot;python: No radiation sources so nothing to do but quit!\n&quot;</span>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          exit (0);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="comment">/* With the macro atom approach we won&#39;t want to generate photon </span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">         bundles in the wind so switch it off here. (SS) */</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">rt_mode</a> == <a class="code" href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a>)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        (<span class="stringliteral">&quot;python: Using Macro Atom method so switching off wind radiation.\n&quot;</span>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;          <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aff6d34b209264b154fa7bd36266f70de">wind_radiation</a> = 0;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="comment">/* Describe the wind. This routine reads in geo.rmax and geo.twind</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">         and then gets params by calling e.g. get_sv_wind_params() */</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <a class="code" href="log_8h.html#ae97b0cce071056f882a059ef092f2c40">rdpar_comment</a></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        (<span class="stringliteral">&quot;Parameters descibing the various winds or coronae in the system&quot;</span>);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <a class="code" href="log_8h.html#a3a649b0453ce83dbb1b16de81e08f5af">rdint</a> (<span class="stringliteral">&quot;Wind_radiation(y=1)&quot;</span>, &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aff6d34b209264b154fa7bd36266f70de">wind_radiation</a>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> == <a class="code" href="python_8h.html#a5775504a597057eb63ccda35871a3c16">RUN_TYPE_NEW</a>)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          <a class="code" href="log_8h.html#a3a649b0453ce83dbb1b16de81e08f5af">rdint</a> (<span class="stringliteral">&quot;Wind.number_of_components&quot;</span>, &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;          <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; n++)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          <a class="code" href="foo_8h.html#af355cb7acb867d8ada078fe8ced97f2f">get_domain_params</a> (n);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">/* Get the remainder of the input data.  Note that the next few lines are read from the input file whether or not the windsave file was read in,</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">   because these are things one would like to be able to change even if we have read in an old windsave file.  init_photons reads in </span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">   the numbers of ionization and spectral cycles and then instatiates PhotPtr.  It is possilbe that this should be moved to else where in</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">   the flow of reading in data.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">/* XXX- All operating modes */</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="foo_8h.html#a3eba280b12bdc0cafaf8a7fbe33a887a">init_photons</a> ();</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">/* Define how ionization is going to be calculated */</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">/* XXX- All operating modes */</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <a class="code" href="foo_8h.html#a887b555bea1486a6c04a71838b690b63">init_ionization</a> ();</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">/* Note: ksl - At this point, SYSTEM_TYPE_PREVIOUS refers both to a restart and to a situation where </span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">   * one is starting from an early wind file as implemented this is quite restrictive about what one</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">   * can change in the previous case.   */</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> == <a class="code" href="python_8h.html#a5775504a597057eb63ccda35871a3c16">RUN_TYPE_NEW</a>) <span class="comment">// Start of block to define a model for the first time</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="comment">/* Describe the wind, by calling get_wind_params one or more times</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">         and then gets params by calling e.g. get_sv_wind_params() </span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">         XXX - There is currently an issue that geo.ramax is scked for</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">         multiple times. */</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; n++)</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <a class="code" href="log_8h.html#ae97b0cce071056f882a059ef092f2c40">rdpar_comment</a> (<span class="stringliteral">&quot;Parameters for Domain %d&quot;</span>, n);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="foo_8h.html#a156f40c5dd5b2c76f1002d05f712b0a0">get_wind_params</a> (n);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }               <span class="comment">// End of block to define a model for the first time</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">zeus_connect</a> == 1) <span class="comment">/* We are in rad-hydro mode, we want the new density and temperature */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="comment">/* Hydro takes the wind domain number as an argument in the current domains setup */</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    (<span class="stringliteral">&quot;We are going to read in the density and temperature from a zeus file\n&quot;</span>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <a class="code" href="foo_8h.html#a839f7eaa23de10001c2ec293dc890563">get_hydro</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9e4e74de249210566125f8254f468184">hydro_domain_number</a>);  <span class="comment">//This line just populates the hydro structures  </span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">/* Calculate additional parameters associated with the binary star system */</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa1d0031436952c2a2fdc2506c137b3d8">system_type</a> == <a class="code" href="python_8h.html#a63732238e6ee8b8da1f3c162f4a7042f">SYSTEM_TYPE_BINARY</a>)</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="foo_8h.html#a22069934602644cf4f894c0b48967d49">binary_basics</a> ();</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">/* Check that the parameters which have been supplied for the star, disk and boundary layer will</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">     allow generation of photons where that is appropriate */</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a616dab8404be7333cecb406cd354d906">tstar</a> &lt;= 0.0)</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#afa33aaacf8e2a7956bcea9c4e2257f9b">star_radiation</a> = 0;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a45dca7da50031053e3afe2da3bd5aac7">disk_mdot</a> &lt;= 0.0 &amp;&amp; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a6303d18fc24435a8be2822e1a98b8747">disk_tprofile</a> == <a class="code" href="python_8h.html#a08859148ab82ac4d52232b19653dd399">DISK_TPROFILE_STANDARD</a>)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a3c382f0f9c6d402381b6faeb5b4f216f">disk_radiation</a> = 0;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a1f8e0859717e5e41ed53be2e222b9e2b">t_bl</a> &lt;= 0.0 || <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#aa2ea17f8b23e8e3785c3685c9261a8bf">lum_bl</a> &lt;= 0.0)</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a25933883c250dfbd51df9f1df808c6d9">bl_radiation</a> = 0;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">/* If the disk radius is &lt;0, assume no disk was intended. */</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a71b7a3a06fb5c18efba2b2642cb8e060">diskrad</a> &lt;= 0.0)</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a17efc849b549c82a01393a50b62315a6">disk_type</a> = <a class="code" href="python_8h.html#aec4250ef7545b2393f4f3e07d63f28f6">DISK_NONE</a>;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a3c382f0f9c6d402381b6faeb5b4f216f">disk_radiation</a> = 0;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#afa33aaacf8e2a7956bcea9c4e2257f9b">star_radiation</a>)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There is a star which radiates\n&quot;</span>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;The star in the system does not radiate\n&quot;</span>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a17efc849b549c82a01393a50b62315a6">disk_type</a>)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There is no disk in the system \n&quot;</span>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a3c382f0f9c6d402381b6faeb5b4f216f">disk_radiation</a>)</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;The disk exists, but only absorbs photons\n&quot;</span>);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There is a disk which radiates and absorbs\n&quot;</span>);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a25933883c250dfbd51df9f1df808c6d9">bl_radiation</a>)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There is a boundary layer which radiates\n&quot;</span>);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There is no boundary layer\n&quot;</span>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0be43d0c0f6fd83ef56702359de54512">agn_radiation</a>)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There is a BH  which radiates\n&quot;</span>);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There is no BH \n&quot;</span>);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">/* Describe the spectra which will be extracted and the way it will be extracted */</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="comment">/* First initialise things to semi-reasonable values */</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">/* These two variables have to do with what types of spectra are created n the</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"> * spectrum files. They are not associated with the nature of the spectra that</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"> * are generated by say the boundary layer</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">select_extract</a> = 1;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a384632d687a144af30856d0c8d96f01c">select_spectype</a> = 1;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">/* Completed initialization of this section.  Note that get_spectype uses the source of the</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"> * ratiation and then value given to return a spectrum type. The output is not the same </span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"> * number as one inputs. It&#39; s not obvious that this is a good idea. */</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">pcycles</a> &gt; 0)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <a class="code" href="log_8h.html#ae97b0cce071056f882a059ef092f2c40">rdpar_comment</a> (<span class="stringliteral">&quot;Parameters defining the spectra seen by observers\n&quot;</span>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <a class="code" href="foo_8h.html#ab358cbada062a9acccdf184b57630305">get_spectype</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#afa33aaacf8e2a7956bcea9c4e2257f9b">star_radiation</a>,</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="comment">//&quot;Rad_type_for_star(0=bb,1=models,2=uniform)_in_final_spectrum&quot;,</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="stringliteral">&quot;Central_object.rad_type_in_final_spectrum(0=bb,1=models,2=uniform)&quot;</span>,</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a38ee7d8d2a6a863cd437dcafc58ebc10">star_spectype</a>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <a class="code" href="foo_8h.html#ab358cbada062a9acccdf184b57630305">get_spectype</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a3c382f0f9c6d402381b6faeb5b4f216f">disk_radiation</a>,</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="comment">//&quot;Rad_type_for_disk(0=bb,1=models,2=uniform)_in_final_spectrum&quot;,</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="stringliteral">&quot;Disk.rad_type_in_final_spectrum(0=bb,1=models,2=uniform)&quot;</span>,</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a03d95e2ef842e21fb07e2076ab560c98">disk_spectype</a>);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <a class="code" href="foo_8h.html#ab358cbada062a9acccdf184b57630305">get_spectype</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a25933883c250dfbd51df9f1df808c6d9">bl_radiation</a>,</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="comment">//&quot;Rad_type_for_bl(0=bb,1=models,2=uniform)_in_final_spectrum&quot;,</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="stringliteral">&quot;Boundary_layer.rad_type_in_final_spectrum(0=bb,1=models,2=uniform)&quot;</span>,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#ad8186bf06722e4d1fda29b9162374596">bl_spectype</a>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af4e6a2e8c84eebc16bd93c17899c124f">agn_spectype</a> = 3;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <a class="code" href="foo_8h.html#ab358cbada062a9acccdf184b57630305">get_spectype</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0be43d0c0f6fd83ef56702359de54512">agn_radiation</a>,</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="stringliteral">&quot;Rad_type_for_agn(3=power_law,4=cloudy_table,5=bremsstrahlung)_in_final_spectrum&quot;</span>,</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af4e6a2e8c84eebc16bd93c17899c124f">agn_spectype</a>);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <a class="code" href="foo_8h.html#afc4ebd7d545f29d6e3a9505cf462c62c">init_observers</a> ();</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a4b97dc16b54fd49d53a06ff8896596a6">matom_radiation</a> = 0;  <span class="comment">//initialise for ionization cycles - don&#39;t use pre-computed emissivities for macro-atom levels/ k-packets.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <a class="code" href="diag_8c.html#acb7ea92897c7bc8fa09f98078babcc01">get_standard_care_factors</a> ();</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <a class="code" href="foo_8h.html#a4017af15d8bd072936049dafc4250a1b">get_meta_params</a> ();</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">/* Establish limits on the frequency intervals to be used by the ionization cycles and </span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"> * the fraquency bands for stratified sampling. These bands are alos used as the spectral</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"> * intervals for creating crude spectra in each of the cells</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"> * This section of inputs might logically go earlier in the code, but</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"> * was put here so it would add on to existing .pf files.  It would be reasonble to consider moving</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"> * it to a more logical location</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="log_8h.html#ae97b0cce071056f882a059ef092f2c40">rdpar_comment</a> (<span class="stringliteral">&quot;Other parameters&quot;</span>);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <a class="code" href="bands_8c.html#a3513a64162c15d3d3d101c3d5ea2367f">bands_init</a> (-1, &amp;<a class="code" href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a>);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  freqmin = <a class="code" href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a>.<a class="code" href="structxbands.html#a4822266ca02ed8a4b214e5efcd79256c">f1</a>[0];</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  freqmax = <a class="code" href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a>.<a class="code" href="structxbands.html#af398da6fd226bb4257ad64ac9704098a">f2</a>[<a class="code" href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a>.<a class="code" href="structxbands.html#aad6fe819267976ae85b61e65e0b70f75">nbands</a> - 1];</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#af01ce2e0a78e9f6f5bf1ef516626996f">iadvanced</a>)</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="comment">/* Do we require extra diagnostics or not */</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <a class="code" href="log_8h.html#a3a649b0453ce83dbb1b16de81e08f5af">rdint</a> (<span class="stringliteral">&quot;@Diag.extra(0=no,1=yes) &quot;</span>, &amp;<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a1b1488c202da4f2131eb2800e10ed2a1">diag_on_off</a>);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a1b1488c202da4f2131eb2800e10ed2a1">diag_on_off</a>)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <a class="code" href="diag_8c.html#ab28b32b3a1f983da958d2a6a8a0554fc">get_extra_diagnostics</a> ();</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">/* Wrap up and save all the inputs */</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span> (strncmp (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;mod&quot;</span>, 3) == 0)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="log_8h.html#afa6d193a6665f1ee917420a371ae133d">cpar</a> (<span class="stringliteral">&quot;mod.pf&quot;</span>);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opar_stat == 1)</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <a class="code" href="log_8h.html#afa6d193a6665f1ee917420a371ae133d">cpar</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ad69a4b6cb667c701b42275495c4cd002">input</a>);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <a class="code" href="log_8h.html#afa6d193a6665f1ee917420a371ae133d">cpar</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a78ff170f6723c4497848c471d5faf579">new_pf</a>);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">/* At this point, all inputs have been obtained at this point and the inputs have been copied to &quot;mod.pf&quot; or &quot;python.pf&quot;</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">   * If we have used, the -i flag, we quit; otherwise we continue on to run the model */</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a77fab35698c16498dee21a41813c9811">quit_after_inputs</a>)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    (<span class="stringliteral">&quot;This was was run with the -i or --dry-run flag set, so quitting now inputs have been gathered.\n&quot;</span>);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      exit (0);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">/* INPUTS ARE FINALLY COMPLETE */</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="comment">/* Print out some diagnositic infomration about the domains */</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    </div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;There are %d domains\n&quot;</span>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">ndomain</a>; n++)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot;%20s type: %d  ndim: %d mdim: %d ndim2: %d\n&quot;</span>, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[n].name,</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;       <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[n].wind_type, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[n].<a class="code" href="import__cylindrical_8c.html#a0d9c8cbc461c7cf86cad8e548f195bd1">ndim</a>, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[n].<a class="code" href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a>, <a class="code" href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a>[n].ndim2);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">/* DFUDGE is a distance that assures we can &quot;push through&quot; boundaries.  setup_dfudge</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">     sets the push through distance depending on the size of the system. </span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <a class="code" href="python_8h.html#afda1ac6937e9d82232d5d99159e6485d">DFUDGE</a> = <a class="code" href="foo_8h.html#ab0e6804f11862cb19cf6ac6976480c3f">setup_dfudge</a> ();</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="comment">/* Now define the wind cones generically. modifies the global windcone structure */</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <a class="code" href="foo_8h.html#a404b09d110445816d66969489b854756">setup_windcone</a> ();</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="comment">/* initialize the random number generator */</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="comment">/* By default, the random number generator start with fixed seeds (differnt</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">    * for each processor, but this can be changed using a command line</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">    * switch.  </span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">    * An exception is when we are in zeus mode, where it would be inappropriate</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">    * to use the same phtons in ezch cycle.  There we initiate the seeds unsing</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">    * the clock</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a4da5e005fe696de0f87e747fa7fb302c">rand_seed_usetime</a> == 1)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;       n = (<span class="keywordtype">unsigned</span> int) clock () * (<a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a> + 1);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <a class="code" href="foo_8h.html#a6cc03550704557b5ad2967fc748a579d">init_rand</a>(n);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;     }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;     <a class="code" href="foo_8h.html#a6cc03550704557b5ad2967fc748a579d">init_rand</a>(1084515760 + (13 * <a class="code" href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a>));</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">/* Next line finally defines the wind if this is the initial time this model is being run */</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">run_type</a> == <a class="code" href="python_8h.html#a5775504a597057eb63ccda35871a3c16">RUN_TYPE_NEW</a>) <span class="comment">// Define the wind and allocate the arrays the first time</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <a class="code" href="foo_8h.html#a27671483c230bf332cc2286dbfa6c4be">define_wind</a> ();</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    </div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">zeus_connect</a> == 1)  <span class="comment">//We have restarted, but are in zeus connect mode, so we want to update density, temp and velocities</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="comment">/* Hydro takes the wind domain number as an argument in the current domains setup */</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <a class="code" href="foo_8h.html#a044bda6029c9b8057f77a920a61ce525">hydro_restart</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a9e4e74de249210566125f8254f468184">hydro_domain_number</a>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">/* this routine checks, somewhat crudely, if the grid is well enough resolved */</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <a class="code" href="foo_8h.html#a850c8c06e8a1481921582559b0bd2cf1">check_grid</a> ();</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  w = <a class="code" href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#af1e206518e9a1375ec7eaf46987027a3">extra_diagnostics</a>)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">/* Open a diagnostic file or files (with hardwired names) */</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <a class="code" href="diag_8c.html#ae56c24fbf634a302259671a903bcea7e">init_extra_diagnostics</a> ();</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  </div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">/* Start with photon history off */</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="python_8h.html#aeb3f8b12b43fd6aaa0cbdd0b815bd1f0">phot_hist_on</a> = 0;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">/* If required, read in a non-standard disk temperature profile */</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a6303d18fc24435a8be2822e1a98b8747">disk_tprofile</a> == 1)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <a class="code" href="disk_8c.html#ada5d5c91372291204ba0255184ce1f87">read_non_standard_disk_profile</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#ab591635bb4619345b1367b36cdd2cce6">tprofile</a>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">/* The next section sets up a structure qdisk to record the effects</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"> * of illumination on the disk.  disk_init is called primarily to get</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"> * a defined set of annular rings which are kept throughout the</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"> * ionization calculation.  A second structure qdisk is needed</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment"> * because in the process of generating photons in various bands</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"> * the annular rings are changed</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"> * disk_init calculates the flux from the disk in the energy range set by</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"> * freqmin and freqmax, and uses is this to identify the position of the</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"> * rings in the disk, so that each ring contributes the same amount to</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"> * the flux</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment"> * */</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <a class="code" href="foo_8h.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020">disk_init</a> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a7384383e4129a0341c5a1a27a68d7947">rstar</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a71b7a3a06fb5c18efba2b2642cb8e060">diskrad</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a0a526c9353a39b2f27f1edfdcb808384">mstar</a>, <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a45dca7da50031053e3afe2da3bd5aac7">disk_mdot</a>, freqmin,</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         freqmax, 0, &amp;<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a680f63b1b2306f462005771b7328c31d">f_disk</a>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <a class="code" href="disk_8c.html#a8c6a40a92905dcccfe3f17bb046182bc">qdisk_init</a> ();        <span class="comment">/* Initialize a disk qdisk to store the information about photons impinging on the disk */</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <a class="code" href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>, <span class="stringliteral">&quot;%-20s Finished initialization for %s\n&quot;</span>, <span class="stringliteral">&quot;NOK&quot;</span>,</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;       <a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <a class="code" href="foo_8h.html#aa067770b0286b11ebb3282166d941c85">check_time</a> (<a class="code" href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a>.<a class="code" href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">root</a>);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">/* XXXX - THE CALCULATION OF THE IONIZATION OF THE WIND */</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a1cdd3c658ff714b9504c7ada69ae1f0d">ioniz_or_extract</a> = 1; <span class="comment">//SS July 04 - want to compute MC estimators during ionization cycles</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">//1 simply implies we are in the ionization section of the code</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">//and allows routines to act accordinaly.</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">/* 67 -ksl- geo.wycle will start at zero unless we are completing an old run */</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">/* XXXX -  CALCULATE THE IONIZATION OF THE WIND */</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <a class="code" href="foo_8h.html#a28fc174aa63a5eeef6de99ef392e1616">calculate_ionization</a> (restart_stat);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">/* XXXX - END OF CYCLE TO CALCULATE THE IONIZATION OF THE WIND */</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <a class="code" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a> (<span class="stringliteral">&quot; Completed wind creation.  The elapsed TIME was %f\n&quot;</span>, <a class="code" href="foo_8h.html#a766e9400cf36e77e8d5dc4c5289735e2">timer</a> ());</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="comment">/* SWM - Evaluate wind paths for last iteration */</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">reverb</a> == REV_WIND || <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">reverb</a> == REV_MATOM)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {               <span class="comment">//If this is a mode in which we keep wind arrays, update them</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <a class="code" href="foo_8h.html#a210e77beda2c9c25b9008de9107a17f8">wind_paths_evaluate</a> (w, my_rank);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">/* XXXX - THE CALCULATION OF A DETAILED SPECTRUM IN A SPECIFIC REGION OF WAVELENGTH SPACE */</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  freqmax = <a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> / (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#abc10c324e776f2bf8c809096402ecb75">swavemin</a> * 1.e-8);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  freqmin = <a class="code" href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a> / (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a140530983e750dba228f9cd27d12000f">swavemax</a> * 1.e-8);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">/* Perform the initilizations required to handle macro-atoms during the detailed</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">     calculation of the spectrum.  </span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">     Next lines turns off macro atom estimators and other portions of the code that are</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">     unnecessary during spectrum cycles.  */</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a1cdd3c658ff714b9504c7ada69ae1f0d">ioniz_or_extract</a> = 0;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">/* Next step speeds up extraction stage */</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a>.<a class="code" href="structadvanced__modes.html#a067fe29b52bdeb7a6f9efa1019e418f1">keep_photoabs</a>)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <a class="code" href="python_8h.html#a269192868359259c3fb4fad8d9f7b669">DENSITY_PHOT_MIN</a> = -1.0;  <span class="comment">// Do not calculated photoabsorption in detailed spectrum </span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">/*Switch on k-packet/macro atom emissivities  SS June 04 */</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">rt_mode</a> == <a class="code" href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a>)</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a>.<a class="code" href="structgeometry.html#a4b97dc16b54fd49d53a06ff8896596a6">matom_radiation</a> = 1;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    }</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">/* Finished initializations required for macro-atom approach */</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">/* Calculate and store which bf processess need to be considered in each cell</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">   * Note that this is not macro-specific but is just to speed the program up.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <a class="code" href="foo_8h.html#a7d7a0bd03f273ab50a2eabadb685b585">kbf_need</a> (freqmin, freqmax);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="comment">/* XXXX - Execute  CYCLES TO CREATE THE DETAILED SPECTRUM */</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <a class="code" href="foo_8h.html#abc2ad803345c801984f4dc64d4d4a9e0">make_spectra</a> (restart_stat);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;}</div><div class="ttc" id="structgeometry_html_a853e273c5a2a6630c2c1c609db0f47a1"><div class="ttname"><a href="structgeometry.html#a853e273c5a2a6630c2c1c609db0f47a1">geometry::reverb</a></div><div class="ttdeci">enum geometry::reverb_enum reverb</div></div>
<div class="ttc" id="structfilenames_html_a12010879e17a410582c95418e70fb8f4"><div class="ttname"><a href="structfilenames.html#a12010879e17a410582c95418e70fb8f4">filenames::specsave</a></div><div class="ttdeci">char specsave[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01374">python.h:1374</a></div></div>
<div class="ttc" id="python_8h_html_afda1ac6937e9d82232d5d99159e6485d"><div class="ttname"><a href="python_8h.html#afda1ac6937e9d82232d5d99159e6485d">DFUDGE</a></div><div class="ttdeci">double DFUDGE</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00045">python.h:45</a></div></div>
<div class="ttc" id="structgeometry_html_a38ee7d8d2a6a863cd437dcafc58ebc10"><div class="ttname"><a href="structgeometry.html#a38ee7d8d2a6a863cd437dcafc58ebc10">geometry::star_spectype</a></div><div class="ttdeci">int star_spectype</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00483">python.h:483</a></div></div>
<div class="ttc" id="foo_8h_html_a5e18aeda5d11190333c93b952b562b04"><div class="ttname"><a href="foo_8h.html#a5e18aeda5d11190333c93b952b562b04">get_stellar_params</a></div><div class="ttdeci">double get_stellar_params(void)</div><div class="ttdoc">sets rstar, mstar, tstar as well as secondary parameters based on user inputs </div><div class="ttdef"><b>Definition:</b> <a href="setup__star__bh_8c_source.html#l00044">setup_star_bh.c:44</a></div></div>
<div class="ttc" id="foo_8h_html_a210e77beda2c9c25b9008de9107a17f8"><div class="ttname"><a href="foo_8h.html#a210e77beda2c9c25b9008de9107a17f8">wind_paths_evaluate</a></div><div class="ttdeci">int wind_paths_evaluate(WindPtr wind, int i_rank)</div><div class="ttdoc">Evaluates wind path details for a cycle. </div><div class="ttdef"><b>Definition:</b> <a href="paths_8c_source.html#l00533">paths.c:533</a></div></div>
<div class="ttc" id="foo_8h_html_a850c8c06e8a1481921582559b0bd2cf1"><div class="ttname"><a href="foo_8h.html#a850c8c06e8a1481921582559b0bd2cf1">check_grid</a></div><div class="ttdeci">int check_grid(void)</div><div class="ttdoc">check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might ...</div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l01313">wind2d.c:1313</a></div></div>
<div class="ttc" id="python_8h_html_a08859148ab82ac4d52232b19653dd399"><div class="ttname"><a href="python_8h.html#a08859148ab82ac4d52232b19653dd399">DISK_TPROFILE_STANDARD</a></div><div class="ttdeci">#define DISK_TPROFILE_STANDARD</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00387">python.h:387</a></div></div>
<div class="ttc" id="structgeometry_html_a3c382f0f9c6d402381b6faeb5b4f216f"><div class="ttname"><a href="structgeometry.html#a3c382f0f9c6d402381b6faeb5b4f216f">geometry::disk_radiation</a></div><div class="ttdeci">int disk_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00400">python.h:400</a></div></div>
<div class="ttc" id="structfilenames_html_ad69a4b6cb667c701b42275495c4cd002"><div class="ttname"><a href="structfilenames.html#ad69a4b6cb667c701b42275495c4cd002">filenames::input</a></div><div class="ttdeci">char input[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01377">python.h:1377</a></div></div>
<div class="ttc" id="structphoton_html_a5fa87a07a9ceef33dd79aa5cdd7856cb"><div class="ttname"><a href="structphoton.html#a5fa87a07a9ceef33dd79aa5cdd7856cb">photon::w</a></div><div class="ttdeci">double w</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01039">python.h:1039</a></div></div>
<div class="ttc" id="structgeometry_html_a680f63b1b2306f462005771b7328c31d"><div class="ttname"><a href="structgeometry.html#a680f63b1b2306f462005771b7328c31d">geometry::f_disk</a></div><div class="ttdeci">double f_disk</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00526">python.h:526</a></div></div>
<div class="ttc" id="structadvanced__modes_html_a9a1d48d878cdb6a4ef9c0f08f3f42f12"><div class="ttname"><a href="structadvanced__modes.html#a9a1d48d878cdb6a4ef9c0f08f3f42f12">advanced_modes::zeus_connect</a></div><div class="ttdeci">int zeus_connect</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01358">python.h:1358</a></div></div>
<div class="ttc" id="python_8h_html_aec4250ef7545b2393f4f3e07d63f28f6"><div class="ttname"><a href="python_8h.html#aec4250ef7545b2393f4f3e07d63f28f6">DISK_NONE</a></div><div class="ttdeci">#define DISK_NONE</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00371">python.h:371</a></div></div>
<div class="ttc" id="log_8h_html_a9a25be4f0d7d13fccc8457774d74167f"><div class="ttname"><a href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f">Log</a></div><div class="ttdeci">int Log(char *format,...)</div><div class="ttdoc">Print/write an informational message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00325">xlog.c:325</a></div></div>
<div class="ttc" id="python_8h_html_a9bc1d8131e46b327abd573ff73547834"><div class="ttname"><a href="python_8h.html#a9bc1d8131e46b327abd573ff73547834">RUN_TYPE_PREVIOUS</a></div><div class="ttdeci">#define RUN_TYPE_PREVIOUS</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00300">python.h:300</a></div></div>
<div class="ttc" id="version_8h_html_a1c6d5de492ac61ad29aec7aa9a436bbf"><div class="ttname"><a href="version_8h.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a></div><div class="ttdeci">#define VERSION</div><div class="ttdef"><b>Definition:</b> <a href="version_8h_source.html#l00001">version.h:1</a></div></div>
<div class="ttc" id="foo_8h_html_a53d75807008c96f7053e25e029ed8a95"><div class="ttname"><a href="foo_8h.html#a53d75807008c96f7053e25e029ed8a95">set_max_time</a></div><div class="ttdeci">int set_max_time(char *root, double t)</div><div class="ttdoc">Set the maximum time the program should run. </div><div class="ttdef"><b>Definition:</b> <a href="signal_8c_source.html#l00223">signal.c:223</a></div></div>
<div class="ttc" id="diag_8c_html_acb7ea92897c7bc8fa09f98078babcc01"><div class="ttname"><a href="diag_8c.html#acb7ea92897c7bc8fa09f98078babcc01">get_standard_care_factors</a></div><div class="ttdeci">int get_standard_care_factors()</div><div class="ttdoc">get inputs that provides more control over how the program is run </div><div class="ttdef"><b>Definition:</b> <a href="diag_8c_source.html#l00110">diag.c:110</a></div></div>
<div class="ttc" id="python_8h_html_a4d5c68b263c929465c5ce25903ab1773"><div class="ttname"><a href="python_8h.html#a4d5c68b263c929465c5ce25903ab1773">RT_MODE_MACRO</a></div><div class="ttdeci">#define RT_MODE_MACRO</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00456">python.h:456</a></div></div>
<div class="ttc" id="structgeometry_html_af1df42c04bb7980f13bbb390f7fbb222"><div class="ttname"><a href="structgeometry.html#af1df42c04bb7980f13bbb390f7fbb222">geometry::pcycles</a></div><div class="ttdeci">int pcycles</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00337">python.h:337</a></div></div>
<div class="ttc" id="foo_8h_html_a3eba280b12bdc0cafaf8a7fbe33a887a"><div class="ttname"><a href="foo_8h.html#a3eba280b12bdc0cafaf8a7fbe33a887a">init_photons</a></div><div class="ttdeci">PhotPtr init_photons(void)</div><div class="ttdoc">gets information about the number of cycles and how many photons there should be per cycle...</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00501">setup.c:501</a></div></div>
<div class="ttc" id="foo_8h_html_abaf08b81d739ed75e14ee5932317af2d"><div class="ttname"><a href="foo_8h.html#abaf08b81d739ed75e14ee5932317af2d">spec_read</a></div><div class="ttdeci">int spec_read(char filename[])</div></div>
<div class="ttc" id="foo_8h_html_ab1f63fcb955cb5c77dcb2d35b5da2cd4"><div class="ttname"><a href="foo_8h.html#ab1f63fcb955cb5c77dcb2d35b5da2cd4">xsignal</a></div><div class="ttdeci">int xsignal(char *root, char *format,...)</div><div class="ttdoc">xsignal generates a single line message to a file names root.sig </div><div class="ttdef"><b>Definition:</b> <a href="signal_8c_source.html#l00078">signal.c:78</a></div></div>
<div class="ttc" id="structgeometry_html_ad8186bf06722e4d1fda29b9162374596"><div class="ttname"><a href="structgeometry.html#ad8186bf06722e4d1fda29b9162374596">geometry::bl_spectype</a></div><div class="ttdeci">int bl_spectype</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00486">python.h:486</a></div></div>
<div class="ttc" id="foo_8h_html_a3c3ee1b7657b6c1bc4e6c1e6d8300020"><div class="ttname"><a href="foo_8h.html#a3c3ee1b7657b6c1bc4e6c1e6d8300020">disk_init</a></div><div class="ttdeci">double disk_init(double rmin, double rmax, double m, double mdot, double freqmin, double freqmax, int ioniz_or_final, double *ftot)</div><div class="ttdoc">calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk...</div><div class="ttdef"><b>Definition:</b> <a href="photon__gen_8c_source.html#l00842">photon_gen.c:842</a></div></div>
<div class="ttc" id="structgeometry_html_ab8605990f1d7f0862abaf18f1c701045"><div class="ttname"><a href="structgeometry.html#ab8605990f1d7f0862abaf18f1c701045">geometry::select_extract</a></div><div class="ttdeci">int select_extract</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00349">python.h:349</a></div></div>
<div class="ttc" id="structadvanced__modes_html_a77fab35698c16498dee21a41813c9811"><div class="ttname"><a href="structadvanced__modes.html#a77fab35698c16498dee21a41813c9811">advanced_modes::quit_after_inputs</a></div><div class="ttdeci">int quit_after_inputs</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01356">python.h:1356</a></div></div>
<div class="ttc" id="structgeometry_html_a03d95e2ef842e21fb07e2076ab560c98"><div class="ttname"><a href="structgeometry.html#a03d95e2ef842e21fb07e2076ab560c98">geometry::disk_spectype</a></div><div class="ttdeci">int disk_spectype</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00485">python.h:485</a></div></div>
<div class="ttc" id="foo_8h_html_a3995f2a6ba379027804653e28e4feac1"><div class="ttname"><a href="foo_8h.html#a3995f2a6ba379027804653e28e4feac1">init_log_and_windsave</a></div><div class="ttdeci">int init_log_and_windsave(int restart_stat)</div><div class="ttdoc">init_files </div><div class="ttdef"><b>Definition:</b> <a href="setup__files_8c_source.html#l00052">setup_files.c:52</a></div></div>
<div class="ttc" id="foo_8h_html_a839f7eaa23de10001c2ec293dc890563"><div class="ttname"><a href="foo_8h.html#a839f7eaa23de10001c2ec293dc890563">get_hydro</a></div><div class="ttdeci">int get_hydro(int ndom)</div><div class="ttdoc">Reads in and decodes a hydro-dynamic model. </div><div class="ttdef"><b>Definition:</b> <a href="hydro__import_8c_source.html#l00218">hydro_import.c:218</a></div></div>
<div class="ttc" id="foo_8h_html_ac88fda6c445f7e99eb1238b8132576ad"><div class="ttname"><a href="foo_8h.html#ac88fda6c445f7e99eb1238b8132576ad">setup_created_files</a></div><div class="ttdeci">int setup_created_files(void)</div><div class="ttdoc">Use the root name of the .pf file to create names for the various output files written by Python...</div><div class="ttdef"><b>Definition:</b> <a href="setup__files_8c_source.html#l00120">setup_files.c:120</a></div></div>
<div class="ttc" id="python_8h_html_a5775504a597057eb63ccda35871a3c16"><div class="ttname"><a href="python_8h.html#a5775504a597057eb63ccda35871a3c16">RUN_TYPE_NEW</a></div><div class="ttdeci">#define RUN_TYPE_NEW</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00298">python.h:298</a></div></div>
<div class="ttc" id="structadvanced__modes_html_af01ce2e0a78e9f6f5bf1ef516626996f"><div class="ttname"><a href="structadvanced__modes.html#af01ce2e0a78e9f6f5bf1ef516626996f">advanced_modes::iadvanced</a></div><div class="ttdeci">int iadvanced</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01343">python.h:1343</a></div></div>
<div class="ttc" id="import__cylindrical_8c_html_a4fdcb279e1e2a2ff83edb434cbbbf34a"><div class="ttname"><a href="import__cylindrical_8c.html#a4fdcb279e1e2a2ff83edb434cbbbf34a">mdim</a></div><div class="ttdeci">int mdim</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00030">import_cylindrical.c:30</a></div></div>
<div class="ttc" id="foo_8h_html_a28fc174aa63a5eeef6de99ef392e1616"><div class="ttname"><a href="foo_8h.html#a28fc174aa63a5eeef6de99ef392e1616">calculate_ionization</a></div><div class="ttdeci">int calculate_ionization(int restart_stat)</div><div class="ttdoc">run the ionization cycles for a python model </div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00052">run.c:52</a></div></div>
<div class="ttc" id="log_8h_html_a6568a4df00f76870b9e36f94c573a4ad"><div class="ttname"><a href="log_8h.html#a6568a4df00f76870b9e36f94c573a4ad">Log_set_verbosity</a></div><div class="ttdeci">int Log_set_verbosity(int vlevel)</div><div class="ttdoc">Control the range of messages which are logged to the command line. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00245">xlog.c:245</a></div></div>
<div class="ttc" id="python_8h_html_a4f0e3bc930f46505989f47a576f3ae3b"><div class="ttname"><a href="python_8h.html#a4f0e3bc930f46505989f47a576f3ae3b">xband</a></div><div class="ttdeci">struct xbands xband</div></div>
<div class="ttc" id="structfilenames_html_ab591635bb4619345b1367b36cdd2cce6"><div class="ttname"><a href="structfilenames.html#ab591635bb4619345b1367b36cdd2cce6">filenames::tprofile</a></div><div class="ttdeci">char tprofile[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01388">python.h:1388</a></div></div>
<div class="ttc" id="python_8h_html_ac5be720a47277d650c31cee6ee815026"><div class="ttname"><a href="python_8h.html#ac5be720a47277d650c31cee6ee815026">files</a></div><div class="ttdeci">struct filenames files</div></div>
<div class="ttc" id="structdomain_html"><div class="ttname"><a href="structdomain.html">domain</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00200">python.h:200</a></div></div>
<div class="ttc" id="structgeometry_html_a9e4e74de249210566125f8254f468184"><div class="ttname"><a href="structgeometry.html#a9e4e74de249210566125f8254f468184">geometry::hydro_domain_number</a></div><div class="ttdeci">int hydro_domain_number</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00330">python.h:330</a></div></div>
<div class="ttc" id="structwind_html"><div class="ttname"><a href="structwind.html">wind</a></div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00692">python.h:692</a></div></div>
<div class="ttc" id="python_8h_html_a33f8696ebd56cd4158a5b519ec627fc5"><div class="ttname"><a href="python_8h.html#a33f8696ebd56cd4158a5b519ec627fc5">modes</a></div><div class="ttdeci">struct advanced_modes modes</div></div>
<div class="ttc" id="structgeometry_html_a781ad48d18a8d675b84414f1ba7a352d"><div class="ttname"><a href="structgeometry.html#a781ad48d18a8d675b84414f1ba7a352d">geometry::ndomain</a></div><div class="ttdeci">int ndomain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00312">python.h:312</a></div></div>
<div class="ttc" id="foo_8h_html_ad72f5c977c7a79152243ba8ba509cccc"><div class="ttname"><a href="foo_8h.html#ad72f5c977c7a79152243ba8ba509cccc">wind_read</a></div><div class="ttdeci">int wind_read(char filename[])</div></div>
<div class="ttc" id="foo_8h_html_a156f40c5dd5b2c76f1002d05f712b0a0"><div class="ttname"><a href="foo_8h.html#a156f40c5dd5b2c76f1002d05f712b0a0">get_wind_params</a></div><div class="ttdeci">int get_wind_params(int ndom)</div><div class="ttdoc">Get detailed particular component of the wind. </div><div class="ttdef"><b>Definition:</b> <a href="setup__domains_8c_source.html#l00179">setup_domains.c:179</a></div></div>
<div class="ttc" id="foo_8h_html_a766e9400cf36e77e8d5dc4c5289735e2"><div class="ttname"><a href="foo_8h.html#a766e9400cf36e77e8d5dc4c5289735e2">timer</a></div><div class="ttdeci">double timer(void)</div><div class="ttdoc">Return the time in seconds since the timer was initiated. </div><div class="ttdef"><b>Definition:</b> <a href="time_8c_source.html#l00047">time.c:47</a></div></div>
<div class="ttc" id="foo_8h_html_af355cb7acb867d8ada078fe8ced97f2f"><div class="ttname"><a href="foo_8h.html#af355cb7acb867d8ada078fe8ced97f2f">get_domain_params</a></div><div class="ttdeci">int get_domain_params(int ndom)</div><div class="ttdoc">Get inputs that describe a particular component of the wind. </div><div class="ttdef"><b>Definition:</b> <a href="setup__domains_8c_source.html#l00047">setup_domains.c:47</a></div></div>
<div class="ttc" id="structadvanced__modes_html_a067fe29b52bdeb7a6f9efa1019e418f1"><div class="ttname"><a href="structadvanced__modes.html#a067fe29b52bdeb7a6f9efa1019e418f1">advanced_modes::keep_photoabs</a></div><div class="ttdeci">int keep_photoabs</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01355">python.h:1355</a></div></div>
<div class="ttc" id="python_8h_html_aeb3f8b12b43fd6aaa0cbdd0b815bd1f0"><div class="ttname"><a href="python_8h.html#aeb3f8b12b43fd6aaa0cbdd0b815bd1f0">phot_hist_on</a></div><div class="ttdeci">int phot_hist_on</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01103">python.h:1103</a></div></div>
<div class="ttc" id="foo_8h_html_abc2ad803345c801984f4dc64d4d4a9e0"><div class="ttname"><a href="foo_8h.html#abc2ad803345c801984f4dc64d4d4a9e0">make_spectra</a></div><div class="ttdeci">int make_spectra(int restart_stat)</div><div class="ttdoc">generates the detailed spectra </div><div class="ttdef"><b>Definition:</b> <a href="run_8c_source.html#l00368">run.c:368</a></div></div>
<div class="ttc" id="log_8h_html_a655c6e64b9d44a15b3331e49b6f168f9"><div class="ttname"><a href="log_8h.html#a655c6e64b9d44a15b3331e49b6f168f9">Log_parallel</a></div><div class="ttdeci">int Log_parallel(char *format,...)</div><div class="ttdoc">In addition to writing to the diag file, print a message to the screen from all threads. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00728">xlog.c:728</a></div></div>
<div class="ttc" id="foo_8h_html_a897e0ae97c32a481075df9fc45f6e745"><div class="ttname"><a href="foo_8h.html#a897e0ae97c32a481075df9fc45f6e745">get_bl_and_agn_params</a></div><div class="ttdeci">int get_bl_and_agn_params(double lstar)</div><div class="ttdoc">sets up the boundary layer and agn power law parameters based on user input and system type ...</div><div class="ttdef"><b>Definition:</b> <a href="setup__star__bh_8c_source.html#l00145">setup_star_bh.c:145</a></div></div>
<div class="ttc" id="structxbands_html_af398da6fd226bb4257ad64ac9704098a"><div class="ttname"><a href="structxbands.html#af398da6fd226bb4257ad64ac9704098a">xbands::f2</a></div><div class="ttdeci">double f2[NBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01264">python.h:1264</a></div></div>
<div class="ttc" id="python_8h_html_a3a571e0bd4220490c5c5bd86f51c83ba"><div class="ttname"><a href="python_8h.html#a3a571e0bd4220490c5c5bd86f51c83ba">geo</a></div><div class="ttdeci">struct geometry geo</div></div>
<div class="ttc" id="structgeometry_html_aa1d0031436952c2a2fdc2506c137b3d8"><div class="ttname"><a href="structgeometry.html#aa1d0031436952c2a2fdc2506c137b3d8">geometry::system_type</a></div><div class="ttdeci">int system_type</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00309">python.h:309</a></div></div>
<div class="ttc" id="python_8h_html_ae022cd774d7ee369fc758eff33990847"><div class="ttname"><a href="python_8h.html#ae022cd774d7ee369fc758eff33990847">DomainPtr</a></div><div class="ttdeci">struct domain * DomainPtr</div></div>
<div class="ttc" id="log_8h_html_a3a649b0453ce83dbb1b16de81e08f5af"><div class="ttname"><a href="log_8h.html#a3a649b0453ce83dbb1b16de81e08f5af">rdint</a></div><div class="ttdeci">int rdint(char question[], int *answer)</div></div>
<div class="ttc" id="log_8h_html_ae97b0cce071056f882a059ef092f2c40"><div class="ttname"><a href="log_8h.html#ae97b0cce071056f882a059ef092f2c40">rdpar_comment</a></div><div class="ttdeci">int rdpar_comment(char *format,...)</div><div class="ttdoc">Add a comment to the header of the output file. </div><div class="ttdef"><b>Definition:</b> <a href="rdpar_8c_source.html#l00773">rdpar.c:773</a></div></div>
<div class="ttc" id="structgeometry_html_a6303d18fc24435a8be2822e1a98b8747"><div class="ttname"><a href="structgeometry.html#a6303d18fc24435a8be2822e1a98b8747">geometry::disk_tprofile</a></div><div class="ttdeci">int disk_tprofile</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00390">python.h:390</a></div></div>
<div class="ttc" id="structgeometry_html_a5c5643e70e2f927fac6f1ff6e9ecb489"><div class="ttname"><a href="structgeometry.html#a5c5643e70e2f927fac6f1ff6e9ecb489">geometry::pcycle</a></div><div class="ttdeci">int pcycle</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00336">python.h:336</a></div></div>
<div class="ttc" id="xlog_8c_html_a36683b6f0eb124ab5a7c462b3f3ca1cc"><div class="ttname"><a href="xlog_8c.html#a36683b6f0eb124ab5a7c462b3f3ca1cc">my_rank</a></div><div class="ttdeci">int my_rank</div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00098">xlog.c:98</a></div></div>
<div class="ttc" id="foo_8h_html_a404b09d110445816d66969489b854756"><div class="ttname"><a href="foo_8h.html#a404b09d110445816d66969489b854756">setup_windcone</a></div><div class="ttdeci">int setup_windcone(void)</div><div class="ttdoc">sets up the windcones for each domain </div><div class="ttdef"><b>Definition:</b> <a href="setup__domains_8c_source.html#l00463">setup_domains.c:463</a></div></div>
<div class="ttc" id="foo_8h_html_a4017af15d8bd072936049dafc4250a1b"><div class="ttname"><a href="foo_8h.html#a4017af15d8bd072936049dafc4250a1b">get_meta_params</a></div><div class="ttdeci">int get_meta_params(void)</div><div class="ttdoc">Gets parameters from input file for reverb and visualisation settings. </div><div class="ttdef"><b>Definition:</b> <a href="setup__reverb_8c_source.html#l00080">setup_reverb.c:80</a></div></div>
<div class="ttc" id="structgeometry_html_a0a526c9353a39b2f27f1edfdcb808384"><div class="ttname"><a href="structgeometry.html#a0a526c9353a39b2f27f1edfdcb808384">geometry::mstar</a></div><div class="ttdeci">double mstar</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00362">python.h:362</a></div></div>
<div class="ttc" id="structgeometry_html_a384632d687a144af30856d0c8d96f01c"><div class="ttname"><a href="structgeometry.html#a384632d687a144af30856d0c8d96f01c">geometry::select_spectype</a></div><div class="ttdeci">int select_spectype</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00349">python.h:349</a></div></div>
<div class="ttc" id="foo_8h_html_a611c7cc190ffb8c6494e75ec549191f3"><div class="ttname"><a href="foo_8h.html#a611c7cc190ffb8c6494e75ec549191f3">get_disk_params</a></div><div class="ttdeci">double get_disk_params(void)</div><div class="ttdoc">get the parameters need to define a disk </div><div class="ttdef"><b>Definition:</b> <a href="setup__disk_8c_source.html#l00065">setup_disk.c:65</a></div></div>
<div class="ttc" id="structfilenames_html_a8c053bab321640d4f0f5b75110980c89"><div class="ttname"><a href="structfilenames.html#a8c053bab321640d4f0f5b75110980c89">filenames::root</a></div><div class="ttdeci">char root[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01371">python.h:1371</a></div></div>
<div class="ttc" id="structgeometry_html_a1f8e0859717e5e41ed53be2e222b9e2b"><div class="ttname"><a href="structgeometry.html#a1f8e0859717e5e41ed53be2e222b9e2b">geometry::t_bl</a></div><div class="ttdeci">double t_bl</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00549">python.h:549</a></div></div>
<div class="ttc" id="structgeometry_html_aa2ea17f8b23e8e3785c3685c9261a8bf"><div class="ttname"><a href="structgeometry.html#aa2ea17f8b23e8e3785c3685c9261a8bf">geometry::lum_bl</a></div><div class="ttdeci">double lum_bl</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00504">python.h:504</a></div></div>
<div class="ttc" id="foo_8h_html_ab0e6804f11862cb19cf6ac6976480c3f"><div class="ttname"><a href="foo_8h.html#ab0e6804f11862cb19cf6ac6976480c3f">setup_dfudge</a></div><div class="ttdeci">double setup_dfudge(void)</div><div class="ttdoc">Sets a global &quot;push_through_distance&quot; designed to prevent photons from being trapped at boundaries...</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00703">setup.c:703</a></div></div>
<div class="ttc" id="structgeometry_html_a45dca7da50031053e3afe2da3bd5aac7"><div class="ttname"><a href="structgeometry.html#a45dca7da50031053e3afe2da3bd5aac7">geometry::disk_mdot</a></div><div class="ttdeci">double disk_mdot</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00392">python.h:392</a></div></div>
<div class="ttc" id="python_8h_html_a58b428706c49233f4580ed387c4820c6"><div class="ttname"><a href="python_8h.html#a58b428706c49233f4580ed387c4820c6">np_mpi_global</a></div><div class="ttdeci">int np_mpi_global</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00007">python.h:7</a></div></div>
<div class="ttc" id="python_8h_html"><div class="ttname"><a href="python_8h.html">python.h</a></div></div>
<div class="ttc" id="diag_8c_html_ab28b32b3a1f983da958d2a6a8a0554fc"><div class="ttname"><a href="diag_8c.html#ab28b32b3a1f983da958d2a6a8a0554fc">get_extra_diagnostics</a></div><div class="ttdeci">int get_extra_diagnostics()</div><div class="ttdoc">Allows the user to specify what extra diagnositcs to write out. </div><div class="ttdef"><b>Definition:</b> <a href="diag_8c_source.html#l00158">diag.c:158</a></div></div>
<div class="ttc" id="diag_8c_html_ae56c24fbf634a302259671a903bcea7e"><div class="ttname"><a href="diag_8c.html#ae56c24fbf634a302259671a903bcea7e">init_extra_diagnostics</a></div><div class="ttdeci">int init_extra_diagnostics()</div><div class="ttdoc">opon a file for writing out extra diagnostics. In some cases reads a file that specifies in which cel...</div><div class="ttdef"><b>Definition:</b> <a href="diag_8c_source.html#l00225">diag.c:225</a></div></div>
<div class="ttc" id="python_8h_html_a48632b55b333d2627f6a1ddd87b3d7ea"><div class="ttname"><a href="python_8h.html#a48632b55b333d2627f6a1ddd87b3d7ea">rank_global</a></div><div class="ttdeci">int rank_global</div><div class="ttdoc">Global variable which holds the number of MPI processes. </div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00009">python.h:9</a></div></div>
<div class="ttc" id="foo_8h_html_a6cc03550704557b5ad2967fc748a579d"><div class="ttname"><a href="foo_8h.html#a6cc03550704557b5ad2967fc748a579d">init_rand</a></div><div class="ttdeci">int init_rand(int seed)</div><div class="ttdoc">Sets up a random number generator. </div><div class="ttdef"><b>Definition:</b> <a href="random_8c_source.html#l00260">random.c:260</a></div></div>
<div class="ttc" id="structgeometry_html_aff6d34b209264b154fa7bd36266f70de"><div class="ttname"><a href="structgeometry.html#aff6d34b209264b154fa7bd36266f70de">geometry::wind_radiation</a></div><div class="ttdeci">int wind_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00401">python.h:401</a></div></div>
<div class="ttc" id="structgeometry_html_a7384383e4129a0341c5a1a27a68d7947"><div class="ttname"><a href="structgeometry.html#a7384383e4129a0341c5a1a27a68d7947">geometry::rstar</a></div><div class="ttdeci">double rstar</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00362">python.h:362</a></div></div>
<div class="ttc" id="log_8h_html_a84a2c7bd396934f47298859d6019ba8f"><div class="ttname"><a href="log_8h.html#a84a2c7bd396934f47298859d6019ba8f">rdstr</a></div><div class="ttdeci">int rdstr(char question[], char answer[])</div></div>
<div class="ttc" id="structgeometry_html_ab344978ef2535435535587ec5d5a3d6e"><div class="ttname"><a href="structgeometry.html#ab344978ef2535435535587ec5d5a3d6e">geometry::wcycle</a></div><div class="ttdeci">int wcycle</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00336">python.h:336</a></div></div>
<div class="ttc" id="structgeometry_html_af4e6a2e8c84eebc16bd93c17899c124f"><div class="ttname"><a href="structgeometry.html#af4e6a2e8c84eebc16bd93c17899c124f">geometry::agn_spectype</a></div><div class="ttdeci">int agn_spectype</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00487">python.h:487</a></div></div>
<div class="ttc" id="log_8h_html_afa6d193a6665f1ee917420a371ae133d"><div class="ttname"><a href="log_8h.html#afa6d193a6665f1ee917420a371ae133d">cpar</a></div><div class="ttdeci">int cpar(char filename[])</div></div>
<div class="ttc" id="import__cylindrical_8c_html_a0d9c8cbc461c7cf86cad8e548f195bd1"><div class="ttname"><a href="import__cylindrical_8c.html#a0d9c8cbc461c7cf86cad8e548f195bd1">ndim</a></div><div class="ttdeci">int ndim</div><div class="ttdef"><b>Definition:</b> <a href="import__cylindrical_8c_source.html#l00030">import_cylindrical.c:30</a></div></div>
<div class="ttc" id="log_8h_html_a4f4caa375f1c3a9def422000f305cce5"><div class="ttname"><a href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5">Error</a></div><div class="ttdeci">int Error(char *format,...)</div><div class="ttdoc">Print/write out an error message. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00402">xlog.c:402</a></div></div>
<div class="ttc" id="atomic_8h_html"><div class="ttname"><a href="atomic_8h.html">atomic.h</a></div></div>
<div class="ttc" id="python_8h_html_a96118defc18eccb296450a8b9c474027"><div class="ttname"><a href="python_8h.html#a96118defc18eccb296450a8b9c474027">SYSTEM_TYPE_PREVIOUS</a></div><div class="ttdeci">#define SYSTEM_TYPE_PREVIOUS</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00290">python.h:290</a></div></div>
<div class="ttc" id="structgeometry_html_a1cdd3c658ff714b9504c7ada69ae1f0d"><div class="ttname"><a href="structgeometry.html#a1cdd3c658ff714b9504c7ada69ae1f0d">geometry::ioniz_or_extract</a></div><div class="ttdeci">int ioniz_or_extract</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00419">python.h:419</a></div></div>
<div class="ttc" id="foo_8h_html_afc4ebd7d545f29d6e3a9505cf462c62c"><div class="ttname"><a href="foo_8h.html#afc4ebd7d545f29d6e3a9505cf462c62c">init_observers</a></div><div class="ttdeci">int init_observers(void)</div><div class="ttdoc">get inputs that describe the detailed spectra that one intends to extract. </div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00334">setup.c:334</a></div></div>
<div class="ttc" id="structgeometry_html_a17efc849b549c82a01393a50b62315a6"><div class="ttname"><a href="structgeometry.html#a17efc849b549c82a01393a50b62315a6">geometry::disk_type</a></div><div class="ttdeci">int disk_type</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00375">python.h:375</a></div></div>
<div class="ttc" id="structgeometry_html_af65bb6689e1945e975f6787825d2c5b8"><div class="ttname"><a href="structgeometry.html#af65bb6689e1945e975f6787825d2c5b8">geometry::run_type</a></div><div class="ttdeci">int run_type</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00396">python.h:396</a></div></div>
<div class="ttc" id="python_8h_html_a269192868359259c3fb4fad8d9f7b669"><div class="ttname"><a href="python_8h.html#a269192868359259c3fb4fad8d9f7b669">DENSITY_PHOT_MIN</a></div><div class="ttdeci">double DENSITY_PHOT_MIN</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00061">python.h:61</a></div></div>
<div class="ttc" id="disk_8c_html_ada5d5c91372291204ba0255184ce1f87"><div class="ttname"><a href="disk_8c.html#ada5d5c91372291204ba0255184ce1f87">read_non_standard_disk_profile</a></div><div class="ttdeci">int read_non_standard_disk_profile(char *tprofile)</div><div class="ttdoc">Read the temperature profile from a file. </div><div class="ttdef"><b>Definition:</b> <a href="disk_8c_source.html#l00795">disk.c:795</a></div></div>
<div class="ttc" id="python_8h_html_a6941aa4454202b7692e5555b66badd42"><div class="ttname"><a href="python_8h.html#a6941aa4454202b7692e5555b66badd42">RUN_TYPE_RESTART</a></div><div class="ttdeci">#define RUN_TYPE_RESTART</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00299">python.h:299</a></div></div>
<div class="ttc" id="python_8h_html_a6e3bf2cbb457970f2ae23c746e8f8ea5"><div class="ttname"><a href="python_8h.html#a6e3bf2cbb457970f2ae23c746e8f8ea5">zdom</a></div><div class="ttdeci">DomainPtr zdom</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00275">python.h:275</a></div></div>
<div class="ttc" id="foo_8h_html_aa067770b0286b11ebb3282166d941c85"><div class="ttname"><a href="foo_8h.html#aa067770b0286b11ebb3282166d941c85">check_time</a></div><div class="ttdeci">int check_time(char *root)</div><div class="ttdoc">check whether the elapsed time is greater than the max_time and terminate the program if that is the ...</div><div class="ttdef"><b>Definition:</b> <a href="signal_8c_source.html#l00261">signal.c:261</a></div></div>
<div class="ttc" id="python_8h_html_a1bdcfae3209cbd96db35a2ae356fa15e"><div class="ttname"><a href="python_8h.html#a1bdcfae3209cbd96db35a2ae356fa15e">verbosity</a></div><div class="ttdeci">int verbosity</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00013">python.h:13</a></div></div>
<div class="ttc" id="atomic_8h_html_ac4cf4b2ab929bd23951a8676eeac086b"><div class="ttname"><a href="atomic_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a></div><div class="ttdeci">#define C</div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00011">atomic.h:11</a></div></div>
<div class="ttc" id="foo_8h_html_ab358cbada062a9acccdf184b57630305"><div class="ttname"><a href="foo_8h.html#ab358cbada062a9acccdf184b57630305">get_spectype</a></div><div class="ttdeci">int get_spectype(int yesno, char *question, int *spectype)</div><div class="ttdoc">Generalized routine to get the spectrum type for a radiation source and if necessary read a set of pr...</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00187">setup.c:187</a></div></div>
<div class="ttc" id="python_8h_html_a1fce05260cd94e4bb0908a0b5d2b4e17"><div class="ttname"><a href="python_8h.html#a1fce05260cd94e4bb0908a0b5d2b4e17">SYSTEM_TYPE_STAR</a></div><div class="ttdeci">#define SYSTEM_TYPE_STAR</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00287">python.h:287</a></div></div>
<div class="ttc" id="structgeometry_html_a0be43d0c0f6fd83ef56702359de54512"><div class="ttname"><a href="structgeometry.html#a0be43d0c0f6fd83ef56702359de54512">geometry::agn_radiation</a></div><div class="ttdeci">int agn_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00401">python.h:401</a></div></div>
<div class="ttc" id="python_8h_html_a940291848296c285c722ed248863afc1"><div class="ttname"><a href="python_8h.html#a940291848296c285c722ed248863afc1">wmain</a></div><div class="ttdeci">WindPtr wmain</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00724">python.h:724</a></div></div>
<div class="ttc" id="structgeometry_html_a140530983e750dba228f9cd27d12000f"><div class="ttname"><a href="structgeometry.html#a140530983e750dba228f9cd27d12000f">geometry::swavemax</a></div><div class="ttdeci">double swavemax</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00348">python.h:348</a></div></div>
<div class="ttc" id="disk_8c_html_a8c6a40a92905dcccfe3f17bb046182bc"><div class="ttname"><a href="disk_8c.html#a8c6a40a92905dcccfe3f17bb046182bc">qdisk_init</a></div><div class="ttdeci">int qdisk_init()</div><div class="ttdoc">Initialize a structure (qdisk) for recording information about photons/energy impinging on the disk...</div><div class="ttdef"><b>Definition:</b> <a href="disk_8c_source.html#l00681">disk.c:681</a></div></div>
<div class="ttc" id="structfilenames_html_a78ff170f6723c4497848c471d5faf579"><div class="ttname"><a href="structfilenames.html#a78ff170f6723c4497848c471d5faf579">filenames::new_pf</a></div><div class="ttdeci">char new_pf[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01378">python.h:1378</a></div></div>
<div class="ttc" id="foo_8h_html_a27671483c230bf332cc2286dbfa6c4be"><div class="ttname"><a href="foo_8h.html#a27671483c230bf332cc2286dbfa6c4be">define_wind</a></div><div class="ttdeci">int define_wind(void)</div><div class="ttdoc">initializes the structures which characterize the wind, including wmain and plasmamain. </div><div class="ttdef"><b>Definition:</b> <a href="wind2d_8c_source.html#l00043">wind2d.c:43</a></div></div>
<div class="ttc" id="foo_8h_html_a555f188199cb3346b32e289e64c9d980"><div class="ttname"><a href="foo_8h.html#a555f188199cb3346b32e289e64c9d980">init_geo</a></div><div class="ttdeci">int init_geo(void)</div><div class="ttdoc">initializes the geo structure to something that is semi-reasonable </div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00060">setup.c:60</a></div></div>
<div class="ttc" id="structxbands_html_a4822266ca02ed8a4b214e5efcd79256c"><div class="ttname"><a href="structxbands.html#a4822266ca02ed8a4b214e5efcd79256c">xbands::f1</a></div><div class="ttdeci">double f1[NBANDS]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01264">python.h:1264</a></div></div>
<div class="ttc" id="foo_8h_html_a7d7a0bd03f273ab50a2eabadb685b585"><div class="ttname"><a href="foo_8h.html#a7d7a0bd03f273ab50a2eabadb685b585">kbf_need</a></div><div class="ttdeci">int kbf_need(double fmin, double fmax)</div><div class="ttdoc">computes and stores the set of bound-free processes which make significiant contributions to the opac...</div><div class="ttdef"><b>Definition:</b> <a href="resonate_8c_source.html#l00682">resonate.c:682</a></div></div>
<div class="ttc" id="foo_8h_html_af01dfd90f1eaaa70104a594dd92bd30c"><div class="ttname"><a href="foo_8h.html#af01dfd90f1eaaa70104a594dd92bd30c">init_advanced_modes</a></div><div class="ttdeci">int init_advanced_modes(void)</div><div class="ttdoc">simply initialises the set of advanced modes stored in the modes structure to a default value...</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00286">setup.c:286</a></div></div>
<div class="ttc" id="bands_8c_html_a3513a64162c15d3d3d101c3d5ea2367f"><div class="ttname"><a href="bands_8c.html#a3513a64162c15d3d3d101c3d5ea2367f">bands_init</a></div><div class="ttdeci">int bands_init(int imode, struct xbands *band)</div><div class="ttdoc">This is the routine that initializes the bands. </div><div class="ttdef"><b>Definition:</b> <a href="bands_8c_source.html#l00123">bands.c:123</a></div></div>
<div class="ttc" id="structgeometry_html_afa33aaacf8e2a7956bcea9c4e2257f9b"><div class="ttname"><a href="structgeometry.html#afa33aaacf8e2a7956bcea9c4e2257f9b">geometry::star_radiation</a></div><div class="ttdeci">int star_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00400">python.h:400</a></div></div>
<div class="ttc" id="structgeometry_html_a25933883c250dfbd51df9f1df808c6d9"><div class="ttname"><a href="structgeometry.html#a25933883c250dfbd51df9f1df808c6d9">geometry::bl_radiation</a></div><div class="ttdeci">int bl_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00401">python.h:401</a></div></div>
<div class="ttc" id="structgeometry_html_a27207d7b4e1bef1c57a659354ff5cee9"><div class="ttname"><a href="structgeometry.html#a27207d7b4e1bef1c57a659354ff5cee9">geometry::rt_mode</a></div><div class="ttdeci">int rt_mode</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00458">python.h:458</a></div></div>
<div class="ttc" id="structadvanced__modes_html_a1b1488c202da4f2131eb2800e10ed2a1"><div class="ttname"><a href="structadvanced__modes.html#a1b1488c202da4f2131eb2800e10ed2a1">advanced_modes::diag_on_off</a></div><div class="ttdeci">int diag_on_off</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01352">python.h:1352</a></div></div>
<div class="ttc" id="structgeometry_html_a71b7a3a06fb5c18efba2b2642cb8e060"><div class="ttname"><a href="structgeometry.html#a71b7a3a06fb5c18efba2b2642cb8e060">geometry::diskrad</a></div><div class="ttdeci">double diskrad</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00393">python.h:393</a></div></div>
<div class="ttc" id="version_8h_html_af4763d53e5a3f37642797fac3ee14564"><div class="ttname"><a href="version_8h.html#af4763d53e5a3f37642797fac3ee14564">GIT_COMMIT_HASH</a></div><div class="ttdeci">#define GIT_COMMIT_HASH</div><div class="ttdef"><b>Definition:</b> <a href="version_8h_source.html#l00003">version.h:3</a></div></div>
<div class="ttc" id="structxbands_html_aad6fe819267976ae85b61e65e0b70f75"><div class="ttname"><a href="structxbands.html#aad6fe819267976ae85b61e65e0b70f75">xbands::nbands</a></div><div class="ttdeci">int nbands</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01273">python.h:1273</a></div></div>
<div class="ttc" id="foo_8h_html_a887b555bea1486a6c04a71838b690b63"><div class="ttname"><a href="foo_8h.html#a887b555bea1486a6c04a71838b690b63">init_ionization</a></div><div class="ttdeci">int init_ionization(void)</div><div class="ttdoc">Select the ionization and line transfer modes, along with various other parameters about ionization...</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00581">setup.c:581</a></div></div>
<div class="ttc" id="log_8h_html_aec7b5a284f31423e4382f65cda7986fa"><div class="ttname"><a href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa">Debug</a></div><div class="ttdeci">int Debug(char *format,...)</div><div class="ttdoc">Print/write to a file a special message for debugging. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00773">xlog.c:773</a></div></div>
<div class="ttc" id="log_8h_html_ac8c2622fe84047acf2894bcf91fcef73"><div class="ttname"><a href="log_8h.html#ac8c2622fe84047acf2894bcf91fcef73">Log_set_mpi_rank</a></div><div class="ttdeci">int Log_set_mpi_rank(int rank, int n_mpi)</div><div class="ttdoc">Store the rank of this particular thread. </div><div class="ttdef"><b>Definition:</b> <a href="xlog_8c_source.html#l00696">xlog.c:696</a></div></div>
<div class="ttc" id="python_8c_html_afced8478b91af5c169926dfa4426333d"><div class="ttname"><a href="python_8c.html#afced8478b91af5c169926dfa4426333d">main</a></div><div class="ttdeci">int main(int argc, argv)</div><div class="ttdoc">The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. </div><div class="ttdef"><b>Definition:</b> <a href="python_8c_source.html#l00286">python.c:286</a></div></div>
<div class="ttc" id="python_8h_html_a63732238e6ee8b8da1f3c162f4a7042f"><div class="ttname"><a href="python_8h.html#a63732238e6ee8b8da1f3c162f4a7042f">SYSTEM_TYPE_BINARY</a></div><div class="ttdeci">#define SYSTEM_TYPE_BINARY</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00288">python.h:288</a></div></div>
<div class="ttc" id="structgeometry_html_a616dab8404be7333cecb406cd354d906"><div class="ttname"><a href="structgeometry.html#a616dab8404be7333cecb406cd354d906">geometry::tstar</a></div><div class="ttdeci">double tstar</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00362">python.h:362</a></div></div>
<div class="ttc" id="version_8h_html_a352befcd3b5ee44940f2a37db2e325a3"><div class="ttname"><a href="version_8h.html#a352befcd3b5ee44940f2a37db2e325a3">GIT_DIFF_STATUS</a></div><div class="ttdeci">#define GIT_DIFF_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="version_8h_source.html#l00004">version.h:4</a></div></div>
<div class="ttc" id="structgeometry_html_a4b97dc16b54fd49d53a06ff8896596a6"><div class="ttname"><a href="structgeometry.html#a4b97dc16b54fd49d53a06ff8896596a6">geometry::matom_radiation</a></div><div class="ttdeci">int matom_radiation</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00403">python.h:403</a></div></div>
<div class="ttc" id="structfilenames_html_ad7f42e4035f3ba3be6bbf16d00b7ba35"><div class="ttname"><a href="structfilenames.html#ad7f42e4035f3ba3be6bbf16d00b7ba35">filenames::old_windsave</a></div><div class="ttdeci">char old_windsave[LINELENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01373">python.h:1373</a></div></div>
<div class="ttc" id="structgeometry_html_abc10c324e776f2bf8c809096402ecb75"><div class="ttname"><a href="structgeometry.html#abc10c324e776f2bf8c809096402ecb75">geometry::swavemin</a></div><div class="ttdeci">double swavemin</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00348">python.h:348</a></div></div>
<div class="ttc" id="python_8h_html_a157bd6748b72993519aae76091de0008"><div class="ttname"><a href="python_8h.html#a157bd6748b72993519aae76091de0008">MaxDom</a></div><div class="ttdeci">#define MaxDom</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l00159">python.h:159</a></div></div>
<div class="ttc" id="structadvanced__modes_html_af1e206518e9a1375ec7eaf46987027a3"><div class="ttname"><a href="structadvanced__modes.html#af1e206518e9a1375ec7eaf46987027a3">advanced_modes::extra_diagnostics</a></div><div class="ttdeci">int extra_diagnostics</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01344">python.h:1344</a></div></div>
<div class="ttc" id="foo_8h_html_a22069934602644cf4f894c0b48967d49"><div class="ttname"><a href="foo_8h.html#a22069934602644cf4f894c0b48967d49">binary_basics</a></div><div class="ttdeci">int binary_basics(void)</div><div class="ttdoc">From the masses and period, setup the information one needs to calculate the position of the Roche lo...</div><div class="ttdef"><b>Definition:</b> <a href="roche_8c_source.html#l00081">roche.c:81</a></div></div>
<div class="ttc" id="structadvanced__modes_html_a4da5e005fe696de0f87e747fa7fb302c"><div class="ttname"><a href="structadvanced__modes.html#a4da5e005fe696de0f87e747fa7fb302c">advanced_modes::rand_seed_usetime</a></div><div class="ttdeci">int rand_seed_usetime</div><div class="ttdef"><b>Definition:</b> <a href="python_8h_source.html#l01359">python.h:1359</a></div></div>
<div class="ttc" id="foo_8h_html_aa181995d7df5c31711c06ff2657f2f29"><div class="ttname"><a href="foo_8h.html#aa181995d7df5c31711c06ff2657f2f29">parse_command_line</a></div><div class="ttdeci">int parse_command_line(int argc, char *argv[])</div></div>
<div class="ttc" id="foo_8h_html_a044bda6029c9b8057f77a920a61ce525"><div class="ttname"><a href="foo_8h.html#a044bda6029c9b8057f77a920a61ce525">hydro_restart</a></div><div class="ttdeci">int hydro_restart(int ndom)</div><div class="ttdoc">Allows a previous windsave to be used in a new hydro simulation. </div><div class="ttdef"><b>Definition:</b> <a href="hydro__import_8c_source.html#l01092">hydro_import.c:1092</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="python_8c.html">python.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
