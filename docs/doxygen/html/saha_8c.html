<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/saha.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('saha_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">saha.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines to (re)calculate the ion densities.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for saha.c:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2saha_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2saha_8c" id="_2_users_2mhewitt_2python_2source_2saha_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="283,169,327,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="351,169,413,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="437,169,511,196"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="535,169,597,196"/>
</map>
</div>
</div>
<p><a href="saha_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structforce__con.html">force_con</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a97b9295c2ccd68eab06cce70209049a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a97b9295c2ccd68eab06cce70209049a2">MIN_FUDGE</a>&#160;&#160;&#160;1.e-10</td></tr>
<tr class="separator:a97b9295c2ccd68eab06cce70209049a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c6aa71bd92481ca7a8eabb14cae1e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#ad2c6aa71bd92481ca7a8eabb14cae1e0">MAX_FUDGE</a>&#160;&#160;&#160;10.</td></tr>
<tr class="separator:ad2c6aa71bd92481ca7a8eabb14cae1e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a63d5795e0b9978d33ed61a63917004e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a63d5795e0b9978d33ed61a63917004e2">nebular_concentrations</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode)</td></tr>
<tr class="memdesc:a63d5795e0b9978d33ed61a63917004e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the WindPtr itself, such as t_r, t_e, w, based on the "mode".  <a href="#a63d5795e0b9978d33ed61a63917004e2">More...</a><br /></td></tr>
<tr class="separator:a63d5795e0b9978d33ed61a63917004e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f3f44cc5cf473ca91ca268747dfba1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a96f3f44cc5cf473ca91ca268747dfba1">concentrations</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode)</td></tr>
<tr class="memdesc:a96f3f44cc5cf473ca91ca268747dfba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptions about what to use for the temperature Saha equantion.  <a href="#a96f3f44cc5cf473ca91ca268747dfba1">More...</a><br /></td></tr>
<tr class="separator:a96f3f44cc5cf473ca91ca268747dfba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16363b5cd764e733bd84a0d991cb6568"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a16363b5cd764e733bd84a0d991cb6568">saha</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, double ne, double <a class="el" href="import__spherical_8c.html#afc1637b8a38578a1c95ed9f689476775">t</a>)</td></tr>
<tr class="memdesc:a16363b5cd764e733bd84a0d991cb6568"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the densities for all of the ions in a single cell given ne and t.  <a href="#a16363b5cd764e733bd84a0d991cb6568">More...</a><br /></td></tr>
<tr class="separator:a16363b5cd764e733bd84a0d991cb6568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ede21a14cf7e763909094555c5240d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#aa8ede21a14cf7e763909094555c5240d">lucy</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>)</td></tr>
<tr class="memdesc:aa8ede21a14cf7e763909094555c5240d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances contained in xplasma. It thus assumes that <a class="el" href="saha_8c.html#a16363b5cd764e733bd84a0d991cb6568" title="Calculate the densities for all of the ions in a single cell given ne and t. ">saha()</a> has been called before it, in the concentrations routine.  <a href="#aa8ede21a14cf7e763909094555c5240d">More...</a><br /></td></tr>
<tr class="separator:aa8ede21a14cf7e763909094555c5240d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a389fdf4d9e9d542a78a25229ce259927"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a389fdf4d9e9d542a78a25229ce259927">lucy_mazzali1</a> (double nh, double t_r, double t_e, double www, int nelem, double ne, density, double xne, newden)</td></tr>
<tr class="memdesc:a389fdf4d9e9d542a78a25229ce259927"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates ion densities of a single element (defined by nelem) according to a modified on the spot approximation, in this case equation 11 of Mazzali and Lucy which attempts to consider ionizations from excieted and ground state levels.  <a href="#a389fdf4d9e9d542a78a25229ce259927">More...</a><br /></td></tr>
<tr class="separator:a389fdf4d9e9d542a78a25229ce259927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad350a11e70a4518fb86b842942575e26"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#ad350a11e70a4518fb86b842942575e26">fix_concentrations</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode)</td></tr>
<tr class="memdesc:ad350a11e70a4518fb86b842942575e26"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the concentrations of individual ions assuming hard coded ionization fractions that are read from a file  <a href="#ad350a11e70a4518fb86b842942575e26">More...</a><br /></td></tr>
<tr class="separator:ad350a11e70a4518fb86b842942575e26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e110fd1ce9e1f21afb98455e153ba9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a90e110fd1ce9e1f21afb98455e153ba9">get_ne</a> (density)</td></tr>
<tr class="memdesc:a90e110fd1ce9e1f21afb98455e153ba9"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the electron density given the densities of each ion.  <a href="#a90e110fd1ce9e1f21afb98455e153ba9">More...</a><br /></td></tr>
<tr class="separator:a90e110fd1ce9e1f21afb98455e153ba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a55786cdfcf98a42b819656e1e4ee7065"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a55786cdfcf98a42b819656e1e4ee7065">fix_con_start</a> = 0</td></tr>
<tr class="separator:a55786cdfcf98a42b819656e1e4ee7065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e841e587b275d756267eddb95cc6a2"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structforce__con.html">force_con</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a23e841e587b275d756267eddb95cc6a2">con_force</a> [1000]</td></tr>
<tr class="separator:a23e841e587b275d756267eddb95cc6a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b3eba3a0a02b028a29c5d59620ba991"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saha_8c.html#a2b3eba3a0a02b028a29c5d59620ba991">nforce</a></td></tr>
<tr class="separator:a2b3eba3a0a02b028a29c5d59620ba991"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines to (re)calculate the ion densities. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May, 2018</dd></dl>
<p>The driving routine for calculating the ion desnsities is here, as well as the routines for carrying out many of the older ionization schemes, but more modern matrix based approaches re elsewhere. </p>

<p class="definition">Definition in file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad2c6aa71bd92481ca7a8eabb14cae1e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c6aa71bd92481ca7a8eabb14cae1e0">&#9670;&nbsp;</a></span>MAX_FUDGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_FUDGE&#160;&#160;&#160;10.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00464">464</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>

</div>
</div>
<a id="a97b9295c2ccd68eab06cce70209049a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97b9295c2ccd68eab06cce70209049a2">&#9670;&nbsp;</a></span>MIN_FUDGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_FUDGE&#160;&#160;&#160;1.e-10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00463">463</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a96f3f44cc5cf473ca91ca268747dfba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f3f44cc5cf473ca91ca268747dfba1">&#9670;&nbsp;</a></span>concentrations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int concentrations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptions about what to use for the temperature Saha equantion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma A singll plasma cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A swich whith defines what to use for the temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>concentrations returns 0 if it converged; -1 if it did not converge. If it does not converge, both density and *ne are likely to be garbage.</dd></dl>
<p>The densities are updated in xplasma</p>
<p>The modes are as follows:</p><ul>
<li>NEBULAR_TR &ndash; use the radiation temperature</li>
<li>NEBULaR_TE &ndash; use the electron temperature</li>
<li>NEBULAR_ML93 - From Mazzli &amp; Lucy 1993, use the geometric mean of the electron and radiaion temperature</li>
</ul>
<p>This routine iterates to find the densities of individual ions using the Saha equation.</p>
<p>The Saha eqn. is (e.g. Motz, p 110, eqn 4.14</p>
<ul>
<li><p class="startli">N_r+1 N_e / N_r = (2*pi*m*kT)**1.5/h**3 2 Z_r+1(T)/Z_r * exp (-X/kT)</p>
<p class="startli">where N_r+1 is the number density of the r+1 ionization state and Z_r+1 is the partition function of that state.</p>
</li>
</ul>
<p>he program works by perfoming a crude iteration on ne. It could undoubtedly be improved, if one wanted better accuracy or higher speed.</p>
<h3>Notes</h3>
<p>So that one doesn't get zero-divides in other programs, e.g. nebular_concentrations, a floor is set on the density of any ion or the electron density. </p>

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00202">202</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_cgraph.png" border="0" usemap="#saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_cgraph" alt=""/></div>
<map name="saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_cgraph" id="saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_cgraph">
<area shape="rect" id="node2" href="balance__templates_8h.html#ab34d13ef098af692d1a406016724580a" title="xsaha" alt="" coords="265,5,315,32"/>
<area shape="rect" id="node3" href="saha_8c.html#a90e110fd1ce9e1f21afb98455e153ba9" title="calculates the electron density given the densities of each ion. " alt="" coords="153,157,205,184"/>
<area shape="rect" id="node4" href="saha_8c.html#a16363b5cd764e733bd84a0d991cb6568" title="Calculate the densities for all of the ions in a single cell given ne and t. " alt="" coords="157,56,201,83"/>
<area shape="rect" id="node5" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="268,107,312,133"/>
<area shape="rect" id="node13" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="140,208,217,235"/>
<area shape="rect" id="node12" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="363,56,439,83"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="735,132,792,159"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="364,107,437,133"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="487,107,576,133"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="509,56,553,83"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="636,132,675,159"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="624,81,687,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_icgraph.png" border="0" usemap="#saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_icgraph" alt=""/></div>
<map name="saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_icgraph" id="saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="140,5,265,32"/>
</map>
</div>

</div>
</div>
<a id="ad350a11e70a4518fb86b842942575e26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad350a11e70a4518fb86b842942575e26">&#9670;&nbsp;</a></span>fix_concentrations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fix_concentrations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets the concentrations of individual ions assuming hard coded ionization fractions that are read from a file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma A plasma cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode UNUSED </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The first time the routine is called it reads the file specified by geo.con_file which populates the <a class="el" href="structforce__con.html">force_con</a> array.</p>
<p>On subsequent calls the values of one of an xplasma element are modified.</p>
<p>The format of the file is fairly obvious</p>
<p>Element.z Ion ion_fraction</p>
<p>6 4 1</p>
<p>would set the CIV fraction to 1.</p>
<p>Note there is nothing forcing the totals to be anything sensible.</p>
<h3>Notes</h3>
<p>o change the ions that you want to fix, simply update con_force, AND MAKE SURE NFORCE IS SET TO THE NUMBER OF IONS</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000053">Bug:</a></b></dt><dd>It is not obvious that this is really what we want. This routine was written when we only were concerned about scattering and does not really take into account emission (for which one needs n_e. One possiblity is to calculated ion abundances for H and He properly, in which case we would need the mode variable.</dd></dl>

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00803">803</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_ad350a11e70a4518fb86b842942575e26_cgraph.png" border="0" usemap="#saha_8c_ad350a11e70a4518fb86b842942575e26_cgraph" alt=""/></div>
<map name="saha_8c_ad350a11e70a4518fb86b842942575e26_cgraph" id="saha_8c_ad350a11e70a4518fb86b842942575e26_cgraph">
<area shape="rect" id="node2" href="saha_8c.html#a90e110fd1ce9e1f21afb98455e153ba9" title="calculates the electron density given the densities of each ion. " alt="" coords="181,74,233,101"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="185,125,229,151"/>
<area shape="rect" id="node10" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="324,175,363,202"/>
<area shape="rect" id="node11" href="balance__templates_8h.html#a37c9b91e3450874eb15cef76079f344d" title="calculates the partition functions for a single cell in the grid (and then calls a routine that calcu..." alt="" coords="156,226,259,253"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="676,74,733,101"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="307,125,380,151"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="428,74,517,101"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="451,125,495,151"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="577,23,616,50"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="565,74,628,101"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_ad350a11e70a4518fb86b842942575e26_icgraph.png" border="0" usemap="#saha_8c_ad350a11e70a4518fb86b842942575e26_icgraph" alt=""/></div>
<map name="saha_8c_ad350a11e70a4518fb86b842942575e26_icgraph" id="saha_8c_ad350a11e70a4518fb86b842942575e26_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="156,5,252,32"/>
</map>
</div>

</div>
</div>
<a id="a90e110fd1ce9e1f21afb98455e153ba9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90e110fd1ce9e1f21afb98455e153ba9">&#9670;&nbsp;</a></span>get_ne()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_ne </td>
          <td>(</td>
          <td class="paramtype">density&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the electron density given the densities of each ion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>density[] A trial set of densities for ions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An electron density</dd></dl>
<p>The routine is used in situations where we have a trial set of densities for a cell, but do not want to populate the plasma structure with them (yet).</p>
<h3>Notes</h3>
<p>This makes use of the fact that the densities are stored in ion order. </p>

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00905">905</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a90e110fd1ce9e1f21afb98455e153ba9_icgraph.png" border="0" usemap="#saha_8c_a90e110fd1ce9e1f21afb98455e153ba9_icgraph" alt=""/></div>
<map name="saha_8c_a90e110fd1ce9e1f21afb98455e153ba9_icgraph" id="saha_8c_a90e110fd1ce9e1f21afb98455e153ba9_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="256,26,381,53"/>
<area shape="rect" id="node3" href="templates_8h.html#a96f3f44cc5cf473ca91ca268747dfba1" title="A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptio..." alt="" coords="113,26,200,53"/>
<area shape="rect" id="node4" href="templates_8h.html#aa8ede21a14cf7e763909094555c5240d" title="Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances con..." alt="" coords="137,77,177,103"/>
<area shape="rect" id="node5" href="templates_8h.html#ad350a11e70a4518fb86b842942575e26" title="sets the concentrations of individual ions assuming hard coded ionization fractions that are read fro..." alt="" coords="105,127,208,154"/>
</map>
</div>

</div>
</div>
<a id="aa8ede21a14cf7e763909094555c5240d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ede21a14cf7e763909094555c5240d">&#9670;&nbsp;</a></span>lucy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lucy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances contained in xplasma. It thus assumes that <a class="el" href="saha_8c.html#a16363b5cd764e733bd84a0d991cb6568" title="Calculate the densities for all of the ions in a single cell given ne and t. ">saha()</a> has been called before it, in the concentrations routine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma A single plasma cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always retuns 0</dd></dl>
<p>This routine solves for ne (and the concentrations) using the Lucy Mazzli correction factors.</p>
<h3>Notes</h3>
<p>The routine needs the Saha abundances before the correction factors can be found. As a result, the sequence is to call parttion functions, concentrations and then this routine.</p>
<p>Procedurally, the routine is analogous to <a class="el" href="saha_8c.html#a96f3f44cc5cf473ca91ca268747dfba1" title="A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptio...">concentrations()</a></p>
<p>Note that also applied the macro_pops routine, and required that the ne convergence criteria is rigorous enough that the macro atom level populations converge on the correct values. </p>

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00493">493</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_aa8ede21a14cf7e763909094555c5240d_cgraph.png" border="0" usemap="#saha_8c_aa8ede21a14cf7e763909094555c5240d_cgraph" alt=""/></div>
<map name="saha_8c_aa8ede21a14cf7e763909094555c5240d_cgraph" id="saha_8c_aa8ede21a14cf7e763909094555c5240d_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="247,45,291,71"/>
<area shape="rect" id="node9" href="saha_8c.html#a389fdf4d9e9d542a78a25229ce259927" title="calculates ion densities of a single element (defined by nelem) according to a modified on the spot a..." alt="" coords="93,95,179,122"/>
<area shape="rect" id="node13" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="97,146,175,173"/>
<area shape="rect" id="node14" href="saha_8c.html#a90e110fd1ce9e1f21afb98455e153ba9" title="calculates the electron density given the densities of each ion. " alt="" coords="110,197,162,223"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="729,134,787,161"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="360,45,433,71"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="481,89,571,115"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="504,38,548,65"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="631,134,669,161"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="619,83,681,110"/>
<area shape="rect" id="node10" href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa" title="Print/write to a file a special message for debugging. " alt="" coords="371,235,423,262"/>
<area shape="rect" id="node11" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="233,146,306,173"/>
<area shape="rect" id="node12" href="foo_8h.html#a54a60a3cfc21ceae39f7c529519c25ae" title="calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equa..." alt="" coords="227,95,312,122"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_aa8ede21a14cf7e763909094555c5240d_icgraph.png" border="0" usemap="#saha_8c_aa8ede21a14cf7e763909094555c5240d_icgraph" alt=""/></div>
<map name="saha_8c_aa8ede21a14cf7e763909094555c5240d_icgraph" id="saha_8c_aa8ede21a14cf7e763909094555c5240d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="93,5,219,32"/>
</map>
</div>

</div>
</div>
<a id="a389fdf4d9e9d542a78a25229ce259927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a389fdf4d9e9d542a78a25229ce259927">&#9670;&nbsp;</a></span>lucy_mazzali1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lucy_mazzali1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>www</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ne</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">density&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xne</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">newden&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates ion densities of a single element (defined by nelem) according to a modified on the spot approximation, in this case equation 11 of Mazzali and Lucy which attempts to consider ionizations from excieted and ground state levels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>nh Number density of H </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t_r The radiation temeperture </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t_e The electorn temperature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>www dilution factor for the radiation field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nelem the element number for which the calculation is carried out </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>ne electron density </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>density[] densities of individual ions under pure Saha conditions </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">[in</td><td>out] double xne ??? </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>newden[] Array containing the modified densities </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if it converged to an answer, -1 otherwise. On an abnormal return the density array and ne are left unchanged.</dd></dl>
<p>This is a first attempt to fudge the ionization equation in the wind to account for the fact that one is not sitting in a BB radiation field. The routine assumes one has already put the concentrations of of the ions under LTE conditions for a temperature t_r into density. It uses the same dumb procedure as for "concentrations."</p>
<h3>Notes</h3>
<p>It's probably OK but it would be worthwhile worrying whether I have introduced any problems by setting the floor to any species and ne of DENSITY_MIN </p>

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00634">634</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a389fdf4d9e9d542a78a25229ce259927_cgraph.png" border="0" usemap="#saha_8c_a389fdf4d9e9d542a78a25229ce259927_cgraph" alt=""/></div>
<map name="saha_8c_a389fdf4d9e9d542a78a25229ce259927_cgraph" id="saha_8c_a389fdf4d9e9d542a78a25229ce259927_cgraph">
<area shape="rect" id="node2" href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa" title="Print/write to a file a special message for debugging. " alt="" coords="283,5,335,32"/>
<area shape="rect" id="node4" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="145,107,218,133"/>
<area shape="rect" id="node10" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="159,157,203,184"/>
<area shape="rect" id="node11" href="foo_8h.html#a54a60a3cfc21ceae39f7c529519c25ae" title="calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equa..." alt="" coords="139,208,224,235"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="641,107,699,133"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="272,157,345,184"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="393,132,483,159"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="416,183,460,209"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="543,107,581,133"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="531,157,593,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a389fdf4d9e9d542a78a25229ce259927_icgraph.png" border="0" usemap="#saha_8c_a389fdf4d9e9d542a78a25229ce259927_icgraph" alt=""/></div>
<map name="saha_8c_a389fdf4d9e9d542a78a25229ce259927_icgraph" id="saha_8c_a389fdf4d9e9d542a78a25229ce259927_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="227,5,352,32"/>
<area shape="rect" id="node3" href="templates_8h.html#aa8ede21a14cf7e763909094555c5240d" title="Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances con..." alt="" coords="139,31,179,57"/>
</map>
</div>

</div>
</div>
<a id="a63d5795e0b9978d33ed61a63917004e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63d5795e0b9978d33ed61a63917004e2">&#9670;&nbsp;</a></span>nebular_concentrations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nebular_concentrations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the WindPtr itself, such as t_r, t_e, w, based on the "mode". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma A single plasma cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode A mode which describes which of the various ionization schemes to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A status message (returned from the individual routines that calculate the ionization. 0 generally signifies success.</dd></dl>
<p>nebular concentrations serves as the steering routine for all ionization calculations.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00051">51</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a63d5795e0b9978d33ed61a63917004e2_cgraph.png" border="0" usemap="#saha_8c_a63d5795e0b9978d33ed61a63917004e2_cgraph" alt=""/></div>
<map name="saha_8c_a63d5795e0b9978d33ed61a63917004e2_cgraph" id="saha_8c_a63d5795e0b9978d33ed61a63917004e2_cgraph">
<area shape="rect" id="node2" href="saha_8c.html#a90e110fd1ce9e1f21afb98455e153ba9" title="calculates the electron density given the densities of each ion. " alt="" coords="369,259,421,285"/>
<area shape="rect" id="node3" href="saha_8c.html#a389fdf4d9e9d542a78a25229ce259927" title="calculates ion densities of a single element (defined by nelem) according to a modified on the spot a..." alt="" coords="352,56,437,83"/>
<area shape="rect" id="node12" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="506,233,550,260"/>
<area shape="rect" id="node14" href="balance__templates_8h.html#a37c9b91e3450874eb15cef76079f344d" title="calculates the partition functions for a single cell in the grid (and then calls a routine that calcu..." alt="" coords="190,208,293,235"/>
<area shape="rect" id="node15" href="saha_8c.html#a96f3f44cc5cf473ca91ca268747dfba1" title="A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptio..." alt="" coords="198,309,285,336"/>
<area shape="rect" id="node20" href="saha_8c.html#aa8ede21a14cf7e763909094555c5240d" title="Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances con..." alt="" coords="221,157,261,184"/>
<area shape="rect" id="node21" href="foo_8h.html#a72d9769510683e30aeef87c2a255ebe4" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="183,360,299,387"/>
<area shape="rect" id="node22" href="foo_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="179,411,304,437"/>
<area shape="rect" id="node4" href="log_8h.html#aec7b5a284f31423e4382f65cda7986fa" title="Print/write to a file a special message for debugging. " alt="" coords="631,56,683,83"/>
<area shape="rect" id="node6" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="491,107,565,133"/>
<area shape="rect" id="node13" href="foo_8h.html#a54a60a3cfc21ceae39f7c529519c25ae" title="calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equa..." alt="" coords="485,5,571,32"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="991,208,1048,235"/>
<area shape="rect" id="node7" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="620,233,693,260"/>
<area shape="rect" id="node8" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="743,208,832,235"/>
<area shape="rect" id="node11" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="765,259,809,285"/>
<area shape="rect" id="node9" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="892,208,931,235"/>
<area shape="rect" id="node10" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="880,157,943,184"/>
<area shape="rect" id="node16" href="balance__templates_8h.html#ab34d13ef098af692d1a406016724580a" title="xsaha" alt="" coords="503,411,553,437"/>
<area shape="rect" id="node17" href="saha_8c.html#a16363b5cd764e733bd84a0d991cb6568" title="Calculate the densities for all of the ions in a single cell given ne and t. " alt="" coords="373,360,417,387"/>
<area shape="rect" id="node19" href="foo_8h.html#a590f1ed026cd692ac6f878ed6f359d5a" title="uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms..." alt="" coords="356,208,433,235"/>
<area shape="rect" id="node18" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="619,360,695,387"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a63d5795e0b9978d33ed61a63917004e2_icgraph.png" border="0" usemap="#saha_8c_a63d5795e0b9978d33ed61a63917004e2_icgraph" alt=""/></div>
<map name="saha_8c_a63d5795e0b9978d33ed61a63917004e2_icgraph" id="saha_8c_a63d5795e0b9978d33ed61a63917004e2_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a626b1882e2533441cdf2daabd36e8a8b" title="ionization routines for the wind one cell at a time " alt="" coords="289,5,385,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a0c0fa3305df1f5c000e0ed0a26d413d8" title="calculates new densities of ions in a single element of the wind after (usually) having found the tem..." alt="" coords="179,31,241,57"/>
</map>
</div>

</div>
</div>
<a id="a16363b5cd764e733bd84a0d991cb6568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16363b5cd764e733bd84a0d991cb6568">&#9670;&nbsp;</a></span>saha()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int saha </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ne</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the densities for all of the ions in a single cell given ne and t. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PlasmaPtr</td><td>xplasma The cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>ne A trial value for ne </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>t A value of the temperature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The calculate abundances are stored in xplasma</p>
<p>This routine simply uses the Saha equantion to calculate the densities of all of the ions. It assumes that ne is known, and so in general if one calcualted ne from the concentrations, one would not get the input value. Iteration to calculate ne takes place in concentrations.</p>
<h3>Notes</h3>
<p>All of the partition functions are assumed to have been calculated before entering the routine. </p>

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00358">358</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a16363b5cd764e733bd84a0d991cb6568_cgraph.png" border="0" usemap="#saha_8c_a16363b5cd764e733bd84a0d991cb6568_cgraph" alt=""/></div>
<map name="saha_8c_a16363b5cd764e733bd84a0d991cb6568_cgraph" id="saha_8c_a16363b5cd764e733bd84a0d991cb6568_cgraph">
<area shape="rect" id="node2" href="balance__templates_8h.html#ab34d13ef098af692d1a406016724580a" title="xsaha" alt="" coords="97,5,147,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="100,56,144,83"/>
<area shape="rect" id="node10" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="195,107,271,133"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="567,31,624,57"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="196,56,269,83"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="319,56,408,83"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="341,107,385,133"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="468,31,507,57"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="456,81,519,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="saha_8c_a16363b5cd764e733bd84a0d991cb6568_icgraph.png" border="0" usemap="#saha_8c_a16363b5cd764e733bd84a0d991cb6568_icgraph" alt=""/></div>
<map name="saha_8c_a16363b5cd764e733bd84a0d991cb6568_icgraph" id="saha_8c_a16363b5cd764e733bd84a0d991cb6568_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a74e9a1ed7ffcb66086ca24b9cc1d280f" title="is a routine which prints information about departure coefficients and level populations in a cell..." alt="" coords="117,5,219,32"/>
<area shape="rect" id="node4" href="py__wind__macro_8c.html#aad71ef4970632e72236ffe2ca6095e1a" title="gives populations of nconfig in each cell " alt="" coords="97,56,239,83"/>
<area shape="rect" id="node5" href="py__wind__macro_8c.html#ad6e2a0d37288f7f51afea6c8a0d95347" title="is a routine which prints information about departure coefficients and level populations in a cell..." alt="" coords="113,107,223,133"/>
<area shape="rect" id="node6" href="templates_8h.html#a96f3f44cc5cf473ca91ca268747dfba1" title="A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptio..." alt="" coords="125,157,211,184"/>
<area shape="rect" id="node3" href="py__wind__macro_8c.html#a6e3344441d509e05ca1c82b37fd88318" title="is a routine intended to allow one to display information about macro atoms. It is the top level rout..." alt="" coords="301,56,397,83"/>
<area shape="rect" id="node7" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="287,157,412,184"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a23e841e587b275d756267eddb95cc6a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e841e587b275d756267eddb95cc6a2">&#9670;&nbsp;</a></span>con_force</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structforce__con.html">force_con</a>
 con_force[1000]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a55786cdfcf98a42b819656e1e4ee7065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55786cdfcf98a42b819656e1e4ee7065">&#9670;&nbsp;</a></span>fix_con_start</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fix_con_start = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00754">754</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>

</div>
</div>
<a id="a2b3eba3a0a02b028a29c5d59620ba991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b3eba3a0a02b028a29c5d59620ba991">&#9670;&nbsp;</a></span>nforce</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nforce</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="saha_8c_source.html#l00761">761</a> of file <a class="el" href="saha_8c_source.html">saha.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="saha_8c.html">saha.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
