<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/phot_util.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('phot__util_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">phot_util.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains utilities which can be used to work with photon structues. It also contains routines to calculate the distances to intersections of spheres and cones. The routines included here should not be tightly tied to a particular wind model. The one exception at present is ds_to_cone which calculates the distance to a bifurcated cone.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for phot_util.c:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2phot__util_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2phot__util_8c" id="_2_users_2mhewitt_2python_2source_2phot__util_8c">
<area shape="rect" id="node7" href="atomic_8h.html" title="atomic.h" alt="" coords="388,95,448,121"/>
<area shape="rect" id="node8" href="python_8h.html" title="python.h" alt="" coords="472,95,532,121"/>
<area shape="rect" id="node9" href="log_8h.html" title="log.h" alt="" coords="356,169,400,196"/>
<area shape="rect" id="node10" href="version_8h.html" title="version.h" alt="" coords="424,169,487,196"/>
<area shape="rect" id="node11" href="templates_8h.html" title="templates.h" alt="" coords="511,169,584,196"/>
<area shape="rect" id="node12" href="recipes_8h.html" title="recipes.h" alt="" coords="608,169,671,196"/>
</map>
</div>
</div>
<p><a href="phot__util_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1c6dc9c24a43e2bc6319b23faba4a041"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a1c6dc9c24a43e2bc6319b23faba4a041">stuff_phot</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> pin, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> pout)</td></tr>
<tr class="memdesc:a1c6dc9c24a43e2bc6319b23faba4a041"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simply copy one photon bundle into another.  <a href="#a1c6dc9c24a43e2bc6319b23faba4a041">More...</a><br /></td></tr>
<tr class="separator:a1c6dc9c24a43e2bc6319b23faba4a041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f17a1e86112f24760862d998129d91c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a8f17a1e86112f24760862d998129d91c">move_phot</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> pp, double ds)</td></tr>
<tr class="memdesc:a8f17a1e86112f24760862d998129d91c"><td class="mdescLeft">&#160;</td><td class="mdescRight">move a photon by a distance ds  <a href="#a8f17a1e86112f24760862d998129d91c">More...</a><br /></td></tr>
<tr class="separator:a8f17a1e86112f24760862d998129d91c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b6ecee57eb3cb519fde55290c02f1b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a54b6ecee57eb3cb519fde55290c02f1b">comp_phot</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p1, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p2)</td></tr>
<tr class="memdesc:a54b6ecee57eb3cb519fde55290c02f1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares two photons to determine whether they have the identical position and direction.  <a href="#a54b6ecee57eb3cb519fde55290c02f1b">More...</a><br /></td></tr>
<tr class="separator:a54b6ecee57eb3cb519fde55290c02f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56bcc4eb80e38e626fe58bb5c989eafd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a56bcc4eb80e38e626fe58bb5c989eafd">phot_hist</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, int iswitch)</td></tr>
<tr class="memdesc:a56bcc4eb80e38e626fe58bb5c989eafd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record the history of a single photon bundle, in terms of a series of photon structures that are populated as the photon goes through the grid.  <a href="#a56bcc4eb80e38e626fe58bb5c989eafd">More...</a><br /></td></tr>
<tr class="separator:a56bcc4eb80e38e626fe58bb5c989eafd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13bf02e4a8315e90c84ae43b42fde4b6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a13bf02e4a8315e90c84ae43b42fde4b6">phot_history_summarize</a> ()</td></tr>
<tr class="memdesc:a13bf02e4a8315e90c84ae43b42fde4b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The next routine is designed to update a portion of the PlasmaPtr to reflect where photons along the line of sight to the observer were absorbed in the wind.  <a href="#a13bf02e4a8315e90c84ae43b42fde4b6">More...</a><br /></td></tr>
<tr class="separator:a13bf02e4a8315e90c84ae43b42fde4b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a0398c1230c6d21c5c51f4750ca2ea1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a4a0398c1230c6d21c5c51f4750ca2ea1">ds_to_cone</a> (<a class="el" href="python_8h.html#a24207bf0bce7d09eb68cd114e725996d">ConePtr</a> cc, struct <a class="el" href="structphoton.html">photon</a> *p)</td></tr>
<tr class="memdesc:a4a0398c1230c6d21c5c51f4750ca2ea1"><td class="mdescLeft">&#160;</td><td class="mdescRight">(cc, p) This is a new version of introduced in order to allow cylvar coordinates Eventually it is intended to replace ds_to_windcone completely, or at least the guts of ds_to_windcone.  <a href="#a4a0398c1230c6d21c5c51f4750ca2ea1">More...</a><br /></td></tr>
<tr class="separator:a4a0398c1230c6d21c5c51f4750ca2ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67e3cb7a7d0cd3d55277fc4f3373fe2e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a67e3cb7a7d0cd3d55277fc4f3373fe2e">ds_to_sphere</a> (double <a class="el" href="import__spherical_8c.html#a83175ac8fd9d924ff2bce40c99e88870">r</a>, struct <a class="el" href="structphoton.html">photon</a> *p)</td></tr>
<tr class="memdesc:a67e3cb7a7d0cd3d55277fc4f3373fe2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the pathlenth along a line of sight defined by a photon p to a sphere centered on the origin.  <a href="#a67e3cb7a7d0cd3d55277fc4f3373fe2e">More...</a><br /></td></tr>
<tr class="separator:a67e3cb7a7d0cd3d55277fc4f3373fe2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8656562abff4020df988426338e79eca"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a8656562abff4020df988426338e79eca">ds_to_sphere2</a> (<a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, <a class="el" href="import__spherical_8c.html#a83175ac8fd9d924ff2bce40c99e88870">r</a>, struct <a class="el" href="structphoton.html">photon</a> *p)</td></tr>
<tr class="memdesc:a8656562abff4020df988426338e79eca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the positive distance to a sphere centered at x with radius r.  <a href="#a8656562abff4020df988426338e79eca">More...</a><br /></td></tr>
<tr class="separator:a8656562abff4020df988426338e79eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2cef648adc07ade76f313650e627ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#aba2cef648adc07ade76f313650e627ab">quadratic</a> (double a, double b, double c, <a class="el" href="import__spherical_8c.html#a83175ac8fd9d924ff2bce40c99e88870">r</a>)</td></tr>
<tr class="memdesc:aba2cef648adc07ade76f313650e627ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">This solves a simple quadratic (or if a is zero linear) equation.  <a href="#aba2cef648adc07ade76f313650e627ab">More...</a><br /></td></tr>
<tr class="separator:aba2cef648adc07ade76f313650e627ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae443765b508c1d69ac5249ef9de2bb81"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#ae443765b508c1d69ac5249ef9de2bb81">ds_to_plane</a> (struct <a class="el" href="structplane.html">plane</a> *pl, struct <a class="el" href="structphoton.html">photon</a> *p)</td></tr>
<tr class="memdesc:ae443765b508c1d69ac5249ef9de2bb81"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the distance of a photon must travel to hit the plane.  <a href="#ae443765b508c1d69ac5249ef9de2bb81">More...</a><br /></td></tr>
<tr class="separator:ae443765b508c1d69ac5249ef9de2bb81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b9698b536acf2ec47097c93fb6c81f0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a8b9698b536acf2ec47097c93fb6c81f0">ds_to_closest_approach</a> (<a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, struct <a class="el" href="structphoton.html">photon</a> *p, double *impact_parameter)</td></tr>
<tr class="memdesc:a8b9698b536acf2ec47097c93fb6c81f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine calculates the distance a photon has to be moved to reach the point of closest approach to a point described by x and also calculates the distance of closest approach (i.e. the impact parameter).  <a href="#a8b9698b536acf2ec47097c93fb6c81f0">More...</a><br /></td></tr>
<tr class="separator:a8b9698b536acf2ec47097c93fb6c81f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abca5dd4cfb2140628e2a8f8be27aa2ee"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#abca5dd4cfb2140628e2a8f8be27aa2ee">ds_to_cylinder</a> (double <a class="el" href="wind2d_8c.html#a078472458c0ac73f723c094fc2121c14">rho</a>, struct <a class="el" href="structphoton.html">photon</a> *p)</td></tr>
<tr class="memdesc:abca5dd4cfb2140628e2a8f8be27aa2ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the distance a photon must travel to encouter a cylinder that is centered on the z axis.  <a href="#abca5dd4cfb2140628e2a8f8be27aa2ee">More...</a><br /></td></tr>
<tr class="separator:abca5dd4cfb2140628e2a8f8be27aa2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0791b17bafbcf6e30d7bbeffa2c1cec4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#a0791b17bafbcf6e30d7bbeffa2c1cec4">init_stuff_phot</a> = 0</td></tr>
<tr class="separator:a0791b17bafbcf6e30d7bbeffa2c1cec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad063cb5ecb88d7c02392bcb4b84a942d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phot__util_8c.html#ad063cb5ecb88d7c02392bcb4b84a942d">sizeofphot</a></td></tr>
<tr class="separator:ad063cb5ecb88d7c02392bcb4b84a942d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains utilities which can be used to work with photon structues. It also contains routines to calculate the distances to intersections of spheres and cones. The routines included here should not be tightly tied to a particular wind model. The one exception at present is ds_to_cone which calculates the distance to a bifurcated cone. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January, 2018 </dd></dl>

<p class="definition">Definition in file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a54b6ecee57eb3cb519fde55290c02f1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b6ecee57eb3cb519fde55290c02f1b">&#9670;&nbsp;</a></span>comp_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int comp_phot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares two photons to determine whether they have the identical position and direction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p1 The first photon bundle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p2 The second phton bundle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 if the position and direction are identical, 1 otherwise</dd></dl>
<h3>Notes</h3>
<p>The routine is used in calculate_ds </p>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00133">133</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a54b6ecee57eb3cb519fde55290c02f1b_icgraph.png" border="0" usemap="#phot__util_8c_a54b6ecee57eb3cb519fde55290c02f1b_icgraph" alt=""/></div>
<map name="phot__util_8c_a54b6ecee57eb3cb519fde55290c02f1b_icgraph" id="phot__util_8c_a54b6ecee57eb3cb519fde55290c02f1b_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="125,5,203,32"/>
</map>
</div>

</div>
</div>
<a id="a8b9698b536acf2ec47097c93fb6c81f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b9698b536acf2ec47097c93fb6c81f0">&#9670;&nbsp;</a></span>ds_to_closest_approach()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_closest_approach </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structphoton.html">photon</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>impact_parameter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This routine calculates the distance a photon has to be moved to reach the point of closest approach to a point described by x and also calculates the distance of closest approach (i.e. the impact parameter). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] A position in space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">struct</td><td>photon * p A photon bundle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>* impact_parameter The distance of closest approach of the photon </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The distance the photon would have to be moved to reach the point of closest approach, which can be negative</dd></dl>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00859">859</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a8b9698b536acf2ec47097c93fb6c81f0_cgraph.png" border="0" usemap="#phot__util_8c_a8b9698b536acf2ec47097c93fb6c81f0_cgraph" alt=""/></div>
<map name="phot__util_8c_a8b9698b536acf2ec47097c93fb6c81f0_cgraph" id="phot__util_8c_a8b9698b536acf2ec47097c93fb6c81f0_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="185,5,235,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="191,56,229,83"/>
<area shape="rect" id="node4" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="189,107,231,133"/>
<area shape="rect" id="node5" href="foo_8h.html#a121f213b4ad36619461deebbea325e66" title="vmove" alt="" coords="184,157,236,184"/>
</map>
</div>

</div>
</div>
<a id="a4a0398c1230c6d21c5c51f4750ca2ea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a0398c1230c6d21c5c51f4750ca2ea1">&#9670;&nbsp;</a></span>ds_to_cone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_cone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a24207bf0bce7d09eb68cd114e725996d">ConePtr</a>&#160;</td>
          <td class="paramname"><em>cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structphoton.html">photon</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(cc, p) This is a new version of introduced in order to allow cylvar coordinates Eventually it is intended to replace ds_to_windcone completely, or at least the guts of ds_to_windcone. </p>
<p>&lt;NOTE: The [in, out] tag describes if the value of a parameter is used or altered. If it is used but not altered, delete 'OUT'. If the original value is not used and it is written to, delete 'IN'.&gt; </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ConePtr</td><td>cc ??? </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td>photon * p ??? </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>??? RETURNS ???</dd></dl>
<p>??? DESCRIPTION ???</p>
<h3>Notes</h3>
<p>As part of the conversion, the old ds_to_cone was renamed to ds_to_windcone</p>
<pre class="fragment">56d -- Cones have become more prominent in python with time.  Originally
they were used simply to define the inner and outer edges of the
wind, that is   to determine when a photon entered the wind.  The wind was/is
assumed to be a biconical flow, and therefore the most naturally was defined in
terms of a footpoint in the disk for the innermost/outermost stream line
and a slope.

It was expanced when rtheta coordanates were introduced
to handle find when one had hit the theta coordinate boundaries.  And in
56d we also want it to handle the case where the grid cells have variable
z coordinates.  Therefore one needs to be quite careful, Since ds_to_cone
is the ultimate name of the routine I would like to use, the first step
I took was to change the name of the old routine to ds_to_windcone.  This
should allow me to replace the old routine incrementally.

56d -- With python 56d the variable defining a cone were changed to be
the point on the z axis intercepted by the cone (extended) through
the disk, and the slope.

Our approach is as follows:

The cone is defined by  z=z_o + dz/drho *drho
The photon is defined by X=X_o + LMN s

Unless dz/drho = 0, this turns into a simple quadratic equation that must
be solved.  We work in the northen hemisphere only.

There are issues concerning what to do so one crosses the disk plane.  For
    finding how far a photon can travel in a cell, we are *not* interested
in the possibility that the photon hits the cone on the other side of
the disk plane, but for a photon travelling out of the wind we are
very interested in this possibility.</pre> 
<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00439">439</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_cgraph.png" border="0" usemap="#phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_cgraph" alt=""/></div>
<map name="phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_cgraph" id="phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_cgraph">
<area shape="rect" id="node2" href="phot__util_8c.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="127,5,192,32"/>
<area shape="rect" id="node3" href="phot__util_8c.html#aba2cef648adc07ade76f313650e627ab" title="This solves a simple quadratic (or if a is zero linear) equation. " alt="" coords="128,56,191,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_icgraph.png" border="0" usemap="#phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_icgraph" alt=""/></div>
<map name="phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_icgraph" id="phot__util_8c_a4a0398c1230c6d21c5c51f4750ca2ea1_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a52b5367a4a1a8d1bbe9446a5571a81fd" title="cylin_ds_in_cell calculates the distance to the far boundary of the cell in which the photon bundle r..." alt="" coords="127,5,225,32"/>
<area shape="rect" id="node7" href="templates_8h.html#a8bc3604c533b18b872bb155bfd444bb5" title="calculates the photon pathlength to the edge of the wind. " alt="" coords="273,56,345,83"/>
<area shape="rect" id="node8" href="templates_8h.html#a68cff92e2a36ec9073dbecabffa5543b" title="calculates the distance to the far boundary of the cell in which the photon bundle resides..." alt="" coords="127,107,225,133"/>
<area shape="rect" id="node3" href="templates_8h.html#afee395233fbca5e632fd3ef51106f74c" title="calculates the distance photon can travel within the cell that it is currently in. " alt="" coords="276,5,343,32"/>
<area shape="rect" id="node4" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="393,5,499,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="396,56,496,83"/>
<area shape="rect" id="node5" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="547,31,607,57"/>
</map>
</div>

</div>
</div>
<a id="abca5dd4cfb2140628e2a8f8be27aa2ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abca5dd4cfb2140628e2a8f8be27aa2ee">&#9670;&nbsp;</a></span>ds_to_cylinder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_cylinder </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structphoton.html">photon</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the distance a photon must travel to encouter a cylinder that is centered on the z axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>rho the size of the cylinder </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td>photon * p a photon ptr </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The smallest positive distance to the cylinder. If the ray does not hit the cylinder a VERY_BIG is returned.</dd></dl>
<p>Given a position and a direction the distance to a cylinder, solve the simple quadratic equation that gives the distance to the cylinder.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00940">940</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_cgraph.png" border="0" usemap="#phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_cgraph" alt=""/></div>
<map name="phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_cgraph" id="phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_cgraph">
<area shape="rect" id="node2" href="phot__util_8c.html#aba2cef648adc07ade76f313650e627ab" title="This solves a simple quadratic (or if a is zero linear) equation. " alt="" coords="140,5,203,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_icgraph.png" border="0" usemap="#phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_icgraph" alt=""/></div>
<map name="phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_icgraph" id="phot__util_8c_abca5dd4cfb2140628e2a8f8be27aa2ee_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a8bc3604c533b18b872bb155bfd444bb5" title="calculates the photon pathlength to the edge of the wind. " alt="" coords="140,31,212,57"/>
<area shape="rect" id="node3" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="260,5,365,32"/>
<area shape="rect" id="node5" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="263,56,363,83"/>
<area shape="rect" id="node4" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="413,31,473,57"/>
</map>
</div>

</div>
</div>
<a id="ae443765b508c1d69ac5249ef9de2bb81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae443765b508c1d69ac5249ef9de2bb81">&#9670;&nbsp;</a></span>ds_to_plane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_plane </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structplane.html">plane</a> *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structphoton.html">photon</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the distance of a photon must travel to hit the plane. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td>plane * pl A structure which descibes a plane in terms of a position and vector normal to the surface </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td>photon * p A photon </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The distance to the plane, or VERY_BIG if the photon does not hit the plane (in the positive direction)</dd></dl>
<p>Calcululate the distance a photon must travel to hit a plane. The plane, just for simplicity, is defined as a photon structure since you need both a point and a direction to define it. A plane can be defined by a position x_p and a normal lmn_p. If the photon ray is then defined by x=x_v+s lmn_v and the allowed values of s are determined by the equation</p>
<p>(x_v+s lmn_v - x_p) . lmn_p=0 where . implies the dot-product. The routine returns VERY_BIG if the photon ray does not intersect the plane .</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00794">794</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_cgraph.png" border="0" usemap="#phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_cgraph" alt=""/></div>
<map name="phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_cgraph" id="phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="131,5,170,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="129,56,172,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_icgraph.png" border="0" usemap="#phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_icgraph" alt=""/></div>
<map name="phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_icgraph" id="phot__util_8c_ae443765b508c1d69ac5249ef9de2bb81_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#afff91fbd2e4ab430bad432ecb529a28a" title="Calculates the distance that a photon would need to travel from its current position to hit disk..." alt="" coords="147,157,216,184"/>
<area shape="rect" id="node10" href="templates_8h.html#a8bc3604c533b18b872bb155bfd444bb5" title="calculates the photon pathlength to the edge of the wind. " alt="" coords="145,309,217,336"/>
<area shape="rect" id="node12" href="templates_8h.html#aa5efed3848af045bb3035fc6db93e757" title="Calculates the delay to the observer plane. " alt="" coords="129,360,233,387"/>
<area shape="rect" id="node16" href="templates_8h.html#a3a6359a23f10596d6bb51c80905c1c88" title="Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary..." alt="" coords="156,411,207,437"/>
<area shape="rect" id="node3" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="298,5,370,32"/>
<area shape="rect" id="node4" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="463,31,515,57"/>
<area shape="rect" id="node5" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="284,259,384,285"/>
<area shape="rect" id="node7" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="312,107,356,133"/>
<area shape="rect" id="node8" href="sv_8c.html#a2e62e3c36e76963e8e9f69b82329d447" title="Calulate the v of a Schlossman Vitello wind at a position x. " alt="" coords="299,157,369,184"/>
<area shape="rect" id="node9" href="sv_8c.html#abde80034508a0a977d22a060696a8b7e" title="Calculate the density of an sv_wind at a position x. " alt="" coords="463,183,515,209"/>
<area shape="rect" id="node6" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="459,259,519,285"/>
<area shape="rect" id="node11" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="281,309,387,336"/>
<area shape="rect" id="node13" href="templates_8h.html#ac0ede87d97addcd4c5df57e2930dbdb6" title="Dumps tracked photons to file. " alt="" coords="296,360,372,387"/>
<area shape="rect" id="node14" href="templates_8h.html#a835e66c48118aa52e1903512ed676f20" title="Finishes dumping tracked photons to file. " alt="" coords="436,385,541,412"/>
<area shape="rect" id="node15" href="templates_8h.html#a30c0a9051caebba27b5ef5583d38ad0c" title="Preps a single photon to be dumped. " alt="" coords="435,335,543,361"/>
<area shape="rect" id="node17" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="290,411,378,437"/>
<area shape="rect" id="node18" href="templates_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="292,461,376,488"/>
</map>
</div>

</div>
</div>
<a id="a67e3cb7a7d0cd3d55277fc4f3373fe2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67e3cb7a7d0cd3d55277fc4f3373fe2e">&#9670;&nbsp;</a></span>ds_to_sphere()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_sphere </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structphoton.html">photon</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the pathlenth along a line of sight defined by a photon p to a sphere centered on the origin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>r The radius of the sphere </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td>photon * p The photon </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The distance to the sphere. If the photon does not hit the sphere return a large number VERY_BIG</dd></dl>
<p>The routine simply solves the quadratic equation for calculating the distance to the sphere. It returns the smalles positive root</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00531">531</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_cgraph.png" border="0" usemap="#phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_cgraph" alt=""/></div>
<map name="phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_cgraph" id="phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="148,5,187,32"/>
<area shape="rect" id="node3" href="phot__util_8c.html#aba2cef648adc07ade76f313650e627ab" title="This solves a simple quadratic (or if a is zero linear) equation. " alt="" coords="136,56,199,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_icgraph.png" border="0" usemap="#phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_icgraph" alt=""/></div>
<map name="phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_icgraph" id="phot__util_8c_a67e3cb7a7d0cd3d55277fc4f3373fe2e_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#afff91fbd2e4ab430bad432ecb529a28a" title="Calculates the distance that a photon would need to travel from its current position to hit disk..." alt="" coords="157,183,227,209"/>
<area shape="rect" id="node7" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="327,309,371,336"/>
<area shape="rect" id="node10" href="templates_8h.html#a8bc3604c533b18b872bb155bfd444bb5" title="calculates the photon pathlength to the edge of the wind. " alt="" coords="156,56,228,83"/>
<area shape="rect" id="node12" href="templates_8h.html#a68cff92e2a36ec9073dbecabffa5543b" title="calculates the distance to the far boundary of the cell in which the photon bundle resides..." alt="" coords="143,284,241,311"/>
<area shape="rect" id="node13" href="templates_8h.html#a3810d91d16158ce91d1247c4df1ede09" title="calculates the distance to the far boundary of the cell in which the photon bundle resides..." alt="" coords="136,335,248,361"/>
<area shape="rect" id="node3" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="313,157,385,184"/>
<area shape="rect" id="node4" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="453,120,505,147"/>
<area shape="rect" id="node5" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="299,56,399,83"/>
<area shape="rect" id="node8" href="sv_8c.html#a2e62e3c36e76963e8e9f69b82329d447" title="Calulate the v of a Schlossman Vitello wind at a position x. " alt="" coords="313,208,384,235"/>
<area shape="rect" id="node9" href="sv_8c.html#abde80034508a0a977d22a060696a8b7e" title="Calculate the density of an sv_wind at a position x. " alt="" coords="453,233,505,260"/>
<area shape="rect" id="node6" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="449,44,509,71"/>
<area shape="rect" id="node11" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="296,5,401,32"/>
</map>
</div>

</div>
</div>
<a id="a8656562abff4020df988426338e79eca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8656562abff4020df988426338e79eca">&#9670;&nbsp;</a></span>ds_to_sphere2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ds_to_sphere2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structphoton.html">photon</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the positive distance to a sphere centered at x with radius r. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>x[] The center of the sphere </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>r The radius of the sphere </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">struct</td><td>photon * p A photon </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The distance to the sphere. If the photon does not hit the sphere return a large number VERY_BIG</dd></dl>
<p>The routine simply solves the quadratic equation for calculating the distance to the sphere. It returns the smalles positive root</p>
<h3>Notes</h3>
<p>It is not clear we need two routines like this, one which assumes that the sphere is centered on 0 and one which does not. </p>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00605">605</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a8656562abff4020df988426338e79eca_cgraph.png" border="0" usemap="#phot__util_8c_a8656562abff4020df988426338e79eca_cgraph" alt=""/></div>
<map name="phot__util_8c_a8656562abff4020df988426338e79eca_cgraph" id="phot__util_8c_a8656562abff4020df988426338e79eca_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="153,5,192,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="151,56,194,83"/>
<area shape="rect" id="node4" href="phot__util_8c.html#aba2cef648adc07ade76f313650e627ab" title="This solves a simple quadratic (or if a is zero linear) equation. " alt="" coords="141,107,204,133"/>
</map>
</div>

</div>
</div>
<a id="a8f17a1e86112f24760862d998129d91c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f17a1e86112f24760862d998129d91c">&#9670;&nbsp;</a></span>move_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int move_phot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>move a photon by a distance ds </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>pp A photon bundle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>ds The distance to move the photon </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The routine simply updates the position x of the photon using the current direction and the distance.</p>
<p>The path length for the photon is also updated for use in reverberation calculations</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00101">101</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a8f17a1e86112f24760862d998129d91c_icgraph.png" border="0" usemap="#phot__util_8c_a8f17a1e86112f24760862d998129d91c_icgraph" alt=""/></div>
<map name="phot__util_8c_a8f17a1e86112f24760862d998129d91c_icgraph" id="phot__util_8c_a8f17a1e86112f24760862d998129d91c_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#afff91fbd2e4ab430bad432ecb529a28a" title="Calculates the distance that a photon would need to travel from its current position to hit disk..." alt="" coords="293,193,362,220"/>
<area shape="rect" id="node3" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="447,67,519,93"/>
<area shape="rect" id="node4" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="603,67,655,93"/>
<area shape="rect" id="node5" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="433,472,533,499"/>
<area shape="rect" id="node7" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="461,269,505,296"/>
<area shape="rect" id="node8" href="sv_8c.html#a2e62e3c36e76963e8e9f69b82329d447" title="Calulate the v of a Schlossman Vitello wind at a position x. " alt="" coords="447,117,518,144"/>
<area shape="rect" id="node9" href="sv_8c.html#abde80034508a0a977d22a060696a8b7e" title="Calculate the density of an sv_wind at a position x. " alt="" coords="603,219,655,245"/>
<area shape="rect" id="node10" href="templates_8h.html#a625372b64e082ea4b46de6f8be0e385f" title="Calculate the change in disk height as s function of s. " alt="" coords="143,168,209,195"/>
<area shape="rect" id="node11" href="templates_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="141,421,211,448"/>
<area shape="rect" id="node12" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="275,421,380,448"/>
<area shape="rect" id="node13" href="templates_8h.html#a8bc3604c533b18b872bb155bfd444bb5" title="calculates the photon pathlength to the edge of the wind. " alt="" coords="140,472,212,499"/>
<area shape="rect" id="node14" href="py__wind__sub_8c.html#a55b115ab89dcad8e8f00bfc49dd4a158" title="get_los_dvds" alt="" coords="135,573,217,600"/>
<area shape="rect" id="node16" href="templates_8h.html#adb025e0891ad334d41481551bf785170" title="updates the field parameters in the wind and reduces the weight of the photon as a result of the effe..." alt="" coords="146,624,206,651"/>
<area shape="rect" id="node17" href="templates_8h.html#adc18086c9912f51dae0f13aef98278de" title="p) attempts to assure that a photon is not scattered a second time inappropriately by the same transi..." alt="" coords="143,675,209,701"/>
<area shape="rect" id="node18" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="137,725,215,752"/>
<area shape="rect" id="node19" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="585,884,673,911"/>
<area shape="rect" id="node20" href="templates_8h.html#a3a6359a23f10596d6bb51c80905c1c88" title="Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary..." alt="" coords="151,877,201,904"/>
<area shape="rect" id="node22" href="templates_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="157,776,195,803"/>
<area shape="rect" id="node30" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="125,1055,227,1081"/>
<area shape="rect" id="node6" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="599,447,659,473"/>
<area shape="rect" id="node15" href="py__wind__sub_8c.html#a758f8ee1d31c6812ffa74189ccb23e36" title="dvds_summary" alt="" coords="283,573,372,600"/>
<area shape="rect" id="node21" href="templates_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="285,877,369,904"/>
<area shape="rect" id="node23" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="875,751,957,777"/>
<area shape="rect" id="node24" href="templates_8h.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="299,725,356,752"/>
<area shape="rect" id="node25" href="templates_8h.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="459,1029,506,1056"/>
<area shape="rect" id="node29" href="templates_8h.html#a7b0bed5d82ce2310bbd039704b3567cd" title="Calculate the second derivative of the Roche potential of the secondary. " alt="" coords="449,776,517,803"/>
<area shape="rect" id="node28" href="templates_8h.html#aa72cfd7beaead2acdb08bb12eafa3197" title="Calculate the first and second derivative of the roche potential along a specific line of sight..." alt="" coords="592,725,667,752"/>
<area shape="rect" id="node26" href="templates_8h.html#aa6c77132d4fe5cdf4cb3d66186981228" title="Calculate the width of the Roche potentiil at a position x along the x axis. " alt="" coords="591,960,667,987"/>
<area shape="rect" id="node27" href="templates_8h.html#ad958df4fd3f6dd7f4ff01882d407c6c6" title="Find the half width of the secondary Roche lobe. " alt="" coords="721,897,827,924"/>
<area shape="rect" id="node31" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="293,1080,362,1107"/>
<area shape="rect" id="node32" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="428,1080,537,1107"/>
<area shape="rect" id="node33" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="440,1131,525,1157"/>
</map>
</div>

</div>
</div>
<a id="a56bcc4eb80e38e626fe58bb5c989eafd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56bcc4eb80e38e626fe58bb5c989eafd">&#9670;&nbsp;</a></span>phot_hist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int phot_hist </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iswitch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Record the history of a single photon bundle, in terms of a series of photon structures that are populated as the photon goes through the grid. </p>
<p>Unless phot_hist_on is true, then this routine is a NOP</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p A photon to track </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">int</td><td>iswitch A switch that resets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the number of photons which have been stored</dd></dl>
<p>This routine stores selected photons in an array, which one can use to see what is happening in a special case.</p>
<p>This is a diagnostic routine only</p>
<h3>Notes</h3>
<p>The routine is useful (at present) only in the context of a debugger since the array in which photons are stored is not written out. The basic idea is that one identifies a problem say with a specific photon and then stores the history of that photon in the array so once can inspect in detail what has happened to the photon.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000040">Bug:</a></b></dt><dd>It is not obvious that this routine is needed as we now have another mechanism to write photons out to a file. In any event, this should be moved to some other place in the code.</dd></dl>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00207">207</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_cgraph.png" border="0" usemap="#phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_cgraph" alt=""/></div>
<map name="phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_cgraph" id="phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_cgraph">
<area shape="rect" id="node2" href="phot__util_8c.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="116,5,181,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="127,56,171,83"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="599,56,656,83"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="229,81,303,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="351,68,440,95"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="373,119,417,145"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="500,56,539,83"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="488,107,551,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_icgraph.png" border="0" usemap="#phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_icgraph" alt=""/></div>
<map name="phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_icgraph" id="phot__util_8c_a56bcc4eb80e38e626fe58bb5c989eafd_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="117,31,192,57"/>
<area shape="rect" id="node8" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="116,81,193,108"/>
<area shape="rect" id="node3" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="241,31,293,57"/>
<area shape="rect" id="node4" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="491,31,560,57"/>
<area shape="rect" id="node7" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="341,56,443,83"/>
<area shape="rect" id="node5" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="608,5,717,32"/>
<area shape="rect" id="node6" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="620,56,705,83"/>
</map>
</div>

</div>
</div>
<a id="a13bf02e4a8315e90c84ae43b42fde4b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13bf02e4a8315e90c84ae43b42fde4b6">&#9670;&nbsp;</a></span>phot_history_summarize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int phot_history_summarize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The next routine is designed to update a portion of the PlasmaPtr to reflect where photons along the line of sight to the observer were absorbed in the wind. </p>
<p>&lt;NOTE: The [in, out] tag describes if the value of a parameter is used or altered. If it is used but not altered, delete 'OUT'. If the original value is not used and it is written to, delete 'IN'.&gt; </p><dl class="section return"><dt>Returns</dt><dd>??? RETURNS ???</dd></dl>
<p>??? DESCRIPTION ???</p>
<h3>Notes</h3>
<p>As photon is extracted from the wind, tau changes due to scatters and w changes due to absorption. We are just recording how much energy is absorbed by scatterng processes here, and so the energy absorbed is the current weight (exp(-tau_before) - exp (-tau_after)) </p>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00278">278</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_cgraph.png" border="0" usemap="#phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_cgraph" alt=""/></div>
<map name="phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_cgraph" id="phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="184,25,228,52"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="645,25,703,52"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="276,51,349,77"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="397,37,487,64"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="420,88,464,115"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="547,25,585,52"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="535,76,597,103"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_icgraph.png" border="0" usemap="#phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_icgraph" alt=""/></div>
<map name="phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_icgraph" id="phot__util_8c_a13bf02e4a8315e90c84ae43b42fde4b6_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="184,31,259,57"/>
<area shape="rect" id="node3" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="307,31,359,57"/>
<area shape="rect" id="node4" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="556,31,625,57"/>
<area shape="rect" id="node7" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="407,56,508,83"/>
<area shape="rect" id="node5" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="673,5,783,32"/>
<area shape="rect" id="node6" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="685,56,771,83"/>
</map>
</div>

</div>
</div>
<a id="aba2cef648adc07ade76f313650e627ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba2cef648adc07ade76f313650e627ab">&#9670;&nbsp;</a></span>quadratic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int quadratic </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__spherical_8c.html#a83175ac8fd9d924ff2bce40c99e88870">r</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This solves a simple quadratic (or if a is zero linear) equation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>a The constant which multiples x**2 in the quadratic equation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>b The constant which multiples x </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>c The constant </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">double</td><td>r[] The roots of the quadratic equation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The returns depend on the a status tha depends on the nature of the solutions The return is set up to make it easy to identify the smallest positive root if one exists. The routine returns a negative number if both roots are negative or imaginary. More specifically the routine returns<ul>
<li>-1 -&gt; both roots are imaginary</li>
<li>-2 -&gt; both roots are negative or 0</li>
<li>0 -&gt; the first root is the smallest positive root</li>
<li>1 -&gt; the second root is the smallest positive root</li>
</ul>
</dd></dl>
<p>The equation that is solved is ax**2+bx+c=0.</p>
<h3>Notes</h3>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00689">689</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_aba2cef648adc07ade76f313650e627ab_icgraph.png" border="0" usemap="#phot__util_8c_aba2cef648adc07ade76f313650e627ab_icgraph" alt=""/></div>
<map name="phot__util_8c_aba2cef648adc07ade76f313650e627ab_icgraph" id="phot__util_8c_aba2cef648adc07ade76f313650e627ab_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a4a0398c1230c6d21c5c51f4750ca2ea1" title="(cc, p) This is a new version of introduced in order to allow cylvar coordinates Eventually it is int..." alt="" coords="123,5,197,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a67e3cb7a7d0cd3d55277fc4f3373fe2e" title="Calculate the pathlenth along a line of sight defined by a photon p to a sphere centered on the origi..." alt="" coords="119,56,201,83"/>
<area shape="rect" id="node4" href="phot__util_8c.html#a8656562abff4020df988426338e79eca" title="Find the positive distance to a sphere centered at x with radius r. " alt="" coords="116,107,204,133"/>
<area shape="rect" id="node5" href="templates_8h.html#abca5dd4cfb2140628e2a8f8be27aa2ee" title="calculate the distance a photon must travel to encouter a cylinder that is centered on the z axis..." alt="" coords="117,157,203,184"/>
</map>
</div>

</div>
</div>
<a id="a1c6dc9c24a43e2bc6319b23faba4a041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6dc9c24a43e2bc6319b23faba4a041">&#9670;&nbsp;</a></span>stuff_phot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stuff_phot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simply copy one photon bundle into another. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>pin The photon bundle to be copied </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PhotPtr</td><td>pout The PhotPtr that contains the output </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>This just a simple utility to copy a photon bundle</p>
<h3>Notes</h3>
<p>All variables are (or should be) copied. </p>

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00046">46</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="phot__util_8c_a1c6dc9c24a43e2bc6319b23faba4a041_icgraph.png" border="0" usemap="#phot__util_8c_a1c6dc9c24a43e2bc6319b23faba4a041_icgraph" alt=""/></div>
<map name="phot__util_8c_a1c6dc9c24a43e2bc6319b23faba4a041_icgraph" id="phot__util_8c_a1c6dc9c24a43e2bc6319b23faba4a041_icgraph">
<area shape="rect" id="node2" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="141,107,204,133"/>
<area shape="rect" id="node8" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="301,157,353,184"/>
<area shape="rect" id="node9" href="templates_8h.html#a76f3cece46c92129a1e138a02aac87ca" title="calculates the weight of a photon in the wind that is forced to scatter along a specific line of sigh..." alt="" coords="133,360,213,387"/>
<area shape="rect" id="node10" href="templates_8h.html#a1aaecc045729b48d2ede700108567dcd" title="(w,pp,itype,nspec) " alt="" coords="290,360,365,387"/>
<area shape="rect" id="node11" href="templates_8h.html#a280fcbb3dddfaf58a73b2a8d6fd61c76" title="A supervisory routine called to builds detailed spectra in the normal (extract) mode. " alt="" coords="452,309,504,336"/>
<area shape="rect" id="node12" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="743,259,813,285"/>
<area shape="rect" id="node15" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="576,259,677,285"/>
<area shape="rect" id="node16" href="templates_8h.html#afff91fbd2e4ab430bad432ecb529a28a" title="Calculates the distance that a photon would need to travel from its current position to hit disk..." alt="" coords="293,487,362,513"/>
<area shape="rect" id="node21" href="templates_8h.html#acb71ca3a7e18d652d5eb0df69766c022" title="determines whether the photon has encountered the star of disk or reached the edges of the grid and r..." alt="" coords="456,575,500,601"/>
<area shape="rect" id="node24" href="templates_8h.html#a625372b64e082ea4b46de6f8be0e385f" title="Calculate the change in disk height as s function of s. " alt="" coords="139,461,206,488"/>
<area shape="rect" id="node25" href="templates_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="138,613,207,640"/>
<area shape="rect" id="node26" href="templates_8h.html#a56bcc4eb80e38e626fe58bb5c989eafd" title="Record the history of a single photon bundle, in terms of a series of photon structures that are popu..." alt="" coords="141,664,204,691"/>
<area shape="rect" id="node27" href="templates_8h.html#a4a0398c1230c6d21c5c51f4750ca2ea1" title="(cc, p) This is a new version of introduced in order to allow cylvar coordinates Eventually it is int..." alt="" coords="136,715,209,741"/>
<area shape="rect" id="node28" href="templates_8h.html#aa1ffd17034054d51819328d892fc57e8" title="translates the photon from its current position to the edge of the wind. " alt="" coords="275,791,380,817"/>
<area shape="rect" id="node29" href="templates_8h.html#a8bc3604c533b18b872bb155bfd444bb5" title="calculates the photon pathlength to the edge of the wind. " alt="" coords="137,765,209,792"/>
<area shape="rect" id="node30" href="py__wind__sub_8c.html#a55b115ab89dcad8e8f00bfc49dd4a158" title="get_los_dvds" alt="" coords="132,867,213,893"/>
<area shape="rect" id="node32" href="templates_8h.html#adb025e0891ad334d41481551bf785170" title="updates the field parameters in the wind and reduces the weight of the photon as a result of the effe..." alt="" coords="143,917,203,944"/>
<area shape="rect" id="node33" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="134,968,211,995"/>
<area shape="rect" id="node34" href="templates_8h.html#a30c0a9051caebba27b5ef5583d38ad0c" title="Preps a single photon to be dumped. " alt="" coords="119,1019,227,1045"/>
<area shape="rect" id="node35" href="templates_8h.html#aff5a3156ec26863e37ff61073bb97ca4" title="Calculate the distance to the Roche surface for a photon. " alt="" coords="583,1171,671,1197"/>
<area shape="rect" id="node36" href="templates_8h.html#ad4ca36cf5f0eaaa3fb044a982d922fb3" title="Find out whether a photon will hit the secondary, but don&#39;t actually calculate the point where it hit..." alt="" coords="285,1171,369,1197"/>
<area shape="rect" id="node37" href="templates_8h.html#a3a6359a23f10596d6bb51c80905c1c88" title="Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary..." alt="" coords="147,1120,198,1147"/>
<area shape="rect" id="node38" href="templates_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="153,1272,192,1299"/>
<area shape="rect" id="node3" href="templates_8h.html#a5b9038968dd801ac73806fcc16fc1f0c" title="generates photons within the wind between two freqencies and stores them in the photon array ..." alt="" coords="279,5,375,32"/>
<area shape="rect" id="node6" href="templates_8h.html#a4541dc581678aaea94bb9bdf0d38dfcf" title="produces photon packets to account for creating of r&#45;packets by k&#45;packets in the spectrum calculation..." alt="" coords="281,56,374,83"/>
<area shape="rect" id="node7" href="templates_8h.html#a7248f385000ac034fb3f0e3d5f45298f" title="produces photon packets to account for creation of r&#45;packets by deactivation of macro atoms in the sp..." alt="" coords="275,107,380,133"/>
<area shape="rect" id="node4" href="templates_8h.html#ab7f1c9362f29a0b44f41cff21494b6df" title="just makes photons " alt="" coords="440,5,516,32"/>
<area shape="rect" id="node5" href="templates_8h.html#aa943bd857500a1f2937d8b97d84ff633" title="the controlling routine for creating the underlying photon distribution. " alt="" coords="589,5,664,32"/>
<area shape="rect" id="node13" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="879,284,988,311"/>
<area shape="rect" id="node14" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="891,233,976,260"/>
<area shape="rect" id="node17" href="knigge_8c.html#aff42023accb056ea7ba26ec712605562" title="Calculate the v at a postion in a KWD wind. " alt="" coords="442,372,514,399"/>
<area shape="rect" id="node18" href="knigge_8c.html#ab20600703e7e59707c2041ec1aae6f60" title="double (x) calculates the density of an kn_wind at a position x " alt="" coords="601,385,653,412"/>
<area shape="rect" id="node19" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="428,740,528,767"/>
<area shape="rect" id="node22" href="sv_8c.html#a2e62e3c36e76963e8e9f69b82329d447" title="Calulate the v of a Schlossman Vitello wind at a position x. " alt="" coords="443,473,513,500"/>
<area shape="rect" id="node23" href="sv_8c.html#abde80034508a0a977d22a060696a8b7e" title="Calculate the density of an sv_wind at a position x. " alt="" coords="601,499,653,525"/>
<area shape="rect" id="node20" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="597,765,657,792"/>
<area shape="rect" id="node31" href="py__wind__sub_8c.html#a758f8ee1d31c6812ffa74189ccb23e36" title="dvds_summary" alt="" coords="283,867,372,893"/>
<area shape="rect" id="node39" href="templates_8h.html#a22069934602644cf4f894c0b48967d49" title="From the masses and period, setup the information one needs to calculate the position of the Roche lo..." alt="" coords="892,1348,975,1375"/>
<area shape="rect" id="node40" href="templates_8h.html#aa85d6bb7bef49e7e4b18d238eb2e6430" title="Calculate the gradient of the Roche potential as the photon travels. " alt="" coords="299,1323,356,1349"/>
<area shape="rect" id="node41" href="templates_8h.html#a9c51519f54c26122775ef8eaca1806d8" title="Calculate the value of the Roche potential and its derivative along a particular lien of sight..." alt="" coords="455,1272,501,1299"/>
<area shape="rect" id="node45" href="templates_8h.html#a7b0bed5d82ce2310bbd039704b3567cd" title="Calculate the second derivative of the Roche potential of the secondary. " alt="" coords="444,1373,512,1400"/>
<area shape="rect" id="node44" href="templates_8h.html#aa72cfd7beaead2acdb08bb12eafa3197" title="Calculate the first and second derivative of the roche potential along a specific line of sight..." alt="" coords="589,1323,664,1349"/>
<area shape="rect" id="node42" href="templates_8h.html#aa6c77132d4fe5cdf4cb3d66186981228" title="Calculate the width of the Roche potentiil at a position x along the x axis. " alt="" coords="589,1221,665,1248"/>
<area shape="rect" id="node43" href="templates_8h.html#ad958df4fd3f6dd7f4ff01882d407c6c6" title="Find the half width of the secondary Roche lobe. " alt="" coords="725,1221,831,1248"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0791b17bafbcf6e30d7bbeffa2c1cec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0791b17bafbcf6e30d7bbeffa2c1cec4">&#9670;&nbsp;</a></span>init_stuff_phot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_stuff_phot = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00025">25</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>

</div>
</div>
<a id="ad063cb5ecb88d7c02392bcb4b84a942d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad063cb5ecb88d7c02392bcb4b84a942d">&#9670;&nbsp;</a></span>sizeofphot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t sizeofphot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="phot__util_8c_source.html#l00026">26</a> of file <a class="el" href="phot__util_8c_source.html">phot_util.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="phot__util_8c.html">phot_util.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
