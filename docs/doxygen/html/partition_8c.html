<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/partition.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('partition_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">partition.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file includes calculations of partition functions for ions in plasma cells under a number of assumptions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for partition.c:</div>
<div class="dyncontent">
<div class="center"><img src="partition_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2partition_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2partition_8c" id="_2_users_2mhewitt_2python_2source_2partition_8c">
<area shape="rect" id="node6" href="atomic_8h.html" title="atomic.h" alt="" coords="315,95,375,121"/>
<area shape="rect" id="node7" href="python_8h.html" title="python.h" alt="" coords="399,95,459,121"/>
<area shape="rect" id="node8" href="log_8h.html" title="log.h" alt="" coords="283,169,327,196"/>
<area shape="rect" id="node9" href="version_8h.html" title="version.h" alt="" coords="351,169,413,196"/>
<area shape="rect" id="node10" href="templates_8h.html" title="templates.h" alt="" coords="437,169,511,196"/>
<area shape="rect" id="node11" href="recipes_8h.html" title="recipes.h" alt="" coords="535,169,597,196"/>
</map>
</div>
</div>
<p><a href="partition_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a37c9b91e3450874eb15cef76079f344d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="partition_8c.html#a37c9b91e3450874eb15cef76079f344d">partition_functions</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int mode)</td></tr>
<tr class="memdesc:a37c9b91e3450874eb15cef76079f344d"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations  <a href="#a37c9b91e3450874eb15cef76079f344d">More...</a><br /></td></tr>
<tr class="separator:a37c9b91e3450874eb15cef76079f344d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de3c1f3e0adc389cfda580a1003a688"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="partition_8c.html#a2de3c1f3e0adc389cfda580a1003a688">partition_functions_2</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, int xnion, double temp, double weight)</td></tr>
<tr class="memdesc:a2de3c1f3e0adc389cfda580a1003a688"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the partition functions for a pair of ions at a given temperature.  <a href="#a2de3c1f3e0adc389cfda580a1003a688">More...</a><br /></td></tr>
<tr class="separator:a2de3c1f3e0adc389cfda580a1003a688"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file includes calculations of partition functions for ions in plasma cells under a number of assumptions. </p>
<dl class="section author"><dt>Author</dt><dd>ksl,nsh </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April 2018</dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000038">Bug:</a></b></dt><dd>It seems likely that this file and <a class="el" href="levels_8c.html" title="This file contains a routine to calculate level populations in ions for LTE and related assumptions...">levels.c</a> should be combined into a single file. There are very comments (by nsh) about eliminating some of the modes that need investigation as well. </dd></dl>

<p class="definition">Definition in file <a class="el" href="partition_8c_source.html">partition.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a37c9b91e3450874eb15cef76079f344d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37c9b91e3450874eb15cef76079f344d">&#9670;&nbsp;</a></span>partition_functions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int partition_functions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma A plasma cell in the wind </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>mode An integer which determines the way in which the partition funciton will be calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The possibilites are:</p><ul>
<li>NEBULARMODE_TR 0 LTE using t_r</li>
<li>NEBULARMODE_TE 1 LTE using t_e</li>
<li>NEBULARMODE_ML93 2 ML93 using a nebular approximation correction to LTE</li>
<li>NEBULARMODE_NLTE_SIM 3 // Non_LTE with SS modification (Probably could be removed)</li>
<li>NEBULARMODE_LTE_GROUND 4 // A mode which forces all levels to the GS - this is used when we are modelling J_nu.</li>
</ul>
<h3>Notes</h3>
<p>0800802 - This is a rewritten version of two routines, do_partitions and partition. It is still true that levels is almost identical to some of the code here and therefore it is unclear why it is needed. levels is always called from partition_functions </p>

<p class="definition">Definition at line <a class="el" href="partition_8c_source.html#l00109">109</a> of file <a class="el" href="partition_8c_source.html">partition.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="partition_8c_a37c9b91e3450874eb15cef76079f344d_cgraph.png" border="0" usemap="#partition_8c_a37c9b91e3450874eb15cef76079f344d_cgraph" alt=""/></div>
<map name="partition_8c_a37c9b91e3450874eb15cef76079f344d_cgraph" id="partition_8c_a37c9b91e3450874eb15cef76079f344d_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="158,14,202,41"/>
<area shape="rect" id="node9" href="foo_8h.html#a2ba8dcf484d3688f9687d48dd865dc0d" title="Calculates the fractional occupation numbers of the various of atomic configurations assuming LTE or ..." alt="" coords="156,65,204,92"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="621,28,679,54"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="252,53,325,80"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="373,40,463,66"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="396,90,440,117"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="523,28,561,54"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="511,78,573,105"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="partition_8c_a37c9b91e3450874eb15cef76079f344d_icgraph.png" border="0" usemap="#partition_8c_a37c9b91e3450874eb15cef76079f344d_icgraph" alt=""/></div>
<map name="partition_8c_a37c9b91e3450874eb15cef76079f344d_icgraph" id="partition_8c_a37c9b91e3450874eb15cef76079f344d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a044bda6029c9b8057f77a920a61ce525" title="Allows a previous windsave to be used in a new hydro simulation. " alt="" coords="186,5,267,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a1e569c92136f73f8643f20d8fb43f544" title="A matrix solver for the ionization state in a cell. " alt="" coords="164,56,289,83"/>
<area shape="rect" id="node4" href="templates_8h.html#a74e9a1ed7ffcb66086ca24b9cc1d280f" title="is a routine which prints information about departure coefficients and level populations in a cell..." alt="" coords="175,107,278,133"/>
<area shape="rect" id="node6" href="py__wind__macro_8c.html#aad71ef4970632e72236ffe2ca6095e1a" title="gives populations of nconfig in each cell " alt="" coords="156,157,297,184"/>
<area shape="rect" id="node7" href="py__wind__macro_8c.html#ad6e2a0d37288f7f51afea6c8a0d95347" title="is a routine which prints information about departure coefficients and level populations in a cell..." alt="" coords="172,208,281,235"/>
<area shape="rect" id="node8" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="345,309,471,336"/>
<area shape="rect" id="node9" href="templates_8h.html#ad350a11e70a4518fb86b842942575e26" title="sets the concentrations of individual ions assuming hard coded ionization fractions that are read fro..." alt="" coords="175,309,278,336"/>
<area shape="rect" id="node10" href="variable__temperature_8c.html#a72d9769510683e30aeef87c2a255ebe4" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="169,360,285,387"/>
<area shape="rect" id="node5" href="py__wind__macro_8c.html#a6e3344441d509e05ca1c82b37fd88318" title="is a routine intended to allow one to display information about macro atoms. It is the top level rout..." alt="" coords="360,157,456,184"/>
</map>
</div>

</div>
</div>
<a id="a2de3c1f3e0adc389cfda580a1003a688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de3c1f3e0adc389cfda580a1003a688">&#9670;&nbsp;</a></span>partition_functions_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int partition_functions_2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xnion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the partition functions for a pair of ions at a given temperature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma - the cell we are interested in. Used to communicate back </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>xnion The ion number for the upper ion of a pair </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>temp the temperature we are using for the saha equation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>weight The ratio of the intensity of the radiation field to that of a BB </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>changes the partition functions of just two ions we are currently working on</dd></dl>
<pre class="fragment">This routine is used 
to support the pairwise ioinization state calculations where 
the saha equation is applied to a pair of states at a
temperature, then corrected. Part of this is 
a requirement to get the partition functions at that 
temperature for just two states of interest. It is 
wasteful to calculate all of the states at each temperature.

The results are stored in xplasma-&gt;partition[nion]
</pre><h3>Notes</h3>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000039">Bug:</a></b></dt><dd>According to the historical notes, there is no need for the weight term in the calculation since this is only called when we are making the assumption that we are in LTE for the saha equation.</dd></dl>
<p>One of the ways in which this routine differs from partition_functions is that here the temperature and weight are passed to the routing directly instead of being taken from the Plasma structure. </p>

<p class="definition">Definition at line <a class="el" href="partition_8c_source.html#l00299">299</a> of file <a class="el" href="partition_8c_source.html">partition.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="partition_8c_a2de3c1f3e0adc389cfda580a1003a688_icgraph.png" border="0" usemap="#partition_8c_a2de3c1f3e0adc389cfda580a1003a688_icgraph" alt=""/></div>
<map name="partition_8c_a2de3c1f3e0adc389cfda580a1003a688_icgraph" id="partition_8c_a2de3c1f3e0adc389cfda580a1003a688_icgraph">
<area shape="rect" id="node2" href="variable__temperature_8c.html#a72d9769510683e30aeef87c2a255ebe4" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="168,5,284,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a63d5795e0b9978d33ed61a63917004e2" title="modifies the densities of ions, levels, and partition functions of ions within a cell of the wind bas..." alt="" coords="332,5,457,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="partition_8c.html">partition.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
