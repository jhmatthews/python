<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Python MCRT: /Users/mhewitt/python/source/resonate.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Python MCRT
   </div>
   <div id="projectbrief">A Monte Carlo radiative transfer and ionization code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('resonate_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">resonate.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>These routines have to do with calculating where resonances are and how strong they are.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="atomic_8h_source.html">atomic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="python_8h_source.html">python.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for resonate.c:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c__incl.png" border="0" usemap="#_2_users_2mhewitt_2python_2source_2resonate_8c" alt=""/></div>
<map name="_2_users_2mhewitt_2python_2source_2resonate_8c" id="_2_users_2mhewitt_2python_2source_2resonate_8c">
<area shape="rect" id="node5" href="atomic_8h.html" title="atomic.h" alt="" coords="236,95,296,121"/>
<area shape="rect" id="node6" href="python_8h.html" title="python.h" alt="" coords="320,95,380,121"/>
<area shape="rect" id="node7" href="log_8h.html" title="log.h" alt="" coords="204,169,248,196"/>
<area shape="rect" id="node8" href="version_8h.html" title="version.h" alt="" coords="272,169,335,196"/>
<area shape="rect" id="node9" href="templates_8h.html" title="templates.h" alt="" coords="359,169,432,196"/>
<area shape="rect" id="node10" href="recipes_8h.html" title="recipes.h" alt="" coords="456,169,519,196"/>
</map>
</div>
</div>
<p><a href="resonate_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9abacb792fc41f73a200f8a725c40189"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#a9abacb792fc41f73a200f8a725c40189">calculate_ds</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> w, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, double tau_scat, double *tau, int *<a class="el" href="python_8h.html#ac1f90b11b79f8d2c9a25f12643063ee7">nres</a>, double smax, int *istat)</td></tr>
<tr class="memdesc:a9abacb792fc41f73a200f8a725c40189"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the distance a photon can travel within a single shell without scattering  <a href="#a9abacb792fc41f73a200f8a725c40189">More...</a><br /></td></tr>
<tr class="separator:a9abacb792fc41f73a200f8a725c40189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc43b4ba5a867bfdfb8f3c05a70f20a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#adcc43b4ba5a867bfdfb8f3c05a70f20a">select_continuum_scattering_process</a> (double kap_cont, double kap_es, double kap_ff, <a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>)</td></tr>
<tr class="memdesc:adcc43b4ba5a867bfdfb8f3c05a70f20a"><td class="mdescLeft">&#160;</td><td class="mdescRight">determine what continuum process was that caused the scatter and returns this to the main routine.  <a href="#adcc43b4ba5a867bfdfb8f3c05a70f20a">More...</a><br /></td></tr>
<tr class="separator:adcc43b4ba5a867bfdfb8f3c05a70f20a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a983dcec5903b4aacfce1c770b20e4ba9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#a983dcec5903b4aacfce1c770b20e4ba9">kappa_bf</a> (<a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a> <a class="el" href="compton_8c.html#ad65f0d74fe764d3ecae5ec1a89d63f08">xplasma</a>, double freq, int macro_all)</td></tr>
<tr class="memdesc:a983dcec5903b4aacfce1c770b20e4ba9"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the bf opacity in a specific cell.  <a href="#a983dcec5903b4aacfce1c770b20e4ba9">More...</a><br /></td></tr>
<tr class="separator:a983dcec5903b4aacfce1c770b20e4ba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d7a0bd03f273ab50a2eabadb685b585"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#a7d7a0bd03f273ab50a2eabadb685b585">kbf_need</a> (double fmin, double fmax)</td></tr>
<tr class="memdesc:a7d7a0bd03f273ab50a2eabadb685b585"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes and stores the set of bound-free processes which make significiant contributions to the opacity in a grid cell.  <a href="#a7d7a0bd03f273ab50a2eabadb685b585">More...</a><br /></td></tr>
<tr class="separator:a7d7a0bd03f273ab50a2eabadb685b585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a836209a9286117cc7b27e3e6fa37ef8d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#a836209a9286117cc7b27e3e6fa37ef8d">sobolev</a> (<a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a> one, <a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>, double den_ion, struct <a class="el" href="structlines.html">lines</a> *lptr, double dvds)</td></tr>
<tr class="memdesc:a836209a9286117cc7b27e3e6fa37ef8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">double (p,w,l,dvds) calculates tau associated with a resonance, given the conditions in the wind and the direction of the photon.  <a href="#a836209a9286117cc7b27e3e6fa37ef8d">More...</a><br /></td></tr>
<tr class="separator:a836209a9286117cc7b27e3e6fa37ef8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229902e28b108e5c2bdf13468e5a7a98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#a229902e28b108e5c2bdf13468e5a7a98">doppler</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> pin, <a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> pout, <a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>, int <a class="el" href="python_8h.html#ac1f90b11b79f8d2c9a25f12643063ee7">nres</a>)</td></tr>
<tr class="memdesc:a229902e28b108e5c2bdf13468e5a7a98"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the shift given the direction of the incoming and outgoing photons and the local velocity of the wind  <a href="#a229902e28b108e5c2bdf13468e5a7a98">More...</a><br /></td></tr>
<tr class="separator:a229902e28b108e5c2bdf13468e5a7a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa6a9c682ca16156e768a39033e55c0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#adaa6a9c682ca16156e768a39033e55c0">scatter</a> (<a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a> p, int *<a class="el" href="python_8h.html#ac1f90b11b79f8d2c9a25f12643063ee7">nres</a>, int *nnscat)</td></tr>
<tr class="memdesc:adaa6a9c682ca16156e768a39033e55c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">determine a new direction and frequency for a photon that is in the wind  <a href="#adaa6a9c682ca16156e768a39033e55c0">More...</a><br /></td></tr>
<tr class="separator:adaa6a9c682ca16156e768a39033e55c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5deef7c8b73403644c329ff506b57d1f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structphoton.html">photon</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#a5deef7c8b73403644c329ff506b57d1f">cds_phot_old</a></td></tr>
<tr class="separator:a5deef7c8b73403644c329ff506b57d1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d7095a3c0c7f94b1656f41223897ee"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#a47d7095a3c0c7f94b1656f41223897ee">cds_v2_old</a></td></tr>
<tr class="separator:a47d7095a3c0c7f94b1656f41223897ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa632d961a70777605bd2333b14f501d1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resonate_8c.html#aa632d961a70777605bd2333b14f501d1">cds_dvds2_old</a></td></tr>
<tr class="separator:aa632d961a70777605bd2333b14f501d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>These routines have to do with calculating where resonances are and how strong they are. </p>
<dl class="section author"><dt>Author</dt><dd>ksl </dd></dl>
<dl class="section date"><dt>Date</dt><dd>May, 2018</dd></dl>
<h3>Notes</h3>
<p>These routines should be made geometry independent and therefore should work with very minor (header only) modifications in other configurations. </p>

<p class="definition">Definition in file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9abacb792fc41f73a200f8a725c40189"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9abacb792fc41f73a200f8a725c40189">&#9670;&nbsp;</a></span>calculate_ds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calculate_ds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_scat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>istat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the distance a photon can travel within a single shell without scattering </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>w the entire wind structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>p A photon (bundle) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>tau_scat the optical depth at which the photon will scatter </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">double</td><td>* tau Initially the current optical depth for the photon; finally the optical depth at the distance the photon can be moved. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* nres the number of the resonance if there was one, -1 if there was no resonant scatter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>smax the maximum distance the photon can travel in the cell </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* istat A flag indidicating whether the photon should scatter if it traels the distance estimated, 0 if no, TAU_SCAT if yes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The distance the photon can travel</dd></dl>
<p>calculate_ds finds the distance the photon can travel subject to a number of conditions, which include reach a distance where tau is the distance where a scatter can occur, or a maximum distance set to ensure we do not cross into another cell, or indeed to go so far that one is not sure that the velocity can be approximated as a linear function of distance.</p>
<p>The routine returns the distance that the photon can travel subject to these conditions and information about why the photon was halted at the distance it was halted.</p>
<h3>Notes</h3>
<p>Calculate_ds does not modify the p in any way!!</p>
<p>Any paramaters that depend explicitly on the coordinate gridding, such as the maximum distance the photon can travel before hitting the edge of the shell should be calculated outside of this routine. </p>

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00076">76</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a9abacb792fc41f73a200f8a725c40189_cgraph.png" border="0" usemap="#resonate_8c_a9abacb792fc41f73a200f8a725c40189_cgraph" alt=""/></div>
<map name="resonate_8c_a9abacb792fc41f73a200f8a725c40189_cgraph" id="resonate_8c_a9abacb792fc41f73a200f8a725c40189_cgraph">
<area shape="rect" id="node2" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="354,175,398,202"/>
<area shape="rect" id="node9" href="foo_8h.html#a54b6ecee57eb3cb519fde55290c02f1b" title="Compares two photons to determine whether they have the identical position and direction. " alt="" coords="169,479,241,506"/>
<area shape="rect" id="node10" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="171,530,239,556"/>
<area shape="rect" id="node11" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="186,580,225,607"/>
<area shape="rect" id="node12" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="173,631,238,658"/>
<area shape="rect" id="node13" href="foo_8h.html#a8f17a1e86112f24760862d998129d91c" title="move a photon by a distance ds " alt="" coords="169,682,241,708"/>
<area shape="rect" id="node14" href="compton_8c.html#a28be66a0a760ceb7b8394a5a8e7526af" title="computes the Klein Nishina cross section for a photon of frequency nu. " alt="" coords="165,732,245,759"/>
<area shape="rect" id="node15" href="foo_8h.html#a8cf338374390539709c962c60a953c3d" title="(freqmin,freqmax) sets the the current values of line_min and line_max in atomic.h which can be used ..." alt="" coords="173,783,238,810"/>
<area shape="rect" id="node16" href="resonate_8c.html#a983dcec5903b4aacfce1c770b20e4ba9" title="calculates the bf opacity in a specific cell. " alt="" coords="174,276,237,303"/>
<area shape="rect" id="node19" href="foo_8h.html#a03396c07d161ba11de4a87161c5b6745" title="calculates the free&#45;free opacity allowing for stimulated emission " alt="" coords="175,834,235,860"/>
<area shape="rect" id="node20" href="log_8h.html#a77b726226e13d98782bd4bc60bdc786a" title="Write an error message to the diag file. " alt="" coords="339,58,413,84"/>
<area shape="rect" id="node21" href="resonate_8c.html#adcc43b4ba5a867bfdfb8f3c05a70f20a" title="determine what continuum process was that caused the scatter and returns this to the main routine..." alt="" coords="131,109,280,150"/>
<area shape="rect" id="node23" href="density_8c.html#aa04bdf663883a5f18970d5bc1f996db2" title="finds the density of a specific ion designated by nion at a position " alt="" coords="330,327,422,354"/>
<area shape="rect" id="node25" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="171,884,240,911"/>
<area shape="rect" id="node26" href="resonate_8c.html#a836209a9286117cc7b27e3e6fa37ef8d" title="double (p,w,l,dvds) calculates tau associated with a resonance, given the conditions in the wind and ..." alt="" coords="177,327,233,354"/>
<area shape="rect" id="node28" href="balance__templates_8h.html#a56740476af61734dee90b4090f004971" title="walls" alt="" coords="183,935,227,962"/>
<area shape="rect" id="node29" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="163,986,248,1012"/>
<area shape="rect" id="node30" href="estimators_8c.html#aa85aa8b5ea483c44b26216b963015484" title="increment the matom bound&#45;bound estimators " alt="" coords="138,226,273,252"/>
<area shape="rect" id="node31" href="estimators_8c.html#a5dcca3c33cb0db12719fcc6a79958119" title="records the heating contribution from lines of simple elements. " alt="" coords="159,428,251,455"/>
<area shape="rect" id="node36" href="foo_8h.html#a56bcc4eb80e38e626fe58bb5c989eafd" title="Record the history of a single photon bundle, in terms of a series of photon structures that are popu..." alt="" coords="174,1036,237,1063"/>
<area shape="rect" id="node3" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="853,124,911,151"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="478,150,551,176"/>
<area shape="rect" id="node5" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="605,99,695,126"/>
<area shape="rect" id="node8" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="628,150,672,176"/>
<area shape="rect" id="node6" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="755,99,793,126"/>
<area shape="rect" id="node7" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="743,48,805,75"/>
<area shape="rect" id="node17" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="341,276,411,303"/>
<area shape="rect" id="node18" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="339,226,413,252"/>
<area shape="rect" id="node22" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="328,116,424,143"/>
<area shape="rect" id="node24" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3" title="coord_fraction" alt="" coords="472,327,557,354"/>
<area shape="rect" id="node27" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="330,378,422,404"/>
<area shape="rect" id="node32" href="foo_8h.html#ac84f4556e3972c1fe39b74fd9b7b4241" title="b12" alt="" coords="357,479,395,506"/>
<area shape="rect" id="node33" href="atomic_8c.html#a8c589bd3089b7851e8da407ad1ce44a5" title="Calculate the Einstein A coefficient for a transition. " alt="" coords="357,530,395,556"/>
<area shape="rect" id="node34" href="foo_8h.html#a3579026b8eac7743ef56ad21ff9696ff" title="Estimate the esccapte probability for a line in a plasma cell. " alt="" coords="343,580,409,607"/>
<area shape="rect" id="node35" href="foo_8h.html#a6daa97078321cf4f668d31b7004fed6c" title="calculates and returns the collisional de&#45;excitation coefficient q21 " alt="" coords="357,428,395,455"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a9abacb792fc41f73a200f8a725c40189_icgraph.png" border="0" usemap="#resonate_8c_a9abacb792fc41f73a200f8a725c40189_icgraph" alt=""/></div>
<map name="resonate_8c_a9abacb792fc41f73a200f8a725c40189_icgraph" id="resonate_8c_a9abacb792fc41f73a200f8a725c40189_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a0118547dede9b08b5ac6609b4313e3e8" title="translates the photon within a single cell in the wind. " alt="" coords="131,5,231,32"/>
<area shape="rect" id="node3" href="templates_8h.html#ae77272897af1eb8f6ebd0f7cfe2932e8" title="a steering routine that either calls _in_space or _in_wind depending upon the current location of the..." alt="" coords="279,5,339,32"/>
</map>
</div>

</div>
</div>
<a id="a229902e28b108e5c2bdf13468e5a7a98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a229902e28b108e5c2bdf13468e5a7a98">&#9670;&nbsp;</a></span>doppler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int doppler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>pout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__spherical_8c.html#ac2915aad3a05ff2328a7ad7fa6d37e86">v</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the shift given the direction of the incoming and outgoing photons and the local velocity of the wind </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PhotPtr</td><td>pin The pre-scattered photon (used for its direction) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>pout the scattered photon (used for its direction) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>v[] the velocity of the wind where the scatter occurred </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nres either the number of the scatter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>pout-&gt;freq is updated</p>
<p>Given the incoming and the outgoing photon direction, doppler calculates the outgoing frequency (to first order in beta). There are two basic cases, depending on whether it was a resonant or a nonresonant scatter.</p>
<h3>Notes</h3>
<p>Called from scatter </p>

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00899">899</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_cgraph.png" border="0" usemap="#resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_cgraph" alt=""/></div>
<map name="resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_cgraph" id="resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="112,5,151,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="109,56,153,83"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="571,56,628,83"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="201,81,275,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="323,68,412,95"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="345,119,389,145"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="472,56,511,83"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="460,107,523,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_icgraph.png" border="0" usemap="#resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_icgraph" alt=""/></div>
<map name="resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_icgraph" id="resonate_8c_a229902e28b108e5c2bdf13468e5a7a98_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#adaa6a9c682ca16156e768a39033e55c0" title="determine a new direction and frequency for a photon that is in the wind " alt="" coords="109,5,161,32"/>
</map>
</div>

</div>
</div>
<a id="a983dcec5903b4aacfce1c770b20e4ba9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a983dcec5903b4aacfce1c770b20e4ba9">&#9670;&nbsp;</a></span>kappa_bf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double kappa_bf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>macro_all</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the bf opacity in a specific cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma The plasma cell of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>freq The frequency at which the opacity is calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>macro_all 1&ndash;&gt; macro_atoms only, 0 all topbase ions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The bf opacity</dd></dl>
<h3>Notes</h3>
<p>The routine allows for clumping, reducing kappa_bf by the filling factor. </p>

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00585">585</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_cgraph.png" border="0" usemap="#resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_cgraph" alt=""/></div>
<map name="resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_cgraph" id="resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="117,5,188,32"/>
<area shape="rect" id="node3" href="atomic_8c.html#a107b53af4265eb649a0e2a483dc613da" title="double (x_ptr,freq) calculates the photionization crossection due to the transition associated with x..." alt="" coords="116,56,189,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_icgraph.png" border="0" usemap="#resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_icgraph" alt=""/></div>
<map name="resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_icgraph" id="resonate_8c_a983dcec5903b4aacfce1c770b20e4ba9_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="116,5,193,32"/>
</map>
</div>

</div>
</div>
<a id="a7d7a0bd03f273ab50a2eabadb685b585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d7a0bd03f273ab50a2eabadb685b585">&#9670;&nbsp;</a></span>kbf_need()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kbf_need </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes and stores the set of bound-free processes which make significiant contributions to the opacity in a grid cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>fmin the lowest frequency of interest to the calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>fmax the highest frequency of interest to the calculations </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The purpose of this routine is to speed up calculations by idenfifying which bound-free x-sections are important enough to be included when calculationg the bound-fee opacity, and which an be ignored because the denisty of the particular ion is so low it will not contribute.</p>
<p>For each cell, the routine determines what bf transitons are important and stores them in one-&gt;kbf_use[n].</p>
<p>The total number of such transitions is given in one-&gt;kbf_nuse.</p>
<p>This routine is now called before various cylces of the Monte Carlo calculation. (in <a class="el" href="run_8c.html" title="the driving routines to carry out calculation of the ionization of the plasma and also to extract det...">run.c</a>) * It determines which bf processes are worth considering during the calculation that follows.</p>
<p>To do this is uses the edge position (must be inside, or close to, the spectral region of interest) and the edge opacity (must be greater than a threshold value, currently 10^-6.</p>
<p>The need for the routine is just to prevent wasting time on unimportant bf transitions. It is called (currently from resonate).</p>
<h3>Notes</h3>
<p>The dimensionalty of kbf_use is currently set to NTOP_PHOT, which is large enough to store evey transition if necessary. </p>

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00682">682</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_cgraph.png" border="0" usemap="#resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_cgraph" alt=""/></div>
<map name="resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_cgraph" id="resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="116,5,187,32"/>
<area shape="rect" id="node3" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="127,56,176,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_icgraph.png" border="0" usemap="#resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_icgraph" alt=""/></div>
<map name="resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_icgraph" id="resonate_8c_a7d7a0bd03f273ab50a2eabadb685b585_icgraph">
<area shape="rect" id="node2" href="python_8c.html#afced8478b91af5c169926dfa4426333d" title="The main routine for Python, which supervises the ingest of data defining a model, the initializtion of the model, and actual run of the model, and writing the data to the disk. " alt="" coords="149,5,193,32"/>
<area shape="rect" id="node3" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="116,56,225,83"/>
<area shape="rect" id="node4" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="128,107,213,133"/>
</map>
</div>

</div>
</div>
<a id="adaa6a9c682ca16156e768a39033e55c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa6a9c682ca16156e768a39033e55c0">&#9670;&nbsp;</a></span>scatter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scatter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad2424d53ebcf811656882a87e11b440c">PhotPtr</a>&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nnscat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determine a new direction and frequency for a photon that is in the wind </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PhotPtr</td><td>p the photon of interest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>* nres either the number of the scatter or a nonresonant scatter if nres &lt; 0 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int</td><td>* nnscat Returned from anisotropic thermal scattering model </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Always returns 0</dd></dl>
<p>The results are stored in the PhotPtr p which contains the direction and frequency of the scattered photon.</p>
<p>The routine calculates a new direction and frequency for a photon in both the resonant and non-resonant cases. In the frame of the wind, scattering is assumed to be isotropic.</p>
<h3>Notes</h3>
<p>This is the routine that is called when a resonant scatter does occur. It is relevant for both simple and macro atoms</p>
<p>The equations for the frequency shifts are accurate only to first order in beta</p>
<p>This routine should not move the photon at all, because other routines need to take this photon in differing directions, and if one moves it here they may encounter this resonance again </p>

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00985">985</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_adaa6a9c682ca16156e768a39033e55c0_cgraph.png" border="0" usemap="#resonate_8c_adaa6a9c682ca16156e768a39033e55c0_cgraph" alt=""/></div>
<map name="resonate_8c_adaa6a9c682ca16156e768a39033e55c0_cgraph" id="resonate_8c_adaa6a9c682ca16156e768a39033e55c0_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a1c6dc9c24a43e2bc6319b23faba4a041" title="Simply copy one photon bundle into another. " alt="" coords="321,159,387,185"/>
<area shape="rect" id="node3" href="foo_8h.html#a1db4ad38f132371d7fe31fdd998ae53e" title="where_in_grid" alt="" coords="311,209,397,236"/>
<area shape="rect" id="node4" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="815,311,859,337"/>
<area shape="rect" id="node11" href="foo_8h.html#a7de597169a947d506f6d2210de2080ac" title="is a routine that will sit at a higher level in the code than either matom or kpkt and will govern th..." alt="" coords="141,1425,213,1452"/>
<area shape="rect" id="node12" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="141,1476,212,1503"/>
<area shape="rect" id="node13" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="475,665,571,692"/>
<area shape="rect" id="node14" href="foo_8h.html#a0063dc1e42150aa43a80ac17e3070b66" title="vwind_xyz" alt="" coords="143,1527,211,1553"/>
<area shape="rect" id="node15" href="foo_8h.html#a284ee938adda5964f70e57cf3517bb93" title="dot" alt="" coords="335,1527,373,1553"/>
<area shape="rect" id="node16" href="compton_8c.html#a9300319cf99a4a66db3876befda54050" title="computes a random direction for a photon undergoing compton scattering. " alt="" coords="138,1172,215,1199"/>
<area shape="rect" id="node18" href="foo_8h.html#a1881a8f6279e1472e741aab3ee654383" title="randvec" alt="" coords="325,1172,383,1199"/>
<area shape="rect" id="node19" href="foo_8h.html#a917f837a1598fc3307b17cceef5f4340" title="stuff_v" alt="" coords="328,1071,380,1097"/>
<area shape="rect" id="node26" href="foo_8h.html#ab14e3dce54237244859ed06cef6b5846" title="renorm" alt="" coords="327,1425,381,1452"/>
<area shape="rect" id="node27" href="anisowind_8c.html#aa02bd1c515967ac3e1214843158df2f4" title="calculate a new direction for the photon which is being scattered in the wind in the SCATTER_MODE_ANI..." alt="" coords="145,539,208,565"/>
<area shape="rect" id="node42" href="anisowind_8c.html#a5cc282e1f3d56ce0f29cb080bc225408" title="is the routine which chooses a new anisotropic direction in geo.scatter_mode = SCATTER_MODE_THERMAL ..." alt="" coords="105,792,248,819"/>
<area shape="rect" id="node45" href="resonate_8c.html#a229902e28b108e5c2bdf13468e5a7a98" title="calculate the shift given the direction of the incoming and outgoing photons and the local velocity o..." alt="" coords="149,1324,205,1351"/>
<area shape="rect" id="node46" href="foo_8h.html#a3b474f3933aeab1276e52e7ed441dfc1" title="vsub" alt="" coords="155,1577,198,1604"/>
<area shape="rect" id="node47" href="foo_8h.html#ad69e520ff4f237809642951e68cc645b" title="project_from_xyz_cyl" alt="" coords="119,1628,235,1655"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="1292,209,1349,236"/>
<area shape="rect" id="node6" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="923,209,996,236"/>
<area shape="rect" id="node7" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="1044,209,1133,236"/>
<area shape="rect" id="node10" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="1067,159,1111,185"/>
<area shape="rect" id="node8" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="1193,260,1232,287"/>
<area shape="rect" id="node9" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="1181,209,1244,236"/>
<area shape="rect" id="node17" href="foo_8h.html#a4a0210aea098f52ca60dfbc90de4ecee" title="Calculate the Roche potential at position indicated by the photon p_roche and the length s..." alt="" coords="335,1020,373,1047"/>
<area shape="rect" id="node20" href="compton_8c.html#add111df2de1b0fadab91816f33ee5266" title="is the Klein Nishina cross section as a function of the fractional energy change " alt="" coords="460,1349,585,1376"/>
<area shape="rect" id="node21" href="foo_8h.html#a8c30fbf58d7a0b5789604f00c96bedb6" title="A routine that finds the rooot of a function f. " alt="" coords="329,1273,379,1300"/>
<area shape="rect" id="node22" href="compton_8c.html#a9891de810e686fa36209796ff1704fa3" title="Function used to find the fractional energy change for a given cross&#45;section in the compton scatterin..." alt="" coords="311,1375,397,1401"/>
<area shape="rect" id="node23" href="foo_8h.html#a5acc98b72071d64f02e15f4975d03eb2" title="cross" alt="" coords="331,969,377,996"/>
<area shape="rect" id="node24" href="foo_8h.html#ab0b1a9d790b71c94f9562c567eeee268" title="create_basis" alt="" coords="315,868,393,895"/>
<area shape="rect" id="node25" href="foo_8h.html#a5672a43b959d7e6d398852cbc41ee6b1" title="project_from" alt="" coords="315,919,393,945"/>
<area shape="rect" id="node28" href="foo_8h.html#af9a097a1df32d54cc7161c02a07c7894" title="sobolev" alt="" coords="326,615,382,641"/>
<area shape="rect" id="node29" href="anisowind_8c.html#a62480c3fe99eaa0284c85a48b1e8427d" title="make_cdf_randwind" alt="" coords="298,311,410,337"/>
<area shape="rect" id="node35" href="log_8h.html#aaadbb20af7b628f26e81e4e49b1a379f" title="Check that a variable is valid double precision number. " alt="" coords="799,57,875,84"/>
<area shape="rect" id="node38" href="cdf_8c.html#a6cd473cda634a93562f9162b5c0c5f06" title="Generate a single sample from a cdf. " alt="" coords="314,463,394,489"/>
<area shape="rect" id="node40" href="foo_8h.html#a2252a3d2a1a36fbe8bef311e90ffd171" title="project_from_cyl_xyz" alt="" coords="296,513,412,540"/>
<area shape="rect" id="node41" href="foo_8h.html#a779ccebed86e21a9d217673baf5da757" title="length" alt="" coords="329,361,379,388"/>
<area shape="rect" id="node30" href="cdf_8c.html#a759a0a027603baae4d61eed58031a71b" title="Generate a cumulative distrubution function (cdf) from a function. " alt="" coords="469,260,577,287"/>
<area shape="rect" id="node37" href="anisowind_8c.html#af170ad39af01fbe3b232230692c2aa5e" title="the function that is used to generate the cdf for anisotropic scattering. " alt="" coords="658,57,726,84"/>
<area shape="rect" id="node31" href="cdf_8c.html#ac8e83990b5cf236827414abe43bee911" title="a simple routine to check some basics of the cumulative distribution function. " alt="" coords="659,159,725,185"/>
<area shape="rect" id="node34" href="cdf_8c.html#a55ee1475eba79ff70c6b97c836df25c7" title="generates a cdf from a function " alt="" coords="633,108,751,135"/>
<area shape="rect" id="node36" href="cdf_8c.html#a30c0717640ef307cbe5489ec9ef911f5" title="Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points..." alt="" coords="642,260,742,287"/>
<area shape="rect" id="node32" href="log_8h.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="817,108,856,135"/>
<area shape="rect" id="node33" href="cdf_8c.html#a31e0e0d8ba68a00590abef9754c8ea6b" title="Write the full structure of the cumulattive distribution function to a file. " alt="" coords="803,159,871,185"/>
<area shape="rect" id="node39" href="bilinear_8c.html#af582498786ae60301965c85d405d7cde" title="solves a quadratic of the form 0=ax**2+bx+c " alt="" coords="489,463,557,489"/>
<area shape="rect" id="node43" href="foo_8h.html#a07b4586a6bbe5e5633e165c6a9a55fb6" title="Given an optical depth estimate the escape probility. " alt="" coords="299,716,409,743"/>
<area shape="rect" id="node44" href="foo_8h.html#a96c552f69871659978a481c47617fc6c" title="find the gradient velocity vector v, dv_ds for a photon at a certain postion travelling in a certain ..." alt="" coords="319,767,389,793"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_adaa6a9c682ca16156e768a39033e55c0_icgraph.png" border="0" usemap="#resonate_8c_adaa6a9c682ca16156e768a39033e55c0_icgraph" alt=""/></div>
<map name="resonate_8c_adaa6a9c682ca16156e768a39033e55c0_icgraph" id="resonate_8c_adaa6a9c682ca16156e768a39033e55c0_icgraph">
<area shape="rect" id="node2" href="trans__phot_8c.html#a620388e1c4a8e38f192c5a0ce42af389" title="int (w,p,iextract) oversees the propagation of a &quot;flight&quot; of photons " alt="" coords="255,31,324,57"/>
<area shape="rect" id="node5" href="trans__phot_8c.html#a2f7b8208c76fe2718f45f46c9dc3a813" title="Transport a single photon photon through the wind. " alt="" coords="105,56,207,83"/>
<area shape="rect" id="node3" href="templates_8h.html#a28fc174aa63a5eeef6de99ef392e1616" title="run the ionization cycles for a python model " alt="" coords="372,5,481,32"/>
<area shape="rect" id="node4" href="templates_8h.html#abc2ad803345c801984f4dc64d4d4a9e0" title="generates the detailed spectra " alt="" coords="384,56,469,83"/>
</map>
</div>

</div>
</div>
<a id="adcc43b4ba5a867bfdfb8f3c05a70f20a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcc43b4ba5a867bfdfb8f3c05a70f20a">&#9670;&nbsp;</a></span>select_continuum_scattering_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int select_continuum_scattering_process </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kap_cont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kap_es</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kap_ff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="python_8h.html#a13ce7664e071685e1c3eaac3c32d7c8d">PlasmaPtr</a>&#160;</td>
          <td class="paramname"><em>xplasma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determine what continuum process was that caused the scatter and returns this to the main routine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>kap_cont The continuum opacity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>kap_es The electron scattering opacity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>kap_ff The free free opacity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PlasmaPtr</td><td>xplasma The plasma cell where everyting is being calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The process that cause the photon to stop/scatter at a particular point</dd></dl>
<p>This routine is called to determine which of several continuum proceseses cause a photon to be scattered or absorpbed. In addition to electron scattering and free-free absorption, the routine can identify which photoionization process is implicated.</p>
<h3>Notes</h3>
<p>select_continuum_scattering_proces is called when it has already been determined that a photon will stop or be scattered due to some continuum process. This determination is based on the total continuum opacity. In this routine a random number is generated and this is used to determine which of the processes was responsible. Data for the opacity due to photonionization is passed remotely via the PlasmaPtr. </p>

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00515">515</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_cgraph.png" border="0" usemap="#resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_cgraph" alt=""/></div>
<map name="resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_cgraph" id="resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a451b4740f3d1e12cb07885b0d3e5ef1b" title="Gets a random number from the generator set up in init_rand. " alt="" coords="203,5,299,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="229,56,273,83"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="716,56,773,83"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="347,81,420,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="468,68,557,95"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="491,119,535,145"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="617,56,656,83"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="605,107,668,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_icgraph.png" border="0" usemap="#resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_icgraph" alt=""/></div>
<map name="resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_icgraph" id="resonate_8c_adcc43b4ba5a867bfdfb8f3c05a70f20a_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="203,13,280,39"/>
</map>
</div>

</div>
</div>
<a id="a836209a9286117cc7b27e3e6fa37ef8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a836209a9286117cc7b27e3e6fa37ef8d">&#9670;&nbsp;</a></span>sobolev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sobolev </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="python_8h.html#ad957272e4ddecfb558775b2aeddf2ac4">WindPtr</a>&#160;</td>
          <td class="paramname"><em>one</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="import__cylindrical_8c.html#a099bc7b5a9501685180c163c1ffb67d0">x</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>den_ion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlines.html">lines</a> *&#160;</td>
          <td class="paramname"><em>lptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dvds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>double (p,w,l,dvds) calculates tau associated with a resonance, given the conditions in the wind and the direction of the photon. </p>
<p>It does not modify any of the variables that are passed to it, including for example the photon.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">WindPtr</td><td>one A single wind cell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>x[] A position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>den_ion The density of the ion. If less than 0, the routine calculates the density at x </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">struct</td><td>lines * lptr A pointer to a particular ion </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">double</td><td>dvds the velocity gradient in the direction of travel of the photon </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The optical depth associated with a transition</dd></dl>
<p>In the sobolev approx tau = PI e^2 / m_e c * NL * f * lambda * 1 / (|dv/dx|) where dv/ds is the velocity gradient in the direction the photon is travelling. This can be made slightly simpler by noting that lambda = freq / c and so tau = PI e^w / m_e</p>
<h3>Notes</h3>
<p>The routine includes a correcton for the filling factor which reduces tau </p>

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00775">775</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_cgraph.png" border="0" usemap="#resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_cgraph" alt=""/></div>
<map name="resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_cgraph" id="resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_cgraph">
<area shape="rect" id="node2" href="foo_8h.html#a234e98c30b4b66b1f72240a79d9f4d11" title="calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom..." alt="" coords="109,5,201,32"/>
<area shape="rect" id="node3" href="log_8h.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="133,56,177,83"/>
<area shape="rect" id="node10" href="foo_8h.html#a7a80c6ec538ad7bf2b546126bac374bf" title="returns the precalculated density of a particular &quot;nlte&quot; level. " alt="" coords="120,107,191,133"/>
<area shape="rect" id="node11" href="density_8c.html#aa04bdf663883a5f18970d5bc1f996db2" title="finds the density of a specific ion designated by nion at a position " alt="" coords="109,157,201,184"/>
<area shape="rect" id="node4" href="xlog_8c.html#aeb93dfd882dd6a658b86662e6e219a09" title="Open a log file. " alt="" coords="631,31,688,57"/>
<area shape="rect" id="node5" href="xlog_8c.html#aeaba9fb5d129e3ab9d5efa760206deff" title="track the number of errors of each type " alt="" coords="255,81,329,108"/>
<area shape="rect" id="node6" href="xlog_8c.html#a3d395705c83c0bda5aeee6a271fdfd47" title="Summarize the errors that have occurred. " alt="" coords="383,56,472,83"/>
<area shape="rect" id="node9" href="xlog_8c.html#a4f4caa375f1c3a9def422000f305cce5" title="Print/write out an error message. " alt="" coords="405,107,449,133"/>
<area shape="rect" id="node7" href="xlog_8c.html#a9a25be4f0d7d13fccc8457774d74167f" title="Print/write an informational message. " alt="" coords="532,31,571,57"/>
<area shape="rect" id="node8" href="log_8h.html#a488c6292e324fa9bd3793694c3d29826" title="message" alt="" coords="520,81,583,108"/>
<area shape="rect" id="node12" href="foo_8h.html#a3d923b8d7eb460585ecf6885222a69a3" title="coord_fraction" alt="" coords="249,157,335,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_icgraph.png" border="0" usemap="#resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_icgraph" alt=""/></div>
<map name="resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_icgraph" id="resonate_8c_a836209a9286117cc7b27e3e6fa37ef8d_icgraph">
<area shape="rect" id="node2" href="templates_8h.html#a9abacb792fc41f73a200f8a725c40189" title="calculate the distance a photon can travel within a single shell without scattering ..." alt="" coords="109,5,187,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa632d961a70777605bd2333b14f501d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa632d961a70777605bd2333b14f501d1">&#9670;&nbsp;</a></span>cds_dvds2_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cds_dvds2_old</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00031">31</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>

</div>
</div>
<a id="a5deef7c8b73403644c329ff506b57d1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5deef7c8b73403644c329ff506b57d1f">&#9670;&nbsp;</a></span>cds_phot_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structphoton.html">photon</a> cds_phot_old</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00030">30</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>

</div>
</div>
<a id="a47d7095a3c0c7f94b1656f41223897ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d7095a3c0c7f94b1656f41223897ee">&#9670;&nbsp;</a></span>cds_v2_old</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cds_v2_old</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="resonate_8c_source.html#l00031">31</a> of file <a class="el" href="resonate_8c_source.html">resonate.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="resonate_8c.html">resonate.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
