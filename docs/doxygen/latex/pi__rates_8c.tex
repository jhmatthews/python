\hypertarget{pi__rates_8c}{}\section{/\+Users/mhewitt/python/source/pi\+\_\+rates.c File Reference}
\label{pi__rates_8c}\index{/\+Users/mhewitt/python/source/pi\+\_\+rates.\+c@{/\+Users/mhewitt/python/source/pi\+\_\+rates.\+c}}


Routines associated with calculating photionization rates.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for pi\+\_\+rates.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{pi__rates_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{pi__rates_8c_ae8bab77755879541eaede60436cfbda2}{calc\+\_\+pi\+\_\+rate} (int nion, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode, int type)
\begin{DoxyCompactList}\small\item\em int calculates the photoionization rate coefficient for an ion in a given cell \end{DoxyCompactList}\item 
double \hyperlink{pi__rates_8c_ae2e3418a581094a1c02352db778e3d12}{tb\+\_\+planck1} (double freq)
\begin{DoxyCompactList}\small\item\em The integrand for working out the PI rate in a BB radiation field. \end{DoxyCompactList}\item 
double \hyperlink{pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763}{tb\+\_\+logpow1} (double freq)
\begin{DoxyCompactList}\small\item\em The integrand for working out the PI rate in a radiation field modelled by a power law. \end{DoxyCompactList}\item 
double \hyperlink{pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f}{tb\+\_\+exp1} (double freq)
\begin{DoxyCompactList}\small\item\em The integrand for working out the PI rate in a radiation field modelled by an exponential. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ \hyperlink{pi__rates_8c_a27fa8981c5a8f9cea39f4e0aecc31fe7}{xtop}
\item 
double \hyperlink{pi__rates_8c_a7c172ee9a58f8312e11188e1eb910044}{qromb\+\_\+temp}
\item 
double \hyperlink{pi__rates_8c_a91feb6a16dd3dc36aeb6c975ae44fec3}{xpl\+\_\+alpha}
\item 
double \hyperlink{pi__rates_8c_a6bedc638d1ebb9f6243328f57740530c}{xpl\+\_\+w}
\item 
double \hyperlink{pi__rates_8c_ab5661a175b610bf901bf445da51b964d}{xpl\+\_\+logw}
\item 
double \hyperlink{pi__rates_8c_af016d92d32fdb254c98e7792b58cca9a}{xexp\+\_\+temp}
\item 
double \hyperlink{pi__rates_8c_a8ee5826b6c79c1785b5745f215f42f55}{xexp\+\_\+w}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines associated with calculating photionization rates. 

\begin{DoxyAuthor}{Author}
nsh 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
Aug, 2014
\end{DoxyDate}
??? 

\subsection{Function Documentation}
\mbox{\Hypertarget{pi__rates_8c_ae8bab77755879541eaede60436cfbda2}\label{pi__rates_8c_ae8bab77755879541eaede60436cfbda2}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!calc\+\_\+pi\+\_\+rate@{calc\+\_\+pi\+\_\+rate}}
\index{calc\+\_\+pi\+\_\+rate@{calc\+\_\+pi\+\_\+rate}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{calc\+\_\+pi\+\_\+rate()}{calc\_pi\_rate()}}
{\footnotesize\ttfamily double calc\+\_\+pi\+\_\+rate (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode,  }\item[{int}]{type }\end{DoxyParamCaption})}



int calculates the photoionization rate coefficient for an ion in a given cell 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion The ion being ionized (or the index to an inner shell cross section) \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The cell in question -\/ note that the details of the model is stored in this strucute \\
\hline
\mbox{\tt in}  & {\em int} & mode says whether to use a piecewise model (1) or a blackbody model (2) for J\+\_\+nu \\
\hline
\mbox{\tt in,out}  & {\em type} & says whether we are computing an outer shell (1) or inner shell (2) rate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The photioinization rate coefficient for the ion.
\end{DoxyReturn}
calc\+\_\+pi\+\_\+rate calculates the photoionization rate coefficient for ion nion, based upon the mean intensity stored in cell xplasma The mode tells the subroutine wether we are modelling the mean intensity as a dilute blackbody (mode2) or as a series of power laws and exponentials (mode1). The type allows for the calculation of inner shell rates -\/ in this case nion is the indenx into an inner shell cross section record -\/ this links to the relvant ion internally. the reason for the difference is that there is exactly one outer rate per ion, but there can be many inner shell rates. Most of the information needed for the calculations is stored in the xplasma structure (e.\+g. temperature and spectral model)

\paragraph*{Notes}

This was created in Summer 2014 in preparation for matrix ionization solver. Previously, this code was contained in two subroutines bb\+\_\+correct\+\_\+2 and pl\+\_\+correct\+\_\+2.\+The functionality of these two have ben combined into one -\/ hence the requirement for the mode parameter.\+It was further extended to deal with inner shell rates -\/ hence the type parameter 

Definition at line 63 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{pi__rates_8c_ae8bab77755879541eaede60436cfbda2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{pi__rates_8c_ae8bab77755879541eaede60436cfbda2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f}\label{pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!tb\+\_\+exp1@{tb\+\_\+exp1}}
\index{tb\+\_\+exp1@{tb\+\_\+exp1}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{tb\+\_\+exp1()}{tb\_exp1()}}
{\footnotesize\ttfamily double tb\+\_\+exp1 (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



The integrand for working out the PI rate in a radiation field modelled by an exponential. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq the frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of sigma J\+\_\+nu/nu at nu
\end{DoxyReturn}
This is the integrand for computing the PI rate coefficient when j\+\_\+nu is described by an exponential law. The returned value is J\+\_\+nu x cross section / nu.

\paragraph*{Notes}

Definition at line 305 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=216pt]{pi__rates_8c_ac6baffec2b7a559720f862e50cabec6f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763}\label{pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!tb\+\_\+logpow1@{tb\+\_\+logpow1}}
\index{tb\+\_\+logpow1@{tb\+\_\+logpow1}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{tb\+\_\+logpow1()}{tb\_logpow1()}}
{\footnotesize\ttfamily double tb\+\_\+logpow1 (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



The integrand for working out the PI rate in a radiation field modelled by a power law. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq the frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of sigma J\+\_\+nu/nu at nu
\end{DoxyReturn}
This is the integrand for computing the PI rate coefficient when j\+\_\+nu is described by a power law. The returned value is J\+\_\+nu x cross section / nu. The power law is computed in log space to allow a larger range of possible values.

\paragraph*{Notes}

Definition at line 278 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=228pt]{pi__rates_8c_ab952e8ceb4c53ae59abe06169acce763_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{pi__rates_8c_ae2e3418a581094a1c02352db778e3d12}\label{pi__rates_8c_ae2e3418a581094a1c02352db778e3d12}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!tb\+\_\+planck1@{tb\+\_\+planck1}}
\index{tb\+\_\+planck1@{tb\+\_\+planck1}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{tb\+\_\+planck1()}{tb\_planck1()}}
{\footnotesize\ttfamily double tb\+\_\+planck1 (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



The integrand for working out the PI rate in a BB radiation field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq the frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of sigma B\+\_\+nu/nu at nu
\end{DoxyReturn}
tb\+\_\+planck is the function a and is called by Qromb in order to integrate over the frequency range where the ionisation cross section is significant. This is the function for ions with a topbase cross section N\+SH

\paragraph*{Notes}

Definition at line 246 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=224pt]{pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{pi__rates_8c_ae2e3418a581094a1c02352db778e3d12_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{pi__rates_8c_a7c172ee9a58f8312e11188e1eb910044}\label{pi__rates_8c_a7c172ee9a58f8312e11188e1eb910044}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!qromb\+\_\+temp@{qromb\+\_\+temp}}
\index{qromb\+\_\+temp@{qromb\+\_\+temp}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{qromb\+\_\+temp}{qromb\_temp}}
{\footnotesize\ttfamily double qromb\+\_\+temp}



Definition at line 22 of file pi\+\_\+rates.\+c.

\mbox{\Hypertarget{pi__rates_8c_af016d92d32fdb254c98e7792b58cca9a}\label{pi__rates_8c_af016d92d32fdb254c98e7792b58cca9a}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!xexp\+\_\+temp@{xexp\+\_\+temp}}
\index{xexp\+\_\+temp@{xexp\+\_\+temp}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{xexp\+\_\+temp}{xexp\_temp}}
{\footnotesize\ttfamily double xexp\+\_\+temp}



Definition at line 27 of file pi\+\_\+rates.\+c.

\mbox{\Hypertarget{pi__rates_8c_a8ee5826b6c79c1785b5745f215f42f55}\label{pi__rates_8c_a8ee5826b6c79c1785b5745f215f42f55}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!xexp\+\_\+w@{xexp\+\_\+w}}
\index{xexp\+\_\+w@{xexp\+\_\+w}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{xexp\+\_\+w}{xexp\_w}}
{\footnotesize\ttfamily double xexp\+\_\+w}



Definition at line 27 of file pi\+\_\+rates.\+c.

\mbox{\Hypertarget{pi__rates_8c_a91feb6a16dd3dc36aeb6c975ae44fec3}\label{pi__rates_8c_a91feb6a16dd3dc36aeb6c975ae44fec3}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!xpl\+\_\+alpha@{xpl\+\_\+alpha}}
\index{xpl\+\_\+alpha@{xpl\+\_\+alpha}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{xpl\+\_\+alpha}{xpl\_alpha}}
{\footnotesize\ttfamily double xpl\+\_\+alpha}



Definition at line 26 of file pi\+\_\+rates.\+c.

\mbox{\Hypertarget{pi__rates_8c_ab5661a175b610bf901bf445da51b964d}\label{pi__rates_8c_ab5661a175b610bf901bf445da51b964d}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!xpl\+\_\+logw@{xpl\+\_\+logw}}
\index{xpl\+\_\+logw@{xpl\+\_\+logw}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{xpl\+\_\+logw}{xpl\_logw}}
{\footnotesize\ttfamily double xpl\+\_\+logw}



Definition at line 26 of file pi\+\_\+rates.\+c.

\mbox{\Hypertarget{pi__rates_8c_a6bedc638d1ebb9f6243328f57740530c}\label{pi__rates_8c_a6bedc638d1ebb9f6243328f57740530c}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!xpl\+\_\+w@{xpl\+\_\+w}}
\index{xpl\+\_\+w@{xpl\+\_\+w}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{xpl\+\_\+w}{xpl\_w}}
{\footnotesize\ttfamily double xpl\+\_\+w}



Definition at line 26 of file pi\+\_\+rates.\+c.

\mbox{\Hypertarget{pi__rates_8c_a27fa8981c5a8f9cea39f4e0aecc31fe7}\label{pi__rates_8c_a27fa8981c5a8f9cea39f4e0aecc31fe7}} 
\index{pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}!xtop@{xtop}}
\index{xtop@{xtop}!pi\+\_\+rates.\+c@{pi\+\_\+rates.\+c}}
\subsubsection{\texorpdfstring{xtop}{xtop}}
{\footnotesize\ttfamily struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot}$\ast$ xtop}



Definition at line 20 of file pi\+\_\+rates.\+c.

