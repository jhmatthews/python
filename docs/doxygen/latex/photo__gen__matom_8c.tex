\hypertarget{photo__gen__matom_8c}{}\section{/\+Users/mhewitt/python/source/photo\+\_\+gen\+\_\+matom.c File Reference}
\label{photo__gen__matom_8c}\index{/\+Users/mhewitt/python/source/photo\+\_\+gen\+\_\+matom.\+c@{/\+Users/mhewitt/python/source/photo\+\_\+gen\+\_\+matom.\+c}}


functions for calculating emissivities and generating photons from macro-\/atoms and k-\/packets. during the spectral cycles. The actual functions which do the jumps inside an activated macro-\/atom are in \hyperlink{matom_8c}{matom.\+c}. This is partly done to prevent overly long files (J\+M1504)  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+block.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+vector.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+matrix.\+h$>$}\newline
{\ttfamily \#include \char`\"{}my\+\_\+linalg.\+h\char`\"{}}\newline
Include dependency graph for photo\+\_\+gen\+\_\+matom.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{photo__gen__matom_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220}{get\+\_\+kpkt\+\_\+f} ()
\begin{DoxyCompactList}\small\item\em returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k-\/packet -\/$>$ r-\/packet in the required wavelength range. \end{DoxyCompactList}\item 
double \hyperlink{photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920}{get\+\_\+matom\+\_\+f} (int mode)
\begin{DoxyCompactList}\small\item\em returns the specific band-\/limited luminosity in macro-\/atoms \end{DoxyCompactList}\item 
int \hyperlink{photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf}{photo\+\_\+gen\+\_\+kpkt} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double weight, int photstart, int nphot)
\begin{DoxyCompactList}\small\item\em produces photon packets to account for creating of r-\/packets by k-\/packets in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). \end{DoxyCompactList}\item 
int \hyperlink{photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f}{photo\+\_\+gen\+\_\+matom} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double weight, int photstart, int nphot)
\begin{DoxyCompactList}\small\item\em produces photon packets to account for creation of r-\/packets by deactivation of macro atoms in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
functions for calculating emissivities and generating photons from macro-\/atoms and k-\/packets. during the spectral cycles. The actual functions which do the jumps inside an activated macro-\/atom are in \hyperlink{matom_8c}{matom.\+c}. This is partly done to prevent overly long files (J\+M1504) 

\begin{DoxyAuthor}{Author}
ksl, ss, jm 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220}\label{photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220}} 
\index{photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}!get\+\_\+kpkt\+\_\+f@{get\+\_\+kpkt\+\_\+f}}
\index{get\+\_\+kpkt\+\_\+f@{get\+\_\+kpkt\+\_\+f}!photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+kpkt\+\_\+f()}{get\_kpkt\_f()}}
{\footnotesize\ttfamily double get\+\_\+kpkt\+\_\+f (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k-\/packet -\/$>$ r-\/packet in the required wavelength range. 

\begin{DoxyReturn}{Returns}
double lum The energy radiated by the process k-\/packet -\/$>$ r-\/packet in the wind in the wavelength range required for the specrum calculation.
\end{DoxyReturn}
\paragraph*{Notes}

Literally just loops through the kpkt\+\_\+emiss entries in plasmamain. 

Definition at line 38 of file photo\+\_\+gen\+\_\+matom.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{photo__gen__matom_8c_a7cb37d7e97d03e7de67b4def94af9220_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920}\label{photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920}} 
\index{photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}!get\+\_\+matom\+\_\+f@{get\+\_\+matom\+\_\+f}}
\index{get\+\_\+matom\+\_\+f@{get\+\_\+matom\+\_\+f}!photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+matom\+\_\+f()}{get\_matom\_f()}}
{\footnotesize\ttfamily double get\+\_\+matom\+\_\+f (\begin{DoxyParamCaption}\item[{int}]{mode }\end{DoxyParamCaption})}



returns the specific band-\/limited luminosity in macro-\/atoms 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & mode vvariable which controls whether or not we need to compute the emissivities (C\+A\+L\+C\+U\+L\+A\+T\+E\+\_\+\+M\+A\+T\+O\+M\+\_\+\+E\+M\+I\+S\+S\+I\+V\+I\+T\+I\+ES) or use stored ones because we are restarting a spectral cycle (U\+S\+E\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+M\+A\+T\+O\+M\+\_\+\+E\+M\+I\+S\+S\+I\+V\+I\+T\+I\+ES) see \#define statements in \hyperlink{python_8h}{python.\+h} and code in \hyperlink{foo_8h_a9a0acf2d461c665dc0302defa95ded65}{xdefine\+\_\+phot()}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
double lum The energy radiated by the deactivation of macro atoms in the wind in the wavelength range required for the specrum calculation.
\end{DoxyReturn}
this routine calculates the luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the deactivation of macro atoms in the required wavelength range. This can be a slow process, as there is no priori way (at least with our method) to work out where a photon is going to come out when a macro-\/atom is generated

\paragraph*{Notes}

Consult Matthews thesis. 

Definition at line 80 of file photo\+\_\+gen\+\_\+matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{photo__gen__matom_8c_ac8797bce5a5f3411f4162dff928b7920_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf}\label{photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf}} 
\index{photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}!photo\+\_\+gen\+\_\+kpkt@{photo\+\_\+gen\+\_\+kpkt}}
\index{photo\+\_\+gen\+\_\+kpkt@{photo\+\_\+gen\+\_\+kpkt}!photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+kpkt()}{photo\_gen\_kpkt()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+kpkt (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{weight,  }\item[{int}]{photstart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



produces photon packets to account for creating of r-\/packets by k-\/packets in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the ptr to the entire structure for the photons \\
\hline
\mbox{\tt in}  & {\em double} & weight the photon weight \\
\hline
\mbox{\tt in}  & {\em int} & photstart The first element of the photon stucure to be populated \\
\hline
\mbox{\tt in}  & {\em int} & nphot the number of photons to be generated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int nphot When it finishes it should have generated nphot photons from k-\/packet elliminations.
\end{DoxyReturn}
This routine is closely related to photo\+\_\+gen\+\_\+wind from which much of the code has been copied. 

Definition at line 477 of file photo\+\_\+gen\+\_\+matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{photo__gen__matom_8c_a4541dc581678aaea94bb9bdf0d38dfcf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f}\label{photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f}} 
\index{photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}!photo\+\_\+gen\+\_\+matom@{photo\+\_\+gen\+\_\+matom}}
\index{photo\+\_\+gen\+\_\+matom@{photo\+\_\+gen\+\_\+matom}!photo\+\_\+gen\+\_\+matom.\+c@{photo\+\_\+gen\+\_\+matom.\+c}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+matom()}{photo\_gen\_matom()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+matom (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{weight,  }\item[{int}]{photstart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



produces photon packets to account for creation of r-\/packets by deactivation of macro atoms in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the ptr to the structire for the photons \\
\hline
\mbox{\tt in}  & {\em double} & weight the photon weight \\
\hline
\mbox{\tt in}  & {\em int} & photstart The position in the photon structure of the first photon to generate \\
\hline
\mbox{\tt in}  & {\em int} & nphot the number of the photons to be generated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int nphot When it finishes it should have generated nphot photons from macro atom deactivations.
\end{DoxyReturn}
This routine is closely related to photo\+\_\+gen\+\_\+kpkt from which much of the code has been copied.

\paragraph*{Notes}

Consult Matthews thesis. 

Definition at line 645 of file photo\+\_\+gen\+\_\+matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=344pt]{photo__gen__matom_8c_a7248f385000ac034fb3f0e3d5f45298f_icgraph}
\end{center}
\end{figure}
