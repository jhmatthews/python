\hypertarget{estimators_8c}{}\section{/\+Users/mhewitt/python/source/estimators.c File Reference}
\label{estimators_8c}\index{/\+Users/mhewitt/python/source/estimators.\+c@{/\+Users/mhewitt/python/source/estimators.\+c}}


Routines for dealing with macro-\/atom and simple-\/atom Monte Carlo estimators. Consult sections 3.\+3 and 3.\+4 of Matthews Phd Thesis\+: .  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for estimators.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{estimators_8c_a5d003db13b4f257723500c23bee10b90}{A\+L\+P\+H\+A\+\_\+\+S\+P\+\_\+\+C\+O\+N\+S\+T\+A\+NT}~5.\+79618e-\/36
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{estimators_8c_a141c8c8db4119b46cba7dcff5de861b3}{bf\+\_\+estimators\+\_\+increment} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds)
\begin{DoxyCompactList}\small\item\em increment the matom bound-\/free estimators \end{DoxyCompactList}\item 
int \hyperlink{estimators_8c_aa85aa8b5ea483c44b26216b963015484}{bb\+\_\+estimators\+\_\+increment} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double tau\+\_\+sobolev, double dvds, int nn)
\begin{DoxyCompactList}\small\item\em increment the matom bound-\/bound estimators \end{DoxyCompactList}\item 
int \hyperlink{estimators_8c_a0b0bdb47e266cd31f1c381bb2410fa80}{mc\+\_\+estimator\+\_\+normalise} (int n)
\begin{DoxyCompactList}\small\item\em the routine to normalise the matom bb and bf estimators. \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_ac3d85b1663343d2b268e3bbb09e6dcc6}{total\+\_\+fb\+\_\+matoms} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e, double f1, double f2)
\begin{DoxyCompactList}\small\item\em computes the cooling rate due to free-\/bound recombinations \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_ac9b0bd2eb8c4957c99a8c369d02cd169}{total\+\_\+bb\+\_\+cooling} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total cooling in matom bb transitions \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_a1d58fccfac7eec74c69412cfabcc5caf}{macro\+\_\+bb\+\_\+heating} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total heating due to matom bb transitions \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_a6122a3139a25688235ecb8b77e875b0f}{macro\+\_\+bf\+\_\+heating} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total heating due to bf transitions for macro atoms. \end{DoxyCompactList}\item 
int \hyperlink{estimators_8c_a5dcca3c33cb0db12719fcc6a79958119}{bb\+\_\+simple\+\_\+heat} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double tau\+\_\+sobolev, double dvds, int nn)
\begin{DoxyCompactList}\small\item\em records the heating contribution from lines of simple elements. \end{DoxyCompactList}\item 
int \hyperlink{estimators_8c_a00d9c108946340fef4c429a9afdeb110}{check\+\_\+stimulated\+\_\+recomb} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em sanity check the stimulated recombination rate \end{DoxyCompactList}\item 
int \hyperlink{estimators_8c_abd62705b5006847a8dc70b442bf15332}{get\+\_\+dilute\+\_\+estimators} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em compute dilute matom estimators \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_af9a598f20c5f4d5b9f01585d7cf8eb4c}{get\+\_\+gamma} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the dilute photoionization rate estimator \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_a0332ea341d92221cbaa2600a2adaa35f}{gamma\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em integrand for the dilute photoionization rate estimator \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_a1e05a878575b566deae630d01be4c75c}{get\+\_\+gamma\+\_\+e} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the dilute energy weighted photoionization rate estimator \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_aa5dfb70302251c14bd8a01ff6f3ec20a}{gamma\+\_\+e\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em the integrand for the energy-\/weighted photoionization rate estimator, \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_ade8e60c03793f3c9f76d4ddd1c159346}{get\+\_\+alpha\+\_\+st} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the stimulated recombination rate estimator \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_ae1c68aef7b2918706acea6da976e3cf4}{alpha\+\_\+st\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em returns the integrand for alpha\+\_\+st at a chosen frequency \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_accd23482f2a991d91cb8dedaef4560ed}{get\+\_\+alpha\+\_\+st\+\_\+e} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the energy-\/weighted stimulated recombination estimator \end{DoxyCompactList}\item 
double \hyperlink{estimators_8c_a034f4f5a8a3102d5224cf211c11d6abc}{alpha\+\_\+st\+\_\+e\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em the integrand for alpha\+\_\+st\+\_\+e at a chosen frequency \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ \hyperlink{estimators_8c_a28e7d1416df8f9f167281153da879cb5}{cont\+\_\+ext\+\_\+ptr2}
\item 
double \hyperlink{estimators_8c_ab7ffed9d9b5e3677bed6abbe77f90d02}{temp\+\_\+ext2}
\item 
double \hyperlink{estimators_8c_a19f2c75a504a37feee8844db5c039702}{temp\+\_\+ext\+\_\+rad}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines for dealing with macro-\/atom and simple-\/atom Monte Carlo estimators. Consult sections 3.\+3 and 3.\+4 of Matthews Phd Thesis\+: . 

\begin{DoxyAuthor}{Author}
Stuart Sim, James Matthews 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{estimators_8c_a5d003db13b4f257723500c23bee10b90}\label{estimators_8c_a5d003db13b4f257723500c23bee10b90}} 
\index{estimators.\+c@{estimators.\+c}!A\+L\+P\+H\+A\+\_\+\+S\+P\+\_\+\+C\+O\+N\+S\+T\+A\+NT@{A\+L\+P\+H\+A\+\_\+\+S\+P\+\_\+\+C\+O\+N\+S\+T\+A\+NT}}
\index{A\+L\+P\+H\+A\+\_\+\+S\+P\+\_\+\+C\+O\+N\+S\+T\+A\+NT@{A\+L\+P\+H\+A\+\_\+\+S\+P\+\_\+\+C\+O\+N\+S\+T\+A\+NT}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{A\+L\+P\+H\+A\+\_\+\+S\+P\+\_\+\+C\+O\+N\+S\+T\+A\+NT}{ALPHA\_SP\_CONSTANT}}
{\footnotesize\ttfamily \#define A\+L\+P\+H\+A\+\_\+\+S\+P\+\_\+\+C\+O\+N\+S\+T\+A\+NT~5.\+79618e-\/36}



Definition at line 29 of file estimators.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{estimators_8c_a034f4f5a8a3102d5224cf211c11d6abc}\label{estimators_8c_a034f4f5a8a3102d5224cf211c11d6abc}} 
\index{estimators.\+c@{estimators.\+c}!alpha\+\_\+st\+\_\+e\+\_\+integrand@{alpha\+\_\+st\+\_\+e\+\_\+integrand}}
\index{alpha\+\_\+st\+\_\+e\+\_\+integrand@{alpha\+\_\+st\+\_\+e\+\_\+integrand}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{alpha\+\_\+st\+\_\+e\+\_\+integrand()}{alpha\_st\_e\_integrand()}}
{\footnotesize\ttfamily double alpha\+\_\+st\+\_\+e\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



the integrand for alpha\+\_\+st\+\_\+e at a chosen frequency 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
the integrand for the energy-\/weighted stimulated recombination estimator see equation 3.\+68 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1287 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{estimators_8c_a034f4f5a8a3102d5224cf211c11d6abc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a034f4f5a8a3102d5224cf211c11d6abc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_ae1c68aef7b2918706acea6da976e3cf4}\label{estimators_8c_ae1c68aef7b2918706acea6da976e3cf4}} 
\index{estimators.\+c@{estimators.\+c}!alpha\+\_\+st\+\_\+integrand@{alpha\+\_\+st\+\_\+integrand}}
\index{alpha\+\_\+st\+\_\+integrand@{alpha\+\_\+st\+\_\+integrand}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{alpha\+\_\+st\+\_\+integrand()}{alpha\_st\_integrand()}}
{\footnotesize\ttfamily double alpha\+\_\+st\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



returns the integrand for alpha\+\_\+st at a chosen frequency 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
integrand for the stimulated recombination rate estimator, in equation 3.\+65 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1199 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=251pt]{estimators_8c_ae1c68aef7b2918706acea6da976e3cf4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_ae1c68aef7b2918706acea6da976e3cf4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_aa85aa8b5ea483c44b26216b963015484}\label{estimators_8c_aa85aa8b5ea483c44b26216b963015484}} 
\index{estimators.\+c@{estimators.\+c}!bb\+\_\+estimators\+\_\+increment@{bb\+\_\+estimators\+\_\+increment}}
\index{bb\+\_\+estimators\+\_\+increment@{bb\+\_\+estimators\+\_\+increment}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{bb\+\_\+estimators\+\_\+increment()}{bb\_estimators\_increment()}}
{\footnotesize\ttfamily int bb\+\_\+estimators\+\_\+increment (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{tau\+\_\+sobolev,  }\item[{double}]{dvds,  }\item[{int}]{nn }\end{DoxyParamCaption})}



increment the matom bound-\/bound estimators 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one pointer to cell \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p the packet \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+sobolev optical depth of line \\
\hline
\mbox{\tt in}  & {\em double} & dvds velocity gradient \\
\hline
\mbox{\tt in}  & {\em int} & nn the label for the line in question \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 1 if the line was a \char`\"{}simple\char`\"{} line. The routine should not have been called if that was the case.
\end{DoxyReturn}
increment the matom bound-\/bound estimators as needed for the macro atom calculations. Whenever a packet comes into resonance with a line this routine is called W\+H\+E\+T\+H\+ER OR N\+OT the packet interacts with the line. The estimator is not normalised here. That is done later.

\paragraph*{Notes}

The estimators are not normalised by this routine For the moment, the increment to the estimator is taken to be weight $\ast$ (1 -\/ exp(-\/tau))/ tau / dvds This is slightly different from what I do in my code (not accurate to v/c corrections). If calculations where accuracy to order v/c is needed then this routine should be improved. 

Definition at line 312 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_aa85aa8b5ea483c44b26216b963015484_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{estimators_8c_aa85aa8b5ea483c44b26216b963015484_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a5dcca3c33cb0db12719fcc6a79958119}\label{estimators_8c_a5dcca3c33cb0db12719fcc6a79958119}} 
\index{estimators.\+c@{estimators.\+c}!bb\+\_\+simple\+\_\+heat@{bb\+\_\+simple\+\_\+heat}}
\index{bb\+\_\+simple\+\_\+heat@{bb\+\_\+simple\+\_\+heat}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{bb\+\_\+simple\+\_\+heat()}{bb\_simple\_heat()}}
{\footnotesize\ttfamily int bb\+\_\+simple\+\_\+heat (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{tau\+\_\+sobolev,  }\item[{double}]{dvds,  }\item[{int}]{nn }\end{DoxyParamCaption})}



records the heating contribution from lines of simple elements. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Plasma\+Ptrxplasma} & \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p the packet \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+sobolev optical depth of line \\
\hline
\mbox{\tt in}  & {\em double} & dvds velocity gradient \\
\hline
\mbox{\tt in}  & {\em int} & nn the label for the line in question \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success
\end{DoxyReturn}
records the heating contribution from lines of simple elements. It is called whenever a packet comes into resonance with the line and records the heating contribution from that line and packet 

Definition at line 850 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=254pt]{estimators_8c_a5dcca3c33cb0db12719fcc6a79958119_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=243pt]{estimators_8c_a5dcca3c33cb0db12719fcc6a79958119_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a141c8c8db4119b46cba7dcff5de861b3}\label{estimators_8c_a141c8c8db4119b46cba7dcff5de861b3}} 
\index{estimators.\+c@{estimators.\+c}!bf\+\_\+estimators\+\_\+increment@{bf\+\_\+estimators\+\_\+increment}}
\index{bf\+\_\+estimators\+\_\+increment@{bf\+\_\+estimators\+\_\+increment}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{bf\+\_\+estimators\+\_\+increment()}{bf\_estimators\_increment()}}
{\footnotesize\ttfamily int bf\+\_\+estimators\+\_\+increment (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds }\end{DoxyParamCaption})}



increment the matom bound-\/free estimators 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one pointer to cell \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p the packet \\
\hline
\mbox{\tt in}  & {\em double} & ds the path length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
increment the bound-\/free estimators as needed for the macro atom calculations. Whenever a packet travels a path length ds through a shell the estimator for all bound-\/free processes where the packet frequency is above the threshold frequency is incremented. The estimator is not normalised here. That is done later.

\paragraph*{Notes}

The estimators are not normalised by this routine. This routine also computes the total heating rate due to simple ions. Therefore the routine needs to be called even for the simple non-\/macro atom case.

The bound-\/free estimators are described in section 3.\+3.\+3.\+1 Matthews Phd Thesis. 

Definition at line 57 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a141c8c8db4119b46cba7dcff5de861b3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a141c8c8db4119b46cba7dcff5de861b3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a00d9c108946340fef4c429a9afdeb110}\label{estimators_8c_a00d9c108946340fef4c429a9afdeb110}} 
\index{estimators.\+c@{estimators.\+c}!check\+\_\+stimulated\+\_\+recomb@{check\+\_\+stimulated\+\_\+recomb}}
\index{check\+\_\+stimulated\+\_\+recomb@{check\+\_\+stimulated\+\_\+recomb}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{check\+\_\+stimulated\+\_\+recomb()}{check\_stimulated\_recomb()}}
{\footnotesize\ttfamily int check\+\_\+stimulated\+\_\+recomb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



sanity check the stimulated recombination rate 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
check that stimulated recombination rate doesn\textquotesingle{}t exceed the photoionization rate (check if any levels have $\alpha_{st}n_e*\frac{n_u}{n_l} > \gamma$ 

Definition at line 912 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a00d9c108946340fef4c429a9afdeb110_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{estimators_8c_a00d9c108946340fef4c429a9afdeb110_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_aa5dfb70302251c14bd8a01ff6f3ec20a}\label{estimators_8c_aa5dfb70302251c14bd8a01ff6f3ec20a}} 
\index{estimators.\+c@{estimators.\+c}!gamma\+\_\+e\+\_\+integrand@{gamma\+\_\+e\+\_\+integrand}}
\index{gamma\+\_\+e\+\_\+integrand@{gamma\+\_\+e\+\_\+integrand}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{gamma\+\_\+e\+\_\+integrand()}{gamma\_e\_integrand()}}
{\footnotesize\ttfamily double gamma\+\_\+e\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



the integrand for the energy-\/weighted photoionization rate estimator, 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
the integrand for the energy-\/weighted photoionization rate estimator, equation 3.\+66 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1116 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{estimators_8c_aa5dfb70302251c14bd8a01ff6f3ec20a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_aa5dfb70302251c14bd8a01ff6f3ec20a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a0332ea341d92221cbaa2600a2adaa35f}\label{estimators_8c_a0332ea341d92221cbaa2600a2adaa35f}} 
\index{estimators.\+c@{estimators.\+c}!gamma\+\_\+integrand@{gamma\+\_\+integrand}}
\index{gamma\+\_\+integrand@{gamma\+\_\+integrand}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{gamma\+\_\+integrand()}{gamma\_integrand()}}
{\footnotesize\ttfamily double gamma\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



integrand for the dilute photoionization rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
integrand for the dilute photoionization rate estimator, for a black body radiation field with known dilution factor and temperature see equation 3.\+64 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1044 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{estimators_8c_a0332ea341d92221cbaa2600a2adaa35f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a0332ea341d92221cbaa2600a2adaa35f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_ade8e60c03793f3c9f76d4ddd1c159346}\label{estimators_8c_ade8e60c03793f3c9f76d4ddd1c159346}} 
\index{estimators.\+c@{estimators.\+c}!get\+\_\+alpha\+\_\+st@{get\+\_\+alpha\+\_\+st}}
\index{get\+\_\+alpha\+\_\+st@{get\+\_\+alpha\+\_\+st}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+alpha\+\_\+st()}{get\_alpha\_st()}}
{\footnotesize\ttfamily double get\+\_\+alpha\+\_\+st (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the stimulated recombination rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
alpha\+\_\+st\+\_\+value
\end{DoxyReturn}
the stimulated recombination rate estimator, equation 3.\+65 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1153 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{estimators_8c_ade8e60c03793f3c9f76d4ddd1c159346_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_ade8e60c03793f3c9f76d4ddd1c159346_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_accd23482f2a991d91cb8dedaef4560ed}\label{estimators_8c_accd23482f2a991d91cb8dedaef4560ed}} 
\index{estimators.\+c@{estimators.\+c}!get\+\_\+alpha\+\_\+st\+\_\+e@{get\+\_\+alpha\+\_\+st\+\_\+e}}
\index{get\+\_\+alpha\+\_\+st\+\_\+e@{get\+\_\+alpha\+\_\+st\+\_\+e}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+alpha\+\_\+st\+\_\+e()}{get\_alpha\_st\_e()}}
{\footnotesize\ttfamily double get\+\_\+alpha\+\_\+st\+\_\+e (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the energy-\/weighted stimulated recombination estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
alpha\+\_\+st\+\_\+e\+\_\+value
\end{DoxyReturn}
the energy-\/weighted stimulated recombination estimator see equation 3.\+68 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1240 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_accd23482f2a991d91cb8dedaef4560ed_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_accd23482f2a991d91cb8dedaef4560ed_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_abd62705b5006847a8dc70b442bf15332}\label{estimators_8c_abd62705b5006847a8dc70b442bf15332}} 
\index{estimators.\+c@{estimators.\+c}!get\+\_\+dilute\+\_\+estimators@{get\+\_\+dilute\+\_\+estimators}}
\index{get\+\_\+dilute\+\_\+estimators@{get\+\_\+dilute\+\_\+estimators}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+dilute\+\_\+estimators()}{get\_dilute\_estimators()}}
{\footnotesize\ttfamily int get\+\_\+dilute\+\_\+estimators (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



compute dilute matom estimators 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
get\+\_\+dilute\+\_\+estimators computes the bound free and bound bound estimators for a cell from a dilute blackbody. This is the default if macro\+\_\+pops fails to find a solution for an ion. Modifies mplasma. 

Definition at line 961 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_abd62705b5006847a8dc70b442bf15332_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{estimators_8c_abd62705b5006847a8dc70b442bf15332_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_af9a598f20c5f4d5b9f01585d7cf8eb4c}\label{estimators_8c_af9a598f20c5f4d5b9f01585d7cf8eb4c}} 
\index{estimators.\+c@{estimators.\+c}!get\+\_\+gamma@{get\+\_\+gamma}}
\index{get\+\_\+gamma@{get\+\_\+gamma}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+gamma()}{get\_gamma()}}
{\footnotesize\ttfamily double get\+\_\+gamma (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the dilute photoionization rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
gamma\+\_\+value
\end{DoxyReturn}
the dilute photoionization rate estimator, for a black body radiation field with known dilution factor and temperature see equation 3.\+64 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1007 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{estimators_8c_af9a598f20c5f4d5b9f01585d7cf8eb4c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_af9a598f20c5f4d5b9f01585d7cf8eb4c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a1e05a878575b566deae630d01be4c75c}\label{estimators_8c_a1e05a878575b566deae630d01be4c75c}} 
\index{estimators.\+c@{estimators.\+c}!get\+\_\+gamma\+\_\+e@{get\+\_\+gamma\+\_\+e}}
\index{get\+\_\+gamma\+\_\+e@{get\+\_\+gamma\+\_\+e}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+gamma\+\_\+e()}{get\_gamma\_e()}}
{\footnotesize\ttfamily double get\+\_\+gamma\+\_\+e (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the dilute energy weighted photoionization rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
gamma\+\_\+e\+\_\+value
\end{DoxyReturn}
the energy-\/weighted photoionization rate estimator, for a black body radiation field with known dilution factor and temperature equation 3.\+66 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1080 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a1e05a878575b566deae630d01be4c75c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a1e05a878575b566deae630d01be4c75c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a1d58fccfac7eec74c69412cfabcc5caf}\label{estimators_8c_a1d58fccfac7eec74c69412cfabcc5caf}} 
\index{estimators.\+c@{estimators.\+c}!macro\+\_\+bb\+\_\+heating@{macro\+\_\+bb\+\_\+heating}}
\index{macro\+\_\+bb\+\_\+heating@{macro\+\_\+bb\+\_\+heating}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{macro\+\_\+bb\+\_\+heating()}{macro\_bb\_heating()}}
{\footnotesize\ttfamily double macro\+\_\+bb\+\_\+heating (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total heating due to matom bb transitions 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the total heating due to bb transitions (due to collisions) for macro atoms. The heating in simple ions is taken care of elsewhere. It is used by the heating/cooling calculation to get the temperature. 

Definition at line 746 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{estimators_8c_a1d58fccfac7eec74c69412cfabcc5caf_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a1d58fccfac7eec74c69412cfabcc5caf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a6122a3139a25688235ecb8b77e875b0f}\label{estimators_8c_a6122a3139a25688235ecb8b77e875b0f}} 
\index{estimators.\+c@{estimators.\+c}!macro\+\_\+bf\+\_\+heating@{macro\+\_\+bf\+\_\+heating}}
\index{macro\+\_\+bf\+\_\+heating@{macro\+\_\+bf\+\_\+heating}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{macro\+\_\+bf\+\_\+heating()}{macro\_bf\_heating()}}
{\footnotesize\ttfamily double macro\+\_\+bf\+\_\+heating (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total heating due to bf transitions for macro atoms. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the total heating due to bf transitions for macro atoms. The heating in simple ions is taken care of elsewhere. It is used by the heating/cooling calculation to get the temperature. 

Definition at line 791 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a6122a3139a25688235ecb8b77e875b0f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a6122a3139a25688235ecb8b77e875b0f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_a0b0bdb47e266cd31f1c381bb2410fa80}\label{estimators_8c_a0b0bdb47e266cd31f1c381bb2410fa80}} 
\index{estimators.\+c@{estimators.\+c}!mc\+\_\+estimator\+\_\+normalise@{mc\+\_\+estimator\+\_\+normalise}}
\index{mc\+\_\+estimator\+\_\+normalise@{mc\+\_\+estimator\+\_\+normalise}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{mc\+\_\+estimator\+\_\+normalise()}{mc\_estimator\_normalise()}}
{\footnotesize\ttfamily int mc\+\_\+estimator\+\_\+normalise (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



the routine to normalise the matom bb and bf estimators. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n the cell for which the normalisation is to be done \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
This routine normalises the bb and bf mc estimators needed for the macro atom jumping probabilities. During the main mc simulation these were stored unnormalised. They are now normalised and moved into the \char`\"{}old\char`\"{} slots for use in the next iteration. The current slots are reset to zero for use in the next iteration.

It is performed as part of the wind update stage of Python. The estimators should only be changed during the ionisation cycles -\/ after that they should be fixed. It also now computes the bf heating rate using the normalised estimators. heat\+\_\+tot and heat\+\_\+photo are incremented but nothing else is for now.

\paragraph*{Notes}

ksl -- This routine loops over nlte\+\_\+levels, which in principle could include non-\/macro ions, but that should not matter since nbfu\+\_\+jumps will be zero for these. 

Definition at line 427 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_a0b0bdb47e266cd31f1c381bb2410fa80_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_ac9b0bd2eb8c4957c99a8c369d02cd169}\label{estimators_8c_ac9b0bd2eb8c4957c99a8c369d02cd169}} 
\index{estimators.\+c@{estimators.\+c}!total\+\_\+bb\+\_\+cooling@{total\+\_\+bb\+\_\+cooling}}
\index{total\+\_\+bb\+\_\+cooling@{total\+\_\+bb\+\_\+cooling}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{total\+\_\+bb\+\_\+cooling()}{total\_bb\_cooling()}}
{\footnotesize\ttfamily double total\+\_\+bb\+\_\+cooling (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total cooling in matom bb transitions 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em doublet\+\_\+e} & electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the total cooling in bb transitions (due to collisions) for both macro atoms and simple ions. It is used by the heating/cooling calculation to get the temperature. 

Definition at line 682 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{estimators_8c_ac9b0bd2eb8c4957c99a8c369d02cd169_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_ac9b0bd2eb8c4957c99a8c369d02cd169_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{estimators_8c_ac3d85b1663343d2b268e3bbb09e6dcc6}\label{estimators_8c_ac3d85b1663343d2b268e3bbb09e6dcc6}} 
\index{estimators.\+c@{estimators.\+c}!total\+\_\+fb\+\_\+matoms@{total\+\_\+fb\+\_\+matoms}}
\index{total\+\_\+fb\+\_\+matoms@{total\+\_\+fb\+\_\+matoms}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{total\+\_\+fb\+\_\+matoms()}{total\_fb\_matoms()}}
{\footnotesize\ttfamily double total\+\_\+fb\+\_\+matoms (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



computes the cooling rate due to free-\/bound recombinations 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\mbox{\tt in}  & {\em double} & f1 lower frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 upper frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the cooling rate due to free-\/bound recombinations using MC estimators. It is modelled on total\+\_\+fb but makes use of the mc estimators for stimulated recombination.

\paragraph*{Notes}

K\+SL\+: This routine loops over nlte\+\_\+levels, which in principle could include non-\/macro ions, but that should not matter since since nbfu\+\_\+jumps will be zero for these. 

Definition at line 606 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_ac3d85b1663343d2b268e3bbb09e6dcc6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{estimators_8c_ac3d85b1663343d2b268e3bbb09e6dcc6_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{estimators_8c_a28e7d1416df8f9f167281153da879cb5}\label{estimators_8c_a28e7d1416df8f9f167281153da879cb5}} 
\index{estimators.\+c@{estimators.\+c}!cont\+\_\+ext\+\_\+ptr2@{cont\+\_\+ext\+\_\+ptr2}}
\index{cont\+\_\+ext\+\_\+ptr2@{cont\+\_\+ext\+\_\+ptr2}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{cont\+\_\+ext\+\_\+ptr2}{cont\_ext\_ptr2}}
{\footnotesize\ttfamily struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot}$\ast$ cont\+\_\+ext\+\_\+ptr2}



Definition at line 25 of file estimators.\+c.

\mbox{\Hypertarget{estimators_8c_ab7ffed9d9b5e3677bed6abbe77f90d02}\label{estimators_8c_ab7ffed9d9b5e3677bed6abbe77f90d02}} 
\index{estimators.\+c@{estimators.\+c}!temp\+\_\+ext2@{temp\+\_\+ext2}}
\index{temp\+\_\+ext2@{temp\+\_\+ext2}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{temp\+\_\+ext2}{temp\_ext2}}
{\footnotesize\ttfamily double temp\+\_\+ext2}



Definition at line 26 of file estimators.\+c.

\mbox{\Hypertarget{estimators_8c_a19f2c75a504a37feee8844db5c039702}\label{estimators_8c_a19f2c75a504a37feee8844db5c039702}} 
\index{estimators.\+c@{estimators.\+c}!temp\+\_\+ext\+\_\+rad@{temp\+\_\+ext\+\_\+rad}}
\index{temp\+\_\+ext\+\_\+rad@{temp\+\_\+ext\+\_\+rad}!estimators.\+c@{estimators.\+c}}
\subsubsection{\texorpdfstring{temp\+\_\+ext\+\_\+rad}{temp\_ext\_rad}}
{\footnotesize\ttfamily double temp\+\_\+ext\+\_\+rad}



Definition at line 27 of file estimators.\+c.

