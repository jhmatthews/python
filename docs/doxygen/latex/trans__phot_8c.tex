\hypertarget{trans__phot_8c}{}\section{/\+Users/mhewitt/python/source/trans\+\_\+phot.c File Reference}
\label{trans__phot_8c}\index{/\+Users/mhewitt/python/source/trans\+\_\+phot.\+c@{/\+Users/mhewitt/python/source/trans\+\_\+phot.\+c}}


This file contains high level routines which carry out the propagation of photons through the wind/wind domains both for ionization and spectrum (extract) cycles.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for trans\+\_\+phot.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{trans__phot_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389}{trans\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int iextract)
\begin{DoxyCompactList}\small\item\em int (w,p,iextract) oversees the propagation of a \char`\"{}flight\char`\"{} of photons \end{DoxyCompactList}\item 
int \hyperlink{trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813}{trans\+\_\+phot\+\_\+single} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int iextract)
\begin{DoxyCompactList}\small\item\em Transport a single photon photon through the wind. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
F\+I\+LE $\ast$ \hyperlink{trans__phot_8c_a67e1c9923b347ff54c2515cce727e62f}{pltptr}
\item 
int \hyperlink{trans__phot_8c_a0539753df48490e5b774668a65af9fce}{plinit} = 0
\item 
long \hyperlink{trans__phot_8c_a09209ddd6e40362291feaaafc3dd989b}{n\+\_\+lost\+\_\+to\+\_\+dfudge} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file contains high level routines which carry out the propagation of photons through the wind/wind domains both for ionization and spectrum (extract) cycles. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
April, 2018
\end{DoxyDate}
\paragraph*{Notes}

The routines contained here are central to Python, and anyone who wants to understand Python in general should spend time understanding how they work

There are two basic options associated with the routines.


\begin{DoxyItemize}
\item live or die is the case in which one is only concerned with how a photon goes through the wind and random numbers are used to generate the scattering directions. The photon is followed until it leaves the system. This is the only option used in ionization cycles (currently).
\item extract is the mode where whenever a photon scatters we also calculate what the photon weight would be if it scattered in a set of certain directions. When this happens the weight of the photon is changed to reflect the fact that the direction is not random.
\end{DoxyItemize}

The extract option is used normaly during the spectral extraction cycles. However, as an advanced option one can use the live or die to construct the detailed spectrum. One would not normally want to do this, as many photons are \char`\"{}wasted\char`\"{} since they don\textquotesingle{}t scatter at the desired angle. With sufficient numbers of photons however the results of the two methods should (by construction) be identical (or at least very very similar). 

\subsection{Function Documentation}
\mbox{\Hypertarget{trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389}\label{trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389}} 
\index{trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}!trans\+\_\+phot@{trans\+\_\+phot}}
\index{trans\+\_\+phot@{trans\+\_\+phot}!trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}}
\subsubsection{\texorpdfstring{trans\+\_\+phot()}{trans\_phot()}}
{\footnotesize\ttfamily int trans\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{iextract }\end{DoxyParamCaption})}



int (w,p,iextract) oversees the propagation of a \char`\"{}flight\char`\"{} of photons 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind domain \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A pointer to a \char`\"{}fligh\char`\"{} of photons \\
\hline
\mbox{\tt in}  & {\em int} & iextract An integer controlling whether we are to process the flight in the live or die option (0) or whether we also need to extract photons in specific directions (which is usually the case in constructing spectra \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns 0
\end{DoxyReturn}
This routine oversees the propagation of individual photons. The main loop covers an entire \char`\"{}flight\char`\"{} of photons. The routine generates the random optical depth a photon can travel before scattering and monitors the progress of the photon through the grid.

The real physics is done elsewhere, in lower level routines.

\paragraph*{Notes}

At the end of the routine the position for each of the photons in p is the last point where the photon was in the wind, $\ast$ not the outer boundary of the radiative transfer 

Definition at line 85 of file trans\+\_\+phot.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{trans__phot_8c_a620388e1c4a8e38f192c5a0ce42af389_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813}\label{trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813}} 
\index{trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}!trans\+\_\+phot\+\_\+single@{trans\+\_\+phot\+\_\+single}}
\index{trans\+\_\+phot\+\_\+single@{trans\+\_\+phot\+\_\+single}!trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}}
\subsubsection{\texorpdfstring{trans\+\_\+phot\+\_\+single()}{trans\_phot\_single()}}
{\footnotesize\ttfamily int trans\+\_\+phot\+\_\+single (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{iextract }\end{DoxyParamCaption})}



Transport a single photon photon through the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A single photon \\
\hline
\mbox{\tt in}  & {\em int} & iextract If 0, then process this photon in the live or die option, without calling extract\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine oversees the propagation of an individual photon through the wind. As the photon moves through the wind, its position, direction and weight are updated. In reverberation mode, the flight time is also tracked.

Basically what the routine does is generate a random number whihc is used to determine the optical depth to a scatter, and then it calles translate multiple times. translate involves moving the photon only a single cell (or alternatively a single tranfer in the windless region), and returns a status. Depending on what this status is, trans\+\_\+phot\+\_\+single calls trans\+\_\+phot again doing nothing, but if the scattering depth has been reached, then trans\+\_\+phot\+\_\+single causes the photon to scatter, which changes its direction. This process continues until the photon exits the system or hits a barrier. If the photon hits a radiating surface, the disk or star, then the photon may either be absorbed, or scattered depending on the reflection/absorption mode.

\paragraph*{Notes}

This routine is called by trans\+\_\+phot once for each photon in a flight of photons 

Definition at line 302 of file trans\+\_\+phot.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{trans__phot_8c_a2f7b8208c76fe2718f45f46c9dc3a813_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{trans__phot_8c_a09209ddd6e40362291feaaafc3dd989b}\label{trans__phot_8c_a09209ddd6e40362291feaaafc3dd989b}} 
\index{trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}!n\+\_\+lost\+\_\+to\+\_\+dfudge@{n\+\_\+lost\+\_\+to\+\_\+dfudge}}
\index{n\+\_\+lost\+\_\+to\+\_\+dfudge@{n\+\_\+lost\+\_\+to\+\_\+dfudge}!trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}}
\subsubsection{\texorpdfstring{n\+\_\+lost\+\_\+to\+\_\+dfudge}{n\_lost\_to\_dfudge}}
{\footnotesize\ttfamily long n\+\_\+lost\+\_\+to\+\_\+dfudge = 0}



Definition at line 53 of file trans\+\_\+phot.\+c.

\mbox{\Hypertarget{trans__phot_8c_a0539753df48490e5b774668a65af9fce}\label{trans__phot_8c_a0539753df48490e5b774668a65af9fce}} 
\index{trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}!plinit@{plinit}}
\index{plinit@{plinit}!trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}}
\subsubsection{\texorpdfstring{plinit}{plinit}}
{\footnotesize\ttfamily int plinit = 0}



Definition at line 52 of file trans\+\_\+phot.\+c.

\mbox{\Hypertarget{trans__phot_8c_a67e1c9923b347ff54c2515cce727e62f}\label{trans__phot_8c_a67e1c9923b347ff54c2515cce727e62f}} 
\index{trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}!pltptr@{pltptr}}
\index{pltptr@{pltptr}!trans\+\_\+phot.\+c@{trans\+\_\+phot.\+c}}
\subsubsection{\texorpdfstring{pltptr}{pltptr}}
{\footnotesize\ttfamily F\+I\+LE$\ast$ pltptr}



Definition at line 51 of file trans\+\_\+phot.\+c.

