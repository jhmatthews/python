\hypertarget{roche_8c}{}\section{/\+Users/mhewitt/python/source/roche.c File Reference}
\label{roche_8c}\index{/\+Users/mhewitt/python/source/roche.\+c@{/\+Users/mhewitt/python/source/roche.\+c}}


These routines are used to describe the Roche geometry and are intended to allow one to calculate whether a photon intersects the surface of the star.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for roche.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{roche_8c_a6ebf6899d6c1c8b7b9d09be872c05aae}{E\+PS}~10000.
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da}{binary\+\_\+basics} ()
\begin{DoxyCompactList}\small\item\em From the masses and period, setup the information one needs to calculate the position of the Roche lobe of the secondary to calculate whether a photon intersects the surface of the star. \end{DoxyCompactList}\item 
double \hyperlink{roche_8c_aff5a3156ec26863e37ff61073bb97ca4}{ds\+\_\+to\+\_\+roche\+\_\+2} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em Calculate the distance to the Roche surface for a photon. \end{DoxyCompactList}\item 
int \hyperlink{roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3}{hit\+\_\+secondary} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em Find out whether a photon will hit the secondary, but don\textquotesingle{}t actually calculate the point where it hits. \end{DoxyCompactList}\item 
double \hyperlink{roche_8c_a3a6359a23f10596d6bb51c80905c1c88}{pillbox} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double $\ast$smin, double $\ast$smax)
\begin{DoxyCompactList}\small\item\em Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary. \end{DoxyCompactList}\item 
double \hyperlink{roche_8c_a4a0210aea098f52ca60dfbc90de4ecee}{phi} (double s)
\begin{DoxyCompactList}\small\item\em Calculate the Roche potential at position indicated by the photon p\+\_\+roche and the length s. \end{DoxyCompactList}\item 
double \hyperlink{roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430}{dphi\+\_\+ds} (double s)
\begin{DoxyCompactList}\small\item\em Calculate the gradient of the Roche potential as the photon travels. \end{DoxyCompactList}\item 
double \hyperlink{roche_8c_a7b0bed5d82ce2310bbd039704b3567cd}{d2phi\+\_\+ds2} (double s)
\begin{DoxyCompactList}\small\item\em Calculate the second derivative of the Roche potential of the secondary. \end{DoxyCompactList}\item 
double \hyperlink{roche_8c_aa6c77132d4fe5cdf4cb3d66186981228}{roche\+\_\+width} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Calculate the width of the Roche potentiil at a position x along the x axis. \end{DoxyCompactList}\item 
double \hyperlink{roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937}{roche2\+\_\+width\+\_\+max} ()
\begin{DoxyCompactList}\small\item\em Find the half width of the secondary Roche lobe. \end{DoxyCompactList}\item 
void \hyperlink{roche_8c_a9c51519f54c26122775ef8eaca1806d8}{roche} (double s, double $\ast$value, double $\ast$derivative)
\begin{DoxyCompactList}\small\item\em Calculate the value of the Roche potential and its derivative along a particular lien of sight. \end{DoxyCompactList}\item 
void \hyperlink{roche_8c_aa72cfd7beaead2acdb08bb12eafa3197}{roche\+\_\+deriv} (double s, double $\ast$value, double $\ast$derivative)
\begin{DoxyCompactList}\small\item\em Calculate the first and second derivative of the roche potential along a specific line of sight. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structphoton}{photon} \hyperlink{roche_8c_a18146e93d3e11a3c0fae56976057c12f}{p\+\_\+roche}
\item 
int \hyperlink{roche_8c_adc09e0999f545c5536ae23fb5af7d6af}{phi\+\_\+init} = 0
\item 
double \hyperlink{roche_8c_aa745f36e93f2d6e087104c461c0d8299}{phi\+\_\+gm1}
\item 
double \hyperlink{roche_8c_ac3c00f91fc3b74caefda51e0b780164a}{phi\+\_\+gm2}
\item 
double \hyperlink{roche_8c_a5c49fe0824ac783b653795bdec304d52}{phi\+\_\+3}
\item 
double \hyperlink{roche_8c_a0fb4d1a2dda34ad3175ec3102efbbe55}{phi\+\_\+4}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
These routines are used to describe the Roche geometry and are intended to allow one to calculate whether a photon intersects the surface of the star. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018
\end{DoxyDate}
The important routines are


\begin{DoxyItemize}
\item binary\+\_\+basics which uses the masses of the primary and the secondary to calculate the position of various Lagrange points, etc, and the size of a pillbox which encloses the Roche lobe of the secondary. It must be called before the other routines can be used!
\item ds\+\_\+to\+\_\+roche2 calculates the distance a photon defined by p\+\_\+roche has to travel before it will encounter the secondary. If it misses, ds\+\_\+to\+\_\+roche2 returns V\+E\+R\+Y\+\_\+\+B\+IG.
\item hit\+\_\+secondary determines whether a photon defined by p\+\_\+roche will hit the secondary or not. If it misses, hit\+\_\+secondary returns 0, if it hits, the return is P\+\_\+\+S\+EC (or hit secondary as contained in \hyperlink{python_8h}{python.\+h}).
\end{DoxyItemize}

\paragraph*{Notes}

The secondary is located along the x, i.\+e. 0, axis

To utilize the routines you must stuff the photon of interest into the external photon \char`\"{}p\+\_\+roche\char`\"{}. This is necessary because the program makes use of two Numerical Recipes Routines rtsafe and golden to find zeroes and minima respectively. Note that it is possible (likely) that these are not the very best choices of Numerical Recipes routines to use. In particular it is possible that B\+R\+E\+NT could replace both routines.

The routines adopt the same approach as in Keith Horne\textquotesingle{}s routines dealing with the Roche geometry, that is a pillbox is defined around the secondary. The radius of the pillbox is determined by the maximum size of the secondary perpendicular to the line of sight between the two stars. One end of the pillbox is defined by the L1 point. The other end of the pillbox is defined by the backside of the secondary. One first tests to find out whether a photon intersects the pillbox, and then one checks more carefully to see whether the photon actually hits the secondary (using the intersections with the pillbox to define the limits of the careful search.

Note\+: ds\+\_\+to\+\_\+roche2 is not actually used by Python. It would be used if one wanted to calculate the heating of the secondary. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{roche_8c_a6ebf6899d6c1c8b7b9d09be872c05aae}\label{roche_8c_a6ebf6899d6c1c8b7b9d09be872c05aae}} 
\index{roche.\+c@{roche.\+c}!E\+PS@{E\+PS}}
\index{E\+PS@{E\+PS}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{E\+PS}{EPS}}
{\footnotesize\ttfamily \#define E\+PS~10000.}



Definition at line 499 of file roche.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da}\label{roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da}} 
\index{roche.\+c@{roche.\+c}!binary\+\_\+basics@{binary\+\_\+basics}}
\index{binary\+\_\+basics@{binary\+\_\+basics}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{binary\+\_\+basics()}{binary\_basics()}}
{\footnotesize\ttfamily int binary\+\_\+basics (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



From the masses and period, setup the information one needs to calculate the position of the Roche lobe of the secondary to calculate whether a photon intersects the surface of the star. 

\begin{DoxyReturn}{Returns}
Always returns 0 
\end{DoxyReturn}


Definition at line 81 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{roche_8c_a6a3c682535c3baaeb7c0e56ba18fe9da_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_a7b0bed5d82ce2310bbd039704b3567cd}\label{roche_8c_a7b0bed5d82ce2310bbd039704b3567cd}} 
\index{roche.\+c@{roche.\+c}!d2phi\+\_\+ds2@{d2phi\+\_\+ds2}}
\index{d2phi\+\_\+ds2@{d2phi\+\_\+ds2}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{d2phi\+\_\+ds2()}{d2phi\_ds2()}}
{\footnotesize\ttfamily double d2phi\+\_\+ds2 (\begin{DoxyParamCaption}\item[{double}]{s }\end{DoxyParamCaption})}



Calculate the second derivative of the Roche potential of the secondary. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance the phtoon has traveled from its inital postiion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The second deritave
\end{DoxyReturn}
\paragraph*{Notes}

This is a brute force calculation of the derivative 

Definition at line 549 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{roche_8c_a7b0bed5d82ce2310bbd039704b3567cd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430}\label{roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430}} 
\index{roche.\+c@{roche.\+c}!dphi\+\_\+ds@{dphi\+\_\+ds}}
\index{dphi\+\_\+ds@{dphi\+\_\+ds}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{dphi\+\_\+ds()}{dphi\_ds()}}
{\footnotesize\ttfamily double dphi\+\_\+ds (\begin{DoxyParamCaption}\item[{double}]{s }\end{DoxyParamCaption})}



Calculate the gradient of the Roche potential as the photon travels. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance the photon has traveled from its initial position \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the first derivative of the potential
\end{DoxyReturn}
This is a brute force calculation of the first derivative of the Roche potentail

\paragraph*{Notes}

Definition at line 517 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_aa85d6bb7bef49e7e4b18d238eb2e6430_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_aff5a3156ec26863e37ff61073bb97ca4}\label{roche_8c_aff5a3156ec26863e37ff61073bb97ca4}} 
\index{roche.\+c@{roche.\+c}!ds\+\_\+to\+\_\+roche\+\_\+2@{ds\+\_\+to\+\_\+roche\+\_\+2}}
\index{ds\+\_\+to\+\_\+roche\+\_\+2@{ds\+\_\+to\+\_\+roche\+\_\+2}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+roche\+\_\+2()}{ds\_to\_roche\_2()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+roche\+\_\+2 (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



Calculate the distance to the Roche surface for a photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p The photon whose path one wishes to track \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the distance to the roche surface of the secondary for photon p, or V\+E\+R\+Y\+\_\+\+B\+IG if the photon does not intercept the surface
\end{DoxyReturn}
Instead of simply determining whether the photon hits the Roche surface, this routine determine how far the photon would need to travel to hit the Roche surface.

\paragraph*{Notes}

This routine is currently not used in Python. It would be important if one actually wished to calculate the heating of the secondary.

If it were used for this purpose, one should confirm that it is working correctly 

Definition at line 186 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_aff5a3156ec26863e37ff61073bb97ca4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3}\label{roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3}} 
\index{roche.\+c@{roche.\+c}!hit\+\_\+secondary@{hit\+\_\+secondary}}
\index{hit\+\_\+secondary@{hit\+\_\+secondary}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{hit\+\_\+secondary()}{hit\_secondary()}}
{\footnotesize\ttfamily int hit\+\_\+secondary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



Find out whether a photon will hit the secondary, but don\textquotesingle{}t actually calculate the point where it hits. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p A photon, for which we have a possiton and adirection of travel \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the photon would miss the secondary, P\+\_\+\+S\+EC otherwise
\end{DoxyReturn}
The routine chacks whether a photon hits the Roche lobe of the secondary star.

\paragraph*{Notes}

The routine first checks if the photon encounters a pill\+\_\+box that surrouds the secondary. Photons that do not encounter this pill box do not hit the secondar. If the photon enters the pill box, then the routine determines whether the photon hits the roche surface of the secondary, by finding the minimum value of the Rooche potential. If this is greater than 0, then the photon has missed the secondary. If less thn zero then it has hit the secondary. 

Definition at line 263 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_ad4ca36cf5f0eaaa3fb044a982d922fb3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_a4a0210aea098f52ca60dfbc90de4ecee}\label{roche_8c_a4a0210aea098f52ca60dfbc90de4ecee}} 
\index{roche.\+c@{roche.\+c}!phi@{phi}}
\index{phi@{phi}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{phi()}{phi()}}
{\footnotesize\ttfamily double phi (\begin{DoxyParamCaption}\item[{double}]{s }\end{DoxyParamCaption})}



Calculate the Roche potential at position indicated by the photon p\+\_\+roche and the length s. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance from the current position of the photon to the point where one wishes to calculate the Roche potentail \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Roche potential at the postiong given by the photon moved by a distance s
\end{DoxyReturn}
Given a photon stored in p\+\_\+roche and a distance s to move the photone, phi returns the roche potentail at that point

\paragraph*{Notes}

Definition at line 457 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=199pt]{roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_a4a0210aea098f52ca60dfbc90de4ecee_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_a3a6359a23f10596d6bb51c80905c1c88}\label{roche_8c_a3a6359a23f10596d6bb51c80905c1c88}} 
\index{roche.\+c@{roche.\+c}!pillbox@{pillbox}}
\index{pillbox@{pillbox}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{pillbox()}{pillbox()}}
{\footnotesize\ttfamily double pillbox (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double $\ast$}]{smin,  }\item[{double $\ast$}]{smax }\end{DoxyParamCaption})}



Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p The photon whose trajectory we wish to examine \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ smin If the photon, hits the pillbox, this is how far the photon must travel to enter the pillbox \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ smax If the photon, hits the pillbox, this is how far the photon must travel to exit the pillbox \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pillbox returns V\+E\+R\+Y\+\_\+\+B\+IG if the photon p has not intersected the pillbox. It appears to return the distance to the pillbox if the photon p hits the pillbox. smin and smax contain the entrance and exit distances. It is not obvious that smin $<$ smax.
\end{DoxyReturn}
The purpose of this routine is to separate photons which may hit the Roche surface and those which certainly do not by seeing if the photon avoids a pillbox surrounding the secondary. If the photons does not enter the pillbox then one dos not have to explore in detail whether the photon hits the Roche surrvace.

If the photon does pass through the secondary, then the routine returns the distances of entry and exit which are used to limit the range of root finding that then must take place.

\paragraph*{Notes}

The pillbox is defined by a plane at L1, a plane on the backside of the star and a cylinder whose radius is the maximum (half) width of the star in the plane of the orbit.

This routine distinguishes two basic types of photons, \char`\"{}normal\char`\"{} and \char`\"{}abnormal\char`\"{} photons. A normal photon is on the WD side of L1 plane; an abnormal one is on the side of the L1 plane with the secondary.

Note\+: 01jul22 ksl revised this so that it would handle photons coming in all directions for use with plot\+\_\+roche but this instantiation of pillbox still seems to me not optical. The basic point is that unless the photon is in the pillbox, the only roots that matter are ones which are positive. Only inside the pillbox will there be a positive and a negative root. Here we try to correct this at the end by making sure that both roots are not negative, but one would have thought that one might establish that that photons inside the pillbox are special and dealt with them accordindly 

Definition at line 323 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_a3a6359a23f10596d6bb51c80905c1c88_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{roche_8c_a3a6359a23f10596d6bb51c80905c1c88_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_a9c51519f54c26122775ef8eaca1806d8}\label{roche_8c_a9c51519f54c26122775ef8eaca1806d8}} 
\index{roche.\+c@{roche.\+c}!roche@{roche}}
\index{roche@{roche}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{roche()}{roche()}}
{\footnotesize\ttfamily void roche (\begin{DoxyParamCaption}\item[{double}]{s,  }\item[{double $\ast$}]{value,  }\item[{double $\ast$}]{derivative }\end{DoxyParamCaption})}



Calculate the value of the Roche potential and its derivative along a particular lien of sight. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance s \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ value The value of the Roche potenial at a distance s along the path of the photon \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ derivative The derivative of the roche potential as the photon tavels \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N/A
\end{DoxyReturn}
This is the function used by the Recipes routine rtsafe to locate specific surfaces of the Roche potential. Here $\ast$value is phi and $\ast$derivative is the slope of phi at s along the vector defined by p\+\_\+roche. The value of phi has to be set in advance through geo.\+phi and would normally be that of the Roche lobe

\paragraph*{Notes}

The routime simply calls phi and dphi\+\_\+ds 

Definition at line 677 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{roche_8c_a9c51519f54c26122775ef8eaca1806d8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_a9c51519f54c26122775ef8eaca1806d8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937}\label{roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937}} 
\index{roche.\+c@{roche.\+c}!roche2\+\_\+width\+\_\+max@{roche2\+\_\+width\+\_\+max}}
\index{roche2\+\_\+width\+\_\+max@{roche2\+\_\+width\+\_\+max}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{roche2\+\_\+width\+\_\+max()}{roche2\_width\_max()}}
{\footnotesize\ttfamily double roche2\+\_\+width\+\_\+max (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Find the half width of the secondary Roche lobe. 

\begin{DoxyReturn}{Returns}
The half width is returned
\end{DoxyReturn}
Find the maximum half width of the Roche lobe of the secondary. This routine uses the NR routine golden to find the point in x where the Roche lobe is maximized.

\paragraph*{Notes}

Definition at line 631 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{roche_8c_a47fd8875ad403d2b3b7c51b3ce2e0937_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_aa72cfd7beaead2acdb08bb12eafa3197}\label{roche_8c_aa72cfd7beaead2acdb08bb12eafa3197}} 
\index{roche.\+c@{roche.\+c}!roche\+\_\+deriv@{roche\+\_\+deriv}}
\index{roche\+\_\+deriv@{roche\+\_\+deriv}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{roche\+\_\+deriv()}{roche\_deriv()}}
{\footnotesize\ttfamily void roche\+\_\+deriv (\begin{DoxyParamCaption}\item[{double}]{s,  }\item[{double $\ast$}]{value,  }\item[{double $\ast$}]{derivative }\end{DoxyParamCaption})}



Calculate the first and second derivative of the roche potential along a specific line of sight. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance from the initial photon position at which derivatives are to be calcualted \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ value The first derivative \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ derivative The second derivatiove \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N/A
\end{DoxyReturn}
This is the function used by the Recipes routine rtsafe to lacate extrema of the Roche potential. Thus it can be used to find the L1 point, for example. Here $\ast$value is the derivative of phi at s along the vector defined by p\+\_\+roche, and $\ast$derivative is the second derivative

\paragraph*{Notes}

Definition at line 707 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{roche_8c_aa72cfd7beaead2acdb08bb12eafa3197_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{roche_8c_aa6c77132d4fe5cdf4cb3d66186981228}\label{roche_8c_aa6c77132d4fe5cdf4cb3d66186981228}} 
\index{roche.\+c@{roche.\+c}!roche\+\_\+width@{roche\+\_\+width}}
\index{roche\+\_\+width@{roche\+\_\+width}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{roche\+\_\+width()}{roche\_width()}}
{\footnotesize\ttfamily double roche\+\_\+width (\begin{DoxyParamCaption}\item[{double}]{x }\end{DoxyParamCaption})}



Calculate the width of the Roche potentiil at a position x along the x axis. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & x The distance the phtoon has traveled from its initial position\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the width
\end{DoxyReturn}
Calculate the half width of the Roche lobe at the position x along the x axis in the plane of the orbit.

\paragraph*{Notes}

There is no real guarantee that this would work if you were outside L2 or L3. 

Definition at line 586 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{roche_8c_aa6c77132d4fe5cdf4cb3d66186981228_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{roche_8c_a18146e93d3e11a3c0fae56976057c12f}\label{roche_8c_a18146e93d3e11a3c0fae56976057c12f}} 
\index{roche.\+c@{roche.\+c}!p\+\_\+roche@{p\+\_\+roche}}
\index{p\+\_\+roche@{p\+\_\+roche}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{p\+\_\+roche}{p\_roche}}
{\footnotesize\ttfamily struct \hyperlink{structphoton}{photon} p\+\_\+roche}

p\+\_\+roche provides a way to pass a photon structure to \hyperlink{roche_8c_a9c51519f54c26122775ef8eaca1806d8}{roche()} and roche\+\_\+derive which are in turn used by the Numerical Recipes Routine rtsafe to find the zero either to dphi\+\_\+ds or to phi along the path lenght of the photon 

Definition at line 65 of file roche.\+c.

\mbox{\Hypertarget{roche_8c_a5c49fe0824ac783b653795bdec304d52}\label{roche_8c_a5c49fe0824ac783b653795bdec304d52}} 
\index{roche.\+c@{roche.\+c}!phi\+\_\+3@{phi\+\_\+3}}
\index{phi\+\_\+3@{phi\+\_\+3}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{phi\+\_\+3}{phi\_3}}
{\footnotesize\ttfamily double phi\+\_\+3}



Definition at line 439 of file roche.\+c.

\mbox{\Hypertarget{roche_8c_a0fb4d1a2dda34ad3175ec3102efbbe55}\label{roche_8c_a0fb4d1a2dda34ad3175ec3102efbbe55}} 
\index{roche.\+c@{roche.\+c}!phi\+\_\+4@{phi\+\_\+4}}
\index{phi\+\_\+4@{phi\+\_\+4}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{phi\+\_\+4}{phi\_4}}
{\footnotesize\ttfamily double phi\+\_\+4}



Definition at line 439 of file roche.\+c.

\mbox{\Hypertarget{roche_8c_aa745f36e93f2d6e087104c461c0d8299}\label{roche_8c_aa745f36e93f2d6e087104c461c0d8299}} 
\index{roche.\+c@{roche.\+c}!phi\+\_\+gm1@{phi\+\_\+gm1}}
\index{phi\+\_\+gm1@{phi\+\_\+gm1}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{phi\+\_\+gm1}{phi\_gm1}}
{\footnotesize\ttfamily double phi\+\_\+gm1}



Definition at line 439 of file roche.\+c.

\mbox{\Hypertarget{roche_8c_ac3c00f91fc3b74caefda51e0b780164a}\label{roche_8c_ac3c00f91fc3b74caefda51e0b780164a}} 
\index{roche.\+c@{roche.\+c}!phi\+\_\+gm2@{phi\+\_\+gm2}}
\index{phi\+\_\+gm2@{phi\+\_\+gm2}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{phi\+\_\+gm2}{phi\_gm2}}
{\footnotesize\ttfamily double phi\+\_\+gm2}



Definition at line 439 of file roche.\+c.

\mbox{\Hypertarget{roche_8c_adc09e0999f545c5536ae23fb5af7d6af}\label{roche_8c_adc09e0999f545c5536ae23fb5af7d6af}} 
\index{roche.\+c@{roche.\+c}!phi\+\_\+init@{phi\+\_\+init}}
\index{phi\+\_\+init@{phi\+\_\+init}!roche.\+c@{roche.\+c}}
\subsubsection{\texorpdfstring{phi\+\_\+init}{phi\_init}}
{\footnotesize\ttfamily int phi\+\_\+init = 0}



Definition at line 438 of file roche.\+c.

