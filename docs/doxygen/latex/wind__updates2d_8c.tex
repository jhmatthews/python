\hypertarget{wind__updates2d_8c}{}\section{/\+Users/mhewitt/python/source/wind\+\_\+updates2d.c File Reference}
\label{wind__updates2d_8c}\index{/\+Users/mhewitt/python/source/wind\+\_\+updates2d.\+c@{/\+Users/mhewitt/python/source/wind\+\_\+updates2d.\+c}}


This file contains the main routines for updating and then reinitializing the wind after an ionization cycle.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for wind\+\_\+updates2d.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind__updates2d_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{wind__updates2d_8c_a764eaf37b6117ac7a17b1c049c1d2d16}{L\+I\+N\+E\+L\+EN}~256
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{wind__updates2d_8c_a33b6675f8fdb790ed332fd9f5df994d3}{wind\+\_\+update} (w)
\begin{DoxyCompactList}\small\item\em updates the parameters in the wind that are affected by radiation, including ion densities. \end{DoxyCompactList}\item 
int \hyperlink{wind__updates2d_8c_aa1f75e088856c1c47527ce62bea5c913}{wind\+\_\+rad\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em zeros those portions of the wind which contain the radiation properties of the wind, i.\+e those portions which should be set to zeroed when the structure of the wind has been changed or when you simply want to start off a calculation in a known state \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{wind__updates2d_8c_a3c086b2e71aab221283031cdd9ae00ba}{num\+\_\+updates} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file contains the main routines for updating and then reinitializing the wind after an ionization cycle. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May, 2018
\end{DoxyDate}
The routines in this file are generic. There is no dependence on a particlar wind model or any coordinate system dependences. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{wind__updates2d_8c_a764eaf37b6117ac7a17b1c049c1d2d16}\label{wind__updates2d_8c_a764eaf37b6117ac7a17b1c049c1d2d16}} 
\index{wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}!L\+I\+N\+E\+L\+EN@{L\+I\+N\+E\+L\+EN}}
\index{L\+I\+N\+E\+L\+EN@{L\+I\+N\+E\+L\+EN}!wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}}
\subsubsection{\texorpdfstring{L\+I\+N\+E\+L\+EN}{LINELEN}}
{\footnotesize\ttfamily \#define L\+I\+N\+E\+L\+EN~256}



Definition at line 22 of file wind\+\_\+updates2d.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{wind__updates2d_8c_aa1f75e088856c1c47527ce62bea5c913}\label{wind__updates2d_8c_aa1f75e088856c1c47527ce62bea5c913}} 
\index{wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}!wind\+\_\+rad\+\_\+init@{wind\+\_\+rad\+\_\+init}}
\index{wind\+\_\+rad\+\_\+init@{wind\+\_\+rad\+\_\+init}!wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+rad\+\_\+init()}{wind\_rad\_init()}}
{\footnotesize\ttfamily int wind\+\_\+rad\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



zeros those portions of the wind which contain the radiation properties of the wind, i.\+e those portions which should be set to zeroed when the structure of the wind has been changed or when you simply want to start off a calculation in a known state 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine is called at the beginning of each ionization calculation cycle. It should zero all heating and radiation induced cooling in the wind array. Since cooling is recalculated in wind\+\_\+update, one needs to be sure that all of the appropriate cooling terms are also rezeroed there as well.

\paragraph*{Notes}

Definition at line 1013 of file wind\+\_\+updates2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=224pt]{wind__updates2d_8c_aa1f75e088856c1c47527ce62bea5c913_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=259pt]{wind__updates2d_8c_aa1f75e088856c1c47527ce62bea5c913_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind__updates2d_8c_a33b6675f8fdb790ed332fd9f5df994d3}\label{wind__updates2d_8c_a33b6675f8fdb790ed332fd9f5df994d3}} 
\index{wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}!wind\+\_\+update@{wind\+\_\+update}}
\index{wind\+\_\+update@{wind\+\_\+update}!wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+update()}{wind\_update()}}
{\footnotesize\ttfamily int wind\+\_\+update (\begin{DoxyParamCaption}\item[{w}]{ }\end{DoxyParamCaption})}



updates the parameters in the wind that are affected by radiation, including ion densities. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & The entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is the main routine used to update the wind at the end of an ionization cycle (in preparation for a new cycle). The routine is parallelized to save time

\paragraph*{Notes}

At the time wind\+\_\+update is called the various quantities that are accumulated during the photon transfer part of the cycle has been accumulated and shared between the threads. Here certain plasma cells are assigned to each thread so that the ionization structure can be updated, and each thread is responsible for calculaing the updates for a certain set of cells. At the end of the routine the updates are collected and reshared.

The real need for prallelising the routine is the work done in ion\+\_\+abundances

Once this is done, various checks are made to determined what happened as a function of the updates, various variables in geo are updated, and for a hydro model the results are written to a file

This routine is nearly 1000 lines long and might beneifit from breaking it into functionl blocks, e.\+g by separating out the mpi communicaiton into their own routines. 

Definition at line 62 of file wind\+\_\+updates2d.\+c.



\subsection{Variable Documentation}
\mbox{\Hypertarget{wind__updates2d_8c_a3c086b2e71aab221283031cdd9ae00ba}\label{wind__updates2d_8c_a3c086b2e71aab221283031cdd9ae00ba}} 
\index{wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}!num\+\_\+updates@{num\+\_\+updates}}
\index{num\+\_\+updates@{num\+\_\+updates}!wind\+\_\+updates2d.\+c@{wind\+\_\+updates2d.\+c}}
\subsubsection{\texorpdfstring{num\+\_\+updates}{num\_updates}}
{\footnotesize\ttfamily int num\+\_\+updates = 0}



Definition at line 26 of file wind\+\_\+updates2d.\+c.

