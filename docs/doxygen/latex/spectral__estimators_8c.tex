\hypertarget{spectral__estimators_8c}{}\section{/\+Users/mhewitt/python/source/spectral\+\_\+estimators.c File Reference}
\label{spectral__estimators_8c}\index{/\+Users/mhewitt/python/source/spectral\+\_\+estimators.\+c@{/\+Users/mhewitt/python/source/spectral\+\_\+estimators.\+c}}


The routines in this file are all associated with the process of modelling the spectrum in a cell.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for spectral\+\_\+estimators.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spectral__estimators_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{spectral__estimators_8c_abe28dc93125bf28e9c3dcef85428b16a}{spectral\+\_\+estimators} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em Calculate the parameters of a model for J\+\_\+nu in a cell. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_a5c555bf81b13fcd5357bda01781ea3bc}{pl\+\_\+alpha\+\_\+func\+\_\+log} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em Function used in zbrent to work out best value of alpha for a power law model. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_a1df982c704d2defe2182934f2ab66b70}{pl\+\_\+logmean} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double lnumin, double lnumax)
\begin{DoxyCompactList}\small\item\em Computes the mean frequency of a power law with exponent alpha. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_abba07de067655328106ec96798c4794d}{pl\+\_\+log\+\_\+w} (double \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double lnumin, double lnumax)
\begin{DoxyCompactList}\small\item\em works out the scaling factor for a power law representation of a cell spectrum \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_a29985eb821f4ce1d32c191926b84fe59}{pl\+\_\+log\+\_\+stddev} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double lnumin, double lnumax)
\begin{DoxyCompactList}\small\item\em Work out the standard deviation of a power law spectral model. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_a17dff6266e67bdc289c6ac89d1a230b7}{exp\+\_\+temp\+\_\+func} (double exp\+\_\+temp)
\begin{DoxyCompactList}\small\item\em Function used in zbrent to work out best value of alpha for a power law model. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_ad5da2d7b86cbdf86c1fc733c56d9f302}{exp\+\_\+mean} (double exp\+\_\+temp, double numin, double numax)
\begin{DoxyCompactList}\small\item\em Calculate the mean frequency of an exponential distribution. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_ad6d1b9b9650b2f9e2f3bd72bfb5e5382}{exp\+\_\+w} (double \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, double exp\+\_\+temp, double numin, double numax)
\begin{DoxyCompactList}\small\item\em This program works out the scaling factor for an exponential representation of a spectrum. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_a288f4e76f4f5ee38900c0f14b5a4ac21}{exp\+\_\+stddev} (double exp\+\_\+temp, double numin, double numax)
\begin{DoxyCompactList}\small\item\em This program works out the standard deviation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{spectral__estimators_8c_a2c126aede9718815314870d9b62cec10}{spec\+\_\+numin}
\begin{DoxyCompactList}\small\item\em Minimum, maximum and mean frequency in a band. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_aa94a84f27fff83979e0d2d6666136468}{spec\+\_\+numax}
\item 
double \hyperlink{spectral__estimators_8c_af642f5e60854ca96682e040f6e58daa5}{spec\+\_\+numean}
\item 
double \hyperlink{spectral__estimators_8c_a6dced2d0b5c9b517b66f3675f8d8c320}{lspec\+\_\+numin}
\begin{DoxyCompactList}\small\item\em Log versions of numin and numax -\/ the band ends. \end{DoxyCompactList}\item 
double \hyperlink{spectral__estimators_8c_a88893a4c5839e7dbbceeee2494e9a517}{lspec\+\_\+numax}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The routines in this file are all associated with the process of modelling the spectrum in a cell. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018
\end{DoxyDate}
??? 

\subsection{Function Documentation}
\mbox{\Hypertarget{spectral__estimators_8c_ad5da2d7b86cbdf86c1fc733c56d9f302}\label{spectral__estimators_8c_ad5da2d7b86cbdf86c1fc733c56d9f302}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!exp\+\_\+mean@{exp\+\_\+mean}}
\index{exp\+\_\+mean@{exp\+\_\+mean}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{exp\+\_\+mean()}{exp\_mean()}}
{\footnotesize\ttfamily double exp\+\_\+mean (\begin{DoxyParamCaption}\item[{double}]{exp\+\_\+temp,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}



Calculate the mean frequency of an exponential distribution. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & exp\+\_\+temp The effective temperature of the distribution \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Miniumum frequency \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The mean frequency
\end{DoxyReturn}
The mean of a frequency depedant mean inteisntiy is the integral of nu j(nu) divided by the integral of j(nu). The prefactor w is lost in the division, so this function should equal the mean frequency. Since this is a simple algrebraic frequency distribution we can integrate algebraically

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 555 of file spectral\+\_\+estimators.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spectral__estimators_8c_ad5da2d7b86cbdf86c1fc733c56d9f302_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_a288f4e76f4f5ee38900c0f14b5a4ac21}\label{spectral__estimators_8c_a288f4e76f4f5ee38900c0f14b5a4ac21}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!exp\+\_\+stddev@{exp\+\_\+stddev}}
\index{exp\+\_\+stddev@{exp\+\_\+stddev}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{exp\+\_\+stddev()}{exp\_stddev()}}
{\footnotesize\ttfamily double exp\+\_\+stddev (\begin{DoxyParamCaption}\item[{double}]{exp\+\_\+temp,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}



This program works out the standard deviation. 


\begin{DoxyParams}[1]{Parameters}
 & {\em \mbox{[}in} & out\mbox{]} double exp\+\_\+temp -\/ the temperature of the exponential model of J\+\_\+nu \\
\hline
\mbox{\tt in}  & {\em double} & numin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & numax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The standard deviation of the mean intensity model
\end{DoxyReturn}
First we work out the integral of nu$^\wedge$2 jnu / int jnu. Then we subtract the (mean/j)$^\wedge$2 and then take the square root.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 642 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=223pt]{spectral__estimators_8c_a288f4e76f4f5ee38900c0f14b5a4ac21_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{spectral__estimators_8c_a288f4e76f4f5ee38900c0f14b5a4ac21_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_a17dff6266e67bdc289c6ac89d1a230b7}\label{spectral__estimators_8c_a17dff6266e67bdc289c6ac89d1a230b7}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!exp\+\_\+temp\+\_\+func@{exp\+\_\+temp\+\_\+func}}
\index{exp\+\_\+temp\+\_\+func@{exp\+\_\+temp\+\_\+func}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{exp\+\_\+temp\+\_\+func()}{exp\_temp\_func()}}
{\footnotesize\ttfamily double exp\+\_\+temp\+\_\+func (\begin{DoxyParamCaption}\item[{double}]{exp\+\_\+temp }\end{DoxyParamCaption})}



Function used in zbrent to work out best value of alpha for a power law model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & exp\+\_\+temp The effective temperature of an expontential model for J\+\_\+nu \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Difference between the mean of a modelled photon spectrum and the observed one
\end{DoxyReturn}
This function is used in zbrent to search for the value of \textquotesingle{}temperature\textquotesingle{} which makes the mean frequewncy from an expoential model (coputed in a subroutine) function equal to the mean frequency computed for the cell from photon packets. So we subtract the mean frequency at the end to make the value of the function equal to zero at the correct temperature.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 523 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{spectral__estimators_8c_a17dff6266e67bdc289c6ac89d1a230b7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{spectral__estimators_8c_a17dff6266e67bdc289c6ac89d1a230b7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_ad6d1b9b9650b2f9e2f3bd72bfb5e5382}\label{spectral__estimators_8c_ad6d1b9b9650b2f9e2f3bd72bfb5e5382}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!exp\+\_\+w@{exp\+\_\+w}}
\index{exp\+\_\+w@{exp\+\_\+w}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{exp\+\_\+w()}{exp\_w()}}
{\footnotesize\ttfamily double exp\+\_\+w (\begin{DoxyParamCaption}\item[{double}]{j,  }\item[{double}]{exp\+\_\+temp,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}



This program works out the scaling factor for an exponential representation of a spectrum. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & j The \textquotesingle{}measured\textquotesingle{} mean intensity for a cell/band \\
\hline
 & {\em \mbox{[}in} & out\mbox{]} double exp\+\_\+temp -\/ the temperature of the exponential model of J\+\_\+nu \\
\hline
\mbox{\tt in}  & {\em double} & numin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & numax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
w -\/ the scaling factor
\end{DoxyReturn}
We compute J/W= integral from numin to numax of e$^\wedge$(-\/nhu/kt). We then obtain W by comparing this number to the measured mean intensity in the band

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 600 of file spectral\+\_\+estimators.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{spectral__estimators_8c_ad6d1b9b9650b2f9e2f3bd72bfb5e5382_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_a5c555bf81b13fcd5357bda01781ea3bc}\label{spectral__estimators_8c_a5c555bf81b13fcd5357bda01781ea3bc}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!pl\+\_\+alpha\+\_\+func\+\_\+log@{pl\+\_\+alpha\+\_\+func\+\_\+log}}
\index{pl\+\_\+alpha\+\_\+func\+\_\+log@{pl\+\_\+alpha\+\_\+func\+\_\+log}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{pl\+\_\+alpha\+\_\+func\+\_\+log()}{pl\_alpha\_func\_log()}}
{\footnotesize\ttfamily double pl\+\_\+alpha\+\_\+func\+\_\+log (\begin{DoxyParamCaption}\item[{double}]{alpha }\end{DoxyParamCaption})}



Function used in zbrent to work out best value of alpha for a power law model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha -\/ the exponent of a power law model for J\+\_\+nu \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Difference between the mean of a modelled photon spectrum and the observed one
\end{DoxyReturn}
The function is just subtracts the \textquotesingle{}observed\textquotesingle{} mean frequency of the photons which passed thruogh as cell from thr mean frequency of a power law spectral model (which is computed externally). This is used in a zero finding function to work out the best value of alpha.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 361 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=319pt]{spectral__estimators_8c_a5c555bf81b13fcd5357bda01781ea3bc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{spectral__estimators_8c_a5c555bf81b13fcd5357bda01781ea3bc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_a29985eb821f4ce1d32c191926b84fe59}\label{spectral__estimators_8c_a29985eb821f4ce1d32c191926b84fe59}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!pl\+\_\+log\+\_\+stddev@{pl\+\_\+log\+\_\+stddev}}
\index{pl\+\_\+log\+\_\+stddev@{pl\+\_\+log\+\_\+stddev}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{pl\+\_\+log\+\_\+stddev()}{pl\_log\_stddev()}}
{\footnotesize\ttfamily double pl\+\_\+log\+\_\+stddev (\begin{DoxyParamCaption}\item[{double}]{alpha,  }\item[{double}]{lnumin,  }\item[{double}]{lnumax }\end{DoxyParamCaption})}



Work out the standard deviation of a power law spectral model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha The exponent of the power law representation \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The standard deviation
\end{DoxyReturn}
This subroutine works out the standard deviation of a photon distribution modelled by a power law. First we work out the integral of nu$^\wedge$2 jnu / int jnu. Then we subtract the (mean/j)$^\wedge$2 and then take the square root.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 470 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{spectral__estimators_8c_a29985eb821f4ce1d32c191926b84fe59_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{spectral__estimators_8c_a29985eb821f4ce1d32c191926b84fe59_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_abba07de067655328106ec96798c4794d}\label{spectral__estimators_8c_abba07de067655328106ec96798c4794d}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!pl\+\_\+log\+\_\+w@{pl\+\_\+log\+\_\+w}}
\index{pl\+\_\+log\+\_\+w@{pl\+\_\+log\+\_\+w}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{pl\+\_\+log\+\_\+w()}{pl\_log\_w()}}
{\footnotesize\ttfamily double pl\+\_\+log\+\_\+w (\begin{DoxyParamCaption}\item[{double}]{j,  }\item[{double}]{alpha,  }\item[{double}]{lnumin,  }\item[{double}]{lnumax }\end{DoxyParamCaption})}



works out the scaling factor for a power law representation of a cell spectrum 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & j The \textquotesingle{}measured\textquotesingle{} mean intensity for a cell/band \\
\hline
\mbox{\tt in}  & {\em double} & alpha The exponent of the power law representation \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
logw -\/ the log of the scaling factor
\end{DoxyReturn}
This routine works out the scaling factor for a power law representation of a spectrum in a cell -\/ the W in J\+\_\+nu=Wnu$\ast$$\ast$alpha. Assuming alpha is known, it computes w for J=W x integral from numin to numax of nu$^\wedge$alpha. For a power law model, the integral is easily done numercially. We work in log space to allow huge numbers to work and not give errors.

\paragraph*{Notes}

Definition at line 432 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{spectral__estimators_8c_abba07de067655328106ec96798c4794d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{spectral__estimators_8c_abba07de067655328106ec96798c4794d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_a1df982c704d2defe2182934f2ab66b70}\label{spectral__estimators_8c_a1df982c704d2defe2182934f2ab66b70}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!pl\+\_\+logmean@{pl\+\_\+logmean}}
\index{pl\+\_\+logmean@{pl\+\_\+logmean}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{pl\+\_\+logmean()}{pl\_logmean()}}
{\footnotesize\ttfamily double pl\+\_\+logmean (\begin{DoxyParamCaption}\item[{double}]{alpha,  }\item[{double}]{lnumin,  }\item[{double}]{lnumax }\end{DoxyParamCaption})}



Computes the mean frequency of a power law with exponent alpha. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha The exponent of the power law \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Miniumum frequency \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the mean frequency
\end{DoxyReturn}
This function computes the mean frequency of a power law disturbution. It is essentially a ratio of two integrals (nu\+Jnu) / (Jnu) For a power law this can be done algegraically, so we do that

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 390 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{spectral__estimators_8c_a1df982c704d2defe2182934f2ab66b70_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spectral__estimators_8c_a1df982c704d2defe2182934f2ab66b70_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spectral__estimators_8c_abe28dc93125bf28e9c3dcef85428b16a}\label{spectral__estimators_8c_abe28dc93125bf28e9c3dcef85428b16a}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!spectral\+\_\+estimators@{spectral\+\_\+estimators}}
\index{spectral\+\_\+estimators@{spectral\+\_\+estimators}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{spectral\+\_\+estimators()}{spectral\_estimators()}}
{\footnotesize\ttfamily int spectral\+\_\+estimators (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



Calculate the parameters of a model for J\+\_\+nu in a cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma Pointer to the plasma structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
This routine uses the mean frequency (calculated in the photon transsport cycle) find a power law model and an exponential model. It then uses the standard deviation to decide which is best. The routine is called from \hyperlink{ionization_8c}{ionization.\+c} The results are stored in parameters in the Plasma\+Ptr structure in variables, such as spec\+\_\+mod\+\_\+type, pl\+\_\+alpah, pl\+\_\+log,exp\+\_\+temp, etc.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 52 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spectral__estimators_8c_abe28dc93125bf28e9c3dcef85428b16a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=270pt]{spectral__estimators_8c_abe28dc93125bf28e9c3dcef85428b16a_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{spectral__estimators_8c_a88893a4c5839e7dbbceeee2494e9a517}\label{spectral__estimators_8c_a88893a4c5839e7dbbceeee2494e9a517}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!lspec\+\_\+numax@{lspec\+\_\+numax}}
\index{lspec\+\_\+numax@{lspec\+\_\+numax}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{lspec\+\_\+numax}{lspec\_numax}}
{\footnotesize\ttfamily double lspec\+\_\+numax}



Definition at line 27 of file spectral\+\_\+estimators.\+c.

\mbox{\Hypertarget{spectral__estimators_8c_a6dced2d0b5c9b517b66f3675f8d8c320}\label{spectral__estimators_8c_a6dced2d0b5c9b517b66f3675f8d8c320}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!lspec\+\_\+numin@{lspec\+\_\+numin}}
\index{lspec\+\_\+numin@{lspec\+\_\+numin}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{lspec\+\_\+numin}{lspec\_numin}}
{\footnotesize\ttfamily double lspec\+\_\+numin}



Log versions of numin and numax -\/ the band ends. 



Definition at line 27 of file spectral\+\_\+estimators.\+c.

\mbox{\Hypertarget{spectral__estimators_8c_aa94a84f27fff83979e0d2d6666136468}\label{spectral__estimators_8c_aa94a84f27fff83979e0d2d6666136468}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!spec\+\_\+numax@{spec\+\_\+numax}}
\index{spec\+\_\+numax@{spec\+\_\+numax}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{spec\+\_\+numax}{spec\_numax}}
{\footnotesize\ttfamily double spec\+\_\+numax}



Definition at line 25 of file spectral\+\_\+estimators.\+c.

\mbox{\Hypertarget{spectral__estimators_8c_af642f5e60854ca96682e040f6e58daa5}\label{spectral__estimators_8c_af642f5e60854ca96682e040f6e58daa5}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!spec\+\_\+numean@{spec\+\_\+numean}}
\index{spec\+\_\+numean@{spec\+\_\+numean}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{spec\+\_\+numean}{spec\_numean}}
{\footnotesize\ttfamily double spec\+\_\+numean}



Definition at line 25 of file spectral\+\_\+estimators.\+c.

\mbox{\Hypertarget{spectral__estimators_8c_a2c126aede9718815314870d9b62cec10}\label{spectral__estimators_8c_a2c126aede9718815314870d9b62cec10}} 
\index{spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}!spec\+\_\+numin@{spec\+\_\+numin}}
\index{spec\+\_\+numin@{spec\+\_\+numin}!spectral\+\_\+estimators.\+c@{spectral\+\_\+estimators.\+c}}
\subsubsection{\texorpdfstring{spec\+\_\+numin}{spec\_numin}}
{\footnotesize\ttfamily double spec\+\_\+numin}



Minimum, maximum and mean frequency in a band. 



Definition at line 25 of file spectral\+\_\+estimators.\+c.

