\hypertarget{compton_8c}{}\section{/\+Users/mhewitt/python/source/compton.c File Reference}
\label{compton_8c}\index{/\+Users/mhewitt/python/source/compton.\+c@{/\+Users/mhewitt/python/source/compton.\+c}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for compton.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{compton_8c_a058633208c21e33eb49a33bd82c6327d}{kappa\+\_\+comp} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double freq)
\begin{DoxyCompactList}\small\item\em Pointer to current plasma cell. \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_a3ce17d1882989bac342f4bc4d1e0a7b6}{kappa\+\_\+ind\+\_\+comp} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double freq)
\begin{DoxyCompactList}\small\item\em Computes the effective opacity in the cell due to {\itshape induced} compton heating. \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_a560f4bd0619fdb29b85891d46ce63a48}{total\+\_\+comp} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the cooling in the cell due to inverse compton scattering. \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_a28be66a0a760ceb7b8394a5a8e7526af}{klein\+\_\+nishina} (double nu)
\begin{DoxyCompactList}\small\item\em computes the Klein Nishina cross section for a photon of frequency nu. \end{DoxyCompactList}\item 
int \hyperlink{compton_8c_a9300319cf99a4a66db3876befda54050}{compton\+\_\+dir} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em computes a random direction for a photon undergoing compton scattering. \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_a9891de810e686fa36209796ff1704fa3}{compton\+\_\+func} (double f)
\begin{DoxyCompactList}\small\item\em Function used to find the fractional energy change for a given cross-\/section in the compton scattering limit. \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_add111df2de1b0fadab91816f33ee5266}{sigma\+\_\+compton\+\_\+partial} (double f, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em is the Klein Nishina cross section as a function of the fractional energy change \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_a89a27f4f3a5c836df75585774ba7a643}{alpha} (double nu)
\begin{DoxyCompactList}\small\item\em The \textquotesingle{}heating\textquotesingle{} cross section correction to Thompson. \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_a5bffcc1725b11f5b35c37b406aaec263}{beta} (double nu)
\begin{DoxyCompactList}\small\item\em The \textquotesingle{}cooling\textquotesingle{} cross section correction to Thompson. \end{DoxyCompactList}\item 
double \hyperlink{compton_8c_a2f793ca07e9f7ec0220090b8f6b73634}{comp\+\_\+cool\+\_\+integrand} (double nu)
\begin{DoxyCompactList}\small\item\em The integrand in the integral to obtain the total cooling rate due to inverse compton scattering. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}
\item 
double \hyperlink{compton_8c_a1f82287c66f68d9fd6443c3c2d20cc2f}{sigma\+\_\+rand}
\item 
double \hyperlink{compton_8c_a13ac4700886a0380aa7d6a568a839c96}{sigma\+\_\+max}
\item 
double \hyperlink{compton_8c_ac75b803b570527306e1e744bfb7a604f}{x1}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{compton_8c_a89a27f4f3a5c836df75585774ba7a643}\label{compton_8c_a89a27f4f3a5c836df75585774ba7a643}} 
\index{compton.\+c@{compton.\+c}!alpha@{alpha}}
\index{alpha@{alpha}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{alpha()}{alpha()}}
{\footnotesize\ttfamily double alpha (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



The \textquotesingle{}heating\textquotesingle{} cross section correction to Thompson. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
alpha-\/ the effective heating cross section relative to sigma\+\_\+T
\end{DoxyReturn}
We calculate compton heating due to photons passing through a parcel of gas using an opacity. In order to work out the opacity, we need the cross section that the electrons present to the photons, and in order to take proper account of the energy transfer during a scatter we use a \textquotesingle{}heating crosss ection\textquotesingle{}. This is equal to \textquotesingle{}alpha\textquotesingle{} times the Thompson cross section -\/ we calculate alpha here.

\paragraph*{Notes}

The fit used here is given in Hazy 3, eq 6.\+6 

Definition at line 437 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=115pt]{compton_8c_a89a27f4f3a5c836df75585774ba7a643_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a89a27f4f3a5c836df75585774ba7a643_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a5bffcc1725b11f5b35c37b406aaec263}\label{compton_8c_a5bffcc1725b11f5b35c37b406aaec263}} 
\index{compton.\+c@{compton.\+c}!beta@{beta}}
\index{beta@{beta}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{beta()}{beta()}}
{\footnotesize\ttfamily double beta (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



The \textquotesingle{}cooling\textquotesingle{} cross section correction to Thompson. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
beta -\/ the effective cooling cross section relative to sigma\+\_\+T
\end{DoxyReturn}
The inverse compton cooling rate in a cell is computed by ingegrating the mean intensity in that cell by the frequency dependant cross section. In order to take account of the energy transfer in an interaction, the cross section must be the effective cooling cross section (not just the Klein Nishina cross section)

\paragraph*{Notes}

The fit used here is given in Hazy 3, eq 6.\+6 

Definition at line 469 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=182pt]{compton_8c_a5bffcc1725b11f5b35c37b406aaec263_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a5bffcc1725b11f5b35c37b406aaec263_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a2f793ca07e9f7ec0220090b8f6b73634}\label{compton_8c_a2f793ca07e9f7ec0220090b8f6b73634}} 
\index{compton.\+c@{compton.\+c}!comp\+\_\+cool\+\_\+integrand@{comp\+\_\+cool\+\_\+integrand}}
\index{comp\+\_\+cool\+\_\+integrand@{comp\+\_\+cool\+\_\+integrand}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{comp\+\_\+cool\+\_\+integrand()}{comp\_cool\_integrand()}}
{\footnotesize\ttfamily double comp\+\_\+cool\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



The integrand in the integral to obtain the total cooling rate due to inverse compton scattering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
frequwncy dependant cross section multiplied by the mean intensity at frequency nu
\end{DoxyReturn}
This is is the integrand sigma x J\+\_\+nu that is integrated to obtain the compton cooling rate in a cell. The sigma in question is the effective energy exchange cross section, which for coolnig is /alpha/beta/sigma\+\_\+T. These alpha and beta terms are computed in ther subroutines, but here we only need to use , because the  term is taken account of when we compute J\+\_\+nu during the photon transport phase of the code. If we are calling this function, we know we have a model so there is no need to protect against the problem of not having a model

\paragraph*{Notes}

See Hazy 3 eq 6.\+6 for more details of this approach 

Definition at line 508 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{compton_8c_a2f793ca07e9f7ec0220090b8f6b73634_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a2f793ca07e9f7ec0220090b8f6b73634_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a9300319cf99a4a66db3876befda54050}\label{compton_8c_a9300319cf99a4a66db3876befda54050}} 
\index{compton.\+c@{compton.\+c}!compton\+\_\+dir@{compton\+\_\+dir}}
\index{compton\+\_\+dir@{compton\+\_\+dir}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{compton\+\_\+dir()}{compton\_dir()}}
{\footnotesize\ttfamily int compton\+\_\+dir (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



computes a random direction for a photon undergoing compton scattering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p -\/ the photon currently being scattered \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ the cell in which the scattering is taking place \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful -\/ the new direction is returned as part of the photon structure
\end{DoxyReturn}
This routine computes a new direction (and energy change) for a photon undergoing compton scattering. If the freqiuency is low with respect to the electron rest mass then it is totaslly elastic, isotropic Thompson scattering.

\paragraph*{Notes}

E\+Verything is calculated in the rest frame of the electron. In this frame, the photon energy change is E/E\textquotesingle{}=1+(hnu/mc$^\wedge$2)(1+cos) where  is the angle thruogh which the photon is deflected. This is a maximum for =180 -\/ E/E\textquotesingle{}=1+2hnumc$^\wedge$2 and minimum for =0 -\/ E/E\textquotesingle{}=1 We compute everything by first drawing a random cross section that our photon packet will see. This cross section represents an energy change and hence a direction. The distribnution of angles is taken care of by using a differential cross section vs energy change function. So we work out what energy change and hence direction is implied by our random cross section. 

Definition at line 289 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a9300319cf99a4a66db3876befda54050_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=213pt]{compton_8c_a9300319cf99a4a66db3876befda54050_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a9891de810e686fa36209796ff1704fa3}\label{compton_8c_a9891de810e686fa36209796ff1704fa3}} 
\index{compton.\+c@{compton.\+c}!compton\+\_\+func@{compton\+\_\+func}}
\index{compton\+\_\+func@{compton\+\_\+func}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{compton\+\_\+func()}{compton\_func()}}
{\footnotesize\ttfamily double compton\+\_\+func (\begin{DoxyParamCaption}\item[{double}]{f }\end{DoxyParamCaption})}



Function used to find the fractional energy change for a given cross-\/section in the compton scattering limit. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} double f The fractional energy change of a photon undergoing scattering \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the difference between sigma(f) and the randomised cross section we are searching for
\end{DoxyReturn}
This function calculates the difference between the KN cross section for a given fractional energy loss f/x1 and the randomly generated cross section for our current interaction. A zero finding function is used to work out where this function is equal to zero -\/ we need to do this because we cannot invert the function sigma\+\_\+compton\+\_\+partial.

\paragraph*{Notes}

Since this function is called by zbrent, many of the variables have to be communicated externally. These are x1, the ratio of incoming photon energy to electron rest mass, sigma\+\_\+max, the KN cross section for the maximum possible energy loss sigma\+\_\+rand -\/ a randomised number between 0 and 1 representing the normalised cross section we want to find 

Definition at line 373 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{compton_8c_a9891de810e686fa36209796ff1704fa3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{compton_8c_a9891de810e686fa36209796ff1704fa3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a058633208c21e33eb49a33bd82c6327d}\label{compton_8c_a058633208c21e33eb49a33bd82c6327d}} 
\index{compton.\+c@{compton.\+c}!kappa\+\_\+comp@{kappa\+\_\+comp}}
\index{kappa\+\_\+comp@{kappa\+\_\+comp}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{kappa\+\_\+comp()}{kappa\_comp()}}
{\footnotesize\ttfamily double kappa\+\_\+comp (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{freq }\end{DoxyParamCaption})}



Pointer to current plasma cell. 

computes the effective compton opacity in the cell.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ pointer to the current plasma cell \\
\hline
\mbox{\tt in}  & {\em double} & freq -\/ the frequency of the current photon packet being tracked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
kappa -\/ the compton opacity for the cell.
\end{DoxyReturn}
This routine works out the opacity of a cell to compton (Thompson) scattering. It is designed to give the correct {\itshape heating} effect when high frequency photons undergo Compton scattering. We use a fitted cross section given in Hazy 3 to calculate the frequency depedant cross section. This cross section takes account of the energy exchange, i.\+e. not only the cross section is freqneucy dependant, but so is the mean energy transfer.-\/ just using the Klein-\/\+Nishina cross section will give the wrong results in terms of actual heating effect of these interactions.

\paragraph*{Notes}

This implements the equation kappa=(sigma\+T\+\_\+h$\ast$ne$\ast$freq)/(me$\ast$c$^\wedge$2) Initally it is called by radiation 

Definition at line 46 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=210pt]{compton_8c_a058633208c21e33eb49a33bd82c6327d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a058633208c21e33eb49a33bd82c6327d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a3ce17d1882989bac342f4bc4d1e0a7b6}\label{compton_8c_a3ce17d1882989bac342f4bc4d1e0a7b6}} 
\index{compton.\+c@{compton.\+c}!kappa\+\_\+ind\+\_\+comp@{kappa\+\_\+ind\+\_\+comp}}
\index{kappa\+\_\+ind\+\_\+comp@{kappa\+\_\+ind\+\_\+comp}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{kappa\+\_\+ind\+\_\+comp()}{kappa\_ind\_comp()}}
{\footnotesize\ttfamily double kappa\+\_\+ind\+\_\+comp (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{freq }\end{DoxyParamCaption})}



Computes the effective opacity in the cell due to {\itshape induced} compton heating. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ pointer to the current plasma cell \\
\hline
\mbox{\tt in}  & {\em double} & freq -\/ the frequency of the current photon packet being tracked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
kappa -\/ the inducd compton opacity for the cell.
\end{DoxyReturn}
This routine implements a rather unusual situation, where the mean intensity in a cell exceeds the blackbody value and we get induced compton heating.

\paragraph*{Notes}

This implements the induced compton term in equation 6.\+5 in Hazy vol 3 -\/ this is the last term in the equation. It will rarely if ever occur in a real model, but was included to give better agreement with cloudy over a wide range of ionization parameters. 

Definition at line 89 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a3ce17d1882989bac342f4bc4d1e0a7b6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a3ce17d1882989bac342f4bc4d1e0a7b6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a28be66a0a760ceb7b8394a5a8e7526af}\label{compton_8c_a28be66a0a760ceb7b8394a5a8e7526af}} 
\index{compton.\+c@{compton.\+c}!klein\+\_\+nishina@{klein\+\_\+nishina}}
\index{klein\+\_\+nishina@{klein\+\_\+nishina}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{klein\+\_\+nishina()}{klein\_nishina()}}
{\footnotesize\ttfamily double klein\+\_\+nishina (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



computes the Klein Nishina cross section for a photon of frequency nu. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ photon frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the KN cross section.
\end{DoxyReturn}
This routine is used to compute the frequency dependant cross section of a photon to electron scattering. For a frequency of less than 1e18\+Hz this is just the Thompson scattering cross section. It is currently only used to compute the chance of a photon interacting in this way. The actual eneergy loss when an interaction occurs requires a cross section that takes account of energy balance (provided by the alpha function.)

\paragraph*{Notes}

This implements equation 7.\+5 in Rybicki and Lightman 

Definition at line 230 of file compton.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{compton_8c_a28be66a0a760ceb7b8394a5a8e7526af_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_add111df2de1b0fadab91816f33ee5266}\label{compton_8c_add111df2de1b0fadab91816f33ee5266}} 
\index{compton.\+c@{compton.\+c}!sigma\+\_\+compton\+\_\+partial@{sigma\+\_\+compton\+\_\+partial}}
\index{sigma\+\_\+compton\+\_\+partial@{sigma\+\_\+compton\+\_\+partial}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{sigma\+\_\+compton\+\_\+partial()}{sigma\_compton\_partial()}}
{\footnotesize\ttfamily double sigma\+\_\+compton\+\_\+partial (\begin{DoxyParamCaption}\item[{double}]{f,  }\item[{double}]{x }\end{DoxyParamCaption})}



is the Klein Nishina cross section as a function of the fractional energy change 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & f -\/ the fractional energy change \\
\hline
\mbox{\tt in}  & {\em double} & x the energy of the incoming photon divided by the rest mass energy of an electron \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the cross section for the scattering angle that gives this fractional energy change.
\end{DoxyReturn}
This is a functiuon which returns the Klein-\/\+Nishina cross section implied by a supplied fractional energy change for an incoming photon.

\paragraph*{Notes}

Stuart Sim supplied this formula, but coundn\textquotesingle{}t recall where he had found it, although he had rederived it and thinks it is correct! 

Definition at line 400 of file compton.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_add111df2de1b0fadab91816f33ee5266_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{compton_8c_a560f4bd0619fdb29b85891d46ce63a48}\label{compton_8c_a560f4bd0619fdb29b85891d46ce63a48}} 
\index{compton.\+c@{compton.\+c}!total\+\_\+comp@{total\+\_\+comp}}
\index{total\+\_\+comp@{total\+\_\+comp}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{total\+\_\+comp()}{total\_comp()}}
{\footnotesize\ttfamily double total\+\_\+comp (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the cooling in the cell due to inverse compton scattering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one -\/ pointer to the current wind cell \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e -\/ electron temperature that we need the cooling rate for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the compton luminosity for the cell.
\end{DoxyReturn}
This routine computes the temperature dependant compton cooling rate in ergs/second. It is mainly called as part of the search for a new temperature balancing heating and cooling rates after an ionization cycle.

\paragraph*{Notes}

Compton cooling or \textquotesingle{}inverse compton scattering\textquotesingle{} is the process of energy transfer from hot electrons to \textquotesingle{}cool\textquotesingle{} phortons, that is when 4kT $>$ hnu. For each interaction, the fractional energy loss from the electrons is given by \{\} e\}\{e\} = 4k\+\_\+\+B\+T/mc$^\wedge$2. Where we have a model for the mean intensity of radiation in a cell, we are able to compute the cooling rate by doing an integration over the mean intensity multiplied by the frequency dependant cooling cross section. which looks like C=4k\+\_\+\+B\+T/mc$^\wedge$2 $\ast$ 4/pi \{ $\ast$ beta $\ast$ J\+\_\+\{\} d\}. Beta is the effective cooling cross section from fits in Hazy 3. If we are in the low frequency limit, we dont need to integrate, because the cooling cross section is not frequency depedant in the Thompson limit so we can just multiply by the band limited mean intensity. Simiularly, if we dont have a model -\/ we just do the best we can which is to multiply by the total integrated mean indensity times the Thormpson cross section. 

Definition at line 161 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a560f4bd0619fdb29b85891d46ce63a48_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{compton_8c_a560f4bd0619fdb29b85891d46ce63a48_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{compton_8c_a13ac4700886a0380aa7d6a568a839c96}\label{compton_8c_a13ac4700886a0380aa7d6a568a839c96}} 
\index{compton.\+c@{compton.\+c}!sigma\+\_\+max@{sigma\+\_\+max}}
\index{sigma\+\_\+max@{sigma\+\_\+max}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{sigma\+\_\+max}{sigma\_max}}
{\footnotesize\ttfamily double sigma\+\_\+max}



Definition at line 258 of file compton.\+c.

\mbox{\Hypertarget{compton_8c_a1f82287c66f68d9fd6443c3c2d20cc2f}\label{compton_8c_a1f82287c66f68d9fd6443c3c2d20cc2f}} 
\index{compton.\+c@{compton.\+c}!sigma\+\_\+rand@{sigma\+\_\+rand}}
\index{sigma\+\_\+rand@{sigma\+\_\+rand}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{sigma\+\_\+rand}{sigma\_rand}}
{\footnotesize\ttfamily double sigma\+\_\+rand}



Definition at line 257 of file compton.\+c.

\mbox{\Hypertarget{compton_8c_ac75b803b570527306e1e744bfb7a604f}\label{compton_8c_ac75b803b570527306e1e744bfb7a604f}} 
\index{compton.\+c@{compton.\+c}!x1@{x1}}
\index{x1@{x1}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{x1}{x1}}
{\footnotesize\ttfamily double x1}



Definition at line 259 of file compton.\+c.

\mbox{\Hypertarget{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}\label{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}} 
\index{compton.\+c@{compton.\+c}!xplasma@{xplasma}}
\index{xplasma@{xplasma}!compton.\+c@{compton.\+c}}
\subsubsection{\texorpdfstring{xplasma}{xplasma}}
{\footnotesize\ttfamily \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} xplasma}



Definition at line 19 of file compton.\+c.

