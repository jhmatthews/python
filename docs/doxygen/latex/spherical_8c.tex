\hypertarget{spherical_8c}{}\section{/\+Users/mhewitt/python/source/spherical.c File Reference}
\label{spherical_8c}\index{/\+Users/mhewitt/python/source/spherical.\+c@{/\+Users/mhewitt/python/source/spherical.\+c}}


These are generic routines for setting up 1d spherical coordinate system, as well as a special case of this the so-\/called shell-\/wind model.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for spherical.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spherical_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{spherical_8c_a95d55ebfa2f2f1bd14867ad6a6cc9bfb}{R\+E\+S\+O\+L\+U\+T\+I\+ON}~100
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{spherical_8c_a3810d91d16158ce91d1247c4df1ede09}{spherical\+\_\+ds\+\_\+in\+\_\+cell} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em calculates the distance to the far boundary of the cell in which the photon bundle resides. \end{DoxyCompactList}\item 
int \hyperlink{spherical_8c_abc3da46eefcdd64c79fd792439a5b53d}{spherical\+\_\+make\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em defines the cells in a spherical grid \end{DoxyCompactList}\item 
int \hyperlink{spherical_8c_a223201f3c894676560fbd4d94e71c167}{spherical\+\_\+wind\+\_\+complete} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Initialize some arrays in a domain for a spherical system that are used in various interpolation routines. \end{DoxyCompactList}\item 
int \hyperlink{spherical_8c_a1c6dbd2946a218d14cf553a59e41d189}{spherical\+\_\+volumes} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em spherical\+\_\+volume(w) calculates the wind volume of cell allowing for the fact that some cells are partially in the wind \end{DoxyCompactList}\item 
int \hyperlink{spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5}{spherical\+\_\+where\+\_\+in\+\_\+grid} (int ndom, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em locates the element in wmain corrosponding to a position when one is using spherical coordinates. \end{DoxyCompactList}\item 
int \hyperlink{spherical_8c_aadfbcaed1dc773ebb991e922722a5267}{spherical\+\_\+get\+\_\+random\+\_\+location} (int n, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\item 
int \hyperlink{spherical_8c_a6c5300254db561924aba1c13186be975}{spherical\+\_\+extend\+\_\+density} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em extends the density to regions just outside the wind regiions so that extrapolations of density can be made there \end{DoxyCompactList}\item 
int \hyperlink{spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e}{shell\+\_\+make\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em defines the cells in a thin shell, a special case of a spherical wind. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
These are generic routines for setting up 1d spherical coordinate system, as well as a special case of this the so-\/called shell-\/wind model. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
March, 2018 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{spherical_8c_a95d55ebfa2f2f1bd14867ad6a6cc9bfb}\label{spherical_8c_a95d55ebfa2f2f1bd14867ad6a6cc9bfb}} 
\index{spherical.\+c@{spherical.\+c}!R\+E\+S\+O\+L\+U\+T\+I\+ON@{R\+E\+S\+O\+L\+U\+T\+I\+ON}}
\index{R\+E\+S\+O\+L\+U\+T\+I\+ON@{R\+E\+S\+O\+L\+U\+T\+I\+ON}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{R\+E\+S\+O\+L\+U\+T\+I\+ON}{RESOLUTION}}
{\footnotesize\ttfamily \#define R\+E\+S\+O\+L\+U\+T\+I\+ON~100}



Definition at line 245 of file spherical.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e}\label{spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e}} 
\index{spherical.\+c@{spherical.\+c}!shell\+\_\+make\+\_\+grid@{shell\+\_\+make\+\_\+grid}}
\index{shell\+\_\+make\+\_\+grid@{shell\+\_\+make\+\_\+grid}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{shell\+\_\+make\+\_\+grid()}{shell\_make\_grid()}}
{\footnotesize\ttfamily int shell\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



defines the cells in a thin shell, a special case of a spherical wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w The structure which defines the wind in Python \\
\hline
\mbox{\tt in,out}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always retunrs 0
\end{DoxyReturn}
The shell wind has 3 elements, one inside the shell, one outside, and one outside and one shell exactly fitting the shell.

\paragraph*{Notes}

The shell wind is intended for diagnostic purposes 

Definition at line 585 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{spherical_8c_a1df8af4539e5836b6a2f8dab9f88572e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spherical_8c_a3810d91d16158ce91d1247c4df1ede09}\label{spherical_8c_a3810d91d16158ce91d1247c4df1ede09}} 
\index{spherical.\+c@{spherical.\+c}!spherical\+\_\+ds\+\_\+in\+\_\+cell@{spherical\+\_\+ds\+\_\+in\+\_\+cell}}
\index{spherical\+\_\+ds\+\_\+in\+\_\+cell@{spherical\+\_\+ds\+\_\+in\+\_\+cell}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{spherical\+\_\+ds\+\_\+in\+\_\+cell()}{spherical\_ds\_in\_cell()}}
{\footnotesize\ttfamily double spherical\+\_\+ds\+\_\+in\+\_\+cell (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



calculates the distance to the far boundary of the cell in which the photon bundle resides. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain in which the photon resides \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Distance to the far boundary of the cell in which the photon currently resides. Negative numbers (and zero) should be regarded as errors.
\end{DoxyReturn}
The routine simply determines which grid cell the photon is in and then solves two quadradic equations for the distance to the inner and outer boundary of the cell. The routine returns the smallest positive distance.

\paragraph*{Notes}

Definition at line 84 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spherical_8c_a3810d91d16158ce91d1247c4df1ede09_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spherical_8c_a3810d91d16158ce91d1247c4df1ede09_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spherical_8c_a6c5300254db561924aba1c13186be975}\label{spherical_8c_a6c5300254db561924aba1c13186be975}} 
\index{spherical.\+c@{spherical.\+c}!spherical\+\_\+extend\+\_\+density@{spherical\+\_\+extend\+\_\+density}}
\index{spherical\+\_\+extend\+\_\+density@{spherical\+\_\+extend\+\_\+density}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{spherical\+\_\+extend\+\_\+density()}{spherical\_extend\_density()}}
{\footnotesize\ttfamily int spherical\+\_\+extend\+\_\+density (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



extends the density to regions just outside the wind regiions so that extrapolations of density can be made there 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w The enetire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
In order for density to be continuous within the grid, and to enable linear interpolation everwhere, we need to define a density in the guard cells inside and outside the wind region.

This routine accomplishes this by assignining an element in the plasma structure to the guard cells.

\paragraph*{Notes}

In principle one could interpolate on any of the prameters in the plasma stucture, but in reality the main thing this is used for is to assure tha ion denisites are continuous. 

Definition at line 516 of file spherical.\+c.

\mbox{\Hypertarget{spherical_8c_aadfbcaed1dc773ebb991e922722a5267}\label{spherical_8c_aadfbcaed1dc773ebb991e922722a5267}} 
\index{spherical.\+c@{spherical.\+c}!spherical\+\_\+get\+\_\+random\+\_\+location@{spherical\+\_\+get\+\_\+random\+\_\+location}}
\index{spherical\+\_\+get\+\_\+random\+\_\+location@{spherical\+\_\+get\+\_\+random\+\_\+location}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{spherical\+\_\+get\+\_\+random\+\_\+location()}{spherical\_get\_random\_location()}}
{\footnotesize\ttfamily int spherical\+\_\+get\+\_\+random\+\_\+location (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{ }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n -- Cell in which random position is to be generated \\
\hline
\mbox{\tt out}  & {\em double} & x\mbox{[}\mbox{]} A random position in the cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The retine generally returns W\+\_\+\+A\+L\+L\+\_\+\+I\+N\+\_\+\+W\+I\+ND
\end{DoxyReturn}
The routine generates random positions within a spherical cell and returns when it finds a position that is in the wind region.

\paragraph*{Notes}

Comment\+: This routine has no protection against the possibility that the cell is not at least partially in the wind. 

Definition at line 448 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=279pt]{spherical_8c_aadfbcaed1dc773ebb991e922722a5267_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spherical_8c_abc3da46eefcdd64c79fd792439a5b53d}\label{spherical_8c_abc3da46eefcdd64c79fd792439a5b53d}} 
\index{spherical.\+c@{spherical.\+c}!spherical\+\_\+make\+\_\+grid@{spherical\+\_\+make\+\_\+grid}}
\index{spherical\+\_\+make\+\_\+grid@{spherical\+\_\+make\+\_\+grid}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{spherical\+\_\+make\+\_\+grid()}{spherical\_make\_grid()}}
{\footnotesize\ttfamily int spherical\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



defines the cells in a spherical grid 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The structure which defines the wind in Python \\
\hline
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine defines the boundaries of cells for a spherical grid in the appropriate parts of the wind domain In spherical coordinates w runs from 0 to n.

\paragraph*{Notes}

The centers of the grid cells are defined in the xz plane at a 45 degree angle. This was done so that one would be in a plausible region of a biconical wind. 

Definition at line 144 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{spherical_8c_abc3da46eefcdd64c79fd792439a5b53d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spherical_8c_a1c6dbd2946a218d14cf553a59e41d189}\label{spherical_8c_a1c6dbd2946a218d14cf553a59e41d189}} 
\index{spherical.\+c@{spherical.\+c}!spherical\+\_\+volumes@{spherical\+\_\+volumes}}
\index{spherical\+\_\+volumes@{spherical\+\_\+volumes}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{spherical\+\_\+volumes()}{spherical\_volumes()}}
{\footnotesize\ttfamily int spherical\+\_\+volumes (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



spherical\+\_\+volume(w) calculates the wind volume of cell allowing for the fact that some cells are partially in the wind 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom the domain number \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w the entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine performs a simple 2d numerical integration to find out what fraction of a shell is in the wind of a specfic domain and uses this to calculate the volume that is in the wind.

\paragraph*{Notes}

The volume of edge cells are all set to 0 

Definition at line 272 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{spherical_8c_a1c6dbd2946a218d14cf553a59e41d189_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5}\label{spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5}} 
\index{spherical.\+c@{spherical.\+c}!spherical\+\_\+where\+\_\+in\+\_\+grid@{spherical\+\_\+where\+\_\+in\+\_\+grid}}
\index{spherical\+\_\+where\+\_\+in\+\_\+grid@{spherical\+\_\+where\+\_\+in\+\_\+grid}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{spherical\+\_\+where\+\_\+in\+\_\+grid()}{spherical\_where\_in\_grid()}}
{\footnotesize\ttfamily int spherical\+\_\+where\+\_\+in\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{ }\end{DoxyParamCaption})}



locates the element in wmain corrosponding to a position when one is using spherical coordinates. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} The postion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of wind element associated with a position.
\end{DoxyReturn}
If the position is in the grid this will be a positive number. If s is inside the grid -\/1 will be returned, if x is outsice the domain -\/2 will be returned

\paragraph*{Notes}

speherical\+\_\+where\+\_\+in grid does not tell you whether the x is in the wind or not.

What one means by inside or outside the grid may well be different for different coordinate systems.

This routine is not normally used directly. Instead it is called via where\+\_\+in\+\_\+grid which determines the specific where\+\_\+in\+\_\+grid routine to call, depending on the coordinate system. 

Definition at line 391 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=255pt]{spherical_8c_af8f81bf23594ec53e0dad81c86d7e3c5_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{spherical_8c_a223201f3c894676560fbd4d94e71c167}\label{spherical_8c_a223201f3c894676560fbd4d94e71c167}} 
\index{spherical.\+c@{spherical.\+c}!spherical\+\_\+wind\+\_\+complete@{spherical\+\_\+wind\+\_\+complete}}
\index{spherical\+\_\+wind\+\_\+complete@{spherical\+\_\+wind\+\_\+complete}!spherical.\+c@{spherical.\+c}}
\subsubsection{\texorpdfstring{spherical\+\_\+wind\+\_\+complete()}{spherical\_wind\_complete()}}
{\footnotesize\ttfamily int spherical\+\_\+wind\+\_\+complete (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Initialize some arrays in a domain for a spherical system that are used in various interpolation routines. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom A domain which has a spherical grid defined \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w the entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alwasy returns 0
\end{DoxyReturn}
This simple little routine just populates one dimensional arrays that are used for interpolation.

\paragraph*{Notes}

Definition at line 219 of file spherical.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{spherical_8c_a223201f3c894676560fbd4d94e71c167_icgraph}
\end{center}
\end{figure}
