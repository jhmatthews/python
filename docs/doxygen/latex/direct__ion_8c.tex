\hypertarget{direct__ion_8c}{}\section{/\+Users/mhewitt/python/source/direct\+\_\+ion.c File Reference}
\label{direct__ion_8c}\index{/\+Users/mhewitt/python/source/direct\+\_\+ion.\+c@{/\+Users/mhewitt/python/source/direct\+\_\+ion.\+c}}


direct\+\_\+ion contains the routines relating to direct (collisional) ionization and threebody recombination  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}recipes.\+h\char`\"{}}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+sf\+\_\+expint.\+h$>$}\newline
Include dependency graph for direct\+\_\+ion.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{direct__ion_8c_abf8e9c4dba2c37614a969357ccfe830d}{A\+L\+P\+H\+A\+B\+I\+G\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+I\+ON}~100.
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{direct__ion_8c_a71e4aa982b912f78d70646462c6a6115}{compute\+\_\+di\+\_\+coeffs} (double T)
\begin{DoxyCompactList}\small\item\em computes the rates due to direct (collisional) ionization from Dere data. \end{DoxyCompactList}\item 
double \hyperlink{direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71}{q\+\_\+ioniz\+\_\+dere} (int nion, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em Returns the collisional ionization rate coefficient for a given ion/temperature. \end{DoxyCompactList}\item 
double \hyperlink{direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce}{total\+\_\+di} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total cooling due collisional ionization \end{DoxyCompactList}\item 
int \hyperlink{direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c}{compute\+\_\+qrecomb\+\_\+coeffs} (double T)
\begin{DoxyCompactList}\small\item\em computes the rate coefficient for three body recombination from Dere data. \end{DoxyCompactList}\item 
double \hyperlink{direct__ion_8c_a193d6c4498adc3507b41e79e52a94016}{q\+\_\+recomb\+\_\+dere} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, double electron\+\_\+temperature)
\begin{DoxyCompactList}\small\item\em Returns the collisional recombination co-\/efficient. \end{DoxyCompactList}\item 
double \hyperlink{direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3}{q\+\_\+ioniz} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, double electron\+\_\+temperature)
\begin{DoxyCompactList}\small\item\em returns the collisional ionization rate co-\/efficient \end{DoxyCompactList}\item 
double \hyperlink{direct__ion_8c_a432a9569392003e4470067b1c44dca5b}{q\+\_\+recomb} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, double electron\+\_\+temperature)
\begin{DoxyCompactList}\small\item\em Returns a collisional recombination rate co-\/efficient. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
direct\+\_\+ion contains the routines relating to direct (collisional) ionization and threebody recombination 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{direct__ion_8c_abf8e9c4dba2c37614a969357ccfe830d}\label{direct__ion_8c_abf8e9c4dba2c37614a969357ccfe830d}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!A\+L\+P\+H\+A\+B\+I\+G\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+I\+ON@{A\+L\+P\+H\+A\+B\+I\+G\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+I\+ON}}
\index{A\+L\+P\+H\+A\+B\+I\+G\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+I\+ON@{A\+L\+P\+H\+A\+B\+I\+G\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+I\+ON}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{A\+L\+P\+H\+A\+B\+I\+G\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+I\+ON}{ALPHABIG\_DIRECT\_ION}}
{\footnotesize\ttfamily \#define A\+L\+P\+H\+A\+B\+I\+G\+\_\+\+D\+I\+R\+E\+C\+T\+\_\+\+I\+ON~100.}



Definition at line 25 of file direct\+\_\+ion.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{direct__ion_8c_a71e4aa982b912f78d70646462c6a6115}\label{direct__ion_8c_a71e4aa982b912f78d70646462c6a6115}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!compute\+\_\+di\+\_\+coeffs@{compute\+\_\+di\+\_\+coeffs}}
\index{compute\+\_\+di\+\_\+coeffs@{compute\+\_\+di\+\_\+coeffs}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{compute\+\_\+di\+\_\+coeffs()}{compute\_di\_coeffs()}}
{\footnotesize\ttfamily int compute\+\_\+di\+\_\+coeffs (\begin{DoxyParamCaption}\item[{double}]{T }\end{DoxyParamCaption})}



computes the rates due to direct (collisional) ionization from Dere data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & T temperature in K of the cell in question \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success
\end{DoxyReturn}
This routine controls the calculation of the direct ionization coefficients for each ionic species at a temperature T. They are stored in a global array di\+\_\+coeffs -\/ usually for use in calculating the ionization balance. The actual calculations are done in a seperate routine, q\+\_\+ioniz\+\_\+dere Data is from Ionization rate coefficients for elements H to Zn (Dere+, 2007) Table J\+\_\+\+A\+\_\+\+A\+\_\+466\+\_\+771\+\_\+table29\+:

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 51 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a71e4aa982b912f78d70646462c6a6115_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c}\label{direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!compute\+\_\+qrecomb\+\_\+coeffs@{compute\+\_\+qrecomb\+\_\+coeffs}}
\index{compute\+\_\+qrecomb\+\_\+coeffs@{compute\+\_\+qrecomb\+\_\+coeffs}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{compute\+\_\+qrecomb\+\_\+coeffs()}{compute\_qrecomb\_coeffs()}}
{\footnotesize\ttfamily int compute\+\_\+qrecomb\+\_\+coeffs (\begin{DoxyParamCaption}\item[{double}]{T }\end{DoxyParamCaption})}



computes the rate coefficient for three body recombination from Dere data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & T Temperature in K \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success
\end{DoxyReturn}
This routine calculates the three body recombination rate coefficient for all ions in a cell at temperature T. The resulting rate coefficients are stored in a global array for use by the calling routine -\/ normally matrix\+\_\+ion as part of the search for an ionization balance. It works by essentially applying the Milne relation to collisional ionization data. This is a driver routine, the hard work is done in a seperate routine (q\+\_\+recomb\+\_\+dere)

\paragraph*{Notes}

1508 JM coded 

Definition at line 243 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{direct__ion_8c_a2cd4b2739e1ba69e646c63e7e327583c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3}\label{direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!q\+\_\+ioniz@{q\+\_\+ioniz}}
\index{q\+\_\+ioniz@{q\+\_\+ioniz}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{q\+\_\+ioniz()}{q\_ioniz()}}
{\footnotesize\ttfamily double q\+\_\+ioniz (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{double}]{electron\+\_\+temperature }\end{DoxyParamCaption})}



returns the collisional ionization rate co-\/efficient 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} -\/ pointer to a Topbase style cross section -\/ u \\
\hline
\mbox{\tt in}  & {\em double} & electron\+\_\+temperature -\/ electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
collisional ionization rate coefficieient
\end{DoxyReturn}
This returns the collisional ionization co-\/efficient Calculated following equation 5-\/79 of Mihalas or from data from Dere 2007.

\paragraph*{Notes}

This is extrememly similar to the routine compute\+\_\+di\+\_\+coeffs apart from the fact that it computes just one rate coefficient, and can use an approximate formula in the absence of data. It is an earlier routine used only in macroatom calculations. 

Definition at line 387 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_ad33c3a097208fb519a5e779c62e3d1f3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71}\label{direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!q\+\_\+ioniz\+\_\+dere@{q\+\_\+ioniz\+\_\+dere}}
\index{q\+\_\+ioniz\+\_\+dere@{q\+\_\+ioniz\+\_\+dere}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{q\+\_\+ioniz\+\_\+dere()}{q\_ioniz\_dere()}}
{\footnotesize\ttfamily double q\+\_\+ioniz\+\_\+dere (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



Returns the collisional ionization rate coefficient for a given ion/temperature. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion Index into ion structure for current ion under analysis \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e Electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the collisional ionization rate coefficient
\end{DoxyReturn}
This uses data from Dere 07 to calculate a collisional ionization rate coefficient. Data is provided as spline fits over a range of temperatures and so an interpolation is required to arrive at the correct data for a given temperature. There is also an exponential integral which is done using a gsl routine.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 91 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a6a22ee2c1e95eae27423b95ce1283f71_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{direct__ion_8c_a432a9569392003e4470067b1c44dca5b}\label{direct__ion_8c_a432a9569392003e4470067b1c44dca5b}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!q\+\_\+recomb@{q\+\_\+recomb}}
\index{q\+\_\+recomb@{q\+\_\+recomb}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{q\+\_\+recomb()}{q\_recomb()}}
{\footnotesize\ttfamily double q\+\_\+recomb (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{double}]{electron\+\_\+temperature }\end{DoxyParamCaption})}



Returns a collisional recombination rate co-\/efficient. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} -\/ pointer to a topbase style PI cross section \\
\hline
{\em \mbox{[}in} & out\mbox{]} double electron\+\_\+temperature -\/ electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Collisional recombination rate coefficient
\end{DoxyReturn}
This equation comes from considering TE and getting the expression q\+\_\+recomb = 2.\+07e-\/16 $\ast$ gl/gu $\ast$ exp(E/kT) $\ast$ (T\+\_\+e$\ast$$\ast$-\/3/2) $\ast$ q\+\_\+ioniz then substituting the above expression for q\+\_\+ioniz.

\paragraph*{Notes}

This routine is very similar to compute\+\_\+qrecomb\+\_\+coeffs apart from the fact that this routine only computes one recomb coefficient and applies an approximate calculation where dere data is missing. It is used in macroatom calculations. 

Definition at line 450 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a432a9569392003e4470067b1c44dca5b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a432a9569392003e4470067b1c44dca5b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{direct__ion_8c_a193d6c4498adc3507b41e79e52a94016}\label{direct__ion_8c_a193d6c4498adc3507b41e79e52a94016}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!q\+\_\+recomb\+\_\+dere@{q\+\_\+recomb\+\_\+dere}}
\index{q\+\_\+recomb\+\_\+dere@{q\+\_\+recomb\+\_\+dere}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{q\+\_\+recomb\+\_\+dere()}{q\_recomb\_dere()}}
{\footnotesize\ttfamily double q\+\_\+recomb\+\_\+dere (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{double}]{electron\+\_\+temperature }\end{DoxyParamCaption})}



Returns the collisional recombination co-\/efficient. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} a pointer to the topbdae style PI cross section \\
\hline
\mbox{\tt in}  & {\em double} & electron\+\_\+temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
??? R\+E\+T\+U\+R\+NS ???
\end{DoxyReturn}
This equation comes from considering TE and getting the expression q\+\_\+recomb = 2.\+07e-\/16 $\ast$ gl/gu $\ast$ exp(E/kT) $\ast$ q\+\_\+ioniz then substituting the above expression for q\+\_\+ioniz. We get the ionization threshold from the supplied PI cross section.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 315 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a193d6c4498adc3507b41e79e52a94016_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce}\label{direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce}} 
\index{direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}!total\+\_\+di@{total\+\_\+di}}
\index{total\+\_\+di@{total\+\_\+di}!direct\+\_\+ion.\+c@{direct\+\_\+ion.\+c}}
\subsubsection{\texorpdfstring{total\+\_\+di()}{total\_di()}}
{\footnotesize\ttfamily double total\+\_\+di (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total cooling due collisional ionization 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one pointer to cell \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total di cooling
\end{DoxyReturn}
This routine computes the total cooling rate in a cell due to collisional ionization. This is just the rate, times the ionization thereshold of the state being recombined into.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 183 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{direct__ion_8c_a56f9a736ea5fdd9b253e4a7fa07103ce_icgraph}
\end{center}
\end{figure}
