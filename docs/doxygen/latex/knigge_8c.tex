\hypertarget{knigge_8c}{}\section{/\+Users/mhewitt/python/source/knigge.c File Reference}
\label{knigge_8c}\index{/\+Users/mhewitt/python/source/knigge.\+c@{/\+Users/mhewitt/python/source/knigge.\+c}}


Routines needed to define a K\+WD wind.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for knigge.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{knigge_8c_add45ca8576114294ab6b3569311c30fa}{kfudge}~1.\+01
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{knigge_8c_abc35742eeeb50cc9cda997c3de567f20}{get\+\_\+knigge\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em get the input data that is necessary to define K\+W\+D-\/type model description of the wind \end{DoxyCompactList}\item 
double \hyperlink{knigge_8c_aff42023accb056ea7ba26ec712605562}{kn\+\_\+velocity} (int ndom, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em Calculate the v at a postion in a K\+WD wind. \end{DoxyCompactList}\item 
double \hyperlink{knigge_8c_ab20600703e7e59707c2041ec1aae6f60}{kn\+\_\+rho} (int ndom, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em double (x) calculates the density of an kn\+\_\+wind at a position x \end{DoxyCompactList}\item 
double \hyperlink{knigge_8c_a62c27981e9cc187028480ec2752923d3}{kn\+\_\+vzero} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate the sound speed (launch speed) of the wind at r. \end{DoxyCompactList}\item 
double \hyperlink{knigge_8c_ab4a7a07fd07176e2d8723e16fd7b619d}{kn\+\_\+wind\+\_\+mdot\+\_\+integral} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em the integrand of K\+WD model for mdot as a function of radius \end{DoxyCompactList}\item 
double \hyperlink{knigge_8c_a28ecd56d18384623466c728d74cee061}{kn\+\_\+rho\+\_\+zero} (int ndom, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate rho at the base of the wind. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{knigge_8c_a87f5037a33a370fc88439ecef8047057}{kn\+\_\+lambda}
\begin{DoxyCompactList}\small\item\em This is a variable required to do the integration of local mdot in K\+WD. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines needed to define a K\+WD wind. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018
\end{DoxyDate}
The routines here are all that are needed to define a K\+W\+D-\/type wind within Python. Inputs are gathered, and the any values such as the nomalization needed to convert a global to a local mass loss rate. Functions are provided to calculated the density and velocity of the wind at any point.

As written, the routines assume a standard Shakura-\/\+Sunyaeve disk temperature distribution.

Although a K\+WD wind is only really defined within wind cones, the routines will return a non-\/zero velocity and density outside these regions to allow for interpolating at the edges of the wind cones. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{knigge_8c_add45ca8576114294ab6b3569311c30fa}\label{knigge_8c_add45ca8576114294ab6b3569311c30fa}} 
\index{knigge.\+c@{knigge.\+c}!kfudge@{kfudge}}
\index{kfudge@{kfudge}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{kfudge}{kfudge}}
{\footnotesize\ttfamily \#define kfudge~1.\+01}



Definition at line 177 of file knigge.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{knigge_8c_abc35742eeeb50cc9cda997c3de567f20}\label{knigge_8c_abc35742eeeb50cc9cda997c3de567f20}} 
\index{knigge.\+c@{knigge.\+c}!get\+\_\+knigge\+\_\+wind\+\_\+params@{get\+\_\+knigge\+\_\+wind\+\_\+params}}
\index{get\+\_\+knigge\+\_\+wind\+\_\+params@{get\+\_\+knigge\+\_\+wind\+\_\+params}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+knigge\+\_\+wind\+\_\+params()}{get\_knigge\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+knigge\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



get the input data that is necessary to define K\+W\+D-\/type model description of the wind 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alwasys returns 0
\end{DoxyReturn}
\paragraph*{Notes}

The routine first obtains wind\+\_\+mdot and then the various parameters required for the K\+WD model. It then integrates the mass loss rate per unit area over the region occupied by the wind to normalize the mass loss rate.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000034}{Bug}]There may weel be errors associated with a vertically extended disk that need tobe addressed\end{DoxyRefDesc}


Definition at line 59 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c_abc35742eeeb50cc9cda997c3de567f20_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c_abc35742eeeb50cc9cda997c3de567f20_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{knigge_8c_ab20600703e7e59707c2041ec1aae6f60}\label{knigge_8c_ab20600703e7e59707c2041ec1aae6f60}} 
\index{knigge.\+c@{knigge.\+c}!kn\+\_\+rho@{kn\+\_\+rho}}
\index{kn\+\_\+rho@{kn\+\_\+rho}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{kn\+\_\+rho()}{kn\_rho()}}
{\footnotesize\ttfamily double kn\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{ }\end{DoxyParamCaption})}



double (x) calculates the density of an kn\+\_\+wind at a position x 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain where kn params are stored \\
\hline
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} the position which one desires the density \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The density at x is returned in gram/cm$\ast$$\ast$3
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 347 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c_ab20600703e7e59707c2041ec1aae6f60_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{knigge_8c_a28ecd56d18384623466c728d74cee061}\label{knigge_8c_a28ecd56d18384623466c728d74cee061}} 
\index{knigge.\+c@{knigge.\+c}!kn\+\_\+rho\+\_\+zero@{kn\+\_\+rho\+\_\+zero}}
\index{kn\+\_\+rho\+\_\+zero@{kn\+\_\+rho\+\_\+zero}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{kn\+\_\+rho\+\_\+zero()}{kn\_rho\_zero()}}
{\footnotesize\ttfamily double kn\+\_\+rho\+\_\+zero (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{r }\end{DoxyParamCaption})}



Calculate rho at the base of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\mbox{\tt in}  & {\em double} & r A position in the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The mass density at the base of the wind
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 496 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c_a28ecd56d18384623466c728d74cee061_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=213pt]{knigge_8c_a28ecd56d18384623466c728d74cee061_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{knigge_8c_aff42023accb056ea7ba26ec712605562}\label{knigge_8c_aff42023accb056ea7ba26ec712605562}} 
\index{knigge.\+c@{knigge.\+c}!kn\+\_\+velocity@{kn\+\_\+velocity}}
\index{kn\+\_\+velocity@{kn\+\_\+velocity}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{kn\+\_\+velocity()}{kn\_velocity()}}
{\footnotesize\ttfamily double kn\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{,  }\item[{\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}}]{ }\end{DoxyParamCaption})}



Calculate the v at a postion in a K\+WD wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom the domain for the KN wind \\
\hline
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} a position in cartesiatn coordiantes \\
\hline
\mbox{\tt out}  & {\em double} & v\mbox{[}\mbox{]} the calculated velocity at that position in cartesian coordinates \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The amplitude of the velocity is returned
\end{DoxyReturn}
This implements equations 17 \& 18 of K\+W\+D95.

\paragraph*{Notes}

For a contant poloidal velocity along a stream line, kn\+\_\+alpha should be set to 0

There is a largely hidden option that allows one to incoporated a SV velocity law into a K\+WD model. This is accomplished by settting v\+\_\+inf$<$0. The code should be examined for details.

At the inner edge of the accretion disk the temperature of the disk goes to zero, and so in principle the thermal velocity goes to zero. The kfudge below keeps this from happening. What did Christian actually do here?? 

Definition at line 211 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c_aff42023accb056ea7ba26ec712605562_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=209pt]{knigge_8c_aff42023accb056ea7ba26ec712605562_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{knigge_8c_a62c27981e9cc187028480ec2752923d3}\label{knigge_8c_a62c27981e9cc187028480ec2752923d3}} 
\index{knigge.\+c@{knigge.\+c}!kn\+\_\+vzero@{kn\+\_\+vzero}}
\index{kn\+\_\+vzero@{kn\+\_\+vzero}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{kn\+\_\+vzero()}{kn\_vzero()}}
{\footnotesize\ttfamily double kn\+\_\+vzero (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



Calculate the sound speed (launch speed) of the wind at r. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r The position (radius) for caculating the sound speed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The sound speed
\end{DoxyReturn}
For K\+WD, the launch speed is the sound velocity

\paragraph*{Notes}

Prior to calling this routine the properties of the disk must have been entered

This routine assumes a standard Shakura-\/\+Sunyaev disk.

In our implementation of the K\+WD model, the velocity at the footpoint can be a mulitiple of the sound speed, but that correction is applied in kn\+\_\+velocity 

Definition at line 420 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c_a62c27981e9cc187028480ec2752923d3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{knigge_8c_a62c27981e9cc187028480ec2752923d3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{knigge_8c_ab4a7a07fd07176e2d8723e16fd7b619d}\label{knigge_8c_ab4a7a07fd07176e2d8723e16fd7b619d}} 
\index{knigge.\+c@{knigge.\+c}!kn\+\_\+wind\+\_\+mdot\+\_\+integral@{kn\+\_\+wind\+\_\+mdot\+\_\+integral}}
\index{kn\+\_\+wind\+\_\+mdot\+\_\+integral@{kn\+\_\+wind\+\_\+mdot\+\_\+integral}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{kn\+\_\+wind\+\_\+mdot\+\_\+integral()}{kn\_wind\_mdot\_integral()}}
{\footnotesize\ttfamily double kn\+\_\+wind\+\_\+mdot\+\_\+integral (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



the integrand of K\+WD model for mdot as a function of radius 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r A position (radius) in the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the integrand
\end{DoxyReturn}
The mass loss rate is proportional to T(r)$\ast$$\ast$(4$\ast$kn\+\_\+lambda) as can be seen from K\+W\+D95 equation 10. This functikon has to be integrated over radius to normalize the local mdot to the integrated value.

\paragraph*{Notes}

The integration is carrid out in get\+\_\+knigge\+\_\+wind\+\_\+params

There is an extra factor of 2 because the wind emerges from both sides of the disk 

Definition at line 462 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{knigge_8c_ab4a7a07fd07176e2d8723e16fd7b619d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{knigge_8c_ab4a7a07fd07176e2d8723e16fd7b619d_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{knigge_8c_a87f5037a33a370fc88439ecef8047057}\label{knigge_8c_a87f5037a33a370fc88439ecef8047057}} 
\index{knigge.\+c@{knigge.\+c}!kn\+\_\+lambda@{kn\+\_\+lambda}}
\index{kn\+\_\+lambda@{kn\+\_\+lambda}!knigge.\+c@{knigge.\+c}}
\subsubsection{\texorpdfstring{kn\+\_\+lambda}{kn\_lambda}}
{\footnotesize\ttfamily double kn\+\_\+lambda}



This is a variable required to do the integration of local mdot in K\+WD. 



Definition at line 35 of file knigge.\+c.

