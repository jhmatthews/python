\hypertarget{continuum_8c}{}\section{/\+Users/mhewitt/python/source/continuum.c File Reference}
\label{continuum_8c}\index{/\+Users/mhewitt/python/source/continuum.\+c@{/\+Users/mhewitt/python/source/continuum.\+c}}


Rotines related speciically to generating MC spectra for stellar atmospheres like grids of spectra.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}models.\+h\char`\"{}}\newline
Include dependency graph for continuum.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{continuum_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{continuum_8c_aca0d5b8835f560393ae64306e8f24ce3}{one\+\_\+continuum} (int spectype, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double g, double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em get a photon frequency from a grid of stored spectra from a continuum grid \end{DoxyCompactList}\item 
double \hyperlink{continuum_8c_a9d1648c5fc65c0c98f2cdf51dfaee558}{emittance\+\_\+continuum} (int spectype, double freqmin, double freqmax, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double g)
\begin{DoxyCompactList}\small\item\em get the surface flux for Hubeny/\+Kurucz like stellar models \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{continuum_8c_ad5ae362a91b7c239184d49913e1701b1}{old\+\_\+t}
\item 
double \hyperlink{continuum_8c_aca4b7b10c4b84e3f30245927b6411d0b}{old\+\_\+g}
\item 
double \hyperlink{continuum_8c_a65f885c797f8031956517c69adcd0345}{old\+\_\+freqmin}
\item 
double \hyperlink{continuum_8c_a8dc32bfb2583414f49194409ba81c27c}{old\+\_\+freqmax}
\item 
double \hyperlink{continuum_8c_a47bb97973150c998d469697784328f6e}{jump} \mbox{[}$\,$\mbox{]} = \{ 913.\+8 \}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Rotines related speciically to generating MC spectra for stellar atmospheres like grids of spectra. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May, 2018 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{continuum_8c_a9d1648c5fc65c0c98f2cdf51dfaee558}\label{continuum_8c_a9d1648c5fc65c0c98f2cdf51dfaee558}} 
\index{continuum.\+c@{continuum.\+c}!emittance\+\_\+continuum@{emittance\+\_\+continuum}}
\index{emittance\+\_\+continuum@{emittance\+\_\+continuum}!continuum.\+c@{continuum.\+c}}
\subsubsection{\texorpdfstring{emittance\+\_\+continuum()}{emittance\_continuum()}}
{\footnotesize\ttfamily double emittance\+\_\+continuum (\begin{DoxyParamCaption}\item[{int}]{spectype,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{t,  }\item[{double}]{g }\end{DoxyParamCaption})}



get the surface flux for Hubeny/\+Kurucz like stellar models 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & spectype an integer identifying the set of models to use \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The mimimum frequency \\
\hline
 & {\em \mbox{[}int\mbox{]}} & double freqmax The maximum frequency \\
\hline
\mbox{\tt in}  & {\em double} & t A temperature \\
\hline
\mbox{\tt in}  & {\em double} & g A gravity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The surface flux for a star-\/like spectrum read from a grid
\end{DoxyReturn}
The routine gets the band-\/limited flux per unit area for Hubeny or Kurucz models which are both in units of the Eddingting flux (H)

\paragraph*{Notes}

As indicated this is not a general purpose routine. Not all spectral models for stars are calculated in terms of the Eddington flux. The factor of 4 pi is the conversion from Eddington flux to phhysical flux

For an explanation see Hubeny \& Mihalas -\/ Theory of Stellar Atmospheres, equation 3.\+70 (or Mihalas, Stellar Atmospheres 2nd ed, eq (1-\/27).

Note that the observed flux at a distance is given by

f/H = 4pi $\ast$ R$\ast$$\ast$2/d$\ast$$\ast$2

and

L=f$\ast$4pi$\ast$\+R$\ast$$\ast$2 = 16 pi$\ast$$\ast$2 R$\ast$$\ast$2 H 

Definition at line 259 of file continuum.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{continuum_8c_a9d1648c5fc65c0c98f2cdf51dfaee558_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{continuum_8c_a9d1648c5fc65c0c98f2cdf51dfaee558_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{continuum_8c_aca0d5b8835f560393ae64306e8f24ce3}\label{continuum_8c_aca0d5b8835f560393ae64306e8f24ce3}} 
\index{continuum.\+c@{continuum.\+c}!one\+\_\+continuum@{one\+\_\+continuum}}
\index{one\+\_\+continuum@{one\+\_\+continuum}!continuum.\+c@{continuum.\+c}}
\subsubsection{\texorpdfstring{one\+\_\+continuum()}{one\_continuum()}}
{\footnotesize\ttfamily double one\+\_\+continuum (\begin{DoxyParamCaption}\item[{int}]{spectype,  }\item[{double}]{t,  }\item[{double}]{g,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



get a photon frequency from a grid of stored spectra from a continuum grid 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & spectype An index to the continum grid which one want got obtaining a photon \\
\hline
\mbox{\tt in}  & {\em double} & t The associated temperature (or first variable) defining the grid \\
\hline
\mbox{\tt in}  & {\em double} & g The associted gravity (or second variable) \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency desiered for a photon \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequecny for a photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A frequency for a photon
\end{DoxyReturn}
This is a routine that is used to select a function from a grid of spectra stored in the model structure. For the purpose of this routine, the model grid is assumed to be based on two variables t (temperature) and gravity (g). This reflects the fact that most of the grids used in Python to date (e.\+g Kurucz models) are these kinds of grids. The routine linearly interpolates on these to variables to produce a spectrum at the desired t and g. It then creates a coumulative distribution of the portion of the spectrum bewtween fmin and fmax and then uses a random number to obtain a frequncy for a single program.

The routine should already work for any grid.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000008}{Bug}]The model structure is general in the sense that it was intended for situation with any number of variables. However what is written here is specific to the case of two variables. This is a problem, as we have found in trying to use this in other situations. A more general routine is needed. The first step in doing this is to replace much of the code here with a call to the routine model (spectype, par) in models.\+c\end{DoxyRefDesc}


Definition at line 108 of file continuum.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{continuum_8c_aca0d5b8835f560393ae64306e8f24ce3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{continuum_8c_aca0d5b8835f560393ae64306e8f24ce3_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{continuum_8c_a47bb97973150c998d469697784328f6e}\label{continuum_8c_a47bb97973150c998d469697784328f6e}} 
\index{continuum.\+c@{continuum.\+c}!jump@{jump}}
\index{jump@{jump}!continuum.\+c@{continuum.\+c}}
\subsubsection{\texorpdfstring{jump}{jump}}
{\footnotesize\ttfamily double jump\mbox{[}$\,$\mbox{]} = \{ 913.\+8 \}}



Definition at line 66 of file continuum.\+c.

\mbox{\Hypertarget{continuum_8c_a8dc32bfb2583414f49194409ba81c27c}\label{continuum_8c_a8dc32bfb2583414f49194409ba81c27c}} 
\index{continuum.\+c@{continuum.\+c}!old\+\_\+freqmax@{old\+\_\+freqmax}}
\index{old\+\_\+freqmax@{old\+\_\+freqmax}!continuum.\+c@{continuum.\+c}}
\subsubsection{\texorpdfstring{old\+\_\+freqmax}{old\_freqmax}}
{\footnotesize\ttfamily double old\+\_\+freqmax}



Definition at line 65 of file continuum.\+c.

\mbox{\Hypertarget{continuum_8c_a65f885c797f8031956517c69adcd0345}\label{continuum_8c_a65f885c797f8031956517c69adcd0345}} 
\index{continuum.\+c@{continuum.\+c}!old\+\_\+freqmin@{old\+\_\+freqmin}}
\index{old\+\_\+freqmin@{old\+\_\+freqmin}!continuum.\+c@{continuum.\+c}}
\subsubsection{\texorpdfstring{old\+\_\+freqmin}{old\_freqmin}}
{\footnotesize\ttfamily double old\+\_\+freqmin}



Definition at line 65 of file continuum.\+c.

\mbox{\Hypertarget{continuum_8c_aca4b7b10c4b84e3f30245927b6411d0b}\label{continuum_8c_aca4b7b10c4b84e3f30245927b6411d0b}} 
\index{continuum.\+c@{continuum.\+c}!old\+\_\+g@{old\+\_\+g}}
\index{old\+\_\+g@{old\+\_\+g}!continuum.\+c@{continuum.\+c}}
\subsubsection{\texorpdfstring{old\+\_\+g}{old\_g}}
{\footnotesize\ttfamily double old\+\_\+g}



Definition at line 65 of file continuum.\+c.

\mbox{\Hypertarget{continuum_8c_ad5ae362a91b7c239184d49913e1701b1}\label{continuum_8c_ad5ae362a91b7c239184d49913e1701b1}} 
\index{continuum.\+c@{continuum.\+c}!old\+\_\+t@{old\+\_\+t}}
\index{old\+\_\+t@{old\+\_\+t}!continuum.\+c@{continuum.\+c}}
\subsubsection{\texorpdfstring{old\+\_\+t}{old\_t}}
{\footnotesize\ttfamily double old\+\_\+t}



Definition at line 65 of file continuum.\+c.

