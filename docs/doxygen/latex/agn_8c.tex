\hypertarget{agn_8c}{}\section{/\+Users/mhewitt/python/source/agn.c File Reference}
\label{agn_8c}\index{/\+Users/mhewitt/python/source/agn.\+c@{/\+Users/mhewitt/python/source/agn.\+c}}


Subroutines relating to power law radiation sources.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$strings.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}log.\+h\char`\"{}}\newline
Include dependency graph for agn.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{agn_8c_aea0982182724515da5e5a4b2c82a02d2}{X\+F\+R\+E\+Q\+M\+IN}~4.\+84e17
\item 
\#define \hyperlink{agn_8c_a9e305088b07ea013ede73eab99af9fd8}{X\+F\+R\+E\+Q\+M\+AX}~2.\+42e18
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{agn_8c_ab6c8e4e9577a9edb71a9a5900d43964c}{agn\+\_\+init} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, double lum, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double freqmin, double freqmax, int ioniz\+\_\+or\+\_\+final, double $\ast$f)
\begin{DoxyCompactList}\small\item\em Calculates the total luminosity of an A\+GN type source. \end{DoxyCompactList}\item 
double \hyperlink{agn_8c_ab172924888b8579c4acdd737732edce1}{emittance\+\_\+pow} (double freqmin, double freqmax, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em The luminosity of a power law over a frerquency range. \end{DoxyCompactList}\item 
double \hyperlink{agn_8c_a9bd7eb064b17d9b352e044d5e417a649}{emittance\+\_\+bpow} (double freqmin, double freqmax, double lum, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em Works out the luminosity of a broken power law. \end{DoxyCompactList}\item 
int \hyperlink{agn_8c_a82dbda6e94577f3ecd6e55c085f2aa10}{photo\+\_\+gen\+\_\+agn} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double weight, double f1, double f2, int spectype, int istart, int nphot)
\begin{DoxyCompactList}\small\item\em Generate a photon from an A\+GN object. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Subroutines relating to power law radiation sources. 

\begin{DoxyAuthor}{Author}
nsh 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2011
\end{DoxyDate}
The subroutines and functions in this file are to do with power law S\+E\+Ds, which are mainly used for A\+GN, hence the name of the file. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{agn_8c_a9e305088b07ea013ede73eab99af9fd8}\label{agn_8c_a9e305088b07ea013ede73eab99af9fd8}} 
\index{agn.\+c@{agn.\+c}!X\+F\+R\+E\+Q\+M\+AX@{X\+F\+R\+E\+Q\+M\+AX}}
\index{X\+F\+R\+E\+Q\+M\+AX@{X\+F\+R\+E\+Q\+M\+AX}!agn.\+c@{agn.\+c}}
\subsubsection{\texorpdfstring{X\+F\+R\+E\+Q\+M\+AX}{XFREQMAX}}
{\footnotesize\ttfamily \#define X\+F\+R\+E\+Q\+M\+AX~2.\+42e18}

\mbox{\Hypertarget{agn_8c_aea0982182724515da5e5a4b2c82a02d2}\label{agn_8c_aea0982182724515da5e5a4b2c82a02d2}} 
\index{agn.\+c@{agn.\+c}!X\+F\+R\+E\+Q\+M\+IN@{X\+F\+R\+E\+Q\+M\+IN}}
\index{X\+F\+R\+E\+Q\+M\+IN@{X\+F\+R\+E\+Q\+M\+IN}!agn.\+c@{agn.\+c}}
\subsubsection{\texorpdfstring{X\+F\+R\+E\+Q\+M\+IN}{XFREQMIN}}
{\footnotesize\ttfamily \#define X\+F\+R\+E\+Q\+M\+IN~4.\+84e17}



\subsection{Function Documentation}
\mbox{\Hypertarget{agn_8c_ab6c8e4e9577a9edb71a9a5900d43964c}\label{agn_8c_ab6c8e4e9577a9edb71a9a5900d43964c}} 
\index{agn.\+c@{agn.\+c}!agn\+\_\+init@{agn\+\_\+init}}
\index{agn\+\_\+init@{agn\+\_\+init}!agn.\+c@{agn.\+c}}
\subsubsection{\texorpdfstring{agn\+\_\+init()}{agn\_init()}}
{\footnotesize\ttfamily double agn\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{r,  }\item[{double}]{lum,  }\item[{double}]{alpha,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{double $\ast$}]{f }\end{DoxyParamCaption})}



Calculates the total luminosity of an A\+GN type source. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r radius of emitting object \\
\hline
\mbox{\tt in}  & {\em double} & lum the luminosity of the A\+GN (2-\/10keV) -\/ X\+XX I\textquotesingle{}m not sure this is used apart from \\
\hline
\mbox{\tt in}  & {\em double} & alpha the spectral index of the PL source -\/ also sometimes used for a temperature if a BB source is required \\
\hline
\mbox{\tt in}  & {\em double} & freqmin minimum frequency to integrate over \\
\hline
\mbox{\tt in}  & {\em double} & freqmax maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final flag to say if we are in the ionization cycles or spectral cycle \\
\hline
\mbox{\tt out}  & {\em double} & f the returned luminosity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
f -\/ the luminosity -\/ seems to be returned as well as set implicitly.
\end{DoxyReturn}
This routine is used when one is working out how many photons will be made from each of several sources. This computes the total luminosity of a source of radius r, with spectral index alpha between band boundaries given by freqmin and freqmax

\paragraph*{Notes}

There seem to be some inconsistencies here -\/ lum (the 2-\/10keV luminosity of the PL source) is supplied but it doesnt seem to be used apart from in the emittance\+\_\+continuum which is nonsense -\/ this requires a temperature and a local gravity Another inconsistency is that the bremstrahlung code uses values for T and alpha that are stored in the geo structure, whilst the power law uses data supplied in the code. 

Definition at line 54 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c_ab6c8e4e9577a9edb71a9a5900d43964c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c_ab6c8e4e9577a9edb71a9a5900d43964c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{agn_8c_a9bd7eb064b17d9b352e044d5e417a649}\label{agn_8c_a9bd7eb064b17d9b352e044d5e417a649}} 
\index{agn.\+c@{agn.\+c}!emittance\+\_\+bpow@{emittance\+\_\+bpow}}
\index{emittance\+\_\+bpow@{emittance\+\_\+bpow}!agn.\+c@{agn.\+c}}
\subsubsection{\texorpdfstring{emittance\+\_\+bpow()}{emittance\_bpow()}}
{\footnotesize\ttfamily double emittance\+\_\+bpow (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{lum,  }\item[{double}]{alpha }\end{DoxyParamCaption})}



Works out the luminosity of a broken power law. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & freqmin min frequency that we are generating photons over \\
\hline
\mbox{\tt in,out}  & {\em double} & freqmax max frequency that we are generating photons over \\
\hline
\mbox{\tt in,out}  & {\em double} & lum 2-\/10kev luminosity \\
\hline
\mbox{\tt in,out}  & {\em double} & alpha is the 2-\/10kev slope. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
emit The luminosity of the whole power law.
\end{DoxyReturn}
computes the emittance of a broken power law coded to try to replicate the cloudy table type power law. There are three sections -\/ a central bit, which should cover the 2-\/10kev portion of the spectrum, a low frequency tail and a high frequency tail .

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 219 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c_a9bd7eb064b17d9b352e044d5e417a649_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c_a9bd7eb064b17d9b352e044d5e417a649_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{agn_8c_ab172924888b8579c4acdd737732edce1}\label{agn_8c_ab172924888b8579c4acdd737732edce1}} 
\index{agn.\+c@{agn.\+c}!emittance\+\_\+pow@{emittance\+\_\+pow}}
\index{emittance\+\_\+pow@{emittance\+\_\+pow}!agn.\+c@{agn.\+c}}
\subsubsection{\texorpdfstring{emittance\+\_\+pow()}{emittance\_pow()}}
{\footnotesize\ttfamily double emittance\+\_\+pow (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{alpha }\end{DoxyParamCaption})}



The luminosity of a power law over a frerquency range. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freqmin lower frequency bound \\
\hline
\mbox{\tt in}  & {\em double} & freqmax upper frequency bound \\
\hline
\mbox{\tt in}  & {\em double} & alpha spectral index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
double emit the luminosoty
\end{DoxyReturn}
A Simple routine which just integrates a power law between two limits. There is a little bit of code that deals with the case where an advanced mode is used that cuts off the low frequency tail -\/ and a bit of clever work to check for the pathalogical case of alpha=-\/1 where one cannot symbolically integrate.

\paragraph*{Notes}

Definition at line 131 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c_ab172924888b8579c4acdd737732edce1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c_ab172924888b8579c4acdd737732edce1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{agn_8c_a82dbda6e94577f3ecd6e55c085f2aa10}\label{agn_8c_a82dbda6e94577f3ecd6e55c085f2aa10}} 
\index{agn.\+c@{agn.\+c}!photo\+\_\+gen\+\_\+agn@{photo\+\_\+gen\+\_\+agn}}
\index{photo\+\_\+gen\+\_\+agn@{photo\+\_\+gen\+\_\+agn}!agn.\+c@{agn.\+c}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+agn()}{photo\_gen\_agn()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+agn (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{r,  }\item[{double}]{alpha,  }\item[{double}]{weight,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{spectype,  }\item[{int}]{istart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



Generate a photon from an A\+GN object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p pointer to the photon array \\
\hline
\mbox{\tt in,out}  & {\em double} & r radius of the central source \\
\hline
\mbox{\tt in,out}  & {\em double} & alpha spectral index of the PL sourece -\/ also used to communicate temperature if a BB or model is used. \\
\hline
\mbox{\tt in,out}  & {\em double} & weight the weight of each photon to be made \\
\hline
\mbox{\tt in,out}  & {\em double} & f1 lower frequency bound \\
\hline
\mbox{\tt in,out}  & {\em double} & f2 upper frequency nound \\
\hline
\mbox{\tt in,out}  & {\em int} & spectype the type of S\+ED \\
\hline
\mbox{\tt in,out}  & {\em int} & istart the number of the first photon to be made -\/ index into the p array \\
\hline
\mbox{\tt in,out}  & {\em int} & nphot the number of photons to be made \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 (if successful or unscuccessful)
\end{DoxyReturn}
This subroutine produces photons from an A\+GN type source. There are a range of different S\+E\+Ds that can be used, these are communicated by the spectype and different choices cause different surbroutines to be called. The only {\itshape real} work done here is to compute the strarting location and direction of the photons.

\paragraph*{Notes}

Definition at line 374 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{agn_8c_a82dbda6e94577f3ecd6e55c085f2aa10_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{agn_8c_a82dbda6e94577f3ecd6e55c085f2aa10_icgraph}
\end{center}
\end{figure}
