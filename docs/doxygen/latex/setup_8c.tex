\hypertarget{setup_8c}{}\section{/\+Users/mhewitt/python/source/setup.c File Reference}
\label{setup_8c}\index{/\+Users/mhewitt/python/source/setup.\+c@{/\+Users/mhewitt/python/source/setup.\+c}}


Various intialization routines, including a number that read values from the parameter files.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for setup.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{setup_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{setup_8c_a1f91048ff31bbf77445ce4e739ee8558}{init\+\_\+geo} ()
\begin{DoxyCompactList}\small\item\em initializes the geo structure to something that is semi-\/reasonable \end{DoxyCompactList}\item 
int \hyperlink{setup_8c_ab358cbada062a9acccdf184b57630305}{get\+\_\+spectype} (int yesno, char $\ast$question, int $\ast$spectype)
\begin{DoxyCompactList}\small\item\em Generalized routine to get the spectrum type for a radiation source and if necessary read a set of precalculated spectra. \end{DoxyCompactList}\item 
int \hyperlink{setup_8c_a74b3c5bdd6a21485e21c9b2519d21d93}{init\+\_\+advanced\+\_\+modes} ()
\begin{DoxyCompactList}\small\item\em simply initialises the set of advanced modes stored in the modes structure to a default value. \end{DoxyCompactList}\item 
int \hyperlink{setup_8c_a20e681c858fa3ec39d6518d5ff7040dc}{init\+\_\+observers} ()
\begin{DoxyCompactList}\small\item\em get inputs that describe the detailed spectra that one intends to extract. \end{DoxyCompactList}\item 
\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} \hyperlink{setup_8c_af41ad05318e322b9f80b9d24cb5d645b}{init\+\_\+photons} ()
\begin{DoxyCompactList}\small\item\em gets information about the number of cycles and how many photons there should be per cycle. \end{DoxyCompactList}\item 
int \hyperlink{setup_8c_af238cdc068bd49d8073b2d6205769054}{init\+\_\+ionization} ()
\begin{DoxyCompactList}\small\item\em Select the ionization and line transfer modes, along with various other parameters about ionization. \end{DoxyCompactList}\item 
double \hyperlink{setup_8c_aea9bc1a60f573ac8c66c08dab10f9e21}{setup\+\_\+dfudge} ()
\begin{DoxyCompactList}\small\item\em Sets a global \char`\"{}push\+\_\+through\+\_\+distance\char`\"{} designed to prevent photons from being trapped at boundaries. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char \hyperlink{setup_8c_ad1ce272db97764afbe1317714c5585bc}{get\+\_\+spectype\+\_\+oldname} \mbox{[}\hyperlink{xlog_8c_a10e8c7b8458375c3dbfbb4010a2aba8c}{L\+I\+N\+E\+L\+E\+N\+G\+TH}\mbox{]} = \char`\"{}data/kurucz91.\+ls\char`\"{}
\begin{DoxyCompactList}\small\item\em This is to assure that we read model lists in the same order everytime. \end{DoxyCompactList}\item 
int \hyperlink{setup_8c_ae21c4a1b52ec5dbd149e3eccf592d2cf}{get\+\_\+spectype\+\_\+count} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Various intialization routines, including a number that read values from the parameter files. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
March, 2018
\end{DoxyDate}
\paragraph*{Notes}

Because the input and setup of Python is relatively complex, we have over time moved much of this out of main into subroutines, and we have generally tried to collect related portion of the initialization into different setup routines, such as setup\+\_\+disk or setup\+\_\+files.

This file contains a collection of these setup routines, that either stand-\/alone or have not been moved into their own files. 

\subsection{Function Documentation}
\mbox{\Hypertarget{setup_8c_ab358cbada062a9acccdf184b57630305}\label{setup_8c_ab358cbada062a9acccdf184b57630305}} 
\index{setup.\+c@{setup.\+c}!get\+\_\+spectype@{get\+\_\+spectype}}
\index{get\+\_\+spectype@{get\+\_\+spectype}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+spectype()}{get\_spectype()}}
{\footnotesize\ttfamily int get\+\_\+spectype (\begin{DoxyParamCaption}\item[{int}]{yesno,  }\item[{char $\ast$}]{question,  }\item[{int $\ast$}]{spectype }\end{DoxyParamCaption})}



Generalized routine to get the spectrum type for a radiation source and if necessary read a set of precalculated spectra. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & yesno An integer used to decide whether to ask for a spectrum type \\
\hline
\mbox{\tt in,out}  & {\em char} & $\ast$ question The query for a spectrum type for this component \\
\hline
\mbox{\tt in,out}  & {\em int} & $\ast$ spectype The type of spectrum to assign \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the spectype, a number that says what type of spectrum (bb, power law, etc) to generate for this source
\end{DoxyReturn}
If yesno is non-\/zero, the user will be asked for the type of spectrum for a radation source. If yesno is 0, we presume that this radiation souce (a star a disk or the wind itself) is not to radiate in the calculation, and the spectrum type is set to S\+P\+E\+C\+T\+Y\+P\+E\+\_\+\+N\+O\+NE.

If one wants to geneate spectra from a seriels of models (such as synthetic spectra caluclated for stars), this routine calls routines to read the models.

\paragraph*{Notes}

This routine is awkwardly constructed. For reasons that are probably historical the routine converts the internally stored values to different values in order to ask what type of spectrum the user wants, and then translates these back to the internal value. 

Definition at line 187 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{setup_8c_ab358cbada062a9acccdf184b57630305_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{setup_8c_ab358cbada062a9acccdf184b57630305_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{setup_8c_a74b3c5bdd6a21485e21c9b2519d21d93}\label{setup_8c_a74b3c5bdd6a21485e21c9b2519d21d93}} 
\index{setup.\+c@{setup.\+c}!init\+\_\+advanced\+\_\+modes@{init\+\_\+advanced\+\_\+modes}}
\index{init\+\_\+advanced\+\_\+modes@{init\+\_\+advanced\+\_\+modes}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+advanced\+\_\+modes()}{init\_advanced\_modes()}}
{\footnotesize\ttfamily int init\+\_\+advanced\+\_\+modes (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



simply initialises the set of advanced modes stored in the modes structure to a default value. 

\begin{DoxyReturn}{Returns}
Allways returns 0
\end{DoxyReturn}
\paragraph*{Notes}

modes is a structure declared in \hyperlink{python_8h}{python.\+h}

Most of the modes are initialized to 0, which means that activites that could be uddertaken for this mode, will not be.

Advanced modes are turned off by default, unless the -\/d flag is invoked at runtime. If it is invoked, one will be asked whether to turn-\/on an advanced mode.

In most cases, the advanced modes cause extra diagnostic information to be saved.

see \#111 and \#120 for recent work 

Definition at line 286 of file setup.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{setup_8c_a74b3c5bdd6a21485e21c9b2519d21d93_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{setup_8c_a1f91048ff31bbf77445ce4e739ee8558}\label{setup_8c_a1f91048ff31bbf77445ce4e739ee8558}} 
\index{setup.\+c@{setup.\+c}!init\+\_\+geo@{init\+\_\+geo}}
\index{init\+\_\+geo@{init\+\_\+geo}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+geo()}{init\_geo()}}
{\footnotesize\ttfamily int init\+\_\+geo (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



initializes the geo structure to something that is semi-\/reasonable 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Initial values for all of the variables that are not part of the individual wind descriptions that are actully read(!) into the program should be created here. The derived values are not needed.

\paragraph*{Notes}

In general, cgs units are the working units for Python. Thus all intialization should be converted to these units.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000054}{Bug}]Currently init\+\_\+geo is set up for C\+Vs and Stars and not A\+GN. We now read in the system type as the first variable. The intent was to allow one to use the system type to particularize how geo (aqnd other variables) were intialized. But this has yet to be carreid out.\end{DoxyRefDesc}


Definition at line 60 of file setup.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=192pt]{setup_8c_a1f91048ff31bbf77445ce4e739ee8558_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{setup_8c_af238cdc068bd49d8073b2d6205769054}\label{setup_8c_af238cdc068bd49d8073b2d6205769054}} 
\index{setup.\+c@{setup.\+c}!init\+\_\+ionization@{init\+\_\+ionization}}
\index{init\+\_\+ionization@{init\+\_\+ionization}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+ionization()}{init\_ionization()}}
{\footnotesize\ttfamily int init\+\_\+ionization (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Select the ionization and line transfer modes, along with various other parameters about ionization. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine queries for a variety of parameters which describe how ionization and line transfer are handled. This includes whether surfaces reflect

\paragraph*{Notes}

The routine is not particular well named, and it is not immediately obvious that all of the parmenters that are queried for here are related. 

Definition at line 581 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{setup_8c_af238cdc068bd49d8073b2d6205769054_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{setup_8c_af238cdc068bd49d8073b2d6205769054_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{setup_8c_a20e681c858fa3ec39d6518d5ff7040dc}\label{setup_8c_a20e681c858fa3ec39d6518d5ff7040dc}} 
\index{setup.\+c@{setup.\+c}!init\+\_\+observers@{init\+\_\+observers}}
\index{init\+\_\+observers@{init\+\_\+observers}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+observers()}{init\_observers()}}
{\footnotesize\ttfamily int init\+\_\+observers (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



get inputs that describe the detailed spectra that one intends to extract. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

There are inputs here both for a normal extaction and in advanced mode for selecting spectra from photons with specific numbers of scatters, or from a certain reagion. It is also possible to extact spectra in the \textquotesingle{}live or die" mode, in which one simply tracks photons that emerge in a certain inclination range. 

Definition at line 334 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{setup_8c_a20e681c858fa3ec39d6518d5ff7040dc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=212pt]{setup_8c_a20e681c858fa3ec39d6518d5ff7040dc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{setup_8c_af41ad05318e322b9f80b9d24cb5d645b}\label{setup_8c_af41ad05318e322b9f80b9d24cb5d645b}} 
\index{setup.\+c@{setup.\+c}!init\+\_\+photons@{init\+\_\+photons}}
\index{init\+\_\+photons@{init\+\_\+photons}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+photons()}{init\_photons()}}
{\footnotesize\ttfamily \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} init\+\_\+photons (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



gets information about the number of cycles and how many photons there should be per cycle. 

\begin{DoxyReturn}{Returns}
Generally returns 0
\end{DoxyReturn}
??? D\+E\+S\+C\+R\+I\+P\+T\+I\+ON ???

\paragraph*{Notes}

The routine also allocates memory for the photon structure. If the routine is unable to allocate this membory, the routine will exit. 

Definition at line 501 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{setup_8c_af41ad05318e322b9f80b9d24cb5d645b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{setup_8c_af41ad05318e322b9f80b9d24cb5d645b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{setup_8c_aea9bc1a60f573ac8c66c08dab10f9e21}\label{setup_8c_aea9bc1a60f573ac8c66c08dab10f9e21}} 
\index{setup.\+c@{setup.\+c}!setup\+\_\+dfudge@{setup\+\_\+dfudge}}
\index{setup\+\_\+dfudge@{setup\+\_\+dfudge}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{setup\+\_\+dfudge()}{setup\_dfudge()}}
{\footnotesize\ttfamily double setup\+\_\+dfudge (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Sets a global \char`\"{}push\+\_\+through\+\_\+distance\char`\"{} designed to prevent photons from being trapped at boundaries. 

\begin{DoxyReturn}{Returns}
dfudge the push through distance
\end{DoxyReturn}
dfudge is intended to be a small positive number that prevents photons from being trapped at the edges of cells or wind cones. It is often added to the distance to an \char`\"{}edge\char`\"{} to push the photon thorough whatever boundary is being calculated.

\paragraph*{Notes}

setup\+\_\+dfudge is used to modify the variable D\+F\+U\+D\+GE which can be found in \hyperlink{python_8h}{python.\+h}.

Originally, D\+F\+U\+D\+GE was the only number used to push through boundariies, but today D\+F\+U\+D\+GE is used sparingly, if at all, as push tryough distances within wind cells are defined differently for each cell.

There are two competing factors in defining D\+F\+U\+D\+GE. It should be short enough so that the push through distane goes only a small way into s cell. It should be large enough though that round-\/off errors do not prevent one from actually getting into a cell.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000055}{Bug}]This routine does not really belong in this file. It should be moved. \end{DoxyRefDesc}


Definition at line 703 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{setup_8c_aea9bc1a60f573ac8c66c08dab10f9e21_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{setup_8c_aea9bc1a60f573ac8c66c08dab10f9e21_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{setup_8c_ae21c4a1b52ec5dbd149e3eccf592d2cf}\label{setup_8c_ae21c4a1b52ec5dbd149e3eccf592d2cf}} 
\index{setup.\+c@{setup.\+c}!get\+\_\+spectype\+\_\+count@{get\+\_\+spectype\+\_\+count}}
\index{get\+\_\+spectype\+\_\+count@{get\+\_\+spectype\+\_\+count}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+spectype\+\_\+count}{get\_spectype\_count}}
{\footnotesize\ttfamily int get\+\_\+spectype\+\_\+count = 0}



Definition at line 152 of file setup.\+c.

\mbox{\Hypertarget{setup_8c_ad1ce272db97764afbe1317714c5585bc}\label{setup_8c_ad1ce272db97764afbe1317714c5585bc}} 
\index{setup.\+c@{setup.\+c}!get\+\_\+spectype\+\_\+oldname@{get\+\_\+spectype\+\_\+oldname}}
\index{get\+\_\+spectype\+\_\+oldname@{get\+\_\+spectype\+\_\+oldname}!setup.\+c@{setup.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+spectype\+\_\+oldname}{get\_spectype\_oldname}}
{\footnotesize\ttfamily char get\+\_\+spectype\+\_\+oldname\mbox{[}\hyperlink{xlog_8c_a10e8c7b8458375c3dbfbb4010a2aba8c}{L\+I\+N\+E\+L\+E\+N\+G\+TH}\mbox{]} = \char`\"{}data/kurucz91.\+ls\char`\"{}}



This is to assure that we read model lists in the same order everytime. 



Definition at line 151 of file setup.\+c.

