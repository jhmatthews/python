\hypertarget{saha_8c}{}\section{/\+Users/mhewitt/python/source/saha.c File Reference}
\label{saha_8c}\index{/\+Users/mhewitt/python/source/saha.\+c@{/\+Users/mhewitt/python/source/saha.\+c}}


Routines to (re)calculate the ion densities.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for saha.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structforce__con}{force\+\_\+con}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{saha_8c_a97b9295c2ccd68eab06cce70209049a2}{M\+I\+N\+\_\+\+F\+U\+D\+GE}~1.e-\/10
\item 
\#define \hyperlink{saha_8c_ad2c6aa71bd92481ca7a8eabb14cae1e0}{M\+A\+X\+\_\+\+F\+U\+D\+GE}~10.
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{saha_8c_a63d5795e0b9978d33ed61a63917004e2}{nebular\+\_\+concentrations} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the Wind\+Ptr itself, such as t\+\_\+r, t\+\_\+e, w, based on the \char`\"{}mode\char`\"{}. \end{DoxyCompactList}\item 
int \hyperlink{saha_8c_a96f3f44cc5cf473ca91ca268747dfba1}{concentrations} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptions about what to use for the temperature Saha equantion. \end{DoxyCompactList}\item 
int \hyperlink{saha_8c_a16363b5cd764e733bd84a0d991cb6568}{saha} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double ne, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Calculate the densities for all of the ions in a single cell given ne and t. \end{DoxyCompactList}\item 
int \hyperlink{saha_8c_aa8ede21a14cf7e763909094555c5240d}{lucy} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances contained in xplasma. It thus assumes that \hyperlink{saha_8c_a16363b5cd764e733bd84a0d991cb6568}{saha()} has been called before it, in the concentrations routine. \end{DoxyCompactList}\item 
int \hyperlink{saha_8c_a389fdf4d9e9d542a78a25229ce259927}{lucy\+\_\+mazzali1} (double nh, double t\+\_\+r, double t\+\_\+e, double www, int nelem, double ne, density, double xne, newden)
\begin{DoxyCompactList}\small\item\em calculates ion densities of a single element (defined by nelem) according to a modified on the spot approximation, in this case equation 11 of Mazzali and Lucy which attempts to consider ionizations from excieted and ground state levels. \end{DoxyCompactList}\item 
int \hyperlink{saha_8c_ad350a11e70a4518fb86b842942575e26}{fix\+\_\+concentrations} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em sets the concentrations of individual ions assuming hard coded ionization fractions that are read from a file \end{DoxyCompactList}\item 
double \hyperlink{saha_8c_a90e110fd1ce9e1f21afb98455e153ba9}{get\+\_\+ne} (density)
\begin{DoxyCompactList}\small\item\em calculates the electron density given the densities of each ion. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{saha_8c_a55786cdfcf98a42b819656e1e4ee7065}{fix\+\_\+con\+\_\+start} = 0
\item 
struct \hyperlink{structforce__con}{force\+\_\+con} \hyperlink{saha_8c_a23e841e587b275d756267eddb95cc6a2}{con\+\_\+force} \mbox{[}1000\mbox{]}
\item 
int \hyperlink{saha_8c_a2b3eba3a0a02b028a29c5d59620ba991}{nforce}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines to (re)calculate the ion densities. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May, 2018
\end{DoxyDate}
The driving routine for calculating the ion desnsities is here, as well as the routines for carrying out many of the older ionization schemes, but more modern matrix based approaches re elsewhere. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{saha_8c_ad2c6aa71bd92481ca7a8eabb14cae1e0}\label{saha_8c_ad2c6aa71bd92481ca7a8eabb14cae1e0}} 
\index{saha.\+c@{saha.\+c}!M\+A\+X\+\_\+\+F\+U\+D\+GE@{M\+A\+X\+\_\+\+F\+U\+D\+GE}}
\index{M\+A\+X\+\_\+\+F\+U\+D\+GE@{M\+A\+X\+\_\+\+F\+U\+D\+GE}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{M\+A\+X\+\_\+\+F\+U\+D\+GE}{MAX\_FUDGE}}
{\footnotesize\ttfamily \#define M\+A\+X\+\_\+\+F\+U\+D\+GE~10.}



Definition at line 464 of file saha.\+c.

\mbox{\Hypertarget{saha_8c_a97b9295c2ccd68eab06cce70209049a2}\label{saha_8c_a97b9295c2ccd68eab06cce70209049a2}} 
\index{saha.\+c@{saha.\+c}!M\+I\+N\+\_\+\+F\+U\+D\+GE@{M\+I\+N\+\_\+\+F\+U\+D\+GE}}
\index{M\+I\+N\+\_\+\+F\+U\+D\+GE@{M\+I\+N\+\_\+\+F\+U\+D\+GE}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{M\+I\+N\+\_\+\+F\+U\+D\+GE}{MIN\_FUDGE}}
{\footnotesize\ttfamily \#define M\+I\+N\+\_\+\+F\+U\+D\+GE~1.e-\/10}



Definition at line 463 of file saha.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{saha_8c_a96f3f44cc5cf473ca91ca268747dfba1}\label{saha_8c_a96f3f44cc5cf473ca91ca268747dfba1}} 
\index{saha.\+c@{saha.\+c}!concentrations@{concentrations}}
\index{concentrations@{concentrations}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{concentrations()}{concentrations()}}
{\footnotesize\ttfamily int concentrations (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptions about what to use for the temperature Saha equantion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A singll plasma cell \\
\hline
\mbox{\tt in}  & {\em int} & mode A swich whith defines what to use for the temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
concentrations returns 0 if it converged; -\/1 if it did not converge. If it does not converge, both density and $\ast$ne are likely to be garbage.
\end{DoxyReturn}
The densities are updated in xplasma

The modes are as follows\+:
\begin{DoxyItemize}
\item N\+E\+B\+U\+L\+A\+R\+\_\+\+TR -- use the radiation temperature
\item N\+E\+B\+U\+La\+R\+\_\+\+TE -- use the electron temperature
\item N\+E\+B\+U\+L\+A\+R\+\_\+\+M\+L93 -\/ From Mazzli \& Lucy 1993, use the geometric mean of the electron and radiaion temperature
\end{DoxyItemize}

This routine iterates to find the densities of individual ions using the Saha equation.

The Saha eqn. is (e.\+g. Motz, p 110, eqn 4.\+14


\begin{DoxyItemize}
\item N\+\_\+r+1 N\+\_\+e / N\+\_\+r = (2$\ast$pi$\ast$m$\ast$kT)$\ast$$\ast$1.5/h$\ast$$\ast$3 2 Z\+\_\+r+1(T)/\+Z\+\_\+r $\ast$ exp (-\/\+X/kT)

where N\+\_\+r+1 is the number density of the r+1 ionization state and Z\+\_\+r+1 is the partition function of that state.
\end{DoxyItemize}

he program works by perfoming a crude iteration on ne. It could undoubtedly be improved, if one wanted better accuracy or higher speed.

\paragraph*{Notes}

So that one doesn\textquotesingle{}t get zero-\/divides in other programs, e.\+g. nebular\+\_\+concentrations, a floor is set on the density of any ion or the electron density. 

Definition at line 202 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{saha_8c_a96f3f44cc5cf473ca91ca268747dfba1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{saha_8c_ad350a11e70a4518fb86b842942575e26}\label{saha_8c_ad350a11e70a4518fb86b842942575e26}} 
\index{saha.\+c@{saha.\+c}!fix\+\_\+concentrations@{fix\+\_\+concentrations}}
\index{fix\+\_\+concentrations@{fix\+\_\+concentrations}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{fix\+\_\+concentrations()}{fix\_concentrations()}}
{\footnotesize\ttfamily int fix\+\_\+concentrations (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



sets the concentrations of individual ions assuming hard coded ionization fractions that are read from a file 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A plasma cell \\
\hline
\mbox{\tt in}  & {\em int} & mode U\+N\+U\+S\+ED \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The first time the routine is called it reads the file specified by geo.\+con\+\_\+file which populates the \hyperlink{structforce__con}{force\+\_\+con} array.

On subsequent calls the values of one of an xplasma element are modified.

The format of the file is fairly obvious

Element.\+z Ion ion\+\_\+fraction

6 4 1

would set the C\+IV fraction to 1.

Note there is nothing forcing the totals to be anything sensible.

\paragraph*{Notes}

o change the ions that you want to fix, simply update con\+\_\+force, A\+ND M\+A\+KE S\+U\+RE N\+F\+O\+R\+CE IS S\+ET TO T\+HE N\+U\+M\+B\+ER OF I\+O\+NS

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000053}{Bug}]It is not obvious that this is really what we want. This routine was written when we only were concerned about scattering and does not really take into account emission (for which one needs n\+\_\+e. One possiblity is to calculated ion abundances for H and He properly, in which case we would need the mode variable.\end{DoxyRefDesc}


Definition at line 803 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_ad350a11e70a4518fb86b842942575e26_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=265pt]{saha_8c_ad350a11e70a4518fb86b842942575e26_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{saha_8c_a90e110fd1ce9e1f21afb98455e153ba9}\label{saha_8c_a90e110fd1ce9e1f21afb98455e153ba9}} 
\index{saha.\+c@{saha.\+c}!get\+\_\+ne@{get\+\_\+ne}}
\index{get\+\_\+ne@{get\+\_\+ne}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+ne()}{get\_ne()}}
{\footnotesize\ttfamily double get\+\_\+ne (\begin{DoxyParamCaption}\item[{density}]{ }\end{DoxyParamCaption})}



calculates the electron density given the densities of each ion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & density\mbox{[}\mbox{]} A trial set of densities for ions \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An electron density
\end{DoxyReturn}
The routine is used in situations where we have a trial set of densities for a cell, but do not want to populate the plasma structure with them (yet).

\paragraph*{Notes}

This makes use of the fact that the densities are stored in ion order. 

Definition at line 905 of file saha.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_a90e110fd1ce9e1f21afb98455e153ba9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{saha_8c_aa8ede21a14cf7e763909094555c5240d}\label{saha_8c_aa8ede21a14cf7e763909094555c5240d}} 
\index{saha.\+c@{saha.\+c}!lucy@{lucy}}
\index{lucy@{lucy}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{lucy()}{lucy()}}
{\footnotesize\ttfamily int lucy (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances contained in xplasma. It thus assumes that \hyperlink{saha_8c_a16363b5cd764e733bd84a0d991cb6568}{saha()} has been called before it, in the concentrations routine. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A single plasma cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always retuns 0
\end{DoxyReturn}
This routine solves for ne (and the concentrations) using the Lucy Mazzli correction factors.

\paragraph*{Notes}

The routine needs the Saha abundances before the correction factors can be found. As a result, the sequence is to call parttion functions, concentrations and then this routine.

Procedurally, the routine is analogous to \hyperlink{saha_8c_a96f3f44cc5cf473ca91ca268747dfba1}{concentrations()}

Note that also applied the macro\+\_\+pops routine, and required that the ne convergence criteria is rigorous enough that the macro atom level populations converge on the correct values. 

Definition at line 493 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_aa8ede21a14cf7e763909094555c5240d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{saha_8c_aa8ede21a14cf7e763909094555c5240d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{saha_8c_a389fdf4d9e9d542a78a25229ce259927}\label{saha_8c_a389fdf4d9e9d542a78a25229ce259927}} 
\index{saha.\+c@{saha.\+c}!lucy\+\_\+mazzali1@{lucy\+\_\+mazzali1}}
\index{lucy\+\_\+mazzali1@{lucy\+\_\+mazzali1}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{lucy\+\_\+mazzali1()}{lucy\_mazzali1()}}
{\footnotesize\ttfamily int lucy\+\_\+mazzali1 (\begin{DoxyParamCaption}\item[{double}]{nh,  }\item[{double}]{t\+\_\+r,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{www,  }\item[{int}]{nelem,  }\item[{double}]{ne,  }\item[{density}]{,  }\item[{double}]{xne,  }\item[{newden}]{ }\end{DoxyParamCaption})}



calculates ion densities of a single element (defined by nelem) according to a modified on the spot approximation, in this case equation 11 of Mazzali and Lucy which attempts to consider ionizations from excieted and ground state levels. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nh Number density of H \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+r The radiation temeperture \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e The electorn temperature \\
\hline
\mbox{\tt in}  & {\em double} & www dilution factor for the radiation field \\
\hline
\mbox{\tt in}  & {\em int} & nelem the element number for which the calculation is carried out \\
\hline
\mbox{\tt in}  & {\em double} & ne electron density \\
\hline
\mbox{\tt in}  & {\em double} & density\mbox{[}\mbox{]} densities of individual ions under pure Saha conditions \\
\hline
 & {\em \mbox{[}in} & out\mbox{]} double xne ??? \\
\hline
\mbox{\tt out}  & {\em double} & newden\mbox{[}\mbox{]} Array containing the modified densities \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if it converged to an answer, -\/1 otherwise. On an abnormal return the density array and ne are left unchanged.
\end{DoxyReturn}
This is a first attempt to fudge the ionization equation in the wind to account for the fact that one is not sitting in a BB radiation field. The routine assumes one has already put the concentrations of of the ions under L\+TE conditions for a temperature t\+\_\+r into density. It uses the same dumb procedure as for \char`\"{}concentrations.\char`\"{}

\paragraph*{Notes}

It\textquotesingle{}s probably OK but it would be worthwhile worrying whether I have introduced any problems by setting the floor to any species and ne of D\+E\+N\+S\+I\+T\+Y\+\_\+\+M\+IN 

Definition at line 634 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_a389fdf4d9e9d542a78a25229ce259927_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{saha_8c_a389fdf4d9e9d542a78a25229ce259927_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{saha_8c_a63d5795e0b9978d33ed61a63917004e2}\label{saha_8c_a63d5795e0b9978d33ed61a63917004e2}} 
\index{saha.\+c@{saha.\+c}!nebular\+\_\+concentrations@{nebular\+\_\+concentrations}}
\index{nebular\+\_\+concentrations@{nebular\+\_\+concentrations}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{nebular\+\_\+concentrations()}{nebular\_concentrations()}}
{\footnotesize\ttfamily int nebular\+\_\+concentrations (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the Wind\+Ptr itself, such as t\+\_\+r, t\+\_\+e, w, based on the \char`\"{}mode\char`\"{}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A single plasma cell \\
\hline
\mbox{\tt in}  & {\em int} & mode A mode which describes which of the various ionization schemes to use \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status message (returned from the individual routines that calculate the ionization. 0 generally signifies success.
\end{DoxyReturn}
nebular concentrations serves as the steering routine for all ionization calculations.

\paragraph*{Notes}

Definition at line 51 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_a63d5795e0b9978d33ed61a63917004e2_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_a63d5795e0b9978d33ed61a63917004e2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{saha_8c_a16363b5cd764e733bd84a0d991cb6568}\label{saha_8c_a16363b5cd764e733bd84a0d991cb6568}} 
\index{saha.\+c@{saha.\+c}!saha@{saha}}
\index{saha@{saha}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{saha()}{saha()}}
{\footnotesize\ttfamily int saha (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{ne,  }\item[{double}]{t }\end{DoxyParamCaption})}



Calculate the densities for all of the ions in a single cell given ne and t. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The cell \\
\hline
\mbox{\tt in}  & {\em double} & ne A trial value for ne \\
\hline
\mbox{\tt in}  & {\em double} & t A value of the temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The calculate abundances are stored in xplasma

This routine simply uses the Saha equantion to calculate the densities of all of the ions. It assumes that ne is known, and so in general if one calcualted ne from the concentrations, one would not get the input value. Iteration to calculate ne takes place in concentrations.

\paragraph*{Notes}

All of the partition functions are assumed to have been calculated before entering the routine. 

Definition at line 358 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_a16363b5cd764e733bd84a0d991cb6568_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{saha_8c_a16363b5cd764e733bd84a0d991cb6568_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{saha_8c_a23e841e587b275d756267eddb95cc6a2}\label{saha_8c_a23e841e587b275d756267eddb95cc6a2}} 
\index{saha.\+c@{saha.\+c}!con\+\_\+force@{con\+\_\+force}}
\index{con\+\_\+force@{con\+\_\+force}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{con\+\_\+force}{con\_force}}
{\footnotesize\ttfamily struct \hyperlink{structforce__con}{force\+\_\+con}
 con\+\_\+force\mbox{[}1000\mbox{]}}

\mbox{\Hypertarget{saha_8c_a55786cdfcf98a42b819656e1e4ee7065}\label{saha_8c_a55786cdfcf98a42b819656e1e4ee7065}} 
\index{saha.\+c@{saha.\+c}!fix\+\_\+con\+\_\+start@{fix\+\_\+con\+\_\+start}}
\index{fix\+\_\+con\+\_\+start@{fix\+\_\+con\+\_\+start}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{fix\+\_\+con\+\_\+start}{fix\_con\_start}}
{\footnotesize\ttfamily int fix\+\_\+con\+\_\+start = 0}



Definition at line 754 of file saha.\+c.

\mbox{\Hypertarget{saha_8c_a2b3eba3a0a02b028a29c5d59620ba991}\label{saha_8c_a2b3eba3a0a02b028a29c5d59620ba991}} 
\index{saha.\+c@{saha.\+c}!nforce@{nforce}}
\index{nforce@{nforce}!saha.\+c@{saha.\+c}}
\subsubsection{\texorpdfstring{nforce}{nforce}}
{\footnotesize\ttfamily int nforce}



Definition at line 761 of file saha.\+c.

