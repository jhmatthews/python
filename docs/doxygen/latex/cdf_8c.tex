\hypertarget{cdf_8c}{}\section{/\+Users/mhewitt/python/source/cdf.c File Reference}
\label{cdf_8c}\index{/\+Users/mhewitt/python/source/cdf.\+c@{/\+Users/mhewitt/python/source/cdf.\+c}}


Routines to create a cumulatimve distribution (C\+DF) from a function or array, and then to sample that cdf in a fleximble manner.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}models.\+h\char`\"{}}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+sort.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+interp.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+rng.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+randist.\+h$>$}\newline
Include dependency graph for cdf.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{cdf_8c_a0eb2d38b53bd0577b2f9a302702a765c}{P\+D\+F\+S\+T\+E\+PS}~10000
\begin{DoxyCompactList}\small\item\em This is the initial value of P\+D\+F\+S\+T\+E\+PS. \end{DoxyCompactList}\item 
\#define \hyperlink{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}{P\+D\+F\+\_\+\+A\+R\+R\+AY}~28000
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{cdf_8c_a759a0a027603baae4d61eed58031a71b}{cdf\+\_\+gen\+\_\+from\+\_\+func} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, double($\ast$)(double) func, double xmin, double xmax, int njumps, \hyperlink{continuum_8c_a47bb97973150c998d469697784328f6e}{jump})
\begin{DoxyCompactList}\small\item\em Generate a cumulative distrubution function (cdf) from a function. \end{DoxyCompactList}\item 
double \hyperlink{cdf_8c_a55ee1475eba79ff70c6b97c836df25c7}{gen\+\_\+array\+\_\+from\+\_\+func} (double($\ast$)(double) func, double xmin, double xmax, int pdfsteps)
\begin{DoxyCompactList}\small\item\em generates a cdf from a function \end{DoxyCompactList}\item 
int \hyperlink{cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8}{cdf\+\_\+gen\+\_\+from\+\_\+array} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, y, int n\+\_\+xy, double xmin, double xmax)
\begin{DoxyCompactList}\small\item\em Generate a cumulative distribution function (cdf) from an array of values. \end{DoxyCompactList}\item 
double \hyperlink{cdf_8c_a6cd473cda634a93562f9162b5c0c5f06}{cdf\+\_\+get\+\_\+rand} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em Generate a single sample from a cdf. \end{DoxyCompactList}\item 
int \hyperlink{cdf_8c_aecb77ca29971f4b21ea483ab1672e652}{cdf\+\_\+limit} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, double xmin, double xmax)
\begin{DoxyCompactList}\small\item\em sets limit1 and limit2 so that one can generate distributions from a limited range within a previously created cdf. \end{DoxyCompactList}\item 
double \hyperlink{cdf_8c_ab79e837935267ae9f6061620404f000e}{cdf\+\_\+get\+\_\+rand\+\_\+limit} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em get a random number for a cdf inside limits set by cdf\+\_\+limit. \end{DoxyCompactList}\item 
int \hyperlink{cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b}{cdf\+\_\+to\+\_\+file} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, filename)
\begin{DoxyCompactList}\small\item\em Write the full structure of the cumulattive distribution function to a file. \end{DoxyCompactList}\item 
int \hyperlink{cdf_8c_ac8e83990b5cf236827414abe43bee911}{cdf\+\_\+check} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em a simple routine to check some basics of the cumulative distribution function. \end{DoxyCompactList}\item 
int \hyperlink{cdf_8c_a30c0717640ef307cbe5489ec9ef911f5}{calc\+\_\+cdf\+\_\+gradient} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points. \end{DoxyCompactList}\item 
int \hyperlink{cdf_8c_a55984373c219b38477d5dafb44c2e336}{cdf\+\_\+array\+\_\+fixup} (double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double $\ast$y, int n\+\_\+xy)
\begin{DoxyCompactList}\small\item\em Given two paralel arrays, x and y, this routine reorders the array in ascending order of x. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{cdf_8c_a343a93e72865e903cfe3ce0f69361db5}{pdf\+\_\+steps\+\_\+current}
\begin{DoxyCompactList}\small\item\em This is the value of pdfsteps at this point in time. \end{DoxyCompactList}\item 
int \hyperlink{cdf_8c_a474b5aa096196458745709eb60b2ad20}{init\+\_\+pdf} = 0
\begin{DoxyCompactList}\small\item\em Flag to say whether structures to hold a cdf have been initialised. \end{DoxyCompactList}\item 
double $\ast$ \hyperlink{cdf_8c_a8977edf5d3fd4c68f5627235db8ca564}{pdf\+\_\+array}
\begin{DoxyCompactList}\small\item\em Pointer to pdf\+\_\+array -\/ made external because it is used in varous routines. \end{DoxyCompactList}\item 
double \hyperlink{cdf_8c_a8fde0c6951fb53dc1672b1d6e14efe6f}{pdf\+\_\+x} \mbox{[}\hyperlink{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}{P\+D\+F\+\_\+\+A\+R\+R\+AY}\mbox{]}
\item 
double \hyperlink{cdf_8c_a1bd5f32c7826172a1eb9ea2f2ad45ce7}{pdf\+\_\+y} \mbox{[}\hyperlink{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}{P\+D\+F\+\_\+\+A\+R\+R\+AY}\mbox{]}
\item 
double \hyperlink{cdf_8c_a48989ccc668bffbc0f0fc84526341d53}{pdf\+\_\+z} \mbox{[}\hyperlink{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}{P\+D\+F\+\_\+\+A\+R\+R\+AY}\mbox{]}
\item 
int \hyperlink{cdf_8c_a7a99ffa2f02388ef6442afddfdef0c31}{pdf\+\_\+n}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines to create a cumulatimve distribution (C\+DF) from a function or array, and then to sample that cdf in a fleximble manner. 

\begin{DoxyAuthor}{Author}
ksl,nsh 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
March, 2018
\end{DoxyDate}
C\+D\+Fs can be generated either from a function using cdf\+\_\+gen\+\_\+from\+\_\+func or from an array using cdf gen\+\_\+from\+\_\+array. The function or the array that is input are used as the proability densities for the cdfs. The cdfs are stored in a \hyperlink{struct_cdf}{Cdf} structure (See \hyperlink{python_8h}{python.\+h})

The procedure is either to call cdf\+\_\+gen\+\_\+from\+\_\+func if you have a function whose probability distribution you want (as might be the case if you were generating bremsstrahlung photons and you knew the formula) or cdf\+\_\+gen\+\_\+from\+\_\+array (as might be the case if you were trying to generate Monte Carlo spectra from precalculated Kurucz models).

Once the cdfs are generated one can sample the full distribution distritution function with cdf\+\_\+get\+\_\+rand, or one can sample a part of the distribution by setting the part that one wants with cdf\+\_\+limit and then sampling the distribution with cdf\+\_\+get\+\_\+rand\+\_\+limit

There are a number of helper functions that are internal to the generation of the cdfs, and verification that the cdfs are readonable.

\paragraph*{Notes}

In generating the C\+D\+Fs, one must be careful of places where the pdf is discontinuous, or more generally changing in a way that will not be well represented via linear interpolations. When generating a C\+DF from a function it is possible to specify positions where one wishes to have points, e.\+g on either side of a discontinuity. When generating a C\+DF from a function, the discontinuities should be well sampled in the array that is provided.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000006}{Bug}]For reasons, which are currently unclear there are differences in the number of points maintained in the cdfs for different generation methods.\end{DoxyRefDesc}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}\label{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}} 
\index{cdf.\+c@{cdf.\+c}!P\+D\+F\+\_\+\+A\+R\+R\+AY@{P\+D\+F\+\_\+\+A\+R\+R\+AY}}
\index{P\+D\+F\+\_\+\+A\+R\+R\+AY@{P\+D\+F\+\_\+\+A\+R\+R\+AY}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{P\+D\+F\+\_\+\+A\+R\+R\+AY}{PDF\_ARRAY}}
{\footnotesize\ttfamily \#define P\+D\+F\+\_\+\+A\+R\+R\+AY~28000}



Definition at line 366 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_a0eb2d38b53bd0577b2f9a302702a765c}\label{cdf_8c_a0eb2d38b53bd0577b2f9a302702a765c}} 
\index{cdf.\+c@{cdf.\+c}!P\+D\+F\+S\+T\+E\+PS@{P\+D\+F\+S\+T\+E\+PS}}
\index{P\+D\+F\+S\+T\+E\+PS@{P\+D\+F\+S\+T\+E\+PS}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{P\+D\+F\+S\+T\+E\+PS}{PDFSTEPS}}
{\footnotesize\ttfamily \#define P\+D\+F\+S\+T\+E\+PS~10000}



This is the initial value of P\+D\+F\+S\+T\+E\+PS. 



Definition at line 53 of file cdf.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{cdf_8c_a30c0717640ef307cbe5489ec9ef911f5}\label{cdf_8c_a30c0717640ef307cbe5489ec9ef911f5}} 
\index{cdf.\+c@{cdf.\+c}!calc\+\_\+cdf\+\_\+gradient@{calc\+\_\+cdf\+\_\+gradient}}
\index{calc\+\_\+cdf\+\_\+gradient@{calc\+\_\+cdf\+\_\+gradient}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{calc\+\_\+cdf\+\_\+gradient()}{calc\_cdf\_gradient()}}
{\footnotesize\ttfamily int calc\+\_\+cdf\+\_\+gradient (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns 0; a positive return indicates a problem
\end{DoxyReturn}
Calculate the gradient of a cdf at each point in the cdf array in oder to allow one to calculate a first order correction to a uniform distibution between the points where the gradient has been calculated.

\paragraph*{Notes}

The gradients are calculated by differencing the cdf. Thus this routine should work both for cdf\textquotesingle{}s calculated from functions and from arrays

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000007}{Bug}]X\+XX N\+SH -\/ the way that the ends are dealt with is not great -\/ we should really try to come up with an extrapolation rather than just fill in the same gradients for the second and penultimate cells into the first and last cells.\end{DoxyRefDesc}


Definition at line 1038 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a30c0717640ef307cbe5489ec9ef911f5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_a55984373c219b38477d5dafb44c2e336}\label{cdf_8c_a55984373c219b38477d5dafb44c2e336}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+array\+\_\+fixup@{cdf\+\_\+array\+\_\+fixup}}
\index{cdf\+\_\+array\+\_\+fixup@{cdf\+\_\+array\+\_\+fixup}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+array\+\_\+fixup()}{cdf\_array\_fixup()}}
{\footnotesize\ttfamily int cdf\+\_\+array\+\_\+fixup (\begin{DoxyParamCaption}\item[{double $\ast$}]{x,  }\item[{double $\ast$}]{y,  }\item[{int}]{n\+\_\+xy }\end{DoxyParamCaption})}



Given two paralel arrays, x and y, this routine reorders the array in ascending order of x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & $\ast$ x The array that is sorted \\
\hline
\mbox{\tt in,out}  & {\em double} & $\ast$ y The parallel array that is sorted in order of x \\
\hline
\mbox{\tt in,out}  & {\em int} & n\+\_\+xy The length of the two arrays \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The length of the input array
\end{DoxyReturn}
This routine is a routine that is intended to fix a potential problem with an input pdf, which one is intending to convert into a cdf. The cdf genearion routines assume that an input routine is in ascending order of the x variable, often a freqency. The y variable is usually an unnormalized pdf. This routine checks that the x variables is indeed in ascending order and if not reorders the two arrays.

\paragraph*{Notes}

The routine makes an assumption about what one wants if the x array contains two x values that are identical. It assumes one wants to the value with the lower corresponding pdf value to be first in the output arrays (as is genearlly the case whn one has a sharp jump for a photoionization x-\/section. This will generate a at the upper edge of a square wave. 

Definition at line 1114 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_ac8e83990b5cf236827414abe43bee911}\label{cdf_8c_ac8e83990b5cf236827414abe43bee911}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+check@{cdf\+\_\+check}}
\index{cdf\+\_\+check@{cdf\+\_\+check}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+check()}{cdf\_check()}}
{\footnotesize\ttfamily int cdf\+\_\+check (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



a simple routine to check some basics of the cumulative distribution function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if eveything is OK, a positive number otherwise
\end{DoxyReturn}
This is a diagnostic designed to see whether a cdf is reasonable

\paragraph*{Notes}

Definition at line 916 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_ac8e83990b5cf236827414abe43bee911_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_ac8e83990b5cf236827414abe43bee911_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8}\label{cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+gen\+\_\+from\+\_\+array@{cdf\+\_\+gen\+\_\+from\+\_\+array}}
\index{cdf\+\_\+gen\+\_\+from\+\_\+array@{cdf\+\_\+gen\+\_\+from\+\_\+array}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+gen\+\_\+from\+\_\+array()}{cdf\_gen\_from\_array()}}
{\footnotesize\ttfamily int cdf\+\_\+gen\+\_\+from\+\_\+array (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{,  }\item[{y}]{,  }\item[{int}]{n\+\_\+xy,  }\item[{double}]{xmin,  }\item[{double}]{xmax }\end{DoxyParamCaption})}



Generate a cumulative distribution function (cdf) from an array of values. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em cdf} & Pointer to the cdf that will be populated here \\
\hline
\mbox{\tt in}  & {\em x} & Locations of points in supplied data -\/ usually wavelength or freuency \\
\hline
\mbox{\tt in}  & {\em y} & Data -\/ e.\+g. cross section or emissivity \\
\hline
\mbox{\tt in}  & {\em n\+\_\+xy} & Number of data points \\
\hline
\mbox{\tt in}  & {\em xmin} & Lower limit to required cdf \\
\hline
\mbox{\tt in}  & {\em xmin} & Upper limit to required cdf \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
echeck the reutrn value from cdf\+\_\+check
\end{DoxyReturn}
Takes two arrays of some values of a function y at locations x and turns it into a cumlative density function to allow random values to be obtained from the function. There is no resampling.

\paragraph*{Notes}

cdf\+\_\+gen\+\_\+from\+\_\+array does not have the concept of jumps. All of this needs to be taken care of by the routine that generates the array.

In constructing the cdf the routine collapses regions of the pdf that have zero probability of occuring 

Definition at line 403 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a6add58a19448dc0dde8f4bc4bbc46cc8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_a759a0a027603baae4d61eed58031a71b}\label{cdf_8c_a759a0a027603baae4d61eed58031a71b}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+gen\+\_\+from\+\_\+func@{cdf\+\_\+gen\+\_\+from\+\_\+func}}
\index{cdf\+\_\+gen\+\_\+from\+\_\+func@{cdf\+\_\+gen\+\_\+from\+\_\+func}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+gen\+\_\+from\+\_\+func()}{cdf\_gen\_from\_func()}}
{\footnotesize\ttfamily int cdf\+\_\+gen\+\_\+from\+\_\+func (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{double ($\ast$) (double)}]{func,  }\item[{double}]{xmin,  }\item[{double}]{xmax,  }\item[{int}]{njumps,  }\item[{\hyperlink{continuum_8c_a47bb97973150c998d469697784328f6e}{jump}}]{ }\end{DoxyParamCaption})}



Generate a cumulative distrubution function (cdf) from a function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$func The probablility density function to be integrated to create the pdf \\
\hline
\mbox{\tt in}  & {\em double} & xmin,xmax The range over which the function is to be integrated \\
\hline
\mbox{\tt in}  & {\em int} & njumps The number of points at which we want to force a break in the cdf \\
\hline
\mbox{\tt in}  & {\em double} & jump an array of points in the x-\/corrdinates at which we want to force points \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on successful completion,
\end{DoxyReturn}
This routine allows one to generate a C\+DF from a function. It is used to make photons from blackbody and bremstrahlung sources and also to sample things like cosine functions for directions of generated photons.

\paragraph*{Notes}

The jumps are used to force points in the C\+DF at certain values of X. 

Definition at line 90 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a759a0a027603baae4d61eed58031a71b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a759a0a027603baae4d61eed58031a71b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_a6cd473cda634a93562f9162b5c0c5f06}\label{cdf_8c_a6cd473cda634a93562f9162b5c0c5f06}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+get\+\_\+rand@{cdf\+\_\+get\+\_\+rand}}
\index{cdf\+\_\+get\+\_\+rand@{cdf\+\_\+get\+\_\+rand}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+get\+\_\+rand()}{cdf\_get\_rand()}}
{\footnotesize\ttfamily double cdf\+\_\+get\+\_\+rand (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



Generate a single sample from a cdf. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Cdf\+Ptr} & cdf a structure which contains the cumulative distribution function. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
x a random value fronm the cdf between xmin and xmax
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 652 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a6cd473cda634a93562f9162b5c0c5f06_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_ab79e837935267ae9f6061620404f000e}\label{cdf_8c_ab79e837935267ae9f6061620404f000e}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+get\+\_\+rand\+\_\+limit@{cdf\+\_\+get\+\_\+rand\+\_\+limit}}
\index{cdf\+\_\+get\+\_\+rand\+\_\+limit@{cdf\+\_\+get\+\_\+rand\+\_\+limit}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+get\+\_\+rand\+\_\+limit()}{cdf\_get\_rand\_limit()}}
{\footnotesize\ttfamily double cdf\+\_\+get\+\_\+rand\+\_\+limit (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



get a random number for a cdf inside limits set by cdf\+\_\+limit. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A random number drawn from the \hyperlink{struct_cdf}{Cdf}, but within inside limits which have been set previously
\end{DoxyReturn}
The basic idea here is that we have created a cdf that covers a broad range of, for example, frequncy space. At this point we want photons that only cover some portion of the broad range. Instead of creating a new cdf that just covers a desired frequency space, we only sample a portion of the broad range as defined by cdf\+\_\+limit (for this particular cdf)

\paragraph*{Notes}

Definition at line 818 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_ab79e837935267ae9f6061620404f000e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_ab79e837935267ae9f6061620404f000e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_aecb77ca29971f4b21ea483ab1672e652}\label{cdf_8c_aecb77ca29971f4b21ea483ab1672e652}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+limit@{cdf\+\_\+limit}}
\index{cdf\+\_\+limit@{cdf\+\_\+limit}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+limit()}{cdf\_limit()}}
{\footnotesize\ttfamily int cdf\+\_\+limit (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{double}]{xmin,  }\item[{double}]{xmax }\end{DoxyParamCaption})}



sets limit1 and limit2 so that one can generate distributions from a limited range within a previously created cdf. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\mbox{\tt in}  & {\em double} & xmin The minimum value to return \\
\hline
\mbox{\tt in}  & {\em double} & xmax The maximum value to return \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
We have defined the cdf in such a way that one can generate a random number 0 and 1, find the place in the y array that corresponds to this and map back onto the x values (which is what is returned. We now want to limit the range of the returned x values, but we need to know in terms of the original array where these values are and the generate a random number between some minimum ($>$0) and maximum ($<$1) whichi will allow one to find the x that corresponds. The point of this routine is to find that minimum and maximum value. Having done this one can call cdf\+\_\+get\+\_\+rand\+\_\+limit

\paragraph*{Notes}

Sometimes it is expensive computationally to recalculate the distribution function every time you change the limits. An example of this is the distribution function for a bb where the distribution function is quite smooth (and can be represented in a dimensionless manner) but calculating the function and the distribution function can be expensive. This routine together with cdf\+\_\+gen\+\_\+rand\+\_\+limit allow one to sample a part of a cdf. Note that cdf\+\_\+gen-\/from\+\_\+func or cdf\+\_\+gen\+\_\+from\+\_\+array should have been called previously!

xmin and xmax will cause cdf\mbox{[}\mbox{]}.limit1 and cdf\mbox{[}\mbox{]}.limit2 to be set in such a way that when you call pdf\+\_\+get\+\_\+rand\+\_\+limit the distribution will be sampled only between xmin and xmax.

If these routine is called improperly, e.\+g if xmin and xmax lie outside of the original value of xmin and xmax then the distribution will not extend this far, and the progrem will exit. 

Definition at line 735 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_aecb77ca29971f4b21ea483ab1672e652_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_aecb77ca29971f4b21ea483ab1672e652_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b}\label{cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b}} 
\index{cdf.\+c@{cdf.\+c}!cdf\+\_\+to\+\_\+file@{cdf\+\_\+to\+\_\+file}}
\index{cdf\+\_\+to\+\_\+file@{cdf\+\_\+to\+\_\+file}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+to\+\_\+file()}{cdf\_to\_file()}}
{\footnotesize\ttfamily int cdf\+\_\+to\+\_\+file (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{filename}]{ }\end{DoxyParamCaption})}



Write the full structure of the cumulattive distribution function to a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\mbox{\tt in}  & {\em char} & filename\mbox{[}\mbox{]} The name of the file to which the cdf should be written \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a diagnostic routine

\paragraph*{Notes}

Definition at line 877 of file cdf.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a31e0e0d8ba68a00590abef9754c8ea6b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{cdf_8c_a55ee1475eba79ff70c6b97c836df25c7}\label{cdf_8c_a55ee1475eba79ff70c6b97c836df25c7}} 
\index{cdf.\+c@{cdf.\+c}!gen\+\_\+array\+\_\+from\+\_\+func@{gen\+\_\+array\+\_\+from\+\_\+func}}
\index{gen\+\_\+array\+\_\+from\+\_\+func@{gen\+\_\+array\+\_\+from\+\_\+func}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{gen\+\_\+array\+\_\+from\+\_\+func()}{gen\_array\_from\_func()}}
{\footnotesize\ttfamily double gen\+\_\+array\+\_\+from\+\_\+func (\begin{DoxyParamCaption}\item[{double ($\ast$) (double)}]{func,  }\item[{double}]{xmin,  }\item[{double}]{xmax,  }\item[{int}]{pdfsteps }\end{DoxyParamCaption})}



generates a cdf from a function 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & $\ast$func The probablility density function to be integrated to create the pdf \\
\hline
\mbox{\tt in}  & {\em double} & xmin,xmax; The range over which the function is to be integrated \\
\hline
\mbox{\tt in}  & {\em int} & pdfsteps; number of steps that are calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
delta -\/ the largest change in the cdf between any two points in the grid.
\end{DoxyReturn}
This is a routine which is called by cdf\+\_\+gen\+\_\+from\+\_\+func which simply calculates the cumulative distribution of the function in equally spaced steps between xmin and xmax. The C\+DF is properly normalized.

\paragraph*{Notes}

10oct -\/ ksl -\/\+This is rather brute force. An alternative would have been to have increased the density of points only in the region where it was needed. This could be done by looking at the regions where the sampling was poor in the initial calculation and addeding new points in in a new calculations. But this would require one to pass both the values of the C\+DF and the positions where the values were taken. This would be not be hard but would require more extensive modifications to pdf\+\_\+gen\+\_\+from func than currently. 

Definition at line 270 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{cdf_8c_a55ee1475eba79ff70c6b97c836df25c7_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{cdf_8c_a474b5aa096196458745709eb60b2ad20}\label{cdf_8c_a474b5aa096196458745709eb60b2ad20}} 
\index{cdf.\+c@{cdf.\+c}!init\+\_\+pdf@{init\+\_\+pdf}}
\index{init\+\_\+pdf@{init\+\_\+pdf}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+pdf}{init\_pdf}}
{\footnotesize\ttfamily int init\+\_\+pdf = 0}



Flag to say whether structures to hold a cdf have been initialised. 



Definition at line 59 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_a8977edf5d3fd4c68f5627235db8ca564}\label{cdf_8c_a8977edf5d3fd4c68f5627235db8ca564}} 
\index{cdf.\+c@{cdf.\+c}!pdf\+\_\+array@{pdf\+\_\+array}}
\index{pdf\+\_\+array@{pdf\+\_\+array}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{pdf\+\_\+array}{pdf\_array}}
{\footnotesize\ttfamily double$\ast$ pdf\+\_\+array}



Pointer to pdf\+\_\+array -\/ made external because it is used in varous routines. 



Definition at line 62 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_a7a99ffa2f02388ef6442afddfdef0c31}\label{cdf_8c_a7a99ffa2f02388ef6442afddfdef0c31}} 
\index{cdf.\+c@{cdf.\+c}!pdf\+\_\+n@{pdf\+\_\+n}}
\index{pdf\+\_\+n@{pdf\+\_\+n}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{pdf\+\_\+n}{pdf\_n}}
{\footnotesize\ttfamily int pdf\+\_\+n}



Definition at line 369 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_a343a93e72865e903cfe3ce0f69361db5}\label{cdf_8c_a343a93e72865e903cfe3ce0f69361db5}} 
\index{cdf.\+c@{cdf.\+c}!pdf\+\_\+steps\+\_\+current@{pdf\+\_\+steps\+\_\+current}}
\index{pdf\+\_\+steps\+\_\+current@{pdf\+\_\+steps\+\_\+current}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{pdf\+\_\+steps\+\_\+current}{pdf\_steps\_current}}
{\footnotesize\ttfamily int pdf\+\_\+steps\+\_\+current}



This is the value of pdfsteps at this point in time. 



Definition at line 56 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_a8fde0c6951fb53dc1672b1d6e14efe6f}\label{cdf_8c_a8fde0c6951fb53dc1672b1d6e14efe6f}} 
\index{cdf.\+c@{cdf.\+c}!pdf\+\_\+x@{pdf\+\_\+x}}
\index{pdf\+\_\+x@{pdf\+\_\+x}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{pdf\+\_\+x}{pdf\_x}}
{\footnotesize\ttfamily double pdf\+\_\+x\mbox{[}\hyperlink{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}{P\+D\+F\+\_\+\+A\+R\+R\+AY}\mbox{]}}



Definition at line 368 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_a1bd5f32c7826172a1eb9ea2f2ad45ce7}\label{cdf_8c_a1bd5f32c7826172a1eb9ea2f2ad45ce7}} 
\index{cdf.\+c@{cdf.\+c}!pdf\+\_\+y@{pdf\+\_\+y}}
\index{pdf\+\_\+y@{pdf\+\_\+y}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{pdf\+\_\+y}{pdf\_y}}
{\footnotesize\ttfamily double pdf\+\_\+y\mbox{[}\hyperlink{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}{P\+D\+F\+\_\+\+A\+R\+R\+AY}\mbox{]}}



Definition at line 368 of file cdf.\+c.

\mbox{\Hypertarget{cdf_8c_a48989ccc668bffbc0f0fc84526341d53}\label{cdf_8c_a48989ccc668bffbc0f0fc84526341d53}} 
\index{cdf.\+c@{cdf.\+c}!pdf\+\_\+z@{pdf\+\_\+z}}
\index{pdf\+\_\+z@{pdf\+\_\+z}!cdf.\+c@{cdf.\+c}}
\subsubsection{\texorpdfstring{pdf\+\_\+z}{pdf\_z}}
{\footnotesize\ttfamily double pdf\+\_\+z\mbox{[}\hyperlink{cdf_8c_a0100482896d5d68afe86c8bb601ddba6}{P\+D\+F\+\_\+\+A\+R\+R\+AY}\mbox{]}}



Definition at line 368 of file cdf.\+c.

