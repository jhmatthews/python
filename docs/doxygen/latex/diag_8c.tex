\hypertarget{diag_8c}{}\section{/\+Users/mhewitt/python/source/diag.c File Reference}
\label{diag_8c}\index{/\+Users/mhewitt/python/source/diag.\+c@{/\+Users/mhewitt/python/source/diag.\+c}}


consolidates an approach to providing extra diagnositcs for debugging python, Some of the diagnostics allow one to change defaults in python while others allow traking of and contains initialization routines that control which diagnosics are a  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for diag.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{diag_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{diag_8c_acb7ea92897c7bc8fa09f98078babcc01}{get\+\_\+standard\+\_\+care\+\_\+factors} ()
\begin{DoxyCompactList}\small\item\em get inputs that provides more control over how the program is run \end{DoxyCompactList}\item 
int \hyperlink{diag_8c_ab28b32b3a1f983da958d2a6a8a0554fc}{get\+\_\+extra\+\_\+diagnostics} ()
\begin{DoxyCompactList}\small\item\em Allows the user to specify what extra diagnositcs to write out. \end{DoxyCompactList}\item 
int \hyperlink{diag_8c_ae56c24fbf634a302259671a903bcea7e}{init\+\_\+extra\+\_\+diagnostics} ()
\begin{DoxyCompactList}\small\item\em opon a file for writing out extra diagnostics. In some cases reads a file that specifies in which cells ones wants diagnostics \end{DoxyCompactList}\item 
int \hyperlink{diag_8c_a1c8114c71c12528c31d3329d1a5a7777}{save\+\_\+photon\+\_\+stats} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds, double w\+\_\+ave)
\begin{DoxyCompactList}\small\item\em prints photon statistics to a file \end{DoxyCompactList}\item 
int \hyperlink{diag_8c_ad9812264d4df596406d5878299e8b7e5}{save\+\_\+extract\+\_\+photons} (int n, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, double $\ast$\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em saves informations about phtoons in a particulare wavelength gange \end{DoxyCompactList}\item 
int \hyperlink{diag_8c_a852eb08f6a48973ca3dfd61567803ee8}{save\+\_\+photons} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, comment)
\begin{DoxyCompactList}\small\item\em save\+\_\+photon \end{DoxyCompactList}\item 
int \hyperlink{diag_8c_a36a9f5603f59602831695269c056cbe4}{track\+\_\+scatters} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int nplasma, char $\ast$comment)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{diag_8c_a11a7b3a6415f5b7dab044fdecb221290}{eplinit} = 0
\item 
int \hyperlink{diag_8c_a9654f2212b3e8e58fb6e61ae9751deff}{pstatinit} = 0
\begin{DoxyCompactList}\small\item\em To say if we have checked to see if we need to log photons. \end{DoxyCompactList}\item 
F\+I\+LE $\ast$ \hyperlink{diag_8c_a1c920244fb7c509b78eacdd7cc843754}{epltptr}
\begin{DoxyCompactList}\small\item\em Extra diagnostics file. \end{DoxyCompactList}\item 
int \hyperlink{diag_8c_a3ddae9aa9fbb2071a1acbb0b9dcbf255}{save\+\_\+photon\+\_\+number} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
consolidates an approach to providing extra diagnositcs for debugging python, Some of the diagnostics allow one to change defaults in python while others allow traking of and contains initialization routines that control which diagnosics are a 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May, 2018
\end{DoxyDate}
The first few functions are associated with gather information about what one wants to track

The basic idea for the extra diagnositics routines are as follows\+:

There is one file to which all of the diagnostics are written. Which diagnositica are written depends on how varaious of the modes variables are set.

All of the various diagnostic routines should be line oriented and begin with a unique identifier to allow easy parsing of the outputs.

To add a new diagnostic one should


\begin{DoxyItemize}
\item (0) check that one of the existing diagnostics is insuffient for your needs
\item (1) add a routine here that writes to the diagnostic file.
\item (2) add a rdpar statement in get\+\_\+extra\+\_\+diagnostics
\item (3) Assure that your new routine has the appropriate doxygne description,
\item (4) Add a yaml file for the new rdpare statemnt), and
\item (5) call the routine with the approriate condidtions from wherever you wish.
\end{DoxyItemize}

As written, you must put your routine here. This is done on purpose so that we will not proliferate extra diagnostics around the various subroutines.

\paragraph*{Notes}

The unified approach makes most sense when one wants similar information spread out over several routines. There will be places where one wishes to print out detailed information within a certain routine. A current example is print\+\_\+dvds\+\_\+info, which is totally contained within \hyperlink{gradv_8c}{gradv.\+c}

This approached was adopted, based onthe discution isssue \#338 A detailed look at the subroutines indicates that this, especially the part having to do with writing to a single diagnostic file is a work in progress.

Right now there are a numer of very similar routines, some of which might be combined. 

\subsection{Function Documentation}
\mbox{\Hypertarget{diag_8c_ab28b32b3a1f983da958d2a6a8a0554fc}\label{diag_8c_ab28b32b3a1f983da958d2a6a8a0554fc}} 
\index{diag.\+c@{diag.\+c}!get\+\_\+extra\+\_\+diagnostics@{get\+\_\+extra\+\_\+diagnostics}}
\index{get\+\_\+extra\+\_\+diagnostics@{get\+\_\+extra\+\_\+diagnostics}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+extra\+\_\+diagnostics()}{get\_extra\_diagnostics()}}
{\footnotesize\ttfamily int get\+\_\+extra\+\_\+diagnostics (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Allows the user to specify what extra diagnositcs to write out. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Based on the inputs, the rougines modifies variables in the modes structure to turn on whichever modes are asked for.

The routine is just for setting up the options. The routine is called only if one has requested extra diagnostics.

\paragraph*{Notes}

see \#111 and \#120

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000018}{Bug}]This routine should be combined with get\+\_\+standard\+\_\+care\+\_\+factors\end{DoxyRefDesc}


Definition at line 158 of file diag.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{diag_8c_ab28b32b3a1f983da958d2a6a8a0554fc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{diag_8c_ab28b32b3a1f983da958d2a6a8a0554fc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{diag_8c_acb7ea92897c7bc8fa09f98078babcc01}\label{diag_8c_acb7ea92897c7bc8fa09f98078babcc01}} 
\index{diag.\+c@{diag.\+c}!get\+\_\+standard\+\_\+care\+\_\+factors@{get\+\_\+standard\+\_\+care\+\_\+factors}}
\index{get\+\_\+standard\+\_\+care\+\_\+factors@{get\+\_\+standard\+\_\+care\+\_\+factors}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+standard\+\_\+care\+\_\+factors()}{get\_standard\_care\_factors()}}
{\footnotesize\ttfamily int get\+\_\+standard\+\_\+care\+\_\+factors (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



get inputs that provides more control over how the program is run 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
In advanced mode, this routine provides ways to change several somewhat unrelated parameters in the routines

The parameters are
\begin{DoxyItemize}
\item the fractional distance a photons may travel
\item the lowest ion allowed to contribute to photabosrption
\item whether photoabsorption is considered in the final spectrum
\end{DoxyItemize}

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000017}{Bug}]It is not obvious that much recent thought has been given to the choices that are here. The fractional distance that a photon travel is intended to make sure the velocity along the line of sight can be approximated linearly. If a photon travels too far in an azimuthal direction the sense of the velocity can change and this prevensts this\end{DoxyRefDesc}


The lowest ion density contributing to photoionization is used to determine what ions one has to calculate the photoionzation xsection for. The lower this density; the more that have to be calculated, and as a result the slower the program.

Keeping photoionizaion during final spectrum allows one to check the contribution of photoabsorption. 

Definition at line 110 of file diag.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{diag_8c_acb7ea92897c7bc8fa09f98078babcc01_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=255pt]{diag_8c_acb7ea92897c7bc8fa09f98078babcc01_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{diag_8c_ae56c24fbf634a302259671a903bcea7e}\label{diag_8c_ae56c24fbf634a302259671a903bcea7e}} 
\index{diag.\+c@{diag.\+c}!init\+\_\+extra\+\_\+diagnostics@{init\+\_\+extra\+\_\+diagnostics}}
\index{init\+\_\+extra\+\_\+diagnostics@{init\+\_\+extra\+\_\+diagnostics}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+extra\+\_\+diagnostics()}{init\_extra\_diagnostics()}}
{\footnotesize\ttfamily int init\+\_\+extra\+\_\+diagnostics (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



opon a file for writing out extra diagnostics. In some cases reads a file that specifies in which cells ones wants diagnostics 

\begin{DoxyReturn}{Returns}
Always retuns 0
\end{DoxyReturn}
This routine gets some residual inforamtion needed to specify exactlay what one wants to track, and opens files that will be used to write the diagnostics.

\paragraph*{Notes}

see \#111 and \#120

The diagnostic filenames are hardwired

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000019}{Bug}]Ultimately we would like to write the extra diagnositcs to a single file\end{DoxyRefDesc}


Definition at line 225 of file diag.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{diag_8c_ae56c24fbf634a302259671a903bcea7e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{diag_8c_ae56c24fbf634a302259671a903bcea7e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{diag_8c_ad9812264d4df596406d5878299e8b7e5}\label{diag_8c_ad9812264d4df596406d5878299e8b7e5}} 
\index{diag.\+c@{diag.\+c}!save\+\_\+extract\+\_\+photons@{save\+\_\+extract\+\_\+photons}}
\index{save\+\_\+extract\+\_\+photons@{save\+\_\+extract\+\_\+photons}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{save\+\_\+extract\+\_\+photons()}{save\_extract\_photons()}}
{\footnotesize\ttfamily int save\+\_\+extract\+\_\+photons (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{double $\ast$}]{v }\end{DoxyParamCaption})}



saves informations about phtoons in a particulare wavelength gange 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n The number of the spectrum \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p The photon before being doppler shifted \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & pp The phtoon after being doppler shiftd \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ v The velocity vector at the possibon of p/pp \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This diagnostic routine was proably written to address a concern about whether the photons were being properly doppler shifted on extract

\paragraph*{Notes}

Called from \hyperlink{extract_8c}{extract.\+c}, where currently one restricts the wavelenght range of the photons to around C\+IV 

Definition at line 348 of file diag.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{diag_8c_ad9812264d4df596406d5878299e8b7e5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{diag_8c_a1c8114c71c12528c31d3329d1a5a7777}\label{diag_8c_a1c8114c71c12528c31d3329d1a5a7777}} 
\index{diag.\+c@{diag.\+c}!save\+\_\+photon\+\_\+stats@{save\+\_\+photon\+\_\+stats}}
\index{save\+\_\+photon\+\_\+stats@{save\+\_\+photon\+\_\+stats}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{save\+\_\+photon\+\_\+stats()}{save\_photon\_stats()}}
{\footnotesize\ttfamily int save\+\_\+photon\+\_\+stats (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds,  }\item[{double}]{w\+\_\+ave }\end{DoxyParamCaption})}



prints photon statistics to a file 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one Wind\+Ptr for the cell \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p Photon pointer (for one photon) \\
\hline
\mbox{\tt in}  & {\em double} & ds ds travelled \\
\hline
\mbox{\tt in}  & {\em double} & w\+\_\+ave The avereage weight of the pohton as it travelled \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine checks whether this is one of a number of cells in which one wishes to record the photons statitics and if so writes out information about the phtoon to a file.

\paragraph*{Notes}

Called from radiation 

Definition at line 299 of file diag.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{diag_8c_a1c8114c71c12528c31d3329d1a5a7777_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{diag_8c_a852eb08f6a48973ca3dfd61567803ee8}\label{diag_8c_a852eb08f6a48973ca3dfd61567803ee8}} 
\index{diag.\+c@{diag.\+c}!save\+\_\+photons@{save\+\_\+photons}}
\index{save\+\_\+photons@{save\+\_\+photons}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{save\+\_\+photons()}{save\_photons()}}
{\footnotesize\ttfamily int save\+\_\+photons (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{comment}]{ }\end{DoxyParamCaption})}



save\+\_\+photon 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\mbox{\tt in}  & {\em char} & comment\mbox{[}\mbox{]} A comment indicating why/at what point the photon information needed to be recorded. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a diagnostic that allows one to print out information about a photon at any time.

\paragraph*{Notes}

It was written as part of the effort to debug imports for the fu\+\_\+ori project. 

Definition at line 385 of file diag.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{diag_8c_a852eb08f6a48973ca3dfd61567803ee8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{diag_8c_a36a9f5603f59602831695269c056cbe4}\label{diag_8c_a36a9f5603f59602831695269c056cbe4}} 
\index{diag.\+c@{diag.\+c}!track\+\_\+scatters@{track\+\_\+scatters}}
\index{track\+\_\+scatters@{track\+\_\+scatters}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{track\+\_\+scatters()}{track\_scatters()}}
{\footnotesize\ttfamily int track\+\_\+scatters (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{nplasma,  }\item[{char $\ast$}]{comment }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\mbox{\tt in}  & {\em int} & nplasma the cell in which the photon resides \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ comment An arbitrary comment \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Another way to track photons. This one is focussed on what happens scattering events.

\paragraph*{Notes}

Definition at line 420 of file diag.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{diag_8c_a36a9f5603f59602831695269c056cbe4_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{diag_8c_a11a7b3a6415f5b7dab044fdecb221290}\label{diag_8c_a11a7b3a6415f5b7dab044fdecb221290}} 
\index{diag.\+c@{diag.\+c}!eplinit@{eplinit}}
\index{eplinit@{eplinit}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{eplinit}{eplinit}}
{\footnotesize\ttfamily int eplinit = 0}



Definition at line 191 of file diag.\+c.

\mbox{\Hypertarget{diag_8c_a1c920244fb7c509b78eacdd7cc843754}\label{diag_8c_a1c920244fb7c509b78eacdd7cc843754}} 
\index{diag.\+c@{diag.\+c}!epltptr@{epltptr}}
\index{epltptr@{epltptr}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{epltptr}{epltptr}}
{\footnotesize\ttfamily F\+I\+LE$\ast$ epltptr}



Extra diagnostics file. 



Definition at line 197 of file diag.\+c.

\mbox{\Hypertarget{diag_8c_a9654f2212b3e8e58fb6e61ae9751deff}\label{diag_8c_a9654f2212b3e8e58fb6e61ae9751deff}} 
\index{diag.\+c@{diag.\+c}!pstatinit@{pstatinit}}
\index{pstatinit@{pstatinit}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{pstatinit}{pstatinit}}
{\footnotesize\ttfamily int pstatinit = 0}



To say if we have checked to see if we need to log photons. 



Definition at line 194 of file diag.\+c.

\mbox{\Hypertarget{diag_8c_a3ddae9aa9fbb2071a1acbb0b9dcbf255}\label{diag_8c_a3ddae9aa9fbb2071a1acbb0b9dcbf255}} 
\index{diag.\+c@{diag.\+c}!save\+\_\+photon\+\_\+number@{save\+\_\+photon\+\_\+number}}
\index{save\+\_\+photon\+\_\+number@{save\+\_\+photon\+\_\+number}!diag.\+c@{diag.\+c}}
\subsubsection{\texorpdfstring{save\+\_\+photon\+\_\+number}{save\_photon\_number}}
{\footnotesize\ttfamily int save\+\_\+photon\+\_\+number = 0}



Definition at line 362 of file diag.\+c.

