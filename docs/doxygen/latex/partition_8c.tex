\hypertarget{partition_8c}{}\section{/\+Users/mhewitt/python/source/partition.c File Reference}
\label{partition_8c}\index{/\+Users/mhewitt/python/source/partition.\+c@{/\+Users/mhewitt/python/source/partition.\+c}}


This file includes calculations of partition functions for ions in plasma cells under a number of assumptions.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for partition.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{partition_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{partition_8c_a37c9b91e3450874eb15cef76079f344d}{partition\+\_\+functions} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations \end{DoxyCompactList}\item 
int \hyperlink{partition_8c_a2de3c1f3e0adc389cfda580a1003a688}{partition\+\_\+functions\+\_\+2} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int xnion, double temp, double weight)
\begin{DoxyCompactList}\small\item\em calculates the partition functions for a pair of ions at a given temperature. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file includes calculations of partition functions for ions in plasma cells under a number of assumptions. 

\begin{DoxyAuthor}{Author}
ksl,nsh 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
April 2018
\end{DoxyDate}
\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000038}{Bug}]It seems likely that this file and \hyperlink{levels_8c}{levels.\+c} should be combined into a single file. There are very comments (by nsh) about eliminating some of the modes that need investigation as well. \end{DoxyRefDesc}


\subsection{Function Documentation}
\mbox{\Hypertarget{partition_8c_a37c9b91e3450874eb15cef76079f344d}\label{partition_8c_a37c9b91e3450874eb15cef76079f344d}} 
\index{partition.\+c@{partition.\+c}!partition\+\_\+functions@{partition\+\_\+functions}}
\index{partition\+\_\+functions@{partition\+\_\+functions}!partition.\+c@{partition.\+c}}
\subsubsection{\texorpdfstring{partition\+\_\+functions()}{partition\_functions()}}
{\footnotesize\ttfamily int partition\+\_\+functions (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma A plasma cell in the wind \\
\hline
\mbox{\tt in}  & {\em int} & mode An integer which determines the way in which the partition funciton will be calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The possibilites are\+:
\begin{DoxyItemize}
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TR 0 L\+TE using t\+\_\+r
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TE 1 L\+TE using t\+\_\+e
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+M\+L93 2 M\+L93 using a nebular approximation correction to L\+TE
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+N\+L\+T\+E\+\_\+\+S\+IM 3 // Non\+\_\+\+L\+TE with SS modification (Probably could be removed)
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+L\+T\+E\+\_\+\+G\+R\+O\+U\+ND 4 // A mode which forces all levels to the GS -\/ this is used when we are modelling J\+\_\+nu.
\end{DoxyItemize}

\paragraph*{Notes}

0800802 -\/ This is a rewritten version of two routines, do\+\_\+partitions and partition. It is still true that levels is almost identical to some of the code here and therefore it is unclear why it is needed. levels is always called from partition\+\_\+functions 

Definition at line 109 of file partition.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{partition_8c_a37c9b91e3450874eb15cef76079f344d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{partition_8c_a37c9b91e3450874eb15cef76079f344d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{partition_8c_a2de3c1f3e0adc389cfda580a1003a688}\label{partition_8c_a2de3c1f3e0adc389cfda580a1003a688}} 
\index{partition.\+c@{partition.\+c}!partition\+\_\+functions\+\_\+2@{partition\+\_\+functions\+\_\+2}}
\index{partition\+\_\+functions\+\_\+2@{partition\+\_\+functions\+\_\+2}!partition.\+c@{partition.\+c}}
\subsubsection{\texorpdfstring{partition\+\_\+functions\+\_\+2()}{partition\_functions\_2()}}
{\footnotesize\ttfamily int partition\+\_\+functions\+\_\+2 (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{xnion,  }\item[{double}]{temp,  }\item[{double}]{weight }\end{DoxyParamCaption})}



calculates the partition functions for a pair of ions at a given temperature. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ the cell we are interested in. Used to communicate back \\
\hline
\mbox{\tt in}  & {\em int} & xnion The ion number for the upper ion of a pair \\
\hline
\mbox{\tt in}  & {\em double} & temp the temperature we are using for the saha equation. \\
\hline
\mbox{\tt in}  & {\em double} & weight The ratio of the intensity of the radiation field to that of a BB \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
changes the partition functions of just two ions we are currently working on
\end{DoxyReturn}
\begin{DoxyVerb}This routine is used 
to support the pairwise ioinization state calculations where 
the saha equation is applied to a pair of states at a
temperature, then corrected. Part of this is 
a requirement to get the partition functions at that 
temperature for just two states of interest. It is 
wasteful to calculate all of the states at each temperature.

The results are stored in xplasma->partition[nion]
\end{DoxyVerb}


\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000039}{Bug}]According to the historical notes, there is no need for the weight term in the calculation since this is only called when we are making the assumption that we are in L\+TE for the saha equation.\end{DoxyRefDesc}


One of the ways in which this routine differs from partition\+\_\+functions is that here the temperature and weight are passed to the routing directly instead of being taken from the Plasma structure. 

Definition at line 299 of file partition.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{partition_8c_a2de3c1f3e0adc389cfda580a1003a688_icgraph}
\end{center}
\end{figure}
