\hypertarget{bb_8c}{}\section{/\+Users/mhewitt/python/source/bb.c File Reference}
\label{bb_8c}\index{/\+Users/mhewitt/python/source/bb.\+c@{/\+Users/mhewitt/python/source/bb.\+c}}


Routines concerning the generation of photons from blackbodies.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+rng.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+randist.\+h$>$}\newline
Include dependency graph for bb.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{bb_8c_a4f42ae5d5509b18cabce35777d92f62f}{A\+L\+P\+H\+A\+M\+IN}~0.\+4
\item 
\#define \hyperlink{bb_8c_ac1547dd7dacf3a4dc5d56c8e6ff960a6}{A\+L\+P\+H\+A\+M\+AX}~30.
\item 
\#define \hyperlink{bb_8c_ab72cc0331127fe2719296673f28b440b}{A\+L\+P\+H\+A\+B\+IG}~100.
\item 
\#define \hyperlink{bb_8c_a3c01ddae06770065b909d38445f03bd8}{N\+J\+U\+M\+PS}~30
\item 
\#define \hyperlink{bb_8c_a5de5d183f9a6a8d53316f743e1ca6dc2}{N\+M\+AX}~1000
\item 
\#define \hyperlink{bb_8c_a002b2f4894492820fe708b1b7e7c5e70}{E\+P\+S\+I\+L\+ON}~1.e-\/6
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{bb_8c_a5f832b1ef434fdb41eaa62feb7edd710}{planck} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits \end{DoxyCompactList}\item 
double \hyperlink{bb_8c_a6bae7f74815dfcf783a7dafade8faeca}{get\+\_\+rand\+\_\+pow} (double \hyperlink{compton_8c_ac75b803b570527306e1e744bfb7a604f}{x1}, double x2, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em obtains a random number between x1 and x2 for a power law densiity distribution with index alpha \end{DoxyCompactList}\item 
double \hyperlink{bb_8c_af2d9c9e4094a425824f269ef22163048}{get\+\_\+rand\+\_\+exp} (double alpha\+\_\+min, double alpha\+\_\+max)
\begin{DoxyCompactList}\small\item\em obtain a random number between alpha\+\_\+min and alpha\+\_\+max from an distribution of the form e$\ast$$\ast$-\/alpha \end{DoxyCompactList}\item 
double \hyperlink{bb_8c_af5c48487242ab8760a1893e385d3e11b}{integ\+\_\+planck\+\_\+d} (double \hyperlink{bb_8c_a35106e779db1ad64f0de4eec449ec129}{alphamin}, double \hyperlink{bb_8c_af21e1955cd413e7edbe9c2a4fe822282}{alphamax})
\begin{DoxyCompactList}\small\item\em Obtains the integral of the dimensionless blackbody function between alphamin and alphamax. \end{DoxyCompactList}\item 
int \hyperlink{bb_8c_aa67b840e2ff05fc474799c42178b392e}{init\+\_\+integ\+\_\+planck\+\_\+d} ()
\begin{DoxyCompactList}\small\item\em calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in an array used by integ\+\_\+plank\+\_\+d \end{DoxyCompactList}\item 
double \hyperlink{bb_8c_ad6196c3c4ec0bdeda06aa797af259d81}{planck\+\_\+d} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em The value of the dimensioless BB function at alpha. \end{DoxyCompactList}\item 
double \hyperlink{bb_8c_a337db7e010442d30f7c4b45f3e41fa5c}{emittance\+\_\+bb} (double freqmin, double freqmax, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Calculate the emittance of a bb between freqmin and freqmax. \end{DoxyCompactList}\item 
double \hyperlink{bb_8c_a11871d7df7f3167db92bef8c8ef98926}{check\+\_\+fmax} (double fmin, double fmax, double temp)
\begin{DoxyCompactList}\small\item\em decides whether a maximum frequency requested for an integral is sensible. If it is too far off the end of the planck function, qromb will malfunction. We just have to set it to a frequency where the BB function is tiny, say where hnu/kT =100. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{bb_8c_a0d6e712e70e9d8d896e421421e5232a9}{ninit\+\_\+planck} = 0
\item 
double \hyperlink{bb_8c_ad5ae362a91b7c239184d49913e1701b1}{old\+\_\+t} = 0
\item 
double \hyperlink{bb_8c_a65f885c797f8031956517c69adcd0345}{old\+\_\+freqmin} = 0
\item 
double \hyperlink{bb_8c_a8dc32bfb2583414f49194409ba81c27c}{old\+\_\+freqmax} = 0
\item 
double \hyperlink{bb_8c_a35106e779db1ad64f0de4eec449ec129}{alphamin}
\item 
double \hyperlink{bb_8c_af21e1955cd413e7edbe9c2a4fe822282}{alphamax}
\item 
double \hyperlink{bb_8c_acddeb64d75504658a4a6e7aec61d3721}{cdf\+\_\+bb\+\_\+lo}
\item 
double \hyperlink{bb_8c_a4e1ff6ebea38be2c5723ae40379acb30}{cdf\+\_\+bb\+\_\+hi}
\item 
double \hyperlink{bb_8c_a30d9e580767e41f7671f036b54167316}{cdf\+\_\+bb\+\_\+tot}
\item 
double \hyperlink{bb_8c_ac3a0662170e08c6bbd081b1ae368c650}{cdf\+\_\+bb\+\_\+ylo}
\item 
double \hyperlink{bb_8c_a9a8f24be43c8ae7bc5328821d705fd38}{cdf\+\_\+bb\+\_\+yhi}
\item 
double \hyperlink{bb_8c_a5e666b72cd5ad44a523f8cef4c6e5f06}{lo\+\_\+freq\+\_\+alphamin}
\item 
double \hyperlink{bb_8c_a8cb2580284665f530fa828efeb72c8e2}{lo\+\_\+freq\+\_\+alphamax}
\item 
double \hyperlink{bb_8c_a481fe97a41ed0e1a21ef0f1e0952e2a2}{hi\+\_\+freq\+\_\+alphamin}
\item 
double \hyperlink{bb_8c_acf13e2e3c9727b3d93ed1e53ea81ab96}{hi\+\_\+freq\+\_\+alphamax}
\item 
double \hyperlink{bb_8c_a3308b12af5085b72eed7ec3169a707b4}{bb\+\_\+set} \mbox{[}$\,$\mbox{]}
\item 
int \hyperlink{bb_8c_a13f5d4ca91896d41ac5d4b8479198552}{error\+\_\+bb\+\_\+hi} = 0
\item 
int \hyperlink{bb_8c_a31dc4842298d34d3091c916f27f2f4aa}{error\+\_\+bb\+\_\+lo} = 0
\item 
double \hyperlink{bb_8c_a29644660e3c6b64c4f2dd0286c5c0268}{integ\+\_\+planck} \mbox{[}\hyperlink{bb_8c_a5de5d183f9a6a8d53316f743e1ca6dc2}{N\+M\+AX}+1\mbox{]}
\begin{DoxyCompactList}\small\item\em The dimensionless planck function integrated from A\+L\+P\+H\+A\+M\+IN to a range of values of alpha. \end{DoxyCompactList}\item 
int \hyperlink{bb_8c_a2cba79df974368a69fa87d2cab474c35}{i\+\_\+integ\+\_\+planck\+\_\+d} = 0
\begin{DoxyCompactList}\small\item\em A flag to say whether we have initialised integ\+\_\+planck. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines concerning the generation of photons from blackbodies. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
March, 2018
\end{DoxyDate}
\paragraph*{Notes}

The two main routines are emittance\+\_\+bb or planck. The rest of the routines are helper routines that should not normally be called directly.

The first call to either of these routines (surely emittance\+\_\+bb) results in a call to integ\+\_\+planck\+\_\+d, which in turn calls integ\+\_\+planck\+\_\+init. This initialization routine in turn populates the array integ\+\_\+planck , which contains the integral of the bb function in an array. bb\+\_\+emittance continues to access the array integ\+\_\+plank through integ\+\_\+planck\+\_\+d every future time is is called.

planck does the same thing albeit more indirectly. It sets up a cdf each time new frequency limits are placed on it. planck therefore really uses the cdf.

Both emittence\+\_\+bb and planck accept inputs in physical units, frequencies and temperatures. Internally howeve the routines convert physical to dimensionless units. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{bb_8c_ab72cc0331127fe2719296673f28b440b}\label{bb_8c_ab72cc0331127fe2719296673f28b440b}} 
\index{bb.\+c@{bb.\+c}!A\+L\+P\+H\+A\+B\+IG@{A\+L\+P\+H\+A\+B\+IG}}
\index{A\+L\+P\+H\+A\+B\+IG@{A\+L\+P\+H\+A\+B\+IG}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{A\+L\+P\+H\+A\+B\+IG}{ALPHABIG}}
{\footnotesize\ttfamily \#define A\+L\+P\+H\+A\+B\+IG~100.}



Definition at line 40 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_ac1547dd7dacf3a4dc5d56c8e6ff960a6}\label{bb_8c_ac1547dd7dacf3a4dc5d56c8e6ff960a6}} 
\index{bb.\+c@{bb.\+c}!A\+L\+P\+H\+A\+M\+AX@{A\+L\+P\+H\+A\+M\+AX}}
\index{A\+L\+P\+H\+A\+M\+AX@{A\+L\+P\+H\+A\+M\+AX}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{A\+L\+P\+H\+A\+M\+AX}{ALPHAMAX}}
{\footnotesize\ttfamily \#define A\+L\+P\+H\+A\+M\+AX~30.}



Definition at line 39 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a4f42ae5d5509b18cabce35777d92f62f}\label{bb_8c_a4f42ae5d5509b18cabce35777d92f62f}} 
\index{bb.\+c@{bb.\+c}!A\+L\+P\+H\+A\+M\+IN@{A\+L\+P\+H\+A\+M\+IN}}
\index{A\+L\+P\+H\+A\+M\+IN@{A\+L\+P\+H\+A\+M\+IN}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{A\+L\+P\+H\+A\+M\+IN}{ALPHAMIN}}
{\footnotesize\ttfamily \#define A\+L\+P\+H\+A\+M\+IN~0.\+4}



Definition at line 38 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a002b2f4894492820fe708b1b7e7c5e70}\label{bb_8c_a002b2f4894492820fe708b1b7e7c5e70}} 
\index{bb.\+c@{bb.\+c}!E\+P\+S\+I\+L\+ON@{E\+P\+S\+I\+L\+ON}}
\index{E\+P\+S\+I\+L\+ON@{E\+P\+S\+I\+L\+ON}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{E\+P\+S\+I\+L\+ON}{EPSILON}}
{\footnotesize\ttfamily \#define E\+P\+S\+I\+L\+ON~1.e-\/6}



Definition at line 511 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a3c01ddae06770065b909d38445f03bd8}\label{bb_8c_a3c01ddae06770065b909d38445f03bd8}} 
\index{bb.\+c@{bb.\+c}!N\+J\+U\+M\+PS@{N\+J\+U\+M\+PS}}
\index{N\+J\+U\+M\+PS@{N\+J\+U\+M\+PS}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{N\+J\+U\+M\+PS}{NJUMPS}}
{\footnotesize\ttfamily \#define N\+J\+U\+M\+PS~30}



Definition at line 41 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a5de5d183f9a6a8d53316f743e1ca6dc2}\label{bb_8c_a5de5d183f9a6a8d53316f743e1ca6dc2}} 
\index{bb.\+c@{bb.\+c}!N\+M\+AX@{N\+M\+AX}}
\index{N\+M\+AX@{N\+M\+AX}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{N\+M\+AX}{NMAX}}
{\footnotesize\ttfamily \#define N\+M\+AX~1000}



Definition at line 42 of file bb.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{bb_8c_a11871d7df7f3167db92bef8c8ef98926}\label{bb_8c_a11871d7df7f3167db92bef8c8ef98926}} 
\index{bb.\+c@{bb.\+c}!check\+\_\+fmax@{check\+\_\+fmax}}
\index{check\+\_\+fmax@{check\+\_\+fmax}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{check\+\_\+fmax()}{check\_fmax()}}
{\footnotesize\ttfamily double check\+\_\+fmax (\begin{DoxyParamCaption}\item[{double}]{fmin,  }\item[{double}]{fmax,  }\item[{double}]{temp }\end{DoxyParamCaption})}



decides whether a maximum frequency requested for an integral is sensible. If it is too far off the end of the planck function, qromb will malfunction. We just have to set it to a frequency where the BB function is tiny, say where hnu/kT =100. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & fmin The minimum frequency (N\+OT U\+S\+ED) \\
\hline
\mbox{\tt in}  & {\em double} & fmax The maximum frequency (N\+OT U\+S\+ED) \\
\hline
\mbox{\tt in}  & {\em double} & temp The temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A frequency which is the maximum value for which one should try to evaluate the BB function
\end{DoxyReturn}
We use alphabig to define the place in the BB spectrum where we want to give up

\paragraph*{Notes}

This is a little helper routine written by N\+SH in August 2012. We were having lots of problems with trying to integrate cross sections x a plack function at temperatures where there is no flux at fmax. This little routine just checks if fmax is going to be more than 100xt/(h/k) which will return tiny numbers for planck, and make qromb return nonsense.

The routine is called from py\+\_\+rates

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000004}{Bug}]This routine calls several variables that it does not use. It is also unclear that it is needed.\end{DoxyRefDesc}


Definition at line 632 of file bb.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=230pt]{bb_8c_a11871d7df7f3167db92bef8c8ef98926_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bb_8c_a337db7e010442d30f7c4b45f3e41fa5c}\label{bb_8c_a337db7e010442d30f7c4b45f3e41fa5c}} 
\index{bb.\+c@{bb.\+c}!emittance\+\_\+bb@{emittance\+\_\+bb}}
\index{emittance\+\_\+bb@{emittance\+\_\+bb}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{emittance\+\_\+bb()}{emittance\_bb()}}
{\footnotesize\ttfamily double emittance\+\_\+bb (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{t }\end{DoxyParamCaption})}



Calculate the emittance of a bb between freqmin and freqmax. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequency \\
\hline
\mbox{\tt in}  & {\em double} & t ??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
??? R\+E\+T\+U\+R\+NS ???
\end{DoxyReturn}
\paragraph*{Notes}

This should integrate to sigma if freqmin and freqmax go effeictively from 0 to infinity 

Definition at line 564 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_a337db7e010442d30f7c4b45f3e41fa5c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_a337db7e010442d30f7c4b45f3e41fa5c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bb_8c_af2d9c9e4094a425824f269ef22163048}\label{bb_8c_af2d9c9e4094a425824f269ef22163048}} 
\index{bb.\+c@{bb.\+c}!get\+\_\+rand\+\_\+exp@{get\+\_\+rand\+\_\+exp}}
\index{get\+\_\+rand\+\_\+exp@{get\+\_\+rand\+\_\+exp}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+rand\+\_\+exp()}{get\_rand\_exp()}}
{\footnotesize\ttfamily double get\+\_\+rand\+\_\+exp (\begin{DoxyParamCaption}\item[{double}]{alpha\+\_\+min,  }\item[{double}]{alpha\+\_\+max }\end{DoxyParamCaption})}



obtain a random number between alpha\+\_\+min and alpha\+\_\+max from an distribution of the form e$\ast$$\ast$-\/alpha 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha\+\_\+min The lower limit for the random number \\
\hline
\mbox{\tt in}  & {\em double} & alpha\+\_\+max The upper limit for the random number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A double precision random number
\end{DoxyReturn}
\paragraph*{Notes}

The cdf for an exponential distribution can be easily shown to be given by solving this equation for alpha

r$\ast$(exp(-\/alpha\+\_\+min)-\/exp(-\/alpha\+\_\+max))=(exp(-\/alpha\+\_\+min)-\/exp(alpha))

but you can recast this and solve for delta\+\_\+alpha

exp(-\/delta\+\_\+alpha)=(1-\/R)+\+R$\ast$exp(-\/(alpha\+\_\+max-\/alpha\+\_\+min))

This has the advantage that it depends only on the difference of alpha\+\_\+max and alpha\+\_\+min and not their actual values, and as long as the exp of a very large number turns out to be zero and not not a number, it shuld not generate N\+A\+Ns 

Definition at line 327 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_af2d9c9e4094a425824f269ef22163048_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_af2d9c9e4094a425824f269ef22163048_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bb_8c_a6bae7f74815dfcf783a7dafade8faeca}\label{bb_8c_a6bae7f74815dfcf783a7dafade8faeca}} 
\index{bb.\+c@{bb.\+c}!get\+\_\+rand\+\_\+pow@{get\+\_\+rand\+\_\+pow}}
\index{get\+\_\+rand\+\_\+pow@{get\+\_\+rand\+\_\+pow}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+rand\+\_\+pow()}{get\_rand\_pow()}}
{\footnotesize\ttfamily double get\+\_\+rand\+\_\+pow (\begin{DoxyParamCaption}\item[{double}]{x1,  }\item[{double}]{x2,  }\item[{double}]{alpha }\end{DoxyParamCaption})}



obtains a random number between x1 and x2 for a power law densiity distribution with index alpha 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & x1 the minimum allowed value to return \\
\hline
\mbox{\tt in,out}  & {\em double} & x2 the maximum allowed value to return \\
\hline
\mbox{\tt in,out}  & {\em double} & alpha the index of the power law \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A single value taken from a power law distribution
\end{DoxyReturn}
\paragraph*{Notes}

It is straight fowrward to integrate a power law in closed form and given this it one can easily find the value of the upper limit to the definite integral that is a given fraction of the total interval

The case with alpha==1 is a special case, but this is also easy to integrate. 

Definition at line 267 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{bb_8c_a6bae7f74815dfcf783a7dafade8faeca_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_a6bae7f74815dfcf783a7dafade8faeca_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bb_8c_aa67b840e2ff05fc474799c42178b392e}\label{bb_8c_aa67b840e2ff05fc474799c42178b392e}} 
\index{bb.\+c@{bb.\+c}!init\+\_\+integ\+\_\+planck\+\_\+d@{init\+\_\+integ\+\_\+planck\+\_\+d}}
\index{init\+\_\+integ\+\_\+planck\+\_\+d@{init\+\_\+integ\+\_\+planck\+\_\+d}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+integ\+\_\+planck\+\_\+d()}{init\_integ\_planck\_d()}}
{\footnotesize\ttfamily int init\+\_\+integ\+\_\+planck\+\_\+d (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in an array used by integ\+\_\+plank\+\_\+d 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a helper routine which is only called once from integ\+\_\+planck in order to initialize the array integ\+\_\+planck.

It calculates the integral of the dimensionless bb function between 0 and alpha for a series of alpha values values between A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX.

\paragraph*{Notes}

A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX are hardcoded which are hardcorded.

The actual integration is done with the numerical recipes routine \char`\"{}qromb\char`\"{} 

Definition at line 495 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{bb_8c_aa67b840e2ff05fc474799c42178b392e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_aa67b840e2ff05fc474799c42178b392e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bb_8c_af5c48487242ab8760a1893e385d3e11b}\label{bb_8c_af5c48487242ab8760a1893e385d3e11b}} 
\index{bb.\+c@{bb.\+c}!integ\+\_\+planck\+\_\+d@{integ\+\_\+planck\+\_\+d}}
\index{integ\+\_\+planck\+\_\+d@{integ\+\_\+planck\+\_\+d}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{integ\+\_\+planck\+\_\+d()}{integ\_planck\_d()}}
{\footnotesize\ttfamily double integ\+\_\+planck\+\_\+d (\begin{DoxyParamCaption}\item[{double}]{alphamin,  }\item[{double}]{alphamax }\end{DoxyParamCaption})}



Obtains the integral of the dimensionless blackbody function between alphamin and alphamax. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alphamin The minimum value of alpha (h nu/ kT) considered \\
\hline
\mbox{\tt in}  & {\em double} & alphamax The maximum value of alpha to be considered \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the integral
\end{DoxyReturn}
To save computing time, the routine actually accesses an array that contains the the integral of the bb function from 0 to alpha for a number of values of alpha. By differencing (and intepolating) this array for the element corrsponding to alphamax and alphamin, the routine returns the integral between alphamax and alphamin

\paragraph*{Notes}

The first time the function is called the integ\+\_\+planck\mbox{[}\mbox{]} is filled.

integ\+\_\+plank\mbox{[}n\mbox{]} contains the integral of the dimensionless planck function from A\+L\+P\+H\+A\+M\+IN to A\+L\+P\+H\+A\+M\+AX. Therefore if one wants to obtain the integral of the dimensionless bb function, one simply interpolates this array. 

Definition at line 391 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_af5c48487242ab8760a1893e385d3e11b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_af5c48487242ab8760a1893e385d3e11b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bb_8c_a5f832b1ef434fdb41eaa62feb7edd710}\label{bb_8c_a5f832b1ef434fdb41eaa62feb7edd710}} 
\index{bb.\+c@{bb.\+c}!planck@{planck}}
\index{planck@{planck}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{planck()}{planck()}}
{\footnotesize\ttfamily double planck (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperature of the bb \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency for the photon \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequency for the photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The frequency drawn randomly from a BB function with temperature T
\end{DoxyReturn}
The frequency is pseudo random in the following limited sense. The photons are returned are weighted so that the energy distribution of a function is approximately reproduced. Within an energy bin the photon frequency is uniform.

\paragraph*{Notes}

The first time one enters the program, a cdf for a diminensionless BB function is createda. The cdf is created for values between A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX where A\+L\+P\+HA=h nu/kT. The number of points in the cdf is determined by N\+M\+AX

On subseqent entries, when the temperature or frequency limits are changed, we use standard routines to limit what portion of the dimensionless cdf to use.

If the freuency range and temperature for a photon falls outside of A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX special routines are used to sample the distribution there. so that the spectrum falls off as a power law at low frequencies and an exponential at high frequencies. 

Definition at line 109 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_a5f832b1ef434fdb41eaa62feb7edd710_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_a5f832b1ef434fdb41eaa62feb7edd710_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bb_8c_ad6196c3c4ec0bdeda06aa797af259d81}\label{bb_8c_ad6196c3c4ec0bdeda06aa797af259d81}} 
\index{bb.\+c@{bb.\+c}!planck\+\_\+d@{planck\+\_\+d}}
\index{planck\+\_\+d@{planck\+\_\+d}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{planck\+\_\+d()}{planck\_d()}}
{\footnotesize\ttfamily double planck\+\_\+d (\begin{DoxyParamCaption}\item[{double}]{alpha }\end{DoxyParamCaption})}



The value of the dimensioless BB function at alpha. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the dimensionless BB function at x
\end{DoxyReturn}
The BB emittence is given by

F\+\_\+nu= 2$\ast$\+P\+I$\ast$ (k\+T/h$\ast$$\ast$3)$\ast$planck\+\_\+d(h$\ast$freq/ k T)

alpha is simply h nu/kT

\paragraph*{Notes}

Definition at line 534 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=198pt]{bb_8c_ad6196c3c4ec0bdeda06aa797af259d81_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bb_8c_ad6196c3c4ec0bdeda06aa797af259d81_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{bb_8c_af21e1955cd413e7edbe9c2a4fe822282}\label{bb_8c_af21e1955cd413e7edbe9c2a4fe822282}} 
\index{bb.\+c@{bb.\+c}!alphamax@{alphamax}}
\index{alphamax@{alphamax}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{alphamax}{alphamax}}
{\footnotesize\ttfamily double alphamax}



Definition at line 49 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a35106e779db1ad64f0de4eec449ec129}\label{bb_8c_a35106e779db1ad64f0de4eec449ec129}} 
\index{bb.\+c@{bb.\+c}!alphamin@{alphamin}}
\index{alphamin@{alphamin}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{alphamin}{alphamin}}
{\footnotesize\ttfamily double alphamin}



Definition at line 49 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a3308b12af5085b72eed7ec3169a707b4}\label{bb_8c_a3308b12af5085b72eed7ec3169a707b4}} 
\index{bb.\+c@{bb.\+c}!bb\+\_\+set@{bb\+\_\+set}}
\index{bb\+\_\+set@{bb\+\_\+set}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{bb\+\_\+set}{bb\_set}}
{\footnotesize\ttfamily double bb\+\_\+set\mbox{[}$\,$\mbox{]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{

  10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0,
  19., 20., 21., 22., 23., 24., 25., 26., 27., 28., 29.
\}
\end{DoxyCode}
Array that cdf\+\_\+gen\+\_\+from\+\_\+func uses to establish the specific points in the cdf of the dimensionless bb function.

These are what we call \textquotesingle{}jumps\textquotesingle{} and are used by cdf\+\_\+gen\+\_\+from\+\_\+func to ensure important parts of the C\+DF have points 

Definition at line 62 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a4e1ff6ebea38be2c5723ae40379acb30}\label{bb_8c_a4e1ff6ebea38be2c5723ae40379acb30}} 
\index{bb.\+c@{bb.\+c}!cdf\+\_\+bb\+\_\+hi@{cdf\+\_\+bb\+\_\+hi}}
\index{cdf\+\_\+bb\+\_\+hi@{cdf\+\_\+bb\+\_\+hi}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+bb\+\_\+hi}{cdf\_bb\_hi}}
{\footnotesize\ttfamily double cdf\+\_\+bb\+\_\+hi}



Definition at line 50 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_acddeb64d75504658a4a6e7aec61d3721}\label{bb_8c_acddeb64d75504658a4a6e7aec61d3721}} 
\index{bb.\+c@{bb.\+c}!cdf\+\_\+bb\+\_\+lo@{cdf\+\_\+bb\+\_\+lo}}
\index{cdf\+\_\+bb\+\_\+lo@{cdf\+\_\+bb\+\_\+lo}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+bb\+\_\+lo}{cdf\_bb\_lo}}
{\footnotesize\ttfamily double cdf\+\_\+bb\+\_\+lo}



Definition at line 50 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a30d9e580767e41f7671f036b54167316}\label{bb_8c_a30d9e580767e41f7671f036b54167316}} 
\index{bb.\+c@{bb.\+c}!cdf\+\_\+bb\+\_\+tot@{cdf\+\_\+bb\+\_\+tot}}
\index{cdf\+\_\+bb\+\_\+tot@{cdf\+\_\+bb\+\_\+tot}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+bb\+\_\+tot}{cdf\_bb\_tot}}
{\footnotesize\ttfamily double cdf\+\_\+bb\+\_\+tot}



Definition at line 50 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a9a8f24be43c8ae7bc5328821d705fd38}\label{bb_8c_a9a8f24be43c8ae7bc5328821d705fd38}} 
\index{bb.\+c@{bb.\+c}!cdf\+\_\+bb\+\_\+yhi@{cdf\+\_\+bb\+\_\+yhi}}
\index{cdf\+\_\+bb\+\_\+yhi@{cdf\+\_\+bb\+\_\+yhi}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+bb\+\_\+yhi}{cdf\_bb\_yhi}}
{\footnotesize\ttfamily double cdf\+\_\+bb\+\_\+yhi}



Definition at line 51 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_ac3a0662170e08c6bbd081b1ae368c650}\label{bb_8c_ac3a0662170e08c6bbd081b1ae368c650}} 
\index{bb.\+c@{bb.\+c}!cdf\+\_\+bb\+\_\+ylo@{cdf\+\_\+bb\+\_\+ylo}}
\index{cdf\+\_\+bb\+\_\+ylo@{cdf\+\_\+bb\+\_\+ylo}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{cdf\+\_\+bb\+\_\+ylo}{cdf\_bb\_ylo}}
{\footnotesize\ttfamily double cdf\+\_\+bb\+\_\+ylo}



Definition at line 51 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a13f5d4ca91896d41ac5d4b8479198552}\label{bb_8c_a13f5d4ca91896d41ac5d4b8479198552}} 
\index{bb.\+c@{bb.\+c}!error\+\_\+bb\+\_\+hi@{error\+\_\+bb\+\_\+hi}}
\index{error\+\_\+bb\+\_\+hi@{error\+\_\+bb\+\_\+hi}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{error\+\_\+bb\+\_\+hi}{error\_bb\_hi}}
{\footnotesize\ttfamily int error\+\_\+bb\+\_\+hi = 0}



Definition at line 69 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a31dc4842298d34d3091c916f27f2f4aa}\label{bb_8c_a31dc4842298d34d3091c916f27f2f4aa}} 
\index{bb.\+c@{bb.\+c}!error\+\_\+bb\+\_\+lo@{error\+\_\+bb\+\_\+lo}}
\index{error\+\_\+bb\+\_\+lo@{error\+\_\+bb\+\_\+lo}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{error\+\_\+bb\+\_\+lo}{error\_bb\_lo}}
{\footnotesize\ttfamily int error\+\_\+bb\+\_\+lo = 0}



Definition at line 70 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_acf13e2e3c9727b3d93ed1e53ea81ab96}\label{bb_8c_acf13e2e3c9727b3d93ed1e53ea81ab96}} 
\index{bb.\+c@{bb.\+c}!hi\+\_\+freq\+\_\+alphamax@{hi\+\_\+freq\+\_\+alphamax}}
\index{hi\+\_\+freq\+\_\+alphamax@{hi\+\_\+freq\+\_\+alphamax}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{hi\+\_\+freq\+\_\+alphamax}{hi\_freq\_alphamax}}
{\footnotesize\ttfamily double hi\+\_\+freq\+\_\+alphamax}



Definition at line 52 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a481fe97a41ed0e1a21ef0f1e0952e2a2}\label{bb_8c_a481fe97a41ed0e1a21ef0f1e0952e2a2}} 
\index{bb.\+c@{bb.\+c}!hi\+\_\+freq\+\_\+alphamin@{hi\+\_\+freq\+\_\+alphamin}}
\index{hi\+\_\+freq\+\_\+alphamin@{hi\+\_\+freq\+\_\+alphamin}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{hi\+\_\+freq\+\_\+alphamin}{hi\_freq\_alphamin}}
{\footnotesize\ttfamily double hi\+\_\+freq\+\_\+alphamin}



Definition at line 52 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a2cba79df974368a69fa87d2cab474c35}\label{bb_8c_a2cba79df974368a69fa87d2cab474c35}} 
\index{bb.\+c@{bb.\+c}!i\+\_\+integ\+\_\+planck\+\_\+d@{i\+\_\+integ\+\_\+planck\+\_\+d}}
\index{i\+\_\+integ\+\_\+planck\+\_\+d@{i\+\_\+integ\+\_\+planck\+\_\+d}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{i\+\_\+integ\+\_\+planck\+\_\+d}{i\_integ\_planck\_d}}
{\footnotesize\ttfamily int i\+\_\+integ\+\_\+planck\+\_\+d = 0}



A flag to say whether we have initialised integ\+\_\+planck. 



Definition at line 357 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a29644660e3c6b64c4f2dd0286c5c0268}\label{bb_8c_a29644660e3c6b64c4f2dd0286c5c0268}} 
\index{bb.\+c@{bb.\+c}!integ\+\_\+planck@{integ\+\_\+planck}}
\index{integ\+\_\+planck@{integ\+\_\+planck}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{integ\+\_\+planck}{integ\_planck}}
{\footnotesize\ttfamily double integ\+\_\+planck\mbox{[}\hyperlink{bb_8c_a5de5d183f9a6a8d53316f743e1ca6dc2}{N\+M\+AX}+1\mbox{]}}



The dimensionless planck function integrated from A\+L\+P\+H\+A\+M\+IN to a range of values of alpha. 



Definition at line 354 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a8cb2580284665f530fa828efeb72c8e2}\label{bb_8c_a8cb2580284665f530fa828efeb72c8e2}} 
\index{bb.\+c@{bb.\+c}!lo\+\_\+freq\+\_\+alphamax@{lo\+\_\+freq\+\_\+alphamax}}
\index{lo\+\_\+freq\+\_\+alphamax@{lo\+\_\+freq\+\_\+alphamax}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{lo\+\_\+freq\+\_\+alphamax}{lo\_freq\_alphamax}}
{\footnotesize\ttfamily double lo\+\_\+freq\+\_\+alphamax}



Definition at line 52 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a5e666b72cd5ad44a523f8cef4c6e5f06}\label{bb_8c_a5e666b72cd5ad44a523f8cef4c6e5f06}} 
\index{bb.\+c@{bb.\+c}!lo\+\_\+freq\+\_\+alphamin@{lo\+\_\+freq\+\_\+alphamin}}
\index{lo\+\_\+freq\+\_\+alphamin@{lo\+\_\+freq\+\_\+alphamin}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{lo\+\_\+freq\+\_\+alphamin}{lo\_freq\_alphamin}}
{\footnotesize\ttfamily double lo\+\_\+freq\+\_\+alphamin}



Definition at line 52 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a0d6e712e70e9d8d896e421421e5232a9}\label{bb_8c_a0d6e712e70e9d8d896e421421e5232a9}} 
\index{bb.\+c@{bb.\+c}!ninit\+\_\+planck@{ninit\+\_\+planck}}
\index{ninit\+\_\+planck@{ninit\+\_\+planck}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{ninit\+\_\+planck}{ninit\_planck}}
{\footnotesize\ttfamily int ninit\+\_\+planck = 0}



Definition at line 44 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a8dc32bfb2583414f49194409ba81c27c}\label{bb_8c_a8dc32bfb2583414f49194409ba81c27c}} 
\index{bb.\+c@{bb.\+c}!old\+\_\+freqmax@{old\+\_\+freqmax}}
\index{old\+\_\+freqmax@{old\+\_\+freqmax}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{old\+\_\+freqmax}{old\_freqmax}}
{\footnotesize\ttfamily double old\+\_\+freqmax = 0}



Definition at line 48 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_a65f885c797f8031956517c69adcd0345}\label{bb_8c_a65f885c797f8031956517c69adcd0345}} 
\index{bb.\+c@{bb.\+c}!old\+\_\+freqmin@{old\+\_\+freqmin}}
\index{old\+\_\+freqmin@{old\+\_\+freqmin}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{old\+\_\+freqmin}{old\_freqmin}}
{\footnotesize\ttfamily double old\+\_\+freqmin = 0}



Definition at line 47 of file bb.\+c.

\mbox{\Hypertarget{bb_8c_ad5ae362a91b7c239184d49913e1701b1}\label{bb_8c_ad5ae362a91b7c239184d49913e1701b1}} 
\index{bb.\+c@{bb.\+c}!old\+\_\+t@{old\+\_\+t}}
\index{old\+\_\+t@{old\+\_\+t}!bb.\+c@{bb.\+c}}
\subsubsection{\texorpdfstring{old\+\_\+t}{old\_t}}
{\footnotesize\ttfamily double old\+\_\+t = 0}



Definition at line 46 of file bb.\+c.

