\hypertarget{ionization_8c}{}\section{/\+Users/mhewitt/python/source/ionization.c File Reference}
\label{ionization_8c}\index{/\+Users/mhewitt/python/source/ionization.\+c@{/\+Users/mhewitt/python/source/ionization.\+c}}


Routines used to calculate and update ion densities.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for ionization.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ionization_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ionization_8c_a626b1882e2533441cdf2daabd36e8a8b}{ion\+\_\+abundances} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em ionization routines for the wind one cell at a time \end{DoxyCompactList}\item 
int \hyperlink{ionization_8c_ab729c5f4ef31135996b77fb1add8df2c}{convergence} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em checks to see whether a single cell is or is not converging \end{DoxyCompactList}\item 
int \hyperlink{ionization_8c_a7b0fefc2866b126097193b3bece2cff7}{check\+\_\+convergence} ()
\begin{DoxyCompactList}\small\item\em The routien summarizes the how well the wind converging to a solution as a whole. \end{DoxyCompactList}\item 
int \hyperlink{ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8}{one\+\_\+shot} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em calculates new densities of ions in a single element of the wind after (usually) having found the temperature which matches heating and cooling for the previous densities \end{DoxyCompactList}\item 
double \hyperlink{ionization_8c_a09cddd089f4a6cc83c34606d125c28a4}{calc\+\_\+te} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double tmin, double tmax)
\begin{DoxyCompactList}\small\item\em calc\+\_\+te determines and returns the electron temperature in the wind such that the energy emitted by the wind is equal to energy emitted (asssuming it is in the interval bracketed by tmin and tmax.) \end{DoxyCompactList}\item 
double \hyperlink{ionization_8c_a866bab53f422c2afa889e5e549df76d1}{zero\+\_\+emit} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell in the previous ionization cycle. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{ionization_8c_a4894abff5157e9a38f8dd34d0d0c2b4a}{xxxplasma}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines used to calculate and update ion densities. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May, 2018 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{ionization_8c_a09cddd089f4a6cc83c34606d125c28a4}\label{ionization_8c_a09cddd089f4a6cc83c34606d125c28a4}} 
\index{ionization.\+c@{ionization.\+c}!calc\+\_\+te@{calc\+\_\+te}}
\index{calc\+\_\+te@{calc\+\_\+te}!ionization.\+c@{ionization.\+c}}
\subsubsection{\texorpdfstring{calc\+\_\+te()}{calc\_te()}}
{\footnotesize\ttfamily double calc\+\_\+te (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{tmin,  }\item[{double}]{tmax }\end{DoxyParamCaption})}



calc\+\_\+te determines and returns the electron temperature in the wind such that the energy emitted by the wind is equal to energy emitted (asssuming it is in the interval bracketed by tmin and tmax.) 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Plasma\+Ptr xplasma A plasma cell in the wind \\
\hline
{\em \mbox{[}in} & out\mbox{]} double tmin A bracketing minimum temperature \\
\hline
{\em \mbox{[}in} & out\mbox{]} double tmax A bracketing mxximum temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The temperature where heating and cooling match
\end{DoxyReturn}
The routine iterates to find the temperature in a cell, where heating and cooling are matched.

calc\+\_\+te does not modify any abundances. It simply takes the current value of the heating in the cell and attempts to find the value of the electron temperature which will result in cooling which matches the heating.

\paragraph*{Notes}

Ion densities are N\+OT updated in this process.

xxxplasma is just a way to tranmit information to zero\+\_\+emit 

Definition at line 471 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{ionization_8c_a09cddd089f4a6cc83c34606d125c28a4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ionization_8c_a7b0fefc2866b126097193b3bece2cff7}\label{ionization_8c_a7b0fefc2866b126097193b3bece2cff7}} 
\index{ionization.\+c@{ionization.\+c}!check\+\_\+convergence@{check\+\_\+convergence}}
\index{check\+\_\+convergence@{check\+\_\+convergence}!ionization.\+c@{ionization.\+c}}
\subsubsection{\texorpdfstring{check\+\_\+convergence()}{check\_convergence()}}
{\footnotesize\ttfamily int check\+\_\+convergence (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



The routien summarizes the how well the wind converging to a solution as a whole. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Basically the routine just looks at the numbers of cells which haave passed/failed the various convergence tests and writes this to the log file

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000032}{Bug}]It would make sense to write this information to a separate file so that plots of the rate of convergence could be easily made.\end{DoxyRefDesc}


Definition at line 278 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=327pt]{ionization_8c_a7b0fefc2866b126097193b3bece2cff7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ionization_8c_ab729c5f4ef31135996b77fb1add8df2c}\label{ionization_8c_ab729c5f4ef31135996b77fb1add8df2c}} 
\index{ionization.\+c@{ionization.\+c}!convergence@{convergence}}
\index{convergence@{convergence}!ionization.\+c@{ionization.\+c}}
\subsubsection{\texorpdfstring{convergence()}{convergence()}}
{\footnotesize\ttfamily int convergence (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



checks to see whether a single cell is or is not converging 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Plasma\+Ptr xplasma The cell of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A number which describes the degree to which the cell is converging
\end{DoxyReturn}
The routine attempts to determine whether a cell is on the track to a final solution by checking whether the electron and radiation temperatures are getting smaller with cycle and whetehr the difference between heating and cooling is drroping.

The routine returns a number between 0 and 3, depending on the number of convergence checks that are passed. If all convergence tests are pssed then the number returned will be 0

The routine also adjust the gain which controls how far the electron temperture can change in a cycle.

\paragraph*{Notes}

Definition at line 184 of file ionization.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{ionization_8c_ab729c5f4ef31135996b77fb1add8df2c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ionization_8c_a626b1882e2533441cdf2daabd36e8a8b}\label{ionization_8c_a626b1882e2533441cdf2daabd36e8a8b}} 
\index{ionization.\+c@{ionization.\+c}!ion\+\_\+abundances@{ion\+\_\+abundances}}
\index{ion\+\_\+abundances@{ion\+\_\+abundances}!ionization.\+c@{ionization.\+c}}
\subsubsection{\texorpdfstring{ion\+\_\+abundances()}{ion\_abundances()}}
{\footnotesize\ttfamily int ion\+\_\+abundances (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



ionization routines for the wind one cell at a time 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The cell in which the ioniztion is to be calculated \\
\hline
\mbox{\tt in}  & {\em int} & mode A parameter descibing how to calculate the ioniztion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine returns status messages dereived from the individual routines used to calculate the abundances.
\end{DoxyReturn}
The intent is that the routine ion\+\_\+abundances is the steering routine for all calculations of the abundances

\paragraph*{Notes}

Definition at line 39 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{ionization_8c_a626b1882e2533441cdf2daabd36e8a8b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8}\label{ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8}} 
\index{ionization.\+c@{ionization.\+c}!one\+\_\+shot@{one\+\_\+shot}}
\index{one\+\_\+shot@{one\+\_\+shot}!ionization.\+c@{ionization.\+c}}
\subsubsection{\texorpdfstring{one\+\_\+shot()}{one\_shot()}}
{\footnotesize\ttfamily int one\+\_\+shot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates new densities of ions in a single element of the wind after (usually) having found the temperature which matches heating and cooling for the previous densities 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The plasma cell of interest \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch describing what approximation to use in determinging the densities \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine attempts to match heating and cooling in the wind element! To do this it calls calc\+\_\+te. Based on the returned value of te, the routine then calculates densities for various ions in the cell. The densities in xplasma are updated.

\paragraph*{Notes}

Special exceptions are made for Zeus; it is not clear why this is necessary

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000033}{Bug}]There are some numbered switches included here. This is because these values are not allowed anymore. But this needs to be cleaned up. Deactivated modes should be captured when the parameters are read in, not at this point. An else statement should provide a sufficent check for any unknown mode.\end{DoxyRefDesc}


Definition at line 358 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{ionization_8c_a0c0fa3305df1f5c000e0ed0a26d413d8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ionization_8c_a866bab53f422c2afa889e5e549df76d1}\label{ionization_8c_a866bab53f422c2afa889e5e549df76d1}} 
\index{ionization.\+c@{ionization.\+c}!zero\+\_\+emit@{zero\+\_\+emit}}
\index{zero\+\_\+emit@{zero\+\_\+emit}!ionization.\+c@{ionization.\+c}}
\subsubsection{\texorpdfstring{zero\+\_\+emit()}{zero\_emit()}}
{\footnotesize\ttfamily double zero\+\_\+emit (\begin{DoxyParamCaption}\item[{double}]{t }\end{DoxyParamCaption})}



Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell in the previous ionization cycle. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t A trial temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The difference between the recorded heating and the cooling
\end{DoxyReturn}
This routine is used to estiamate a new temperature for a cell given the heating of the cell in the previous ionization cycle.

\paragraph*{Notes}

The abundances of ions in the cell are not modified. Results are stored in the cell of interest. This routine is used in connection with a zero finding routine 

Definition at line 557 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ionization_8c_a866bab53f422c2afa889e5e549df76d1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ionization_8c_a866bab53f422c2afa889e5e549df76d1_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{ionization_8c_a4894abff5157e9a38f8dd34d0d0c2b4a}\label{ionization_8c_a4894abff5157e9a38f8dd34d0d0c2b4a}} 
\index{ionization.\+c@{ionization.\+c}!xxxplasma@{xxxplasma}}
\index{xxxplasma@{xxxplasma}!ionization.\+c@{ionization.\+c}}
\subsubsection{\texorpdfstring{xxxplasma}{xxxplasma}}
{\footnotesize\ttfamily \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} xxxplasma}



Definition at line 324 of file ionization.\+c.

