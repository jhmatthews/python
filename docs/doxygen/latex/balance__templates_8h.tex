\hypertarget{balance__templates_8h}{}\section{/\+Users/mhewitt/python/source/balance\+\_\+templates.h File Reference}
\label{balance__templates_8h}\index{/\+Users/mhewitt/python/source/balance\+\_\+templates.\+h@{/\+Users/mhewitt/python/source/balance\+\_\+templates.\+h}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{balance__templates_8h_aaea56e4177bd14c0ad6d55c81d2504fe}{absolute\+\_\+saha} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} www, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double nh, double t\+\_\+r, double t\+\_\+e, double weight, int freq\+\_\+sampling)
\item 
double \hyperlink{balance__templates_8h_aab782f10945f43b64502aa2670ed55b7}{absolute\+\_\+total\+\_\+emission} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e, double f1, double f2)
\item 
double \hyperlink{balance__templates_8h_acaacc7878589d1387a33ace5eed06b59}{absolute\+\_\+total\+\_\+line\+\_\+emission} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} ww, double t\+\_\+e, double f1, double f2)
\item 
double \hyperlink{balance__templates_8h_adf94ba064c06da9ef29d91b1ce2eb8f2}{absolute\+\_\+line\+\_\+heating} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds)
\item 
double \hyperlink{balance__templates_8h_a7b5184477c806f535b3e59232205158e}{absolute\+\_\+line\+\_\+nsigma} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} w)
\item 
double \hyperlink{balance__templates_8h_afabb511243ff444fcd3b968d96650181}{absolute\+\_\+two\+\_\+level\+\_\+atom} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} www, double $\ast$d1, double $\ast$d2)
\item 
double \hyperlink{balance__templates_8h_a8bf694158a4386b3c360a3ba7518fd45}{fb\+\_\+cooling} (double t\+\_\+e, double f1, double f2, double $\ast$fb\+\_\+h, double $\ast$fb\+\_\+he1, double $\ast$fb\+\_\+he2)
\item 
double \hyperlink{balance__templates_8h_aec7b0f63aeb85f00e64bc2e4ccc29033}{fb\+\_\+cooling\+\_\+d} (double f)
\item 
int \hyperlink{balance__templates_8h_a2cdbde0efa1209e5e416c10c54ed7e8d}{xbb} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double weight, double f1, double f2, int freq\+\_\+sampling)
\item 
int \hyperlink{balance__templates_8h_a571b75143e5686426dbc0d5ef4bf58a3}{xmake\+\_\+bb} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double t\+\_\+r, double freqmin, double freqmax, double weight, int iphot\+\_\+start, int nphot)
\item 
int \hyperlink{balance__templates_8h_a0ddf1224851353fc92bfbff6f499fa97}{main} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{balance__templates_8h_aa362e9608342d17798849cf026e41a5e}{multicycle} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} www, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int mode, int freq\+\_\+sampling, int radmode)
\item 
int \hyperlink{balance__templates_8h_a16695e51479862629c3204586710a9da}{print\+\_\+levels} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} w)
\item 
int \hyperlink{balance__templates_8h_a5831d70a8e5c02008db6aa5f49cc9ea5}{multi\+\_\+concen} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} www)
\item 
int \hyperlink{balance__templates_8h_a8c6c750e78c6ac8947df45545e328f79}{check\+\_\+field} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} one)
\item 
int \hyperlink{balance__templates_8h_a6e2a1d42f6b6711b81d28868b9e834f9}{do\+\_\+detail} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} one)
\item 
int \hyperlink{balance__templates_8h_a33a5fe351d8c1dcf015fc2cf00b9da5c}{summary} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} one)
\item 
double \hyperlink{balance__templates_8h_a4c2ef9cf62764a5a4da8758813c79e0d}{line\+\_\+heating} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds)
\item 
double \hyperlink{balance__templates_8h_a9da84c571671cfa8523ab5d3aed6c6e5}{sobolev\+\_\+line\+\_\+heating} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds)
\item 
int \hyperlink{balance__templates_8h_ab34d13ef098af692d1a406016724580a}{xsaha} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double nh, double t\+\_\+r, double t\+\_\+e, double weight, int ioniz\+\_\+mode, int freq\+\_\+sampling)
\item 
int \hyperlink{balance__templates_8h_a1b84aa5f9c633207462d3907cb95ea0d}{cycle} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double nh, double t\+\_\+r, double t\+\_\+e, double weight, int mode, int freq\+\_\+sampling, int radmode)
\item 
int \hyperlink{balance__templates_8h_ab262a3874348edde02451c9375f959d4}{dumb\+\_\+step} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double $\ast$te)
\item 
int \hyperlink{balance__templates_8h_af5c48ea866d13aa6edd542c4dc6b1f90}{find\+\_\+te} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one)
\item 
int \hyperlink{balance__templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8}{translate} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, double tau\+\_\+scat, double $\ast$tau, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em a steering routine that either calls \+\_\+in\+\_\+space or \+\_\+in\+\_\+wind depending upon the current location of the photon. \end{DoxyCompactList}\item 
int \hyperlink{balance__templates_8h_aa1ffd17034054d51819328d892fc57e8}{translate\+\_\+in\+\_\+space} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em translates the photon from its current position to the edge of the wind. \end{DoxyCompactList}\item 
double \hyperlink{balance__templates_8h_a3c809c8bf25573271a29ddb1d925d090}{ds\+\_\+to\+\_\+wind} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\item 
int \hyperlink{balance__templates_8h_a0118547dede9b08b5ac6609b4313e3e8}{translate\+\_\+in\+\_\+wind} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double tau\+\_\+scat, double $\ast$tau, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em translates the photon within a single cell in the wind. \end{DoxyCompactList}\item 
int \hyperlink{balance__templates_8h_a56740476af61734dee90b4090f004971}{walls} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pold)
\item 
int \hyperlink{balance__templates_8h_a620388e1c4a8e38f192c5a0ce42af389}{trans\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int iextract)
\begin{DoxyCompactList}\small\item\em int (w,p,iextract) oversees the propagation of a \char`\"{}flight\char`\"{} of photons \end{DoxyCompactList}\item 
int \hyperlink{balance__templates_8h_aaa16d99441c764597ca593780e74f134}{pl\+\_\+wind\+\_\+define} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\item 
double \hyperlink{balance__templates_8h_a6f6a9a8730c8d1fa98e71a19b4121061}{pl\+\_\+rho} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{balance__templates_8h_a0f7abdb5c54e097dce91c47669672ca7}{pl\+\_\+velocity} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{balance__templates_8h_a3b78924c6f60b99b920be396592d3dfe}{define\+\_\+wind\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, double xmin, double xmax, double zmin, double zmax)
\item 
int \hyperlink{balance__templates_8h_a737bba69d6237e8d171f633c2c6d4cbf}{pl\+\_\+copy\+\_\+conditions} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} win, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} wout)
\item 
int \hyperlink{balance__templates_8h_a37c9b91e3450874eb15cef76079f344d}{partition\+\_\+functions} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations \end{DoxyCompactList}\item 
double \hyperlink{balance__templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c}{agn\+\_\+init} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, double lum, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double freqmin, double freqmax, int ioniz\+\_\+or\+\_\+final, double $\ast$f)
\begin{DoxyCompactList}\small\item\em Calculates the total luminosity of an A\+GN type source. \end{DoxyCompactList}\item 
double \hyperlink{balance__templates_8h_a647aa352bc1435e0ef14ca7901009cf6}{emittance\+\_\+pow} (double freqmin, double freqmax, double lum, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\item 
int \hyperlink{balance__templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10}{photo\+\_\+gen\+\_\+agn} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double weight, double f1, double f2, int spectype, int istart, int nphot)
\begin{DoxyCompactList}\small\item\em Generate a photon from an A\+GN object. \end{DoxyCompactList}\item 
int \hyperlink{balance__templates_8h_a371914de0935dbdb2eec59da595cd6d4}{sim\+\_\+driver} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\item 
int \hyperlink{balance__templates_8h_ad9ef6b5303be6721d0d71fef2128ce15}{sim\+\_\+pl} (double nh, double t\+\_\+r, double t\+\_\+e, double www, int nelem, double ne, double density\mbox{[}$\,$\mbox{]}, double xne, double newden\mbox{[}$\,$\mbox{]}, double f1, double f2)
\item 
double \hyperlink{balance__templates_8h_af8cca9ec56b5097105e209de88fbf427}{xinteg\+\_\+sim} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int nion, double max\+\_\+ratio, double current\+\_\+ratio)
\item 
double \hyperlink{balance__templates_8h_a62b387a13364f82a9dd357b7866f9543}{tb\+\_\+planck} (double freq)
\item 
double \hyperlink{balance__templates_8h_a3f7b1bb2489cf3bc02bb0b28c20ebef7}{verner\+\_\+planck} (double freq)
\item 
double \hyperlink{balance__templates_8h_adad31bd88f4f7c762a1c4efa8c964941}{tb\+\_\+pow} (double freq)
\item 
double \hyperlink{balance__templates_8h_a1e88d24ba05d7a5dd5c1f6099e67766d}{verner\+\_\+pow} (double freq)
\item 
double \hyperlink{balance__templates_8h_a2a54f2e08391e50dbbfd7fe91d103c4b}{sim\+\_\+alphasolve} (double ratans, double numin, double numax)
\item 
double \hyperlink{balance__templates_8h_a312eb82e3c0f3b9a56c3eba044981bb9}{sim\+\_\+w} (double en1, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}, double dt, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double numin, double numax)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{balance__templates_8h_adf94ba064c06da9ef29d91b1ce2eb8f2}\label{balance__templates_8h_adf94ba064c06da9ef29d91b1ce2eb8f2}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!absolute\+\_\+line\+\_\+heating@{absolute\+\_\+line\+\_\+heating}}
\index{absolute\+\_\+line\+\_\+heating@{absolute\+\_\+line\+\_\+heating}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{absolute\+\_\+line\+\_\+heating()}{absolute\_line\_heating()}}
{\footnotesize\ttfamily double absolute\+\_\+line\+\_\+heating (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a7b5184477c806f535b3e59232205158e}\label{balance__templates_8h_a7b5184477c806f535b3e59232205158e}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!absolute\+\_\+line\+\_\+nsigma@{absolute\+\_\+line\+\_\+nsigma}}
\index{absolute\+\_\+line\+\_\+nsigma@{absolute\+\_\+line\+\_\+nsigma}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{absolute\+\_\+line\+\_\+nsigma()}{absolute\_line\_nsigma()}}
{\footnotesize\ttfamily double absolute\+\_\+line\+\_\+nsigma (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{w }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_aaea56e4177bd14c0ad6d55c81d2504fe}\label{balance__templates_8h_aaea56e4177bd14c0ad6d55c81d2504fe}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!absolute\+\_\+saha@{absolute\+\_\+saha}}
\index{absolute\+\_\+saha@{absolute\+\_\+saha}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{absolute\+\_\+saha()}{absolute\_saha()}}
{\footnotesize\ttfamily int absolute\+\_\+saha (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{www,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{nh,  }\item[{double}]{t\+\_\+r,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{weight,  }\item[{int}]{freq\+\_\+sampling }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_aab782f10945f43b64502aa2670ed55b7}\label{balance__templates_8h_aab782f10945f43b64502aa2670ed55b7}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!absolute\+\_\+total\+\_\+emission@{absolute\+\_\+total\+\_\+emission}}
\index{absolute\+\_\+total\+\_\+emission@{absolute\+\_\+total\+\_\+emission}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{absolute\+\_\+total\+\_\+emission()}{absolute\_total\_emission()}}
{\footnotesize\ttfamily double absolute\+\_\+total\+\_\+emission (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_acaacc7878589d1387a33ace5eed06b59}\label{balance__templates_8h_acaacc7878589d1387a33ace5eed06b59}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!absolute\+\_\+total\+\_\+line\+\_\+emission@{absolute\+\_\+total\+\_\+line\+\_\+emission}}
\index{absolute\+\_\+total\+\_\+line\+\_\+emission@{absolute\+\_\+total\+\_\+line\+\_\+emission}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{absolute\+\_\+total\+\_\+line\+\_\+emission()}{absolute\_total\_line\_emission()}}
{\footnotesize\ttfamily double absolute\+\_\+total\+\_\+line\+\_\+emission (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{ww,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_afabb511243ff444fcd3b968d96650181}\label{balance__templates_8h_afabb511243ff444fcd3b968d96650181}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!absolute\+\_\+two\+\_\+level\+\_\+atom@{absolute\+\_\+two\+\_\+level\+\_\+atom}}
\index{absolute\+\_\+two\+\_\+level\+\_\+atom@{absolute\+\_\+two\+\_\+level\+\_\+atom}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{absolute\+\_\+two\+\_\+level\+\_\+atom()}{absolute\_two\_level\_atom()}}
{\footnotesize\ttfamily double absolute\+\_\+two\+\_\+level\+\_\+atom (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{www,  }\item[{double $\ast$}]{d1,  }\item[{double $\ast$}]{d2 }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c}\label{balance__templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!agn\+\_\+init@{agn\+\_\+init}}
\index{agn\+\_\+init@{agn\+\_\+init}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{agn\+\_\+init()}{agn\_init()}}
{\footnotesize\ttfamily double agn\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{r,  }\item[{double}]{lum,  }\item[{double}]{alpha,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{double $\ast$}]{f }\end{DoxyParamCaption})}



Calculates the total luminosity of an A\+GN type source. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r radius of emitting object \\
\hline
\mbox{\tt in}  & {\em double} & lum the luminosity of the A\+GN (2-\/10keV) -\/ X\+XX I\textquotesingle{}m not sure this is used apart from \\
\hline
\mbox{\tt in}  & {\em double} & alpha the spectral index of the PL source -\/ also sometimes used for a temperature if a BB source is required \\
\hline
\mbox{\tt in}  & {\em double} & freqmin minimum frequency to integrate over \\
\hline
\mbox{\tt in}  & {\em double} & freqmax maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final flag to say if we are in the ionization cycles or spectral cycle \\
\hline
\mbox{\tt out}  & {\em double} & f the returned luminosity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
f -\/ the luminosity -\/ seems to be returned as well as set implicitly.
\end{DoxyReturn}
This routine is used when one is working out how many photons will be made from each of several sources. This computes the total luminosity of a source of radius r, with spectral index alpha between band boundaries given by freqmin and freqmax

\paragraph*{Notes}

There seem to be some inconsistencies here -\/ lum (the 2-\/10keV luminosity of the PL source) is supplied but it doesnt seem to be used apart from in the emittance\+\_\+continuum which is nonsense -\/ this requires a temperature and a local gravity Another inconsistency is that the bremstrahlung code uses values for T and alpha that are stored in the geo structure, whilst the power law uses data supplied in the code. 

Definition at line 54 of file agn.\+c.

\mbox{\Hypertarget{balance__templates_8h_a8c6c750e78c6ac8947df45545e328f79}\label{balance__templates_8h_a8c6c750e78c6ac8947df45545e328f79}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!check\+\_\+field@{check\+\_\+field}}
\index{check\+\_\+field@{check\+\_\+field}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+field()}{check\_field()}}
{\footnotesize\ttfamily int check\+\_\+field (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{one }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a1b84aa5f9c633207462d3907cb95ea0d}\label{balance__templates_8h_a1b84aa5f9c633207462d3907cb95ea0d}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!cycle@{cycle}}
\index{cycle@{cycle}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{cycle()}{cycle()}}
{\footnotesize\ttfamily int cycle (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{nh,  }\item[{double}]{t\+\_\+r,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{weight,  }\item[{int}]{mode,  }\item[{int}]{freq\+\_\+sampling,  }\item[{int}]{radmode }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a3b78924c6f60b99b920be396592d3dfe}\label{balance__templates_8h_a3b78924c6f60b99b920be396592d3dfe}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!define\+\_\+wind\+\_\+grid@{define\+\_\+wind\+\_\+grid}}
\index{define\+\_\+wind\+\_\+grid@{define\+\_\+wind\+\_\+grid}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{define\+\_\+wind\+\_\+grid()}{define\_wind\_grid()}}
{\footnotesize\ttfamily int define\+\_\+wind\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{double}]{xmin,  }\item[{double}]{xmax,  }\item[{double}]{zmin,  }\item[{double}]{zmax }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a6e2a1d42f6b6711b81d28868b9e834f9}\label{balance__templates_8h_a6e2a1d42f6b6711b81d28868b9e834f9}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!do\+\_\+detail@{do\+\_\+detail}}
\index{do\+\_\+detail@{do\+\_\+detail}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{do\+\_\+detail()}{do\_detail()}}
{\footnotesize\ttfamily int do\+\_\+detail (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{one }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a3c809c8bf25573271a29ddb1d925d090}\label{balance__templates_8h_a3c809c8bf25573271a29ddb1d925d090}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!ds\+\_\+to\+\_\+wind@{ds\+\_\+to\+\_\+wind}}
\index{ds\+\_\+to\+\_\+wind@{ds\+\_\+to\+\_\+wind}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+wind()}{ds\_to\_wind()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_ab262a3874348edde02451c9375f959d4}\label{balance__templates_8h_ab262a3874348edde02451c9375f959d4}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!dumb\+\_\+step@{dumb\+\_\+step}}
\index{dumb\+\_\+step@{dumb\+\_\+step}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{dumb\+\_\+step()}{dumb\_step()}}
{\footnotesize\ttfamily int dumb\+\_\+step (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double $\ast$}]{te }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a647aa352bc1435e0ef14ca7901009cf6}\label{balance__templates_8h_a647aa352bc1435e0ef14ca7901009cf6}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!emittance\+\_\+pow@{emittance\+\_\+pow}}
\index{emittance\+\_\+pow@{emittance\+\_\+pow}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{emittance\+\_\+pow()}{emittance\_pow()}}
{\footnotesize\ttfamily double emittance\+\_\+pow (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{lum,  }\item[{double}]{alpha }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a8bf694158a4386b3c360a3ba7518fd45}\label{balance__templates_8h_a8bf694158a4386b3c360a3ba7518fd45}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!fb\+\_\+cooling@{fb\+\_\+cooling}}
\index{fb\+\_\+cooling@{fb\+\_\+cooling}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{fb\+\_\+cooling()}{fb\_cooling()}}
{\footnotesize\ttfamily double fb\+\_\+cooling (\begin{DoxyParamCaption}\item[{double}]{t\+\_\+e,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{double $\ast$}]{fb\+\_\+h,  }\item[{double $\ast$}]{fb\+\_\+he1,  }\item[{double $\ast$}]{fb\+\_\+he2 }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_aec7b0f63aeb85f00e64bc2e4ccc29033}\label{balance__templates_8h_aec7b0f63aeb85f00e64bc2e4ccc29033}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!fb\+\_\+cooling\+\_\+d@{fb\+\_\+cooling\+\_\+d}}
\index{fb\+\_\+cooling\+\_\+d@{fb\+\_\+cooling\+\_\+d}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{fb\+\_\+cooling\+\_\+d()}{fb\_cooling\_d()}}
{\footnotesize\ttfamily double fb\+\_\+cooling\+\_\+d (\begin{DoxyParamCaption}\item[{double}]{f }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_af5c48ea866d13aa6edd542c4dc6b1f90}\label{balance__templates_8h_af5c48ea866d13aa6edd542c4dc6b1f90}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!find\+\_\+te@{find\+\_\+te}}
\index{find\+\_\+te@{find\+\_\+te}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{find\+\_\+te()}{find\_te()}}
{\footnotesize\ttfamily int find\+\_\+te (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a4c2ef9cf62764a5a4da8758813c79e0d}\label{balance__templates_8h_a4c2ef9cf62764a5a4da8758813c79e0d}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!line\+\_\+heating@{line\+\_\+heating}}
\index{line\+\_\+heating@{line\+\_\+heating}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{line\+\_\+heating()}{line\_heating()}}
{\footnotesize\ttfamily double line\+\_\+heating (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a0ddf1224851353fc92bfbff6f499fa97}\label{balance__templates_8h_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!main@{main}}
\index{main@{main}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a5831d70a8e5c02008db6aa5f49cc9ea5}\label{balance__templates_8h_a5831d70a8e5c02008db6aa5f49cc9ea5}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!multi\+\_\+concen@{multi\+\_\+concen}}
\index{multi\+\_\+concen@{multi\+\_\+concen}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{multi\+\_\+concen()}{multi\_concen()}}
{\footnotesize\ttfamily int multi\+\_\+concen (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{www }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_aa362e9608342d17798849cf026e41a5e}\label{balance__templates_8h_aa362e9608342d17798849cf026e41a5e}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!multicycle@{multicycle}}
\index{multicycle@{multicycle}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{multicycle()}{multicycle()}}
{\footnotesize\ttfamily int multicycle (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{www,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{mode,  }\item[{int}]{freq\+\_\+sampling,  }\item[{int}]{radmode }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a37c9b91e3450874eb15cef76079f344d}\label{balance__templates_8h_a37c9b91e3450874eb15cef76079f344d}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!partition\+\_\+functions@{partition\+\_\+functions}}
\index{partition\+\_\+functions@{partition\+\_\+functions}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{partition\+\_\+functions()}{partition\_functions()}}
{\footnotesize\ttfamily int partition\+\_\+functions (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma A plasma cell in the wind \\
\hline
\mbox{\tt in}  & {\em int} & mode An integer which determines the way in which the partition funciton will be calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The possibilites are\+:
\begin{DoxyItemize}
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TR 0 L\+TE using t\+\_\+r
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TE 1 L\+TE using t\+\_\+e
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+M\+L93 2 M\+L93 using a nebular approximation correction to L\+TE
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+N\+L\+T\+E\+\_\+\+S\+IM 3 // Non\+\_\+\+L\+TE with SS modification (Probably could be removed)
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+L\+T\+E\+\_\+\+G\+R\+O\+U\+ND 4 // A mode which forces all levels to the GS -\/ this is used when we are modelling J\+\_\+nu.
\end{DoxyItemize}

\paragraph*{Notes}

0800802 -\/ This is a rewritten version of two routines, do\+\_\+partitions and partition. It is still true that levels is almost identical to some of the code here and therefore it is unclear why it is needed. levels is always called from partition\+\_\+functions 

Definition at line 109 of file partition.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{balance__templates_8h_a37c9b91e3450874eb15cef76079f344d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{balance__templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10}\label{balance__templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!photo\+\_\+gen\+\_\+agn@{photo\+\_\+gen\+\_\+agn}}
\index{photo\+\_\+gen\+\_\+agn@{photo\+\_\+gen\+\_\+agn}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+agn()}{photo\_gen\_agn()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+agn (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{r,  }\item[{double}]{alpha,  }\item[{double}]{weight,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{spectype,  }\item[{int}]{istart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



Generate a photon from an A\+GN object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p pointer to the photon array \\
\hline
\mbox{\tt in,out}  & {\em double} & r radius of the central source \\
\hline
\mbox{\tt in,out}  & {\em double} & alpha spectral index of the PL sourece -\/ also used to communicate temperature if a BB or model is used. \\
\hline
\mbox{\tt in,out}  & {\em double} & weight the weight of each photon to be made \\
\hline
\mbox{\tt in,out}  & {\em double} & f1 lower frequency bound \\
\hline
\mbox{\tt in,out}  & {\em double} & f2 upper frequency nound \\
\hline
\mbox{\tt in,out}  & {\em int} & spectype the type of S\+ED \\
\hline
\mbox{\tt in,out}  & {\em int} & istart the number of the first photon to be made -\/ index into the p array \\
\hline
\mbox{\tt in,out}  & {\em int} & nphot the number of photons to be made \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 (if successful or unscuccessful)
\end{DoxyReturn}
This subroutine produces photons from an A\+GN type source. There are a range of different S\+E\+Ds that can be used, these are communicated by the spectype and different choices cause different surbroutines to be called. The only {\itshape real} work done here is to compute the strarting location and direction of the photons.

\paragraph*{Notes}

Definition at line 374 of file agn.\+c.

\mbox{\Hypertarget{balance__templates_8h_a737bba69d6237e8d171f633c2c6d4cbf}\label{balance__templates_8h_a737bba69d6237e8d171f633c2c6d4cbf}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!pl\+\_\+copy\+\_\+conditions@{pl\+\_\+copy\+\_\+conditions}}
\index{pl\+\_\+copy\+\_\+conditions@{pl\+\_\+copy\+\_\+conditions}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+copy\+\_\+conditions()}{pl\_copy\_conditions()}}
{\footnotesize\ttfamily int pl\+\_\+copy\+\_\+conditions (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{win,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{wout }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a6f6a9a8730c8d1fa98e71a19b4121061}\label{balance__templates_8h_a6f6a9a8730c8d1fa98e71a19b4121061}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!pl\+\_\+rho@{pl\+\_\+rho}}
\index{pl\+\_\+rho@{pl\+\_\+rho}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+rho()}{pl\_rho()}}
{\footnotesize\ttfamily double pl\+\_\+rho (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a0f7abdb5c54e097dce91c47669672ca7}\label{balance__templates_8h_a0f7abdb5c54e097dce91c47669672ca7}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!pl\+\_\+velocity@{pl\+\_\+velocity}}
\index{pl\+\_\+velocity@{pl\+\_\+velocity}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+velocity()}{pl\_velocity()}}
{\footnotesize\ttfamily double pl\+\_\+velocity (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_aaa16d99441c764597ca593780e74f134}\label{balance__templates_8h_aaa16d99441c764597ca593780e74f134}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!pl\+\_\+wind\+\_\+define@{pl\+\_\+wind\+\_\+define}}
\index{pl\+\_\+wind\+\_\+define@{pl\+\_\+wind\+\_\+define}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+wind\+\_\+define()}{pl\_wind\_define()}}
{\footnotesize\ttfamily int pl\+\_\+wind\+\_\+define (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a16695e51479862629c3204586710a9da}\label{balance__templates_8h_a16695e51479862629c3204586710a9da}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!print\+\_\+levels@{print\+\_\+levels}}
\index{print\+\_\+levels@{print\+\_\+levels}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{print\+\_\+levels()}{print\_levels()}}
{\footnotesize\ttfamily int print\+\_\+levels (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{w }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a2a54f2e08391e50dbbfd7fe91d103c4b}\label{balance__templates_8h_a2a54f2e08391e50dbbfd7fe91d103c4b}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!sim\+\_\+alphasolve@{sim\+\_\+alphasolve}}
\index{sim\+\_\+alphasolve@{sim\+\_\+alphasolve}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{sim\+\_\+alphasolve()}{sim\_alphasolve()}}
{\footnotesize\ttfamily double sim\+\_\+alphasolve (\begin{DoxyParamCaption}\item[{double}]{ratans,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a371914de0935dbdb2eec59da595cd6d4}\label{balance__templates_8h_a371914de0935dbdb2eec59da595cd6d4}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!sim\+\_\+driver@{sim\+\_\+driver}}
\index{sim\+\_\+driver@{sim\+\_\+driver}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{sim\+\_\+driver()}{sim\_driver()}}
{\footnotesize\ttfamily int sim\+\_\+driver (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_ad9ef6b5303be6721d0d71fef2128ce15}\label{balance__templates_8h_ad9ef6b5303be6721d0d71fef2128ce15}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!sim\+\_\+pl@{sim\+\_\+pl}}
\index{sim\+\_\+pl@{sim\+\_\+pl}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{sim\+\_\+pl()}{sim\_pl()}}
{\footnotesize\ttfamily int sim\+\_\+pl (\begin{DoxyParamCaption}\item[{double}]{nh,  }\item[{double}]{t\+\_\+r,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{www,  }\item[{int}]{nelem,  }\item[{double}]{ne,  }\item[{double}]{density\mbox{[}$\,$\mbox{]},  }\item[{double}]{xne,  }\item[{double}]{newden\mbox{[}$\,$\mbox{]},  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a312eb82e3c0f3b9a56c3eba044981bb9}\label{balance__templates_8h_a312eb82e3c0f3b9a56c3eba044981bb9}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!sim\+\_\+w@{sim\+\_\+w}}
\index{sim\+\_\+w@{sim\+\_\+w}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{sim\+\_\+w()}{sim\_w()}}
{\footnotesize\ttfamily double sim\+\_\+w (\begin{DoxyParamCaption}\item[{double}]{en1,  }\item[{double}]{v,  }\item[{double}]{dt,  }\item[{double}]{alpha,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a9da84c571671cfa8523ab5d3aed6c6e5}\label{balance__templates_8h_a9da84c571671cfa8523ab5d3aed6c6e5}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!sobolev\+\_\+line\+\_\+heating@{sobolev\+\_\+line\+\_\+heating}}
\index{sobolev\+\_\+line\+\_\+heating@{sobolev\+\_\+line\+\_\+heating}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{sobolev\+\_\+line\+\_\+heating()}{sobolev\_line\_heating()}}
{\footnotesize\ttfamily double sobolev\+\_\+line\+\_\+heating (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a33a5fe351d8c1dcf015fc2cf00b9da5c}\label{balance__templates_8h_a33a5fe351d8c1dcf015fc2cf00b9da5c}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!summary@{summary}}
\index{summary@{summary}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{summary()}{summary()}}
{\footnotesize\ttfamily int summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{one }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a62b387a13364f82a9dd357b7866f9543}\label{balance__templates_8h_a62b387a13364f82a9dd357b7866f9543}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!tb\+\_\+planck@{tb\+\_\+planck}}
\index{tb\+\_\+planck@{tb\+\_\+planck}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{tb\+\_\+planck()}{tb\_planck()}}
{\footnotesize\ttfamily double tb\+\_\+planck (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_adad31bd88f4f7c762a1c4efa8c964941}\label{balance__templates_8h_adad31bd88f4f7c762a1c4efa8c964941}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!tb\+\_\+pow@{tb\+\_\+pow}}
\index{tb\+\_\+pow@{tb\+\_\+pow}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{tb\+\_\+pow()}{tb\_pow()}}
{\footnotesize\ttfamily double tb\+\_\+pow (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a620388e1c4a8e38f192c5a0ce42af389}\label{balance__templates_8h_a620388e1c4a8e38f192c5a0ce42af389}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!trans\+\_\+phot@{trans\+\_\+phot}}
\index{trans\+\_\+phot@{trans\+\_\+phot}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{trans\+\_\+phot()}{trans\_phot()}}
{\footnotesize\ttfamily int trans\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{iextract }\end{DoxyParamCaption})}



int (w,p,iextract) oversees the propagation of a \char`\"{}flight\char`\"{} of photons 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind domain \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A pointer to a \char`\"{}fligh\char`\"{} of photons \\
\hline
\mbox{\tt in}  & {\em int} & iextract An integer controlling whether we are to process the flight in the live or die option (0) or whether we also need to extract photons in specific directions (which is usually the case in constructing spectra \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns 0
\end{DoxyReturn}
This routine oversees the propagation of individual photons. The main loop covers an entire \char`\"{}flight\char`\"{} of photons. The routine generates the random optical depth a photon can travel before scattering and monitors the progress of the photon through the grid.

The real physics is done elsewhere, in lower level routines.

\paragraph*{Notes}

At the end of the routine the position for each of the photons in p is the last point where the photon was in the wind, $\ast$ not the outer boundary of the radiative transfer 

Definition at line 85 of file trans\+\_\+phot.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{balance__templates_8h_a620388e1c4a8e38f192c5a0ce42af389_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{balance__templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8}\label{balance__templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!translate@{translate}}
\index{translate@{translate}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{translate()}{translate()}}
{\footnotesize\ttfamily int translate (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{double}]{tau\+\_\+scat,  }\item[{double $\ast$}]{tau,  }\item[{int $\ast$}]{nres }\end{DoxyParamCaption})}



a steering routine that either calls \+\_\+in\+\_\+space or \+\_\+in\+\_\+wind depending upon the current location of the photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w A pointer to the wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pp A photon \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+scat the depth at which the photon should scatter \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ tau The optical depth associated with a resonanant scatter when this is the reason the photon has stopped \\
\hline
\mbox{\tt in,out}  & {\em int} & $\ast$ nres The number of the resonance if the photon stopped. due to reaching the scattering optical depth \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status that states what caused the photon to stp as it did
\end{DoxyReturn}
The routine takes the current position of the photon and determines where it is. Depending on this it calls either translate\+\_\+in\+\_\+space or translate\+\_\+in\+\_\+wind

On exit, the position of the photon will have been updated.

\paragraph*{Notes}

Translate controls the flow of the photon through one grid cell. In Python, there are additional possibilities since there are wind free regions.

The routine first calls where\+\_\+in\+\_\+wind which returns the correct domain for a given position, or domain 0 if the position is not in the wind of a domain. The photon structure does not have the domain number directly encoded, but it can be obtained from the grid number, which where in\+\_\+grid updates

This construction is used so that the calling routines for translate (trans\+\_\+phot and extract) can be the same in the 1 and 2d versions. 

Definition at line 79 of file photon2d.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{balance__templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{balance__templates_8h_aa1ffd17034054d51819328d892fc57e8}\label{balance__templates_8h_aa1ffd17034054d51819328d892fc57e8}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!translate\+\_\+in\+\_\+space@{translate\+\_\+in\+\_\+space}}
\index{translate\+\_\+in\+\_\+space@{translate\+\_\+in\+\_\+space}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{translate\+\_\+in\+\_\+space()}{translate\_in\_space()}}
{\footnotesize\ttfamily int translate\+\_\+in\+\_\+space (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



translates the photon from its current position to the edge of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pp A photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status flag indication why the photon stopped
\end{DoxyReturn}
The routine translate the photon (which is assumed to be in the wind, but not in an active wind cell) to the closest boundary.

The photon position is updated in the process.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000041}{Bug}]There are questions in the comments about why an additonal check is needed as to whther the photon as hit the star. It seems superfluous so someone should check whether this addtional check can be removed.\end{DoxyRefDesc}


Definition at line 144 of file photon2d.\+c.

\mbox{\Hypertarget{balance__templates_8h_a0118547dede9b08b5ac6609b4313e3e8}\label{balance__templates_8h_a0118547dede9b08b5ac6609b4313e3e8}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!translate\+\_\+in\+\_\+wind@{translate\+\_\+in\+\_\+wind}}
\index{translate\+\_\+in\+\_\+wind@{translate\+\_\+in\+\_\+wind}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{translate\+\_\+in\+\_\+wind()}{translate\_in\_wind()}}
{\footnotesize\ttfamily int translate\+\_\+in\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{tau\+\_\+scat,  }\item[{double $\ast$}]{tau,  }\item[{int $\ast$}]{nres }\end{DoxyParamCaption})}



translates the photon within a single cell in the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A photon \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+scat The depth at which the photon will scatter \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ tau The tau of a resonance \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ nres The resonaance which caused the photon to stop \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status indicated whether the photon has stopped for a scattering even of for some other teason
\end{DoxyReturn}
It calculates and updates the final position of the photon p, the optical depth tau after having translated the photon, and, if the photon is scattered, the number of the resonance responsible for scattering (or absorbing) the photon bundle.

These last two quantities are calculated in ds\+\_\+calculate and simply passed back.

translate\+\_\+in\+\_\+wind returns that status directly to the calling routine.

\paragraph*{Notes}

In addition to moving the photon, the routine also updates some values having to do with the radiation filed both in and out of macro atom mode. 

Definition at line 543 of file photon2d.\+c.

\mbox{\Hypertarget{balance__templates_8h_a3f7b1bb2489cf3bc02bb0b28c20ebef7}\label{balance__templates_8h_a3f7b1bb2489cf3bc02bb0b28c20ebef7}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!verner\+\_\+planck@{verner\+\_\+planck}}
\index{verner\+\_\+planck@{verner\+\_\+planck}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{verner\+\_\+planck()}{verner\_planck()}}
{\footnotesize\ttfamily double verner\+\_\+planck (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a1e88d24ba05d7a5dd5c1f6099e67766d}\label{balance__templates_8h_a1e88d24ba05d7a5dd5c1f6099e67766d}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!verner\+\_\+pow@{verner\+\_\+pow}}
\index{verner\+\_\+pow@{verner\+\_\+pow}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{verner\+\_\+pow()}{verner\_pow()}}
{\footnotesize\ttfamily double verner\+\_\+pow (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a56740476af61734dee90b4090f004971}\label{balance__templates_8h_a56740476af61734dee90b4090f004971}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!walls@{walls}}
\index{walls@{walls}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{walls()}{walls()}}
{\footnotesize\ttfamily int walls (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pold }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{balance__templates_8h_a56740476af61734dee90b4090f004971_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{balance__templates_8h_a2cdbde0efa1209e5e416c10c54ed7e8d}\label{balance__templates_8h_a2cdbde0efa1209e5e416c10c54ed7e8d}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!xbb@{xbb}}
\index{xbb@{xbb}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{xbb()}{xbb()}}
{\footnotesize\ttfamily int xbb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{t,  }\item[{double}]{weight,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{freq\+\_\+sampling }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_af8cca9ec56b5097105e209de88fbf427}\label{balance__templates_8h_af8cca9ec56b5097105e209de88fbf427}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!xinteg\+\_\+sim@{xinteg\+\_\+sim}}
\index{xinteg\+\_\+sim@{xinteg\+\_\+sim}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{xinteg\+\_\+sim()}{xinteg\_sim()}}
{\footnotesize\ttfamily double xinteg\+\_\+sim (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nion,  }\item[{double}]{max\+\_\+ratio,  }\item[{double}]{current\+\_\+ratio }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_a571b75143e5686426dbc0d5ef4bf58a3}\label{balance__templates_8h_a571b75143e5686426dbc0d5ef4bf58a3}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!xmake\+\_\+bb@{xmake\+\_\+bb}}
\index{xmake\+\_\+bb@{xmake\+\_\+bb}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{xmake\+\_\+bb()}{xmake\_bb()}}
{\footnotesize\ttfamily int xmake\+\_\+bb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{t\+\_\+r,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{weight,  }\item[{int}]{iphot\+\_\+start,  }\item[{int}]{nphot }\end{DoxyParamCaption})}

\mbox{\Hypertarget{balance__templates_8h_ab34d13ef098af692d1a406016724580a}\label{balance__templates_8h_ab34d13ef098af692d1a406016724580a}} 
\index{balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}!xsaha@{xsaha}}
\index{xsaha@{xsaha}!balance\+\_\+templates.\+h@{balance\+\_\+templates.\+h}}
\subsubsection{\texorpdfstring{xsaha()}{xsaha()}}
{\footnotesize\ttfamily int xsaha (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{nh,  }\item[{double}]{t\+\_\+r,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{weight,  }\item[{int}]{ioniz\+\_\+mode,  }\item[{int}]{freq\+\_\+sampling }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{balance__templates_8h_ab34d13ef098af692d1a406016724580a_icgraph}
\end{center}
\end{figure}
