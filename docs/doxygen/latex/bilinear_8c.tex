\hypertarget{bilinear_8c}{}\section{/\+Users/mhewitt/python/source/bilinear.c File Reference}
\label{bilinear_8c}\index{/\+Users/mhewitt/python/source/bilinear.\+c@{/\+Users/mhewitt/python/source/bilinear.\+c}}


As the name indicates the routines solve for the fractional position of a 2d vector in a 2d cell with 4 corners.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$strings.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}log.\+h\char`\"{}}\newline
Include dependency graph for bilinear.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bilinear_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{bilinear_8c_a0d7059db01a063789ca5b78386eb2889}{bilin} (\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, x00, x01, x10, x11, double $\ast$f, double $\ast$g)
\begin{DoxyCompactList}\small\item\em calculates the fractional position in the coordinate grid of a 2d vector x. \end{DoxyCompactList}\item 
int \hyperlink{bilinear_8c_af582498786ae60301965c85d405d7cde}{xquadratic} (double a, double b, double c, \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em solves a quadratic of the form 0=ax$\ast$$\ast$2+bx+c \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
As the name indicates the routines solve for the fractional position of a 2d vector in a 2d cell with 4 corners. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018
\end{DoxyDate}
There is also a quadratic equation solver 

\subsection{Function Documentation}
\mbox{\Hypertarget{bilinear_8c_a0d7059db01a063789ca5b78386eb2889}\label{bilinear_8c_a0d7059db01a063789ca5b78386eb2889}} 
\index{bilinear.\+c@{bilinear.\+c}!bilin@{bilin}}
\index{bilin@{bilin}!bilinear.\+c@{bilinear.\+c}}
\subsubsection{\texorpdfstring{bilin()}{bilin()}}
{\footnotesize\ttfamily int bilin (\begin{DoxyParamCaption}\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{,  }\item[{x00}]{,  }\item[{x01}]{,  }\item[{x10}]{,  }\item[{x11}]{,  }\item[{double $\ast$}]{f,  }\item[{double $\ast$}]{g }\end{DoxyParamCaption})}



calculates the fractional position in the coordinate grid of a 2d vector x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} The 2d position within the cell \\
\hline
\mbox{\tt in}  & {\em double} & x00\mbox{[}\mbox{]} The 2d position of the lower-\/left edge of cell \\
\hline
\mbox{\tt in}  & {\em double} & x01\mbox{[}\mbox{]} The 2d position of the upper-\/left edge of the cell \\
\hline
\mbox{\tt in}  & {\em double} & x10\mbox{[}\mbox{]} The 2d position of the lower-\/right edge of the cell \\
\hline
\mbox{\tt in}  & {\em double} & x11\mbox{[}\mbox{]} The 2d position of the upper-\/right edge of the cell \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ f The fractional position in the \char`\"{}x\char`\"{} direction \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ g The fractional postion in the \char`\"{}z\char`\"{} direction \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine itself returns 0 if the postion is inside the cell, and -\/1 otherwise.
\end{DoxyReturn}
The input 2d input vectors are assumed to have the relationship shown in real space, that is x00 and x01 are more or less along the z axis, while x00 and x10 are more or less along the +x acis


\begin{DoxyItemize}
\item x01 ....... x11
\item . .
\item . .
\item x00 ....... x10
\end{DoxyItemize}

\paragraph*{Notes}

Basically

X= (1-\/g) \mbox{[} (1-\/f) X00 + f X10 \mbox{]} $\ast$ g \mbox{[} (1-\/f)$\ast$\+X01+ f$\ast$ X11 \mbox{]}

where the capitalized values of X,etc denote vectors, and f and g are the fractional weightings.

X = (1-\/g) A + g B

It is easy to solve for g in terms of f

g = (X-\/A)/(B-\/A)

where A = \mbox{[} (1-\/f) X00 + f X10 \mbox{]} and B = \mbox{[} (1-\/f)$\ast$\+X01+ f$\ast$ X11 \mbox{]}

But this gives you two expressions for g depending on whether you consider the 0 or 1 component of the vector, and therefore you can solve for f. More specifically,

g= \mbox{[}(X-\/\+X\+OO) + f (X\+O\+O-\/\+X10)\mbox{]} / \mbox{[}(X01-\/\+X10)+f (X11+\+X00-\/\+X01-\/\+X10)\mbox{]}

or

g = (Q + f R) / (S+f T)

where Q, R, S, and T are defined from the equation above.

So expanding in terms of the component veciots what we have is

(Q\mbox{[}0\mbox{]}+f R\mbox{[}0\mbox{]}) (S\mbox{[}2\mbox{]}+f T\mbox{[}2\mbox{]}) = (Q\mbox{[}2\mbox{]}+f R\mbox{[}2\mbox{]}) (S\mbox{[}0\mbox{]}+f T\mbox{[}0\mbox{]})

which can now be put in the form of a xquadratic

a f$\ast$$\ast$2 + b f +c = 0

where


\begin{DoxyItemize}
\item a = r\mbox{[}0\mbox{]}$\ast$t\mbox{[}2\mbox{]} -\/ r\mbox{[}2\mbox{]}$\ast$t\mbox{[}0\mbox{]}
\item b= r\mbox{[}0\mbox{]}$\ast$s\mbox{[}2\mbox{]} + q\mbox{[}0\mbox{]}$\ast$t\mbox{[}2\mbox{]} -\/ ( r\mbox{[}2\mbox{]}$\ast$s\mbox{[}0\mbox{]} + q\mbox{[}2\mbox{]}$\ast$t\mbox{[}0\mbox{]} )
\item c = q\mbox{[}0\mbox{]}$\ast$s\mbox{[}2\mbox{]} -\/ q\mbox{[}2\mbox{]}$\ast$s\mbox{[}0\mbox{]}
\end{DoxyItemize}

A problem with this approach is that does not work in the case where the coordinates are the x axis positions of X01 and X01 are the same and the X10 and X11 are the same. This is because the denominator becomes 0 in the equation for g. This particular case is important because it is the case we are trying to solve for.

In this case we need to solve for f by itself. Similarly there is a degnereate case when (x00\mbox{[}2\mbox{]} == x10\mbox{[}2\mbox{]} \&\& x01\mbox{[}2\mbox{]} == x11\mbox{[}2\mbox{]}) 

Definition at line 109 of file bilinear.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bilinear_8c_a0d7059db01a063789ca5b78386eb2889_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bilinear_8c_a0d7059db01a063789ca5b78386eb2889_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{bilinear_8c_af582498786ae60301965c85d405d7cde}\label{bilinear_8c_af582498786ae60301965c85d405d7cde}} 
\index{bilinear.\+c@{bilinear.\+c}!xquadratic@{xquadratic}}
\index{xquadratic@{xquadratic}!bilinear.\+c@{bilinear.\+c}}
\subsubsection{\texorpdfstring{xquadratic()}{xquadratic()}}
{\footnotesize\ttfamily int xquadratic (\begin{DoxyParamCaption}\item[{double}]{a,  }\item[{double}]{b,  }\item[{double}]{c,  }\item[{\hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}}]{ }\end{DoxyParamCaption})}



solves a quadratic of the form 0=ax$\ast$$\ast$2+bx+c 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & a \\
\hline
\mbox{\tt in,out}  & {\em double} & b \\
\hline
\mbox{\tt in,out}  & {\em double} & c \\
\hline
\mbox{\tt in,out}  & {\em double} & r\mbox{[}\mbox{]} roots of the quadratic equation \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item -\/1 -\/$>$ both roots are imaginary
\item -\/2 -\/$>$ both roots are negative or 0
\item 0 -\/$>$ the first root is the smallest positive root
\item 1 -\/$>$ the second root is the smallest positive root
\end{DoxyItemize}
\end{DoxyReturn}
This solves a simple xquadratic (or if a is zero linear equation). The return is set up to make it easy to identify the smallest positive root if one exists. The routine returns a negative number if both roots are negative or imaginary.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000005}{Bug}]xquadratic looks line for line identical to another routine quadratic which can be found in \hyperlink{phot__util_8c}{phot\+\_\+util.\+c}. Both versions of the code seem to be called. One of them should be removed.\end{DoxyRefDesc}


Definition at line 240 of file bilinear.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{bilinear_8c_af582498786ae60301965c85d405d7cde_icgraph}
\end{center}
\end{figure}
