\hypertarget{disk_8c}{}\section{/\+Users/mhewitt/python/source/disk.c File Reference}
\label{disk_8c}\index{/\+Users/mhewitt/python/source/disk.\+c@{/\+Users/mhewitt/python/source/disk.\+c}}


Various routines related setting up the disk and calculating when a photon encounters the disk surface.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for disk.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b}{tdisk} (double m, double mdot, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate the reference temperarure for a standard Shakura-\/\+Sunyaeev disk. \end{DoxyCompactList}\item 
double \hyperlink{disk_8c_a3440890f45c87b4c79fef37820f87487}{teff} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Calculate the temperature of the disk at a normalised distance x. \end{DoxyCompactList}\item 
double \hyperlink{disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64}{gdisk} (double mass, double mdot, double rmin)
\begin{DoxyCompactList}\small\item\em Calculate a reference gravity for the disk. \end{DoxyCompactList}\item 
double \hyperlink{disk_8c_aa4eb3da682e26e1705216d977de95a0a}{geff} (double g0, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Calculate the effective gravity at a specfic position in the disk. \end{DoxyCompactList}\item 
double \hyperlink{disk_8c_a29076b6a07403d62872baf4dc9bf9346}{vdisk} (\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em Calculate the speed and velocity v at which material given specific position in the disk. \end{DoxyCompactList}\item 
double \hyperlink{disk_8c_a4027a82b7c3df9474704080c8b3137cc}{zdisk} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate the height of the disk at a certain radius. \end{DoxyCompactList}\item 
double \hyperlink{disk_8c_afff91fbd2e4ab430bad432ecb529a28a}{ds\+\_\+to\+\_\+disk} (struct \hyperlink{structphoton}{photon} $\ast$p, int allow\+\_\+negative)
\begin{DoxyCompactList}\small\item\em Calculates the distance that a photon would need to travel from its current position to hit disk. \end{DoxyCompactList}\item 
void \hyperlink{disk_8c_a625372b64e082ea4b46de6f8be0e385f}{disk\+\_\+deriv} (double s, double $\ast$value, double $\ast$derivative)
\begin{DoxyCompactList}\small\item\em Calculate the change in disk height as s function of s. \end{DoxyCompactList}\item 
int \hyperlink{disk_8c_a8c6a40a92905dcccfe3f17bb046182bc}{qdisk\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em Initialize a structure (qdisk) for recording information about photons/energy impinging on the disk, which is stored in a disk structure called qdisk. \end{DoxyCompactList}\item 
int \hyperlink{disk_8c_a7c88d034953bdd81d94f7b4834f455cb}{qdisk\+\_\+save} (char $\ast$diskfile, double ztot)
\begin{DoxyCompactList}\small\item\em Save the information in the qdisk structure to a file. \end{DoxyCompactList}\item 
int \hyperlink{disk_8c_ada5d5c91372291204ba0255184ce1f87}{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile} (char $\ast$tprofile)
\begin{DoxyCompactList}\small\item\em Read the temperature profile from a file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{disk_8c_afaba31659717b807b58fa7b80c4847a1}{north} \mbox{[}$\,$\mbox{]} = \{ 0.\+0, 0.\+0, 1.\+0 \}
\item 
int \hyperlink{disk_8c_afb53135f3a02cc9e70a2cb6efd14d935}{ds\+\_\+to\+\_\+disk\+\_\+init} = 0
\item 
struct \hyperlink{structphoton}{photon} \hyperlink{disk_8c_aad63152416eeae502d325c1b83ab88d0}{ds\+\_\+to\+\_\+disk\+\_\+photon}
\item 
struct \hyperlink{structplane}{plane} diskplane disktop \hyperlink{disk_8c_a9e6fe84d8cd3c84f810c729edfb8f4ac}{diskbottom}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Various routines related setting up the disk and calculating when a photon encounters the disk surface. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{disk_8c_a625372b64e082ea4b46de6f8be0e385f}\label{disk_8c_a625372b64e082ea4b46de6f8be0e385f}} 
\index{disk.\+c@{disk.\+c}!disk\+\_\+deriv@{disk\+\_\+deriv}}
\index{disk\+\_\+deriv@{disk\+\_\+deriv}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{disk\+\_\+deriv()}{disk\_deriv()}}
{\footnotesize\ttfamily void disk\+\_\+deriv (\begin{DoxyParamCaption}\item[{double}]{s,  }\item[{double $\ast$}]{value,  }\item[{double $\ast$}]{derivative }\end{DoxyParamCaption})}



Calculate the change in disk height as s function of s. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s A distance along the path of a photon \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ value the disk height at s \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ derivative the derivative of the disk heith at s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N/A
\end{DoxyReturn}
Used in ds\+\_\+to\+\_\+disk by rtsafe as part of the procedure to locate the place a photon hits a vertically extended disk

\paragraph*{Notes}

The function we are trying to zero is the difference between the height of the disk and the z height of the photon. 

Definition at line 630 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{disk_8c_a625372b64e082ea4b46de6f8be0e385f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_a625372b64e082ea4b46de6f8be0e385f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_afff91fbd2e4ab430bad432ecb529a28a}\label{disk_8c_afff91fbd2e4ab430bad432ecb529a28a}} 
\index{disk.\+c@{disk.\+c}!ds\+\_\+to\+\_\+disk@{ds\+\_\+to\+\_\+disk}}
\index{ds\+\_\+to\+\_\+disk@{ds\+\_\+to\+\_\+disk}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+disk()}{ds\_to\_disk()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+disk (\begin{DoxyParamCaption}\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p,  }\item[{int}]{allow\+\_\+negative }\end{DoxyParamCaption})}



Calculates the distance that a photon would need to travel from its current position to hit disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & photon $\ast$ p a photon pointer. \\
\hline
\mbox{\tt in}  & {\em int} & allow\+\_\+negative permits a negative number to be returned in certain circumstances \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The distance to the disk.
\end{DoxyReturn}
Usually, ds\+\_\+to\+\_\+disk returns the distance along the line of sight to the disk in the direction a photon is currently travelling.

Usually, if the photon misses the disk going in the positive direction, a very large number is returned.

If allow\+\_\+negative is non-\/zero (true), then ds\+\_\+to\+\_\+disk returns a negative distance if it has not hit the disk going in the positive direction.

The routine allows both for a flat disk, and a vertically extended disk

\paragraph*{Notes}

The need to allow for negative distances arises because several of the parameterization for the wind (SV, K\+WD) depend on the distance between the current position and footpoint along a streamline. (It is not clear that this was a good approach, but that is the rationale)

Generally, there should not be an issue with this, though one can imagine that one might get into trouble for a very flared (bowl-\/shaped) disk.

Significant portions of the routine were rewritten in 1802 by ksl to better handle flared disks. 

Definition at line 370 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{disk_8c_afff91fbd2e4ab430bad432ecb529a28a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{disk_8c_afff91fbd2e4ab430bad432ecb529a28a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64}\label{disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64}} 
\index{disk.\+c@{disk.\+c}!gdisk@{gdisk}}
\index{gdisk@{gdisk}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{gdisk()}{gdisk()}}
{\footnotesize\ttfamily double gdisk (\begin{DoxyParamCaption}\item[{double}]{mass,  }\item[{double}]{mdot,  }\item[{double}]{rmin }\end{DoxyParamCaption})}



Calculate a reference gravity for the disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & mass Mass of the central object \\
\hline
\mbox{\tt in}  & {\em double} & mdot Mass accretion rate of the disk \\
\hline
\mbox{\tt in}  & {\em double} & rmin Minimum radius for the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A fiducial gravity for the disk
\end{DoxyReturn}
The gravity is needed when one constructs a disk spectrum from spectra from a grid of stellar atmospheres

The input units are all cgs

\paragraph*{Notes}

See Long \& Knigge for details 

Definition at line 189 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_a2d9e855352fbd6de6a7ed1cd79ac4a64_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_aa4eb3da682e26e1705216d977de95a0a}\label{disk_8c_aa4eb3da682e26e1705216d977de95a0a}} 
\index{disk.\+c@{disk.\+c}!geff@{geff}}
\index{geff@{geff}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{geff()}{geff()}}
{\footnotesize\ttfamily double geff (\begin{DoxyParamCaption}\item[{double}]{g0,  }\item[{double}]{x }\end{DoxyParamCaption})}



Calculate the effective gravity at a specfic position in the disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & g0 reference gravity in cm s$\ast$$\ast$-\/2 \\
\hline
\mbox{\tt in}  & {\em double} & x distance from center in units of r/rmin \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
gravity at x in cm s$\ast$$\ast$-\/2
\end{DoxyReturn}
The gravity is needed when one constructs a disk spectrum from spectra from a grid of stellar atmospheres

\paragraph*{Notes}

See Long \& Knigge for details 

Definition at line 220 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_aa4eb3da682e26e1705216d977de95a0a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_a8c6a40a92905dcccfe3f17bb046182bc}\label{disk_8c_a8c6a40a92905dcccfe3f17bb046182bc}} 
\index{disk.\+c@{disk.\+c}!qdisk\+\_\+init@{qdisk\+\_\+init}}
\index{qdisk\+\_\+init@{qdisk\+\_\+init}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{qdisk\+\_\+init()}{qdisk\_init()}}
{\footnotesize\ttfamily int qdisk\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize a structure (qdisk) for recording information about photons/energy impinging on the disk, which is stored in a disk structure called qdisk. 

\begin{DoxyReturn}{Returns}
Always return zero
\end{DoxyReturn}
\paragraph*{Notes}

The information stored in qdisk can be used to modify the effective temperature of the disk

The reason the qdisk is needed as well as disk structure is that whenever the wavelength bands are changed the radii in the disk structure are recalibratied. We want qdisk to have fixed boundaries when this happens. 

Definition at line 681 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{disk_8c_a8c6a40a92905dcccfe3f17bb046182bc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_a7c88d034953bdd81d94f7b4834f455cb}\label{disk_8c_a7c88d034953bdd81d94f7b4834f455cb}} 
\index{disk.\+c@{disk.\+c}!qdisk\+\_\+save@{qdisk\+\_\+save}}
\index{qdisk\+\_\+save@{qdisk\+\_\+save}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{qdisk\+\_\+save()}{qdisk\_save()}}
{\footnotesize\ttfamily int qdisk\+\_\+save (\begin{DoxyParamCaption}\item[{char $\ast$}]{diskfile,  }\item[{double}]{ztot }\end{DoxyParamCaption})}



Save the information in the qdisk structure to a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & $\ast$ diskfile Name of the file whihc is writteen \\
\hline
\mbox{\tt in}  & {\em double} & ztot The total luminosity of the disk as calculate over multiple cycles \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine reformats the data about disk heating which has been accumulated and writes it to a file

\paragraph*{Notes}

The data concerning heating by the disk is built up during a the ionization cycles

The file that is produced should be readable as an astropy table 

Definition at line 724 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{disk_8c_a7c88d034953bdd81d94f7b4834f455cb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{disk_8c_a7c88d034953bdd81d94f7b4834f455cb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_ada5d5c91372291204ba0255184ce1f87}\label{disk_8c_ada5d5c91372291204ba0255184ce1f87}} 
\index{disk.\+c@{disk.\+c}!read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile@{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile}}
\index{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile@{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile()}{read\_non\_standard\_disk\_profile()}}
{\footnotesize\ttfamily int read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile (\begin{DoxyParamCaption}\item[{char $\ast$}]{tprofile }\end{DoxyParamCaption})}



Read the temperature profile from a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em char} & $\ast$ tprofile Name of the input file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The input format for the file to be read in is quite spefic The first line should contina the number of points n the profile

Subsequent lines should contian a radius and a temperarue

The radius values shoule be in units of 1e11 cm The temperature should be in units of 1000K

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000020}{Bug}]This routine which was written for the Y\+SO study needs to be made less Y\+SO centric. It should also be retested.\end{DoxyRefDesc}


Definition at line 795 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_ada5d5c91372291204ba0255184ce1f87_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{disk_8c_ada5d5c91372291204ba0255184ce1f87_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b}\label{disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b}} 
\index{disk.\+c@{disk.\+c}!tdisk@{tdisk}}
\index{tdisk@{tdisk}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{tdisk()}{tdisk()}}
{\footnotesize\ttfamily double tdisk (\begin{DoxyParamCaption}\item[{double}]{m,  }\item[{double}]{mdot,  }\item[{double}]{r }\end{DoxyParamCaption})}



Calculate the reference temperarure for a standard Shakura-\/\+Sunyaeev disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & m mass of the central object \\
\hline
\mbox{\tt in}  & {\em double} & mdot mass accretion rate of the disk \\
\hline
\mbox{\tt in}  & {\em double} & r radiis of the central object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The reference temperature for the disk
\end{DoxyReturn}
All of the inputs are in cgs units

\paragraph*{Notes}

For an SS disk, The maximum temperature actuallly seen in the disk is 0.\+488 tdisk 

Definition at line 41 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_adc2a482ce6c550cd7e5498bf0ee1055b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_a3440890f45c87b4c79fef37820f87487}\label{disk_8c_a3440890f45c87b4c79fef37820f87487}} 
\index{disk.\+c@{disk.\+c}!teff@{teff}}
\index{teff@{teff}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{teff()}{teff()}}
{\footnotesize\ttfamily double teff (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{x }\end{DoxyParamCaption})}



Calculate the temperature of the disk at a normalised distance x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t reference temperature of the disk in degrees \\
\hline
\mbox{\tt in}  & {\em double} & x distance from center of disk in units of r/rmin \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The temperature
\end{DoxyReturn}
The routine returns the effective temperature for the disk as a distance which is measured in terms of the ratio of the actual distance to the inner edge of the disk (rmin).

A number of modifications to a simple steady state disk are possible, depending on the variable geo.\+disk\+\_\+tprofile\+:


\begin{DoxyItemize}
\item D\+I\+S\+K\+\_\+\+T\+P\+R\+O\+F\+I\+L\+E\+\_\+\+R\+E\+A\+D\+IN the returned temperature is interpolated from values that been read in
\item D\+I\+S\+K\+\_\+\+T\+P\+R\+O\+F\+I\+L\+E\+\_\+\+Y\+SO an analytic profile implemented for Y\+S\+Os
\end{DoxyItemize}

In addition for a standard profile, this is where disk heading can optionally be taken into account

\paragraph*{Notes}

A reference for the standard steady state disk is Wade, 1984 M\+N\+R\+AS 208, 381 

Definition at line 83 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_a3440890f45c87b4c79fef37820f87487_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_a3440890f45c87b4c79fef37820f87487_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_a29076b6a07403d62872baf4dc9bf9346}\label{disk_8c_a29076b6a07403d62872baf4dc9bf9346}} 
\index{disk.\+c@{disk.\+c}!vdisk@{vdisk}}
\index{vdisk@{vdisk}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{vdisk()}{vdisk()}}
{\footnotesize\ttfamily double vdisk (\begin{DoxyParamCaption}\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{,  }\item[{\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}}]{ }\end{DoxyParamCaption})}



Calculate the speed and velocity v at which material given specific position in the disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} A position in the disk \\
\hline
\mbox{\tt out}  & {\em double} & v\mbox{[}\mbox{]} The velocity at that position \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The speed
\end{DoxyReturn}
This routine interpolates the velocities from a grid which gives the run of velocity with radius. Although the we generally assume keplerian velocities for the disk those velocities are not calculated here.

\paragraph*{Notes}

The routine projects the input variable x on to the xy plane before it calculates velocities

It then takes the xproduct of a unit vector pointing north and the position, to determine the direction of motion at this point in the disk

Finally it rescales this to get the actual velocity. 

Definition at line 266 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{disk_8c_a29076b6a07403d62872baf4dc9bf9346_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_a29076b6a07403d62872baf4dc9bf9346_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{disk_8c_a4027a82b7c3df9474704080c8b3137cc}\label{disk_8c_a4027a82b7c3df9474704080c8b3137cc}} 
\index{disk.\+c@{disk.\+c}!zdisk@{zdisk}}
\index{zdisk@{zdisk}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{zdisk()}{zdisk()}}
{\footnotesize\ttfamily double zdisk (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



Calculate the height of the disk at a certain radius. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r a radial position in the disk. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The vertical height of the disk at that point in the xy plane.
\end{DoxyReturn}
If the disk is vertically extended then the disk surface is defined in terms of the h the fraction of the disk radius at the edge of the disk, and a power law exponent. So a disk thst us a sunoke wedgge wiykd gave an exponent of 1. A flat but thick disk would have an exponent of 0. A flared disk wouuld generally have an exponent greater than 1.

\paragraph*{Notes}

\begin{DoxyVerb}zdisk returns a number that will positive or zero, so one
often needs to take this account if for example one has
a photon that hits the disk below the z=0 plane.\end{DoxyVerb}
 

Definition at line 311 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{disk_8c_a4027a82b7c3df9474704080c8b3137cc_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{disk_8c_a9e6fe84d8cd3c84f810c729edfb8f4ac}\label{disk_8c_a9e6fe84d8cd3c84f810c729edfb8f4ac}} 
\index{disk.\+c@{disk.\+c}!diskbottom@{diskbottom}}
\index{diskbottom@{diskbottom}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{diskbottom}{diskbottom}}
{\footnotesize\ttfamily struct \hyperlink{structplane}{plane} diskplane disktop diskbottom}



Definition at line 323 of file disk.\+c.

\mbox{\Hypertarget{disk_8c_afb53135f3a02cc9e70a2cb6efd14d935}\label{disk_8c_afb53135f3a02cc9e70a2cb6efd14d935}} 
\index{disk.\+c@{disk.\+c}!ds\+\_\+to\+\_\+disk\+\_\+init@{ds\+\_\+to\+\_\+disk\+\_\+init}}
\index{ds\+\_\+to\+\_\+disk\+\_\+init@{ds\+\_\+to\+\_\+disk\+\_\+init}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+disk\+\_\+init}{ds\_to\_disk\_init}}
{\footnotesize\ttfamily int ds\+\_\+to\+\_\+disk\+\_\+init = 0}



Definition at line 321 of file disk.\+c.

\mbox{\Hypertarget{disk_8c_aad63152416eeae502d325c1b83ab88d0}\label{disk_8c_aad63152416eeae502d325c1b83ab88d0}} 
\index{disk.\+c@{disk.\+c}!ds\+\_\+to\+\_\+disk\+\_\+photon@{ds\+\_\+to\+\_\+disk\+\_\+photon}}
\index{ds\+\_\+to\+\_\+disk\+\_\+photon@{ds\+\_\+to\+\_\+disk\+\_\+photon}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+disk\+\_\+photon}{ds\_to\_disk\_photon}}
{\footnotesize\ttfamily struct \hyperlink{structphoton}{photon} ds\+\_\+to\+\_\+disk\+\_\+photon}



Definition at line 322 of file disk.\+c.

\mbox{\Hypertarget{disk_8c_afaba31659717b807b58fa7b80c4847a1}\label{disk_8c_afaba31659717b807b58fa7b80c4847a1}} 
\index{disk.\+c@{disk.\+c}!north@{north}}
\index{north@{north}!disk.\+c@{disk.\+c}}
\subsubsection{\texorpdfstring{north}{north}}
{\footnotesize\ttfamily double north\mbox{[}$\,$\mbox{]} = \{ 0.\+0, 0.\+0, 1.\+0 \}}



Definition at line 231 of file disk.\+c.

