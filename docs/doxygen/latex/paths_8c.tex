\hypertarget{paths_8c}{}\section{/\+Users/mhewitt/python/source/paths.c File Reference}
\label{paths_8c}\index{/\+Users/mhewitt/python/source/paths.\+c@{/\+Users/mhewitt/python/source/paths.\+c}}


Photon pathing functions.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for paths.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} \hyperlink{paths_8c_ac4d257a6939bcb61d002923ae8fbc1fc}{wind\+\_\+paths\+\_\+constructor} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind})
\begin{DoxyCompactList}\small\item\em Allocates the arrays for a path histogram. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a782f80aab666cb86b3a296856d1f34e6}{reverb\+\_\+init} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind})
\begin{DoxyCompactList}\small\item\em Initialises everything for reverb mapping. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a0d8a68cc8cb0e384901a71173dbc333f}{wind\+\_\+paths\+\_\+init} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind})
\begin{DoxyCompactList}\small\item\em Initialises wind path structures. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_ab2919946d2f7195f5e532eefeae7dd2d}{line\+\_\+paths\+\_\+add\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em Following a line emission, increments cell paths. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a7fe8e6139b53b931c68d444216bfd0fe}{wind\+\_\+paths\+\_\+add\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em Registers a photon passage with a wind cell. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a7719923b66bf470bc4eeb42c454ebd48}{simple\+\_\+paths\+\_\+gen\+\_\+phot} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em Generates path for a \textquotesingle{}wind\textquotesingle{} photon in photon mode. \end{DoxyCompactList}\item 
double \hyperlink{paths_8c_a43541dacfceb46c42583c31aeb11d496}{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram} (\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} Path\+Ptr)
\begin{DoxyCompactList}\small\item\em Draws a random path from a path histogram. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a176ee6debad2930212ca97a2d28794c0}{wind\+\_\+paths\+\_\+gen\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em Generates path for a wind photon. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a376d6bf65b4a156a45f28b56bc4c017d}{line\+\_\+paths\+\_\+gen\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int \hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em Generates path for a macro-\/atom line photon. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_adac039bc6269033412fa861aa78aa111}{wind\+\_\+paths\+\_\+evaluate\+\_\+single} (\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} paths)
\begin{DoxyCompactList}\small\item\em Evaluates individual wind cell paths. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a210e77beda2c9c25b9008de9107a17f8}{wind\+\_\+paths\+\_\+evaluate} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int i\+\_\+rank)
\begin{DoxyCompactList}\small\item\em Evaluates wind path details for a cycle. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_acfc3937b157db869057d3f33613b2e87}{wind\+\_\+paths\+\_\+dump} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int \hyperlink{python_8h_a48632b55b333d2627f6a1ddd87b3d7ea}{rank\+\_\+global})
\begin{DoxyCompactList}\small\item\em Dumps wind path arrays for a wind cell. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_abcd463073ed7efc165937715a983b7b7}{wind\+\_\+paths\+\_\+output\+\_\+dump} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int i\+\_\+rank)
\begin{DoxyCompactList}\small\item\em Iterates through the wind, dumping cells of interest. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_a84734785aa6884b89825ac2b84ad5f54}{wind\+\_\+paths\+\_\+point\+\_\+index} (int \hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, int k, int i\+\_\+top, \hyperlink{python_8h_ae022cd774d7ee369fc758eff33990847}{Domain\+Ptr} dom)
\begin{DoxyCompactList}\small\item\em Given trz index in wind, returns vtk data index. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_afd823b3b0d87b9378a04d10604a29cf1}{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index} (int \hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, int k)
\begin{DoxyCompactList}\small\item\em Given rtt index in wind, returns vtk data index. \end{DoxyCompactList}\item 
int \hyperlink{paths_8c_ad7572cd8c842aa9c3ee2476a89888ec4}{wind\+\_\+paths\+\_\+output\+\_\+vtk} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int ndom)
\begin{DoxyCompactList}\small\item\em Outputs wind path information to vtk. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double $\ast$ \hyperlink{paths_8c_a6ef8f0bed45003c4daa91a72735e1979}{reverb\+\_\+path\+\_\+bin}
\begin{DoxyCompactList}\small\item\em Array of path bin boundaries. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Photon pathing functions. 

\begin{DoxyAuthor}{Author}
S\+WM 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
July, 2015 File containing photon path tracking functions. 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{paths_8c_ab2919946d2f7195f5e532eefeae7dd2d}\label{paths_8c_ab2919946d2f7195f5e532eefeae7dd2d}} 
\index{paths.\+c@{paths.\+c}!line\+\_\+paths\+\_\+add\+\_\+phot@{line\+\_\+paths\+\_\+add\+\_\+phot}}
\index{line\+\_\+paths\+\_\+add\+\_\+phot@{line\+\_\+paths\+\_\+add\+\_\+phot}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{line\+\_\+paths\+\_\+add\+\_\+phot()}{line\_paths\_add\_phot()}}
{\footnotesize\ttfamily int line\+\_\+paths\+\_\+add\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int $\ast$}]{nres }\end{DoxyParamCaption})}



Following a line emission, increments cell paths. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind cell to register photon in. \\
\hline
\mbox{\tt in}  & {\em pp} & Photon to register in wind cell \\
\hline
\mbox{\tt in}  & {\em nres} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
When given a wind cell and photon info in matom mode, iterates over the list of tracked lines to see if the transition is in it. If so adds the weight to the path array for that line.

\paragraph*{Notes}

27/2/15 -\/ Written by S\+WM 

Definition at line 212 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{paths_8c_ab2919946d2f7195f5e532eefeae7dd2d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a376d6bf65b4a156a45f28b56bc4c017d}\label{paths_8c_a376d6bf65b4a156a45f28b56bc4c017d}} 
\index{paths.\+c@{paths.\+c}!line\+\_\+paths\+\_\+gen\+\_\+phot@{line\+\_\+paths\+\_\+gen\+\_\+phot}}
\index{line\+\_\+paths\+\_\+gen\+\_\+phot@{line\+\_\+paths\+\_\+gen\+\_\+phot}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{line\+\_\+paths\+\_\+gen\+\_\+phot()}{line\_paths\_gen\_phot()}}
{\footnotesize\ttfamily int line\+\_\+paths\+\_\+gen\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int}]{nres }\end{DoxyParamCaption})}



Generates path for a macro-\/atom line photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind cell to spawn in \\
\hline
\mbox{\tt in,out}  & {\em pp} & Photon to set path of  \mbox{[}in\mbox{]} nres Matom line to generate for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
If the line is being tracked, pick a random path from its path histogram. If not, default to the regular path histogram.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a43541dacfceb46c42583c31aeb11d496}{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram()} 

\hyperlink{paths_8c_a7719923b66bf470bc4eeb42c454ebd48}{simple\+\_\+paths\+\_\+gen\+\_\+phot()} 

\hyperlink{paths_8c_a176ee6debad2930212ca97a2d28794c0}{wind\+\_\+paths\+\_\+gen\+\_\+phot()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 433 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a376d6bf65b4a156a45f28b56bc4c017d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=281pt]{paths_8c_a376d6bf65b4a156a45f28b56bc4c017d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a43541dacfceb46c42583c31aeb11d496}\label{paths_8c_a43541dacfceb46c42583c31aeb11d496}} 
\index{paths.\+c@{paths.\+c}!r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram@{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram}}
\index{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram@{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram()}{r\_draw\_from\_path\_histogram()}}
{\footnotesize\ttfamily double r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr}}]{Path\+Ptr }\end{DoxyParamCaption})}



Draws a random path from a path histogram. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Path\+Ptr} & Path histogram pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Path
\end{DoxyReturn}
Picks a random path bin, weighted by the flux in each in this cell, then assigns a path from within that bin (from a uniform random distribution)

\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 346 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=302pt]{paths_8c_a43541dacfceb46c42583c31aeb11d496_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{paths_8c_a43541dacfceb46c42583c31aeb11d496_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a782f80aab666cb86b3a296856d1f34e6}\label{paths_8c_a782f80aab666cb86b3a296856d1f34e6}} 
\index{paths.\+c@{paths.\+c}!reverb\+\_\+init@{reverb\+\_\+init}}
\index{reverb\+\_\+init@{reverb\+\_\+init}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{reverb\+\_\+init()}{reverb\_init()}}
{\footnotesize\ttfamily int reverb\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind }\end{DoxyParamCaption})}



Initialises everything for reverb mapping. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Top-\/level wind cell array \\
\hline
\mbox{\tt in}  & {\em nangles} & Number of observers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Reports back to user the reverb mode running, and then calls the appropriate setup routines.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a0d8a68cc8cb0e384901a71173dbc333f}{wind\+\_\+paths\+\_\+init()}
\end{DoxySeeAlso}
\paragraph*{Notes}

3/15 -\/ Written by S\+WM 

Definition at line 86 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a782f80aab666cb86b3a296856d1f34e6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=250pt]{paths_8c_a782f80aab666cb86b3a296856d1f34e6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a7719923b66bf470bc4eeb42c454ebd48}\label{paths_8c_a7719923b66bf470bc4eeb42c454ebd48}} 
\index{paths.\+c@{paths.\+c}!simple\+\_\+paths\+\_\+gen\+\_\+phot@{simple\+\_\+paths\+\_\+gen\+\_\+phot}}
\index{simple\+\_\+paths\+\_\+gen\+\_\+phot@{simple\+\_\+paths\+\_\+gen\+\_\+phot}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{simple\+\_\+paths\+\_\+gen\+\_\+phot()}{simple\_paths\_gen\_phot()}}
{\footnotesize\ttfamily int simple\+\_\+paths\+\_\+gen\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



Generates path for a \textquotesingle{}wind\textquotesingle{} photon in photon mode. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em pp} & Photon to set path of \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Finds the straight-\/line distance between photon and the outer star radius, sets minimum path to that. Used in photon mode, and in all modes for non-\/wind starting paths.

\paragraph*{Notes}

20/8/15 -\/ Written by S\+WM 

Definition at line 324 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{paths_8c_a7719923b66bf470bc4eeb42c454ebd48_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a7719923b66bf470bc4eeb42c454ebd48_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a7fe8e6139b53b931c68d444216bfd0fe}\label{paths_8c_a7fe8e6139b53b931c68d444216bfd0fe}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+add\+\_\+phot@{wind\+\_\+paths\+\_\+add\+\_\+phot}}
\index{wind\+\_\+paths\+\_\+add\+\_\+phot@{wind\+\_\+paths\+\_\+add\+\_\+phot}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+add\+\_\+phot()}{wind\_paths\_add\_phot()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+add\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



Registers a photon passage with a wind cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind cell to register photon in. \\
\hline
\mbox{\tt in}  & {\em pp} & Photon to register in wind cell. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
When given a wind cell and photon, adds the photon\textquotesingle{}s weight to the appropriate delay bin.

\paragraph*{Notes}

27/2/15 -\/ Written by S\+WM 2/15. 

Definition at line 273 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a7fe8e6139b53b931c68d444216bfd0fe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_ac4d257a6939bcb61d002923ae8fbc1fc}\label{paths_8c_ac4d257a6939bcb61d002923ae8fbc1fc}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+constructor@{wind\+\_\+paths\+\_\+constructor}}
\index{wind\+\_\+paths\+\_\+constructor@{wind\+\_\+paths\+\_\+constructor}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+constructor()}{wind\_paths\_constructor()}}
{\footnotesize\ttfamily \hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} wind\+\_\+paths\+\_\+constructor (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind }\end{DoxyParamCaption})}



Allocates the arrays for a path histogram. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Pointer to parent wind cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to onstructed histogram
\end{DoxyReturn}
Allocates path bins for a passed wind cell and returns a pointer to the allocated space.

\paragraph*{Notes}

9/3/15 -\/ Written by S\+WM 

Definition at line 42 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_ac4d257a6939bcb61d002923ae8fbc1fc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_ac4d257a6939bcb61d002923ae8fbc1fc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_acfc3937b157db869057d3f33613b2e87}\label{paths_8c_acfc3937b157db869057d3f33613b2e87}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+dump@{wind\+\_\+paths\+\_\+dump}}
\index{wind\+\_\+paths\+\_\+dump@{wind\+\_\+paths\+\_\+dump}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+dump()}{wind\_paths\_dump()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+dump (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{rank\+\_\+global }\end{DoxyParamCaption})}



Dumps wind path arrays for a wind cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind cell to dump \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Outputs a file \char`\"{}root.\+wind\+\_\+paths\+\_\+\mbox{[}nwind\mbox{]}.\+csv\char`\"{} containing the path length bins and total flux in each for each line histogram (and the regular wind histogram) in the given cell.

\paragraph*{Notes}

10/15 -\/ Written by S\+WM 

Definition at line 582 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_acfc3937b157db869057d3f33613b2e87_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a210e77beda2c9c25b9008de9107a17f8}\label{paths_8c_a210e77beda2c9c25b9008de9107a17f8}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+evaluate@{wind\+\_\+paths\+\_\+evaluate}}
\index{wind\+\_\+paths\+\_\+evaluate@{wind\+\_\+paths\+\_\+evaluate}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+evaluate()}{wind\_paths\_evaluate()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+evaluate (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{i\+\_\+rank }\end{DoxyParamCaption})}



Evaluates wind path details for a cycle. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind to evaluate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Iterates over each cell in the wind.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_adac039bc6269033412fa861aa78aa111}{wind\+\_\+paths\+\_\+evaluate\+\_\+single()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 533 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a210e77beda2c9c25b9008de9107a17f8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=285pt]{paths_8c_a210e77beda2c9c25b9008de9107a17f8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_adac039bc6269033412fa861aa78aa111}\label{paths_8c_adac039bc6269033412fa861aa78aa111}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+evaluate\+\_\+single@{wind\+\_\+paths\+\_\+evaluate\+\_\+single}}
\index{wind\+\_\+paths\+\_\+evaluate\+\_\+single@{wind\+\_\+paths\+\_\+evaluate\+\_\+single}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+evaluate\+\_\+single()}{wind\_paths\_evaluate\_single()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+evaluate\+\_\+single (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr}}]{paths }\end{DoxyParamCaption})}



Evaluates individual wind cell paths. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind cell to evaluate\\
\hline
\end{DoxyParams}
Records the total flux in the cell, as well as making a simple \textquotesingle{}average path\textquotesingle{} calculation.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a210e77beda2c9c25b9008de9107a17f8}{wind\+\_\+paths\+\_\+evaluate()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 495 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=290pt]{paths_8c_adac039bc6269033412fa861aa78aa111_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a176ee6debad2930212ca97a2d28794c0}\label{paths_8c_a176ee6debad2930212ca97a2d28794c0}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+gen\+\_\+phot@{wind\+\_\+paths\+\_\+gen\+\_\+phot}}
\index{wind\+\_\+paths\+\_\+gen\+\_\+phot@{wind\+\_\+paths\+\_\+gen\+\_\+phot}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+gen\+\_\+phot()}{wind\_paths\_gen\_phot()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+gen\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



Generates path for a wind photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind cell to spawn in \\
\hline
\mbox{\tt in,out}  & {\em pp} & Photon to set path of \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Picks a random path bin, weighted by the flux in each in this cell, then assigns a path from within that bin (from a uniform random distribution)

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a43541dacfceb46c42583c31aeb11d496}{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram()} 

\hyperlink{paths_8c_a7719923b66bf470bc4eeb42c454ebd48}{simple\+\_\+paths\+\_\+gen\+\_\+phot()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 392 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a176ee6debad2930212ca97a2d28794c0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a176ee6debad2930212ca97a2d28794c0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a0d8a68cc8cb0e384901a71173dbc333f}\label{paths_8c_a0d8a68cc8cb0e384901a71173dbc333f}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+init@{wind\+\_\+paths\+\_\+init}}
\index{wind\+\_\+paths\+\_\+init@{wind\+\_\+paths\+\_\+init}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+init()}{wind\_paths\_init()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind }\end{DoxyParamCaption})}



Initialises wind path structures. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Top-\/level wind cell array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Iterates over each wind cell, and declares a single generic \textquotesingle{}wind path\textquotesingle{} array for binning the paths of incident photons in. Also declares a \textquotesingle{}wind path\textquotesingle{} array for each specific line of interest in matom mode.

\paragraph*{Notes}

10/2/15 -\/ Written by S\+WM 

Definition at line 179 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a0d8a68cc8cb0e384901a71173dbc333f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{paths_8c_a0d8a68cc8cb0e384901a71173dbc333f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_abcd463073ed7efc165937715a983b7b7}\label{paths_8c_abcd463073ed7efc165937715a983b7b7}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+output\+\_\+dump@{wind\+\_\+paths\+\_\+output\+\_\+dump}}
\index{wind\+\_\+paths\+\_\+output\+\_\+dump@{wind\+\_\+paths\+\_\+output\+\_\+dump}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+output\+\_\+dump()}{wind\_paths\_output\_dump()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+output\+\_\+dump (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{i\+\_\+rank }\end{DoxyParamCaption})}



Iterates through the wind, dumping cells of interest. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind array to dump from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Outputs a file \char`\"{}root.\+ngrid.\+csv\char`\"{} containing the path length bins and total flux in each for each line histogram (and the regular wind histogram) in the given cell.

\paragraph*{Notes}

10/15 -\/ Written by S\+WM 

Definition at line 640 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{paths_8c_abcd463073ed7efc165937715a983b7b7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{paths_8c_abcd463073ed7efc165937715a983b7b7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_ad7572cd8c842aa9c3ee2476a89888ec4}\label{paths_8c_ad7572cd8c842aa9c3ee2476a89888ec4}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+output\+\_\+vtk@{wind\+\_\+paths\+\_\+output\+\_\+vtk}}
\index{wind\+\_\+paths\+\_\+output\+\_\+vtk@{wind\+\_\+paths\+\_\+output\+\_\+vtk}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+output\+\_\+vtk()}{wind\_paths\_output\_vtk()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+output\+\_\+vtk (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Outputs wind path information to vtk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Pointer to wind array. \\
\hline
\mbox{\tt in}  & {\em c\+\_\+file\+\_\+in} & Name of input file. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
When given a wind containing position and delay map information generated using R\+E\+V\+E\+R\+B\+\_\+\+W\+I\+ND, outputs a 3d model of the wind to file in A\+S\+C\+II .vtk format.

\paragraph*{Notes\#\#\# Written by S\+WM 4/15.}

Definition at line 728 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_ad7572cd8c842aa9c3ee2476a89888ec4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{paths_8c_ad7572cd8c842aa9c3ee2476a89888ec4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_a84734785aa6884b89825ac2b84ad5f54}\label{paths_8c_a84734785aa6884b89825ac2b84ad5f54}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+point\+\_\+index}}
\index{wind\+\_\+paths\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+point\+\_\+index}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+point\+\_\+index()}{wind\_paths\_point\_index()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+point\+\_\+index (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{int}]{k,  }\item[{int}]{i\+\_\+top,  }\item[{\hyperlink{python_8h_ae022cd774d7ee369fc758eff33990847}{Domain\+Ptr}}]{dom }\end{DoxyParamCaption})}



Given trz index in wind, returns vtk data index. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em i} & Theta index of cell. \\
\hline
\mbox{\tt in}  & {\em j} & Radius index of cell. \\
\hline
\mbox{\tt in}  & {\em k} & Height index of cell. \\
\hline
\mbox{\tt in}  & {\em i\+\_\+top} & Whether the point is above or below the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Index for vtk poly.
\end{DoxyReturn}
When given the position of a cell in the wind, returns the corresponding index in the flat V\+TK data arrays. RZ uses the uses the standard wind location, theta is set as defined in geo. Used in wind\+\_\+paths\+\_\+output() only.

\paragraph*{Notes\#\#\# Written by S\+WM 4/15.}

Definition at line 681 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_a84734785aa6884b89825ac2b84ad5f54_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{paths_8c_afd823b3b0d87b9378a04d10604a29cf1}\label{paths_8c_afd823b3b0d87b9378a04d10604a29cf1}} 
\index{paths.\+c@{paths.\+c}!wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index}}
\index{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index()}{wind\_paths\_sphere\_point\_index()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{int}]{k }\end{DoxyParamCaption})}



Given rtt index in wind, returns vtk data index. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em i} & Theta index of cell. \\
\hline
\mbox{\tt in}  & {\em j} & Radius index of cell. \\
\hline
\mbox{\tt in}  & {\em k} & Height index of cell. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Index for vtk poly.
\end{DoxyReturn}
When given the position of a cell in the wind, returns the corresponding index in the flat V\+TK data arrays. RZ uses the uses the standard wind location, theta is set as defined in geo. Used in wind\+\_\+paths\+\_\+output() only.

\paragraph*{Notes\#\#\# Written by S\+WM 4/15.}

Definition at line 705 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{paths_8c_afd823b3b0d87b9378a04d10604a29cf1_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{paths_8c_a6ef8f0bed45003c4daa91a72735e1979}\label{paths_8c_a6ef8f0bed45003c4daa91a72735e1979}} 
\index{paths.\+c@{paths.\+c}!reverb\+\_\+path\+\_\+bin@{reverb\+\_\+path\+\_\+bin}}
\index{reverb\+\_\+path\+\_\+bin@{reverb\+\_\+path\+\_\+bin}!paths.\+c@{paths.\+c}}
\subsubsection{\texorpdfstring{reverb\+\_\+path\+\_\+bin}{reverb\_path\_bin}}
{\footnotesize\ttfamily $\ast$double reverb\+\_\+path\+\_\+bin}



Array of path bin boundaries. 

Set in \hyperlink{paths_8c_a782f80aab666cb86b3a296856d1f34e6}{reverb\+\_\+init()}, contains the boundaries for each path bin.

\paragraph*{Notes}

10/15 -\/ Written by S\+WM 

Definition at line 26 of file paths.\+c.

