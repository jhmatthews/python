\hypertarget{templates_8h}{}\section{/\+Users/mhewitt/python/source/templates.h File Reference}
\label{templates_8h}\index{/\+Users/mhewitt/python/source/templates.\+h@{/\+Users/mhewitt/python/source/templates.\+h}}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{templates_8h_a5f832b1ef434fdb41eaa62feb7edd710}{planck} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a6bae7f74815dfcf783a7dafade8faeca}{get\+\_\+rand\+\_\+pow} (double \hyperlink{compton_8c_ac75b803b570527306e1e744bfb7a604f}{x1}, double x2, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em obtains a random number between x1 and x2 for a power law densiity distribution with index alpha \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af2d9c9e4094a425824f269ef22163048}{get\+\_\+rand\+\_\+exp} (double alpha\+\_\+min, double alpha\+\_\+max)
\begin{DoxyCompactList}\small\item\em obtain a random number between alpha\+\_\+min and alpha\+\_\+max from an distribution of the form e$\ast$$\ast$-\/alpha \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af5c48487242ab8760a1893e385d3e11b}{integ\+\_\+planck\+\_\+d} (double \hyperlink{bb_8c_a35106e779db1ad64f0de4eec449ec129}{alphamin}, double \hyperlink{bb_8c_af21e1955cd413e7edbe9c2a4fe822282}{alphamax})
\begin{DoxyCompactList}\small\item\em Obtains the integral of the dimensionless blackbody function between alphamin and alphamax. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a6260aa06c4ed5ec3e59026a65ce5194d}{init\+\_\+integ\+\_\+planck\+\_\+d} (void)
\begin{DoxyCompactList}\small\item\em calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in an array used by integ\+\_\+plank\+\_\+d \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ad6196c3c4ec0bdeda06aa797af259d81}{planck\+\_\+d} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em The value of the dimensioless BB function at alpha. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a337db7e010442d30f7c4b45f3e41fa5c}{emittance\+\_\+bb} (double freqmin, double freqmax, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Calculate the emittance of a bb between freqmin and freqmax. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a11871d7df7f3167db92bef8c8ef98926}{check\+\_\+fmax} (double fmin, double fmax, double temp)
\begin{DoxyCompactList}\small\item\em decides whether a maximum frequency requested for an integral is sensible. If it is too far off the end of the planck function, qromb will malfunction. We just have to set it to a frequency where the BB function is tiny, say where hnu/kT =100. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8842598a01e45263815fd1e6d67ca8d6}{get\+\_\+atomic\+\_\+data} (char masterfile\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_af2bf62098e21f43ec0e2cdfc378d447c}{index\+\_\+lines} (void)
\begin{DoxyCompactList}\small\item\em sort the lines into frequency order \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a86b680cbcd546a5f06c86c6805fc91c9}{index\+\_\+phot\+\_\+top} (void)
\begin{DoxyCompactList}\small\item\em Index the topbase photoionzation crossections by frequency. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a129463b5d8256593b8bdce5bf207a079}{index\+\_\+inner\+\_\+cross} (void)
\begin{DoxyCompactList}\small\item\em Index inner shell xsections in frequency order. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a3d71a4823d0ecd3c4b591d8da3bd63a7}{index\+\_\+collisions} (void)
\begin{DoxyCompactList}\small\item\em sorts the collisional lines into frequency order \end{DoxyCompactList}\item 
void \hyperlink{templates_8h_adc5c07bccdca8cfce32214f15cfc76aa}{indexx} (int n, float arrin\mbox{[}$\,$\mbox{]}, int indx\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a8cf338374390539709c962c60a953c3d}{limit\+\_\+lines} (double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em (freqmin,freqmax) sets the the current values of line\+\_\+min and line\+\_\+max in \hyperlink{atomic_8h}{atomic.\+h} which can be used to limit the lines searched for resonances to a specific frequency range. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_afa8b5c03286c90c5365b874967e81b33}{check\+\_\+xsections} (void)
\begin{DoxyCompactList}\small\item\em Perform sanity checks on xsection data. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a0ddf1224851353fc92bfbff6f499fa97}{main} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8}{translate} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, double tau\+\_\+scat, double $\ast$tau, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em a steering routine that either calls \+\_\+in\+\_\+space or \+\_\+in\+\_\+wind depending upon the current location of the photon. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa1ffd17034054d51819328d892fc57e8}{translate\+\_\+in\+\_\+space} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em translates the photon from its current position to the edge of the wind. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a8bc3604c533b18b872bb155bfd444bb5}{ds\+\_\+to\+\_\+wind} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int $\ast$ndom\+\_\+current)
\begin{DoxyCompactList}\small\item\em calculates the photon pathlength to the edge of the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a0118547dede9b08b5ac6609b4313e3e8}{translate\+\_\+in\+\_\+wind} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double tau\+\_\+scat, double $\ast$tau, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em translates the photon within a single cell in the wind. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_afee395233fbca5e632fd3ef51106f74c}{ds\+\_\+in\+\_\+cell} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em calculates the distance photon can travel within the cell that it is currently in. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_acb71ca3a7e18d652d5eb0df69766c022}{walls} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pold, double $\ast$normal)
\begin{DoxyCompactList}\small\item\em determines whether the photon has encountered the star of disk or reached the edges of the grid and returns the appropriate tatus. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa943bd857500a1f2937d8b97d84ff633}{define\+\_\+phot} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double f1, double f2, long nphot\+\_\+tot, int ioniz\+\_\+or\+\_\+final, int iwind, int freq\+\_\+sampling)
\begin{DoxyCompactList}\small\item\em the controlling routine for creating the underlying photon distribution. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_addfbba966a4d69bdc71b771e0d7f3cdf}{populate\+\_\+bands} (double f1, double f2, int ioniz\+\_\+or\+\_\+final, int iwind, struct \hyperlink{structxbands}{xbands} $\ast$band)
\begin{DoxyCompactList}\small\item\em Determine how many photons to allocate to each band. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a9a0acf2d461c665dc0302defa95ded65}{xdefine\+\_\+phot} (double f1, double f2, int ioniz\+\_\+or\+\_\+final, int iwind)
\begin{DoxyCompactList}\small\item\em calculates the band limited fluxes \& luminosities, and prepares for the producting of photons (by reinitializing the disk, among other things). \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ab7f1c9362f29a0b44f41cff21494b6df}{xmake\+\_\+phot} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double f1, double f2, int ioniz\+\_\+or\+\_\+final, int iwind, double weight, int iphot\+\_\+start, int nphotons)
\begin{DoxyCompactList}\small\item\em just makes photons \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a0bc15d347d507f21da65e37f659de349}{star\+\_\+init} (double freqmin, double freqmax, int ioniz\+\_\+or\+\_\+final, double $\ast$f)
\begin{DoxyCompactList}\small\item\em (r, tstar, freqmin, freqmax, ioniz\+\_\+or\+\_\+final, f) \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a19e1b27b1fe040ccadcd39a5783c4d60}{photo\+\_\+gen\+\_\+star} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double weight, double f1, double f2, int spectype, int istart, int nphot)
\begin{DoxyCompactList}\small\item\em Generate nphot photons from the star in the frequency interval f1 to f2. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a3c3ee1b7657b6c1bc4e6c1e6d8300020}{disk\+\_\+init} (double rmin, double rmax, double m, double mdot, double freqmin, double freqmax, int ioniz\+\_\+or\+\_\+final, double $\ast$ftot)
\begin{DoxyCompactList}\small\item\em calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk. More importantly divides the disk into annulae such that each annulus contributes and equal amount to the lumionosity of the disk (within the frequency limits). Thus initializes the structure \char`\"{}disk\char`\"{}. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ac6e59fd8ed9979322e86a14ed34c2851}{photo\+\_\+gen\+\_\+disk} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double weight, double f1, double f2, int spectype, int istart, int nphot)
\begin{DoxyCompactList}\small\item\em Generate disk photons. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8b4486eb9a59ffa30a219586ef94b56c}{phot\+\_\+gen\+\_\+sum} (char filename\mbox{[}$\,$\mbox{]}, char mode\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_afb47deaf80a8f3a6f07ab91d843d960e}{bl\+\_\+init} (double lum\+\_\+bl, double t\+\_\+bl, double freqmin, double freqmax, int ioniz\+\_\+or\+\_\+final, double $\ast$f)
\begin{DoxyCompactList}\small\item\em calculate parameters need to intialize the boundary layer (namely the band-\/liminted luminoisity) \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a663f46d36d6962c7993e4c002442c23b}{photon\+\_\+checks} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double freqmin, double freqmax, char $\ast$comment)
\begin{DoxyCompactList}\small\item\em Perform some simple checks on the photon distribution just produced. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa181995d7df5c31711c06ff2657f2f29}{parse\+\_\+command\+\_\+line} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a03418403841ff39e520854f4c830339f}{help} (void)
\begin{DoxyCompactList}\small\item\em print out some basic help concering command line options for the program \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a63d5795e0b9978d33ed61a63917004e2}{nebular\+\_\+concentrations} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the Wind\+Ptr itself, such as t\+\_\+r, t\+\_\+e, w, based on the \char`\"{}mode\char`\"{}. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a96f3f44cc5cf473ca91ca268747dfba1}{concentrations} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptions about what to use for the temperature Saha equantion. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a16363b5cd764e733bd84a0d991cb6568}{saha} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double ne, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Calculate the densities for all of the ions in a single cell given ne and t. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa8ede21a14cf7e763909094555c5240d}{lucy} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances contained in xplasma. It thus assumes that \hyperlink{saha_8c_a16363b5cd764e733bd84a0d991cb6568}{saha()} has been called before it, in the concentrations routine. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ae57f2f019f9e768eecf4132a64e93ef2}{lucy\+\_\+mazzali1} (double nh, double t\+\_\+r, double t\+\_\+e, double www, int nelem, double ne, double density\mbox{[}$\,$\mbox{]}, double xne, double newden\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ad350a11e70a4518fb86b842942575e26}{fix\+\_\+concentrations} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em sets the concentrations of individual ions assuming hard coded ionization fractions that are read from a file \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a573805cfa8fb135c23fc2f9e97dcf687}{get\+\_\+ne} (double density\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a4dfd9797e2dca42842f8082b5f8e96c4}{spectrum\+\_\+init} (double f1, double f2, int nangle, double angle\mbox{[}$\,$\mbox{]}, double phase\mbox{[}$\,$\mbox{]}, int scat\+\_\+select\mbox{[}$\,$\mbox{]}, int top\+\_\+bot\+\_\+select\mbox{[}$\,$\mbox{]}, int select\+\_\+extract, double rho\+\_\+select\mbox{[}$\,$\mbox{]}, double z\+\_\+select\mbox{[}$\,$\mbox{]}, double az\+\_\+select\mbox{[}$\,$\mbox{]}, double r\+\_\+select\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a3e05df283bba500d0e7a307679b291d6}{spectrum\+\_\+create} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double f1, double f2, int nangle, int select\+\_\+extract)
\begin{DoxyCompactList}\small\item\em Increments the spectrum arrays after each flight of photons is processed (during ionization cycles and for detailed spectra in the Live or Die option). \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8e643e0881e482c11120d32f41ff00c0}{spectrum\+\_\+summary} (char filename\mbox{[}$\,$\mbox{]}, int nspecmin, int nspecmax, int select\+\_\+spectype, double \hyperlink{vvector_8c_a8f009c8e40535ce9122cb90112b6e88c}{renorm}, int loglin, int iwind)
\item 
int \hyperlink{templates_8h_a6d37ca5473b25832956cb6988e1b4ed5}{spectrum\+\_\+restart\+\_\+renormalise} (int nangle)
\begin{DoxyCompactList}\small\item\em renormalizes the detailed spectra in case of a restart \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a27671483c230bf332cc2286dbfa6c4be}{define\+\_\+wind} (void)
\begin{DoxyCompactList}\small\item\em initializes the structures which characterize the wind, including wmain and plasmamain. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1db4ad38f132371d7fe31fdd998ae53e}{where\+\_\+in\+\_\+grid} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a0063dc1e42150aa43a80ac17e3070b66}{vwind\+\_\+xyz} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ad47569135f21d4ce22504b0ad5b0b221}{wind\+\_\+div\+\_\+v} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\item 
double \hyperlink{templates_8h_aa91d5abc6118522c3cff7b67e6275d3e}{rho} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a558bbf4d12656ab12c2a03f6475b0eee}{mdot\+\_\+wind} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, double \hyperlink{import__cylindrical_8c_a136f2755339206755ab0c02f8e53c5fc}{z}, double rmax)
\item 
int \hyperlink{templates_8h_a55dba11eab85fa51b5bbf621a3c66b57}{get\+\_\+random\+\_\+location} (int n, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a055c7dce44e704928680abae7b7aa684}{zero\+\_\+scatters} (void)
\begin{DoxyCompactList}\small\item\em zero out the portion of plasmamain that records the number of scatters in each cell \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a80e38cc8054ee669104c30986700d508}{check\+\_\+corners\+\_\+inwind} (int n)
\begin{DoxyCompactList}\small\item\em The routine basically just calls where\+\_\+in\+\_\+wind for each of the 4 corners of the cell. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a850c8c06e8a1481921582559b0bd2cf1}{check\+\_\+grid} (void)
\begin{DoxyCompactList}\small\item\em check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might wish to have smaller grid cells \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a2c852998cd074100b68f8750a8d8ca99}{where\+\_\+in\+\_\+wind} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, int $\ast$ndomain)
\item 
double \hyperlink{templates_8h_a9ca1dd624c5f0c6c8a401a0e79d023b5}{model\+\_\+velocity} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a547dbd45aa816e77d574b6bf3deb6b65}{model\+\_\+vgrad} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double v\+\_\+grad\mbox{[}$\,$\mbox{]}\mbox{[}3\mbox{]})
\item 
double \hyperlink{templates_8h_a3055ceed3869697bc2a3091fd0663900}{model\+\_\+rho} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_aa5de177d6e8fc4d6d0becf0c2898b90d}{wind\+\_\+check} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} www, int n)
\begin{DoxyCompactList}\small\item\em Simple checks of the wind structure for reasonability. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a284ee938adda5964f70e57cf3517bb93}{dot} (double a\mbox{[}$\,$\mbox{]}, double b\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a779ccebed86e21a9d217673baf5da757}{length} (double a\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ab14e3dce54237244859ed06cef6b5846}{renorm} (double a\mbox{[}$\,$\mbox{]}, double scalar)
\item 
int \hyperlink{templates_8h_a5acc98b72071d64f02e15f4975d03eb2}{cross} (double a\mbox{[}$\,$\mbox{]}, double b\mbox{[}$\,$\mbox{]}, double c\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a121f213b4ad36619461deebbea325e66}{vmove} (double u\mbox{[}$\,$\mbox{]}, double lmn\mbox{[}$\,$\mbox{]}, double s, double result\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a3b474f3933aeab1276e52e7ed441dfc1}{vsub} (double u\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]}, double result\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a47e5844ec76c800f7868e793e5d8364a}{vadd} (double u\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]}, double result\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a917f837a1598fc3307b17cceef5f4340}{stuff\+\_\+v} (double vin\mbox{[}$\,$\mbox{]}, double vout\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_aaee8af7ddccdd146566ebd8daa39b982}{dot\+\_\+tensor\+\_\+vec} (double tensor\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}, double vin\mbox{[}3\mbox{]}, double vout\mbox{[}3\mbox{]})
\item 
int \hyperlink{templates_8h_ad69e520ff4f237809642951e68cc645b}{project\+\_\+from\+\_\+xyz\+\_\+cyl} (double a\mbox{[}$\,$\mbox{]}, double b\mbox{[}$\,$\mbox{]}, double result\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a2252a3d2a1a36fbe8bef311e90ffd171}{project\+\_\+from\+\_\+cyl\+\_\+xyz} (double a\mbox{[}$\,$\mbox{]}, double b\mbox{[}$\,$\mbox{]}, double result\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ab0b1a9d790b71c94f9562c567eeee268}{create\+\_\+basis} (double u\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]}, struct \hyperlink{structbasis}{basis} $\ast$basis\+\_\+new)
\item 
int \hyperlink{templates_8h_a5672a43b959d7e6d398852cbc41ee6b1}{project\+\_\+from} (struct \hyperlink{structbasis}{basis} $\ast$basis\+\_\+from, double v\+\_\+in\mbox{[}$\,$\mbox{]}, double v\+\_\+out\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a6b58ffdfc9f610023bb61f333894caf4}{project\+\_\+to} (struct \hyperlink{structbasis}{basis} $\ast$basis\+\_\+from, double v\+\_\+in\mbox{[}$\,$\mbox{]}, double v\+\_\+out\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a85ea3570f6a740c495a6996fd1acea6e}{reorient} (struct \hyperlink{structbasis}{basis} $\ast$basis\+\_\+from, struct \hyperlink{structbasis}{basis} $\ast$basis\+\_\+to, double v\+\_\+from\mbox{[}$\,$\mbox{]}, double v\+\_\+to\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a3521f91b62531265426401a6c32fa93f}{qromb} (double($\ast$func)(double), double a, double b, double eps)
\begin{DoxyCompactList}\small\item\em Integrate a function between a and b. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a48cdc1c9e874cf04a9ba2eef8990e5d4}{trapzd} (double($\ast$func)(double), double a, double b, int n)
\item 
void \hyperlink{templates_8h_a9e781dcc9df20e8b93139c48b5627be1}{polint} (double xa\mbox{[}$\,$\mbox{]}, double ya\mbox{[}$\,$\mbox{]}, int n, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double $\ast$y, double $\ast$dy)
\item 
double \hyperlink{templates_8h_a8c30fbf58d7a0b5789604f00c96bedb6}{zbrent} (double($\ast$func)(double), double \hyperlink{compton_8c_ac75b803b570527306e1e744bfb7a604f}{x1}, double x2, double tol)
\begin{DoxyCompactList}\small\item\em A routine that finds the rooot of a function f. \end{DoxyCompactList}\item 
double $\ast$ \hyperlink{templates_8h_a5d898a3431abba975dde87769e1ad49c}{vector} (int \hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j})
\item 
void \hyperlink{templates_8h_a892b60c229b8cc4fbc4187ee0cb88e1f}{free\+\_\+vector} (double $\ast$a, int \hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j})
\item 
double \hyperlink{templates_8h_aabcf91dd6a4e633b1beb48978f9a71c1}{rtsafe} (void($\ast$funcd)(double, double $\ast$, double $\ast$), double \hyperlink{compton_8c_ac75b803b570527306e1e744bfb7a604f}{x1}, double x2, double xacc)
\begin{DoxyCompactList}\small\item\em A routine that mimimizes a function f. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aac9129f52275f2d4c2469699cbcf3833}{golden} (double ax, double bx, double cx, double($\ast$f)(double), double tol, double $\ast$xmin)
\begin{DoxyCompactList}\small\item\em A routine that mimimizes a function f. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a620388e1c4a8e38f192c5a0ce42af389}{trans\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int iextract)
\begin{DoxyCompactList}\small\item\em int (w,p,iextract) oversees the propagation of a \char`\"{}flight\char`\"{} of photons \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a2f7b8208c76fe2718f45f46c9dc3a813}{trans\+\_\+phot\+\_\+single} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int iextract)
\begin{DoxyCompactList}\small\item\em Transport a single photon photon through the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1c6dc9c24a43e2bc6319b23faba4a041}{stuff\+\_\+phot} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pin, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pout)
\begin{DoxyCompactList}\small\item\em Simply copy one photon bundle into another. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8f17a1e86112f24760862d998129d91c}{move\+\_\+phot} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, double ds)
\begin{DoxyCompactList}\small\item\em move a photon by a distance ds \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a54b6ecee57eb3cb519fde55290c02f1b}{comp\+\_\+phot} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p1, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p2)
\begin{DoxyCompactList}\small\item\em Compares two photons to determine whether they have the identical position and direction. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a56bcc4eb80e38e626fe58bb5c989eafd}{phot\+\_\+hist} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int iswitch)
\begin{DoxyCompactList}\small\item\em Record the history of a single photon bundle, in terms of a series of photon structures that are populated as the photon goes through the grid. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ac53d695fcce14d5ae685028c7e7280ce}{phot\+\_\+history\+\_\+summarize} (void)
\begin{DoxyCompactList}\small\item\em The next routine is designed to update a portion of the Plasma\+Ptr to reflect where photons along the line of sight to the observer were absorbed in the wind. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a4a0398c1230c6d21c5c51f4750ca2ea1}{ds\+\_\+to\+\_\+cone} (\hyperlink{python_8h_a24207bf0bce7d09eb68cd114e725996d}{Cone\+Ptr} cc, struct \hyperlink{structphoton}{photon} $\ast$p)
\begin{DoxyCompactList}\small\item\em (cc, p) This is a new version of introduced in order to allow cylvar coordinates Eventually it is intended to replace ds\+\_\+to\+\_\+windcone completely, or at least the guts of ds\+\_\+to\+\_\+windcone. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a67e3cb7a7d0cd3d55277fc4f3373fe2e}{ds\+\_\+to\+\_\+sphere} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, struct \hyperlink{structphoton}{photon} $\ast$p)
\begin{DoxyCompactList}\small\item\em Calculate the pathlenth along a line of sight defined by a photon p to a sphere centered on the origin. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ae3980e27bb2bae10474bdb798a3e84b1}{ds\+\_\+to\+\_\+sphere2} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, struct \hyperlink{structphoton}{photon} $\ast$p)
\item 
int \hyperlink{templates_8h_a0940d7c3ced7e511ec385d4de758b436}{quadratic} (double a, double b, double c, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_ae443765b508c1d69ac5249ef9de2bb81}{ds\+\_\+to\+\_\+plane} (struct \hyperlink{structplane}{plane} $\ast$pl, struct \hyperlink{structphoton}{photon} $\ast$p)
\begin{DoxyCompactList}\small\item\em calculates the distance of a photon must travel to hit the plane. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa14b53e068e0016d6cc621e918fdf992}{ds\+\_\+to\+\_\+closest\+\_\+approach} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, struct \hyperlink{structphoton}{photon} $\ast$p, double $\ast$impact\+\_\+parameter)
\item 
double \hyperlink{templates_8h_abca5dd4cfb2140628e2a8f8be27aa2ee}{ds\+\_\+to\+\_\+cylinder} (double \hyperlink{wind2d_8c_a078472458c0ac73f723c094fc2121c14}{rho}, struct \hyperlink{structphoton}{photon} $\ast$p)
\begin{DoxyCompactList}\small\item\em calculate the distance a photon must travel to encouter a cylinder that is centered on the z axis. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a9abacb792fc41f73a200f8a725c40189}{calculate\+\_\+ds} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double tau\+\_\+scat, double $\ast$tau, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, double smax, int $\ast$istat)
\begin{DoxyCompactList}\small\item\em calculate the distance a photon can travel within a single shell without scattering \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_adcc43b4ba5a867bfdfb8f3c05a70f20a}{select\+\_\+continuum\+\_\+scattering\+\_\+process} (double kap\+\_\+cont, double kap\+\_\+es, double kap\+\_\+ff, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em determine what continuum process was that caused the scatter and returns this to the main routine. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a983dcec5903b4aacfce1c770b20e4ba9}{kappa\+\_\+bf} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double freq, int macro\+\_\+all)
\begin{DoxyCompactList}\small\item\em calculates the bf opacity in a specific cell. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7d7a0bd03f273ab50a2eabadb685b585}{kbf\+\_\+need} (double fmin, double fmax)
\begin{DoxyCompactList}\small\item\em computes and stores the set of bound-\/free processes which make significiant contributions to the opacity in a grid cell. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af9a097a1df32d54cc7161c02a07c7894}{sobolev} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double den\+\_\+ion, struct \hyperlink{structlines}{lines} $\ast$lptr, double dvds)
\item 
int \hyperlink{templates_8h_a792efbef440470b9aad57a0d687a8915}{doppler} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pin, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pout, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]}, int \hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\item 
int \hyperlink{templates_8h_adaa6a9c682ca16156e768a39033e55c0}{scatter} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, int $\ast$nnscat)
\begin{DoxyCompactList}\small\item\em determine a new direction and frequency for a photon that is in the wind \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_adb025e0891ad334d41481551bf785170}{radiation} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds)
\begin{DoxyCompactList}\small\item\em updates the field parameters in the wind and reduces the weight of the photon as a result of the effects of free free, bound-\/free and Compton scattering. The routine also keeps track of the number of photoionizations for H and He in the cell. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a03396c07d161ba11de4a87161c5b6745}{kappa\+\_\+ff} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double freq)
\begin{DoxyCompactList}\small\item\em calculates the free-\/free opacity allowing for stimulated emission \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a426bb5a912e3fd43013ffec072376b4a}{sigma\+\_\+phot} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$x\+\_\+ptr, double freq)
\begin{DoxyCompactList}\small\item\em calculates the photionization crossection due to a Topbase level associated with x\+\_\+ptr at frequency freq \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a9b943f07de31437e68d5a62c4d007588}{sigma\+\_\+phot\+\_\+verner} (struct \hyperlink{structinnershell}{innershell} $\ast$x\+\_\+ptr, double freq)
\begin{DoxyCompactList}\small\item\em double (x\+\_\+ptr,freq) calculates the photionization crossection due to the transition associated with x\+\_\+ptr at frequency freq (when the data is in the form of the Verner x-\/sections \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a7a80c6ec538ad7bf2b546126bac374bf}{den\+\_\+config} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int nconf)
\begin{DoxyCompactList}\small\item\em returns the precalculated density of a particular \char`\"{}nlte\char`\"{} level. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a768f0a037ecfb93227eda643e247b219}{pop\+\_\+kappa\+\_\+ff\+\_\+array} (void)
\begin{DoxyCompactList}\small\item\em populates the multiplicative constant, including a gaunt factor, to be used in the calculating free free emission (and absorption). \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a80900ce2eec0df06ac63c9eb02d93afa}{update\+\_\+banded\+\_\+estimators} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds, double w\+\_\+ave)
\begin{DoxyCompactList}\small\item\em updates the estimators required for determining crude spectra in each Plasma cell \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a687aa0dcc49f512e562c1e0afddc0263}{mean\+\_\+intensity} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double freq, int mode)
\begin{DoxyCompactList}\small\item\em returns a value for the mean intensity \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a3995f2a6ba379027804653e28e4feac1}{init\+\_\+log\+\_\+and\+\_\+windsave} (int restart\+\_\+stat)
\begin{DoxyCompactList}\small\item\em init\+\_\+files \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ac88fda6c445f7e99eb1238b8132576ad}{setup\+\_\+created\+\_\+files} (void)
\begin{DoxyCompactList}\small\item\em Use the root name of the .pf file to create names for the various output files written by Python. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a861aa1ae584f627229b18f9b352ae2be}{wind\+\_\+update} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}(w))
\item 
int \hyperlink{templates_8h_a1a5d1633d95cf4e242e41401a1dd5fc5}{wind\+\_\+rad\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em zeros those portions of the wind which contain the radiation properties of the wind, i.\+e those portions which should be set to zeroed when the structure of the wind has been changed or when you simply want to start off a calculation in a known state \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_af6ad57c004d922bda67245571bfdfeb5}{wind\+\_\+ip} (void)
\item 
int \hyperlink{templates_8h_ab38c3e9bfb1c5f325ba00fbefbae66e1}{wind\+\_\+save} (char filename\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ad72f5c977c7a79152243ba8ba509cccc}{wind\+\_\+read} (char filename\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ad5c30455dbf640e7a5d68132a8e4a5c5}{wind\+\_\+complete} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em A driver routine that calls coordinate-\/system specific routines that complete the descirption of the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a2bf66d8d630de2eee13ab88a332cbbfc}{spec\+\_\+save} (char filename\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_abaf08b81d739ed75e14ee5932317af2d}{spec\+\_\+read} (char filename\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a280fcbb3dddfaf58a73b2a8d6fd61c76}{extract} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int itype)
\begin{DoxyCompactList}\small\item\em A supervisory routine called to builds detailed spectra in the normal (extract) mode. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1aaecc045729b48d2ede700108567dcd}{extract\+\_\+one} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int itype, int nspec)
\begin{DoxyCompactList}\small\item\em (w,pp,itype,nspec) \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a4e0486da3b6c0498e47e63b0240f784c}{cdf\+\_\+gen\+\_\+from\+\_\+func} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, double($\ast$func)(double), double xmin, double xmax, int njumps, double \hyperlink{continuum_8c_a47bb97973150c998d469697784328f6e}{jump}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_af2b816871b2b2e0a237a770995bb9803}{gen\+\_\+array\+\_\+from\+\_\+func} (double($\ast$func)(double), double xmin, double xmax, int pdfsteps)
\begin{DoxyCompactList}\small\item\em generates a cdf from a function \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a3752bc8c3152420a2d58398abc1fa4f1}{cdf\+\_\+gen\+\_\+from\+\_\+array} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double y\mbox{[}$\,$\mbox{]}, int n\+\_\+xy, double xmin, double xmax)
\item 
double \hyperlink{templates_8h_a6cd473cda634a93562f9162b5c0c5f06}{cdf\+\_\+get\+\_\+rand} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em Generate a single sample from a cdf. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aecb77ca29971f4b21ea483ab1672e652}{cdf\+\_\+limit} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, double xmin, double xmax)
\begin{DoxyCompactList}\small\item\em sets limit1 and limit2 so that one can generate distributions from a limited range within a previously created cdf. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab79e837935267ae9f6061620404f000e}{cdf\+\_\+get\+\_\+rand\+\_\+limit} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em get a random number for a cdf inside limits set by cdf\+\_\+limit. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a837d826eae7b4094860222086e74e1f2}{cdf\+\_\+to\+\_\+file} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf, char filename\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ac8e83990b5cf236827414abe43bee911}{cdf\+\_\+check} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em a simple routine to check some basics of the cumulative distribution function. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a30c0717640ef307cbe5489ec9ef911f5}{calc\+\_\+cdf\+\_\+gradient} (\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr} cdf)
\begin{DoxyCompactList}\small\item\em Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a55984373c219b38477d5dafb44c2e336}{cdf\+\_\+array\+\_\+fixup} (double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double $\ast$y, int n\+\_\+xy)
\begin{DoxyCompactList}\small\item\em Given two paralel arrays, x and y, this routine reorders the array in ascending order of x. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a22069934602644cf4f894c0b48967d49}{binary\+\_\+basics} (void)
\begin{DoxyCompactList}\small\item\em From the masses and period, setup the information one needs to calculate the position of the Roche lobe of the secondary to calculate whether a photon intersects the surface of the star. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aff5a3156ec26863e37ff61073bb97ca4}{ds\+\_\+to\+\_\+roche\+\_\+2} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em Calculate the distance to the Roche surface for a photon. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ad4ca36cf5f0eaaa3fb044a982d922fb3}{hit\+\_\+secondary} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em Find out whether a photon will hit the secondary, but don\textquotesingle{}t actually calculate the point where it hits. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a3a6359a23f10596d6bb51c80905c1c88}{pillbox} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double $\ast$smin, double $\ast$smax)
\begin{DoxyCompactList}\small\item\em Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a4a0210aea098f52ca60dfbc90de4ecee}{phi} (double s)
\begin{DoxyCompactList}\small\item\em Calculate the Roche potential at position indicated by the photon p\+\_\+roche and the length s. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa85d6bb7bef49e7e4b18d238eb2e6430}{dphi\+\_\+ds} (double s)
\begin{DoxyCompactList}\small\item\em Calculate the gradient of the Roche potential as the photon travels. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a7b0bed5d82ce2310bbd039704b3567cd}{d2phi\+\_\+ds2} (double s)
\begin{DoxyCompactList}\small\item\em Calculate the second derivative of the Roche potential of the secondary. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa6c77132d4fe5cdf4cb3d66186981228}{roche\+\_\+width} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Calculate the width of the Roche potentiil at a position x along the x axis. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ad958df4fd3f6dd7f4ff01882d407c6c6}{roche2\+\_\+width\+\_\+max} (void)
\begin{DoxyCompactList}\small\item\em Find the half width of the secondary Roche lobe. \end{DoxyCompactList}\item 
void \hyperlink{templates_8h_a9c51519f54c26122775ef8eaca1806d8}{roche} (double s, double $\ast$value, double $\ast$derivative)
\begin{DoxyCompactList}\small\item\em Calculate the value of the Roche potential and its derivative along a particular lien of sight. \end{DoxyCompactList}\item 
void \hyperlink{templates_8h_aa72cfd7beaead2acdb08bb12eafa3197}{roche\+\_\+deriv} (double s, double $\ast$value, double $\ast$derivative)
\begin{DoxyCompactList}\small\item\em Calculate the first and second derivative of the roche potential along a specific line of sight. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1881a8f6279e1472e741aab3ee654383}{randvec} (double a\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\item 
int \hyperlink{templates_8h_ac5e9ac55fb4bf0dbb108c006f509b32b}{randvcos} (double lmn\mbox{[}$\,$\mbox{]}, double \hyperlink{disk_8c_afaba31659717b807b58fa7b80c4847a1}{north}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a0d368eae5d684f030c569fcbafeb9df2}{vcos} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\item 
int \hyperlink{templates_8h_a6cc03550704557b5ad2967fc748a579d}{init\+\_\+rand} (int seed)
\begin{DoxyCompactList}\small\item\em Sets up a random number generator. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a451b4740f3d1e12cb07885b0d3e5ef1b}{random\+\_\+number} (double min, double max)
\begin{DoxyCompactList}\small\item\em Gets a random number from the generator set up in init\+\_\+rand. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a40edef16d314acc2a892cd8b8a5f0eec}{get\+\_\+stellar\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em gets input data which is necessary for a Castor and Larmors\textquotesingle{} (1979) description of an O star wind, \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a8dfc0e90b2ec7d2039a8a72236f3fc8f}{stellar\+\_\+velocity} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a9376da4eeb7ef89e52a867eef104cc25}{stellar\+\_\+rho} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a8740705e13bea4c5db604c9c561232b6}{get\+\_\+homologous\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em gets input data which is necessary for a homologous expansion law v(r)= r / t0 \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa79b799560c85bc3b6a750e3bc150873}{homologous\+\_\+velocity} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_aeba6d538928fe4fdbe6d0e7a4350f9f8}{homologous\+\_\+rho} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a023a9f5be6230d4c52840ddde5445b5a}{get\+\_\+hydro\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em Sets up geometry ready to accept a hydro-\/dynamic model. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a839f7eaa23de10001c2ec293dc890563}{get\+\_\+hydro} (int ndom)
\begin{DoxyCompactList}\small\item\em Reads in and decodes a hydro-\/dynamic model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a0f1ed208804bc45d2632cb33e9e73b59}{hydro\+\_\+velocity} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a96750b1c2362e87438698e24afa56a39}{hydro\+\_\+rho} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a9bbb384b23069ca08613aa2396fcbee3}{hydro\+\_\+temp} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a38134c43cdc9afb2ef078514b06b4f88}{rtheta\+\_\+make\+\_\+hydro\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em Defines an r-\/theta grid to accept a hydro model. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a36f04216329e1a6ede98f9f9e0e3989b}{rtheta\+\_\+hydro\+\_\+volumes} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Computes volumes for cells in an r-\/theta hydro model. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa8076d3b8f3be1be3451fd4a7daf9f20}{hydro\+\_\+frac} (double coord, double coord\+\_\+array\mbox{[}$\,$\mbox{]}, int imax, int $\ast$cell1, int $\ast$cell2, double $\ast$frac)
\item 
double \hyperlink{templates_8h_abc5446bc183e860391d1b4a2ee2e6473}{hydro\+\_\+interp\+\_\+value} (double array\mbox{[}$\,$\mbox{]}, int im, int ii, int jm, int jj, double f1, double f2)
\item 
int \hyperlink{templates_8h_a044bda6029c9b8057f77a920a61ce525}{hydro\+\_\+restart} (int ndom)
\begin{DoxyCompactList}\small\item\em Allows a previous windsave to be used in a new hydro simulation. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8c496a3a0937fb3646cbe552d20e7720}{get\+\_\+corona\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em gets input data which is necessary to describe a corona above the surface of the disk. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a5d515c1db2ae9f2cac0b328d7ddfaa1a}{corona\+\_\+velocity} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a7c4c25fcaad3e537c9aa40c61fc356aa}{corona\+\_\+rho} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_abc35742eeeb50cc9cda997c3de567f20}{get\+\_\+knigge\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em get the input data that is necessary to define K\+W\+D-\/type model description of the wind \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a5bbb1cf505a61b894ba478c38ce7935e}{kn\+\_\+velocity} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a1a59c30ec7f9020e01e1eb9010be4109}{kn\+\_\+rho} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a62c27981e9cc187028480ec2752923d3}{kn\+\_\+vzero} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate the sound speed (launch speed) of the wind at r. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab4a7a07fd07176e2d8723e16fd7b619d}{kn\+\_\+wind\+\_\+mdot\+\_\+integral} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em the integrand of K\+WD model for mdot as a function of radius \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a28ecd56d18384623466c728d74cee061}{kn\+\_\+rho\+\_\+zero} (int ndom, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate rho at the base of the wind. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_adc2a482ce6c550cd7e5498bf0ee1055b}{tdisk} (double m, double mdot, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate the reference temperarure for a standard Shakura-\/\+Sunyaeev disk. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a3440890f45c87b4c79fef37820f87487}{teff} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Calculate the temperature of the disk at a normalised distance x. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a2d9e855352fbd6de6a7ed1cd79ac4a64}{gdisk} (double mass, double mdot, double rmin)
\begin{DoxyCompactList}\small\item\em Calculate a reference gravity for the disk. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa4eb3da682e26e1705216d977de95a0a}{geff} (double g0, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Calculate the effective gravity at a specfic position in the disk. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab856a7685f7db0cf633936b2daac314b}{vdisk} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a4027a82b7c3df9474704080c8b3137cc}{zdisk} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Calculate the height of the disk at a certain radius. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_afff91fbd2e4ab430bad432ecb529a28a}{ds\+\_\+to\+\_\+disk} (struct \hyperlink{structphoton}{photon} $\ast$p, int allow\+\_\+negative)
\begin{DoxyCompactList}\small\item\em Calculates the distance that a photon would need to travel from its current position to hit disk. \end{DoxyCompactList}\item 
void \hyperlink{templates_8h_a625372b64e082ea4b46de6f8be0e385f}{disk\+\_\+deriv} (double s, double $\ast$value, double $\ast$derivative)
\begin{DoxyCompactList}\small\item\em Calculate the change in disk height as s function of s. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a6386915abbe2a22bf680d7034b6e1cdc}{qdisk\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Initialize a structure (qdisk) for recording information about photons/energy impinging on the disk, which is stored in a disk structure called qdisk. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7c88d034953bdd81d94f7b4834f455cb}{qdisk\+\_\+save} (char $\ast$diskfile, double ztot)
\begin{DoxyCompactList}\small\item\em Save the information in the qdisk structure to a file. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ada5d5c91372291204ba0255184ce1f87}{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile} (char $\ast$tprofile)
\begin{DoxyCompactList}\small\item\em Read the temperature profile from a file. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a0abc40a64ed911b152833da9a675d1b4}{total\+\_\+line\+\_\+emission} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double f1, double f2)
\begin{DoxyCompactList}\small\item\em Calculate the total line emission from a wind cell. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a0018131577a59a5142e3677785504d37}{lum\+\_\+lines} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, int nmin, int nmax)
\begin{DoxyCompactList}\small\item\em Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a6daa97078321cf4f668d31b7004fed6c}{q21} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em calculates and returns the collisional de-\/excitation coefficient q21 \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a277d190575cbdab99ac77d308dc9dfa1}{q12} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Calculate the collisional excitation coefficient for a line. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a8c589bd3089b7851e8da407ad1ce44a5}{a21} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr)
\begin{DoxyCompactList}\small\item\em Calculate the Einstein A coefficient for a transition. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a234e98c30b4b66b1f72240a79d9f4d11}{two\+\_\+level\+\_\+atom} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double $\ast$d1, double $\ast$d2)
\begin{DoxyCompactList}\small\item\em calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a8b5f64621f83720e21cb4440830ef473}{line\+\_\+nsigma} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em Calculate the total line absorption x-\/section for a specific transition allowing for stimulated emission. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a4a12de5120dbfd2f67d3ac56645cb4e6}{scattering\+\_\+fraction} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em calculate the fraction of excited state atoms which correspond to scattered photons, i.\+e. the portion which are excited by radiation and return to the ground state via spontaneous emission. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a3579026b8eac7743ef56ad21ff9696ff}{p\+\_\+escape} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em Estimate the esccapte probability for a line in a plasma cell. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a07b4586a6bbe5e5633e165c6a9a55fb6}{p\+\_\+escape\+\_\+from\+\_\+tau} (double tau)
\begin{DoxyCompactList}\small\item\em Given an optical depth estimate the escape probility. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a08e6e02acfd4d2fb6b31cf9bfdc7b258}{line\+\_\+heat} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int \hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em calculates the amount of line heating that during a resonance. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a2f3bba5e0752be019862b69eb06d5899}{upsilon} (int n\+\_\+coll, double u0)
\begin{DoxyCompactList}\small\item\em calculates the thermally averaged collision strength thermally excited line emission. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aca0d5b8835f560393ae64306e8f24ce3}{one\+\_\+continuum} (int spectype, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double g, double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em get a photon frequency from a grid of stored spectra from a continuum grid \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a9d1648c5fc65c0c98f2cdf51dfaee558}{emittance\+\_\+continuum} (int spectype, double freqmin, double freqmax, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double g)
\begin{DoxyCompactList}\small\item\em get the surface flux for Hubeny/\+Kurucz like stellar models \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ae1d27b840ad2ff21462921fc2aab975c}{wind\+\_\+luminosity} (double f1, double f2)
\begin{DoxyCompactList}\small\item\em calculate the luminosity of the entire wind between freqencies f1 and f2 \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af6c4eca39f3573084c0a1ff2d9f22209}{total\+\_\+emission} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double f1, double f2)
\begin{DoxyCompactList}\small\item\em Calculate the band-\/limited total emission of a single cell. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a5b9038968dd801ac73806fcc16fc1f0c}{photo\+\_\+gen\+\_\+wind} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double weight, double freqmin, double freqmax, int photstart, int nphot)
\begin{DoxyCompactList}\small\item\em generates photons within the wind between two freqencies and stores them in the photon array \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a8a9a281cba993682e32c78c93f264f35}{one\+\_\+line} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em gets the frequency of a single collisionally excited line photon in a particular cell of the wind. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d}{total\+\_\+free} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e, double f1, double f2)
\begin{DoxyCompactList}\small\item\em calculates the band-\/limited ff luminosity of a cell. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ade7eab896d4188a5b8a4ed6845d33150}{ff} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e, double freq)
\begin{DoxyCompactList}\small\item\em calculate f\+\_\+nu for ff emisssion \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af59091ae76131213b5c23a085d88eb1d}{one\+\_\+ff} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double f1, double f2)
\begin{DoxyCompactList}\small\item\em randomly generate the frequency of a ff photon within the frequency interval f1 and f2 \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aaad109a8ae79883e98e2dee88d65bd4e}{gaunt\+\_\+ff} (double gsquared)
\begin{DoxyCompactList}\small\item\em computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (1988). \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_abf7699b950ec2ef55a4e0087d82d0ab3}{cooling} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{ionization_8c_a4894abff5157e9a38f8dd34d0d0c2b4a}{xxxplasma}, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em calculate the total cooling of a cell at a temperature t \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af3162ce29644bbfd1d6ef9060d972643}{xtotal\+\_\+emission} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double f1, double f2)
\begin{DoxyCompactList}\small\item\em calculate the cooling of a single cell due to free free, bound -\/ boound and recombination processes. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_acbbafed45b10980bb86fe7950daa0604}{adiabatic\+\_\+cooling} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em determines the amount of adiabatic cooling in a cell, in units of luminosity. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a2a31b4c75dc8f482609abe7b1618a97b}{wind\+\_\+cooling} (double f1, double f2)
\begin{DoxyCompactList}\small\item\em calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non-\/radiative processes \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a4afaeaee23214405bf4d30a7d2eb06b6}{fb\+\_\+topbase\+\_\+partial} (double freq)
\begin{DoxyCompactList}\small\item\em returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms of Topbase photoionization x-\/sections. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a7ef12badd64f5bb47d6fccbb217ba805}{integ\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int nion, int fb\+\_\+choice, int mode)
\begin{DoxyCompactList}\small\item\em calculates the integrated emissivity of the plasma, or the number of recombinations per second of a particular ion within defined frequency bands. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a9d0d69b33092d06a7174d71c3082d2a6}{total\+\_\+fb} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int fb\+\_\+choice, int mode)
\begin{DoxyCompactList}\small\item\em returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t between the frequncy limits f1 and f2. The energy lost is just the kinetic energy lost from the plasma because it does not include the ionization potential associated with each recombination. Python tracks effectively the kinetic energy of the plasma (not the potential energy available if everything recombined). \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a1e3f4af5624039f9a4937939331b5219}{one\+\_\+fb} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double f1, double f2)
\begin{DoxyCompactList}\small\item\em generates one free bound photon with specific frequency limits \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7c21266df7327fbc81b2c5cf6b5e067f}{num\+\_\+recomb} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e, int mode)
\begin{DoxyCompactList}\small\item\em calculates the total number of recombinations for all of the ions in a cell \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a9c153b5e0d982b2debddf4523274d159}{fb} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double freq, int ion\+\_\+choice, int fb\+\_\+choice)
\begin{DoxyCompactList}\small\item\em calculates either the free\+\_\+bound emissivity at a specific frequency or depending on inputs, the recombination rate \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a86d223ebd7563467934af71d1d8e4552}{init\+\_\+freebound} (double t1, double t2, double f1, double f2)
\begin{DoxyCompactList}\small\item\em initializes the structure fb\+\_\+struc as well as some associated arrays and variables (found in \hyperlink{python_8h}{python.\+h}) that describe recombination rates and band-\/limited luminosities. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aac492018c209163236776675dbf5c7e7}{get\+\_\+nrecomb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, int nion, int mode)
\begin{DoxyCompactList}\small\item\em Return the recombination coefficient. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa7c3eb3f3d0a8eecbbdee02b8988f17d}{get\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, int nion, int narray, int fb\+\_\+choice, int mode)
\begin{DoxyCompactList}\small\item\em Interpolate from a set of stored emissivities. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_abbfb58b40faa368dabec2eb9f4b51c89}{xinteg\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int nion, int fb\+\_\+choice)
\begin{DoxyCompactList}\small\item\em calculates the integrated emissivity of an ion in the plasma. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a250e063dde090c67146f51ea71371bfc}{xinteg\+\_\+inner\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int nion, int fb\+\_\+choice)
\begin{DoxyCompactList}\small\item\em calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab1050097e6dcebb3469479d4fd5ff6c0}{total\+\_\+rrate} (int nion, double T)
\begin{DoxyCompactList}\small\item\em get the total rediative recombination rate \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a942292d67abfae3c22d1bbf5ed6fbc3c}{gs\+\_\+rrate} (int nion, double T)
\begin{DoxyCompactList}\small\item\em get the recombination rate to the ground state for an ion at a particular temperature \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8012f489c5fe73ae85b4e317f8bb6059}{sort\+\_\+and\+\_\+compress} (double $\ast$array\+\_\+in, double $\ast$array\+\_\+out, int npts)
\begin{DoxyCompactList}\small\item\em sort an array into numerical order elimination duplicates \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ab14b7f5dc01c12685f12b0909b19c44c}{compare\+\_\+doubles} (const void $\ast$a, const void $\ast$b)
\begin{DoxyCompactList}\small\item\em A routine used by qsort in sort\+\_\+and\+\_\+compress. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a3c32de99bd46282a95c0de7c8f7e890f}{get\+\_\+standard\+\_\+care\+\_\+factors} (void)
\begin{DoxyCompactList}\small\item\em get inputs that provides more control over how the program is run \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a4ba7a23129d489314ba51c999d18e321}{get\+\_\+extra\+\_\+diagnostics} (void)
\begin{DoxyCompactList}\small\item\em Allows the user to specify what extra diagnositcs to write out. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_acbb582e8c0def41044e2d4d8aac0c752}{init\+\_\+extra\+\_\+diagnostics} (void)
\begin{DoxyCompactList}\small\item\em opon a file for writing out extra diagnostics. In some cases reads a file that specifies in which cells ones wants diagnostics \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1c8114c71c12528c31d3329d1a5a7777}{save\+\_\+photon\+\_\+stats} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds, double w\+\_\+ave)
\begin{DoxyCompactList}\small\item\em prints photon statistics to a file \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ad9812264d4df596406d5878299e8b7e5}{save\+\_\+extract\+\_\+photons} (int n, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, double $\ast$\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em saves informations about phtoons in a particulare wavelength gange \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8a47e3be8dabf79f57b228429bd33eb8}{save\+\_\+photons} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, char comment\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a36a9f5603f59602831695269c056cbe4}{track\+\_\+scatters} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int nplasma, char $\ast$comment)
\item 
int \hyperlink{templates_8h_acc6d4ccf49e7781a11424e723e25f812}{get\+\_\+sv\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em gets input data which is necessary for a Shlossman \& Vitello description of the wind \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a065ea7111a89ce368a02ab78addf16dd}{sv\+\_\+velocity} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]}, int ndom)
\item 
double \hyperlink{templates_8h_a4139b8cafcab2d2d4fb6d4da9c064dd2}{sv\+\_\+rho} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_ad8e51a07835bbd92abe5584a7330d5e5}{sv\+\_\+find\+\_\+wind\+\_\+rzero} (int ndom, double p\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a39a48868b268c8ac038661aecd465806}{sv\+\_\+zero\+\_\+init} (double p\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a3e9f63d90b25108ed917dbd91583ab8f}{sv\+\_\+zero\+\_\+r} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em Routine used by zbrent to find a footpoint of a streamline in an SV model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a0b95d81797f46e4870ae03311b4278ab}{sv\+\_\+theta\+\_\+wind} (int ndom, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em double (r) finds the angle at which the wind emerges from at a specific radius r on surface of the disk \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af9d14b750645265f8bcb32d68f9a3832}{sv\+\_\+wind\+\_\+mdot\+\_\+integral} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r})
\begin{DoxyCompactList}\small\item\em The integrand required to calculate the normalization factor between the global mass loss rate and the mass loss per unit area at a particular place on the disk. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a626b1882e2533441cdf2daabd36e8a8b}{ion\+\_\+abundances} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em ionization routines for the wind one cell at a time \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ab729c5f4ef31135996b77fb1add8df2c}{convergence} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em checks to see whether a single cell is or is not converging \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a834b9001d849a521f4dbf7a0dcb0d012}{check\+\_\+convergence} (void)
\begin{DoxyCompactList}\small\item\em The routien summarizes the how well the wind converging to a solution as a whole. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a0c0fa3305df1f5c000e0ed0a26d413d8}{one\+\_\+shot} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em calculates new densities of ions in a single element of the wind after (usually) having found the temperature which matches heating and cooling for the previous densities \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a09cddd089f4a6cc83c34606d125c28a4}{calc\+\_\+te} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double tmin, double tmax)
\begin{DoxyCompactList}\small\item\em calc\+\_\+te determines and returns the electron temperature in the wind such that the energy emitted by the wind is equal to energy emitted (asssuming it is in the interval bracketed by tmin and tmax.) \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a866bab53f422c2afa889e5e549df76d1}{zero\+\_\+emit} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell in the previous ionization cycle. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a2ba8dcf484d3688f9687d48dd865dc0d}{levels} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em Calculates the fractional occupation numbers of the various of atomic configurations assuming L\+TE or various alternatives to L\+TE. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a96c552f69871659978a481c47617fc6c}{dvwind\+\_\+ds} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em find the gradient velocity vector v, dv\+\_\+ds for a photon at a certain postion travelling in a certain direction \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a655c28bba6dc25187e6173f6787364c4}{dvds\+\_\+ave} (void)
\begin{DoxyCompactList}\small\item\em Calculate the direction averaged (and maximum) dv\+\_\+ds in each grid cell of the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_adc18086c9912f51dae0f13aef98278de}{reposition} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em p) attempts to assure that a photon is not scattered a second time inappropriately by the same transition \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a086da1ecc9d7064c79041745de7031fa}{randwind} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double lmn\mbox{[}3\mbox{]}, double \hyperlink{disk_8c_afaba31659717b807b58fa7b80c4847a1}{north}\mbox{[}3\mbox{]})
\item 
double \hyperlink{templates_8h_af170ad39af01fbe3b232230692c2aa5e}{vrandwind} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em the function that is used to generate the cdf for anisotropic scattering. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a76f3cece46c92129a1e138a02aac87ca}{reweightwind} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em calculates the weight of a photon in the wind that is forced to scatter along a specific line of sight. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a62480c3fe99eaa0284c85a48b1e8427d}{make\+\_\+cdf\+\_\+randwind} (double tau)
\item 
int \hyperlink{templates_8h_a5cc282e1f3d56ce0f29cb080bc225408}{randwind\+\_\+thermal\+\_\+trapping} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$nnscat)
\begin{DoxyCompactList}\small\item\em is the routine which chooses a new anisotropic direction in geo.\+scatter\+\_\+mode = S\+C\+A\+T\+T\+E\+R\+\_\+\+M\+O\+D\+E\+\_\+\+T\+H\+E\+R\+M\+AL \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_af8c5f231035fc1a85000b9849b4fb0ed}{fraction} (double value, double array\mbox{[}$\,$\mbox{]}, int npts, int $\ast$ival, double $\ast$f, int mode)
\item 
int \hyperlink{templates_8h_a848bdfe987685e5135b3437dc0dec5e7}{linterp} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double xarray\mbox{[}$\,$\mbox{]}, double yarray\mbox{[}$\,$\mbox{]}, int xdim, double $\ast$y, int mode)
\item 
int \hyperlink{templates_8h_a3d923b8d7eb460585ecf6885222a69a3}{coord\+\_\+fraction} (int ndom, int ichoice, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, int ii\mbox{[}$\,$\mbox{]}, double frac\mbox{[}$\,$\mbox{]}, int $\ast$nelem)
\item 
int \hyperlink{templates_8h_a829a331b30311e6768f4cc16a70fdab5}{where\+\_\+in\+\_\+2dcell} (int ichoice, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, int n, double $\ast$fx, double $\ast$fz)
\item 
int \hyperlink{templates_8h_aed64e9379499a741e8a7c42376e20530}{wind\+\_\+n\+\_\+to\+\_\+ij} (int ndom, int n, int $\ast$\hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int $\ast$\hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j})
\begin{DoxyCompactList}\small\item\em Translate a cell number in the wind to the two-\/d grid position in a specific domain. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a172ddeb06a81951700723a0b02d90557}{wind\+\_\+ij\+\_\+to\+\_\+n} (int ndom, int \hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, int $\ast$n)
\begin{DoxyCompactList}\small\item\em Translate from the 2d element for an individual domain to the wind element number. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ad2938cb78e3414274491d2d778843db3}{wind\+\_\+x\+\_\+to\+\_\+n} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, int $\ast$n)
\begin{DoxyCompactList}\small\item\em Determine the wind domain element number from a postion. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a5377ca5e35d35e11d4332da6bb2f2009}{get\+\_\+ion\+\_\+density} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, int nion)
\item 
int \hyperlink{templates_8h_a3513a64162c15d3d3d101c3d5ea2367f}{bands\+\_\+init} (int imode, struct \hyperlink{structxbands}{xbands} $\ast$band)
\begin{DoxyCompactList}\small\item\em This is the routine that initializes the bands. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a900ff3bb7a80569abf42be1e2b00fd36}{freqs\+\_\+init} (double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em This is the routine where the frequency boundaries for course spectra are established. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a766e9400cf36e77e8d5dc4c5289735e2}{timer} (void)
\begin{DoxyCompactList}\small\item\em Return the time in seconds since the timer was initiated. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa3b24089fadbcdf92560f31730390556}{get\+\_\+time} (char curtime\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a9301eba8fb39302ef3da90cdb52aef4d}{matom} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, int $\ast$escape)
\begin{DoxyCompactList}\small\item\em The core of the implementation of Macro Atoms in python. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ac84f4556e3972c1fe39b74fd9b7b4241}{b12} (struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr)
\item 
double \hyperlink{templates_8h_a53e97649d5cd9a1fab024ab99489ddb1}{alpha\+\_\+sp} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int ichoice)
\item 
double \hyperlink{templates_8h_aee2caf449c574d065a2cf67664783ace}{alpha\+\_\+sp\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em This returns the integrand for alpha\+\_\+sp at a chosen frequency -\/. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a16ae068adf1746f09c432de7e245dfb1}{kpkt} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, int $\ast$escape)
\item 
int \hyperlink{templates_8h_aa39c27768ea571d93b29aa2bf90e7913}{fake\+\_\+matom\+\_\+bb} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, int $\ast$escape)
\item 
int \hyperlink{templates_8h_a4c03c66dea8a22dd2a87077c816d26c2}{fake\+\_\+matom\+\_\+bf} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, int $\ast$escape)
\item 
int \hyperlink{templates_8h_a9ae82cdebefd0a70326fd37ee0a61fd4}{emit\+\_\+matom} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, int upper)
\begin{DoxyCompactList}\small\item\em a scaled down version of matom which deals with deactivation only for spectral cycles. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ac60407b8b44d5a57ec6c89122058dcf7}{matom\+\_\+emit\+\_\+in\+\_\+line\+\_\+prob} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, struct \hyperlink{structlines}{lines} $\ast$line\+\_\+ptr\+\_\+emit)
\begin{DoxyCompactList}\small\item\em Prob. of cell emitting in a given line. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a141c8c8db4119b46cba7dcff5de861b3}{bf\+\_\+estimators\+\_\+increment} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double ds)
\begin{DoxyCompactList}\small\item\em increment the matom bound-\/free estimators \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa85aa8b5ea483c44b26216b963015484}{bb\+\_\+estimators\+\_\+increment} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double tau\+\_\+sobolev, double dvds, int nn)
\begin{DoxyCompactList}\small\item\em increment the matom bound-\/bound estimators \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a0b0bdb47e266cd31f1c381bb2410fa80}{mc\+\_\+estimator\+\_\+normalise} (int n)
\begin{DoxyCompactList}\small\item\em the routine to normalise the matom bb and bf estimators. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ac3d85b1663343d2b268e3bbb09e6dcc6}{total\+\_\+fb\+\_\+matoms} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e, double f1, double f2)
\begin{DoxyCompactList}\small\item\em computes the cooling rate due to free-\/bound recombinations \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ac9b0bd2eb8c4957c99a8c369d02cd169}{total\+\_\+bb\+\_\+cooling} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total cooling in matom bb transitions \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a1d58fccfac7eec74c69412cfabcc5caf}{macro\+\_\+bb\+\_\+heating} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total heating due to matom bb transitions \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a6122a3139a25688235ecb8b77e875b0f}{macro\+\_\+bf\+\_\+heating} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total heating due to bf transitions for macro atoms. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a5dcca3c33cb0db12719fcc6a79958119}{bb\+\_\+simple\+\_\+heat} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double tau\+\_\+sobolev, double dvds, int nn)
\begin{DoxyCompactList}\small\item\em records the heating contribution from lines of simple elements. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a00d9c108946340fef4c429a9afdeb110}{check\+\_\+stimulated\+\_\+recomb} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em sanity check the stimulated recombination rate \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_abd62705b5006847a8dc70b442bf15332}{get\+\_\+dilute\+\_\+estimators} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em compute dilute matom estimators \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_af9a598f20c5f4d5b9f01585d7cf8eb4c}{get\+\_\+gamma} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the dilute photoionization rate estimator \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a0332ea341d92221cbaa2600a2adaa35f}{gamma\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em integrand for the dilute photoionization rate estimator \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a1e05a878575b566deae630d01be4c75c}{get\+\_\+gamma\+\_\+e} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the dilute energy weighted photoionization rate estimator \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa5dfb70302251c14bd8a01ff6f3ec20a}{gamma\+\_\+e\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em the integrand for the energy-\/weighted photoionization rate estimator, \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ade8e60c03793f3c9f76d4ddd1c159346}{get\+\_\+alpha\+\_\+st} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the stimulated recombination rate estimator \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ae1c68aef7b2918706acea6da976e3cf4}{alpha\+\_\+st\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em returns the integrand for alpha\+\_\+st at a chosen frequency \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_accd23482f2a991d91cb8dedaef4560ed}{get\+\_\+alpha\+\_\+st\+\_\+e} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em the energy-\/weighted stimulated recombination estimator \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a034f4f5a8a3102d5224cf211c11d6abc}{alpha\+\_\+st\+\_\+e\+\_\+integrand} (double freq)
\begin{DoxyCompactList}\small\item\em the integrand for alpha\+\_\+st\+\_\+e at a chosen frequency \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ad0ff63710a78f84604f2adc60d4b1c32}{xtemp\+\_\+rad} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Prints out t\+\_\+r and t\+\_\+e and the total number of photons in a subsample of the the grid that fits on a typical output terminal. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aae3509585172ef791e8112e146a86f46}{get\+\_\+yso\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em gets input data that are necessary for a Y\+SO comprising a region that resembles a K\+WD wind and a region outside this that contins a speherical wind \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a1ed063376968bf4fa4d573f19bae7375}{yso\+\_\+velocity} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a624115af503ecce9d20d3fc8c3813ca0}{yso\+\_\+rho} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
double \hyperlink{templates_8h_a924a75177a13600d1838067dccd80aa0}{cylind\+\_\+ds\+\_\+in\+\_\+cell} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em calculate the distance to the far boundary of the cell in which the photon bundle when dealing with a cylindrical domain \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a56507e563e08709e70d77a7ccd538ee3}{cylind\+\_\+make\+\_\+grid} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em defines the cells in a cylindrical grid \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8bdfd0f93f3588b82c331dc1b1c38b97}{cylind\+\_\+wind\+\_\+complete} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Create arrays that are used for interpolating quantities, such as density and velocity. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a13144d35b1d57cfa570b6e59d225f474}{cylind\+\_\+volumes} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Calculates the wind volume for cells in a cylindrical domain allowing for the fact that some cells are not necessarily entirely in the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a3a95696ec4f71b5faa5693bb3c1c1bc6}{cylind\+\_\+where\+\_\+in\+\_\+grid} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a256e18f6688f66ced645885b9ca6eb2c}{cylind\+\_\+get\+\_\+random\+\_\+location} (int n, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a550c2a5ff400a82eebb328533b31e700}{cylind\+\_\+extend\+\_\+density} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\item 
int \hyperlink{templates_8h_aa06d3901560706877fe1b434a657e3d1}{cylind\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind} (int n)
\begin{DoxyCompactList}\small\item\em Check whether this cell is in the wind or not. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a68cff92e2a36ec9073dbecabffa5543b}{rtheta\+\_\+ds\+\_\+in\+\_\+cell} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em calculates the distance to the far boundary of the cell in which the photon bundle resides. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a4cb6c91545a34b48e5d6cd74a68665de}{rtheta\+\_\+make\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em Set up an rtheta grid. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a29a481b4e0cfe03c2e99795dc24e10d1}{rtheta\+\_\+make\+\_\+cones} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em defines the wind cones that are needed to calculate ds in a cell \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_afd293c7e79b81faca3f4a2d115eaea6a}{rtheta\+\_\+wind\+\_\+complete} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Complete the creation of an rtheta wind comain by populating certain arrays used for interpolation. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a16377719f4171d75f5aa983c79476590}{rtheta\+\_\+volumes} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em rtheta\+\_\+volume(w) calculates the wind volume of a cell in rtheta coordinate sysem allowing for the fact that some cells may not be in the active wind region \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a711aa1dc0e92eff62111bf90e2a6b89e}{rtheta\+\_\+where\+\_\+in\+\_\+grid} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a00bbfc05ca86bbb87a4c69019564af5d}{rtheta\+\_\+get\+\_\+random\+\_\+location} (int n, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_ad06961b0435b7c8b175189291537c20c}{rtheta\+\_\+extend\+\_\+density} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em extends the density to regions just outside the wind regiions so that extrapolations of density can be made there \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a6a70fbae6e163ad01aec40a2354ed674}{rtheta\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind} (int n)
\begin{DoxyCompactList}\small\item\em Check whether a cell in an rtheta coordiante system is in the wind. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a3810d91d16158ce91d1247c4df1ede09}{spherical\+\_\+ds\+\_\+in\+\_\+cell} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em calculates the distance to the far boundary of the cell in which the photon bundle resides. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_abc3da46eefcdd64c79fd792439a5b53d}{spherical\+\_\+make\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em defines the cells in a spherical grid \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a223201f3c894676560fbd4d94e71c167}{spherical\+\_\+wind\+\_\+complete} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Initialize some arrays in a domain for a spherical system that are used in various interpolation routines. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1c6dbd2946a218d14cf553a59e41d189}{spherical\+\_\+volumes} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em spherical\+\_\+volume(w) calculates the wind volume of cell allowing for the fact that some cells are partially in the wind \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7406e8182dece78e2612793e400d1540}{spherical\+\_\+where\+\_\+in\+\_\+grid} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a01eb12e765998d3b9b350b3d8834347f}{spherical\+\_\+get\+\_\+random\+\_\+location} (int n, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a6c5300254db561924aba1c13186be975}{spherical\+\_\+extend\+\_\+density} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em extends the density to regions just outside the wind regiions so that extrapolations of density can be made there \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1df8af4539e5836b6a2f8dab9f88572e}{shell\+\_\+make\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em defines the cells in a thin shell, a special case of a spherical wind. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a52b5367a4a1a8d1bbe9446a5571a81fd}{cylvar\+\_\+ds\+\_\+in\+\_\+cell} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em cylin\+\_\+ds\+\_\+in\+\_\+cell calculates the distance to the far boundary of the cell in which the photon bundle resides. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a95a5dd7b17dd91fc7d21b44ee290d256}{cylvar\+\_\+make\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em defines the cells in a cylindrical grid when the disk is vertically extended. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a99c605bb65f5950301b4adf1ff09eb8d}{cylvar\+\_\+wind\+\_\+complete} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em Completes the definition of some of the positonal variables in the wind, and creates some subidiary arrays. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a95334daf522cc6a4ac43e85e759f4a31}{cylvar\+\_\+volumes} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em w) calculates the wind volume of a cylindrical cell allowing for the fact that some cells \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a3f57c2e9fb596450ee692d70f2a6a1be}{cylvar\+\_\+where\+\_\+in\+\_\+grid} (int ndom, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, int ichoice, double $\ast$fx, double $\ast$fz)
\item 
int \hyperlink{templates_8h_abcd93706f368767b5cbb885fa6d97f77}{cylvar\+\_\+get\+\_\+random\+\_\+location} (int n, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a2ec3f5fd8390071adf98cdaee7afb064}{cylvar\+\_\+extend\+\_\+density} (int ndom, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\begin{DoxyCompactList}\small\item\em extends the density to regions just outside the wind regiions so that extrapolations of density can be made there \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a71991ab1e84795ab8b9451c4d58a5e31}{cylvar\+\_\+coord\+\_\+fraction} (int ndom, int ichoice, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, int ii\mbox{[}$\,$\mbox{]}, double frac\mbox{[}$\,$\mbox{]}, int $\ast$nelem)
\item 
int \hyperlink{templates_8h_a31c06318250f485d9337c958b118ffe5}{bilin} (double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}\mbox{[}$\,$\mbox{]}, double x00\mbox{[}$\,$\mbox{]}, double x01\mbox{[}$\,$\mbox{]}, double x10\mbox{[}$\,$\mbox{]}, double x11\mbox{[}$\,$\mbox{]}, double $\ast$f, double $\ast$g)
\item 
int \hyperlink{templates_8h_ab5487fc46112085131fe007108772011}{xquadratic} (double a, double b, double c, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a67af2cd841a922ea1001654449239284}{create\+\_\+maps} (int ichoice)
\begin{DoxyCompactList}\small\item\em Create a map between wind and plasma cells. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_af3449f72ae22aca485dfaa4d2f5ae300}{calloc\+\_\+wind} (int nelem)
\begin{DoxyCompactList}\small\item\em Allocate space for the wind domain. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a391062d8b219dffc8496bd6fc8128cf6}{calloc\+\_\+plasma} (int nelem)
\begin{DoxyCompactList}\small\item\em Allocate memory for plasmamain, which contains temperature, densities, etc. for cells which are in the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa751e527d76e3ced7d54e260c6ec8cd3}{check\+\_\+plasma} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, char \hyperlink{rdpar_8c_abc6cdcc4db9d9768558d0faa2128c876}{message}\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a4b147244ba1a5d54d79a57a8ee665b18}{calloc\+\_\+macro} (int nelem)
\begin{DoxyCompactList}\small\item\em Allocate memory to store information for macro atoms for each Plasma element. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a43492c595dcd8568e2c14a8496c8fd43}{calloc\+\_\+estimators} (int nelem)
\begin{DoxyCompactList}\small\item\em Dynamically allocate various arrays in macromain. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a311078e4d3e5530a996283eaf4c0fb19}{calloc\+\_\+dyn\+\_\+plasma} (int nelem)
\begin{DoxyCompactList}\small\item\em This subroutine allocates space for dynamic arrays in the plasma structure. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a37c9b91e3450874eb15cef76079f344d}{partition\+\_\+functions} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a2de3c1f3e0adc389cfda580a1003a688}{partition\+\_\+functions\+\_\+2} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int xnion, double temp, double weight)
\begin{DoxyCompactList}\small\item\em calculates the partition functions for a pair of ions at a given temperature. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ab1f63fcb955cb5c77dcb2d35b5da2cd4}{xsignal} (char $\ast$root, char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em xsignal generates a single line message to a file names root.\+sig \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_adb0062a13c369fa8c13a5a02c3ffec86}{xsignal\+\_\+rm} (char $\ast$root)
\begin{DoxyCompactList}\small\item\em Remove the old signal file so that one can begin again. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a53d75807008c96f7053e25e029ed8a95}{set\+\_\+max\+\_\+time} (char $\ast$root, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t})
\begin{DoxyCompactList}\small\item\em Set the maximum time the program should run. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa067770b0286b11ebb3282166d941c85}{check\+\_\+time} (char $\ast$root)
\begin{DoxyCompactList}\small\item\em check whether the elapsed time is greater than the max\+\_\+time and terminate the program if that is the case. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a9006d7b3b01cfef2acdd6a68cc34434f}{auger\+\_\+ionization} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\item 
double \hyperlink{templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c}{agn\+\_\+init} (double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, double lum, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double freqmin, double freqmax, int ioniz\+\_\+or\+\_\+final, double $\ast$f)
\begin{DoxyCompactList}\small\item\em Calculates the total luminosity of an A\+GN type source. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab172924888b8579c4acdd737732edce1}{emittance\+\_\+pow} (double freqmin, double freqmax, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em The luminosity of a power law over a frerquency range. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a9bd7eb064b17d9b352e044d5e417a649}{emittance\+\_\+bpow} (double freqmin, double freqmax, double lum, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em Works out the luminosity of a broken power law. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10}{photo\+\_\+gen\+\_\+agn} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double \hyperlink{import__spherical_8c_a83175ac8fd9d924ff2bce40c99e88870}{r}, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double weight, double f1, double f2, int spectype, int istart, int nphot)
\begin{DoxyCompactList}\small\item\em Generate a photon from an A\+GN object. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ae964ba7da192ec86c6765f75ab1bcd76}{get\+\_\+shell\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em Get the inputs needed to specigy the shell\+\_\+wind modelen radius. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a058633208c21e33eb49a33bd82c6327d}{kappa\+\_\+comp} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double freq)
\begin{DoxyCompactList}\small\item\em Pointer to current plasma cell. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a3ce17d1882989bac342f4bc4d1e0a7b6}{kappa\+\_\+ind\+\_\+comp} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double freq)
\begin{DoxyCompactList}\small\item\em Computes the effective opacity in the cell due to {\itshape induced} compton heating. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a560f4bd0619fdb29b85891d46ce63a48}{total\+\_\+comp} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the cooling in the cell due to inverse compton scattering. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a28be66a0a760ceb7b8394a5a8e7526af}{klein\+\_\+nishina} (double nu)
\begin{DoxyCompactList}\small\item\em computes the Klein Nishina cross section for a photon of frequency nu. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a9300319cf99a4a66db3876befda54050}{compton\+\_\+dir} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em computes a random direction for a photon undergoing compton scattering. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a9891de810e686fa36209796ff1704fa3}{compton\+\_\+func} (double f)
\begin{DoxyCompactList}\small\item\em Function used to find the fractional energy change for a given cross-\/section in the compton scattering limit. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_add111df2de1b0fadab91816f33ee5266}{sigma\+\_\+compton\+\_\+partial} (double f, double \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em is the Klein Nishina cross section as a function of the fractional energy change \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha} (double nu)
\begin{DoxyCompactList}\small\item\em The \textquotesingle{}heating\textquotesingle{} cross section correction to Thompson. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a5bffcc1725b11f5b35c37b406aaec263}{beta} (double nu)
\begin{DoxyCompactList}\small\item\em The \textquotesingle{}cooling\textquotesingle{} cross section correction to Thompson. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a2f793ca07e9f7ec0220090b8f6b73634}{comp\+\_\+cool\+\_\+integrand} (double nu)
\begin{DoxyCompactList}\small\item\em The integrand in the integral to obtain the total cooling rate due to inverse compton scattering. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a54a60a3cfc21ceae39f7c529519c25ae}{compute\+\_\+zeta} (double temp, int nion, int mode)
\begin{DoxyCompactList}\small\item\em calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equation \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa2bd15d3acbd24b94a78d7a55fbd4bb6}{compute\+\_\+dr\+\_\+coeffs} (double temp)
\begin{DoxyCompactList}\small\item\em returns the volumetric dielectronic rate coefficients for a given temperature. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_abd4b0c8d02397f42187b29be6dcebc87}{total\+\_\+dr} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em calculates the total luminosity from DR. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_abe28dc93125bf28e9c3dcef85428b16a}{spectral\+\_\+estimators} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma})
\begin{DoxyCompactList}\small\item\em Calculate the parameters of a model for J\+\_\+nu in a cell. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a5c555bf81b13fcd5357bda01781ea3bc}{pl\+\_\+alpha\+\_\+func\+\_\+log} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em Function used in zbrent to work out best value of alpha for a power law model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a1df982c704d2defe2182934f2ab66b70}{pl\+\_\+logmean} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double lnumin, double lnumax)
\begin{DoxyCompactList}\small\item\em Computes the mean frequency of a power law with exponent alpha. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_abba07de067655328106ec96798c4794d}{pl\+\_\+log\+\_\+w} (double \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double lnumin, double lnumax)
\begin{DoxyCompactList}\small\item\em works out the scaling factor for a power law representation of a cell spectrum \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a29985eb821f4ce1d32c191926b84fe59}{pl\+\_\+log\+\_\+stddev} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha}, double lnumin, double lnumax)
\begin{DoxyCompactList}\small\item\em Work out the standard deviation of a power law spectral model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a17dff6266e67bdc289c6ac89d1a230b7}{exp\+\_\+temp\+\_\+func} (double exp\+\_\+temp)
\begin{DoxyCompactList}\small\item\em Function used in zbrent to work out best value of alpha for a power law model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ad5da2d7b86cbdf86c1fc733c56d9f302}{exp\+\_\+mean} (double exp\+\_\+temp, double numin, double numax)
\begin{DoxyCompactList}\small\item\em Calculate the mean frequency of an exponential distribution. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ad6d1b9b9650b2f9e2f3bd72bfb5e5382}{exp\+\_\+w} (double \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, double exp\+\_\+temp, double numin, double numax)
\begin{DoxyCompactList}\small\item\em This program works out the scaling factor for an exponential representation of a spectrum. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a288f4e76f4f5ee38900c0f14b5a4ac21}{exp\+\_\+stddev} (double exp\+\_\+temp, double numin, double numax)
\begin{DoxyCompactList}\small\item\em This program works out the standard deviation. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a72d9769510683e30aeef87c2a255ebe4}{variable\+\_\+temperature} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the Wind\+Ptr itself, such as t\+\_\+r, t\+\_\+e, w, based on the \char`\"{}mode\char`\"{}. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a7f409d6ca8a15c6c341fdb1853104685}{pi\+\_\+correct} (double xtemp, int nion, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em calculates the photoionization rate correction factor for the number density of two adjacent ions \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_acadd7fa5bd8a9673141a0de53d002aba}{temp\+\_\+func} (double solv\+\_\+temp)
\begin{DoxyCompactList}\small\item\em the function minimised by zbrent to find a temperature when the ion ratios are one (so the logarithm will be 0), to avoid numerical problems. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a5fc061a271cdb55a6e05db67fafd504c}{matom\+\_\+emiss\+\_\+report} (void)
\begin{DoxyCompactList}\small\item\em a routine which reports the matom level and kpkt emissivities summed over all cells. It is called in \hyperlink{foo_8h_aa943bd857500a1f2937d8b97d84ff633}{define\+\_\+phot()} in the spectral cycles, after \hyperlink{foo_8h_ac8797bce5a5f3411f4162dff928b7920}{get\+\_\+matom\+\_\+f()} \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a71e4aa982b912f78d70646462c6a6115}{compute\+\_\+di\+\_\+coeffs} (double T)
\begin{DoxyCompactList}\small\item\em computes the rates due to direct (collisional) ionization from Dere data. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a6a22ee2c1e95eae27423b95ce1283f71}{q\+\_\+ioniz\+\_\+dere} (int nion, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em Returns the collisional ionization rate coefficient for a given ion/temperature. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a56f9a736ea5fdd9b253e4a7fa07103ce}{total\+\_\+di} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double t\+\_\+e)
\begin{DoxyCompactList}\small\item\em computes the total cooling due collisional ionization \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a2cd4b2739e1ba69e646c63e7e327583c}{compute\+\_\+qrecomb\+\_\+coeffs} (double T)
\begin{DoxyCompactList}\small\item\em computes the rate coefficient for three body recombination from Dere data. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a193d6c4498adc3507b41e79e52a94016}{q\+\_\+recomb\+\_\+dere} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, double electron\+\_\+temperature)
\begin{DoxyCompactList}\small\item\em Returns the collisional recombination co-\/efficient. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ad33c3a097208fb519a5e779c62e3d1f3}{q\+\_\+ioniz} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, double electron\+\_\+temperature)
\begin{DoxyCompactList}\small\item\em returns the collisional ionization rate co-\/efficient \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a432a9569392003e4470067b1c44dca5b}{q\+\_\+recomb} (struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$cont\+\_\+ptr, double electron\+\_\+temperature)
\begin{DoxyCompactList}\small\item\em Returns a collisional recombination rate co-\/efficient. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ae8bab77755879541eaede60436cfbda2}{calc\+\_\+pi\+\_\+rate} (int nion, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode, int type)
\begin{DoxyCompactList}\small\item\em int calculates the photoionization rate coefficient for an ion in a given cell \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ae2e3418a581094a1c02352db778e3d12}{tb\+\_\+planck1} (double freq)
\begin{DoxyCompactList}\small\item\em The integrand for working out the PI rate in a BB radiation field. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab952e8ceb4c53ae59abe06169acce763}{tb\+\_\+logpow1} (double freq)
\begin{DoxyCompactList}\small\item\em The integrand for working out the PI rate in a radiation field modelled by a power law. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ac6baffec2b7a559720f862e50cabec6f}{tb\+\_\+exp1} (double freq)
\begin{DoxyCompactList}\small\item\em The integrand for working out the PI rate in a radiation field modelled by an exponential. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1e569c92136f73f8643f20d8fb43f544}{matrix\+\_\+ion\+\_\+populations} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int mode)
\begin{DoxyCompactList}\small\item\em A matrix solver for the ionization state in a cell. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ac936489e8c884d738a840597081d3c04}{populate\+\_\+ion\+\_\+rate\+\_\+matrix} (double rate\+\_\+matrix\mbox{[}\hyperlink{atomic_8h_a69a2ae3d514b40bbc28d389b2cebe4dd}{nions}\mbox{]}\mbox{[}\hyperlink{atomic_8h_a69a2ae3d514b40bbc28d389b2cebe4dd}{nions}\mbox{]}, double pi\+\_\+rates\mbox{[}\hyperlink{atomic_8h_a69a2ae3d514b40bbc28d389b2cebe4dd}{nions}\mbox{]}, double inner\+\_\+rates\mbox{[}\hyperlink{atomic_8h_aac65679c70a8202e2cffb6d31973c0bf}{n\+\_\+inner\+\_\+tot}\mbox{]}, double rr\+\_\+rates\mbox{[}\hyperlink{atomic_8h_a69a2ae3d514b40bbc28d389b2cebe4dd}{nions}\mbox{]}, double b\+\_\+temp\mbox{[}\hyperlink{atomic_8h_a69a2ae3d514b40bbc28d389b2cebe4dd}{nions}\mbox{]}, double xne)
\item 
int \hyperlink{templates_8h_a37b054a7922fd8ef0a3c003f01b0aa2d}{solve\+\_\+matrix} (double $\ast$a\+\_\+data, double $\ast$b\+\_\+data, int nrows, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, int nplasma)
\begin{DoxyCompactList}\small\item\em solves the matrix equation A x = b for the vector x. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a311f414c070511a6e17313830d4d3c36}{communicate\+\_\+estimators\+\_\+para} (void)
\begin{DoxyCompactList}\small\item\em communicates the MC estimators between tasks \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ab7869aa7674de4defa57e532b23d3a2d}{gather\+\_\+spectra\+\_\+para} (int nspec\+\_\+helper, int nspecs)
\begin{DoxyCompactList}\small\item\em sum up the synthetic spectra between threads. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a426a0602a269a1d9738c39c8098ffaae}{communicate\+\_\+matom\+\_\+estimators\+\_\+para} (void)
\item 
double \hyperlink{templates_8h_a5e18aeda5d11190333c93b952b562b04}{get\+\_\+stellar\+\_\+params} (void)
\begin{DoxyCompactList}\small\item\em sets rstar, mstar, tstar as well as secondary parameters based on user inputs \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a897e0ae97c32a481075df9fc45f6e745}{get\+\_\+bl\+\_\+and\+\_\+agn\+\_\+params} (double lstar)
\begin{DoxyCompactList}\small\item\em sets up the boundary layer and agn power law parameters based on user input and system type \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_af355cb7acb867d8ada078fe8ced97f2f}{get\+\_\+domain\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em Get inputs that describe a particular component of the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a156f40c5dd5b2c76f1002d05f712b0a0}{get\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em Get detailed particular component of the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aabd8388700d83b12bace5f01320b7c06}{get\+\_\+line\+\_\+transfer\+\_\+mode} (void)
\begin{DoxyCompactList}\small\item\em Get the line transfer mode for the wind. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a404b09d110445816d66969489b854756}{setup\+\_\+windcone} (void)
\begin{DoxyCompactList}\small\item\em sets up the windcones for each domain \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a611c7cc190ffb8c6494e75ec549191f3}{get\+\_\+disk\+\_\+params} (void)
\begin{DoxyCompactList}\small\item\em get the parameters need to define a disk \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab250057e4381b5be827dcf4cd35fb3fe}{get\+\_\+kpkt\+\_\+f} (void)
\begin{DoxyCompactList}\small\item\em returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k-\/packet -\/$>$ r-\/packet in the required wavelength range. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ac8797bce5a5f3411f4162dff928b7920}{get\+\_\+matom\+\_\+f} (int mode)
\begin{DoxyCompactList}\small\item\em returns the specific band-\/limited luminosity in macro-\/atoms \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a4541dc581678aaea94bb9bdf0d38dfcf}{photo\+\_\+gen\+\_\+kpkt} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double weight, int photstart, int nphot)
\begin{DoxyCompactList}\small\item\em produces photon packets to account for creating of r-\/packets by k-\/packets in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7248f385000ac034fb3f0e3d5f45298f}{photo\+\_\+gen\+\_\+matom} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, double weight, int photstart, int nphot)
\begin{DoxyCompactList}\small\item\em produces photon packets to account for creation of r-\/packets by deactivation of macro atoms in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7de597169a947d506f6d2210de2080ac}{macro\+\_\+gov} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres}, int matom\+\_\+or\+\_\+kpkt, int $\ast$which\+\_\+out)
\begin{DoxyCompactList}\small\item\em is a routine that will sit at a higher level in the code than either matom or kpkt and will govern the passage of packets between these routines. At the moment, since matom and kpkt call each other it call all get rather confusing and loads of nested subroutine calls ensue. removes this by calling matom and kpkt which on return tell to either return an r-\/packet to resonate or make another call to either kpkt or matom as appropriate. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a590f1ed026cd692ac6f878ed6f359d5a}{macro\+\_\+pops} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double xne)
\begin{DoxyCompactList}\small\item\em uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a435ccfb2aea5f873c9508368e974eced}{do\+\_\+windsave2table} (char $\ast$root)
\begin{DoxyCompactList}\small\item\em The main routine associated with windsave2table, this routine calls various other routines which write individual files. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a9a3b2f351412426aa9e64212235177b0}{create\+\_\+master\+\_\+table} (int ndom, char rootname\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a7f76a839be4a0358447c06f58691bf13}{create\+\_\+heat\+\_\+table} (int ndom, char rootname\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_aca584fb4af447d65ee0d475d4da783b6}{create\+\_\+ion\+\_\+table} (int ndom, char rootname\mbox{[}$\,$\mbox{]}, int iz)
\item 
double $\ast$ \hyperlink{templates_8h_a05c44905d0f679cdd90dd52f13074609}{get\+\_\+ion} (int ndom, int \hyperlink{import__spherical_8c_a1d27360f25596ed5cc7188bb86556a2a}{element}, int istate, int iswitch)
\begin{DoxyCompactList}\small\item\em Get get density, etc for one particular ion. \end{DoxyCompactList}\item 
double $\ast$ \hyperlink{templates_8h_a245151df4c45767770f00123a65f1cb1}{get\+\_\+one} (int ndom, char variable\+\_\+name\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a1729341e0e93f5ca50b7c1666fa4b726}{import\+\_\+wind} (int ndom)
\begin{DoxyCompactList}\small\item\em Import a gridded model. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a757c9acbab0a0377cc2757a853d168df}{import\+\_\+make\+\_\+grid} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em Make the Python grid. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a3100d6568eff0dee456e0b05042f575e}{import\+\_\+velocity} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double $\ast$\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em Get the velocity at a position for an imported model. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a1f19ab5f3007262704d05138c63fce48}{get\+\_\+import\+\_\+wind\+\_\+params} (int ndom)
\begin{DoxyCompactList}\small\item\em get parameters associated with an imported wind model \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ad6061b2ae811618355cf3d1058b14a65}{import\+\_\+rho} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Get the density at an arbitray position in an imported model. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_af9113b1ccc566370cf547f2a6292a29e}{import\+\_\+1d} (int ndom, char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Read the an arbitray wind model intended to mimic a stellar wind or shell. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a635decc081c41b8ab55d8b547408970a}{spherical\+\_\+make\+\_\+grid\+\_\+import} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em Use the imported data to initialize various portions of the Wind and Domain structures. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aedb7294b79d53f3a732f2738a2f9b991}{velocity\+\_\+1d} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double $\ast$\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em The velocity at any positiion in an imported spherical model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab30248c42430af95e6b02e95dbc05db0}{rho\+\_\+1d} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Get the density for an imported spherical model at x. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ae1cdacb786e677fab7288bcc53dc722f}{import\+\_\+cylindrical} (int ndom, char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Read the an arbitray wind model in cylindrical coordinates. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_afe381010f3abbac0bcdba71d37f95bef}{cylindrical\+\_\+make\+\_\+grid\+\_\+import} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em Use the imported data to initialize various portions of the Wind and Domain structures. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a27c9c697b3fdd67b7b4fe6626abf3a65}{velocity\+\_\+cylindrical} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double $\ast$\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em The velocity at any positiion in an imported cylindrical model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a632e5656a7655882be49d9ab436b0372}{rho\+\_\+cylindrical} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Get the density for an imported cylindrical model at x. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a831ead9a3678221f5b2e7a1f95abc725}{import\+\_\+rtheta} (int ndom, char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Read the an arbitray wind model in polar coordinates. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a8b3c1f6c4930f2daf2e4b20af1956787}{rtheta\+\_\+make\+\_\+grid\+\_\+import} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int ndom)
\begin{DoxyCompactList}\small\item\em Use the imported data to initialize various portions of the Wind and Domain structures. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a1694a241d722667936d776953cad5fa5}{velocity\+\_\+rtheta} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, double $\ast$\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em The velcity at any position in an imported rtheat model. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a59c2682b3dc23f5ce1ce89012e5a68f3}{rho\+\_\+rtheta} (int ndom, double $\ast$\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em Get the density for an imported rtheta model at x. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aa5efed3848af045bb3035fc6db93e757}{delay\+\_\+to\+\_\+observer} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em Calculates the delay to the observer plane. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aed071173676fa884b0045139793c85d7}{delay\+\_\+dump\+\_\+prep} (int restart\+\_\+stat)
\begin{DoxyCompactList}\small\item\em Prepares delay dump output file. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a835e66c48118aa52e1903512ed676f20}{delay\+\_\+dump\+\_\+finish} (void)
\begin{DoxyCompactList}\small\item\em Finishes dumping tracked photons to file. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a83531c4a215b42e705cd97b00088be71}{delay\+\_\+dump\+\_\+combine} (int i\+\_\+ranks)
\begin{DoxyCompactList}\small\item\em Prepares delay dump output file. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ac0ede87d97addcd4c5df57e2930dbdb6}{delay\+\_\+dump} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, int np)
\begin{DoxyCompactList}\small\item\em Dumps tracked photons to file. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a30c0a9051caebba27b5ef5583d38ad0c}{delay\+\_\+dump\+\_\+single} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int i\+\_\+spec)
\begin{DoxyCompactList}\small\item\em Preps a single photon to be dumped. \end{DoxyCompactList}\item 
\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} \hyperlink{templates_8h_ac4d257a6939bcb61d002923ae8fbc1fc}{wind\+\_\+paths\+\_\+constructor} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind})
\begin{DoxyCompactList}\small\item\em Allocates the arrays for a path histogram. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a782f80aab666cb86b3a296856d1f34e6}{reverb\+\_\+init} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind})
\begin{DoxyCompactList}\small\item\em Initialises everything for reverb mapping. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a0d8a68cc8cb0e384901a71173dbc333f}{wind\+\_\+paths\+\_\+init} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind})
\begin{DoxyCompactList}\small\item\em Initialises wind path structures. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ab2919946d2f7195f5e532eefeae7dd2d}{line\+\_\+paths\+\_\+add\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int $\ast$\hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em Following a line emission, increments cell paths. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7fe8e6139b53b931c68d444216bfd0fe}{wind\+\_\+paths\+\_\+add\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em Registers a photon passage with a wind cell. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a7719923b66bf470bc4eeb42c454ebd48}{simple\+\_\+paths\+\_\+gen\+\_\+phot} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em Generates path for a \textquotesingle{}wind\textquotesingle{} photon in photon mode. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_a43541dacfceb46c42583c31aeb11d496}{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram} (\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} Path\+Ptr)
\begin{DoxyCompactList}\small\item\em Draws a random path from a path histogram. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a176ee6debad2930212ca97a2d28794c0}{wind\+\_\+paths\+\_\+gen\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp)
\begin{DoxyCompactList}\small\item\em Generates path for a wind photon. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a376d6bf65b4a156a45f28b56bc4c017d}{line\+\_\+paths\+\_\+gen\+\_\+phot} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} pp, int \hyperlink{python_8h_ac1f90b11b79f8d2c9a25f12643063ee7}{nres})
\begin{DoxyCompactList}\small\item\em Generates path for a macro-\/atom line photon. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_adac039bc6269033412fa861aa78aa111}{wind\+\_\+paths\+\_\+evaluate\+\_\+single} (\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} paths)
\begin{DoxyCompactList}\small\item\em Evaluates individual wind cell paths. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a210e77beda2c9c25b9008de9107a17f8}{wind\+\_\+paths\+\_\+evaluate} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int i\+\_\+rank)
\begin{DoxyCompactList}\small\item\em Evaluates wind path details for a cycle. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_acfc3937b157db869057d3f33613b2e87}{wind\+\_\+paths\+\_\+dump} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int \hyperlink{python_8h_a48632b55b333d2627f6a1ddd87b3d7ea}{rank\+\_\+global})
\begin{DoxyCompactList}\small\item\em Dumps wind path arrays for a wind cell. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_abcd463073ed7efc165937715a983b7b7}{wind\+\_\+paths\+\_\+output\+\_\+dump} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int i\+\_\+rank)
\begin{DoxyCompactList}\small\item\em Iterates through the wind, dumping cells of interest. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a84734785aa6884b89825ac2b84ad5f54}{wind\+\_\+paths\+\_\+point\+\_\+index} (int \hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, int k, int i\+\_\+top, \hyperlink{python_8h_ae022cd774d7ee369fc758eff33990847}{Domain\+Ptr} dom)
\begin{DoxyCompactList}\small\item\em Given trz index in wind, returns vtk data index. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_afd823b3b0d87b9378a04d10604a29cf1}{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index} (int \hyperlink{import__rtheta_8c_ab47e1e72aea1af4158c96f38ee80b8f7}{i}, int \hyperlink{import__rtheta_8c_ad9db47ad8a21025384c0b7f8fc0a61cc}{j}, int k)
\begin{DoxyCompactList}\small\item\em Given rtt index in wind, returns vtk data index. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ad7572cd8c842aa9c3ee2476a89888ec4}{wind\+\_\+paths\+\_\+output\+\_\+vtk} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{structwind}{wind}, int ndom)
\begin{DoxyCompactList}\small\item\em Outputs wind path information to vtk. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a555f188199cb3346b32e289e64c9d980}{init\+\_\+geo} (void)
\begin{DoxyCompactList}\small\item\em initializes the geo structure to something that is semi-\/reasonable \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_ab358cbada062a9acccdf184b57630305}{get\+\_\+spectype} (int yesno, char $\ast$question, int $\ast$spectype)
\begin{DoxyCompactList}\small\item\em Generalized routine to get the spectrum type for a radiation source and if necessary read a set of precalculated spectra. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_af01dfd90f1eaaa70104a594dd92bd30c}{init\+\_\+advanced\+\_\+modes} (void)
\begin{DoxyCompactList}\small\item\em simply initialises the set of advanced modes stored in the modes structure to a default value. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_afc4ebd7d545f29d6e3a9505cf462c62c}{init\+\_\+observers} (void)
\begin{DoxyCompactList}\small\item\em get inputs that describe the detailed spectra that one intends to extract. \end{DoxyCompactList}\item 
\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} \hyperlink{templates_8h_a3eba280b12bdc0cafaf8a7fbe33a887a}{init\+\_\+photons} (void)
\begin{DoxyCompactList}\small\item\em gets information about the number of cycles and how many photons there should be per cycle. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a887b555bea1486a6c04a71838b690b63}{init\+\_\+ionization} (void)
\begin{DoxyCompactList}\small\item\em Select the ionization and line transfer modes, along with various other parameters about ionization. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab0e6804f11862cb19cf6ac6976480c3f}{setup\+\_\+dfudge} (void)
\begin{DoxyCompactList}\small\item\em Sets a global \char`\"{}push\+\_\+through\+\_\+distance\char`\"{} designed to prevent photons from being trapped at boundaries. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a28fc174aa63a5eeef6de99ef392e1616}{calculate\+\_\+ionization} (int restart\+\_\+stat)
\begin{DoxyCompactList}\small\item\em run the ionization cycles for a python model \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_abc2ad803345c801984f4dc64d4d4a9e0}{make\+\_\+spectra} (int restart\+\_\+stat)
\begin{DoxyCompactList}\small\item\em generates the detailed spectra \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aaf2a9843cc170d6b01b75a1704f8c4fb}{integ\+\_\+brem} (double freq)
\begin{DoxyCompactList}\small\item\em The integrand used in qromb to compute the luminosity of a bremstrahlung source. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_ab308d8424a5b2ab066577630b7150e7b}{brem\+\_\+d} (double \hyperlink{templates_8h_a89a27f4f3a5c836df75585774ba7a643}{alpha})
\begin{DoxyCompactList}\small\item\em The integrand for integrating a dimensionless bremstrahlung spectrum. \end{DoxyCompactList}\item 
double \hyperlink{templates_8h_aea33eee38cf4a6c25978443404ddaf2c}{get\+\_\+rand\+\_\+brem} (double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em Obtain a random frequency photon from a bremstrahlung spectrum. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a98a10e927f2b5ba88c7d5b4fc51d477d}{check\+\_\+synonyms} (char new\+\_\+question\mbox{[}$\,$\mbox{]}, char old\+\_\+question\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a4017af15d8bd072936049dafc4250a1b}{get\+\_\+meta\+\_\+params} (void)
\begin{DoxyCompactList}\small\item\em Gets parameters from input file for reverb and visualisation settings. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa82b71670033cd85494ad043285e8c75}{zoom} (int direction)
\item 
int \hyperlink{templates_8h_a029129746366e70434428ddf3bf2c54b}{overview} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a43f10249d2500ec53e8e19e42f0f0c61}{position\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\item 
int \hyperlink{templates_8h_a1b892d9b8edae8228ca8a265c20c7eee}{abs\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_aed40a349ee04ac4bea21993a4237c5ec}{adiabatic\+\_\+cooling\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ac86577f6c683d765ba99ffefaaa0fb32}{lum\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ae93657d141864bdb95912c5e37df8c0c}{photo\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a5127b2ba8d9a97446178bb48eff3e586}{recomb\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_aadfef07cd398269d10d8c8e4b91986d1}{electron\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a8f9cb993121bb966a8504a069b17a993}{rho\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a9819dcbdbc4776804bc8acf00e47cefc}{plasma\+\_\+cell} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ae0a25dafbba4fa94dab4b4876b6b6d1a}{freq\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a284000511485a77f13843b2019a77a01}{nphot\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a5f3da2160302fbd2c3edcfabdd480bfe}{temp\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a26d57a83794fb6663434158ab7e898cf}{temp\+\_\+rad} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ae344297a6e533d8464a20ca9a7bbfc2f}{weight\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a73540a1a2630d25b811ed098f11721bf}{velocity\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a0413fc3066769f8cb8b90e8f6bbe2ba4}{mo\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a07341747eace7108cf66af7fa8846b0d}{vol\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a83eeb6fe319aa5af7c8400e921273323}{wind\+\_\+element} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\item 
int \hyperlink{templates_8h_a8f9228dcd9e8de7e3dce87f75812a958}{tau\+\_\+h\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a549b1632252bd1dece18e5caffe35a94}{coolheat\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_aa1fe87e4faadd450e5c741ea35a93cc6}{complete\+\_\+file\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char root\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a8f1809d0fc03ad74b934bd6746f15e38}{wind\+\_\+reg\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a1ab28108b78d1f2ef6a5eb725a9d1ea8}{dvds\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a5444ce9f7285f1e9130f37f9fd40191a}{inner\+\_\+shell\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ad3a1f2e40456d8b008219f245901c0cd}{I\+P\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a8a4a782e9684eb71dac8f20a621b21fb}{alpha\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_aa58fa697f4943c2aeca9ba27cf96dc88}{J\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a8088e64c83fc1e5243732af75e25ec91}{J\+\_\+scat\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a48d3738f0439bd8c0cf75be5914acfc3}{phot\+\_\+split} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_af5845b25bdbd8c63768154df5f3af346}{thompson} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_aeae759ecb9918713caa2fe23a9aa2d53}{nscat\+\_\+split} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a2d54e6320e5c5e8b5d8e8356111ed47e}{convergence\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ade9ceff466d96f388787e6395e8171e5}{convergence\+\_\+all} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_aff983708ba7fa4bd14428a0b5c39097c}{model\+\_\+bands} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a56359478a45c86dc30b59f4758a9f4b8}{heatcool\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a4b2a86e53b88734058364fa5d54b2910}{complete\+\_\+physical\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_aa4bf64b7b93fd56daf8b291122eb107d}{complete\+\_\+ion\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
double \hyperlink{templates_8h_abcbb806bcc4d97f3c38d995b05756317}{get\+\_\+density\+\_\+or\+\_\+frac} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, int \hyperlink{import__spherical_8c_a1d27360f25596ed5cc7188bb86556a2a}{element}, int istate, int frac\+\_\+choice)
\item 
int \hyperlink{templates_8h_a4980d1ea5c262038e2836a2d3a06f053}{find\+\_\+ion} (int \hyperlink{import__spherical_8c_a1d27360f25596ed5cc7188bb86556a2a}{element}, int istate)
\item 
int \hyperlink{templates_8h_af6512a7f0dc1a503410409043ff4eaa3}{find\+\_\+element} (int \hyperlink{import__spherical_8c_a1d27360f25596ed5cc7188bb86556a2a}{element})
\item 
int \hyperlink{templates_8h_a88c68bc653bd48b9e892d971a3061e08}{get\+\_\+los\+\_\+dvds} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ae2eb8e9a77749d7d10fcbe76317e7031}{grid\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\begin{DoxyCompactList}\small\item\em Prints grid boundaries to file. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_aa0fd17466db7bef61e7dcef96737cb00}{ion\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int \hyperlink{import__spherical_8c_a1d27360f25596ed5cc7188bb86556a2a}{element}, int istate, int iswitch, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a6a27d9f69b11280ae32d47603b94188a}{tau\+\_\+ave\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int \hyperlink{import__spherical_8c_a1d27360f25596ed5cc7188bb86556a2a}{element}, int istate, double freq, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a0bef6952219011c118a234daaf9c5f14}{line\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a4bd01941ec880877c6dbd3cbd37aaf06}{total\+\_\+emission\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_ab2e9d091ce799b56c0f3a9843989d383}{modify\+\_\+te} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a3d9d06afb63624f6bc6660c0bcd30057}{partial\+\_\+measure\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, int \hyperlink{import__spherical_8c_a1d27360f25596ed5cc7188bb86556a2a}{element}, int istate, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a8978f1b841dee7dbdab9ec6ff0b1320c}{collision\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a2fe32522b8e86fa83527e71906d634ef}{write\+\_\+array} (char filename\mbox{[}$\,$\mbox{]}, int choice)
\item 
int \hyperlink{templates_8h_a4f972e01804594e4d4a5375e39807495}{display} (char name\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{templates_8h_a73ab7eda651994b533e79cc4d7957198}{xadiabatic\+\_\+cooling\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a3dfc87517f580270c057d489688e7fcb}{macro\+\_\+summary} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a8086fb90b34ab086655b4634ff343ef0}{ion\+\_\+overview} (int icell)
\begin{DoxyCompactList}\small\item\em macro\+\_\+summary is a routine intended to allow one to display information about macro atoms. It is the top level routine for macro information and requires further input from the user. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a75214023fe99c4bd23e5cb5771bf5d0c}{config\+\_\+overview} (int n, int icell)
\begin{DoxyCompactList}\small\item\em macro\+\_\+summary is a routine intended to allow one to display information about macro atoms. It is the top level routine for macro information and requires further input from the user. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a74e9a1ed7ffcb66086ca24b9cc1d280f}{depcoef\+\_\+overview} (int icell)
\begin{DoxyCompactList}\small\item\em is a routine which prints information about departure coefficients and level populations in a cell. There is probably a crossover between this and level\+\_\+popsoverview \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_af0f8c109cc6e8e390c754e74ad3f48fd}{copy\+\_\+plasma} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ac75b803b570527306e1e744bfb7a604f}{x1}, \hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} x2)
\begin{DoxyCompactList}\small\item\em Routine to copy the necessary parts of a plasma structure for computing a set of level populations. x1 points to the cell from which data is copied and x2 points to the cell to which data is copied. \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a2765e7cfe15e6273a2140427a551176b}{dealloc\+\_\+copied\+\_\+plasma} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} xcopy)
\begin{DoxyCompactList}\small\item\em deallocate copied plasma arrays, helper routine \end{DoxyCompactList}\item 
int \hyperlink{templates_8h_a40c328f946d3dbfda7d056bdddd6945a}{depcoef\+\_\+overview\+\_\+specific} (int version, int nconfig, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a5edae3f102ed4ad84228bcc25a1a1492}{level\+\_\+popsoverview} (int nplasma, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_af4c13ec6f6c32377d10896bb62307ee8}{level\+\_\+emissoverview} (int nlev, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a1c6a9b3e9e1723a645c46145ec46183f}{level\+\_\+escapeoverview} (int nlev, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a99d06420894c52dbbc268002c4f7f3d3}{level\+\_\+tauoverview} (int nlev, \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, char rootname\mbox{[}$\,$\mbox{]}, int ochoice)
\item 
int \hyperlink{templates_8h_a7b75986421190b20cefeca5ee6566be1}{one\+\_\+choice} (int choice, char $\ast$root, int ochoice)
\item 
int \hyperlink{templates_8h_a11cd39cf061a4a4779bf7c3500b5a631}{py\+\_\+wind\+\_\+help} (void)
\begin{DoxyCompactList}\small\item\em print out some helpful information to the screen and exits \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{templates_8h_a8c589bd3089b7851e8da407ad1ce44a5}\label{templates_8h_a8c589bd3089b7851e8da407ad1ce44a5}} 
\index{templates.\+h@{templates.\+h}!a21@{a21}}
\index{a21@{a21}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{a21()}{a21()}}
{\footnotesize\ttfamily double a21 (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr }\end{DoxyParamCaption})}



Calculate the Einstein A coefficient for a transition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em struct} & lines $\ast$ line\+\_\+ptr Ptr containing data describing the line \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Einsten (a21) value
\end{DoxyReturn}
\paragraph*{Notes}

The routine checks whether we are asking for the same a21 as previously, and if so returns it without redoing the calculation.

Calculate the Einstein A coefficient for a transition.


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} struct lines $\ast$ line\+\_\+ptr The structure that describes a single line \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Einstein A coefficient
\end{DoxyReturn}
Using the oscillator strecnth and the multiplicity (which are read in) calculate A

\paragraph*{Notes}

Definition at line 103 of file atomic.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8c589bd3089b7851e8da407ad1ce44a5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1b892d9b8edae8228ca8a265c20c7eee}\label{templates_8h_a1b892d9b8edae8228ca8a265c20c7eee}} 
\index{templates.\+h@{templates.\+h}!abs\+\_\+summary@{abs\+\_\+summary}}
\index{abs\+\_\+summary@{abs\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{abs\+\_\+summary()}{abs\_summary()}}
{\footnotesize\ttfamily int abs\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_acbbafed45b10980bb86fe7950daa0604}\label{templates_8h_acbbafed45b10980bb86fe7950daa0604}} 
\index{templates.\+h@{templates.\+h}!adiabatic\+\_\+cooling@{adiabatic\+\_\+cooling}}
\index{adiabatic\+\_\+cooling@{adiabatic\+\_\+cooling}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{adiabatic\+\_\+cooling()}{adiabatic\_cooling()}}
{\footnotesize\ttfamily double adiabatic\+\_\+cooling (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t }\end{DoxyParamCaption})}



determines the amount of adiabatic cooling in a cell, in units of luminosity. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one pointer to wind cell \\
\hline
\mbox{\tt in}  & {\em double} & t electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The adiabiatic cooling (or heating) of a cell
\end{DoxyReturn}
Adiabatic cooling is the amount of PdV work done by a fluid element, per unit time dt. Thus it is equal to P d\+V/dt. d\+V/dt is given by $\ast$ the volume $\ast$ div v. As is evident from this what we call adiabatic cooling can heat the wind if div v is negative.

\paragraph*{Notes}

In calculating the adiabatic cooling we include the pressure from all particles. Adiabatic coolling due to the radiation pressure is not considered.

The routine does not populate xplasma-\/$>$cool\+\_\+adiabatic.

Note also that this function should only be called if geo.\+adiabatic == 1, in which case it populates xplasma-\/$>$cool\+\_\+adiabatic. This is used in heating and cooling balance. We also use it as a potential destruction choice for kpkts in which case the kpkt is thrown away by setting its istat to P\+\_\+\+A\+D\+I\+A\+B\+A\+T\+IC.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000011}{Bug}]The statements here about not calling this routine are odd. There is no reason that the routine cannot be called any time since it does not populate cool\+\_\+adiabatic. And what really shold happen if we do not want to use cool\+\_\+adiabatic is that we should check when we want to calculate the total cooling that it is not done.\end{DoxyRefDesc}


Definition at line 270 of file cooling.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_acbbafed45b10980bb86fe7950daa0604_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_acbbafed45b10980bb86fe7950daa0604_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aed40a349ee04ac4bea21993a4237c5ec}\label{templates_8h_aed40a349ee04ac4bea21993a4237c5ec}} 
\index{templates.\+h@{templates.\+h}!adiabatic\+\_\+cooling\+\_\+summary@{adiabatic\+\_\+cooling\+\_\+summary}}
\index{adiabatic\+\_\+cooling\+\_\+summary@{adiabatic\+\_\+cooling\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{adiabatic\+\_\+cooling\+\_\+summary()}{adiabatic\_cooling\_summary()}}
{\footnotesize\ttfamily int adiabatic\+\_\+cooling\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c}\label{templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c}} 
\index{templates.\+h@{templates.\+h}!agn\+\_\+init@{agn\+\_\+init}}
\index{agn\+\_\+init@{agn\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{agn\+\_\+init()}{agn\_init()}}
{\footnotesize\ttfamily double agn\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{r,  }\item[{double}]{lum,  }\item[{double}]{alpha,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{double $\ast$}]{f }\end{DoxyParamCaption})}



Calculates the total luminosity of an A\+GN type source. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r radius of emitting object \\
\hline
\mbox{\tt in}  & {\em double} & lum the luminosity of the A\+GN (2-\/10keV) -\/ X\+XX I\textquotesingle{}m not sure this is used apart from \\
\hline
\mbox{\tt in}  & {\em double} & alpha the spectral index of the PL source -\/ also sometimes used for a temperature if a BB source is required \\
\hline
\mbox{\tt in}  & {\em double} & freqmin minimum frequency to integrate over \\
\hline
\mbox{\tt in}  & {\em double} & freqmax maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final flag to say if we are in the ionization cycles or spectral cycle \\
\hline
\mbox{\tt out}  & {\em double} & f the returned luminosity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
f -\/ the luminosity -\/ seems to be returned as well as set implicitly.
\end{DoxyReturn}
This routine is used when one is working out how many photons will be made from each of several sources. This computes the total luminosity of a source of radius r, with spectral index alpha between band boundaries given by freqmin and freqmax

\paragraph*{Notes}

There seem to be some inconsistencies here -\/ lum (the 2-\/10keV luminosity of the PL source) is supplied but it doesnt seem to be used apart from in the emittance\+\_\+continuum which is nonsense -\/ this requires a temperature and a local gravity Another inconsistency is that the bremstrahlung code uses values for T and alpha that are stored in the geo structure, whilst the power law uses data supplied in the code. 

Definition at line 54 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab6c8e4e9577a9edb71a9a5900d43964c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a89a27f4f3a5c836df75585774ba7a643}\label{templates_8h_a89a27f4f3a5c836df75585774ba7a643}} 
\index{templates.\+h@{templates.\+h}!alpha@{alpha}}
\index{alpha@{alpha}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{alpha()}{alpha()}}
{\footnotesize\ttfamily double alpha (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



The \textquotesingle{}heating\textquotesingle{} cross section correction to Thompson. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
alpha-\/ the effective heating cross section relative to sigma\+\_\+T
\end{DoxyReturn}
We calculate compton heating due to photons passing through a parcel of gas using an opacity. In order to work out the opacity, we need the cross section that the electrons present to the photons, and in order to take proper account of the energy transfer during a scatter we use a \textquotesingle{}heating crosss ection\textquotesingle{}. This is equal to \textquotesingle{}alpha\textquotesingle{} times the Thompson cross section -\/ we calculate alpha here.

\paragraph*{Notes}

The fit used here is given in Hazy 3, eq 6.\+6 

Definition at line 437 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=186pt]{templates_8h_a89a27f4f3a5c836df75585774ba7a643_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a89a27f4f3a5c836df75585774ba7a643_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a53e97649d5cd9a1fab024ab99489ddb1}\label{templates_8h_a53e97649d5cd9a1fab024ab99489ddb1}} 
\index{templates.\+h@{templates.\+h}!alpha\+\_\+sp@{alpha\+\_\+sp}}
\index{alpha\+\_\+sp@{alpha\+\_\+sp}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{alpha\+\_\+sp()}{alpha\_sp()}}
{\footnotesize\ttfamily double alpha\+\_\+sp (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{ichoice }\end{DoxyParamCaption})}



Definition at line 584 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{templates_8h_a53e97649d5cd9a1fab024ab99489ddb1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{templates_8h_a53e97649d5cd9a1fab024ab99489ddb1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aee2caf449c574d065a2cf67664783ace}\label{templates_8h_aee2caf449c574d065a2cf67664783ace}} 
\index{templates.\+h@{templates.\+h}!alpha\+\_\+sp\+\_\+integrand@{alpha\+\_\+sp\+\_\+integrand}}
\index{alpha\+\_\+sp\+\_\+integrand@{alpha\+\_\+sp\+\_\+integrand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{alpha\+\_\+sp\+\_\+integrand()}{alpha\_sp\_integrand()}}
{\footnotesize\ttfamily double alpha\+\_\+sp\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



This returns the integrand for alpha\+\_\+sp at a chosen frequency -\/. 



Definition at line 625 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{templates_8h_aee2caf449c574d065a2cf67664783ace_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aee2caf449c574d065a2cf67664783ace_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a034f4f5a8a3102d5224cf211c11d6abc}\label{templates_8h_a034f4f5a8a3102d5224cf211c11d6abc}} 
\index{templates.\+h@{templates.\+h}!alpha\+\_\+st\+\_\+e\+\_\+integrand@{alpha\+\_\+st\+\_\+e\+\_\+integrand}}
\index{alpha\+\_\+st\+\_\+e\+\_\+integrand@{alpha\+\_\+st\+\_\+e\+\_\+integrand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{alpha\+\_\+st\+\_\+e\+\_\+integrand()}{alpha\_st\_e\_integrand()}}
{\footnotesize\ttfamily double alpha\+\_\+st\+\_\+e\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



the integrand for alpha\+\_\+st\+\_\+e at a chosen frequency 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
the integrand for the energy-\/weighted stimulated recombination estimator see equation 3.\+68 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1287 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{templates_8h_a034f4f5a8a3102d5224cf211c11d6abc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a034f4f5a8a3102d5224cf211c11d6abc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae1c68aef7b2918706acea6da976e3cf4}\label{templates_8h_ae1c68aef7b2918706acea6da976e3cf4}} 
\index{templates.\+h@{templates.\+h}!alpha\+\_\+st\+\_\+integrand@{alpha\+\_\+st\+\_\+integrand}}
\index{alpha\+\_\+st\+\_\+integrand@{alpha\+\_\+st\+\_\+integrand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{alpha\+\_\+st\+\_\+integrand()}{alpha\_st\_integrand()}}
{\footnotesize\ttfamily double alpha\+\_\+st\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



returns the integrand for alpha\+\_\+st at a chosen frequency 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
integrand for the stimulated recombination rate estimator, in equation 3.\+65 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1199 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=251pt]{templates_8h_ae1c68aef7b2918706acea6da976e3cf4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ae1c68aef7b2918706acea6da976e3cf4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8a4a782e9684eb71dac8f20a621b21fb}\label{templates_8h_a8a4a782e9684eb71dac8f20a621b21fb}} 
\index{templates.\+h@{templates.\+h}!alpha\+\_\+summary@{alpha\+\_\+summary}}
\index{alpha\+\_\+summary@{alpha\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{alpha\+\_\+summary()}{alpha\_summary()}}
{\footnotesize\ttfamily int alpha\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9006d7b3b01cfef2acdd6a68cc34434f}\label{templates_8h_a9006d7b3b01cfef2acdd6a68cc34434f}} 
\index{templates.\+h@{templates.\+h}!auger\+\_\+ionization@{auger\+\_\+ionization}}
\index{auger\+\_\+ionization@{auger\+\_\+ionization}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{auger\+\_\+ionization()}{auger\_ionization()}}
{\footnotesize\ttfamily int auger\+\_\+ionization (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ac84f4556e3972c1fe39b74fd9b7b4241}\label{templates_8h_ac84f4556e3972c1fe39b74fd9b7b4241}} 
\index{templates.\+h@{templates.\+h}!b12@{b12}}
\index{b12@{b12}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{b12()}{b12()}}
{\footnotesize\ttfamily double b12 (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr }\end{DoxyParamCaption})}



Definition at line 530 of file matom.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{templates_8h_ac84f4556e3972c1fe39b74fd9b7b4241_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3513a64162c15d3d3d101c3d5ea2367f}\label{templates_8h_a3513a64162c15d3d3d101c3d5ea2367f}} 
\index{templates.\+h@{templates.\+h}!bands\+\_\+init@{bands\+\_\+init}}
\index{bands\+\_\+init@{bands\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{bands\+\_\+init()}{bands\_init()}}
{\footnotesize\ttfamily int bands\+\_\+init (\begin{DoxyParamCaption}\item[{int}]{imode,  }\item[{struct \hyperlink{structxbands}{xbands} $\ast$}]{band }\end{DoxyParamCaption})}



This is the routine that initializes the bands. 

Python uses a form of stratified sampling in an attempt to assure that there are photon bundles at (high, generally) frequencies

This is the routine that initializes the bands. There are a number of possiblilities for setting up the bands


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & imode A switch used for determining how the bands are to be populated \\
\hline
\mbox{\tt out}  & {\em struct} & xbands $\ast$ band The structure that is populated with the band information \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine itself simply returns 0 on success
\end{DoxyReturn}
The outputs are passed to other routines through the pointer to xbands.

The currently allow modes are $\ast$0 Use temperature to define a single band $\ast$1 Use f1 and f2 to define a single band $\ast$2 Use t,f1 and f2, and hardwired bands to define multiple bands which have been tuned to be relevent to C\+Vs and other systems where a hot disk (T\+\_\+eff of about 100,000 K is assumed
\begin{DoxyItemize}
\item 3 Bands tuned for yso
\item 4 Query the user to specify an arbitrary set of bands
\item 5 Hardwired very wide bands for testing $\ast$6 Bands set up by nsh to test cloudy $\ast$7 Bands hardwired for A\+GN paper1 by nsh $\ast$8 Define bands in logarithmic intervals
\end{DoxyItemize}

\paragraph*{Notes}

10nov -\/ ksl -\/ X\+XX Some of the choices have checks to see whether the bands that are being set up lie within f1 and f2. Others do not. This seems like an error.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000003}{Bug}]At some point some of the banding needs to be tested systematically. We have tended to find a setup that we like and just use it.\end{DoxyRefDesc}


Definition at line 123 of file bands.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3513a64162c15d3d3d101c3d5ea2367f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=200pt]{templates_8h_a3513a64162c15d3d3d101c3d5ea2367f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa85aa8b5ea483c44b26216b963015484}\label{templates_8h_aa85aa8b5ea483c44b26216b963015484}} 
\index{templates.\+h@{templates.\+h}!bb\+\_\+estimators\+\_\+increment@{bb\+\_\+estimators\+\_\+increment}}
\index{bb\+\_\+estimators\+\_\+increment@{bb\+\_\+estimators\+\_\+increment}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{bb\+\_\+estimators\+\_\+increment()}{bb\_estimators\_increment()}}
{\footnotesize\ttfamily int bb\+\_\+estimators\+\_\+increment (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{tau\+\_\+sobolev,  }\item[{double}]{dvds,  }\item[{int}]{nn }\end{DoxyParamCaption})}



increment the matom bound-\/bound estimators 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one pointer to cell \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p the packet \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+sobolev optical depth of line \\
\hline
\mbox{\tt in}  & {\em double} & dvds velocity gradient \\
\hline
\mbox{\tt in}  & {\em int} & nn the label for the line in question \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 1 if the line was a \char`\"{}simple\char`\"{} line. The routine should not have been called if that was the case.
\end{DoxyReturn}
increment the matom bound-\/bound estimators as needed for the macro atom calculations. Whenever a packet comes into resonance with a line this routine is called W\+H\+E\+T\+H\+ER OR N\+OT the packet interacts with the line. The estimator is not normalised here. That is done later.

\paragraph*{Notes}

The estimators are not normalised by this routine For the moment, the increment to the estimator is taken to be weight $\ast$ (1 -\/ exp(-\/tau))/ tau / dvds This is slightly different from what I do in my code (not accurate to v/c corrections). If calculations where accuracy to order v/c is needed then this routine should be improved. 

Definition at line 312 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa85aa8b5ea483c44b26216b963015484_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{templates_8h_aa85aa8b5ea483c44b26216b963015484_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5dcca3c33cb0db12719fcc6a79958119}\label{templates_8h_a5dcca3c33cb0db12719fcc6a79958119}} 
\index{templates.\+h@{templates.\+h}!bb\+\_\+simple\+\_\+heat@{bb\+\_\+simple\+\_\+heat}}
\index{bb\+\_\+simple\+\_\+heat@{bb\+\_\+simple\+\_\+heat}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{bb\+\_\+simple\+\_\+heat()}{bb\_simple\_heat()}}
{\footnotesize\ttfamily int bb\+\_\+simple\+\_\+heat (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{tau\+\_\+sobolev,  }\item[{double}]{dvds,  }\item[{int}]{nn }\end{DoxyParamCaption})}



records the heating contribution from lines of simple elements. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Plasma\+Ptrxplasma} & \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p the packet \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+sobolev optical depth of line \\
\hline
\mbox{\tt in}  & {\em double} & dvds velocity gradient \\
\hline
\mbox{\tt in}  & {\em int} & nn the label for the line in question \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success
\end{DoxyReturn}
records the heating contribution from lines of simple elements. It is called whenever a packet comes into resonance with the line and records the heating contribution from that line and packet 

Definition at line 850 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=254pt]{templates_8h_a5dcca3c33cb0db12719fcc6a79958119_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=243pt]{templates_8h_a5dcca3c33cb0db12719fcc6a79958119_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5bffcc1725b11f5b35c37b406aaec263}\label{templates_8h_a5bffcc1725b11f5b35c37b406aaec263}} 
\index{templates.\+h@{templates.\+h}!beta@{beta}}
\index{beta@{beta}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{beta()}{beta()}}
{\footnotesize\ttfamily double beta (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



The \textquotesingle{}cooling\textquotesingle{} cross section correction to Thompson. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
beta -\/ the effective cooling cross section relative to sigma\+\_\+T
\end{DoxyReturn}
The inverse compton cooling rate in a cell is computed by ingegrating the mean intensity in that cell by the frequency dependant cross section. In order to take account of the energy transfer in an interaction, the cross section must be the effective cooling cross section (not just the Klein Nishina cross section)

\paragraph*{Notes}

The fit used here is given in Hazy 3, eq 6.\+6 

Definition at line 469 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{templates_8h_a5bffcc1725b11f5b35c37b406aaec263_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a5bffcc1725b11f5b35c37b406aaec263_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a141c8c8db4119b46cba7dcff5de861b3}\label{templates_8h_a141c8c8db4119b46cba7dcff5de861b3}} 
\index{templates.\+h@{templates.\+h}!bf\+\_\+estimators\+\_\+increment@{bf\+\_\+estimators\+\_\+increment}}
\index{bf\+\_\+estimators\+\_\+increment@{bf\+\_\+estimators\+\_\+increment}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{bf\+\_\+estimators\+\_\+increment()}{bf\_estimators\_increment()}}
{\footnotesize\ttfamily int bf\+\_\+estimators\+\_\+increment (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds }\end{DoxyParamCaption})}



increment the matom bound-\/free estimators 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one pointer to cell \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p the packet \\
\hline
\mbox{\tt in}  & {\em double} & ds the path length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
increment the bound-\/free estimators as needed for the macro atom calculations. Whenever a packet travels a path length ds through a shell the estimator for all bound-\/free processes where the packet frequency is above the threshold frequency is incremented. The estimator is not normalised here. That is done later.

\paragraph*{Notes}

The estimators are not normalised by this routine. This routine also computes the total heating rate due to simple ions. Therefore the routine needs to be called even for the simple non-\/macro atom case.

The bound-\/free estimators are described in section 3.\+3.\+3.\+1 Matthews Phd Thesis. 

Definition at line 57 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a141c8c8db4119b46cba7dcff5de861b3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a141c8c8db4119b46cba7dcff5de861b3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a31c06318250f485d9337c958b118ffe5}\label{templates_8h_a31c06318250f485d9337c958b118ffe5}} 
\index{templates.\+h@{templates.\+h}!bilin@{bilin}}
\index{bilin@{bilin}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{bilin()}{bilin()}}
{\footnotesize\ttfamily int bilin (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{x00\mbox{[}$\,$\mbox{]},  }\item[{double}]{x01\mbox{[}$\,$\mbox{]},  }\item[{double}]{x10\mbox{[}$\,$\mbox{]},  }\item[{double}]{x11\mbox{[}$\,$\mbox{]},  }\item[{double $\ast$}]{f,  }\item[{double $\ast$}]{g }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a22069934602644cf4f894c0b48967d49}\label{templates_8h_a22069934602644cf4f894c0b48967d49}} 
\index{templates.\+h@{templates.\+h}!binary\+\_\+basics@{binary\+\_\+basics}}
\index{binary\+\_\+basics@{binary\+\_\+basics}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{binary\+\_\+basics()}{binary\_basics()}}
{\footnotesize\ttfamily int binary\+\_\+basics (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



From the masses and period, setup the information one needs to calculate the position of the Roche lobe of the secondary to calculate whether a photon intersects the surface of the star. 

\begin{DoxyReturn}{Returns}
Always returns 0 
\end{DoxyReturn}


Definition at line 81 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a22069934602644cf4f894c0b48967d49_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_afb47deaf80a8f3a6f07ab91d843d960e}\label{templates_8h_afb47deaf80a8f3a6f07ab91d843d960e}} 
\index{templates.\+h@{templates.\+h}!bl\+\_\+init@{bl\+\_\+init}}
\index{bl\+\_\+init@{bl\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{bl\+\_\+init()}{bl\_init()}}
{\footnotesize\ttfamily double bl\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{lum\+\_\+bl,  }\item[{double}]{t\+\_\+bl,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{double $\ast$}]{f }\end{DoxyParamCaption})}



calculate parameters need to intialize the boundary layer (namely the band-\/liminted luminoisity) 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} double lum\+\_\+bl The desired luminosity for the boundary layaer \\
\hline
{\em \mbox{[}in} & out\mbox{]} double t\+\_\+bl The temperature \\
\hline
{\em \mbox{[}in} & out\mbox{]} double freqmin The minimum freqency in the band \\
\hline
{\em \mbox{[}in} & out\mbox{]} double freqmax The maximum freqency in the band \\
\hline
{\em \mbox{[}in} & out\mbox{]} int ioniz\+\_\+or\+\_\+final The spectral type to use in the calucation (N\+OT U\+S\+ED) but see below \\
\hline
{\em \mbox{[}in} & out\mbox{]} double $\ast$ f The band limited luminosity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total luminosity
\end{DoxyReturn}
The only thing that is actually calculated here is f, the luminosity within the frequency range that is specified.

This routine calculates the luminosity of the bl within the frequency boundaries. BB functions are assumed. It was derived from the same routine for a star, but here we have assumed that the temperature and the luminosity are known

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000045}{Bug}]At present bl\+\_\+init assumes a BB regardless of the spectrum. This is not really correct, and is different for what is done in initializing the star\end{DoxyRefDesc}


0703 -\/ ksl -\/ This is rather an odd little routine. As noted all that is calculated is f. ioniz\+\_\+or\+\_\+final is not used, and lum\+\_\+bl which is returned is only the luminosity that was passed. 

Definition at line 1244 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_afb47deaf80a8f3a6f07ab91d843d960e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_afb47deaf80a8f3a6f07ab91d843d960e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab308d8424a5b2ab066577630b7150e7b}\label{templates_8h_ab308d8424a5b2ab066577630b7150e7b}} 
\index{templates.\+h@{templates.\+h}!brem\+\_\+d@{brem\+\_\+d}}
\index{brem\+\_\+d@{brem\+\_\+d}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{brem\+\_\+d()}{brem\_d()}}
{\footnotesize\ttfamily double brem\+\_\+d (\begin{DoxyParamCaption}\item[{double}]{alpha }\end{DoxyParamCaption})}



The integrand for integrating a dimensionless bremstrahlung spectrum. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha h$\ast$freq/k\+\_\+b/T -\/ \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
luminosity of bremstrahlung function at alpha
\end{DoxyReturn}
This produces a dimensinless bremstrahlung spectrum so that one can break fast changing parts of the spectrum (i.\+e. the exponential drop off) into chunks to ensure we get a properly defnined spectrum of randomly generated photons.

\paragraph*{Notes}

10/15 -\/ Written by N\+SH 

Definition at line 75 of file brem.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=193pt]{templates_8h_ab308d8424a5b2ab066577630b7150e7b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab308d8424a5b2ab066577630b7150e7b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a30c0717640ef307cbe5489ec9ef911f5}\label{templates_8h_a30c0717640ef307cbe5489ec9ef911f5}} 
\index{templates.\+h@{templates.\+h}!calc\+\_\+cdf\+\_\+gradient@{calc\+\_\+cdf\+\_\+gradient}}
\index{calc\+\_\+cdf\+\_\+gradient@{calc\+\_\+cdf\+\_\+gradient}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calc\+\_\+cdf\+\_\+gradient()}{calc\_cdf\_gradient()}}
{\footnotesize\ttfamily int calc\+\_\+cdf\+\_\+gradient (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



Calculate gradients for a cdf to be used to better approzimte a cdf calculated at tivn points. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns 0; a positive return indicates a problem
\end{DoxyReturn}
Calculate the gradient of a cdf at each point in the cdf array in oder to allow one to calculate a first order correction to a uniform distibution between the points where the gradient has been calculated.

\paragraph*{Notes}

The gradients are calculated by differencing the cdf. Thus this routine should work both for cdf\textquotesingle{}s calculated from functions and from arrays

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000007}{Bug}]X\+XX N\+SH -\/ the way that the ends are dealt with is not great -\/ we should really try to come up with an extrapolation rather than just fill in the same gradients for the second and penultimate cells into the first and last cells.\end{DoxyRefDesc}


Definition at line 1038 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a30c0717640ef307cbe5489ec9ef911f5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a30c0717640ef307cbe5489ec9ef911f5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae8bab77755879541eaede60436cfbda2}\label{templates_8h_ae8bab77755879541eaede60436cfbda2}} 
\index{templates.\+h@{templates.\+h}!calc\+\_\+pi\+\_\+rate@{calc\+\_\+pi\+\_\+rate}}
\index{calc\+\_\+pi\+\_\+rate@{calc\+\_\+pi\+\_\+rate}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calc\+\_\+pi\+\_\+rate()}{calc\_pi\_rate()}}
{\footnotesize\ttfamily double calc\+\_\+pi\+\_\+rate (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode,  }\item[{int}]{type }\end{DoxyParamCaption})}



int calculates the photoionization rate coefficient for an ion in a given cell 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion The ion being ionized (or the index to an inner shell cross section) \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The cell in question -\/ note that the details of the model is stored in this strucute \\
\hline
\mbox{\tt in}  & {\em int} & mode says whether to use a piecewise model (1) or a blackbody model (2) for J\+\_\+nu \\
\hline
\mbox{\tt in,out}  & {\em type} & says whether we are computing an outer shell (1) or inner shell (2) rate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The photioinization rate coefficient for the ion.
\end{DoxyReturn}
calc\+\_\+pi\+\_\+rate calculates the photoionization rate coefficient for ion nion, based upon the mean intensity stored in cell xplasma The mode tells the subroutine wether we are modelling the mean intensity as a dilute blackbody (mode2) or as a series of power laws and exponentials (mode1). The type allows for the calculation of inner shell rates -\/ in this case nion is the indenx into an inner shell cross section record -\/ this links to the relvant ion internally. the reason for the difference is that there is exactly one outer rate per ion, but there can be many inner shell rates. Most of the information needed for the calculations is stored in the xplasma structure (e.\+g. temperature and spectral model)

\paragraph*{Notes}

This was created in Summer 2014 in preparation for matrix ionization solver. Previously, this code was contained in two subroutines bb\+\_\+correct\+\_\+2 and pl\+\_\+correct\+\_\+2.\+The functionality of these two have ben combined into one -\/ hence the requirement for the mode parameter.\+It was further extended to deal with inner shell rates -\/ hence the type parameter 

Definition at line 63 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ae8bab77755879541eaede60436cfbda2_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a09cddd089f4a6cc83c34606d125c28a4}\label{templates_8h_a09cddd089f4a6cc83c34606d125c28a4}} 
\index{templates.\+h@{templates.\+h}!calc\+\_\+te@{calc\+\_\+te}}
\index{calc\+\_\+te@{calc\+\_\+te}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calc\+\_\+te()}{calc\_te()}}
{\footnotesize\ttfamily double calc\+\_\+te (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{tmin,  }\item[{double}]{tmax }\end{DoxyParamCaption})}



calc\+\_\+te determines and returns the electron temperature in the wind such that the energy emitted by the wind is equal to energy emitted (asssuming it is in the interval bracketed by tmin and tmax.) 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Plasma\+Ptr xplasma A plasma cell in the wind \\
\hline
{\em \mbox{[}in} & out\mbox{]} double tmin A bracketing minimum temperature \\
\hline
{\em \mbox{[}in} & out\mbox{]} double tmax A bracketing mxximum temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The temperature where heating and cooling match
\end{DoxyReturn}
The routine iterates to find the temperature in a cell, where heating and cooling are matched.

calc\+\_\+te does not modify any abundances. It simply takes the current value of the heating in the cell and attempts to find the value of the electron temperature which will result in cooling which matches the heating.

\paragraph*{Notes}

Ion densities are N\+OT updated in this process.

xxxplasma is just a way to tranmit information to zero\+\_\+emit 

Definition at line 471 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a09cddd089f4a6cc83c34606d125c28a4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=311pt]{templates_8h_a09cddd089f4a6cc83c34606d125c28a4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9abacb792fc41f73a200f8a725c40189}\label{templates_8h_a9abacb792fc41f73a200f8a725c40189}} 
\index{templates.\+h@{templates.\+h}!calculate\+\_\+ds@{calculate\+\_\+ds}}
\index{calculate\+\_\+ds@{calculate\+\_\+ds}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calculate\+\_\+ds()}{calculate\_ds()}}
{\footnotesize\ttfamily double calculate\+\_\+ds (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{tau\+\_\+scat,  }\item[{double $\ast$}]{tau,  }\item[{int $\ast$}]{nres,  }\item[{double}]{smax,  }\item[{int $\ast$}]{istat }\end{DoxyParamCaption})}



calculate the distance a photon can travel within a single shell without scattering 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w the entire wind structure \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p A photon (bundle) \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+scat the optical depth at which the photon will scatter \\
\hline
\mbox{\tt in,out}  & {\em double} & $\ast$ tau Initially the current optical depth for the photon; finally the optical depth at the distance the photon can be moved. \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ nres the number of the resonance if there was one, -\/1 if there was no resonant scatter \\
\hline
\mbox{\tt in}  & {\em double} & smax the maximum distance the photon can travel in the cell \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ istat A flag indidicating whether the photon should scatter if it traels the distance estimated, 0 if no, T\+A\+U\+\_\+\+S\+C\+AT if yes. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The distance the photon can travel
\end{DoxyReturn}
calculate\+\_\+ds finds the distance the photon can travel subject to a number of conditions, which include reach a distance where tau is the distance where a scatter can occur, or a maximum distance set to ensure we do not cross into another cell, or indeed to go so far that one is not sure that the velocity can be approximated as a linear function of distance.

The routine returns the distance that the photon can travel subject to these conditions and information about why the photon was halted at the distance it was halted.

\paragraph*{Notes}

Calculate\+\_\+ds does not modify the p in any way!!

Any paramaters that depend explicitly on the coordinate gridding, such as the maximum distance the photon can travel before hitting the edge of the shell should be calculated outside of this routine. 

Definition at line 76 of file resonate.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9abacb792fc41f73a200f8a725c40189_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a28fc174aa63a5eeef6de99ef392e1616}\label{templates_8h_a28fc174aa63a5eeef6de99ef392e1616}} 
\index{templates.\+h@{templates.\+h}!calculate\+\_\+ionization@{calculate\+\_\+ionization}}
\index{calculate\+\_\+ionization@{calculate\+\_\+ionization}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calculate\+\_\+ionization()}{calculate\_ionization()}}
{\footnotesize\ttfamily int calculate\+\_\+ionization (\begin{DoxyParamCaption}\item[{int}]{restart\+\_\+stat }\end{DoxyParamCaption})}



run the ionization cycles for a python model 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & restart\+\_\+stat 0 if the is run is beginning from scratch, non-\/zero if this was a restart \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is the main routine for running the ionization cycles in Python

\paragraph*{Notes}

Definition at line 52 of file run.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{templates_8h_a28fc174aa63a5eeef6de99ef392e1616_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a311078e4d3e5530a996283eaf4c0fb19}\label{templates_8h_a311078e4d3e5530a996283eaf4c0fb19}} 
\index{templates.\+h@{templates.\+h}!calloc\+\_\+dyn\+\_\+plasma@{calloc\+\_\+dyn\+\_\+plasma}}
\index{calloc\+\_\+dyn\+\_\+plasma@{calloc\+\_\+dyn\+\_\+plasma}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calloc\+\_\+dyn\+\_\+plasma()}{calloc\_dyn\_plasma()}}
{\footnotesize\ttfamily int calloc\+\_\+dyn\+\_\+plasma (\begin{DoxyParamCaption}\item[{int}]{nelem }\end{DoxyParamCaption})}



This subroutine allocates space for dynamic arrays in the plasma structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nelem the number of plasma cells (actually N\+P\+L\+A\+S\+M\+A+1) to allow for empty cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0, unless the memory cannot be allocated in which case the proram exits
\end{DoxyReturn}
This subroutine allocates space for variable length arrays in the plasma structure.

\paragraph*{Notes}

Arrays sized to the number of ions are largest, and dominate the size of nplasma, so these were first to be dynamically allocated. 

Definition at line 570 of file gridwind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a311078e4d3e5530a996283eaf4c0fb19_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a43492c595dcd8568e2c14a8496c8fd43}\label{templates_8h_a43492c595dcd8568e2c14a8496c8fd43}} 
\index{templates.\+h@{templates.\+h}!calloc\+\_\+estimators@{calloc\+\_\+estimators}}
\index{calloc\+\_\+estimators@{calloc\+\_\+estimators}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calloc\+\_\+estimators()}{calloc\_estimators()}}
{\footnotesize\ttfamily int calloc\+\_\+estimators (\begin{DoxyParamCaption}\item[{int}]{nelem }\end{DoxyParamCaption})}



Dynamically allocate various arrays in macromain. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nelem The number of elements in macromain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0, unless the desired memory cannot be allocated in which the routine exits after an error message
\end{DoxyReturn}
To minimize the total amount of memory required by Python in macromode, allocate memory for various arrays in macromain which depend upon the number of ions which are treated as macro atoms

\paragraph*{Notes}

Definition at line 388 of file gridwind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a43492c595dcd8568e2c14a8496c8fd43_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4b147244ba1a5d54d79a57a8ee665b18}\label{templates_8h_a4b147244ba1a5d54d79a57a8ee665b18}} 
\index{templates.\+h@{templates.\+h}!calloc\+\_\+macro@{calloc\+\_\+macro}}
\index{calloc\+\_\+macro@{calloc\+\_\+macro}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calloc\+\_\+macro()}{calloc\_macro()}}
{\footnotesize\ttfamily int calloc\+\_\+macro (\begin{DoxyParamCaption}\item[{int}]{nelem }\end{DoxyParamCaption})}



Allocate memory to store information for macro atoms for each Plasma element. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nelem The number of cells that are actually included in the wind. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0, unless memory cannot allocate the requested memory in which case the program exits
\end{DoxyReturn}
This routine allocates memory for the structure macromain, in the situation where the program is being run in macro-\/atom mode.

\paragraph*{Notes}

The size of calloc macro depends on the number cells in the wind, but many of the elements of macro main are simply stucture pointers that are allocated by calloc\+\_\+estimators. 

Definition at line 330 of file gridwind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4b147244ba1a5d54d79a57a8ee665b18_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a391062d8b219dffc8496bd6fc8128cf6}\label{templates_8h_a391062d8b219dffc8496bd6fc8128cf6}} 
\index{templates.\+h@{templates.\+h}!calloc\+\_\+plasma@{calloc\+\_\+plasma}}
\index{calloc\+\_\+plasma@{calloc\+\_\+plasma}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calloc\+\_\+plasma()}{calloc\_plasma()}}
{\footnotesize\ttfamily int calloc\+\_\+plasma (\begin{DoxyParamCaption}\item[{int}]{nelem }\end{DoxyParamCaption})}



Allocate memory for plasmamain, which contains temperature, densities, etc. for cells which are in the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em int} & nelem The number of elements of plasmamain to allocate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0, unless the program is unable to allocate the requested memory in which case the program exits
\end{DoxyReturn}
\paragraph*{Notes}

This only allocates elements. It does not populate them with any information.

The routine also allocates space for storing photons associated with each plasma cell. This is used for creating wind photons in a cell in cases where one wants to created multiple photons of a certain type, and generating the cdf for this is time consuming, but generating photons once you have the cdf is not. It is currently used for fb processes only. 

Definition at line 215 of file gridwind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a391062d8b219dffc8496bd6fc8128cf6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af3449f72ae22aca485dfaa4d2f5ae300}\label{templates_8h_af3449f72ae22aca485dfaa4d2f5ae300}} 
\index{templates.\+h@{templates.\+h}!calloc\+\_\+wind@{calloc\+\_\+wind}}
\index{calloc\+\_\+wind@{calloc\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{calloc\+\_\+wind()}{calloc\_wind()}}
{\footnotesize\ttfamily int calloc\+\_\+wind (\begin{DoxyParamCaption}\item[{int}]{nelem }\end{DoxyParamCaption})}



Allocate space for the wind domain. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em nelem} & The number of elements in the wind domain to allocate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0 unless there is insufficient space, in which case the routine will call the program to exits
\end{DoxyReturn}
\paragraph*{Notes}

The wind is conisists of grids of cells that paper the active region of the calculation. Each domain has a number of these grid cells. nelem is the total number of such cells. 

Definition at line 158 of file gridwind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af3449f72ae22aca485dfaa4d2f5ae300_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a55984373c219b38477d5dafb44c2e336}\label{templates_8h_a55984373c219b38477d5dafb44c2e336}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+array\+\_\+fixup@{cdf\+\_\+array\+\_\+fixup}}
\index{cdf\+\_\+array\+\_\+fixup@{cdf\+\_\+array\+\_\+fixup}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+array\+\_\+fixup()}{cdf\_array\_fixup()}}
{\footnotesize\ttfamily int cdf\+\_\+array\+\_\+fixup (\begin{DoxyParamCaption}\item[{double $\ast$}]{x,  }\item[{double $\ast$}]{y,  }\item[{int}]{n\+\_\+xy }\end{DoxyParamCaption})}



Given two paralel arrays, x and y, this routine reorders the array in ascending order of x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & $\ast$ x The array that is sorted \\
\hline
\mbox{\tt in,out}  & {\em double} & $\ast$ y The parallel array that is sorted in order of x \\
\hline
\mbox{\tt in,out}  & {\em int} & n\+\_\+xy The length of the two arrays \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The length of the input array
\end{DoxyReturn}
This routine is a routine that is intended to fix a potential problem with an input pdf, which one is intending to convert into a cdf. The cdf genearion routines assume that an input routine is in ascending order of the x variable, often a freqency. The y variable is usually an unnormalized pdf. This routine checks that the x variables is indeed in ascending order and if not reorders the two arrays.

\paragraph*{Notes}

The routine makes an assumption about what one wants if the x array contains two x values that are identical. It assumes one wants to the value with the lower corresponding pdf value to be first in the output arrays (as is genearlly the case whn one has a sharp jump for a photoionization x-\/section. This will generate a at the upper edge of a square wave. 

Definition at line 1114 of file cdf.\+c.

\mbox{\Hypertarget{templates_8h_ac8e83990b5cf236827414abe43bee911}\label{templates_8h_ac8e83990b5cf236827414abe43bee911}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+check@{cdf\+\_\+check}}
\index{cdf\+\_\+check@{cdf\+\_\+check}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+check()}{cdf\_check()}}
{\footnotesize\ttfamily int cdf\+\_\+check (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



a simple routine to check some basics of the cumulative distribution function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if eveything is OK, a positive number otherwise
\end{DoxyReturn}
This is a diagnostic designed to see whether a cdf is reasonable

\paragraph*{Notes}

Definition at line 916 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac8e83990b5cf236827414abe43bee911_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac8e83990b5cf236827414abe43bee911_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3752bc8c3152420a2d58398abc1fa4f1}\label{templates_8h_a3752bc8c3152420a2d58398abc1fa4f1}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+gen\+\_\+from\+\_\+array@{cdf\+\_\+gen\+\_\+from\+\_\+array}}
\index{cdf\+\_\+gen\+\_\+from\+\_\+array@{cdf\+\_\+gen\+\_\+from\+\_\+array}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+gen\+\_\+from\+\_\+array()}{cdf\_gen\_from\_array()}}
{\footnotesize\ttfamily int cdf\+\_\+gen\+\_\+from\+\_\+array (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{y\mbox{[}$\,$\mbox{]},  }\item[{int}]{n\+\_\+xy,  }\item[{double}]{xmin,  }\item[{double}]{xmax }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a4e0486da3b6c0498e47e63b0240f784c}\label{templates_8h_a4e0486da3b6c0498e47e63b0240f784c}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+gen\+\_\+from\+\_\+func@{cdf\+\_\+gen\+\_\+from\+\_\+func}}
\index{cdf\+\_\+gen\+\_\+from\+\_\+func@{cdf\+\_\+gen\+\_\+from\+\_\+func}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+gen\+\_\+from\+\_\+func()}{cdf\_gen\_from\_func()}}
{\footnotesize\ttfamily int cdf\+\_\+gen\+\_\+from\+\_\+func (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{double($\ast$)(double)}]{func,  }\item[{double}]{xmin,  }\item[{double}]{xmax,  }\item[{int}]{njumps,  }\item[{double}]{jump\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a6cd473cda634a93562f9162b5c0c5f06}\label{templates_8h_a6cd473cda634a93562f9162b5c0c5f06}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+get\+\_\+rand@{cdf\+\_\+get\+\_\+rand}}
\index{cdf\+\_\+get\+\_\+rand@{cdf\+\_\+get\+\_\+rand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+get\+\_\+rand()}{cdf\_get\_rand()}}
{\footnotesize\ttfamily double cdf\+\_\+get\+\_\+rand (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



Generate a single sample from a cdf. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Cdf\+Ptr} & cdf a structure which contains the cumulative distribution function. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
x a random value fronm the cdf between xmin and xmax
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 652 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6cd473cda634a93562f9162b5c0c5f06_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6cd473cda634a93562f9162b5c0c5f06_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab79e837935267ae9f6061620404f000e}\label{templates_8h_ab79e837935267ae9f6061620404f000e}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+get\+\_\+rand\+\_\+limit@{cdf\+\_\+get\+\_\+rand\+\_\+limit}}
\index{cdf\+\_\+get\+\_\+rand\+\_\+limit@{cdf\+\_\+get\+\_\+rand\+\_\+limit}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+get\+\_\+rand\+\_\+limit()}{cdf\_get\_rand\_limit()}}
{\footnotesize\ttfamily double cdf\+\_\+get\+\_\+rand\+\_\+limit (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf }\end{DoxyParamCaption})}



get a random number for a cdf inside limits set by cdf\+\_\+limit. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A random number drawn from the \hyperlink{struct_cdf}{Cdf}, but within inside limits which have been set previously
\end{DoxyReturn}
The basic idea here is that we have created a cdf that covers a broad range of, for example, frequncy space. At this point we want photons that only cover some portion of the broad range. Instead of creating a new cdf that just covers a desired frequency space, we only sample a portion of the broad range as defined by cdf\+\_\+limit (for this particular cdf)

\paragraph*{Notes}

Definition at line 818 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab79e837935267ae9f6061620404f000e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab79e837935267ae9f6061620404f000e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aecb77ca29971f4b21ea483ab1672e652}\label{templates_8h_aecb77ca29971f4b21ea483ab1672e652}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+limit@{cdf\+\_\+limit}}
\index{cdf\+\_\+limit@{cdf\+\_\+limit}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+limit()}{cdf\_limit()}}
{\footnotesize\ttfamily int cdf\+\_\+limit (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{double}]{xmin,  }\item[{double}]{xmax }\end{DoxyParamCaption})}



sets limit1 and limit2 so that one can generate distributions from a limited range within a previously created cdf. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Cdf\+Ptr} & cdf A ptr to a cdf structure \\
\hline
\mbox{\tt in}  & {\em double} & xmin The minimum value to return \\
\hline
\mbox{\tt in}  & {\em double} & xmax The maximum value to return \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
We have defined the cdf in such a way that one can generate a random number 0 and 1, find the place in the y array that corresponds to this and map back onto the x values (which is what is returned. We now want to limit the range of the returned x values, but we need to know in terms of the original array where these values are and the generate a random number between some minimum ($>$0) and maximum ($<$1) whichi will allow one to find the x that corresponds. The point of this routine is to find that minimum and maximum value. Having done this one can call cdf\+\_\+get\+\_\+rand\+\_\+limit

\paragraph*{Notes}

Sometimes it is expensive computationally to recalculate the distribution function every time you change the limits. An example of this is the distribution function for a bb where the distribution function is quite smooth (and can be represented in a dimensionless manner) but calculating the function and the distribution function can be expensive. This routine together with cdf\+\_\+gen\+\_\+rand\+\_\+limit allow one to sample a part of a cdf. Note that cdf\+\_\+gen-\/from\+\_\+func or cdf\+\_\+gen\+\_\+from\+\_\+array should have been called previously!

xmin and xmax will cause cdf\mbox{[}\mbox{]}.limit1 and cdf\mbox{[}\mbox{]}.limit2 to be set in such a way that when you call pdf\+\_\+get\+\_\+rand\+\_\+limit the distribution will be sampled only between xmin and xmax.

If these routine is called improperly, e.\+g if xmin and xmax lie outside of the original value of xmin and xmax then the distribution will not extend this far, and the progrem will exit. 

Definition at line 735 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aecb77ca29971f4b21ea483ab1672e652_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aecb77ca29971f4b21ea483ab1672e652_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a837d826eae7b4094860222086e74e1f2}\label{templates_8h_a837d826eae7b4094860222086e74e1f2}} 
\index{templates.\+h@{templates.\+h}!cdf\+\_\+to\+\_\+file@{cdf\+\_\+to\+\_\+file}}
\index{cdf\+\_\+to\+\_\+file@{cdf\+\_\+to\+\_\+file}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cdf\+\_\+to\+\_\+file()}{cdf\_to\_file()}}
{\footnotesize\ttfamily int cdf\+\_\+to\+\_\+file (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a14b633e617b31ead523c75ce80cc56e1}{Cdf\+Ptr}}]{cdf,  }\item[{char}]{filename\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a834b9001d849a521f4dbf7a0dcb0d012}\label{templates_8h_a834b9001d849a521f4dbf7a0dcb0d012}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+convergence@{check\+\_\+convergence}}
\index{check\+\_\+convergence@{check\+\_\+convergence}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+convergence()}{check\_convergence()}}
{\footnotesize\ttfamily int check\+\_\+convergence (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



The routien summarizes the how well the wind converging to a solution as a whole. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Basically the routine just looks at the numbers of cells which haave passed/failed the various convergence tests and writes this to the log file

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000032}{Bug}]It would make sense to write this information to a separate file so that plots of the rate of convergence could be easily made.\end{DoxyRefDesc}


Definition at line 278 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=327pt]{templates_8h_a834b9001d849a521f4dbf7a0dcb0d012_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a80e38cc8054ee669104c30986700d508}\label{templates_8h_a80e38cc8054ee669104c30986700d508}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+corners\+\_\+inwind@{check\+\_\+corners\+\_\+inwind}}
\index{check\+\_\+corners\+\_\+inwind@{check\+\_\+corners\+\_\+inwind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+corners\+\_\+inwind()}{check\_corners\_inwind()}}
{\footnotesize\ttfamily int check\+\_\+corners\+\_\+inwind (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



The routine basically just calls where\+\_\+in\+\_\+wind for each of the 4 corners of the cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n the cell number in wmain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of corners of the cell that are in the wind
\end{DoxyReturn}
This is really just a driver routine which calls coordinate system specific routines

It is intended to standardize this check so that one can use such a routine in the volumes calculations.

\paragraph*{Notes}

This is one of the routines that makes explicity assumptions about guard cells, and it is not entirely clear why 

Definition at line 1245 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{templates_8h_a80e38cc8054ee669104c30986700d508_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=333pt]{templates_8h_a80e38cc8054ee669104c30986700d508_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a11871d7df7f3167db92bef8c8ef98926}\label{templates_8h_a11871d7df7f3167db92bef8c8ef98926}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+fmax@{check\+\_\+fmax}}
\index{check\+\_\+fmax@{check\+\_\+fmax}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+fmax()}{check\_fmax()}}
{\footnotesize\ttfamily double check\+\_\+fmax (\begin{DoxyParamCaption}\item[{double}]{fmin,  }\item[{double}]{fmax,  }\item[{double}]{temp }\end{DoxyParamCaption})}



decides whether a maximum frequency requested for an integral is sensible. If it is too far off the end of the planck function, qromb will malfunction. We just have to set it to a frequency where the BB function is tiny, say where hnu/kT =100. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & fmin The minimum frequency (N\+OT U\+S\+ED) \\
\hline
\mbox{\tt in}  & {\em double} & fmax The maximum frequency (N\+OT U\+S\+ED) \\
\hline
\mbox{\tt in}  & {\em double} & temp The temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A frequency which is the maximum value for which one should try to evaluate the BB function
\end{DoxyReturn}
We use alphabig to define the place in the BB spectrum where we want to give up

\paragraph*{Notes}

This is a little helper routine written by N\+SH in August 2012. We were having lots of problems with trying to integrate cross sections x a plack function at temperatures where there is no flux at fmax. This little routine just checks if fmax is going to be more than 100xt/(h/k) which will return tiny numbers for planck, and make qromb return nonsense.

The routine is called from py\+\_\+rates

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000004}{Bug}]This routine calls several variables that it does not use. It is also unclear that it is needed.\end{DoxyRefDesc}


Definition at line 632 of file bb.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=230pt]{templates_8h_a11871d7df7f3167db92bef8c8ef98926_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a850c8c06e8a1481921582559b0bd2cf1}\label{templates_8h_a850c8c06e8a1481921582559b0bd2cf1}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+grid@{check\+\_\+grid}}
\index{check\+\_\+grid@{check\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+grid()}{check\_grid()}}
{\footnotesize\ttfamily int check\+\_\+grid (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might wish to have smaller grid cells 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The results are logged.

loops over the entire wind points and checks quantities like velocity gradients and optical depths across cells for large changes. If there are large changes in cells, it tells the user how many cells and suggests that the grid may need to be modified.

\paragraph*{Notes}

Must be called after define wind so N\+P\+L\+A\+S\+MA and densities are set up.

The information that is checked is very basic and it is clear that someone was thinking about doing somewhat better checks.

Errors are not generated, or rather have been commented out, and so one needs to consider whether this is useful or not. If so there should be errors. 

Definition at line 1313 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a850c8c06e8a1481921582559b0bd2cf1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa751e527d76e3ced7d54e260c6ec8cd3}\label{templates_8h_aa751e527d76e3ced7d54e260c6ec8cd3}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+plasma@{check\+\_\+plasma}}
\index{check\+\_\+plasma@{check\+\_\+plasma}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+plasma()}{check\_plasma()}}
{\footnotesize\ttfamily int check\+\_\+plasma (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{char}]{message\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a00d9c108946340fef4c429a9afdeb110}\label{templates_8h_a00d9c108946340fef4c429a9afdeb110}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+stimulated\+\_\+recomb@{check\+\_\+stimulated\+\_\+recomb}}
\index{check\+\_\+stimulated\+\_\+recomb@{check\+\_\+stimulated\+\_\+recomb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+stimulated\+\_\+recomb()}{check\_stimulated\_recomb()}}
{\footnotesize\ttfamily int check\+\_\+stimulated\+\_\+recomb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



sanity check the stimulated recombination rate 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
check that stimulated recombination rate doesn\textquotesingle{}t exceed the photoionization rate (check if any levels have $\alpha_{st}n_e*\frac{n_u}{n_l} > \gamma$ 

Definition at line 912 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a00d9c108946340fef4c429a9afdeb110_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{templates_8h_a00d9c108946340fef4c429a9afdeb110_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a98a10e927f2b5ba88c7d5b4fc51d477d}\label{templates_8h_a98a10e927f2b5ba88c7d5b4fc51d477d}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+synonyms@{check\+\_\+synonyms}}
\index{check\+\_\+synonyms@{check\+\_\+synonyms}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+synonyms()}{check\_synonyms()}}
{\footnotesize\ttfamily int check\+\_\+synonyms (\begin{DoxyParamCaption}\item[{char}]{new\+\_\+question\mbox{[}$\,$\mbox{]},  }\item[{char}]{old\+\_\+question\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa067770b0286b11ebb3282166d941c85}\label{templates_8h_aa067770b0286b11ebb3282166d941c85}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+time@{check\+\_\+time}}
\index{check\+\_\+time@{check\+\_\+time}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+time()}{check\_time()}}
{\footnotesize\ttfamily int check\+\_\+time (\begin{DoxyParamCaption}\item[{char $\ast$}]{root }\end{DoxyParamCaption})}



check whether the elapsed time is greater than the max\+\_\+time and terminate the program if that is the case. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & $\ast$ root root name of the files where information is logged \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0, unless the time has exeeded the maximum time in which case the program writes a comment to .sig file and exits
\end{DoxyReturn}
If the current time is greater than the allowed time. Then the program is stopped, and a signal is sent to the .sig file that the program can be restarted

If the maximum time has not been set then this routine is a N\+OP

\paragraph*{Notes}

Generally speaking one should send a message to xsignal before invoking check\+\_\+time to record the status of the signal file 

Definition at line 261 of file signal.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa067770b0286b11ebb3282166d941c85_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_afa8b5c03286c90c5365b874967e81b33}\label{templates_8h_afa8b5c03286c90c5365b874967e81b33}} 
\index{templates.\+h@{templates.\+h}!check\+\_\+xsections@{check\+\_\+xsections}}
\index{check\+\_\+xsections@{check\+\_\+xsections}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+xsections()}{check\_xsections()}}
{\footnotesize\ttfamily int check\+\_\+xsections (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Perform sanity checks on xsection data. 

\begin{DoxyReturn}{Returns}
Alway returns 0; errors are written to the log file
\end{DoxyReturn}
Results are written to the log file

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000030}{Bug}]A careful look at this routine is warranted as get\+\_\+atomic\+\_\+data has changed over the years.\end{DoxyRefDesc}


Definition at line 3779 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_afa8b5c03286c90c5365b874967e81b33_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{templates_8h_afa8b5c03286c90c5365b874967e81b33_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8978f1b841dee7dbdab9ec6ff0b1320c}\label{templates_8h_a8978f1b841dee7dbdab9ec6ff0b1320c}} 
\index{templates.\+h@{templates.\+h}!collision\+\_\+summary@{collision\+\_\+summary}}
\index{collision\+\_\+summary@{collision\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{collision\+\_\+summary()}{collision\_summary()}}
{\footnotesize\ttfamily int collision\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a311f414c070511a6e17313830d4d3c36}\label{templates_8h_a311f414c070511a6e17313830d4d3c36}} 
\index{templates.\+h@{templates.\+h}!communicate\+\_\+estimators\+\_\+para@{communicate\+\_\+estimators\+\_\+para}}
\index{communicate\+\_\+estimators\+\_\+para@{communicate\+\_\+estimators\+\_\+para}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{communicate\+\_\+estimators\+\_\+para()}{communicate\_estimators\_para()}}
{\footnotesize\ttfamily int communicate\+\_\+estimators\+\_\+para (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



communicates the MC estimators between tasks 

communicates the MC estimators between tasks relating to spectral models, heating and cooling and cell diagnostics like IP. In the case of some variables, the quantities are maxima and minima so the flag M\+P\+I\+\_\+\+M\+AX or M\+P\+I\+\_\+\+M\+IN is used in M\+P\+I\+\_\+\+Reduce. For summed quantities like heating we use M\+P\+I\+\_\+\+S\+UM.

This routine should only do anything if the M\+P\+I\+\_\+\+ON flag was present in compilation. It communicates all the information required for the spectral model ionization scheme, and also heating and cooling quantities in cells. 

Definition at line 35 of file para\+\_\+update.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=292pt]{templates_8h_a311f414c070511a6e17313830d4d3c36_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a426a0602a269a1d9738c39c8098ffaae}\label{templates_8h_a426a0602a269a1d9738c39c8098ffaae}} 
\index{templates.\+h@{templates.\+h}!communicate\+\_\+matom\+\_\+estimators\+\_\+para@{communicate\+\_\+matom\+\_\+estimators\+\_\+para}}
\index{communicate\+\_\+matom\+\_\+estimators\+\_\+para@{communicate\+\_\+matom\+\_\+estimators\+\_\+para}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{communicate\+\_\+matom\+\_\+estimators\+\_\+para()}{communicate\_matom\_estimators\_para()}}
{\footnotesize\ttfamily int communicate\+\_\+matom\+\_\+estimators\+\_\+para (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

averages the macro-\/atom estimators between tasks using M\+P\+I\+\_\+\+Reduce. It should only be called if the M\+P\+I\+\_\+\+ON flag was present in compilation, and returns 0 immediately if no macro atom levels. This should probably be improved by working out exactly what is needed in simple-\/ion only mode. 

Definition at line 349 of file para\+\_\+update.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a426a0602a269a1d9738c39c8098ffaae_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2f793ca07e9f7ec0220090b8f6b73634}\label{templates_8h_a2f793ca07e9f7ec0220090b8f6b73634}} 
\index{templates.\+h@{templates.\+h}!comp\+\_\+cool\+\_\+integrand@{comp\+\_\+cool\+\_\+integrand}}
\index{comp\+\_\+cool\+\_\+integrand@{comp\+\_\+cool\+\_\+integrand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{comp\+\_\+cool\+\_\+integrand()}{comp\_cool\_integrand()}}
{\footnotesize\ttfamily double comp\+\_\+cool\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



The integrand in the integral to obtain the total cooling rate due to inverse compton scattering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
frequwncy dependant cross section multiplied by the mean intensity at frequency nu
\end{DoxyReturn}
This is is the integrand sigma x J\+\_\+nu that is integrated to obtain the compton cooling rate in a cell. The sigma in question is the effective energy exchange cross section, which for coolnig is /alpha/beta/sigma\+\_\+T. These alpha and beta terms are computed in ther subroutines, but here we only need to use , because the  term is taken account of when we compute J\+\_\+nu during the photon transport phase of the code. If we are calling this function, we know we have a model so there is no need to protect against the problem of not having a model

\paragraph*{Notes}

See Hazy 3 eq 6.\+6 for more details of this approach 

Definition at line 508 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{templates_8h_a2f793ca07e9f7ec0220090b8f6b73634_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2f793ca07e9f7ec0220090b8f6b73634_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a54b6ecee57eb3cb519fde55290c02f1b}\label{templates_8h_a54b6ecee57eb3cb519fde55290c02f1b}} 
\index{templates.\+h@{templates.\+h}!comp\+\_\+phot@{comp\+\_\+phot}}
\index{comp\+\_\+phot@{comp\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{comp\+\_\+phot()}{comp\_phot()}}
{\footnotesize\ttfamily int comp\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p1,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p2 }\end{DoxyParamCaption})}



Compares two photons to determine whether they have the identical position and direction. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p1 The first photon bundle \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p2 The second phton bundle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns 0 if the position and direction are identical, 1 otherwise
\end{DoxyReturn}
\paragraph*{Notes}

The routine is used in calculate\+\_\+ds 

Definition at line 133 of file phot\+\_\+util.\+c.

\mbox{\Hypertarget{templates_8h_ab14b7f5dc01c12685f12b0909b19c44c}\label{templates_8h_ab14b7f5dc01c12685f12b0909b19c44c}} 
\index{templates.\+h@{templates.\+h}!compare\+\_\+doubles@{compare\+\_\+doubles}}
\index{compare\+\_\+doubles@{compare\+\_\+doubles}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{compare\+\_\+doubles()}{compare\_doubles()}}
{\footnotesize\ttfamily int compare\+\_\+doubles (\begin{DoxyParamCaption}\item[{const void $\ast$}]{a,  }\item[{const void $\ast$}]{b }\end{DoxyParamCaption})}



A routine used by qsort in sort\+\_\+and\+\_\+compress. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em const} & void $\ast$ a A double precision number \\
\hline
\mbox{\tt in}  & {\em const} & void $\ast$ b A second double precision nubmer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if a is greater than b, 0 otherwise
\end{DoxyReturn}
This routine just compares two double precision numbers and returns 1 if a is greate than b, and 0 otherwise. It is needed by qsort which sorts a double precision array into numberical order.

\paragraph*{Notes}

Definition at line 1759 of file recomb.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{templates_8h_ab14b7f5dc01c12685f12b0909b19c44c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa1fe87e4faadd450e5c741ea35a93cc6}\label{templates_8h_aa1fe87e4faadd450e5c741ea35a93cc6}} 
\index{templates.\+h@{templates.\+h}!complete\+\_\+file\+\_\+summary@{complete\+\_\+file\+\_\+summary}}
\index{complete\+\_\+file\+\_\+summary@{complete\+\_\+file\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{complete\+\_\+file\+\_\+summary()}{complete\_file\_summary()}}
{\footnotesize\ttfamily int complete\+\_\+file\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{root\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa4bf64b7b93fd56daf8b291122eb107d}\label{templates_8h_aa4bf64b7b93fd56daf8b291122eb107d}} 
\index{templates.\+h@{templates.\+h}!complete\+\_\+ion\+\_\+summary@{complete\+\_\+ion\+\_\+summary}}
\index{complete\+\_\+ion\+\_\+summary@{complete\+\_\+ion\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{complete\+\_\+ion\+\_\+summary()}{complete\_ion\_summary()}}
{\footnotesize\ttfamily int complete\+\_\+ion\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a4b2a86e53b88734058364fa5d54b2910}\label{templates_8h_a4b2a86e53b88734058364fa5d54b2910}} 
\index{templates.\+h@{templates.\+h}!complete\+\_\+physical\+\_\+summary@{complete\+\_\+physical\+\_\+summary}}
\index{complete\+\_\+physical\+\_\+summary@{complete\+\_\+physical\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{complete\+\_\+physical\+\_\+summary()}{complete\_physical\_summary()}}
{\footnotesize\ttfamily int complete\+\_\+physical\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9300319cf99a4a66db3876befda54050}\label{templates_8h_a9300319cf99a4a66db3876befda54050}} 
\index{templates.\+h@{templates.\+h}!compton\+\_\+dir@{compton\+\_\+dir}}
\index{compton\+\_\+dir@{compton\+\_\+dir}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{compton\+\_\+dir()}{compton\_dir()}}
{\footnotesize\ttfamily int compton\+\_\+dir (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



computes a random direction for a photon undergoing compton scattering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p -\/ the photon currently being scattered \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ the cell in which the scattering is taking place \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful -\/ the new direction is returned as part of the photon structure
\end{DoxyReturn}
This routine computes a new direction (and energy change) for a photon undergoing compton scattering. If the freqiuency is low with respect to the electron rest mass then it is totaslly elastic, isotropic Thompson scattering.

\paragraph*{Notes}

E\+Verything is calculated in the rest frame of the electron. In this frame, the photon energy change is E/E\textquotesingle{}=1+(hnu/mc$^\wedge$2)(1+cos) where  is the angle thruogh which the photon is deflected. This is a maximum for =180 -\/ E/E\textquotesingle{}=1+2hnumc$^\wedge$2 and minimum for =0 -\/ E/E\textquotesingle{}=1 We compute everything by first drawing a random cross section that our photon packet will see. This cross section represents an energy change and hence a direction. The distribnution of angles is taken care of by using a differential cross section vs energy change function. So we work out what energy change and hence direction is implied by our random cross section. 

Definition at line 289 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9300319cf99a4a66db3876befda54050_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=213pt]{templates_8h_a9300319cf99a4a66db3876befda54050_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9891de810e686fa36209796ff1704fa3}\label{templates_8h_a9891de810e686fa36209796ff1704fa3}} 
\index{templates.\+h@{templates.\+h}!compton\+\_\+func@{compton\+\_\+func}}
\index{compton\+\_\+func@{compton\+\_\+func}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{compton\+\_\+func()}{compton\_func()}}
{\footnotesize\ttfamily double compton\+\_\+func (\begin{DoxyParamCaption}\item[{double}]{f }\end{DoxyParamCaption})}



Function used to find the fractional energy change for a given cross-\/section in the compton scattering limit. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} double f The fractional energy change of a photon undergoing scattering \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the difference between sigma(f) and the randomised cross section we are searching for
\end{DoxyReturn}
This function calculates the difference between the KN cross section for a given fractional energy loss f/x1 and the randomly generated cross section for our current interaction. A zero finding function is used to work out where this function is equal to zero -\/ we need to do this because we cannot invert the function sigma\+\_\+compton\+\_\+partial.

\paragraph*{Notes}

Since this function is called by zbrent, many of the variables have to be communicated externally. These are x1, the ratio of incoming photon energy to electron rest mass, sigma\+\_\+max, the KN cross section for the maximum possible energy loss sigma\+\_\+rand -\/ a randomised number between 0 and 1 representing the normalised cross section we want to find 

Definition at line 373 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{templates_8h_a9891de810e686fa36209796ff1704fa3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{templates_8h_a9891de810e686fa36209796ff1704fa3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a71e4aa982b912f78d70646462c6a6115}\label{templates_8h_a71e4aa982b912f78d70646462c6a6115}} 
\index{templates.\+h@{templates.\+h}!compute\+\_\+di\+\_\+coeffs@{compute\+\_\+di\+\_\+coeffs}}
\index{compute\+\_\+di\+\_\+coeffs@{compute\+\_\+di\+\_\+coeffs}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{compute\+\_\+di\+\_\+coeffs()}{compute\_di\_coeffs()}}
{\footnotesize\ttfamily int compute\+\_\+di\+\_\+coeffs (\begin{DoxyParamCaption}\item[{double}]{T }\end{DoxyParamCaption})}



computes the rates due to direct (collisional) ionization from Dere data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & T temperature in K of the cell in question \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success
\end{DoxyReturn}
This routine controls the calculation of the direct ionization coefficients for each ionic species at a temperature T. They are stored in a global array di\+\_\+coeffs -\/ usually for use in calculating the ionization balance. The actual calculations are done in a seperate routine, q\+\_\+ioniz\+\_\+dere Data is from Ionization rate coefficients for elements H to Zn (Dere+, 2007) Table J\+\_\+\+A\+\_\+\+A\+\_\+466\+\_\+771\+\_\+table29\+:

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 51 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a71e4aa982b912f78d70646462c6a6115_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a71e4aa982b912f78d70646462c6a6115_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa2bd15d3acbd24b94a78d7a55fbd4bb6}\label{templates_8h_aa2bd15d3acbd24b94a78d7a55fbd4bb6}} 
\index{templates.\+h@{templates.\+h}!compute\+\_\+dr\+\_\+coeffs@{compute\+\_\+dr\+\_\+coeffs}}
\index{compute\+\_\+dr\+\_\+coeffs@{compute\+\_\+dr\+\_\+coeffs}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{compute\+\_\+dr\+\_\+coeffs()}{compute\_dr\_coeffs()}}
{\footnotesize\ttfamily int compute\+\_\+dr\+\_\+coeffs (\begin{DoxyParamCaption}\item[{double}]{temp }\end{DoxyParamCaption})}



returns the volumetric dielectronic rate coefficients for a given temperature. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & temp the temperature at which to compute the coefficients \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
nothing, but populates the array dr\+\_\+coeffs
\end{DoxyReturn}
Takes as its input a temperature, and it populates the dr\+\_\+coeffs array. called every time a cell needs a set of DR coefficients.

\paragraph*{Notes}

the rates are associated with the ion being recombined into. 

Definition at line 106 of file dielectronic.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa2bd15d3acbd24b94a78d7a55fbd4bb6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa2bd15d3acbd24b94a78d7a55fbd4bb6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2cd4b2739e1ba69e646c63e7e327583c}\label{templates_8h_a2cd4b2739e1ba69e646c63e7e327583c}} 
\index{templates.\+h@{templates.\+h}!compute\+\_\+qrecomb\+\_\+coeffs@{compute\+\_\+qrecomb\+\_\+coeffs}}
\index{compute\+\_\+qrecomb\+\_\+coeffs@{compute\+\_\+qrecomb\+\_\+coeffs}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{compute\+\_\+qrecomb\+\_\+coeffs()}{compute\_qrecomb\_coeffs()}}
{\footnotesize\ttfamily int compute\+\_\+qrecomb\+\_\+coeffs (\begin{DoxyParamCaption}\item[{double}]{T }\end{DoxyParamCaption})}



computes the rate coefficient for three body recombination from Dere data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & T Temperature in K \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success
\end{DoxyReturn}
This routine calculates the three body recombination rate coefficient for all ions in a cell at temperature T. The resulting rate coefficients are stored in a global array for use by the calling routine -\/ normally matrix\+\_\+ion as part of the search for an ionization balance. It works by essentially applying the Milne relation to collisional ionization data. This is a driver routine, the hard work is done in a seperate routine (q\+\_\+recomb\+\_\+dere)

\paragraph*{Notes}

1508 JM coded 

Definition at line 243 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2cd4b2739e1ba69e646c63e7e327583c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{templates_8h_a2cd4b2739e1ba69e646c63e7e327583c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a54a60a3cfc21ceae39f7c529519c25ae}\label{templates_8h_a54a60a3cfc21ceae39f7c529519c25ae}} 
\index{templates.\+h@{templates.\+h}!compute\+\_\+zeta@{compute\+\_\+zeta}}
\index{compute\+\_\+zeta@{compute\+\_\+zeta}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{compute\+\_\+zeta()}{compute\_zeta()}}
{\footnotesize\ttfamily double compute\+\_\+zeta (\begin{DoxyParamCaption}\item[{double}]{temp,  }\item[{int}]{nion,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equation 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & temp The temperature for the calculation \\
\hline
\mbox{\tt in}  & {\em int} & nion the ion we are recombining to \\
\hline
\mbox{\tt in}  & {\em int} & mode The mode allow that controls how zeta is calcuated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
zeta, the correction factor to the recombination rates.
\end{DoxyReturn}
zeta is part of correction factor suggested in L\+M93 in a modified version of the on-\/the spot approximation. Specifically it is the fraction of recombinations that go directly to the ground state Saha equation.


\begin{DoxyItemize}
\item mode 1 is the original version, it takes ilow, ihi and interpfrac and interpolates in the ground state fraction table.
\item mode 2 attempts to modify zeta by application of the dielectronic recombination rate -\/ this calculates zeta from first principles using ground state recombination rates and total recombination rates. It defaults to mode 1 if is it missing data but it returns an error.

The program will exit if the mode is unknown.
\end{DoxyItemize}

\paragraph*{Notes}

Values for zeta were tabulated by CK (circa 2000)

When compute\+\_\+zeta is called, nion is the lower ion in the pair whose abundances are being calculated. Calls to the various recombination rate coefficient subroutines are made with nion+1, since these rates are tabulated for the recombining ion.

The data are read in by \hyperlink{get__atomicdata_8c}{get\+\_\+atomicdata.\+c} (around line 2100) 

Definition at line 64 of file zeta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a54a60a3cfc21ceae39f7c529519c25ae_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a96f3f44cc5cf473ca91ca268747dfba1}\label{templates_8h_a96f3f44cc5cf473ca91ca268747dfba1}} 
\index{templates.\+h@{templates.\+h}!concentrations@{concentrations}}
\index{concentrations@{concentrations}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{concentrations()}{concentrations()}}
{\footnotesize\ttfamily int concentrations (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



A routine to calculate concentrations in a plasma cell using the Saha equation with various assumptions about what to use for the temperature Saha equantion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A singll plasma cell \\
\hline
\mbox{\tt in}  & {\em int} & mode A swich whith defines what to use for the temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
concentrations returns 0 if it converged; -\/1 if it did not converge. If it does not converge, both density and $\ast$ne are likely to be garbage.
\end{DoxyReturn}
The densities are updated in xplasma

The modes are as follows\+:
\begin{DoxyItemize}
\item N\+E\+B\+U\+L\+A\+R\+\_\+\+TR -- use the radiation temperature
\item N\+E\+B\+U\+La\+R\+\_\+\+TE -- use the electron temperature
\item N\+E\+B\+U\+L\+A\+R\+\_\+\+M\+L93 -\/ From Mazzli \& Lucy 1993, use the geometric mean of the electron and radiaion temperature
\end{DoxyItemize}

This routine iterates to find the densities of individual ions using the Saha equation.

The Saha eqn. is (e.\+g. Motz, p 110, eqn 4.\+14


\begin{DoxyItemize}
\item N\+\_\+r+1 N\+\_\+e / N\+\_\+r = (2$\ast$pi$\ast$m$\ast$kT)$\ast$$\ast$1.5/h$\ast$$\ast$3 2 Z\+\_\+r+1(T)/\+Z\+\_\+r $\ast$ exp (-\/\+X/kT)

where N\+\_\+r+1 is the number density of the r+1 ionization state and Z\+\_\+r+1 is the partition function of that state.
\end{DoxyItemize}

he program works by perfoming a crude iteration on ne. It could undoubtedly be improved, if one wanted better accuracy or higher speed.

\paragraph*{Notes}

So that one doesn\textquotesingle{}t get zero-\/divides in other programs, e.\+g. nebular\+\_\+concentrations, a floor is set on the density of any ion or the electron density. 

Definition at line 202 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a96f3f44cc5cf473ca91ca268747dfba1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{templates_8h_a96f3f44cc5cf473ca91ca268747dfba1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a75214023fe99c4bd23e5cb5771bf5d0c}\label{templates_8h_a75214023fe99c4bd23e5cb5771bf5d0c}} 
\index{templates.\+h@{templates.\+h}!config\+\_\+overview@{config\+\_\+overview}}
\index{config\+\_\+overview@{config\+\_\+overview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{config\+\_\+overview()}{config\_overview()}}
{\footnotesize\ttfamily int config\+\_\+overview (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{int}]{icell }\end{DoxyParamCaption})}



macro\+\_\+summary is a routine intended to allow one to display information about macro atoms. It is the top level routine for macro information and requires further input from the user. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n \\
\hline
\mbox{\tt in}  & {\em int} & icell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 260 of file py\+\_\+wind\+\_\+macro.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a75214023fe99c4bd23e5cb5771bf5d0c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=258pt]{templates_8h_a75214023fe99c4bd23e5cb5771bf5d0c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab729c5f4ef31135996b77fb1add8df2c}\label{templates_8h_ab729c5f4ef31135996b77fb1add8df2c}} 
\index{templates.\+h@{templates.\+h}!convergence@{convergence}}
\index{convergence@{convergence}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{convergence()}{convergence()}}
{\footnotesize\ttfamily int convergence (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



checks to see whether a single cell is or is not converging 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Plasma\+Ptr xplasma The cell of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A number which describes the degree to which the cell is converging
\end{DoxyReturn}
The routine attempts to determine whether a cell is on the track to a final solution by checking whether the electron and radiation temperatures are getting smaller with cycle and whetehr the difference between heating and cooling is drroping.

The routine returns a number between 0 and 3, depending on the number of convergence checks that are passed. If all convergence tests are pssed then the number returned will be 0

The routine also adjust the gain which controls how far the electron temperture can change in a cycle.

\paragraph*{Notes}

Definition at line 184 of file ionization.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{templates_8h_ab729c5f4ef31135996b77fb1add8df2c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ade9ceff466d96f388787e6395e8171e5}\label{templates_8h_ade9ceff466d96f388787e6395e8171e5}} 
\index{templates.\+h@{templates.\+h}!convergence\+\_\+all@{convergence\+\_\+all}}
\index{convergence\+\_\+all@{convergence\+\_\+all}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{convergence\+\_\+all()}{convergence\_all()}}
{\footnotesize\ttfamily int convergence\+\_\+all (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a2d54e6320e5c5e8b5d8e8356111ed47e}\label{templates_8h_a2d54e6320e5c5e8b5d8e8356111ed47e}} 
\index{templates.\+h@{templates.\+h}!convergence\+\_\+summary@{convergence\+\_\+summary}}
\index{convergence\+\_\+summary@{convergence\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{convergence\+\_\+summary()}{convergence\_summary()}}
{\footnotesize\ttfamily int convergence\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a549b1632252bd1dece18e5caffe35a94}\label{templates_8h_a549b1632252bd1dece18e5caffe35a94}} 
\index{templates.\+h@{templates.\+h}!coolheat\+\_\+summary@{coolheat\+\_\+summary}}
\index{coolheat\+\_\+summary@{coolheat\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{coolheat\+\_\+summary()}{coolheat\_summary()}}
{\footnotesize\ttfamily int coolheat\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_abf7699b950ec2ef55a4e0087d82d0ab3}\label{templates_8h_abf7699b950ec2ef55a4e0087d82d0ab3}} 
\index{templates.\+h@{templates.\+h}!cooling@{cooling}}
\index{cooling@{cooling}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cooling()}{cooling()}}
{\footnotesize\ttfamily double cooling (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xxxplasma,  }\item[{double}]{t }\end{DoxyParamCaption})}



calculate the total cooling of a cell at a temperature t 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xxxplasma A cell in the wind \\
\hline
\mbox{\tt in}  & {\em double} & t The temperature where cooling is calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total amount of cooling in a plasma cell,
\end{DoxyReturn}
The routine calculates cooling of a wind cell, storing the results of various different processes in various parameters of the plasma cell.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000009}{Bug}]There appear to be redundant calls here to xtotal\+\_\+emission (which include calls to total\+\_\+fb, and to total\+\_\+fb in this routine. This makes it difficult to understand whether something is being counted twice.\end{DoxyRefDesc}


Definition at line 43 of file cooling.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abf7699b950ec2ef55a4e0087d82d0ab3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abf7699b950ec2ef55a4e0087d82d0ab3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3d923b8d7eb460585ecf6885222a69a3}\label{templates_8h_a3d923b8d7eb460585ecf6885222a69a3}} 
\index{templates.\+h@{templates.\+h}!coord\+\_\+fraction@{coord\+\_\+fraction}}
\index{coord\+\_\+fraction@{coord\+\_\+fraction}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{coord\+\_\+fraction()}{coord\_fraction()}}
{\footnotesize\ttfamily int coord\+\_\+fraction (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{int}]{ichoice,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{int}]{ii\mbox{[}$\,$\mbox{]},  }\item[{double}]{frac\mbox{[}$\,$\mbox{]},  }\item[{int $\ast$}]{nelem }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_af0f8c109cc6e8e390c754e74ad3f48fd}\label{templates_8h_af0f8c109cc6e8e390c754e74ad3f48fd}} 
\index{templates.\+h@{templates.\+h}!copy\+\_\+plasma@{copy\+\_\+plasma}}
\index{copy\+\_\+plasma@{copy\+\_\+plasma}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{copy\+\_\+plasma()}{copy\_plasma()}}
{\footnotesize\ttfamily int copy\+\_\+plasma (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{x1,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{x2 }\end{DoxyParamCaption})}



Routine to copy the necessary parts of a plasma structure for computing a set of level populations. x1 points to the cell from which data is copied and x2 points to the cell to which data is copied. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & x1 \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & x2 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 458 of file py\+\_\+wind\+\_\+macro.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af0f8c109cc6e8e390c754e74ad3f48fd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af0f8c109cc6e8e390c754e74ad3f48fd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7c4c25fcaad3e537c9aa40c61fc356aa}\label{templates_8h_a7c4c25fcaad3e537c9aa40c61fc356aa}} 
\index{templates.\+h@{templates.\+h}!corona\+\_\+rho@{corona\+\_\+rho}}
\index{corona\+\_\+rho@{corona\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{corona\+\_\+rho()}{corona\_rho()}}
{\footnotesize\ttfamily double corona\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a5d515c1db2ae9f2cac0b328d7ddfaa1a}\label{templates_8h_a5d515c1db2ae9f2cac0b328d7ddfaa1a}} 
\index{templates.\+h@{templates.\+h}!corona\+\_\+velocity@{corona\+\_\+velocity}}
\index{corona\+\_\+velocity@{corona\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{corona\+\_\+velocity()}{corona\_velocity()}}
{\footnotesize\ttfamily double corona\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ab0b1a9d790b71c94f9562c567eeee268}\label{templates_8h_ab0b1a9d790b71c94f9562c567eeee268}} 
\index{templates.\+h@{templates.\+h}!create\+\_\+basis@{create\+\_\+basis}}
\index{create\+\_\+basis@{create\+\_\+basis}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{create\+\_\+basis()}{create\_basis()}}
{\footnotesize\ttfamily int create\+\_\+basis (\begin{DoxyParamCaption}\item[{double}]{u\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]},  }\item[{struct \hyperlink{structbasis}{basis} $\ast$}]{basis\+\_\+new }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a7f76a839be4a0358447c06f58691bf13}\label{templates_8h_a7f76a839be4a0358447c06f58691bf13}} 
\index{templates.\+h@{templates.\+h}!create\+\_\+heat\+\_\+table@{create\+\_\+heat\+\_\+table}}
\index{create\+\_\+heat\+\_\+table@{create\+\_\+heat\+\_\+table}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{create\+\_\+heat\+\_\+table()}{create\_heat\_table()}}
{\footnotesize\ttfamily int create\+\_\+heat\+\_\+table (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aca584fb4af447d65ee0d475d4da783b6}\label{templates_8h_aca584fb4af447d65ee0d475d4da783b6}} 
\index{templates.\+h@{templates.\+h}!create\+\_\+ion\+\_\+table@{create\+\_\+ion\+\_\+table}}
\index{create\+\_\+ion\+\_\+table@{create\+\_\+ion\+\_\+table}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{create\+\_\+ion\+\_\+table()}{create\_ion\_table()}}
{\footnotesize\ttfamily int create\+\_\+ion\+\_\+table (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{iz }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a67af2cd841a922ea1001654449239284}\label{templates_8h_a67af2cd841a922ea1001654449239284}} 
\index{templates.\+h@{templates.\+h}!create\+\_\+maps@{create\+\_\+maps}}
\index{create\+\_\+maps@{create\+\_\+maps}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{create\+\_\+maps()}{create\_maps()}}
{\footnotesize\ttfamily int create\+\_\+maps (\begin{DoxyParamCaption}\item[{int}]{ichoice }\end{DoxyParamCaption})}



Create a map between wind and plasma cells. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ichoice An option which if non-\/zero indicates that a plasma element exists for each wmain element \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine fills variables, nplasma in wmain, and nwind in plasmamain that map elements of wmain to those in plasmamain anc vice versus

\paragraph*{Notes}

Normally, there are fewer plasma elements than wind elements, since plasma elements are created only for those wind elements which have finite volume in the wind. For each domain, a coordinate grid is created that covers a region of space, e.\+g a portion of a cylindrical grid. However some cells in this region are empty or matter, e.\+g in a binconical flow. However if ichoice is non-\/zero, a plasma cell has been created for all wind cells even if they are empty, something that is done only for diagnostic purposes.

wmain and plasmamain will already have been allocated memory by the time this routine is called. 

Definition at line 88 of file gridwind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a67af2cd841a922ea1001654449239284_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9a3b2f351412426aa9e64212235177b0}\label{templates_8h_a9a3b2f351412426aa9e64212235177b0}} 
\index{templates.\+h@{templates.\+h}!create\+\_\+master\+\_\+table@{create\+\_\+master\+\_\+table}}
\index{create\+\_\+master\+\_\+table@{create\+\_\+master\+\_\+table}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{create\+\_\+master\+\_\+table()}{create\_master\_table()}}
{\footnotesize\ttfamily int create\+\_\+master\+\_\+table (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a5acc98b72071d64f02e15f4975d03eb2}\label{templates_8h_a5acc98b72071d64f02e15f4975d03eb2}} 
\index{templates.\+h@{templates.\+h}!cross@{cross}}
\index{cross@{cross}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cross()}{cross()}}
{\footnotesize\ttfamily int cross (\begin{DoxyParamCaption}\item[{double}]{a\mbox{[}$\,$\mbox{]},  }\item[{double}]{b\mbox{[}$\,$\mbox{]},  }\item[{double}]{c\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a924a75177a13600d1838067dccd80aa0}\label{templates_8h_a924a75177a13600d1838067dccd80aa0}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+ds\+\_\+in\+\_\+cell@{cylind\+\_\+ds\+\_\+in\+\_\+cell}}
\index{cylind\+\_\+ds\+\_\+in\+\_\+cell@{cylind\+\_\+ds\+\_\+in\+\_\+cell}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+ds\+\_\+in\+\_\+cell()}{cylind\_ds\_in\_cell()}}
{\footnotesize\ttfamily double cylind\+\_\+ds\+\_\+in\+\_\+cell (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



calculate the distance to the far boundary of the cell in which the photon bundle when dealing with a cylindrical domain 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The number of the domain of interest \\
\hline
\mbox{\tt in}  & {\em p} & Photon pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
distance to the far boundary of the cell
\end{DoxyReturn}
Negative numbers (and zero) should be regarded as errors.

This routine solves the quadratic equations that allow one to determine the distance a photon can travel within a cylindrical cell before hitting the edge of the cell.

\paragraph*{Notes}

The distance if the smallest positive root of the quadratic equation. 

Definition at line 55 of file cylindrical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{templates_8h_a924a75177a13600d1838067dccd80aa0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a924a75177a13600d1838067dccd80aa0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a550c2a5ff400a82eebb328533b31e700}\label{templates_8h_a550c2a5ff400a82eebb328533b31e700}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+extend\+\_\+density@{cylind\+\_\+extend\+\_\+density}}
\index{cylind\+\_\+extend\+\_\+density@{cylind\+\_\+extend\+\_\+density}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+extend\+\_\+density()}{cylind\_extend\_density()}}
{\footnotesize\ttfamily int cylind\+\_\+extend\+\_\+density (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a256e18f6688f66ced645885b9ca6eb2c}\label{templates_8h_a256e18f6688f66ced645885b9ca6eb2c}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+get\+\_\+random\+\_\+location@{cylind\+\_\+get\+\_\+random\+\_\+location}}
\index{cylind\+\_\+get\+\_\+random\+\_\+location@{cylind\+\_\+get\+\_\+random\+\_\+location}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+get\+\_\+random\+\_\+location()}{cylind\_get\_random\_location()}}
{\footnotesize\ttfamily int cylind\+\_\+get\+\_\+random\+\_\+location (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa06d3901560706877fe1b434a657e3d1}\label{templates_8h_aa06d3901560706877fe1b434a657e3d1}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind@{cylind\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind}}
\index{cylind\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind@{cylind\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind()}{cylind\_is\_cell\_in\_wind()}}
{\footnotesize\ttfamily int cylind\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



Check whether this cell is in the wind or not. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n The number of an element in the wind structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Various intergers depending on whether the cell is W\+\_\+\+A\+L\+L\+\_\+\+I\+N\+W\+I\+ND, W\+\_\+\+N\+O\+T\+\_\+\+I\+N\+W\+I\+ND, W\+\_\+\+P\+A\+R\+T\+\_\+\+I\+N\+W\+I\+ND, etc.
\end{DoxyReturn}
This routine performs is a robust check of whether a cell is in the wind or not, by looking at the four corners of the cell as defined in wmain. It was created to speed up the evaluation of the volumes for the wind. It checks each of the four boundaries of the wind to see whether any portions of these are in the wind

\paragraph*{Notes}

This rooutine gets the domain number from wmain\mbox{[}n\mbox{]}.ndom, and uses the wind\+\_\+x and wind\+\_\+y postions to get the coreners, and then calls where in wind multiple times.

Comment\+: As with the case of a number of other routines the logic of this is quite convoluted, reflecting the fact that much of the code was written prior to the introduction of domains 

Definition at line 770 of file cylindrical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=297pt]{templates_8h_aa06d3901560706877fe1b434a657e3d1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa06d3901560706877fe1b434a657e3d1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a56507e563e08709e70d77a7ccd538ee3}\label{templates_8h_a56507e563e08709e70d77a7ccd538ee3}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+make\+\_\+grid@{cylind\+\_\+make\+\_\+grid}}
\index{cylind\+\_\+make\+\_\+grid@{cylind\+\_\+make\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+make\+\_\+grid()}{cylind\_make\_grid()}}
{\footnotesize\ttfamily int cylind\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



defines the cells in a cylindrical grid 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number of interest \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w The structure which defines the wind in Python \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Creates the boundaries of cells for a cylindrical domain.

Depending on the value of log\+\_\+linear for the domain, the cells are linearly or logarithmically spaced in x and z

\paragraph*{Notes}

Definition at line 157 of file cylindrical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a56507e563e08709e70d77a7ccd538ee3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=317pt]{templates_8h_a56507e563e08709e70d77a7ccd538ee3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a13144d35b1d57cfa570b6e59d225f474}\label{templates_8h_a13144d35b1d57cfa570b6e59d225f474}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+volumes@{cylind\+\_\+volumes}}
\index{cylind\+\_\+volumes@{cylind\+\_\+volumes}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+volumes()}{cylind\_volumes()}}
{\footnotesize\ttfamily int cylind\+\_\+volumes (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Calculates the wind volume for cells in a cylindrical domain allowing for the fact that some cells are not necessarily entirely in the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The domain of interest \\
\hline
\mbox{\tt in,out}  & {\em w} & the entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a brute-\/froce integration of the volume \begin{DoxyVerb}ksl--04aug--some of the machinations regarding what to to at the
edge of the wind seem bizarre, like a substiture for figuring out
what one actually should be doing.  However, volume > 0 is used
for making certain choices in the existing code, and so one does
need to be careful.
\end{DoxyVerb}


\paragraph*{Notes}

Where\+\_\+in grid does not tell you whether the photon is in the wind or not.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000015}{Bug}]This routine has unresolved X\+XX questions that need to be resolved\end{DoxyRefDesc}


Definition at line 367 of file cylindrical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a13144d35b1d57cfa570b6e59d225f474_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=310pt]{templates_8h_a13144d35b1d57cfa570b6e59d225f474_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3a95696ec4f71b5faa5693bb3c1c1bc6}\label{templates_8h_a3a95696ec4f71b5faa5693bb3c1c1bc6}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+where\+\_\+in\+\_\+grid@{cylind\+\_\+where\+\_\+in\+\_\+grid}}
\index{cylind\+\_\+where\+\_\+in\+\_\+grid@{cylind\+\_\+where\+\_\+in\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+where\+\_\+in\+\_\+grid()}{cylind\_where\_in\_grid()}}
{\footnotesize\ttfamily int cylind\+\_\+where\+\_\+in\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8bdfd0f93f3588b82c331dc1b1c38b97}\label{templates_8h_a8bdfd0f93f3588b82c331dc1b1c38b97}} 
\index{templates.\+h@{templates.\+h}!cylind\+\_\+wind\+\_\+complete@{cylind\+\_\+wind\+\_\+complete}}
\index{cylind\+\_\+wind\+\_\+complete@{cylind\+\_\+wind\+\_\+complete}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylind\+\_\+wind\+\_\+complete()}{cylind\_wind\_complete()}}
{\footnotesize\ttfamily int cylind\+\_\+wind\+\_\+complete (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Create arrays that are used for interpolating quantities, such as density and velocity. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number of interest \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This simple little routine just populates two one dimensional arrays that are used for interpolation.

\paragraph*{Notes}

There is an analogous routine for each different type of coordinate system 

Definition at line 294 of file cylindrical.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8bdfd0f93f3588b82c331dc1b1c38b97_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_afe381010f3abbac0bcdba71d37f95bef}\label{templates_8h_afe381010f3abbac0bcdba71d37f95bef}} 
\index{templates.\+h@{templates.\+h}!cylindrical\+\_\+make\+\_\+grid\+\_\+import@{cylindrical\+\_\+make\+\_\+grid\+\_\+import}}
\index{cylindrical\+\_\+make\+\_\+grid\+\_\+import@{cylindrical\+\_\+make\+\_\+grid\+\_\+import}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylindrical\+\_\+make\+\_\+grid\+\_\+import()}{cylindrical\_make\_grid\_import()}}
{\footnotesize\ttfamily int cylindrical\+\_\+make\+\_\+grid\+\_\+import (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Use the imported data to initialize various portions of the Wind and Domain structures. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em w} & The entire wind \\
\hline
\mbox{\tt in}  & {\em ndom} & The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine initializes the portions of the wind structure using the imported model, specifically those portions having to do with positions, and velocities.

The routine creates a pillbox around the grid to be used for defining the region which the wind (maximally) occupies.

\paragraph*{Notes}

Definition at line 230 of file import\+\_\+cylindrical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{templates_8h_afe381010f3abbac0bcdba71d37f95bef_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a71991ab1e84795ab8b9451c4d58a5e31}\label{templates_8h_a71991ab1e84795ab8b9451c4d58a5e31}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+coord\+\_\+fraction@{cylvar\+\_\+coord\+\_\+fraction}}
\index{cylvar\+\_\+coord\+\_\+fraction@{cylvar\+\_\+coord\+\_\+fraction}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+coord\+\_\+fraction()}{cylvar\_coord\_fraction()}}
{\footnotesize\ttfamily int cylvar\+\_\+coord\+\_\+fraction (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{int}]{ichoice,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{int}]{ii\mbox{[}$\,$\mbox{]},  }\item[{double}]{frac\mbox{[}$\,$\mbox{]},  }\item[{int $\ast$}]{nelem }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a52b5367a4a1a8d1bbe9446a5571a81fd}\label{templates_8h_a52b5367a4a1a8d1bbe9446a5571a81fd}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+ds\+\_\+in\+\_\+cell@{cylvar\+\_\+ds\+\_\+in\+\_\+cell}}
\index{cylvar\+\_\+ds\+\_\+in\+\_\+cell@{cylvar\+\_\+ds\+\_\+in\+\_\+cell}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+ds\+\_\+in\+\_\+cell()}{cylvar\_ds\_in\_cell()}}
{\footnotesize\ttfamily double cylvar\+\_\+ds\+\_\+in\+\_\+cell (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



cylin\+\_\+ds\+\_\+in\+\_\+cell calculates the distance to the far boundary of the cell in which the photon bundle resides. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The number of the domain of interest \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Distance to the far boundary of the cell in which the photon currently resides.
\end{DoxyReturn}
Negative numbers (and zero) should be regarded as errors.

This routine solves the quadratic equations that allow one to determine the distance a photon can travel within a cell before hitting the edge of the cell.

\paragraph*{Notes}

This differs from the cylindrical case in searching for the a boundaries of the cell 

Definition at line 96 of file cylind\+\_\+var.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a52b5367a4a1a8d1bbe9446a5571a81fd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a52b5367a4a1a8d1bbe9446a5571a81fd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2ec3f5fd8390071adf98cdaee7afb064}\label{templates_8h_a2ec3f5fd8390071adf98cdaee7afb064}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+extend\+\_\+density@{cylvar\+\_\+extend\+\_\+density}}
\index{cylvar\+\_\+extend\+\_\+density@{cylvar\+\_\+extend\+\_\+density}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+extend\+\_\+density()}{cylvar\_extend\_density()}}
{\footnotesize\ttfamily int cylvar\+\_\+extend\+\_\+density (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



extends the density to regions just outside the wind regiions so that extrapolations of density can be made there 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The densities are stored in the approapriate Plasma cells (rather than in the Wind)

We need to updated the densities immediately outside the wind so that the density interpolation in resonate will work. In this case all we have done is to copy the densities from the cell which is just in the wind (as one goes outward) to the cell that is just inside (or outside) the wind.

In cylindrical coordinates, the fast dimension is z; grid positions increase up in z, and then out in r. In spperical polar coordinates, the fast dimension is theta; the grid increases in theta (measured) from the z axis), and then in r.

\paragraph*{Notes}

Instead of copying every thing is accomplished using pointers. 

Definition at line 1040 of file cylind\+\_\+var.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=265pt]{templates_8h_a2ec3f5fd8390071adf98cdaee7afb064_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abcd93706f368767b5cbb885fa6d97f77}\label{templates_8h_abcd93706f368767b5cbb885fa6d97f77}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+get\+\_\+random\+\_\+location@{cylvar\+\_\+get\+\_\+random\+\_\+location}}
\index{cylvar\+\_\+get\+\_\+random\+\_\+location@{cylvar\+\_\+get\+\_\+random\+\_\+location}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+get\+\_\+random\+\_\+location()}{cylvar\_get\_random\_location()}}
{\footnotesize\ttfamily int cylvar\+\_\+get\+\_\+random\+\_\+location (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a95a5dd7b17dd91fc7d21b44ee290d256}\label{templates_8h_a95a5dd7b17dd91fc7d21b44ee290d256}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+make\+\_\+grid@{cylvar\+\_\+make\+\_\+grid}}
\index{cylvar\+\_\+make\+\_\+grid@{cylvar\+\_\+make\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+make\+\_\+grid()}{cylvar\_make\_grid()}}
{\footnotesize\ttfamily int cylvar\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



defines the cells in a cylindrical grid when the disk is vertically extended. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Wind\+Ptr w The structure which defines the wind in Python \\
\hline
{\em \mbox{[}in} & out\mbox{]} int ndom The domain number of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The cylvar coordinate system basically adds and offset determined by zdisk(r) to each z position in the grid. Beyond geo.\+diskrad the coordinate system stays fixed in the z direction (on the assumption that the forumula for the disk is not valid there.)

The coordinate system is adjusted so the last element in the veritical direction of the grid is always the same.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 220 of file cylind\+\_\+var.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{templates_8h_a95a5dd7b17dd91fc7d21b44ee290d256_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=317pt]{templates_8h_a95a5dd7b17dd91fc7d21b44ee290d256_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a95334daf522cc6a4ac43e85e759f4a31}\label{templates_8h_a95334daf522cc6a4ac43e85e759f4a31}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+volumes@{cylvar\+\_\+volumes}}
\index{cylvar\+\_\+volumes@{cylvar\+\_\+volumes}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+volumes()}{cylvar\_volumes()}}
{\footnotesize\ttfamily int cylvar\+\_\+volumes (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



w) calculates the wind volume of a cylindrical cell allowing for the fact that some cells 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom the domain poiinter \\
\hline
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w the entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a brute\+\_\+force integration of the volume. The technique is completely general. It does not depend on the shape of the cell, and could be used for most of the coodinate systems.

\paragraph*{Notes}

Where\+\_\+in grid does not tell you whether the photon is in the wind or not. 

Definition at line 506 of file cylind\+\_\+var.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a95334daf522cc6a4ac43e85e759f4a31_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=310pt]{templates_8h_a95334daf522cc6a4ac43e85e759f4a31_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3f57c2e9fb596450ee692d70f2a6a1be}\label{templates_8h_a3f57c2e9fb596450ee692d70f2a6a1be}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+where\+\_\+in\+\_\+grid@{cylvar\+\_\+where\+\_\+in\+\_\+grid}}
\index{cylvar\+\_\+where\+\_\+in\+\_\+grid@{cylvar\+\_\+where\+\_\+in\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+where\+\_\+in\+\_\+grid()}{cylvar\_where\_in\_grid()}}
{\footnotesize\ttfamily int cylvar\+\_\+where\+\_\+in\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{int}]{ichoice,  }\item[{double $\ast$}]{fx,  }\item[{double $\ast$}]{fz }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a99c605bb65f5950301b4adf1ff09eb8d}\label{templates_8h_a99c605bb65f5950301b4adf1ff09eb8d}} 
\index{templates.\+h@{templates.\+h}!cylvar\+\_\+wind\+\_\+complete@{cylvar\+\_\+wind\+\_\+complete}}
\index{cylvar\+\_\+wind\+\_\+complete@{cylvar\+\_\+wind\+\_\+complete}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{cylvar\+\_\+wind\+\_\+complete()}{cylvar\_wind\_complete()}}
{\footnotesize\ttfamily int cylvar\+\_\+wind\+\_\+complete (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Completes the definition of some of the positonal variables in the wind, and creates some subidiary arrays. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number of interest \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w The structure which defines the wind in Python \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine defines the windcone structures for this coordinate system and creates some arrays that are intended to aide in determining what cell one is in. The routine is specific to cylvar coordinate system.

\paragraph*{Notes}

In principle, one would like to fix problem that the cones are only defined out to M\+D\+I\+M-\/1 and N\+D\+I\+M-\/1, as this has the potential of wasting space. However, volumes have the same problem 

Definition at line 388 of file cylind\+\_\+var.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a99c605bb65f5950301b4adf1ff09eb8d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a99c605bb65f5950301b4adf1ff09eb8d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7b0bed5d82ce2310bbd039704b3567cd}\label{templates_8h_a7b0bed5d82ce2310bbd039704b3567cd}} 
\index{templates.\+h@{templates.\+h}!d2phi\+\_\+ds2@{d2phi\+\_\+ds2}}
\index{d2phi\+\_\+ds2@{d2phi\+\_\+ds2}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{d2phi\+\_\+ds2()}{d2phi\_ds2()}}
{\footnotesize\ttfamily double d2phi\+\_\+ds2 (\begin{DoxyParamCaption}\item[{double}]{s }\end{DoxyParamCaption})}



Calculate the second derivative of the Roche potential of the secondary. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance the phtoon has traveled from its inital postiion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The second deritave
\end{DoxyReturn}
\paragraph*{Notes}

This is a brute force calculation of the derivative 

Definition at line 549 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{templates_8h_a7b0bed5d82ce2310bbd039704b3567cd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{templates_8h_a7b0bed5d82ce2310bbd039704b3567cd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2765e7cfe15e6273a2140427a551176b}\label{templates_8h_a2765e7cfe15e6273a2140427a551176b}} 
\index{templates.\+h@{templates.\+h}!dealloc\+\_\+copied\+\_\+plasma@{dealloc\+\_\+copied\+\_\+plasma}}
\index{dealloc\+\_\+copied\+\_\+plasma@{dealloc\+\_\+copied\+\_\+plasma}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{dealloc\+\_\+copied\+\_\+plasma()}{dealloc\_copied\_plasma()}}
{\footnotesize\ttfamily int dealloc\+\_\+copied\+\_\+plasma (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xcopy }\end{DoxyParamCaption})}



deallocate copied plasma arrays, helper routine 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xcopy \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
00 
\end{DoxyReturn}


Definition at line 507 of file py\+\_\+wind\+\_\+macro.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2765e7cfe15e6273a2140427a551176b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa943bd857500a1f2937d8b97d84ff633}\label{templates_8h_aa943bd857500a1f2937d8b97d84ff633}} 
\index{templates.\+h@{templates.\+h}!define\+\_\+phot@{define\+\_\+phot}}
\index{define\+\_\+phot@{define\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{define\+\_\+phot()}{define\_phot()}}
{\footnotesize\ttfamily int define\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{long}]{nphot\+\_\+tot,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{int}]{iwind,  }\item[{int}]{freq\+\_\+sampling }\end{DoxyParamCaption})}



the controlling routine for creating the underlying photon distribution. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Phot\+Ptr} & p The structure where all photons are stored \\
\hline
\mbox{\tt in}  & {\em double} & f1 The mininum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency if a uniform distribution \\
\hline
\mbox{\tt in}  & {\em long} & nphot\+\_\+tot The total number of photons that need to be generated to reach the total luminosity, not necessarilly the number of photons which will be generated by the call to define\+\_\+phot, which instead is defined by N\+P\+H\+OT \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final 0 -\/$>$ this is for the wind ionization calculation, 1-\/$>$ it is for the final spectrum calculation \\
\hline
\mbox{\tt in}  & {\em int} & iwind A variable (see below) that controls the generation of phtons for the wind \\
\hline
\mbox{\tt in}  & {\em int} & freq\+\_\+sampling If 0, generate photons over the full frequency range without banding, else use banding \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine oversees the generation of photons for the radiative transfer calculation. Most of the actual work is done in other routines, particularly xdefine\+\_\+phot). There can be multiple radiation sources (e.\+g the star and a disk)

There are two basic approaches to generating photons. One can sample the entire wavelength interval in which case all photons have the same weight, but photon frequencies are selected based on the the specific luminiosty. In the banded approach, one defines bands in which photons are generated. Specific numbers of photons are are generated in each band, and within a band the photons are selected according the the specific luminosity, but the weights of photons in different bands differ. still used for detailed spectrum calculation. Which of this choices to use is controlled by freq\+\_\+sampling (The weights are established here)

iwind is a variable that determines how or whether to create photons from the wind\+:
\begin{DoxyItemize}
\item -\/1-\/$>$ Do not consider wind photons under any circumstances
\item 0 -\/$>$Consider wind photons. There is no need to recalculate the relative contribution to number of photons from the wind unless the frequencies have changed
\item 1 -\/$>$ Force a recalculation of the fraction of photons from the wind. This is necessary because after each ionization recalculation one needs to recalculate the flux fraction from the wind.
\end{DoxyItemize}

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000043}{Bug}]Is this correct, have subcycles been removed.\end{DoxyRefDesc}


Definition at line 75 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{templates_8h_aa943bd857500a1f2937d8b97d84ff633_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a27671483c230bf332cc2286dbfa6c4be}\label{templates_8h_a27671483c230bf332cc2286dbfa6c4be}} 
\index{templates.\+h@{templates.\+h}!define\+\_\+wind@{define\+\_\+wind}}
\index{define\+\_\+wind@{define\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{define\+\_\+wind()}{define\_wind()}}
{\footnotesize\ttfamily int define\+\_\+wind (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



initializes the structures which characterize the wind, including wmain and plasmamain. 

\begin{DoxyReturn}{Returns}
Allways returns 0
\end{DoxyReturn}
This is the controlling routine for initializing the wind and related structures, calculating the salient properties (e.\+g. the volume that is in the wind) in each grid cell.

\paragraph*{Notes}

This is a fairly complex routine. In addition ot allocating space, the routine initalizes the wind. In some case the initalization is done \char`\"{}in-\/line\char`\"{} but more often other routines, many of which coordinate system specifica are clled. 

Definition at line 43 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{templates_8h_a27671483c230bf332cc2286dbfa6c4be_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac0ede87d97addcd4c5df57e2930dbdb6}\label{templates_8h_ac0ede87d97addcd4c5df57e2930dbdb6}} 
\index{templates.\+h@{templates.\+h}!delay\+\_\+dump@{delay\+\_\+dump}}
\index{delay\+\_\+dump@{delay\+\_\+dump}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{delay\+\_\+dump()}{delay\_dump()}}
{\footnotesize\ttfamily int delay\+\_\+dump (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{np }\end{DoxyParamCaption})}



Dumps tracked photons to file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em np} & Pointer to photon array tp dump \\
\hline
\mbox{\tt in}  & {\em np} & Number photons in p \\
\hline
\mbox{\tt in}  & {\em i\+Extracted} & Array of extract flags for p \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Sifts through the photons in the delay\+\_\+dump file, checking if they\textquotesingle{}ve scattered or were generated in the wind and so contribute to the delay map. Uses the same filters as the spectra\+\_\+create() function for scatters \& angles.

\paragraph*{Notes}

6/15 -\/ Written by S\+WM 

Definition at line 212 of file reverb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac0ede87d97addcd4c5df57e2930dbdb6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=254pt]{templates_8h_ac0ede87d97addcd4c5df57e2930dbdb6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a83531c4a215b42e705cd97b00088be71}\label{templates_8h_a83531c4a215b42e705cd97b00088be71}} 
\index{templates.\+h@{templates.\+h}!delay\+\_\+dump\+\_\+combine@{delay\+\_\+dump\+\_\+combine}}
\index{delay\+\_\+dump\+\_\+combine@{delay\+\_\+dump\+\_\+combine}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{delay\+\_\+dump\+\_\+combine()}{delay\_dump\_combine()}}
{\footnotesize\ttfamily int delay\+\_\+dump\+\_\+combine (\begin{DoxyParamCaption}\item[{int}]{i\+\_\+ranks }\end{DoxyParamCaption})}



Prepares delay dump output file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em i\+\_\+ranks} & Number of parallel processes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Collects all the delay dump files together at the end. Called by the master thread. Uses \textquotesingle{}cat\textquotesingle{} for simplicity.

\paragraph*{Notes}

6/15 -\/ Written by S\+WM 

Definition at line 159 of file reverb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a83531c4a215b42e705cd97b00088be71_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a835e66c48118aa52e1903512ed676f20}\label{templates_8h_a835e66c48118aa52e1903512ed676f20}} 
\index{templates.\+h@{templates.\+h}!delay\+\_\+dump\+\_\+finish@{delay\+\_\+dump\+\_\+finish}}
\index{delay\+\_\+dump\+\_\+finish@{delay\+\_\+dump\+\_\+finish}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{delay\+\_\+dump\+\_\+finish()}{delay\_dump\_finish()}}
{\footnotesize\ttfamily int delay\+\_\+dump\+\_\+finish (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Finishes dumping tracked photons to file. 

\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Dumps the remaining tracked photons to file, frees memory.

\paragraph*{Notes}

6/15 -\/ Written by S\+WM 

Definition at line 133 of file reverb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a835e66c48118aa52e1903512ed676f20_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aed071173676fa884b0045139793c85d7}\label{templates_8h_aed071173676fa884b0045139793c85d7}} 
\index{templates.\+h@{templates.\+h}!delay\+\_\+dump\+\_\+prep@{delay\+\_\+dump\+\_\+prep}}
\index{delay\+\_\+dump\+\_\+prep@{delay\+\_\+dump\+\_\+prep}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{delay\+\_\+dump\+\_\+prep()}{delay\_dump\_prep()}}
{\footnotesize\ttfamily int delay\+\_\+dump\+\_\+prep (\begin{DoxyParamCaption}\item[{int}]{restart\+\_\+stat }\end{DoxyParamCaption})}



Prepares delay dump output file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & File root for run \\
\hline
\mbox{\tt in}  & {\em restart\+\_\+stat} & If this is a restart run \\
\hline
\mbox{\tt in}  & {\em i\+\_\+rank} & Parallel rank \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Sets up filenames, allocates bank for temporary storage of photons that are to be dumped, and if it\textquotesingle{}s not a resume run prints out a header for the file. Filename is set per thread. The file is then built up in batches using \hyperlink{reverb_8c_ac0ede87d97addcd4c5df57e2930dbdb6}{delay\+\_\+dump()} in increments of \hyperlink{reverb_8c_a588f4feb9a791e95c422851e3806239e}{delay\+\_\+dump\+\_\+bank\+\_\+size}.

\paragraph*{Notes}

9/14 -\/ Written by S\+WM 

Definition at line 68 of file reverb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aed071173676fa884b0045139793c85d7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a30c0a9051caebba27b5ef5583d38ad0c}\label{templates_8h_a30c0a9051caebba27b5ef5583d38ad0c}} 
\index{templates.\+h@{templates.\+h}!delay\+\_\+dump\+\_\+single@{delay\+\_\+dump\+\_\+single}}
\index{delay\+\_\+dump\+\_\+single@{delay\+\_\+dump\+\_\+single}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{delay\+\_\+dump\+\_\+single()}{delay\_dump\_single()}}
{\footnotesize\ttfamily int delay\+\_\+dump\+\_\+single (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int}]{i\+\_\+spec }\end{DoxyParamCaption})}



Preps a single photon to be dumped. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pp} & Pointer to extracted photon \\
\hline
\mbox{\tt in}  & {\em i\+\_\+spec} & Spectrum p extracted to \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Takes a photon and copies it to the staging arrays for delay dumping, to be output to file later.

\paragraph*{Notes}

6/15 -\/ Written by S\+WM 

Definition at line 281 of file reverb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a30c0a9051caebba27b5ef5583d38ad0c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa5efed3848af045bb3035fc6db93e757}\label{templates_8h_aa5efed3848af045bb3035fc6db93e757}} 
\index{templates.\+h@{templates.\+h}!delay\+\_\+to\+\_\+observer@{delay\+\_\+to\+\_\+observer}}
\index{delay\+\_\+to\+\_\+observer@{delay\+\_\+to\+\_\+observer}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{delay\+\_\+to\+\_\+observer()}{delay\_to\_observer()}}
{\footnotesize\ttfamily double delay\+\_\+to\+\_\+observer (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



Calculates the delay to the observer plane. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pp} & Pointer to test photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Distance from photon to plane
\end{DoxyReturn}
Sets up the observer plane, then calculates the distance from the current photon to it. Uses \hyperlink{foo_8h_ae443765b508c1d69ac5249ef9de2bb81}{ds\+\_\+to\+\_\+plane()} for reliability.

\paragraph*{Notes}

9/14 -\/ Written by S\+WM 

Definition at line 37 of file reverb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=251pt]{templates_8h_aa5efed3848af045bb3035fc6db93e757_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa5efed3848af045bb3035fc6db93e757_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7a80c6ec538ad7bf2b546126bac374bf}\label{templates_8h_a7a80c6ec538ad7bf2b546126bac374bf}} 
\index{templates.\+h@{templates.\+h}!den\+\_\+config@{den\+\_\+config}}
\index{den\+\_\+config@{den\+\_\+config}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{den\+\_\+config()}{den\_config()}}
{\footnotesize\ttfamily double den\+\_\+config (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{nconf }\end{DoxyParamCaption})}



returns the precalculated density of a particular \char`\"{}nlte\char`\"{} level. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The Plasma structure containing information about the cell of interest. \\
\hline
\mbox{\tt in}  & {\em int} & nconf The running index that describes which level we are interested in \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The density for a particular level of an ion in the cell
\end{DoxyReturn}
The first case is when the density of the particular level is in the wind array The second case is when the density of the levels for an ion are not tracked, and hence only the total density for the ion is known. In that case, we assume the ion is in it\textquotesingle{}s ground state.

If levels are not defined for an ion it assumes that all ions of are in the ground state.

\paragraph*{Notes}

Definition at line 895 of file radiation.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{templates_8h_a7a80c6ec538ad7bf2b546126bac374bf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a74e9a1ed7ffcb66086ca24b9cc1d280f}\label{templates_8h_a74e9a1ed7ffcb66086ca24b9cc1d280f}} 
\index{templates.\+h@{templates.\+h}!depcoef\+\_\+overview@{depcoef\+\_\+overview}}
\index{depcoef\+\_\+overview@{depcoef\+\_\+overview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{depcoef\+\_\+overview()}{depcoef\_overview()}}
{\footnotesize\ttfamily int depcoef\+\_\+overview (\begin{DoxyParamCaption}\item[{int}]{icell }\end{DoxyParamCaption})}



is a routine which prints information about departure coefficients and level populations in a cell. There is probably a crossover between this and level\+\_\+popsoverview 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & icell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 392 of file py\+\_\+wind\+\_\+macro.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a74e9a1ed7ffcb66086ca24b9cc1d280f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=265pt]{templates_8h_a74e9a1ed7ffcb66086ca24b9cc1d280f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a40c328f946d3dbfda7d056bdddd6945a}\label{templates_8h_a40c328f946d3dbfda7d056bdddd6945a}} 
\index{templates.\+h@{templates.\+h}!depcoef\+\_\+overview\+\_\+specific@{depcoef\+\_\+overview\+\_\+specific}}
\index{depcoef\+\_\+overview\+\_\+specific@{depcoef\+\_\+overview\+\_\+specific}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{depcoef\+\_\+overview\+\_\+specific()}{depcoef\_overview\_specific()}}
{\footnotesize\ttfamily int depcoef\+\_\+overview\+\_\+specific (\begin{DoxyParamCaption}\item[{int}]{version,  }\item[{int}]{nconfig,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a625372b64e082ea4b46de6f8be0e385f}\label{templates_8h_a625372b64e082ea4b46de6f8be0e385f}} 
\index{templates.\+h@{templates.\+h}!disk\+\_\+deriv@{disk\+\_\+deriv}}
\index{disk\+\_\+deriv@{disk\+\_\+deriv}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{disk\+\_\+deriv()}{disk\_deriv()}}
{\footnotesize\ttfamily void disk\+\_\+deriv (\begin{DoxyParamCaption}\item[{double}]{s,  }\item[{double $\ast$}]{value,  }\item[{double $\ast$}]{derivative }\end{DoxyParamCaption})}



Calculate the change in disk height as s function of s. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s A distance along the path of a photon \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ value the disk height at s \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ derivative the derivative of the disk heith at s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N/A
\end{DoxyReturn}
Used in ds\+\_\+to\+\_\+disk by rtsafe as part of the procedure to locate the place a photon hits a vertically extended disk

\paragraph*{Notes}

The function we are trying to zero is the difference between the height of the disk and the z height of the photon. 

Definition at line 630 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{templates_8h_a625372b64e082ea4b46de6f8be0e385f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a625372b64e082ea4b46de6f8be0e385f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3c3ee1b7657b6c1bc4e6c1e6d8300020}\label{templates_8h_a3c3ee1b7657b6c1bc4e6c1e6d8300020}} 
\index{templates.\+h@{templates.\+h}!disk\+\_\+init@{disk\+\_\+init}}
\index{disk\+\_\+init@{disk\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{disk\+\_\+init()}{disk\_init()}}
{\footnotesize\ttfamily double disk\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{rmin,  }\item[{double}]{rmax,  }\item[{double}]{m,  }\item[{double}]{mdot,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{double $\ast$}]{ftot }\end{DoxyParamCaption})}



calculates the total luminosity and the luminosity between freqqmin and freqmax of the disk. More importantly divides the disk into annulae such that each annulus contributes and equal amount to the lumionosity of the disk (within the frequency limits). Thus initializes the structure \char`\"{}disk\char`\"{}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & rmin The minimum radius of the disk \\
\hline
\mbox{\tt in}  & {\em double} & rmax The maximum radius of the disk \\
\hline
\mbox{\tt in}  & {\em double} & m mass of central object \\
\hline
\mbox{\tt in}  & {\em double} & mdot mass accretion rate \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final A flag indicating whether this is an ionization or a detailed spectral cycle (used to determine the spectral type to use) \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ ftot The band limited luminosity in the freqency interval \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the total luminosity of the disk
\end{DoxyReturn}
This routine assumes the temperature distribution for the disk is that of a simple Shakura-\/\+Sunyaev disk, and uses this to determine the band limited luminosity of the disk. Additionally, it divides the disk in the rings of the same band-\/limited luminosity, so that equal numbers of photons can be generated from each ring. (The reason the disk has to be initilaized mulitple times is because the rings are different for different freqency intervals.)

\paragraph*{Notes}

The information needed to generate photons from the disk is stored in the disk structure. The positional parameters x and v are at the edge of the ring, but many of the other parameters (like temperature) are at the mid point. 

Definition at line 842 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3c3ee1b7657b6c1bc4e6c1e6d8300020_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3c3ee1b7657b6c1bc4e6c1e6d8300020_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4f972e01804594e4d4a5375e39807495}\label{templates_8h_a4f972e01804594e4d4a5375e39807495}} 
\index{templates.\+h@{templates.\+h}!display@{display}}
\index{display@{display}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{display()}{display()}}
{\footnotesize\ttfamily int display (\begin{DoxyParamCaption}\item[{char}]{name\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a435ccfb2aea5f873c9508368e974eced}\label{templates_8h_a435ccfb2aea5f873c9508368e974eced}} 
\index{templates.\+h@{templates.\+h}!do\+\_\+windsave2table@{do\+\_\+windsave2table}}
\index{do\+\_\+windsave2table@{do\+\_\+windsave2table}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{do\+\_\+windsave2table()}{do\_windsave2table()}}
{\footnotesize\ttfamily int do\+\_\+windsave2table (\begin{DoxyParamCaption}\item[{char $\ast$}]{root }\end{DoxyParamCaption})}



The main routine associated with windsave2table, this routine calls various other routines which write individual files. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & $\ast$ root The rootname of the windsave file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

The routine cycles through the various domains and calles subroutines that write the individual files for each domain. 

Definition at line 51 of file windsave2table\+\_\+sub.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a435ccfb2aea5f873c9508368e974eced_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a792efbef440470b9aad57a0d687a8915}\label{templates_8h_a792efbef440470b9aad57a0d687a8915}} 
\index{templates.\+h@{templates.\+h}!doppler@{doppler}}
\index{doppler@{doppler}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{doppler()}{doppler()}}
{\footnotesize\ttfamily int doppler (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pin,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pout,  }\item[{double}]{v\mbox{[}$\,$\mbox{]},  }\item[{int}]{nres }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a284ee938adda5964f70e57cf3517bb93}\label{templates_8h_a284ee938adda5964f70e57cf3517bb93}} 
\index{templates.\+h@{templates.\+h}!dot@{dot}}
\index{dot@{dot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{dot()}{dot()}}
{\footnotesize\ttfamily double dot (\begin{DoxyParamCaption}\item[{double}]{a\mbox{[}$\,$\mbox{]},  }\item[{double}]{b\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aaee8af7ddccdd146566ebd8daa39b982}\label{templates_8h_aaee8af7ddccdd146566ebd8daa39b982}} 
\index{templates.\+h@{templates.\+h}!dot\+\_\+tensor\+\_\+vec@{dot\+\_\+tensor\+\_\+vec}}
\index{dot\+\_\+tensor\+\_\+vec@{dot\+\_\+tensor\+\_\+vec}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{dot\+\_\+tensor\+\_\+vec()}{dot\_tensor\_vec()}}
{\footnotesize\ttfamily double dot\+\_\+tensor\+\_\+vec (\begin{DoxyParamCaption}\item[{double}]{tensor\mbox{[}3\mbox{]}\mbox{[}3\mbox{]},  }\item[{double}]{vin\mbox{[}3\mbox{]},  }\item[{double}]{vout\mbox{[}3\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa85d6bb7bef49e7e4b18d238eb2e6430}\label{templates_8h_aa85d6bb7bef49e7e4b18d238eb2e6430}} 
\index{templates.\+h@{templates.\+h}!dphi\+\_\+ds@{dphi\+\_\+ds}}
\index{dphi\+\_\+ds@{dphi\+\_\+ds}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{dphi\+\_\+ds()}{dphi\_ds()}}
{\footnotesize\ttfamily double dphi\+\_\+ds (\begin{DoxyParamCaption}\item[{double}]{s }\end{DoxyParamCaption})}



Calculate the gradient of the Roche potential as the photon travels. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance the photon has traveled from its initial position \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the first derivative of the potential
\end{DoxyReturn}
This is a brute force calculation of the first derivative of the Roche potentail

\paragraph*{Notes}

Definition at line 517 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{templates_8h_aa85d6bb7bef49e7e4b18d238eb2e6430_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa85d6bb7bef49e7e4b18d238eb2e6430_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_afee395233fbca5e632fd3ef51106f74c}\label{templates_8h_afee395233fbca5e632fd3ef51106f74c}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+in\+\_\+cell@{ds\+\_\+in\+\_\+cell}}
\index{ds\+\_\+in\+\_\+cell@{ds\+\_\+in\+\_\+cell}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+in\+\_\+cell()}{ds\_in\_cell()}}
{\footnotesize\ttfamily double ds\+\_\+in\+\_\+cell (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



calculates the distance photon can travel within the cell that it is currently in. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em int} & ndom The current domain \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A distance indicating how far the photon can travel
\end{DoxyReturn}
The routine is basically just a steering routine and calls ds\+\_\+in\+\_\+whatever for various coordinate systems

\paragraph*{Notes}

The other routines are contained in routines like \hyperlink{cylindrical_8c}{cylindrical.\+c}, \hyperlink{rtheta_8c}{rtheta.\+c} etc. 

Definition at line 727 of file photon2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_afee395233fbca5e632fd3ef51106f74c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=326pt]{templates_8h_afee395233fbca5e632fd3ef51106f74c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa14b53e068e0016d6cc621e918fdf992}\label{templates_8h_aa14b53e068e0016d6cc621e918fdf992}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+closest\+\_\+approach@{ds\+\_\+to\+\_\+closest\+\_\+approach}}
\index{ds\+\_\+to\+\_\+closest\+\_\+approach@{ds\+\_\+to\+\_\+closest\+\_\+approach}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+closest\+\_\+approach()}{ds\_to\_closest\_approach()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+closest\+\_\+approach (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p,  }\item[{double $\ast$}]{impact\+\_\+parameter }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a4a0398c1230c6d21c5c51f4750ca2ea1}\label{templates_8h_a4a0398c1230c6d21c5c51f4750ca2ea1}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+cone@{ds\+\_\+to\+\_\+cone}}
\index{ds\+\_\+to\+\_\+cone@{ds\+\_\+to\+\_\+cone}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+cone()}{ds\_to\_cone()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+cone (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a24207bf0bce7d09eb68cd114e725996d}{Cone\+Ptr}}]{cc,  }\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p }\end{DoxyParamCaption})}



(cc, p) This is a new version of introduced in order to allow cylvar coordinates Eventually it is intended to replace ds\+\_\+to\+\_\+windcone completely, or at least the guts of ds\+\_\+to\+\_\+windcone. 

$<$N\+O\+TE\+: The \mbox{[}in, out\mbox{]} tag describes if the value of a parameter is used or altered. If it is used but not altered, delete \textquotesingle{}O\+UT\textquotesingle{}. If the original value is not used and it is written to, delete \textquotesingle{}IN\textquotesingle{}.$>$ 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Cone\+Ptr} & cc ??? \\
\hline
\mbox{\tt in,out}  & {\em struct} & photon $\ast$ p ??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
??? R\+E\+T\+U\+R\+NS ???
\end{DoxyReturn}
??? D\+E\+S\+C\+R\+I\+P\+T\+I\+ON ???

\paragraph*{Notes}

As part of the conversion, the old ds\+\_\+to\+\_\+cone was renamed to ds\+\_\+to\+\_\+windcone

\begin{DoxyVerb}56d -- Cones have become more prominent in python with time.  Originally
they were used simply to define the inner and outer edges of the
wind, that is   to determine when a photon entered the wind.  The wind was/is
assumed to be a biconical flow, and therefore the most naturally was defined in
terms of a footpoint in the disk for the innermost/outermost stream line
and a slope.

It was expanced when rtheta coordanates were introduced
to handle find when one had hit the theta coordinate boundaries.  And in
56d we also want it to handle the case where the grid cells have variable
z coordinates.  Therefore one needs to be quite careful, Since ds_to_cone
is the ultimate name of the routine I would like to use, the first step
I took was to change the name of the old routine to ds_to_windcone.  This
should allow me to replace the old routine incrementally.

56d -- With python 56d the variable defining a cone were changed to be
the point on the z axis intercepted by the cone (extended) through
the disk, and the slope.

Our approach is as follows:

The cone is defined by  z=z_o + dz/drho *drho
The photon is defined by X=X_o + LMN s

Unless dz/drho = 0, this turns into a simple quadratic equation that must
be solved.  We work in the northen hemisphere only.

There are issues concerning what to do so one crosses the disk plane.  For
    finding how far a photon can travel in a cell, we are *not* interested
in the possibility that the photon hits the cone on the other side of
the disk plane, but for a photon travelling out of the wind we are
very interested in this possibility.\end{DoxyVerb}
 

Definition at line 439 of file phot\+\_\+util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{templates_8h_a4a0398c1230c6d21c5c51f4750ca2ea1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abca5dd4cfb2140628e2a8f8be27aa2ee}\label{templates_8h_abca5dd4cfb2140628e2a8f8be27aa2ee}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+cylinder@{ds\+\_\+to\+\_\+cylinder}}
\index{ds\+\_\+to\+\_\+cylinder@{ds\+\_\+to\+\_\+cylinder}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+cylinder()}{ds\_to\_cylinder()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+cylinder (\begin{DoxyParamCaption}\item[{double}]{rho,  }\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p }\end{DoxyParamCaption})}



calculate the distance a photon must travel to encouter a cylinder that is centered on the z axis. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & rho the size of the cylinder \\
\hline
\mbox{\tt in,out}  & {\em struct} & photon $\ast$ p a photon ptr \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The smallest positive distance to the cylinder. If the ray does not hit the cylinder a V\+E\+R\+Y\+\_\+\+B\+IG is returned.
\end{DoxyReturn}
Given a position and a direction the distance to a cylinder, solve the simple quadratic equation that gives the distance to the cylinder.

\paragraph*{Notes}

Definition at line 940 of file phot\+\_\+util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=228pt]{templates_8h_abca5dd4cfb2140628e2a8f8be27aa2ee_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_afff91fbd2e4ab430bad432ecb529a28a}\label{templates_8h_afff91fbd2e4ab430bad432ecb529a28a}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+disk@{ds\+\_\+to\+\_\+disk}}
\index{ds\+\_\+to\+\_\+disk@{ds\+\_\+to\+\_\+disk}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+disk()}{ds\_to\_disk()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+disk (\begin{DoxyParamCaption}\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p,  }\item[{int}]{allow\+\_\+negative }\end{DoxyParamCaption})}



Calculates the distance that a photon would need to travel from its current position to hit disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & photon $\ast$ p a photon pointer. \\
\hline
\mbox{\tt in}  & {\em int} & allow\+\_\+negative permits a negative number to be returned in certain circumstances \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The distance to the disk.
\end{DoxyReturn}
Usually, ds\+\_\+to\+\_\+disk returns the distance along the line of sight to the disk in the direction a photon is currently travelling.

Usually, if the photon misses the disk going in the positive direction, a very large number is returned.

If allow\+\_\+negative is non-\/zero (true), then ds\+\_\+to\+\_\+disk returns a negative distance if it has not hit the disk going in the positive direction.

The routine allows both for a flat disk, and a vertically extended disk

\paragraph*{Notes}

The need to allow for negative distances arises because several of the parameterization for the wind (SV, K\+WD) depend on the distance between the current position and footpoint along a streamline. (It is not clear that this was a good approach, but that is the rationale)

Generally, there should not be an issue with this, though one can imagine that one might get into trouble for a very flared (bowl-\/shaped) disk.

Significant portions of the routine were rewritten in 1802 by ksl to better handle flared disks. 

Definition at line 370 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{templates_8h_afff91fbd2e4ab430bad432ecb529a28a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{templates_8h_afff91fbd2e4ab430bad432ecb529a28a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae443765b508c1d69ac5249ef9de2bb81}\label{templates_8h_ae443765b508c1d69ac5249ef9de2bb81}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+plane@{ds\+\_\+to\+\_\+plane}}
\index{ds\+\_\+to\+\_\+plane@{ds\+\_\+to\+\_\+plane}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+plane()}{ds\_to\_plane()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+plane (\begin{DoxyParamCaption}\item[{struct \hyperlink{structplane}{plane} $\ast$}]{pl,  }\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p }\end{DoxyParamCaption})}



calculates the distance of a photon must travel to hit the plane. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em struct} & plane $\ast$ pl A structure which descibes a plane in terms of a position and vector normal to the surface \\
\hline
\mbox{\tt in,out}  & {\em struct} & photon $\ast$ p A photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The distance to the plane, or V\+E\+R\+Y\+\_\+\+B\+IG if the photon does not hit the plane (in the positive direction)
\end{DoxyReturn}
Calcululate the distance a photon must travel to hit a plane. The plane, just for simplicity, is defined as a photon structure since you need both a point and a direction to define it. A plane can be defined by a position x\+\_\+p and a normal lmn\+\_\+p. If the photon ray is then defined by x=x\+\_\+v+s lmn\+\_\+v and the allowed values of s are determined by the equation

(x\+\_\+v+s lmn\+\_\+v -\/ x\+\_\+p) . lmn\+\_\+p=0 where . implies the dot-\/product. The routine returns V\+E\+R\+Y\+\_\+\+B\+IG if the photon ray does not intersect the plane .

\paragraph*{Notes}

Definition at line 794 of file phot\+\_\+util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=205pt]{templates_8h_ae443765b508c1d69ac5249ef9de2bb81_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aff5a3156ec26863e37ff61073bb97ca4}\label{templates_8h_aff5a3156ec26863e37ff61073bb97ca4}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+roche\+\_\+2@{ds\+\_\+to\+\_\+roche\+\_\+2}}
\index{ds\+\_\+to\+\_\+roche\+\_\+2@{ds\+\_\+to\+\_\+roche\+\_\+2}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+roche\+\_\+2()}{ds\_to\_roche\_2()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+roche\+\_\+2 (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



Calculate the distance to the Roche surface for a photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p The photon whose path one wishes to track \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the distance to the roche surface of the secondary for photon p, or V\+E\+R\+Y\+\_\+\+B\+IG if the photon does not intercept the surface
\end{DoxyReturn}
Instead of simply determining whether the photon hits the Roche surface, this routine determine how far the photon would need to travel to hit the Roche surface.

\paragraph*{Notes}

This routine is currently not used in Python. It would be important if one actually wished to calculate the heating of the secondary.

If it were used for this purpose, one should confirm that it is working correctly 

Definition at line 186 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aff5a3156ec26863e37ff61073bb97ca4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a67e3cb7a7d0cd3d55277fc4f3373fe2e}\label{templates_8h_a67e3cb7a7d0cd3d55277fc4f3373fe2e}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+sphere@{ds\+\_\+to\+\_\+sphere}}
\index{ds\+\_\+to\+\_\+sphere@{ds\+\_\+to\+\_\+sphere}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+sphere()}{ds\_to\_sphere()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+sphere (\begin{DoxyParamCaption}\item[{double}]{r,  }\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p }\end{DoxyParamCaption})}



Calculate the pathlenth along a line of sight defined by a photon p to a sphere centered on the origin. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & r The radius of the sphere \\
\hline
\mbox{\tt in,out}  & {\em struct} & photon $\ast$ p The photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The distance to the sphere. If the photon does not hit the sphere return a large number V\+E\+R\+Y\+\_\+\+B\+IG
\end{DoxyReturn}
The routine simply solves the quadratic equation for calculating the distance to the sphere. It returns the smalles positive root

\paragraph*{Notes}

Definition at line 531 of file phot\+\_\+util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=225pt]{templates_8h_a67e3cb7a7d0cd3d55277fc4f3373fe2e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae3980e27bb2bae10474bdb798a3e84b1}\label{templates_8h_ae3980e27bb2bae10474bdb798a3e84b1}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+sphere2@{ds\+\_\+to\+\_\+sphere2}}
\index{ds\+\_\+to\+\_\+sphere2@{ds\+\_\+to\+\_\+sphere2}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+sphere2()}{ds\_to\_sphere2()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+sphere2 (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{r,  }\item[{struct \hyperlink{structphoton}{photon} $\ast$}]{p }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8bc3604c533b18b872bb155bfd444bb5}\label{templates_8h_a8bc3604c533b18b872bb155bfd444bb5}} 
\index{templates.\+h@{templates.\+h}!ds\+\_\+to\+\_\+wind@{ds\+\_\+to\+\_\+wind}}
\index{ds\+\_\+to\+\_\+wind@{ds\+\_\+to\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ds\+\_\+to\+\_\+wind()}{ds\_to\_wind()}}
{\footnotesize\ttfamily double ds\+\_\+to\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int $\ast$}]{ndom\+\_\+current }\end{DoxyParamCaption})}



calculates the photon pathlength to the edge of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pp A photon \\
\hline
\mbox{\tt in,out}  & {\em int} & $\ast$ ndom\+\_\+current The current domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The distance to the nearest boundary of the wind and the domain for which the boudary applies.
\end{DoxyReturn}
Python defines the boundaries of the wind in term of the intersection of a biconical flow (defined by an inner and outer windcone) and an inner and outer radius centered on the star. If the user is interested in a biconical flow, he/she will most likely set the radii so that they do not truncate the wind. Similarly, by choosing parameters for the windcones properly, one can assure that one has a completely spherical flow. However, the user may also perversely set the parameters to that both the conical flow boundaries and the min and maximum radius come into play.

Usually, one would efine the two types of The two types of boundaries are sually defined so that one includes the other and so the cones apply when one is ealing with a CV type wind, while the inner and outer radius applies for a spherical odel. However this routine does not require this to be the case, since it just alculates where the edges are.

n any event, if you are inside the wind already ds\+\_\+to\+\_\+wind calculates the distance to the edge of the wind. If you are outside, It will also be to the nearest edge.

The routine distinguishes between two basic cases. Either the photon is already in the wind in which case one looks for the nearest boundary, or the photon is not currently in the wind and you have to translate it until it reaches the the boundary (or V\+E\+R\+Y\+\_\+\+B\+IG)

\paragraph*{Notes}

There is no guarantee that you will still be in the region defined by the grid.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000042}{Bug}]1802 -\/ksl -\/ At present this routine for imported models this routine only deals with cylindrical models. Additionally for imported models we skip all of the of the wind\+\_\+cones. This is inefficient, and needs to be corrected for rtheta and spherical models which can easily be handled using wind cones.\end{DoxyRefDesc}


Definition at line 364 of file photon2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8bc3604c533b18b872bb155bfd444bb5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{templates_8h_a8bc3604c533b18b872bb155bfd444bb5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a655c28bba6dc25187e6173f6787364c4}\label{templates_8h_a655c28bba6dc25187e6173f6787364c4}} 
\index{templates.\+h@{templates.\+h}!dvds\+\_\+ave@{dvds\+\_\+ave}}
\index{dvds\+\_\+ave@{dvds\+\_\+ave}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{dvds\+\_\+ave()}{dvds\_ave()}}
{\footnotesize\ttfamily int dvds\+\_\+ave (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Calculate the direction averaged (and maximum) dv\+\_\+ds in each grid cell of the wind. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine cycles through all of the cells in the wind, and calculates the aveage value of dv\+\_\+ds at the center of the wind cell by randomly generating directions and then calculating dv\+\_\+ds in these directions

It not only finds the average value, it also keeps track of the maximum value of dvds and its direction

\paragraph*{Notes}

The routine is called during the intialization process and fills the following elements of wmain


\begin{DoxyItemize}
\item dvds\+\_\+ave -\/ the average dvds
\item dvds\+\_\+max -\/ the maximum value of dvds
\item lmn -\/ the direction of the maximum value
\end{DoxyItemize}

There is an advanced mode which prints this information to file. 

Definition at line 191 of file gradv.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=216pt]{templates_8h_a655c28bba6dc25187e6173f6787364c4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1ab28108b78d1f2ef6a5eb725a9d1ea8}\label{templates_8h_a1ab28108b78d1f2ef6a5eb725a9d1ea8}} 
\index{templates.\+h@{templates.\+h}!dvds\+\_\+summary@{dvds\+\_\+summary}}
\index{dvds\+\_\+summary@{dvds\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{dvds\+\_\+summary()}{dvds\_summary()}}
{\footnotesize\ttfamily int dvds\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a96c552f69871659978a481c47617fc6c}\label{templates_8h_a96c552f69871659978a481c47617fc6c}} 
\index{templates.\+h@{templates.\+h}!dvwind\+\_\+ds@{dvwind\+\_\+ds}}
\index{dvwind\+\_\+ds@{dvwind\+\_\+ds}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{dvwind\+\_\+ds()}{dvwind\_ds()}}
{\footnotesize\ttfamily double dvwind\+\_\+ds (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



find the gradient velocity vector v, dv\+\_\+ds for a photon at a certain postion travelling in a certain direction 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p A photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
dvds on successful completion the value of where in grid if the photon outside the wind grid.
\end{DoxyReturn}
\paragraph*{Notes}

For spherical coordinates the routine calculates the gradient on the fly, that is moves the photon a bit and calculates dvds

For 2d systems, the velocity gradient is calculated using the velocity gradient tensors, which contain the velocity gradient in the xz plane.

It\textquotesingle{}s not clear how much faster the method used for 2d systems actually is, and one might want to consider the on-\/the-\/ fly appoach for all systems. 

Definition at line 47 of file gradv.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a96c552f69871659978a481c47617fc6c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aadfef07cd398269d10d8c8e4b91986d1}\label{templates_8h_aadfef07cd398269d10d8c8e4b91986d1}} 
\index{templates.\+h@{templates.\+h}!electron\+\_\+summary@{electron\+\_\+summary}}
\index{electron\+\_\+summary@{electron\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{electron\+\_\+summary()}{electron\_summary()}}
{\footnotesize\ttfamily int electron\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9ae82cdebefd0a70326fd37ee0a61fd4}\label{templates_8h_a9ae82cdebefd0a70326fd37ee0a61fd4}} 
\index{templates.\+h@{templates.\+h}!emit\+\_\+matom@{emit\+\_\+matom}}
\index{emit\+\_\+matom@{emit\+\_\+matom}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{emit\+\_\+matom()}{emit\_matom()}}
{\footnotesize\ttfamily int emit\+\_\+matom (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nres,  }\item[{int}]{upper }\end{DoxyParamCaption})}



a scaled down version of matom which deals with deactivation only for spectral cycles. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w the ptr to the structure defining the wind \\
\hline
\mbox{\tt in}  & {\em int} & upper the upper level that we deactivate from \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the packet at the point of activation and deactivation \\
\hline
\mbox{\tt in,out}  & {\em int} & nres the process by which deactivation occurs \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
emit\+\_\+matom is a scaled down version of matom which deals with the emission due to deactivating macro atoms in the detailed spectrum part of the calculation.

\paragraph*{Notes}

Definition at line 1323 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9ae82cdebefd0a70326fd37ee0a61fd4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a337db7e010442d30f7c4b45f3e41fa5c}\label{templates_8h_a337db7e010442d30f7c4b45f3e41fa5c}} 
\index{templates.\+h@{templates.\+h}!emittance\+\_\+bb@{emittance\+\_\+bb}}
\index{emittance\+\_\+bb@{emittance\+\_\+bb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{emittance\+\_\+bb()}{emittance\_bb()}}
{\footnotesize\ttfamily double emittance\+\_\+bb (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{t }\end{DoxyParamCaption})}



Calculate the emittance of a bb between freqmin and freqmax. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequency \\
\hline
\mbox{\tt in}  & {\em double} & t ??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
??? R\+E\+T\+U\+R\+NS ???
\end{DoxyReturn}
\paragraph*{Notes}

This should integrate to sigma if freqmin and freqmax go effeictively from 0 to infinity 

Definition at line 564 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a337db7e010442d30f7c4b45f3e41fa5c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a337db7e010442d30f7c4b45f3e41fa5c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9bd7eb064b17d9b352e044d5e417a649}\label{templates_8h_a9bd7eb064b17d9b352e044d5e417a649}} 
\index{templates.\+h@{templates.\+h}!emittance\+\_\+bpow@{emittance\+\_\+bpow}}
\index{emittance\+\_\+bpow@{emittance\+\_\+bpow}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{emittance\+\_\+bpow()}{emittance\_bpow()}}
{\footnotesize\ttfamily double emittance\+\_\+bpow (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{lum,  }\item[{double}]{alpha }\end{DoxyParamCaption})}



Works out the luminosity of a broken power law. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & freqmin min frequency that we are generating photons over \\
\hline
\mbox{\tt in,out}  & {\em double} & freqmax max frequency that we are generating photons over \\
\hline
\mbox{\tt in,out}  & {\em double} & lum 2-\/10kev luminosity \\
\hline
\mbox{\tt in,out}  & {\em double} & alpha is the 2-\/10kev slope. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
emit The luminosity of the whole power law.
\end{DoxyReturn}
computes the emittance of a broken power law coded to try to replicate the cloudy table type power law. There are three sections -\/ a central bit, which should cover the 2-\/10kev portion of the spectrum, a low frequency tail and a high frequency tail .

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 219 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9bd7eb064b17d9b352e044d5e417a649_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9bd7eb064b17d9b352e044d5e417a649_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9d1648c5fc65c0c98f2cdf51dfaee558}\label{templates_8h_a9d1648c5fc65c0c98f2cdf51dfaee558}} 
\index{templates.\+h@{templates.\+h}!emittance\+\_\+continuum@{emittance\+\_\+continuum}}
\index{emittance\+\_\+continuum@{emittance\+\_\+continuum}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{emittance\+\_\+continuum()}{emittance\_continuum()}}
{\footnotesize\ttfamily double emittance\+\_\+continuum (\begin{DoxyParamCaption}\item[{int}]{spectype,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{t,  }\item[{double}]{g }\end{DoxyParamCaption})}



get the surface flux for Hubeny/\+Kurucz like stellar models 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & spectype an integer identifying the set of models to use \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The mimimum frequency \\
\hline
 & {\em \mbox{[}int\mbox{]}} & double freqmax The maximum frequency \\
\hline
\mbox{\tt in}  & {\em double} & t A temperature \\
\hline
\mbox{\tt in}  & {\em double} & g A gravity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The surface flux for a star-\/like spectrum read from a grid
\end{DoxyReturn}
The routine gets the band-\/limited flux per unit area for Hubeny or Kurucz models which are both in units of the Eddingting flux (H)

\paragraph*{Notes}

As indicated this is not a general purpose routine. Not all spectral models for stars are calculated in terms of the Eddington flux. The factor of 4 pi is the conversion from Eddington flux to phhysical flux

For an explanation see Hubeny \& Mihalas -\/ Theory of Stellar Atmospheres, equation 3.\+70 (or Mihalas, Stellar Atmospheres 2nd ed, eq (1-\/27).

Note that the observed flux at a distance is given by

f/H = 4pi $\ast$ R$\ast$$\ast$2/d$\ast$$\ast$2

and

L=f$\ast$4pi$\ast$\+R$\ast$$\ast$2 = 16 pi$\ast$$\ast$2 R$\ast$$\ast$2 H 

Definition at line 259 of file continuum.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9d1648c5fc65c0c98f2cdf51dfaee558_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9d1648c5fc65c0c98f2cdf51dfaee558_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab172924888b8579c4acdd737732edce1}\label{templates_8h_ab172924888b8579c4acdd737732edce1}} 
\index{templates.\+h@{templates.\+h}!emittance\+\_\+pow@{emittance\+\_\+pow}}
\index{emittance\+\_\+pow@{emittance\+\_\+pow}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{emittance\+\_\+pow()}{emittance\_pow()}}
{\footnotesize\ttfamily double emittance\+\_\+pow (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{double}]{alpha }\end{DoxyParamCaption})}



The luminosity of a power law over a frerquency range. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freqmin lower frequency bound \\
\hline
\mbox{\tt in}  & {\em double} & freqmax upper frequency bound \\
\hline
\mbox{\tt in}  & {\em double} & alpha spectral index \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
double emit the luminosoty
\end{DoxyReturn}
A Simple routine which just integrates a power law between two limits. There is a little bit of code that deals with the case where an advanced mode is used that cuts off the low frequency tail -\/ and a bit of clever work to check for the pathalogical case of alpha=-\/1 where one cannot symbolically integrate.

\paragraph*{Notes}

Definition at line 131 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab172924888b8579c4acdd737732edce1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab172924888b8579c4acdd737732edce1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad5da2d7b86cbdf86c1fc733c56d9f302}\label{templates_8h_ad5da2d7b86cbdf86c1fc733c56d9f302}} 
\index{templates.\+h@{templates.\+h}!exp\+\_\+mean@{exp\+\_\+mean}}
\index{exp\+\_\+mean@{exp\+\_\+mean}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{exp\+\_\+mean()}{exp\_mean()}}
{\footnotesize\ttfamily double exp\+\_\+mean (\begin{DoxyParamCaption}\item[{double}]{exp\+\_\+temp,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}



Calculate the mean frequency of an exponential distribution. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & exp\+\_\+temp The effective temperature of the distribution \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Miniumum frequency \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The mean frequency
\end{DoxyReturn}
The mean of a frequency depedant mean inteisntiy is the integral of nu j(nu) divided by the integral of j(nu). The prefactor w is lost in the division, so this function should equal the mean frequency. Since this is a simple algrebraic frequency distribution we can integrate algebraically

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 555 of file spectral\+\_\+estimators.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad5da2d7b86cbdf86c1fc733c56d9f302_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a288f4e76f4f5ee38900c0f14b5a4ac21}\label{templates_8h_a288f4e76f4f5ee38900c0f14b5a4ac21}} 
\index{templates.\+h@{templates.\+h}!exp\+\_\+stddev@{exp\+\_\+stddev}}
\index{exp\+\_\+stddev@{exp\+\_\+stddev}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{exp\+\_\+stddev()}{exp\_stddev()}}
{\footnotesize\ttfamily double exp\+\_\+stddev (\begin{DoxyParamCaption}\item[{double}]{exp\+\_\+temp,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}



This program works out the standard deviation. 


\begin{DoxyParams}[1]{Parameters}
 & {\em \mbox{[}in} & out\mbox{]} double exp\+\_\+temp -\/ the temperature of the exponential model of J\+\_\+nu \\
\hline
\mbox{\tt in}  & {\em double} & numin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & numax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The standard deviation of the mean intensity model
\end{DoxyReturn}
First we work out the integral of nu$^\wedge$2 jnu / int jnu. Then we subtract the (mean/j)$^\wedge$2 and then take the square root.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 642 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=223pt]{templates_8h_a288f4e76f4f5ee38900c0f14b5a4ac21_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{templates_8h_a288f4e76f4f5ee38900c0f14b5a4ac21_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a17dff6266e67bdc289c6ac89d1a230b7}\label{templates_8h_a17dff6266e67bdc289c6ac89d1a230b7}} 
\index{templates.\+h@{templates.\+h}!exp\+\_\+temp\+\_\+func@{exp\+\_\+temp\+\_\+func}}
\index{exp\+\_\+temp\+\_\+func@{exp\+\_\+temp\+\_\+func}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{exp\+\_\+temp\+\_\+func()}{exp\_temp\_func()}}
{\footnotesize\ttfamily double exp\+\_\+temp\+\_\+func (\begin{DoxyParamCaption}\item[{double}]{exp\+\_\+temp }\end{DoxyParamCaption})}



Function used in zbrent to work out best value of alpha for a power law model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & exp\+\_\+temp The effective temperature of an expontential model for J\+\_\+nu \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Difference between the mean of a modelled photon spectrum and the observed one
\end{DoxyReturn}
This function is used in zbrent to search for the value of \textquotesingle{}temperature\textquotesingle{} which makes the mean frequewncy from an expoential model (coputed in a subroutine) function equal to the mean frequency computed for the cell from photon packets. So we subtract the mean frequency at the end to make the value of the function equal to zero at the correct temperature.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 523 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{templates_8h_a17dff6266e67bdc289c6ac89d1a230b7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{templates_8h_a17dff6266e67bdc289c6ac89d1a230b7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad6d1b9b9650b2f9e2f3bd72bfb5e5382}\label{templates_8h_ad6d1b9b9650b2f9e2f3bd72bfb5e5382}} 
\index{templates.\+h@{templates.\+h}!exp\+\_\+w@{exp\+\_\+w}}
\index{exp\+\_\+w@{exp\+\_\+w}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{exp\+\_\+w()}{exp\_w()}}
{\footnotesize\ttfamily double exp\+\_\+w (\begin{DoxyParamCaption}\item[{double}]{j,  }\item[{double}]{exp\+\_\+temp,  }\item[{double}]{numin,  }\item[{double}]{numax }\end{DoxyParamCaption})}



This program works out the scaling factor for an exponential representation of a spectrum. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & j The \textquotesingle{}measured\textquotesingle{} mean intensity for a cell/band \\
\hline
 & {\em \mbox{[}in} & out\mbox{]} double exp\+\_\+temp -\/ the temperature of the exponential model of J\+\_\+nu \\
\hline
\mbox{\tt in}  & {\em double} & numin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & numax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
w -\/ the scaling factor
\end{DoxyReturn}
We compute J/W= integral from numin to numax of e$^\wedge$(-\/nhu/kt). We then obtain W by comparing this number to the measured mean intensity in the band

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 600 of file spectral\+\_\+estimators.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{templates_8h_ad6d1b9b9650b2f9e2f3bd72bfb5e5382_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a280fcbb3dddfaf58a73b2a8d6fd61c76}\label{templates_8h_a280fcbb3dddfaf58a73b2a8d6fd61c76}} 
\index{templates.\+h@{templates.\+h}!extract@{extract}}
\index{extract@{extract}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{extract()}{extract()}}
{\footnotesize\ttfamily int extract (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{itype }\end{DoxyParamCaption})}



A supervisory routine called to builds detailed spectra in the normal (extract) mode. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p The photon to extract \\
\hline
\mbox{\tt in,out}  & {\em int} & itype An integer representing the type of photon for the purpose of being extracted. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
extract is called when a photon begins it\textquotesingle{}s flight and every time that photon scatters, unless the user has exercised the \char`\"{}live or die\char`\"{} option, in which case it is not called.

extract carries out several preperatory steps for the extraction and for each spectrum one wants to build, it calls extract\+\_\+one, where the actual incrementing of the spectrum is done.

itype takes on the following values\+:
\begin{DoxyItemize}
\item P\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+R-\/$>$the photon came for the star
\item P\+T\+Y\+P\+E\+\_\+\+B\+L-\/$>$the photon came from the boundary layer
\item P\+T\+Y\+P\+E\+\_\+\+D\+I\+S\+K-\/$>$the photon being redirected arose in the disk,
\item P\+T\+Y\+P\+E\+\_\+\+W\+I\+N\+D-\/$>$the photon being redirected arose in the wind,
\end{DoxyItemize}

extract uses the types to prepare the photon for extraction, including doppler shifting the photon if is of P\+T\+Y\+P\+E\+\_\+\+W\+I\+ND or P\+T\+Y\+P\+E\+\_\+\+S\+T\+AR

Usually, Python constructs a spectrum of all photons, but there are advanced options which allone to restict the spectrum created to those produced with a certain number of scatters or from photons that arise from the above or below the disk. extract enforces those choices before calling extract\+\_\+one. The parameters for this option all come in through \hyperlink{python_8h}{python.\+h}, and are contained in the spectrum structure.

The basic choices, some of which can be used in tandom are as follows\+:


\begin{DoxyItemize}
\item If s\mbox{[}n\mbox{]}.nscat$>$999; then one obtains the entire spectrum
\item if s\mbox{[}n\mbox{]}.nscat is a positive number, then the spectrum is composed just of photons with that number of scatters
\item if s\mbox{[}n\mbox{]}.nscat is a negative number, then the spectrum contains all photons with $>$= the absolute value of s\mbox{[}n\mbox{]}.nscat
\item s\mbox{[}n\mbox{]}.top\+\_\+bot=0 -\/$>$ accept all photons
\item s\mbox{[}n\mbox{]}.top\+\_\+bot $>$0 -\/$>$ accept photons last above the disk
\item s\mbox{[}n\mbox{]}.top\+\_\+bot $<$0 -\/$>$ accept photons below the disk
\item One can also select photons that are to be extracted from a particular spherical region. \paragraph*{Notes}
\end{DoxyItemize}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000024}{Bug}]This routine as well as extract\+\_\+one have options for tracking the photon history. The routines are in \hyperlink{diag_8c}{diag.\+c} It is not clear that they have been used in a long time and so it may be worthwhile to remove them. Furthermore, we have established a new mechanism save\+\_\+phot for essentially this same task. This really should be consolidated. \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000025}{Bug}]This is also commented in the text, but there is a rather bizarre separation for where the photon frequency is updated and where the weight is update. The former is done in extract, while the latter is done in extract\+\_\+one. This is not an error precisely but makes the code more confusing than it needs to be.\end{DoxyRefDesc}


Definition at line 149 of file extract.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a280fcbb3dddfaf58a73b2a8d6fd61c76_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a280fcbb3dddfaf58a73b2a8d6fd61c76_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1aaecc045729b48d2ede700108567dcd}\label{templates_8h_a1aaecc045729b48d2ede700108567dcd}} 
\index{templates.\+h@{templates.\+h}!extract\+\_\+one@{extract\+\_\+one}}
\index{extract\+\_\+one@{extract\+\_\+one}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{extract\+\_\+one()}{extract\_one()}}
{\footnotesize\ttfamily int extract\+\_\+one (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int}]{itype,  }\item[{int}]{nspec }\end{DoxyParamCaption})}



(w,pp,itype,nspec) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & pp The photon to be extracted \\
\hline
\mbox{\tt in}  & {\em int} & itype The type of photon (star, disk, wind, etc) \\
\hline
\mbox{\tt in}  & {\em int} & nspec the spectrum which will be incremented \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The photon status after translation
\end{DoxyReturn}
extract\+\_\+one is analogous to the detailed portion of transphot except here the basic point is to calculate the optical depth through the plasma in a certain direction, and to increment the appropriate spectrum.

Unlike trans\+\_\+phot, this routine also checks to see if whether the photon hits the secondary star, if one exists.

\paragraph*{Notes}

The logic behind the weighting of the photons is described in Christian Knigge\textquotesingle{}s thesis in section 2.\+3.\+4. According to equation 2.\+19 Pc/\+Pw=12 cos(theta)$\ast$(1+b cos(theta)/(3+2b) where b=1.\+5 corresponds to the Eddington approximation.

In Python, and in extract and transphot in particular, tau generally refers to the tau associated with scattering processes, and the weight contains the effect of dimunition of the energy of the photon bundle due to pure absorption processes. So, in extract, we add pp-\/$>$w $\ast$ exp(-\/tau) to the spectrum.

Note that both linearly and logarithmically spaced spectra are produced. 

Definition at line 307 of file extract.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1aaecc045729b48d2ede700108567dcd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1aaecc045729b48d2ede700108567dcd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa39c27768ea571d93b29aa2bf90e7913}\label{templates_8h_aa39c27768ea571d93b29aa2bf90e7913}} 
\index{templates.\+h@{templates.\+h}!fake\+\_\+matom\+\_\+bb@{fake\+\_\+matom\+\_\+bb}}
\index{fake\+\_\+matom\+\_\+bb@{fake\+\_\+matom\+\_\+bb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{fake\+\_\+matom\+\_\+bb()}{fake\_matom\_bb()}}
{\footnotesize\ttfamily int fake\+\_\+matom\+\_\+bb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nres,  }\item[{int $\ast$}]{escape }\end{DoxyParamCaption})}



Definition at line 1159 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=258pt]{templates_8h_aa39c27768ea571d93b29aa2bf90e7913_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4c03c66dea8a22dd2a87077c816d26c2}\label{templates_8h_a4c03c66dea8a22dd2a87077c816d26c2}} 
\index{templates.\+h@{templates.\+h}!fake\+\_\+matom\+\_\+bf@{fake\+\_\+matom\+\_\+bf}}
\index{fake\+\_\+matom\+\_\+bf@{fake\+\_\+matom\+\_\+bf}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{fake\+\_\+matom\+\_\+bf()}{fake\_matom\_bf()}}
{\footnotesize\ttfamily int fake\+\_\+matom\+\_\+bf (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nres,  }\item[{int $\ast$}]{escape }\end{DoxyParamCaption})}



Definition at line 1276 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{templates_8h_a4c03c66dea8a22dd2a87077c816d26c2_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9c153b5e0d982b2debddf4523274d159}\label{templates_8h_a9c153b5e0d982b2debddf4523274d159}} 
\index{templates.\+h@{templates.\+h}!fb@{fb}}
\index{fb@{fb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{fb()}{fb()}}
{\footnotesize\ttfamily double fb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t,  }\item[{double}]{freq,  }\item[{int}]{ion\+\_\+choice,  }\item[{int}]{fb\+\_\+choice }\end{DoxyParamCaption})}



calculates either the free\+\_\+bound emissivity at a specific frequency or depending on inputs, the recombination rate 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma A plasma cell \\
\hline
\mbox{\tt in}  & {\em double} & t The temperature at which to calculate the emisivity \\
\hline
\mbox{\tt in}  & {\em double} & freq The frequency at which to calculate the emissivity \\
\hline
\mbox{\tt in}  & {\em int} & ion\+\_\+choice Either the total or the emissivity for a specific ion \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice determines whether what is returned is the emissivity a specific frecuency 0 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The returns depend on fb\+\_\+choice
\end{DoxyReturn}
If ion\+\_\+choice is a number less than the number of ions then the value returned for that specific ion. However if ion\+\_\+choice is set to the number of ions or greater, the the value returned is for the sum of all the ions.

The choices are\+:
\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombination rate
\end{DoxyItemize}

\paragraph*{Notes}

This routine calls subroutines that have variablew which are are transmitted externally, e.\+g fbt,fbfr, rather than though calls. The reason for this is some of the routines are also used as integrands where only one variable can be transimitted directly.

This routine does not have choices associated with inner shell recombination. 

Definition at line 840 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9c153b5e0d982b2debddf4523274d159_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{templates_8h_a9c153b5e0d982b2debddf4523274d159_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4afaeaee23214405bf4d30a7d2eb06b6}\label{templates_8h_a4afaeaee23214405bf4d30a7d2eb06b6}} 
\index{templates.\+h@{templates.\+h}!fb\+\_\+topbase\+\_\+partial@{fb\+\_\+topbase\+\_\+partial}}
\index{fb\+\_\+topbase\+\_\+partial@{fb\+\_\+topbase\+\_\+partial}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{fb\+\_\+topbase\+\_\+partial()}{fb\_topbase\_partial()}}
{\footnotesize\ttfamily double fb\+\_\+topbase\+\_\+partial (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms of Topbase photoionization x-\/sections. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq The freqeuncy of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An emissivity or a recombination rate
\end{DoxyReturn}
What the routine returns depends on the external variable fbfr. The choices are\+:


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

\paragraph*{Notes}

Generally speaiking this routine is integrated over frequency using a NR reciepes routine for that purpsoe. For that reason, much of the information has to be passed externally 

Definition at line 100 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4afaeaee23214405bf4d30a7d2eb06b6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4afaeaee23214405bf4d30a7d2eb06b6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ade7eab896d4188a5b8a4ed6845d33150}\label{templates_8h_ade7eab896d4188a5b8a4ed6845d33150}} 
\index{templates.\+h@{templates.\+h}!ff@{ff}}
\index{ff@{ff}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ff()}{ff()}}
{\footnotesize\ttfamily double ff (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{freq }\end{DoxyParamCaption})}



calculate f\+\_\+nu for ff emisssion 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Wind\+Ptr one A wind cell \\
\hline
{\em \mbox{[}in} & out\mbox{]} double t\+\_\+e The temperature of the plasma \\
\hline
{\em \mbox{[}in} & out\mbox{]} double freq The frequency at which f\+\_\+nu is to be calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
f\+\_\+nu for the specific freqency, temperature requested and densities contained in the cell indicated
\end{DoxyReturn}
\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000023}{Bug}]f\+\_\+nu is set to 0 for t\+\_\+e less than 100K. It\textquotesingle{}s not clear that this limit is applied to other functions anymore. Was this missed? Not also that the code having to do with the gaunt factor is duplicated from another routine. Should a gaunt\+\_\+ff routine be created for both?\end{DoxyRefDesc}


Definition at line 587 of file emission.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=189pt]{templates_8h_ade7eab896d4188a5b8a4ed6845d33150_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ade7eab896d4188a5b8a4ed6845d33150_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af6512a7f0dc1a503410409043ff4eaa3}\label{templates_8h_af6512a7f0dc1a503410409043ff4eaa3}} 
\index{templates.\+h@{templates.\+h}!find\+\_\+element@{find\+\_\+element}}
\index{find\+\_\+element@{find\+\_\+element}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{find\+\_\+element()}{find\_element()}}
{\footnotesize\ttfamily int find\+\_\+element (\begin{DoxyParamCaption}\item[{int}]{element }\end{DoxyParamCaption})}



Definition at line 3511 of file py\+\_\+wind\+\_\+sub.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af6512a7f0dc1a503410409043ff4eaa3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4980d1ea5c262038e2836a2d3a06f053}\label{templates_8h_a4980d1ea5c262038e2836a2d3a06f053}} 
\index{templates.\+h@{templates.\+h}!find\+\_\+ion@{find\+\_\+ion}}
\index{find\+\_\+ion@{find\+\_\+ion}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{find\+\_\+ion()}{find\_ion()}}
{\footnotesize\ttfamily int find\+\_\+ion (\begin{DoxyParamCaption}\item[{int}]{element,  }\item[{int}]{istate }\end{DoxyParamCaption})}



Definition at line 3483 of file py\+\_\+wind\+\_\+sub.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4980d1ea5c262038e2836a2d3a06f053_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad350a11e70a4518fb86b842942575e26}\label{templates_8h_ad350a11e70a4518fb86b842942575e26}} 
\index{templates.\+h@{templates.\+h}!fix\+\_\+concentrations@{fix\+\_\+concentrations}}
\index{fix\+\_\+concentrations@{fix\+\_\+concentrations}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{fix\+\_\+concentrations()}{fix\_concentrations()}}
{\footnotesize\ttfamily int fix\+\_\+concentrations (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



sets the concentrations of individual ions assuming hard coded ionization fractions that are read from a file 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A plasma cell \\
\hline
\mbox{\tt in}  & {\em int} & mode U\+N\+U\+S\+ED \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The first time the routine is called it reads the file specified by geo.\+con\+\_\+file which populates the \hyperlink{structforce__con}{force\+\_\+con} array.

On subsequent calls the values of one of an xplasma element are modified.

The format of the file is fairly obvious

Element.\+z Ion ion\+\_\+fraction

6 4 1

would set the C\+IV fraction to 1.

Note there is nothing forcing the totals to be anything sensible.

\paragraph*{Notes}

o change the ions that you want to fix, simply update con\+\_\+force, A\+ND M\+A\+KE S\+U\+RE N\+F\+O\+R\+CE IS S\+ET TO T\+HE N\+U\+M\+B\+ER OF I\+O\+NS

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000053}{Bug}]It is not obvious that this is really what we want. This routine was written when we only were concerned about scattering and does not really take into account emission (for which one needs n\+\_\+e. One possiblity is to calculated ion abundances for H and He properly, in which case we would need the mode variable.\end{DoxyRefDesc}


Definition at line 803 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad350a11e70a4518fb86b842942575e26_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af8c5f231035fc1a85000b9849b4fb0ed}\label{templates_8h_af8c5f231035fc1a85000b9849b4fb0ed}} 
\index{templates.\+h@{templates.\+h}!fraction@{fraction}}
\index{fraction@{fraction}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{fraction()}{fraction()}}
{\footnotesize\ttfamily int fraction (\begin{DoxyParamCaption}\item[{double}]{value,  }\item[{double}]{array\mbox{[}$\,$\mbox{]},  }\item[{int}]{npts,  }\item[{int $\ast$}]{ival,  }\item[{double $\ast$}]{f,  }\item[{int}]{mode }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a892b60c229b8cc4fbc4187ee0cb88e1f}\label{templates_8h_a892b60c229b8cc4fbc4187ee0cb88e1f}} 
\index{templates.\+h@{templates.\+h}!free\+\_\+vector@{free\+\_\+vector}}
\index{free\+\_\+vector@{free\+\_\+vector}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{free\+\_\+vector()}{free\_vector()}}
{\footnotesize\ttfamily void free\+\_\+vector (\begin{DoxyParamCaption}\item[{double $\ast$}]{a,  }\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})}



Definition at line 332 of file recipes.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{templates_8h_a892b60c229b8cc4fbc4187ee0cb88e1f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae0a25dafbba4fa94dab4b4876b6b6d1a}\label{templates_8h_ae0a25dafbba4fa94dab4b4876b6b6d1a}} 
\index{templates.\+h@{templates.\+h}!freq\+\_\+summary@{freq\+\_\+summary}}
\index{freq\+\_\+summary@{freq\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{freq\+\_\+summary()}{freq\_summary()}}
{\footnotesize\ttfamily int freq\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a900ff3bb7a80569abf42be1e2b00fd36}\label{templates_8h_a900ff3bb7a80569abf42be1e2b00fd36}} 
\index{templates.\+h@{templates.\+h}!freqs\+\_\+init@{freqs\+\_\+init}}
\index{freqs\+\_\+init@{freqs\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{freqs\+\_\+init()}{freqs\_init()}}
{\footnotesize\ttfamily int freqs\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



This is the routine where the frequency boundaries for course spectra are established. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & freqmin The minimum frequency \\
\hline
\mbox{\tt in,out}  & {\em double} & freqmax The maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
In addition to setting bands which define the photons that are generated one must define bands that approximated the spectra in a cell. One cannot store all of the photons and their weights. This routine creates boundaries for storring the spectra.

\paragraph*{Notes}

At present everything is hardwired. Two typs of banding are carred out, one for A\+G\+N/\+X-\/ray bianries, and one for stellar systems

freqmin and freqmax are used inorder to limit the total range of the spectral bands.

The results are stored in geo.\+xfreq 

Definition at line 608 of file bands.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=271pt]{templates_8h_a900ff3bb7a80569abf42be1e2b00fd36_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=283pt]{templates_8h_a900ff3bb7a80569abf42be1e2b00fd36_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa5dfb70302251c14bd8a01ff6f3ec20a}\label{templates_8h_aa5dfb70302251c14bd8a01ff6f3ec20a}} 
\index{templates.\+h@{templates.\+h}!gamma\+\_\+e\+\_\+integrand@{gamma\+\_\+e\+\_\+integrand}}
\index{gamma\+\_\+e\+\_\+integrand@{gamma\+\_\+e\+\_\+integrand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{gamma\+\_\+e\+\_\+integrand()}{gamma\_e\_integrand()}}
{\footnotesize\ttfamily double gamma\+\_\+e\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



the integrand for the energy-\/weighted photoionization rate estimator, 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
the integrand for the energy-\/weighted photoionization rate estimator, equation 3.\+66 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1116 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{templates_8h_aa5dfb70302251c14bd8a01ff6f3ec20a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa5dfb70302251c14bd8a01ff6f3ec20a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0332ea341d92221cbaa2600a2adaa35f}\label{templates_8h_a0332ea341d92221cbaa2600a2adaa35f}} 
\index{templates.\+h@{templates.\+h}!gamma\+\_\+integrand@{gamma\+\_\+integrand}}
\index{gamma\+\_\+integrand@{gamma\+\_\+integrand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{gamma\+\_\+integrand()}{gamma\_integrand()}}
{\footnotesize\ttfamily double gamma\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



integrand for the dilute photoionization rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integrand
\end{DoxyReturn}
integrand for the dilute photoionization rate estimator, for a black body radiation field with known dilution factor and temperature see equation 3.\+64 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1044 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{templates_8h_a0332ea341d92221cbaa2600a2adaa35f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0332ea341d92221cbaa2600a2adaa35f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab7869aa7674de4defa57e532b23d3a2d}\label{templates_8h_ab7869aa7674de4defa57e532b23d3a2d}} 
\index{templates.\+h@{templates.\+h}!gather\+\_\+spectra\+\_\+para@{gather\+\_\+spectra\+\_\+para}}
\index{gather\+\_\+spectra\+\_\+para@{gather\+\_\+spectra\+\_\+para}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{gather\+\_\+spectra\+\_\+para()}{gather\_spectra\_para()}}
{\footnotesize\ttfamily int gather\+\_\+spectra\+\_\+para (\begin{DoxyParamCaption}\item[{int}]{nspec\+\_\+helper,  }\item[{int}]{nspecs }\end{DoxyParamCaption})}



sum up the synthetic spectra between threads. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nspecs number of spectra to compute \\
\hline
\mbox{\tt in}  & {\em int} & nspec\+\_\+helper the length of the big arrays to help with the M\+PI reductions of the spectra equal to 2 $\ast$ number of spectra (N\+S\+P\+EC) $\ast$ number of wavelengths.\\
\hline
\end{DoxyParams}
sum up the synthetic spectra between threads. Does an M\+P\+I\+\_\+\+Reduce then an M\+P\+I\+\_\+\+Bcast for each element of the linear and log spectra arrays (xxspec) 

Definition at line 286 of file para\+\_\+update.\+c.

\mbox{\Hypertarget{templates_8h_aaad109a8ae79883e98e2dee88d65bd4e}\label{templates_8h_aaad109a8ae79883e98e2dee88d65bd4e}} 
\index{templates.\+h@{templates.\+h}!gaunt\+\_\+ff@{gaunt\+\_\+ff}}
\index{gaunt\+\_\+ff@{gaunt\+\_\+ff}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{gaunt\+\_\+ff()}{gaunt\_ff()}}
{\footnotesize\ttfamily double gaunt\+\_\+ff (\begin{DoxyParamCaption}\item[{double}]{gsquared }\end{DoxyParamCaption})}



computes the frequency averaged gaunt factor for ff emissionat scaled temperature from Sutherland (1988). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & gsquared The variable on which Sutherland\textquotesingle{}s ff gaunt factors are interpolated. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An estimate of the Gaunt factor (for a particular ion)
\end{DoxyReturn}
It interpolates simply interpolates between the tabulated factors from Table 3 of Sutherland.

\paragraph*{Notes}

The reference for this is Sutherland, R.$\sim$S. 1998, M\+N\+R\+AS, 300, 321

gsquared is the scaled inverse temperature experienced by an ion, Z$\ast$$\ast$2/kT(Ry). 

Definition at line 754 of file emission.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aaad109a8ae79883e98e2dee88d65bd4e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2d9e855352fbd6de6a7ed1cd79ac4a64}\label{templates_8h_a2d9e855352fbd6de6a7ed1cd79ac4a64}} 
\index{templates.\+h@{templates.\+h}!gdisk@{gdisk}}
\index{gdisk@{gdisk}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{gdisk()}{gdisk()}}
{\footnotesize\ttfamily double gdisk (\begin{DoxyParamCaption}\item[{double}]{mass,  }\item[{double}]{mdot,  }\item[{double}]{rmin }\end{DoxyParamCaption})}



Calculate a reference gravity for the disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & mass Mass of the central object \\
\hline
\mbox{\tt in}  & {\em double} & mdot Mass accretion rate of the disk \\
\hline
\mbox{\tt in}  & {\em double} & rmin Minimum radius for the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A fiducial gravity for the disk
\end{DoxyReturn}
The gravity is needed when one constructs a disk spectrum from spectra from a grid of stellar atmospheres

The input units are all cgs

\paragraph*{Notes}

See Long \& Knigge for details 

Definition at line 189 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2d9e855352fbd6de6a7ed1cd79ac4a64_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa4eb3da682e26e1705216d977de95a0a}\label{templates_8h_aa4eb3da682e26e1705216d977de95a0a}} 
\index{templates.\+h@{templates.\+h}!geff@{geff}}
\index{geff@{geff}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{geff()}{geff()}}
{\footnotesize\ttfamily double geff (\begin{DoxyParamCaption}\item[{double}]{g0,  }\item[{double}]{x }\end{DoxyParamCaption})}



Calculate the effective gravity at a specfic position in the disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & g0 reference gravity in cm s$\ast$$\ast$-\/2 \\
\hline
\mbox{\tt in}  & {\em double} & x distance from center in units of r/rmin \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
gravity at x in cm s$\ast$$\ast$-\/2
\end{DoxyReturn}
The gravity is needed when one constructs a disk spectrum from spectra from a grid of stellar atmospheres

\paragraph*{Notes}

See Long \& Knigge for details 

Definition at line 220 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa4eb3da682e26e1705216d977de95a0a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af2b816871b2b2e0a237a770995bb9803}\label{templates_8h_af2b816871b2b2e0a237a770995bb9803}} 
\index{templates.\+h@{templates.\+h}!gen\+\_\+array\+\_\+from\+\_\+func@{gen\+\_\+array\+\_\+from\+\_\+func}}
\index{gen\+\_\+array\+\_\+from\+\_\+func@{gen\+\_\+array\+\_\+from\+\_\+func}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{gen\+\_\+array\+\_\+from\+\_\+func()}{gen\_array\_from\_func()}}
{\footnotesize\ttfamily double gen\+\_\+array\+\_\+from\+\_\+func (\begin{DoxyParamCaption}\item[{double($\ast$)(double)}]{func,  }\item[{double}]{xmin,  }\item[{double}]{xmax,  }\item[{int}]{pdfsteps }\end{DoxyParamCaption})}



generates a cdf from a function 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & $\ast$func The probablility density function to be integrated to create the pdf \\
\hline
\mbox{\tt in}  & {\em double} & xmin,xmax; The range over which the function is to be integrated \\
\hline
\mbox{\tt in}  & {\em int} & pdfsteps; number of steps that are calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
delta -\/ the largest change in the cdf between any two points in the grid.
\end{DoxyReturn}
This is a routine which is called by cdf\+\_\+gen\+\_\+from\+\_\+func which simply calculates the cumulative distribution of the function in equally spaced steps between xmin and xmax. The C\+DF is properly normalized.

\paragraph*{Notes}

10oct -\/ ksl -\/\+This is rather brute force. An alternative would have been to have increased the density of points only in the region where it was needed. This could be done by looking at the regions where the sampling was poor in the initial calculation and addeding new points in in a new calculations. But this would require one to pass both the values of the C\+DF and the positions where the values were taken. This would be not be hard but would require more extensive modifications to pdf\+\_\+gen\+\_\+from func than currently. 

Definition at line 270 of file cdf.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af2b816871b2b2e0a237a770995bb9803_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af2b816871b2b2e0a237a770995bb9803_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ade8e60c03793f3c9f76d4ddd1c159346}\label{templates_8h_ade8e60c03793f3c9f76d4ddd1c159346}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+alpha\+\_\+st@{get\+\_\+alpha\+\_\+st}}
\index{get\+\_\+alpha\+\_\+st@{get\+\_\+alpha\+\_\+st}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+alpha\+\_\+st()}{get\_alpha\_st()}}
{\footnotesize\ttfamily double get\+\_\+alpha\+\_\+st (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the stimulated recombination rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
alpha\+\_\+st\+\_\+value
\end{DoxyReturn}
the stimulated recombination rate estimator, equation 3.\+65 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1153 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{templates_8h_ade8e60c03793f3c9f76d4ddd1c159346_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ade8e60c03793f3c9f76d4ddd1c159346_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_accd23482f2a991d91cb8dedaef4560ed}\label{templates_8h_accd23482f2a991d91cb8dedaef4560ed}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+alpha\+\_\+st\+\_\+e@{get\+\_\+alpha\+\_\+st\+\_\+e}}
\index{get\+\_\+alpha\+\_\+st\+\_\+e@{get\+\_\+alpha\+\_\+st\+\_\+e}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+alpha\+\_\+st\+\_\+e()}{get\_alpha\_st\_e()}}
{\footnotesize\ttfamily double get\+\_\+alpha\+\_\+st\+\_\+e (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the energy-\/weighted stimulated recombination estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
alpha\+\_\+st\+\_\+e\+\_\+value
\end{DoxyReturn}
the energy-\/weighted stimulated recombination estimator see equation 3.\+68 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1240 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_accd23482f2a991d91cb8dedaef4560ed_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_accd23482f2a991d91cb8dedaef4560ed_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8842598a01e45263815fd1e6d67ca8d6}\label{templates_8h_a8842598a01e45263815fd1e6d67ca8d6}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+atomic\+\_\+data@{get\+\_\+atomic\+\_\+data}}
\index{get\+\_\+atomic\+\_\+data@{get\+\_\+atomic\+\_\+data}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+atomic\+\_\+data()}{get\_atomic\_data()}}
{\footnotesize\ttfamily int get\+\_\+atomic\+\_\+data (\begin{DoxyParamCaption}\item[{char}]{masterfile\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a897e0ae97c32a481075df9fc45f6e745}\label{templates_8h_a897e0ae97c32a481075df9fc45f6e745}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+bl\+\_\+and\+\_\+agn\+\_\+params@{get\+\_\+bl\+\_\+and\+\_\+agn\+\_\+params}}
\index{get\+\_\+bl\+\_\+and\+\_\+agn\+\_\+params@{get\+\_\+bl\+\_\+and\+\_\+agn\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+bl\+\_\+and\+\_\+agn\+\_\+params()}{get\_bl\_and\_agn\_params()}}
{\footnotesize\ttfamily int get\+\_\+bl\+\_\+and\+\_\+agn\+\_\+params (\begin{DoxyParamCaption}\item[{double}]{lstar }\end{DoxyParamCaption})}



sets up the boundary layer and agn power law parameters based on user input and system type 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & lstar A luminosity used to intialize the luminosity of the agn in the event that there is no disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine reads a number of parameters that have to do with defining the boundary layer or and A\+GN.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000058}{Bug}]Our long term goal is to make our inputs for radiation sources more generic, but there is still more work to do on this routine. The problems are really to first define what we want. Implementation should be straighforwad if we can figure out what we want. A first step might be to break this into two routines, one for a BL and one for an A\+GN. Note that the A\+GN also is used for a BH binary. This routine was clipped out of python at one pooint so it is not surprising it does not make logical sense to have grouped these itimes together\end{DoxyRefDesc}


Definition at line 145 of file setup\+\_\+star\+\_\+bh.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a897e0ae97c32a481075df9fc45f6e745_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8c496a3a0937fb3646cbe552d20e7720}\label{templates_8h_a8c496a3a0937fb3646cbe552d20e7720}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+corona\+\_\+params@{get\+\_\+corona\+\_\+params}}
\index{get\+\_\+corona\+\_\+params@{get\+\_\+corona\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+corona\+\_\+params()}{get\_corona\_params()}}
{\footnotesize\ttfamily int get\+\_\+corona\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



gets input data which is necessary to describe a corona above the surface of the disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number for the corona \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine initializes variables that are needed to define a corona (to values that are appropriate for a WD system) and then queries the .pf or the user for the same variables, which are then stored in one of the Domain elements

The corona is assumed to exist between rmin and rmax, and between 0 and zmax. Within this region it has a density specified by the density at the base and an exponential scale height.

Azimuthally the velocity will be set to the velocity of the disk, but one can give it a outward velocity which is specifed as a fraction of the azimuthal velocity

\paragraph*{Notes}

The parameters obtained here are only used in the routines in \hyperlink{corona_8c}{corona.\+c} Initially, we define it as a gaussian ring with and exponetial density distribution.

The terminology here is a bit confusing because rmin and rmax as read in to the routine refer actually to the cylindrical rho, which is easy to get confused with other parameters like zdom\mbox{[}ndom\mbox{]}.rmax which really are radii for the central source. 

Definition at line 57 of file corona.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8c496a3a0937fb3646cbe552d20e7720_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{templates_8h_a8c496a3a0937fb3646cbe552d20e7720_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abcbb806bcc4d97f3c38d995b05756317}\label{templates_8h_abcbb806bcc4d97f3c38d995b05756317}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+density\+\_\+or\+\_\+frac@{get\+\_\+density\+\_\+or\+\_\+frac}}
\index{get\+\_\+density\+\_\+or\+\_\+frac@{get\+\_\+density\+\_\+or\+\_\+frac}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+density\+\_\+or\+\_\+frac()}{get\_density\_or\_frac()}}
{\footnotesize\ttfamily double get\+\_\+density\+\_\+or\+\_\+frac (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{element,  }\item[{int}]{istate,  }\item[{int}]{frac\+\_\+choice }\end{DoxyParamCaption})}



Definition at line 3441 of file py\+\_\+wind\+\_\+sub.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{templates_8h_abcbb806bcc4d97f3c38d995b05756317_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=311pt]{templates_8h_abcbb806bcc4d97f3c38d995b05756317_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abd62705b5006847a8dc70b442bf15332}\label{templates_8h_abd62705b5006847a8dc70b442bf15332}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+dilute\+\_\+estimators@{get\+\_\+dilute\+\_\+estimators}}
\index{get\+\_\+dilute\+\_\+estimators@{get\+\_\+dilute\+\_\+estimators}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+dilute\+\_\+estimators()}{get\_dilute\_estimators()}}
{\footnotesize\ttfamily int get\+\_\+dilute\+\_\+estimators (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



compute dilute matom estimators 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
get\+\_\+dilute\+\_\+estimators computes the bound free and bound bound estimators for a cell from a dilute blackbody. This is the default if macro\+\_\+pops fails to find a solution for an ion. Modifies mplasma. 

Definition at line 961 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abd62705b5006847a8dc70b442bf15332_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{templates_8h_abd62705b5006847a8dc70b442bf15332_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a611c7cc190ffb8c6494e75ec549191f3}\label{templates_8h_a611c7cc190ffb8c6494e75ec549191f3}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+disk\+\_\+params@{get\+\_\+disk\+\_\+params}}
\index{get\+\_\+disk\+\_\+params@{get\+\_\+disk\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+disk\+\_\+params()}{get\_disk\_params()}}
{\footnotesize\ttfamily double get\+\_\+disk\+\_\+params (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



get the parameters need to define a disk 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em None} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
Read the parameters, such as the type of disk, the temperature profile, that define a disk

The parameters fill variables defined in the geo data structure.

\paragraph*{Notes}

1712 -\/ Refactored into a separate routine by ksl 

Definition at line 65 of file setup\+\_\+disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=343pt]{templates_8h_a611c7cc190ffb8c6494e75ec549191f3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af355cb7acb867d8ada078fe8ced97f2f}\label{templates_8h_af355cb7acb867d8ada078fe8ced97f2f}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+domain\+\_\+params@{get\+\_\+domain\+\_\+params}}
\index{get\+\_\+domain\+\_\+params@{get\+\_\+domain\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+domain\+\_\+params()}{get\_domain\_params()}}
{\footnotesize\ttfamily int get\+\_\+domain\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



Get inputs that describe a particular component of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The number (begining with 0) of this particular domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Sets up the one domain, which includes defining wind type, e.\+g whether it is a shell, or a biconical flow, or an imported model, as well as the type of coordinate system and its simensions.

If the wind is to be imported from a file, it is imported in this routine.

\paragraph*{Notes}

1801 -\/ Refactored into this file in 1801. Updates in the fall of 17 were made to allow for importing models. Note that cyl\+\_\+var coordinates are not currently working 

Definition at line 47 of file setup\+\_\+domains.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af355cb7acb867d8ada078fe8ced97f2f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4ba7a23129d489314ba51c999d18e321}\label{templates_8h_a4ba7a23129d489314ba51c999d18e321}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+extra\+\_\+diagnostics@{get\+\_\+extra\+\_\+diagnostics}}
\index{get\+\_\+extra\+\_\+diagnostics@{get\+\_\+extra\+\_\+diagnostics}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+extra\+\_\+diagnostics()}{get\_extra\_diagnostics()}}
{\footnotesize\ttfamily int get\+\_\+extra\+\_\+diagnostics (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Allows the user to specify what extra diagnositcs to write out. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Based on the inputs, the rougines modifies variables in the modes structure to turn on whichever modes are asked for.

The routine is just for setting up the options. The routine is called only if one has requested extra diagnostics.

\paragraph*{Notes}

see \#111 and \#120

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000018}{Bug}]This routine should be combined with get\+\_\+standard\+\_\+care\+\_\+factors\end{DoxyRefDesc}


Definition at line 158 of file diag.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4ba7a23129d489314ba51c999d18e321_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{templates_8h_a4ba7a23129d489314ba51c999d18e321_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa7c3eb3f3d0a8eecbbdee02b8988f17d}\label{templates_8h_aa7c3eb3f3d0a8eecbbdee02b8988f17d}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+fb@{get\+\_\+fb}}
\index{get\+\_\+fb@{get\+\_\+fb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+fb()}{get\_fb()}}
{\footnotesize\ttfamily double get\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{int}]{nion,  }\item[{int}]{narray,  }\item[{int}]{fb\+\_\+choice,  }\item[{int}]{mode }\end{DoxyParamCaption})}



Interpolate from a set of stored emissivities. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperure of interest \\
\hline
\mbox{\tt in}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in}  & {\em int} & narray The number of the array calculated for a particular frequency range \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice A switch used only in the case of normal recombination \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch which indicates whether one is interested in normal (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or innershell (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) recombination \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The program generally returns an emissivity or a cooling rate, and the choices are determined by the combination of fb\+\_\+choice and mode
\end{DoxyReturn}
if the mode is set for normal recombiantion, then the possiblities are\+:
\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\end{DoxyItemize}

if the mode is set for inner shell then the cooling rate (effectively F\+B\+\_\+\+F\+U\+LL) is returned.

In an effort to save time, information needed to calculate free-\/bound emissivities and cooling are calculated when a freqency interval is defined, and this routine is used to retrieve these values. The fb structures are populated by init\+\_\+freebound

\paragraph*{Notes}

Definition at line 1184 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa7c3eb3f3d0a8eecbbdee02b8988f17d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa7c3eb3f3d0a8eecbbdee02b8988f17d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af9a598f20c5f4d5b9f01585d7cf8eb4c}\label{templates_8h_af9a598f20c5f4d5b9f01585d7cf8eb4c}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+gamma@{get\+\_\+gamma}}
\index{get\+\_\+gamma@{get\+\_\+gamma}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+gamma()}{get\_gamma()}}
{\footnotesize\ttfamily double get\+\_\+gamma (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the dilute photoionization rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
gamma\+\_\+value
\end{DoxyReturn}
the dilute photoionization rate estimator, for a black body radiation field with known dilution factor and temperature see equation 3.\+64 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1007 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{templates_8h_af9a598f20c5f4d5b9f01585d7cf8eb4c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af9a598f20c5f4d5b9f01585d7cf8eb4c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1e05a878575b566deae630d01be4c75c}\label{templates_8h_a1e05a878575b566deae630d01be4c75c}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+gamma\+\_\+e@{get\+\_\+gamma\+\_\+e}}
\index{get\+\_\+gamma\+\_\+e@{get\+\_\+gamma\+\_\+e}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+gamma\+\_\+e()}{get\_gamma\_e()}}
{\footnotesize\ttfamily double get\+\_\+gamma\+\_\+e (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



the dilute energy weighted photoionization rate estimator 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ cont\+\_\+ptr \\
\hline
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
gamma\+\_\+e\+\_\+value
\end{DoxyReturn}
the energy-\/weighted photoionization rate estimator, for a black body radiation field with known dilution factor and temperature equation 3.\+66 of Matthews Phd thesis, see also Lucy (2003). 

Definition at line 1080 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1e05a878575b566deae630d01be4c75c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1e05a878575b566deae630d01be4c75c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8740705e13bea4c5db604c9c561232b6}\label{templates_8h_a8740705e13bea4c5db604c9c561232b6}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+homologous\+\_\+params@{get\+\_\+homologous\+\_\+params}}
\index{get\+\_\+homologous\+\_\+params@{get\+\_\+homologous\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+homologous\+\_\+params()}{get\_homologous\_params()}}
{\footnotesize\ttfamily int get\+\_\+homologous\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



gets input data which is necessary for a homologous expansion law v(r)= r / t0 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 56 of file homologous.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8740705e13bea4c5db604c9c561232b6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a839f7eaa23de10001c2ec293dc890563}\label{templates_8h_a839f7eaa23de10001c2ec293dc890563}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+hydro@{get\+\_\+hydro}}
\index{get\+\_\+hydro@{get\+\_\+hydro}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+hydro()}{get\_hydro()}}
{\footnotesize\ttfamily int get\+\_\+hydro (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



Reads in and decodes a hydro-\/dynamic model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The number of the domain which will be populated by the geometry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
This deals with importing the hydro-\/dynamic snapshot It asks the user the filename and the maximum theta to be used It also works out the maximum theta bin to be used, and interpolates if this doesnt quite line up.

\paragraph*{Notes}

12/99 -\/ Written by K\+SL 

Definition at line 218 of file hydro\+\_\+import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a839f7eaa23de10001c2ec293dc890563_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=265pt]{templates_8h_a839f7eaa23de10001c2ec293dc890563_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a023a9f5be6230d4c52840ddde5445b5a}\label{templates_8h_a023a9f5be6230d4c52840ddde5445b5a}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+hydro\+\_\+wind\+\_\+params@{get\+\_\+hydro\+\_\+wind\+\_\+params}}
\index{get\+\_\+hydro\+\_\+wind\+\_\+params@{get\+\_\+hydro\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+hydro\+\_\+wind\+\_\+params()}{get\_hydro\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+hydro\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



Sets up geometry ready to accept a hydro-\/dynamic model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The number of the domain which will be populated by the geometry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
Sets up the geometry -\/ max and min -\/ for the hydro-\/dynamic snapshot. It uses limits read in from the file to fill in things more usually read in from the command line.

\paragraph*{Notes}

12/99 -\/ Written by K\+SL 

Definition at line 152 of file hydro\+\_\+import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a023a9f5be6230d4c52840ddde5445b5a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1f19ab5f3007262704d05138c63fce48}\label{templates_8h_a1f19ab5f3007262704d05138c63fce48}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+import\+\_\+wind\+\_\+params@{get\+\_\+import\+\_\+wind\+\_\+params}}
\index{get\+\_\+import\+\_\+wind\+\_\+params@{get\+\_\+import\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+import\+\_\+wind\+\_\+params()}{get\_import\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+import\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



get parameters associated with an imported wind model 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain associated with an imported model \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
At present this routine is simply a place holder and simply returns to the call in setup\+\_\+domains.

\paragraph*{Notes}

Definition at line 211 of file import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{templates_8h_a1f19ab5f3007262704d05138c63fce48_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a05c44905d0f679cdd90dd52f13074609}\label{templates_8h_a05c44905d0f679cdd90dd52f13074609}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+ion@{get\+\_\+ion}}
\index{get\+\_\+ion@{get\+\_\+ion}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+ion()}{get\_ion()}}
{\footnotesize\ttfamily double$\ast$ get\+\_\+ion (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{int}]{element,  }\item[{int}]{istate,  }\item[{int}]{iswitch }\end{DoxyParamCaption})}



Get get density, etc for one particular ion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em int} & ndom the domain number \\
\hline
\mbox{\tt in,out}  & {\em int} & element the element number \\
\hline
\mbox{\tt in,out}  & {\em int} & istate the ionization state \\
\hline
\mbox{\tt in,out}  & {\em int} & iswitch a switch controlling exactly what is returned for that ion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns an array with values associated with what is requested This will return an array with all zeros if there is no such ion
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 867 of file windsave2table\+\_\+sub.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a05c44905d0f679cdd90dd52f13074609_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a05c44905d0f679cdd90dd52f13074609_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5377ca5e35d35e11d4332da6bb2f2009}\label{templates_8h_a5377ca5e35d35e11d4332da6bb2f2009}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+ion\+\_\+density@{get\+\_\+ion\+\_\+density}}
\index{get\+\_\+ion\+\_\+density@{get\+\_\+ion\+\_\+density}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+ion\+\_\+density()}{get\_ion\_density()}}
{\footnotesize\ttfamily double get\+\_\+ion\+\_\+density (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{int}]{nion }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_abc35742eeeb50cc9cda997c3de567f20}\label{templates_8h_abc35742eeeb50cc9cda997c3de567f20}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+knigge\+\_\+wind\+\_\+params@{get\+\_\+knigge\+\_\+wind\+\_\+params}}
\index{get\+\_\+knigge\+\_\+wind\+\_\+params@{get\+\_\+knigge\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+knigge\+\_\+wind\+\_\+params()}{get\_knigge\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+knigge\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



get the input data that is necessary to define K\+W\+D-\/type model description of the wind 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alwasys returns 0
\end{DoxyReturn}
\paragraph*{Notes}

The routine first obtains wind\+\_\+mdot and then the various parameters required for the K\+WD model. It then integrates the mass loss rate per unit area over the region occupied by the wind to normalize the mass loss rate.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000034}{Bug}]There may weel be errors associated with a vertically extended disk that need tobe addressed\end{DoxyRefDesc}


Definition at line 59 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abc35742eeeb50cc9cda997c3de567f20_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab250057e4381b5be827dcf4cd35fb3fe}\label{templates_8h_ab250057e4381b5be827dcf4cd35fb3fe}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+kpkt\+\_\+f@{get\+\_\+kpkt\+\_\+f}}
\index{get\+\_\+kpkt\+\_\+f@{get\+\_\+kpkt\+\_\+f}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+kpkt\+\_\+f()}{get\_kpkt\_f()}}
{\footnotesize\ttfamily double get\+\_\+kpkt\+\_\+f (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



returns the specific luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the process k-\/packet -\/$>$ r-\/packet in the required wavelength range. 

\begin{DoxyReturn}{Returns}
double lum The energy radiated by the process k-\/packet -\/$>$ r-\/packet in the wind in the wavelength range required for the specrum calculation.
\end{DoxyReturn}
\paragraph*{Notes}

Literally just loops through the kpkt\+\_\+emiss entries in plasmamain. 

Definition at line 38 of file photo\+\_\+gen\+\_\+matom.\+c.

\mbox{\Hypertarget{templates_8h_aabd8388700d83b12bace5f01320b7c06}\label{templates_8h_aabd8388700d83b12bace5f01320b7c06}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+line\+\_\+transfer\+\_\+mode@{get\+\_\+line\+\_\+transfer\+\_\+mode}}
\index{get\+\_\+line\+\_\+transfer\+\_\+mode@{get\+\_\+line\+\_\+transfer\+\_\+mode}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+line\+\_\+transfer\+\_\+mode()}{get\_line\_transfer\_mode()}}
{\footnotesize\ttfamily int get\+\_\+line\+\_\+transfer\+\_\+mode (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Get the line transfer mode for the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em None} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
This rontinues simply gets the line tranfer mode for all componensts of the wind. After logging this information the routine also reads in the atomic data.

\paragraph*{Notes}

1801 -\/ Refactored into this file in 1801. It is not obvioous this is the best place for this routine since it refers to all components of the wind. 

Definition at line 312 of file setup\+\_\+domains.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aabd8388700d83b12bace5f01320b7c06_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a88c68bc653bd48b9e892d971a3061e08}\label{templates_8h_a88c68bc653bd48b9e892d971a3061e08}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+los\+\_\+dvds@{get\+\_\+los\+\_\+dvds}}
\index{get\+\_\+los\+\_\+dvds@{get\+\_\+los\+\_\+dvds}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+los\+\_\+dvds()}{get\_los\_dvds()}}
{\footnotesize\ttfamily int get\+\_\+los\+\_\+dvds (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ac8797bce5a5f3411f4162dff928b7920}\label{templates_8h_ac8797bce5a5f3411f4162dff928b7920}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+matom\+\_\+f@{get\+\_\+matom\+\_\+f}}
\index{get\+\_\+matom\+\_\+f@{get\+\_\+matom\+\_\+f}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+matom\+\_\+f()}{get\_matom\_f()}}
{\footnotesize\ttfamily double get\+\_\+matom\+\_\+f (\begin{DoxyParamCaption}\item[{int}]{mode }\end{DoxyParamCaption})}



returns the specific band-\/limited luminosity in macro-\/atoms 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & mode vvariable which controls whether or not we need to compute the emissivities (C\+A\+L\+C\+U\+L\+A\+T\+E\+\_\+\+M\+A\+T\+O\+M\+\_\+\+E\+M\+I\+S\+S\+I\+V\+I\+T\+I\+ES) or use stored ones because we are restarting a spectral cycle (U\+S\+E\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+M\+A\+T\+O\+M\+\_\+\+E\+M\+I\+S\+S\+I\+V\+I\+T\+I\+ES) see \#define statements in \hyperlink{python_8h}{python.\+h} and code in \hyperlink{foo_8h_a9a0acf2d461c665dc0302defa95ded65}{xdefine\+\_\+phot()}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
double lum The energy radiated by the deactivation of macro atoms in the wind in the wavelength range required for the specrum calculation.
\end{DoxyReturn}
this routine calculates the luminosity in the band needed for the computation of the spectrum. It gets the total energy radiated by the deactivation of macro atoms in the required wavelength range. This can be a slow process, as there is no priori way (at least with our method) to work out where a photon is going to come out when a macro-\/atom is generated

\paragraph*{Notes}

Consult Matthews thesis. 

Definition at line 80 of file photo\+\_\+gen\+\_\+matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac8797bce5a5f3411f4162dff928b7920_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4017af15d8bd072936049dafc4250a1b}\label{templates_8h_a4017af15d8bd072936049dafc4250a1b}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+meta\+\_\+params@{get\+\_\+meta\+\_\+params}}
\index{get\+\_\+meta\+\_\+params@{get\+\_\+meta\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+meta\+\_\+params()}{get\_meta\_params()}}
{\footnotesize\ttfamily int get\+\_\+meta\+\_\+params (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Gets parameters from input file for reverb and visualisation settings. 

\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Reads in reverberation mapping and basic visualisation for reverberation mapping settings from file. These settings are fully-\/documented in the Sphinx docs, and briefly here\+:

\paragraph*{reverb.\+type}

Sets whether or not to do reverb mapping, and if so how to assign photon starting paths for non-\/\+CO photons. 0. None
\begin{DoxyEnumerate}
\item \textquotesingle{}Photon\textquotesingle{}, starting paths set by distance to the CO.
\item \textquotesingle{}Wind\textquotesingle{}, photons generated in the wind assigned starting paths from the distribution of paths heating the wind cell they were spawned in.
\item \textquotesingle{}Matom\textquotesingle{}, as wind but photons generated in a line assigned starting paths from the distribution of paths of photons that de-\/excited into that line. For lines in matom\+\_\+lines.
\end{DoxyEnumerate}

\paragraph*{reverb.\+matom\+\_\+lines, reverb.\+matom\+\_\+line}

The number of macro-\/atom lines to track (above). Internal line number! T\+O\+DO\+: Convert to elem\+:ion\+:lvlu\+:lvll format.

\paragraph*{reverb.\+disk\+\_\+type}

How the starting paths of photons from the disk are assigned. 0. Set by distance to the CO.
\begin{DoxyEnumerate}
\item Set to 0. Not recommended.
\item Ignored. Disk photons do not contribute to \textquotesingle{}wind\textquotesingle{} and \textquotesingle{}matom\textquotesingle{} distributions.
\end{DoxyEnumerate}

\paragraph*{reverb.\+path\+\_\+bins}

How many bins to store wind \& matom path distributions in. Typically 1000.

\paragraph*{reverb.\+visualisation}

0. No visualisation
\begin{DoxyEnumerate}
\item Output a .vtk file showing the mean paths in each cell, for visualising in something like Vis\+It or Paraview.
\item Output a series of files dumping the path distributions for cells set by reverb.\+dump\+\_\+cells.
\item Output both.
\end{DoxyEnumerate}

\paragraph*{reverb.\+dump\+\_\+cells, reverb.\+dump\+\_\+cell\+\_\+x, reverb.\+dump\+\_\+cell\+\_\+z}

The number of cells to dump the path distributions for, and the x/z coordinate pairs for each cell.

\paragraph*{reverb.\+filter\+\_\+lines, reverb.\+filter\+\_\+line}

Whether or not to filter the output list of photons. If -\/1, excludes all continuum photons. If $>$0, provide that many line numbers.

\paragraph*{Notes}

6/5/18 -\/ Documented by S\+WM 

Definition at line 80 of file setup\+\_\+reverb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4017af15d8bd072936049dafc4250a1b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a573805cfa8fb135c23fc2f9e97dcf687}\label{templates_8h_a573805cfa8fb135c23fc2f9e97dcf687}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+ne@{get\+\_\+ne}}
\index{get\+\_\+ne@{get\+\_\+ne}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+ne()}{get\_ne()}}
{\footnotesize\ttfamily double get\+\_\+ne (\begin{DoxyParamCaption}\item[{double}]{density\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aac492018c209163236776675dbf5c7e7}\label{templates_8h_aac492018c209163236776675dbf5c7e7}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+nrecomb@{get\+\_\+nrecomb}}
\index{get\+\_\+nrecomb@{get\+\_\+nrecomb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+nrecomb()}{get\_nrecomb()}}
{\footnotesize\ttfamily double get\+\_\+nrecomb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{int}]{nion,  }\item[{int}]{mode }\end{DoxyParamCaption})}



Return the recombination coefficient. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & t The temperature \\
\hline
\mbox{\tt in,out}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in,out}  & {\em int} & mode A switch to choose normal (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or inner shell (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) recombiantion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The recombination coefficient
\end{DoxyReturn}
Uses data from Badnell or another source to get a recombination rate

\paragraph*{Notes}

Definition at line 1133 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aac492018c209163236776675dbf5c7e7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aac492018c209163236776675dbf5c7e7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a245151df4c45767770f00123a65f1cb1}\label{templates_8h_a245151df4c45767770f00123a65f1cb1}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+one@{get\+\_\+one}}
\index{get\+\_\+one@{get\+\_\+one}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+one()}{get\_one()}}
{\footnotesize\ttfamily double$\ast$ get\+\_\+one (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{char}]{variable\+\_\+name\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aea33eee38cf4a6c25978443404ddaf2c}\label{templates_8h_aea33eee38cf4a6c25978443404ddaf2c}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+rand\+\_\+brem@{get\+\_\+rand\+\_\+brem}}
\index{get\+\_\+rand\+\_\+brem@{get\+\_\+rand\+\_\+brem}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+rand\+\_\+brem()}{get\_rand\_brem()}}
{\footnotesize\ttfamily double get\+\_\+rand\+\_\+brem (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



Obtain a random frequency photon from a bremstrahlung spectrum. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freqmin Minimum frequency to be generated \\
\hline
\mbox{\tt in}  & {\em double} & freqmax Maximum frequency to be generated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A random photon frequency between freqmin andf freqmax
\end{DoxyReturn}
This subroutine is used solely to generate random photon frequencies from a bremstrahlung type spectrum. The temperature of the spectrum (defining the high frequency exponential dropoff exp(-\/hnu/kT)) and the spectrasl index of the low frequency part of the spectrum are defined in the geo structure. This code is heavily based upon planck and shares a great deal of code with it. There is a clear possibility of generalising the code to make some kind of generalised power law plus exponential dropoff spectrum.

\paragraph*{Notes}

10/15 -\/ Written by N\+SH 

Definition at line 153 of file brem.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aea33eee38cf4a6c25978443404ddaf2c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aea33eee38cf4a6c25978443404ddaf2c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af2d9c9e4094a425824f269ef22163048}\label{templates_8h_af2d9c9e4094a425824f269ef22163048}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+rand\+\_\+exp@{get\+\_\+rand\+\_\+exp}}
\index{get\+\_\+rand\+\_\+exp@{get\+\_\+rand\+\_\+exp}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+rand\+\_\+exp()}{get\_rand\_exp()}}
{\footnotesize\ttfamily double get\+\_\+rand\+\_\+exp (\begin{DoxyParamCaption}\item[{double}]{alpha\+\_\+min,  }\item[{double}]{alpha\+\_\+max }\end{DoxyParamCaption})}



obtain a random number between alpha\+\_\+min and alpha\+\_\+max from an distribution of the form e$\ast$$\ast$-\/alpha 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha\+\_\+min The lower limit for the random number \\
\hline
\mbox{\tt in}  & {\em double} & alpha\+\_\+max The upper limit for the random number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A double precision random number
\end{DoxyReturn}
\paragraph*{Notes}

The cdf for an exponential distribution can be easily shown to be given by solving this equation for alpha

r$\ast$(exp(-\/alpha\+\_\+min)-\/exp(-\/alpha\+\_\+max))=(exp(-\/alpha\+\_\+min)-\/exp(alpha))

but you can recast this and solve for delta\+\_\+alpha

exp(-\/delta\+\_\+alpha)=(1-\/R)+\+R$\ast$exp(-\/(alpha\+\_\+max-\/alpha\+\_\+min))

This has the advantage that it depends only on the difference of alpha\+\_\+max and alpha\+\_\+min and not their actual values, and as long as the exp of a very large number turns out to be zero and not not a number, it shuld not generate N\+A\+Ns 

Definition at line 327 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af2d9c9e4094a425824f269ef22163048_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af2d9c9e4094a425824f269ef22163048_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6bae7f74815dfcf783a7dafade8faeca}\label{templates_8h_a6bae7f74815dfcf783a7dafade8faeca}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+rand\+\_\+pow@{get\+\_\+rand\+\_\+pow}}
\index{get\+\_\+rand\+\_\+pow@{get\+\_\+rand\+\_\+pow}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+rand\+\_\+pow()}{get\_rand\_pow()}}
{\footnotesize\ttfamily double get\+\_\+rand\+\_\+pow (\begin{DoxyParamCaption}\item[{double}]{x1,  }\item[{double}]{x2,  }\item[{double}]{alpha }\end{DoxyParamCaption})}



obtains a random number between x1 and x2 for a power law densiity distribution with index alpha 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & x1 the minimum allowed value to return \\
\hline
\mbox{\tt in,out}  & {\em double} & x2 the maximum allowed value to return \\
\hline
\mbox{\tt in,out}  & {\em double} & alpha the index of the power law \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A single value taken from a power law distribution
\end{DoxyReturn}
\paragraph*{Notes}

It is straight fowrward to integrate a power law in closed form and given this it one can easily find the value of the upper limit to the definite integral that is a given fraction of the total interval

The case with alpha==1 is a special case, but this is also easy to integrate. 

Definition at line 267 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{templates_8h_a6bae7f74815dfcf783a7dafade8faeca_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6bae7f74815dfcf783a7dafade8faeca_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a55dba11eab85fa51b5bbf621a3c66b57}\label{templates_8h_a55dba11eab85fa51b5bbf621a3c66b57}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+random\+\_\+location@{get\+\_\+random\+\_\+location}}
\index{get\+\_\+random\+\_\+location@{get\+\_\+random\+\_\+location}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+random\+\_\+location()}{get\_random\_location()}}
{\footnotesize\ttfamily int get\+\_\+random\+\_\+location (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ae964ba7da192ec86c6765f75ab1bcd76}\label{templates_8h_ae964ba7da192ec86c6765f75ab1bcd76}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+shell\+\_\+wind\+\_\+params@{get\+\_\+shell\+\_\+wind\+\_\+params}}
\index{get\+\_\+shell\+\_\+wind\+\_\+params@{get\+\_\+shell\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+shell\+\_\+wind\+\_\+params()}{get\_shell\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+shell\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



Get the inputs needed to specigy the shell\+\_\+wind modelen radius. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain for the shell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alwyas returns 0
\end{DoxyReturn}
This routine gets the inputs needed for the shell\+\_\+wind model and translates them into those needed for the equvalent stellar wind model. Several arrays specific to the shell\+\_\+wind model are also intialized.

\paragraph*{Notes}

Definition at line 54 of file shell\+\_\+wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ae964ba7da192ec86c6765f75ab1bcd76_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab358cbada062a9acccdf184b57630305}\label{templates_8h_ab358cbada062a9acccdf184b57630305}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+spectype@{get\+\_\+spectype}}
\index{get\+\_\+spectype@{get\+\_\+spectype}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+spectype()}{get\_spectype()}}
{\footnotesize\ttfamily int get\+\_\+spectype (\begin{DoxyParamCaption}\item[{int}]{yesno,  }\item[{char $\ast$}]{question,  }\item[{int $\ast$}]{spectype }\end{DoxyParamCaption})}



Generalized routine to get the spectrum type for a radiation source and if necessary read a set of precalculated spectra. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & yesno An integer used to decide whether to ask for a spectrum type \\
\hline
\mbox{\tt in,out}  & {\em char} & $\ast$ question The query for a spectrum type for this component \\
\hline
\mbox{\tt in,out}  & {\em int} & $\ast$ spectype The type of spectrum to assign \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the spectype, a number that says what type of spectrum (bb, power law, etc) to generate for this source
\end{DoxyReturn}
If yesno is non-\/zero, the user will be asked for the type of spectrum for a radation source. If yesno is 0, we presume that this radiation souce (a star a disk or the wind itself) is not to radiate in the calculation, and the spectrum type is set to S\+P\+E\+C\+T\+Y\+P\+E\+\_\+\+N\+O\+NE.

If one wants to geneate spectra from a seriels of models (such as synthetic spectra caluclated for stars), this routine calls routines to read the models.

\paragraph*{Notes}

This routine is awkwardly constructed. For reasons that are probably historical the routine converts the internally stored values to different values in order to ask what type of spectrum the user wants, and then translates these back to the internal value. 

Definition at line 187 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab358cbada062a9acccdf184b57630305_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3c32de99bd46282a95c0de7c8f7e890f}\label{templates_8h_a3c32de99bd46282a95c0de7c8f7e890f}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+standard\+\_\+care\+\_\+factors@{get\+\_\+standard\+\_\+care\+\_\+factors}}
\index{get\+\_\+standard\+\_\+care\+\_\+factors@{get\+\_\+standard\+\_\+care\+\_\+factors}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+standard\+\_\+care\+\_\+factors()}{get\_standard\_care\_factors()}}
{\footnotesize\ttfamily int get\+\_\+standard\+\_\+care\+\_\+factors (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



get inputs that provides more control over how the program is run 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
In advanced mode, this routine provides ways to change several somewhat unrelated parameters in the routines

The parameters are
\begin{DoxyItemize}
\item the fractional distance a photons may travel
\item the lowest ion allowed to contribute to photabosrption
\item whether photoabsorption is considered in the final spectrum
\end{DoxyItemize}

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000017}{Bug}]It is not obvious that much recent thought has been given to the choices that are here. The fractional distance that a photon travel is intended to make sure the velocity along the line of sight can be approximated linearly. If a photon travels too far in an azimuthal direction the sense of the velocity can change and this prevensts this\end{DoxyRefDesc}


The lowest ion density contributing to photoionization is used to determine what ions one has to calculate the photoionzation xsection for. The lower this density; the more that have to be calculated, and as a result the slower the program.

Keeping photoionizaion during final spectrum allows one to check the contribution of photoabsorption. 

Definition at line 110 of file diag.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{templates_8h_a3c32de99bd46282a95c0de7c8f7e890f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=255pt]{templates_8h_a3c32de99bd46282a95c0de7c8f7e890f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5e18aeda5d11190333c93b952b562b04}\label{templates_8h_a5e18aeda5d11190333c93b952b562b04}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+stellar\+\_\+params@{get\+\_\+stellar\+\_\+params}}
\index{get\+\_\+stellar\+\_\+params@{get\+\_\+stellar\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+stellar\+\_\+params()}{get\_stellar\_params()}}
{\footnotesize\ttfamily double get\+\_\+stellar\+\_\+params (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



sets rstar, mstar, tstar as well as secondary parameters based on user inputs 

\begin{DoxyReturn}{Returns}
The system returns the luminosity of the central object using the temperature and radius
\end{DoxyReturn}
This obtains the inputs for the Central Object, whether we are dealing with an ordianry star of an A\+GN) If the system is a binary system, the parameters of the secondary are also obtained.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000057}{Bug}]This routine is not completely self consistent, in the sense that for an A\+GN we cannot estimate a luminosity. This reflects the fact that we have not completely setlled on how to homogenize inputs for diffent system types. It\textquotesingle{}s not clear that we need to retun anything.\end{DoxyRefDesc}


Definition at line 44 of file setup\+\_\+star\+\_\+bh.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{templates_8h_a5e18aeda5d11190333c93b952b562b04_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a40edef16d314acc2a892cd8b8a5f0eec}\label{templates_8h_a40edef16d314acc2a892cd8b8a5f0eec}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+stellar\+\_\+wind\+\_\+params@{get\+\_\+stellar\+\_\+wind\+\_\+params}}
\index{get\+\_\+stellar\+\_\+wind\+\_\+params@{get\+\_\+stellar\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+stellar\+\_\+wind\+\_\+params()}{get\_stellar\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+stellar\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



gets input data which is necessary for a Castor and Larmors\textquotesingle{} (1979) description of an O star wind, 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domaain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns zero
\end{DoxyReturn}
\paragraph*{Notes}

Although it seems natural to assume that the wind starts at the photosphere, this is not required (and in Mauche and Raymond\textquotesingle{}s spherical model for a CV wind they set the inner radius of the wind at several WD radii. That possibility is allowed for

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000060}{Bug}]There was an old note here indicating that the ksl was unsure(04j) whether as if the code as written really implements the possibility of a wind that starts at a radius larger than the star. This should be checked\end{DoxyRefDesc}


Definition at line 46 of file stellar\+\_\+wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a40edef16d314acc2a892cd8b8a5f0eec_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_acc6d4ccf49e7781a11424e723e25f812}\label{templates_8h_acc6d4ccf49e7781a11424e723e25f812}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+sv\+\_\+wind\+\_\+params@{get\+\_\+sv\+\_\+wind\+\_\+params}}
\index{get\+\_\+sv\+\_\+wind\+\_\+params@{get\+\_\+sv\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+sv\+\_\+wind\+\_\+params()}{get\_sv\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+sv\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



gets input data which is necessary for a Shlossman \& Vitello description of the wind 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Gets mdot for this wind component, initialize the parameters needed to define a SV wind, and then request those parameters as inputs. Calculate the normalization factor needed to convert the global mass loss rate to the mass loss rate per unite area.

\paragraph*{Notes}

Definition at line 40 of file sv.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_acc6d4ccf49e7781a11424e723e25f812_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa3b24089fadbcdf92560f31730390556}\label{templates_8h_aa3b24089fadbcdf92560f31730390556}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+time@{get\+\_\+time}}
\index{get\+\_\+time@{get\+\_\+time}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+time()}{get\_time()}}
{\footnotesize\ttfamily int get\+\_\+time (\begin{DoxyParamCaption}\item[{char}]{curtime\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a156f40c5dd5b2c76f1002d05f712b0a0}\label{templates_8h_a156f40c5dd5b2c76f1002d05f712b0a0}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+wind\+\_\+params@{get\+\_\+wind\+\_\+params}}
\index{get\+\_\+wind\+\_\+params@{get\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+wind\+\_\+params()}{get\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



Get detailed particular component of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The number (begining with 0) of this particular domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Continues the setup of a single domain begun in get\+\_\+domain\+\_\+params.

Much of this routine is a steering routine that calls other subroutines depending on the type of wind, e.\+g sv, for this particular wind domain.

\paragraph*{Notes}

1801 -\/ Refactored into this file in 1801. 

Definition at line 179 of file setup\+\_\+domains.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a156f40c5dd5b2c76f1002d05f712b0a0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aae3509585172ef791e8112e146a86f46}\label{templates_8h_aae3509585172ef791e8112e146a86f46}} 
\index{templates.\+h@{templates.\+h}!get\+\_\+yso\+\_\+wind\+\_\+params@{get\+\_\+yso\+\_\+wind\+\_\+params}}
\index{get\+\_\+yso\+\_\+wind\+\_\+params@{get\+\_\+yso\+\_\+wind\+\_\+params}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+yso\+\_\+wind\+\_\+params()}{get\_yso\_wind\_params()}}
{\footnotesize\ttfamily int get\+\_\+yso\+\_\+wind\+\_\+params (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



gets input data that are necessary for a Y\+SO comprising a region that resembles a K\+WD wind and a region outside this that contins a speherical wind 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Basically this routine just reads the inputs from the two separate wind models, since this is a combination of the two.

\paragraph*{Notes}

The model has a spherical wind on the interior. The windcones are set to include the region from the polar axis to the outside edge of the wind. (Note that when filling out the grid regions outside the wind may have non-\/zero values of quantities, such as density. This allows for interpolation to occur. But there will not be (should not be) any scattering or whatever in this region since that wind cones define the regions where photons are scattered. 

Definition at line 53 of file yso.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aae3509585172ef791e8112e146a86f46_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aac9129f52275f2d4c2469699cbcf3833}\label{templates_8h_aac9129f52275f2d4c2469699cbcf3833}} 
\index{templates.\+h@{templates.\+h}!golden@{golden}}
\index{golden@{golden}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{golden()}{golden()}}
{\footnotesize\ttfamily double golden (\begin{DoxyParamCaption}\item[{double}]{ax,  }\item[{double}]{bx,  }\item[{double}]{cx,  }\item[{double($\ast$)(double)}]{f,  }\item[{double}]{tol,  }\item[{double $\ast$}]{xmin }\end{DoxyParamCaption})}



A routine that mimimizes a function f. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ax} & \\
\hline
\mbox{\tt in}  & {\em bx} & \\
\hline
\mbox{\tt in}  & {\em cx} & \\
\hline
\mbox{\tt in}  & {\em f} & the function to minimize \\
\hline
\mbox{\tt in}  & {\em tol} & A tolerance \\
\hline
\mbox{\tt out}  & {\em $\ast$} & xmin -\/ The place where the minimum occors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The minimum of the function f .
\end{DoxyReturn}
This is a Numerical Recipes routine. Fiven a fun\+Ytion f, and bracketing triplet of abscissas a,b,c, such that it is known that f(b) $<$ f(a) and f(b)$<$f(c), golden returns the minimum value of the function, and the value xmin where the minimum occurs

\paragraph*{Notes}

Definition at line 463 of file recipes.\+c.

\mbox{\Hypertarget{templates_8h_ae2eb8e9a77749d7d10fcbe76317e7031}\label{templates_8h_ae2eb8e9a77749d7d10fcbe76317e7031}} 
\index{templates.\+h@{templates.\+h}!grid\+\_\+summary@{grid\+\_\+summary}}
\index{grid\+\_\+summary@{grid\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{grid\+\_\+summary()}{grid\_summary()}}
{\footnotesize\ttfamily int grid\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}



Prints grid boundaries to file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em w} & Pointer to wind array \\
\hline
\mbox{\tt in}  & {\em rootname} & Root name of simulation \\
\hline
\mbox{\tt in}  & {\em ochoice} & Whether or not to write out \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Outputs the boundaries for the grids for each domain

\paragraph*{Notes}

6/15 -\/ Written by S\+WM 

Definition at line 3685 of file py\+\_\+wind\+\_\+sub.\+c.

\mbox{\Hypertarget{templates_8h_a942292d67abfae3c22d1bbf5ed6fbc3c}\label{templates_8h_a942292d67abfae3c22d1bbf5ed6fbc3c}} 
\index{templates.\+h@{templates.\+h}!gs\+\_\+rrate@{gs\+\_\+rrate}}
\index{gs\+\_\+rrate@{gs\+\_\+rrate}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{gs\+\_\+rrate()}{gs\_rrate()}}
{\footnotesize\ttfamily double gs\+\_\+rrate (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{double}]{T }\end{DoxyParamCaption})}



get the recombination rate to the ground state for an ion at a particular temperature 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in}  & {\em double} & T A temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the rate
\end{DoxyReturn}
This routine generates a recombination rate to the ground state for a given ion at a given temperature using data from Badnell or other sources (with similar data formats).

If these recombination rates a are not available for the given ion the Milne relation is used.

\paragraph*{Notes}

nion is the ion that is recombining to a less ionizaed state. There is thus no rate for HI or He I, etc.

The routine is used to produce recombination rate coefficients for the matrix ionization 

Definition at line 1576 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a942292d67abfae3c22d1bbf5ed6fbc3c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a56359478a45c86dc30b59f4758a9f4b8}\label{templates_8h_a56359478a45c86dc30b59f4758a9f4b8}} 
\index{templates.\+h@{templates.\+h}!heatcool\+\_\+summary@{heatcool\+\_\+summary}}
\index{heatcool\+\_\+summary@{heatcool\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{heatcool\+\_\+summary()}{heatcool\_summary()}}
{\footnotesize\ttfamily int heatcool\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a03418403841ff39e520854f4c830339f}\label{templates_8h_a03418403841ff39e520854f4c830339f}} 
\index{templates.\+h@{templates.\+h}!help@{help}}
\index{help@{help}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{help()}{help()}}
{\footnotesize\ttfamily int help (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



print out some basic help concering command line options for the program 

\begin{DoxyReturn}{Returns}
0 in all cases
\end{DoxyReturn}
This simply prints out a hardwired multi-\/line string to the command line.

\paragraph*{Notes}

An improved version of this routine would simply read and print and external file.

If one chooses to add to what is printed out then one needs to be careful concerning the ends of lines. 

Definition at line 229 of file parse.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{templates_8h_a03418403841ff39e520854f4c830339f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad4ca36cf5f0eaaa3fb044a982d922fb3}\label{templates_8h_ad4ca36cf5f0eaaa3fb044a982d922fb3}} 
\index{templates.\+h@{templates.\+h}!hit\+\_\+secondary@{hit\+\_\+secondary}}
\index{hit\+\_\+secondary@{hit\+\_\+secondary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{hit\+\_\+secondary()}{hit\_secondary()}}
{\footnotesize\ttfamily int hit\+\_\+secondary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



Find out whether a photon will hit the secondary, but don\textquotesingle{}t actually calculate the point where it hits. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p A photon, for which we have a possiton and adirection of travel \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the photon would miss the secondary, P\+\_\+\+S\+EC otherwise
\end{DoxyReturn}
The routine chacks whether a photon hits the Roche lobe of the secondary star.

\paragraph*{Notes}

The routine first checks if the photon encounters a pill\+\_\+box that surrouds the secondary. Photons that do not encounter this pill box do not hit the secondar. If the photon enters the pill box, then the routine determines whether the photon hits the roche surface of the secondary, by finding the minimum value of the Rooche potential. If this is greater than 0, then the photon has missed the secondary. If less thn zero then it has hit the secondary. 

Definition at line 263 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad4ca36cf5f0eaaa3fb044a982d922fb3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aeba6d538928fe4fdbe6d0e7a4350f9f8}\label{templates_8h_aeba6d538928fe4fdbe6d0e7a4350f9f8}} 
\index{templates.\+h@{templates.\+h}!homologous\+\_\+rho@{homologous\+\_\+rho}}
\index{homologous\+\_\+rho@{homologous\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{homologous\+\_\+rho()}{homologous\_rho()}}
{\footnotesize\ttfamily double homologous\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa79b799560c85bc3b6a750e3bc150873}\label{templates_8h_aa79b799560c85bc3b6a750e3bc150873}} 
\index{templates.\+h@{templates.\+h}!homologous\+\_\+velocity@{homologous\+\_\+velocity}}
\index{homologous\+\_\+velocity@{homologous\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{homologous\+\_\+velocity()}{homologous\_velocity()}}
{\footnotesize\ttfamily double homologous\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa8076d3b8f3be1be3451fd4a7daf9f20}\label{templates_8h_aa8076d3b8f3be1be3451fd4a7daf9f20}} 
\index{templates.\+h@{templates.\+h}!hydro\+\_\+frac@{hydro\+\_\+frac}}
\index{hydro\+\_\+frac@{hydro\+\_\+frac}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{hydro\+\_\+frac()}{hydro\_frac()}}
{\footnotesize\ttfamily int hydro\+\_\+frac (\begin{DoxyParamCaption}\item[{double}]{coord,  }\item[{double}]{coord\+\_\+array\mbox{[}$\,$\mbox{]},  }\item[{int}]{imax,  }\item[{int $\ast$}]{cell1,  }\item[{int $\ast$}]{cell2,  }\item[{double $\ast$}]{frac }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_abc5446bc183e860391d1b4a2ee2e6473}\label{templates_8h_abc5446bc183e860391d1b4a2ee2e6473}} 
\index{templates.\+h@{templates.\+h}!hydro\+\_\+interp\+\_\+value@{hydro\+\_\+interp\+\_\+value}}
\index{hydro\+\_\+interp\+\_\+value@{hydro\+\_\+interp\+\_\+value}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{hydro\+\_\+interp\+\_\+value()}{hydro\_interp\_value()}}
{\footnotesize\ttfamily double hydro\+\_\+interp\+\_\+value (\begin{DoxyParamCaption}\item[{double}]{array\mbox{[}$\,$\mbox{]},  }\item[{int}]{im,  }\item[{int}]{ii,  }\item[{int}]{jm,  }\item[{int}]{jj,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a044bda6029c9b8057f77a920a61ce525}\label{templates_8h_a044bda6029c9b8057f77a920a61ce525}} 
\index{templates.\+h@{templates.\+h}!hydro\+\_\+restart@{hydro\+\_\+restart}}
\index{hydro\+\_\+restart@{hydro\+\_\+restart}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{hydro\+\_\+restart()}{hydro\_restart()}}
{\footnotesize\ttfamily int hydro\+\_\+restart (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



Allows a previous windsave to be used in a new hydro simulation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The number of the domain which will be populated by the geometry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
hydro\+\_\+restart is a subrotine which permits a previous wind save file to be used in a hydro simulation. The density and temperature for each cell are those from the hydro simulation. The ion fractions are taken from the windsave file

\paragraph*{Notes}

02/16 -\/ N\+SH -\/ Coded and debugged. 

Definition at line 1092 of file hydro\+\_\+import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a044bda6029c9b8057f77a920a61ce525_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a96750b1c2362e87438698e24afa56a39}\label{templates_8h_a96750b1c2362e87438698e24afa56a39}} 
\index{templates.\+h@{templates.\+h}!hydro\+\_\+rho@{hydro\+\_\+rho}}
\index{hydro\+\_\+rho@{hydro\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{hydro\+\_\+rho()}{hydro\_rho()}}
{\footnotesize\ttfamily double hydro\+\_\+rho (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9bbb384b23069ca08613aa2396fcbee3}\label{templates_8h_a9bbb384b23069ca08613aa2396fcbee3}} 
\index{templates.\+h@{templates.\+h}!hydro\+\_\+temp@{hydro\+\_\+temp}}
\index{hydro\+\_\+temp@{hydro\+\_\+temp}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{hydro\+\_\+temp()}{hydro\_temp()}}
{\footnotesize\ttfamily double hydro\+\_\+temp (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a0f1ed208804bc45d2632cb33e9e73b59}\label{templates_8h_a0f1ed208804bc45d2632cb33e9e73b59}} 
\index{templates.\+h@{templates.\+h}!hydro\+\_\+velocity@{hydro\+\_\+velocity}}
\index{hydro\+\_\+velocity@{hydro\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{hydro\+\_\+velocity()}{hydro\_velocity()}}
{\footnotesize\ttfamily double hydro\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_af9113b1ccc566370cf547f2a6292a29e}\label{templates_8h_af9113b1ccc566370cf547f2a6292a29e}} 
\index{templates.\+h@{templates.\+h}!import\+\_\+1d@{import\+\_\+1d}}
\index{import\+\_\+1d@{import\+\_\+1d}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{import\+\_\+1d()}{import\_1d()}}
{\footnotesize\ttfamily int import\+\_\+1d (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{char $\ast$}]{filename }\end{DoxyParamCaption})}



Read the an arbitray wind model intended to mimic a stellar wind or shell. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} int ndom The domain number for the imported model \\
\hline
{\em \mbox{[}in} & out\mbox{]} char $\ast$ filename The file containing the model to import \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine just reads in the data and stores it in arrays

\paragraph*{Notes}

The basic data we need to read in are \begin{DoxyVerb}i r v_r rho (and optionally T)
\end{DoxyVerb}


where


\begin{DoxyItemize}
\item i is the element (increaing outwards
\item r is the radial coordiante
\item v\+\_\+r is the velocity in the radial direction
\item rho is the density in cgs unites
\end{DoxyItemize}

We assume that all of the variables are centered, that is we are not assuming that we are giving rho at the center of a cell, but that r and v\+\_\+r are at the edges of a cell. This is someghing that would presumable be easy to change 

Definition at line 74 of file import\+\_\+spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af9113b1ccc566370cf547f2a6292a29e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae1cdacb786e677fab7288bcc53dc722f}\label{templates_8h_ae1cdacb786e677fab7288bcc53dc722f}} 
\index{templates.\+h@{templates.\+h}!import\+\_\+cylindrical@{import\+\_\+cylindrical}}
\index{import\+\_\+cylindrical@{import\+\_\+cylindrical}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{import\+\_\+cylindrical()}{import\_cylindrical()}}
{\footnotesize\ttfamily int import\+\_\+cylindrical (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{char $\ast$}]{filename }\end{DoxyParamCaption})}



Read the an arbitray wind model in cylindrical coordinates. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The domain number for the imported model \\
\hline
\mbox{\tt in}  & {\em filename} & The file containing the model to import \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine just reads in the data and stores it in arrays

\paragraph*{Notes}

The basic data we need to read in are


\begin{DoxyItemize}
\item i, j, r z v\+\_\+x v\+\_\+y v\+\_\+z rho (and optionally T)
\end{DoxyItemize}

where v\+\_\+x,\+\_\+v\+\_\+y,v\+\_\+z are the velocities in the x,z plane and where


\begin{DoxyItemize}
\item i is the column number (Thus i corresponds to ndim)
\item j is the row number (and z coresponds to mdim)
\end{DoxyItemize}

We assume that all of the variables are centered, that is we are not assuming that we are giving rho at the center of a cell, but that r and v\+\_\+r are at the edges of a cell. This is someghing that would presumable be easy to change

Note that we assume that the data are being read in in the same order as printed out by windsave2table, that is that the first \char`\"{}column\char`\"{} is read in, and then the second \char`\"{}column\char`\"{}. 

Definition at line 81 of file import\+\_\+cylindrical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ae1cdacb786e677fab7288bcc53dc722f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a757c9acbab0a0377cc2757a853d168df}\label{templates_8h_a757c9acbab0a0377cc2757a853d168df}} 
\index{templates.\+h@{templates.\+h}!import\+\_\+make\+\_\+grid@{import\+\_\+make\+\_\+grid}}
\index{import\+\_\+make\+\_\+grid@{import\+\_\+make\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{import\+\_\+make\+\_\+grid()}{import\_make\_grid()}}
{\footnotesize\ttfamily int import\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Make the Python grid. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind structure \\
\hline
\mbox{\tt in}  & {\em int} & ndom The domain for the imported model \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is merely a steering routine for calling one of the coordinate-\/system specific routines for creating a grid from one of the imported models

\paragraph*{Notes}

The fact that w is called by this routine is for constency. 

Definition at line 112 of file import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a757c9acbab0a0377cc2757a853d168df_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad6061b2ae811618355cf3d1058b14a65}\label{templates_8h_ad6061b2ae811618355cf3d1058b14a65}} 
\index{templates.\+h@{templates.\+h}!import\+\_\+rho@{import\+\_\+rho}}
\index{import\+\_\+rho@{import\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{import\+\_\+rho()}{import\_rho()}}
{\footnotesize\ttfamily double import\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x }\end{DoxyParamCaption})}



Get the density at an arbitray position in an imported model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain assosciated with an imported model \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ x The position where we desire rho \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
rho
\end{DoxyReturn}
The routine simply calls coordinate system specific routines to get the density for imported models

\paragraph*{Notes}

The routine is used to map densities from an imported model where we assume that the density is given at the grid points. In Python, we want map the grid points to the edges of wind cells, but we expect the densities to be given at the centers of the cells. 

Definition at line 243 of file import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad6061b2ae811618355cf3d1058b14a65_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a831ead9a3678221f5b2e7a1f95abc725}\label{templates_8h_a831ead9a3678221f5b2e7a1f95abc725}} 
\index{templates.\+h@{templates.\+h}!import\+\_\+rtheta@{import\+\_\+rtheta}}
\index{import\+\_\+rtheta@{import\+\_\+rtheta}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{import\+\_\+rtheta()}{import\_rtheta()}}
{\footnotesize\ttfamily int import\+\_\+rtheta (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{char $\ast$}]{filename }\end{DoxyParamCaption})}



Read the an arbitray wind model in polar coordinates. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain for the imported model \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ filename The file containing the model to import \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine reads the data into a set of arrays. It\textquotesingle{}s only purpose is to read in the data

\paragraph*{Notes}

The basic data we need to read in are

r theta v\+\_\+x v\+\_\+y v\+\_\+z rho (and optionally T)

where


\begin{DoxyItemize}
\item r is the radial coordianate
\item theta is the angular coordinate measured from the z axis
\item v\+\_\+x, v\+\_\+y, and v\+\_\+z is the velocity in cartesian coordinates as mearued in the x,z plane
\item rho is the density in cgs units
\end{DoxyItemize}

We assume that all of the variables are centered, that is we are not assuming that we are giving rho at the center of a cell, but that r and v\+\_\+r are at the edges of a cell. This is somehing that would presumable be easy to change 

Definition at line 130 of file import\+\_\+rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a831ead9a3678221f5b2e7a1f95abc725_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3100d6568eff0dee456e0b05042f575e}\label{templates_8h_a3100d6568eff0dee456e0b05042f575e}} 
\index{templates.\+h@{templates.\+h}!import\+\_\+velocity@{import\+\_\+velocity}}
\index{import\+\_\+velocity@{import\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{import\+\_\+velocity()}{import\_velocity()}}
{\footnotesize\ttfamily double import\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x,  }\item[{double $\ast$}]{v }\end{DoxyParamCaption})}



Get the velocity at a position for an imported model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain in which the velocity is to be determined \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ x The position where the velocity is to be determined \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ v The velocity in cartesian coordiantes \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The speed
\end{DoxyReturn}
The routine simply calls one of several coordinate-\/system specific routines for obtaining the velocity of the wind when an imported model is involved.

\paragraph*{Notes}

The routine is used to set up velocities in wmain 

Definition at line 166 of file import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3100d6568eff0dee456e0b05042f575e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1729341e0e93f5ca50b7c1666fa4b726}\label{templates_8h_a1729341e0e93f5ca50b7c1666fa4b726}} 
\index{templates.\+h@{templates.\+h}!import\+\_\+wind@{import\+\_\+wind}}
\index{import\+\_\+wind@{import\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{import\+\_\+wind()}{import\_wind()}}
{\footnotesize\ttfamily int import\+\_\+wind (\begin{DoxyParamCaption}\item[{int}]{ndom }\end{DoxyParamCaption})}



Import a gridded model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain for the model \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a steering routine. It reads the name of the file to import and depending on the pre-\/established coordiante system calls one of several coordiante system specific routines to actually read in the model

\paragraph*{Notes}

Definition at line 58 of file import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1729341e0e93f5ca50b7c1666fa4b726_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3d71a4823d0ecd3c4b591d8da3bd63a7}\label{templates_8h_a3d71a4823d0ecd3c4b591d8da3bd63a7}} 
\index{templates.\+h@{templates.\+h}!index\+\_\+collisions@{index\+\_\+collisions}}
\index{index\+\_\+collisions@{index\+\_\+collisions}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{index\+\_\+collisions()}{index\_collisions()}}
{\footnotesize\ttfamily int index\+\_\+collisions (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



sorts the collisional lines into frequency order 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

The results are stored in xcol\+\_\+ptr 

Definition at line 3506 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3d71a4823d0ecd3c4b591d8da3bd63a7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{templates_8h_a3d71a4823d0ecd3c4b591d8da3bd63a7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a129463b5d8256593b8bdce5bf207a079}\label{templates_8h_a129463b5d8256593b8bdce5bf207a079}} 
\index{templates.\+h@{templates.\+h}!index\+\_\+inner\+\_\+cross@{index\+\_\+inner\+\_\+cross}}
\index{index\+\_\+inner\+\_\+cross@{index\+\_\+inner\+\_\+cross}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{index\+\_\+inner\+\_\+cross()}{index\_inner\_cross()}}
{\footnotesize\ttfamily int index\+\_\+inner\+\_\+cross (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Index inner shell xsections in frequency order. 

\begin{DoxyReturn}{Returns}
Alwasy returns 0
\end{DoxyReturn}
The rusults are stored in inner\+\_\+cross\+\_\+ptr

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 3448 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a129463b5d8256593b8bdce5bf207a079_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=265pt]{templates_8h_a129463b5d8256593b8bdce5bf207a079_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af2bf62098e21f43ec0e2cdfc378d447c}\label{templates_8h_af2bf62098e21f43ec0e2cdfc378d447c}} 
\index{templates.\+h@{templates.\+h}!index\+\_\+lines@{index\+\_\+lines}}
\index{index\+\_\+lines@{index\+\_\+lines}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{index\+\_\+lines()}{index\_lines()}}
{\footnotesize\ttfamily int index\+\_\+lines (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



sort the lines into frequency order 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

All use a Numerical recipes routine indexx for this 

Definition at line 3333 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af2bf62098e21f43ec0e2cdfc378d447c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{templates_8h_af2bf62098e21f43ec0e2cdfc378d447c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a86b680cbcd546a5f06c86c6805fc91c9}\label{templates_8h_a86b680cbcd546a5f06c86c6805fc91c9}} 
\index{templates.\+h@{templates.\+h}!index\+\_\+phot\+\_\+top@{index\+\_\+phot\+\_\+top}}
\index{index\+\_\+phot\+\_\+top@{index\+\_\+phot\+\_\+top}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{index\+\_\+phot\+\_\+top()}{index\_phot\_top()}}
{\footnotesize\ttfamily int index\+\_\+phot\+\_\+top (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Index the topbase photoionzation crossections by frequency. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The results are stored in phot\+\_\+top\+\_\+ptr

\paragraph*{Notes}

Adapted from index\+\_\+lines as part to topbase addition to python 

Definition at line 3394 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a86b680cbcd546a5f06c86c6805fc91c9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{templates_8h_a86b680cbcd546a5f06c86c6805fc91c9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_adc5c07bccdca8cfce32214f15cfc76aa}\label{templates_8h_adc5c07bccdca8cfce32214f15cfc76aa}} 
\index{templates.\+h@{templates.\+h}!indexx@{indexx}}
\index{indexx@{indexx}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{indexx()}{indexx()}}
{\footnotesize\ttfamily void indexx (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{float}]{arrin\mbox{[}$\,$\mbox{]},  }\item[{int}]{indx\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_af01dfd90f1eaaa70104a594dd92bd30c}\label{templates_8h_af01dfd90f1eaaa70104a594dd92bd30c}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+advanced\+\_\+modes@{init\+\_\+advanced\+\_\+modes}}
\index{init\+\_\+advanced\+\_\+modes@{init\+\_\+advanced\+\_\+modes}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+advanced\+\_\+modes()}{init\_advanced\_modes()}}
{\footnotesize\ttfamily int init\+\_\+advanced\+\_\+modes (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



simply initialises the set of advanced modes stored in the modes structure to a default value. 

\begin{DoxyReturn}{Returns}
Allways returns 0
\end{DoxyReturn}
\paragraph*{Notes}

modes is a structure declared in \hyperlink{python_8h}{python.\+h}

Most of the modes are initialized to 0, which means that activites that could be uddertaken for this mode, will not be.

Advanced modes are turned off by default, unless the -\/d flag is invoked at runtime. If it is invoked, one will be asked whether to turn-\/on an advanced mode.

In most cases, the advanced modes cause extra diagnostic information to be saved.

see \#111 and \#120 for recent work 

Definition at line 286 of file setup.\+c.

\mbox{\Hypertarget{templates_8h_acbb582e8c0def41044e2d4d8aac0c752}\label{templates_8h_acbb582e8c0def41044e2d4d8aac0c752}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+extra\+\_\+diagnostics@{init\+\_\+extra\+\_\+diagnostics}}
\index{init\+\_\+extra\+\_\+diagnostics@{init\+\_\+extra\+\_\+diagnostics}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+extra\+\_\+diagnostics()}{init\_extra\_diagnostics()}}
{\footnotesize\ttfamily int init\+\_\+extra\+\_\+diagnostics (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



opon a file for writing out extra diagnostics. In some cases reads a file that specifies in which cells ones wants diagnostics 

\begin{DoxyReturn}{Returns}
Always retuns 0
\end{DoxyReturn}
This routine gets some residual inforamtion needed to specify exactlay what one wants to track, and opens files that will be used to write the diagnostics.

\paragraph*{Notes}

see \#111 and \#120

The diagnostic filenames are hardwired

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000019}{Bug}]Ultimately we would like to write the extra diagnositcs to a single file\end{DoxyRefDesc}


Definition at line 225 of file diag.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_acbb582e8c0def41044e2d4d8aac0c752_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{templates_8h_acbb582e8c0def41044e2d4d8aac0c752_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a86d223ebd7563467934af71d1d8e4552}\label{templates_8h_a86d223ebd7563467934af71d1d8e4552}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+freebound@{init\+\_\+freebound}}
\index{init\+\_\+freebound@{init\+\_\+freebound}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+freebound()}{init\_freebound()}}
{\footnotesize\ttfamily int init\+\_\+freebound (\begin{DoxyParamCaption}\item[{double}]{t1,  }\item[{double}]{t2,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



initializes the structure fb\+\_\+struc as well as some associated arrays and variables (found in \hyperlink{python_8h}{python.\+h}) that describe recombination rates and band-\/limited luminosities. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t1 A lower limit for the temperature \\
\hline
\mbox{\tt in}  & {\em double} & t2 An upper limit for the temperature \\
\hline
\mbox{\tt in}  & {\em double} & f1 The lower limit for a frequency interval \\
\hline
\mbox{\tt in}  & {\em double} & f2 The upper limit for the frequency interval \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine generally returns 0
\end{DoxyReturn}
Python typically calculates photons in frequency ranges (in order to enable stratified sampling). For this to work, one needs freebound emissivities and cooling rates corresponding to these freqency ranges. Since we retrun to the same frequency ranges every cycle, Python stores the necessary information in structures.

This routine is responsible for populating these structures, so that they can be accessed later via the routine get\+\_\+fb.

\paragraph*{Notes}

The first time the routine is called, both recombination rates and band-\/limited luminosities are calculated. On subsequent calls the routine checks to see whether it has already calculated the band-\/limited freebound emissivities, and if so returns without redoing the calculation. However, if a new frequency interval is provided, the new luminosities are added to the free-\/bound structure. To force a re-\/initialization nfb must be set to 0.

The routine allows for the possibility that there are more frequency intervals than place to store data and will recylce the structure if this occurs (indicating this with several error messages). This allows the program to proceed, but if this happens often then the variable N\+FB in \hyperlink{python_8h}{python.\+h} should be increased. 

Definition at line 977 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a86d223ebd7563467934af71d1d8e4552_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{templates_8h_a86d223ebd7563467934af71d1d8e4552_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a555f188199cb3346b32e289e64c9d980}\label{templates_8h_a555f188199cb3346b32e289e64c9d980}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+geo@{init\+\_\+geo}}
\index{init\+\_\+geo@{init\+\_\+geo}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+geo()}{init\_geo()}}
{\footnotesize\ttfamily int init\+\_\+geo (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



initializes the geo structure to something that is semi-\/reasonable 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Initial values for all of the variables that are not part of the individual wind descriptions that are actully read(!) into the program should be created here. The derived values are not needed.

\paragraph*{Notes}

In general, cgs units are the working units for Python. Thus all intialization should be converted to these units.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000054}{Bug}]Currently init\+\_\+geo is set up for C\+Vs and Stars and not A\+GN. We now read in the system type as the first variable. The intent was to allow one to use the system type to particularize how geo (aqnd other variables) were intialized. But this has yet to be carreid out.\end{DoxyRefDesc}


Definition at line 60 of file setup.\+c.

\mbox{\Hypertarget{templates_8h_a6260aa06c4ed5ec3e59026a65ce5194d}\label{templates_8h_a6260aa06c4ed5ec3e59026a65ce5194d}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+integ\+\_\+planck\+\_\+d@{init\+\_\+integ\+\_\+planck\+\_\+d}}
\index{init\+\_\+integ\+\_\+planck\+\_\+d@{init\+\_\+integ\+\_\+planck\+\_\+d}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+integ\+\_\+planck\+\_\+d()}{init\_integ\_planck\_d()}}
{\footnotesize\ttfamily int init\+\_\+integ\+\_\+planck\+\_\+d (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



calulates integrals of the dimensionless bb function from 0 to alpha and the stores the reusults in an array used by integ\+\_\+plank\+\_\+d 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a helper routine which is only called once from integ\+\_\+planck in order to initialize the array integ\+\_\+planck.

It calculates the integral of the dimensionless bb function between 0 and alpha for a series of alpha values values between A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX.

\paragraph*{Notes}

A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX are hardcoded which are hardcorded.

The actual integration is done with the numerical recipes routine \char`\"{}qromb\char`\"{} 

Definition at line 495 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{templates_8h_a6260aa06c4ed5ec3e59026a65ce5194d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6260aa06c4ed5ec3e59026a65ce5194d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a887b555bea1486a6c04a71838b690b63}\label{templates_8h_a887b555bea1486a6c04a71838b690b63}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+ionization@{init\+\_\+ionization}}
\index{init\+\_\+ionization@{init\+\_\+ionization}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+ionization()}{init\_ionization()}}
{\footnotesize\ttfamily int init\+\_\+ionization (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Select the ionization and line transfer modes, along with various other parameters about ionization. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine queries for a variety of parameters which describe how ionization and line transfer are handled. This includes whether surfaces reflect

\paragraph*{Notes}

The routine is not particular well named, and it is not immediately obvious that all of the parmenters that are queried for here are related. 

Definition at line 581 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a887b555bea1486a6c04a71838b690b63_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3995f2a6ba379027804653e28e4feac1}\label{templates_8h_a3995f2a6ba379027804653e28e4feac1}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+log\+\_\+and\+\_\+windsave@{init\+\_\+log\+\_\+and\+\_\+windsave}}
\index{init\+\_\+log\+\_\+and\+\_\+windsave@{init\+\_\+log\+\_\+and\+\_\+windsave}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+log\+\_\+and\+\_\+windsave()}{init\_log\_and\_windsave()}}
{\footnotesize\ttfamily int init\+\_\+log\+\_\+and\+\_\+windsave (\begin{DoxyParamCaption}\item[{int}]{restart\+\_\+stat }\end{DoxyParamCaption})}



init\+\_\+files 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & restart\+\_\+stat A flag indicating whether this run is a restart or a new run.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine open the log file and signal files.

On restarts, it checks whether there is an appropriate windsave file to use.

\paragraph*{Notes}

restart\+\_\+stat will be 1 if restarting, 0 if a new run

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000056}{Bug}]This routine was refactored out of \hyperlink{python_8c}{python.\+c} in an attempt to make that routine simpler, but it is not obvious that what done here actually makes sense. For example, although the routine checks if the windsave file exists, and sets restart\+\_\+stat to 0 if it does not. This information is not transmitted back to any other portion of the program.\end{DoxyRefDesc}


Definition at line 52 of file setup\+\_\+files.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{templates_8h_a3995f2a6ba379027804653e28e4feac1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_afc4ebd7d545f29d6e3a9505cf462c62c}\label{templates_8h_afc4ebd7d545f29d6e3a9505cf462c62c}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+observers@{init\+\_\+observers}}
\index{init\+\_\+observers@{init\+\_\+observers}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+observers()}{init\_observers()}}
{\footnotesize\ttfamily int init\+\_\+observers (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



get inputs that describe the detailed spectra that one intends to extract. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

There are inputs here both for a normal extaction and in advanced mode for selecting spectra from photons with specific numbers of scatters, or from a certain reagion. It is also possible to extact spectra in the \textquotesingle{}live or die" mode, in which one simply tracks photons that emerge in a certain inclination range. 

Definition at line 334 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_afc4ebd7d545f29d6e3a9505cf462c62c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3eba280b12bdc0cafaf8a7fbe33a887a}\label{templates_8h_a3eba280b12bdc0cafaf8a7fbe33a887a}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+photons@{init\+\_\+photons}}
\index{init\+\_\+photons@{init\+\_\+photons}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+photons()}{init\_photons()}}
{\footnotesize\ttfamily \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} init\+\_\+photons (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



gets information about the number of cycles and how many photons there should be per cycle. 

\begin{DoxyReturn}{Returns}
Generally returns 0
\end{DoxyReturn}
??? D\+E\+S\+C\+R\+I\+P\+T\+I\+ON ???

\paragraph*{Notes}

The routine also allocates memory for the photon structure. If the routine is unable to allocate this membory, the routine will exit. 

Definition at line 501 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3eba280b12bdc0cafaf8a7fbe33a887a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6cc03550704557b5ad2967fc748a579d}\label{templates_8h_a6cc03550704557b5ad2967fc748a579d}} 
\index{templates.\+h@{templates.\+h}!init\+\_\+rand@{init\+\_\+rand}}
\index{init\+\_\+rand@{init\+\_\+rand}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{init\+\_\+rand()}{init\_rand()}}
{\footnotesize\ttfamily int init\+\_\+rand (\begin{DoxyParamCaption}\item[{int}]{seed }\end{DoxyParamCaption})}



Sets up a random number generator. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em seed} & The seed to set up the generator \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Sets up a random number generator. The resulting generator is addressed by the pointer rng, which is set up as a local variable at the top of the file. The type of generator is set in the call to gsl\+\_\+rng\+\_\+alloc -\/ currently a meursenne twister

\paragraph*{Notes}

2/18 -\/ Written by N\+SH 

Definition at line 260 of file random.\+c.

\mbox{\Hypertarget{templates_8h_a5444ce9f7285f1e9130f37f9fd40191a}\label{templates_8h_a5444ce9f7285f1e9130f37f9fd40191a}} 
\index{templates.\+h@{templates.\+h}!inner\+\_\+shell\+\_\+summary@{inner\+\_\+shell\+\_\+summary}}
\index{inner\+\_\+shell\+\_\+summary@{inner\+\_\+shell\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{inner\+\_\+shell\+\_\+summary()}{inner\_shell\_summary()}}
{\footnotesize\ttfamily int inner\+\_\+shell\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aaf2a9843cc170d6b01b75a1704f8c4fb}\label{templates_8h_aaf2a9843cc170d6b01b75a1704f8c4fb}} 
\index{templates.\+h@{templates.\+h}!integ\+\_\+brem@{integ\+\_\+brem}}
\index{integ\+\_\+brem@{integ\+\_\+brem}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{integ\+\_\+brem()}{integ\_brem()}}
{\footnotesize\ttfamily double integ\+\_\+brem (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



The integrand used in qromb to compute the luminosity of a bremstrahlung source. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq The frequency at which to compute the bremstrahlung luminosity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The luminosity at frwquency freq
\end{DoxyReturn}
Since geo.\+const\+\_\+agn is a luminosity, this function returns a luminosity with units ergs/s

\paragraph*{Notes}

10/15 -\/ Written by N\+SH 

Definition at line 46 of file brem.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aaf2a9843cc170d6b01b75a1704f8c4fb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7ef12badd64f5bb47d6fccbb217ba805}\label{templates_8h_a7ef12badd64f5bb47d6fccbb217ba805}} 
\index{templates.\+h@{templates.\+h}!integ\+\_\+fb@{integ\+\_\+fb}}
\index{integ\+\_\+fb@{integ\+\_\+fb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{integ\+\_\+fb()}{integ\_fb()}}
{\footnotesize\ttfamily double integ\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nion,  }\item[{int}]{fb\+\_\+choice,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the integrated emissivity of the plasma, or the number of recombinations per second of a particular ion within defined frequency bands. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperature at which the emissivity \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in,out}  & {\em int} & nion The ion for which the emissivity is returned \\
\hline
\mbox{\tt in,out}  & {\em int} & fb\+\_\+choice A switch which determines exactly what is to be returned \\
\hline
\mbox{\tt in,out}  & {\em int} & mode A switch which indicates whether one is interested in normal radiative recombination (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or inner shell recombinaiton (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine returns the specific emissivity, e.\+g. the emissivity and or recombination rate per electron and per ion.
\end{DoxyReturn}
The options are as follows\+:


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

The routine returns the integral of the emissivity (or recombination rate) over the frequency interval. The routine uses pre-\/calculated values if that is possible, or calculate a new values if that is not possible. (In that case xinteg\+\_\+fb updates the set of pre-\/calculated values so that they can be used in a future call.

\paragraph*{Notes}

Definition at line 242 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a7ef12badd64f5bb47d6fccbb217ba805_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{templates_8h_a7ef12badd64f5bb47d6fccbb217ba805_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af5c48487242ab8760a1893e385d3e11b}\label{templates_8h_af5c48487242ab8760a1893e385d3e11b}} 
\index{templates.\+h@{templates.\+h}!integ\+\_\+planck\+\_\+d@{integ\+\_\+planck\+\_\+d}}
\index{integ\+\_\+planck\+\_\+d@{integ\+\_\+planck\+\_\+d}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{integ\+\_\+planck\+\_\+d()}{integ\_planck\_d()}}
{\footnotesize\ttfamily double integ\+\_\+planck\+\_\+d (\begin{DoxyParamCaption}\item[{double}]{alphamin,  }\item[{double}]{alphamax }\end{DoxyParamCaption})}



Obtains the integral of the dimensionless blackbody function between alphamin and alphamax. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alphamin The minimum value of alpha (h nu/ kT) considered \\
\hline
\mbox{\tt in}  & {\em double} & alphamax The maximum value of alpha to be considered \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the integral
\end{DoxyReturn}
To save computing time, the routine actually accesses an array that contains the the integral of the bb function from 0 to alpha for a number of values of alpha. By differencing (and intepolating) this array for the element corrsponding to alphamax and alphamin, the routine returns the integral between alphamax and alphamin

\paragraph*{Notes}

The first time the function is called the integ\+\_\+planck\mbox{[}\mbox{]} is filled.

integ\+\_\+plank\mbox{[}n\mbox{]} contains the integral of the dimensionless planck function from A\+L\+P\+H\+A\+M\+IN to A\+L\+P\+H\+A\+M\+AX. Therefore if one wants to obtain the integral of the dimensionless bb function, one simply interpolates this array. 

Definition at line 391 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af5c48487242ab8760a1893e385d3e11b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af5c48487242ab8760a1893e385d3e11b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a626b1882e2533441cdf2daabd36e8a8b}\label{templates_8h_a626b1882e2533441cdf2daabd36e8a8b}} 
\index{templates.\+h@{templates.\+h}!ion\+\_\+abundances@{ion\+\_\+abundances}}
\index{ion\+\_\+abundances@{ion\+\_\+abundances}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ion\+\_\+abundances()}{ion\_abundances()}}
{\footnotesize\ttfamily int ion\+\_\+abundances (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



ionization routines for the wind one cell at a time 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The cell in which the ioniztion is to be calculated \\
\hline
\mbox{\tt in}  & {\em int} & mode A parameter descibing how to calculate the ioniztion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine returns status messages dereived from the individual routines used to calculate the abundances.
\end{DoxyReturn}
The intent is that the routine ion\+\_\+abundances is the steering routine for all calculations of the abundances

\paragraph*{Notes}

Definition at line 39 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a626b1882e2533441cdf2daabd36e8a8b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8086fb90b34ab086655b4634ff343ef0}\label{templates_8h_a8086fb90b34ab086655b4634ff343ef0}} 
\index{templates.\+h@{templates.\+h}!ion\+\_\+overview@{ion\+\_\+overview}}
\index{ion\+\_\+overview@{ion\+\_\+overview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ion\+\_\+overview()}{ion\_overview()}}
{\footnotesize\ttfamily int ion\+\_\+overview (\begin{DoxyParamCaption}\item[{int}]{icell }\end{DoxyParamCaption})}



macro\+\_\+summary is a routine intended to allow one to display information about macro atoms. It is the top level routine for macro information and requires further input from the user. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & icell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 228 of file py\+\_\+wind\+\_\+macro.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{templates_8h_a8086fb90b34ab086655b4634ff343ef0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa0fd17466db7bef61e7dcef96737cb00}\label{templates_8h_aa0fd17466db7bef61e7dcef96737cb00}} 
\index{templates.\+h@{templates.\+h}!ion\+\_\+summary@{ion\+\_\+summary}}
\index{ion\+\_\+summary@{ion\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{ion\+\_\+summary()}{ion\_summary()}}
{\footnotesize\ttfamily int ion\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{element,  }\item[{int}]{istate,  }\item[{int}]{iswitch,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ad3a1f2e40456d8b008219f245901c0cd}\label{templates_8h_ad3a1f2e40456d8b008219f245901c0cd}} 
\index{templates.\+h@{templates.\+h}!I\+P\+\_\+summary@{I\+P\+\_\+summary}}
\index{I\+P\+\_\+summary@{I\+P\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{I\+P\+\_\+summary()}{IP\_summary()}}
{\footnotesize\ttfamily int I\+P\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8088e64c83fc1e5243732af75e25ec91}\label{templates_8h_a8088e64c83fc1e5243732af75e25ec91}} 
\index{templates.\+h@{templates.\+h}!J\+\_\+scat\+\_\+summary@{J\+\_\+scat\+\_\+summary}}
\index{J\+\_\+scat\+\_\+summary@{J\+\_\+scat\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{J\+\_\+scat\+\_\+summary()}{J\_scat\_summary()}}
{\footnotesize\ttfamily int J\+\_\+scat\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa58fa697f4943c2aeca9ba27cf96dc88}\label{templates_8h_aa58fa697f4943c2aeca9ba27cf96dc88}} 
\index{templates.\+h@{templates.\+h}!J\+\_\+summary@{J\+\_\+summary}}
\index{J\+\_\+summary@{J\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{J\+\_\+summary()}{J\_summary()}}
{\footnotesize\ttfamily int J\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a983dcec5903b4aacfce1c770b20e4ba9}\label{templates_8h_a983dcec5903b4aacfce1c770b20e4ba9}} 
\index{templates.\+h@{templates.\+h}!kappa\+\_\+bf@{kappa\+\_\+bf}}
\index{kappa\+\_\+bf@{kappa\+\_\+bf}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kappa\+\_\+bf()}{kappa\_bf()}}
{\footnotesize\ttfamily double kappa\+\_\+bf (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{freq,  }\item[{int}]{macro\+\_\+all }\end{DoxyParamCaption})}



calculates the bf opacity in a specific cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The plasma cell of interest \\
\hline
\mbox{\tt in}  & {\em double} & freq The frequency at which the opacity is calculated \\
\hline
\mbox{\tt in}  & {\em int} & macro\+\_\+all 1--$>$ macro\+\_\+atoms only, 0 all topbase ions \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The bf opacity
\end{DoxyReturn}
\paragraph*{Notes}

The routine allows for clumping, reducing kappa\+\_\+bf by the filling factor. 

Definition at line 585 of file resonate.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{templates_8h_a983dcec5903b4aacfce1c770b20e4ba9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{templates_8h_a983dcec5903b4aacfce1c770b20e4ba9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a058633208c21e33eb49a33bd82c6327d}\label{templates_8h_a058633208c21e33eb49a33bd82c6327d}} 
\index{templates.\+h@{templates.\+h}!kappa\+\_\+comp@{kappa\+\_\+comp}}
\index{kappa\+\_\+comp@{kappa\+\_\+comp}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kappa\+\_\+comp()}{kappa\_comp()}}
{\footnotesize\ttfamily double kappa\+\_\+comp (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{freq }\end{DoxyParamCaption})}



Pointer to current plasma cell. 

computes the effective compton opacity in the cell.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ pointer to the current plasma cell \\
\hline
\mbox{\tt in}  & {\em double} & freq -\/ the frequency of the current photon packet being tracked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
kappa -\/ the compton opacity for the cell.
\end{DoxyReturn}
This routine works out the opacity of a cell to compton (Thompson) scattering. It is designed to give the correct {\itshape heating} effect when high frequency photons undergo Compton scattering. We use a fitted cross section given in Hazy 3 to calculate the frequency depedant cross section. This cross section takes account of the energy exchange, i.\+e. not only the cross section is freqneucy dependant, but so is the mean energy transfer.-\/ just using the Klein-\/\+Nishina cross section will give the wrong results in terms of actual heating effect of these interactions.

\paragraph*{Notes}

This implements the equation kappa=(sigma\+T\+\_\+h$\ast$ne$\ast$freq)/(me$\ast$c$^\wedge$2) Initally it is called by radiation 

Definition at line 46 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=210pt]{templates_8h_a058633208c21e33eb49a33bd82c6327d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a058633208c21e33eb49a33bd82c6327d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a03396c07d161ba11de4a87161c5b6745}\label{templates_8h_a03396c07d161ba11de4a87161c5b6745}} 
\index{templates.\+h@{templates.\+h}!kappa\+\_\+ff@{kappa\+\_\+ff}}
\index{kappa\+\_\+ff@{kappa\+\_\+ff}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kappa\+\_\+ff()}{kappa\_ff()}}
{\footnotesize\ttfamily double kappa\+\_\+ff (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{freq }\end{DoxyParamCaption})}



calculates the free-\/free opacity allowing for stimulated emission 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The plasma cell where the free-\/free optacity is to be calculated \\
\hline
\mbox{\tt in}  & {\em double} & freq The frequency at which kappa\+\_\+ff is to be calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
kappa
\end{DoxyReturn}
Uses the formula from Allen

\paragraph*{Notes}

The routine originally only includes the effect of singly ionized H and doubly ionized He and did not include a gaunt factor

More recent versions include all ions and a gaunt factor, as calculated in pop\+\_\+kappa\+\_\+ff\+\_\+array and stored in kappa\+\_\+ff\+\_\+factor. The gaunt factor as currewntly implemented is a frequency averaged one, and so is approximate (but better than just using 1). A future upgrade would use a more complex implementation where we use the frequency dependant gaunt factor. 

Definition at line 640 of file radiation.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{templates_8h_a03396c07d161ba11de4a87161c5b6745_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3ce17d1882989bac342f4bc4d1e0a7b6}\label{templates_8h_a3ce17d1882989bac342f4bc4d1e0a7b6}} 
\index{templates.\+h@{templates.\+h}!kappa\+\_\+ind\+\_\+comp@{kappa\+\_\+ind\+\_\+comp}}
\index{kappa\+\_\+ind\+\_\+comp@{kappa\+\_\+ind\+\_\+comp}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kappa\+\_\+ind\+\_\+comp()}{kappa\_ind\_comp()}}
{\footnotesize\ttfamily double kappa\+\_\+ind\+\_\+comp (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{freq }\end{DoxyParamCaption})}



Computes the effective opacity in the cell due to {\itshape induced} compton heating. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ pointer to the current plasma cell \\
\hline
\mbox{\tt in}  & {\em double} & freq -\/ the frequency of the current photon packet being tracked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
kappa -\/ the inducd compton opacity for the cell.
\end{DoxyReturn}
This routine implements a rather unusual situation, where the mean intensity in a cell exceeds the blackbody value and we get induced compton heating.

\paragraph*{Notes}

This implements the induced compton term in equation 6.\+5 in Hazy vol 3 -\/ this is the last term in the equation. It will rarely if ever occur in a real model, but was included to give better agreement with cloudy over a wide range of ionization parameters. 

Definition at line 89 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3ce17d1882989bac342f4bc4d1e0a7b6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3ce17d1882989bac342f4bc4d1e0a7b6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7d7a0bd03f273ab50a2eabadb685b585}\label{templates_8h_a7d7a0bd03f273ab50a2eabadb685b585}} 
\index{templates.\+h@{templates.\+h}!kbf\+\_\+need@{kbf\+\_\+need}}
\index{kbf\+\_\+need@{kbf\+\_\+need}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kbf\+\_\+need()}{kbf\_need()}}
{\footnotesize\ttfamily int kbf\+\_\+need (\begin{DoxyParamCaption}\item[{double}]{fmin,  }\item[{double}]{fmax }\end{DoxyParamCaption})}



computes and stores the set of bound-\/free processes which make significiant contributions to the opacity in a grid cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & fmin the lowest frequency of interest to the calculation \\
\hline
\mbox{\tt in}  & {\em double} & fmax the highest frequency of interest to the calculations \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The purpose of this routine is to speed up calculations by idenfifying which bound-\/free x-\/sections are important enough to be included when calculationg the bound-\/fee opacity, and which an be ignored because the denisty of the particular ion is so low it will not contribute.

For each cell, the routine determines what bf transitons are important and stores them in one-\/$>$kbf\+\_\+use\mbox{[}n\mbox{]}.

The total number of such transitions is given in one-\/$>$kbf\+\_\+nuse.

This routine is now called before various cylces of the Monte Carlo calculation. (in \hyperlink{run_8c}{run.\+c}) $\ast$ It determines which bf processes are worth considering during the calculation that follows.

To do this is uses the edge position (must be inside, or close to, the spectral region of interest) and the edge opacity (must be greater than a threshold value, currently 10$^\wedge$-\/6.

The need for the routine is just to prevent wasting time on unimportant bf transitions. It is called (currently from resonate).

\paragraph*{Notes}

The dimensionalty of kbf\+\_\+use is currently set to N\+T\+O\+P\+\_\+\+P\+H\+OT, which is large enough to store evey transition if necessary. 

Definition at line 682 of file resonate.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=216pt]{templates_8h_a7d7a0bd03f273ab50a2eabadb685b585_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a28be66a0a760ceb7b8394a5a8e7526af}\label{templates_8h_a28be66a0a760ceb7b8394a5a8e7526af}} 
\index{templates.\+h@{templates.\+h}!klein\+\_\+nishina@{klein\+\_\+nishina}}
\index{klein\+\_\+nishina@{klein\+\_\+nishina}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{klein\+\_\+nishina()}{klein\_nishina()}}
{\footnotesize\ttfamily double klein\+\_\+nishina (\begin{DoxyParamCaption}\item[{double}]{nu }\end{DoxyParamCaption})}



computes the Klein Nishina cross section for a photon of frequency nu. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & nu -\/ photon frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the KN cross section.
\end{DoxyReturn}
This routine is used to compute the frequency dependant cross section of a photon to electron scattering. For a frequency of less than 1e18\+Hz this is just the Thompson scattering cross section. It is currently only used to compute the chance of a photon interacting in this way. The actual eneergy loss when an interaction occurs requires a cross section that takes account of energy balance (provided by the alpha function.)

\paragraph*{Notes}

This implements equation 7.\+5 in Rybicki and Lightman 

Definition at line 230 of file compton.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{templates_8h_a28be66a0a760ceb7b8394a5a8e7526af_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1a59c30ec7f9020e01e1eb9010be4109}\label{templates_8h_a1a59c30ec7f9020e01e1eb9010be4109}} 
\index{templates.\+h@{templates.\+h}!kn\+\_\+rho@{kn\+\_\+rho}}
\index{kn\+\_\+rho@{kn\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kn\+\_\+rho()}{kn\_rho()}}
{\footnotesize\ttfamily double kn\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a28ecd56d18384623466c728d74cee061}\label{templates_8h_a28ecd56d18384623466c728d74cee061}} 
\index{templates.\+h@{templates.\+h}!kn\+\_\+rho\+\_\+zero@{kn\+\_\+rho\+\_\+zero}}
\index{kn\+\_\+rho\+\_\+zero@{kn\+\_\+rho\+\_\+zero}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kn\+\_\+rho\+\_\+zero()}{kn\_rho\_zero()}}
{\footnotesize\ttfamily double kn\+\_\+rho\+\_\+zero (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{r }\end{DoxyParamCaption})}



Calculate rho at the base of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\mbox{\tt in}  & {\em double} & r A position in the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The mass density at the base of the wind
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 496 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a28ecd56d18384623466c728d74cee061_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=213pt]{templates_8h_a28ecd56d18384623466c728d74cee061_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5bbb1cf505a61b894ba478c38ce7935e}\label{templates_8h_a5bbb1cf505a61b894ba478c38ce7935e}} 
\index{templates.\+h@{templates.\+h}!kn\+\_\+velocity@{kn\+\_\+velocity}}
\index{kn\+\_\+velocity@{kn\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kn\+\_\+velocity()}{kn\_velocity()}}
{\footnotesize\ttfamily double kn\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a62c27981e9cc187028480ec2752923d3}\label{templates_8h_a62c27981e9cc187028480ec2752923d3}} 
\index{templates.\+h@{templates.\+h}!kn\+\_\+vzero@{kn\+\_\+vzero}}
\index{kn\+\_\+vzero@{kn\+\_\+vzero}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kn\+\_\+vzero()}{kn\_vzero()}}
{\footnotesize\ttfamily double kn\+\_\+vzero (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



Calculate the sound speed (launch speed) of the wind at r. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r The position (radius) for caculating the sound speed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The sound speed
\end{DoxyReturn}
For K\+WD, the launch speed is the sound velocity

\paragraph*{Notes}

Prior to calling this routine the properties of the disk must have been entered

This routine assumes a standard Shakura-\/\+Sunyaev disk.

In our implementation of the K\+WD model, the velocity at the footpoint can be a mulitiple of the sound speed, but that correction is applied in kn\+\_\+velocity 

Definition at line 420 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a62c27981e9cc187028480ec2752923d3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{templates_8h_a62c27981e9cc187028480ec2752923d3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab4a7a07fd07176e2d8723e16fd7b619d}\label{templates_8h_ab4a7a07fd07176e2d8723e16fd7b619d}} 
\index{templates.\+h@{templates.\+h}!kn\+\_\+wind\+\_\+mdot\+\_\+integral@{kn\+\_\+wind\+\_\+mdot\+\_\+integral}}
\index{kn\+\_\+wind\+\_\+mdot\+\_\+integral@{kn\+\_\+wind\+\_\+mdot\+\_\+integral}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kn\+\_\+wind\+\_\+mdot\+\_\+integral()}{kn\_wind\_mdot\_integral()}}
{\footnotesize\ttfamily double kn\+\_\+wind\+\_\+mdot\+\_\+integral (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



the integrand of K\+WD model for mdot as a function of radius 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r A position (radius) in the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the integrand
\end{DoxyReturn}
The mass loss rate is proportional to T(r)$\ast$$\ast$(4$\ast$kn\+\_\+lambda) as can be seen from K\+W\+D95 equation 10. This functikon has to be integrated over radius to normalize the local mdot to the integrated value.

\paragraph*{Notes}

The integration is carrid out in get\+\_\+knigge\+\_\+wind\+\_\+params

There is an extra factor of 2 because the wind emerges from both sides of the disk 

Definition at line 462 of file knigge.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab4a7a07fd07176e2d8723e16fd7b619d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{templates_8h_ab4a7a07fd07176e2d8723e16fd7b619d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a16ae068adf1746f09c432de7e245dfb1}\label{templates_8h_a16ae068adf1746f09c432de7e245dfb1}} 
\index{templates.\+h@{templates.\+h}!kpkt@{kpkt}}
\index{kpkt@{kpkt}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{kpkt()}{kpkt()}}
{\footnotesize\ttfamily int kpkt (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nres,  }\item[{int $\ast$}]{escape }\end{DoxyParamCaption})}



Definition at line 687 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a16ae068adf1746f09c432de7e245dfb1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a779ccebed86e21a9d217673baf5da757}\label{templates_8h_a779ccebed86e21a9d217673baf5da757}} 
\index{templates.\+h@{templates.\+h}!length@{length}}
\index{length@{length}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{length()}{length()}}
{\footnotesize\ttfamily double length (\begin{DoxyParamCaption}\item[{double}]{a\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_af4c13ec6f6c32377d10896bb62307ee8}\label{templates_8h_af4c13ec6f6c32377d10896bb62307ee8}} 
\index{templates.\+h@{templates.\+h}!level\+\_\+emissoverview@{level\+\_\+emissoverview}}
\index{level\+\_\+emissoverview@{level\+\_\+emissoverview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{level\+\_\+emissoverview()}{level\_emissoverview()}}
{\footnotesize\ttfamily int level\+\_\+emissoverview (\begin{DoxyParamCaption}\item[{int}]{nlev,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a1c6a9b3e9e1723a645c46145ec46183f}\label{templates_8h_a1c6a9b3e9e1723a645c46145ec46183f}} 
\index{templates.\+h@{templates.\+h}!level\+\_\+escapeoverview@{level\+\_\+escapeoverview}}
\index{level\+\_\+escapeoverview@{level\+\_\+escapeoverview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{level\+\_\+escapeoverview()}{level\_escapeoverview()}}
{\footnotesize\ttfamily int level\+\_\+escapeoverview (\begin{DoxyParamCaption}\item[{int}]{nlev,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a5edae3f102ed4ad84228bcc25a1a1492}\label{templates_8h_a5edae3f102ed4ad84228bcc25a1a1492}} 
\index{templates.\+h@{templates.\+h}!level\+\_\+popsoverview@{level\+\_\+popsoverview}}
\index{level\+\_\+popsoverview@{level\+\_\+popsoverview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{level\+\_\+popsoverview()}{level\_popsoverview()}}
{\footnotesize\ttfamily int level\+\_\+popsoverview (\begin{DoxyParamCaption}\item[{int}]{nplasma,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a99d06420894c52dbbc268002c4f7f3d3}\label{templates_8h_a99d06420894c52dbbc268002c4f7f3d3}} 
\index{templates.\+h@{templates.\+h}!level\+\_\+tauoverview@{level\+\_\+tauoverview}}
\index{level\+\_\+tauoverview@{level\+\_\+tauoverview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{level\+\_\+tauoverview()}{level\_tauoverview()}}
{\footnotesize\ttfamily int level\+\_\+tauoverview (\begin{DoxyParamCaption}\item[{int}]{nlev,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a2ba8dcf484d3688f9687d48dd865dc0d}\label{templates_8h_a2ba8dcf484d3688f9687d48dd865dc0d}} 
\index{templates.\+h@{templates.\+h}!levels@{levels}}
\index{levels@{levels}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{levels()}{levels()}}
{\footnotesize\ttfamily int levels (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



Calculates the fractional occupation numbers of the various of atomic configurations assuming L\+TE or various alternatives to L\+TE. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma A single element of the Plasma structure \\
\hline
\mbox{\tt in}  & {\em int} & mode An integer which determines the way in which the partition funciton will be calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\begin{DoxyVerb}The possibilites are:
\end{DoxyVerb}



\begin{DoxyItemize}
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TR 0 L\+TE using t\+\_\+r
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TE 1 L\+TE using t\+\_\+e
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+M\+L93 2 M\+L93 using a nebular approximation correction to L\+TE
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+N\+L\+T\+E\+\_\+\+S\+IM 3 // Non\+\_\+\+L\+TE with SS modification (Probably could be removed)
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+L\+T\+E\+\_\+\+G\+R\+O\+U\+ND 4 // A test mode which forces all levels to the GS (Probably could be removed)
\end{DoxyItemize}

levels populates the levden array in the Plasma pointer. It is called from the routine partition

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000035}{Bug}]Some rethinking of the whole level density approach needs to be done. It\textquotesingle{}s not clear how these functions are being used and what difference if any that they make. \end{DoxyRefDesc}


Definition at line 101 of file levels.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2ba8dcf484d3688f9687d48dd865dc0d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8cf338374390539709c962c60a953c3d}\label{templates_8h_a8cf338374390539709c962c60a953c3d}} 
\index{templates.\+h@{templates.\+h}!limit\+\_\+lines@{limit\+\_\+lines}}
\index{limit\+\_\+lines@{limit\+\_\+lines}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{limit\+\_\+lines()}{limit\_lines()}}
{\footnotesize\ttfamily int limit\+\_\+lines (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



(freqmin,freqmax) sets the the current values of line\+\_\+min and line\+\_\+max in \hyperlink{atomic_8h}{atomic.\+h} which can be used to limit the lines searched for resonances to a specific frequency range. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & freqmin The minimum frequency we are interested in \\
\hline
\mbox{\tt in,out}  & {\em double} & freqmax The maximum frequency we are interested in \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of lines that are potentially in resonance.
\end{DoxyReturn}
If limit\+\_\+lines returns 0 there are no lines of interest and one does not need to worry about any resonances at this frequency. If limit\+\_\+lines returns a number greater than 0, then the lines of interest are defined by nline\+\_\+min and nline\+\_\+max (inclusive) in \hyperlink{atomic_8h}{atomic.\+h} nline\+\_\+delt is also set which is the number of lines that are in the specified range

limit\+\_\+lines define the lines that are close to a given frequency. The degree of closeness is defined by v. The routine must be used in conjuction with get\+\_\+atomic\+\_\+data which will have created an ordered list of the lines.

\paragraph*{Notes}

Limit\+\_\+lines needs to be used somewhat carefully. Carefully means checking the return value of limit\+\_\+lines or equivalently nline\+\_\+delt=0. If nline\+\_\+delt=0 then there were no lines in the region of interest. Assuming there were lines in thte range, one must sum over lines from nline\+\_\+min to nline\+\_\+max inclusive.

One might wonder why nline\+\_\+max is not set to one larger than the last line which is in range. This is because depending on how the velocity is trending you may want to sum from the highest frequency line to the lowest. 

Definition at line 3707 of file get\+\_\+atomicdata.\+c.

\mbox{\Hypertarget{templates_8h_a08e6e02acfd4d2fb6b31cf9bfdc7b258}\label{templates_8h_a08e6e02acfd4d2fb6b31cf9bfdc7b258}} 
\index{templates.\+h@{templates.\+h}!line\+\_\+heat@{line\+\_\+heat}}
\index{line\+\_\+heat@{line\+\_\+heat}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{line\+\_\+heat()}{line\_heat()}}
{\footnotesize\ttfamily int line\+\_\+heat (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int}]{nres }\end{DoxyParamCaption})}



calculates the amount of line heating that during a resonance. 


\begin{DoxyParams}[1]{Parameters}
 & {\em \mbox{[}in} & out\mbox{]} Plasma\+Ptr xplasma The plasma cell where the resonance occurs \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pp The photon bundle associated with the event \\
\hline
\mbox{\tt in}  & {\em int} & nres The number of the resonance \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alway returns 0 f
\end{DoxyReturn}
xplasma-\/$>$heat\+\_\+lines and heat\+\_\+total are updated. The weight of photon is decreased by the amount of its energy that goes into heating

The routine calls scttering\+\_\+fraction to determine the fraction of the energy that is scattered, and adds to the heating and decrements the energy of the photon bundle.

\paragraph*{Notes}

It is called by trans\+\_\+phot in python 

Definition at line 904 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a08e6e02acfd4d2fb6b31cf9bfdc7b258_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8b5f64621f83720e21cb4440830ef473}\label{templates_8h_a8b5f64621f83720e21cb4440830ef473}} 
\index{templates.\+h@{templates.\+h}!line\+\_\+nsigma@{line\+\_\+nsigma}}
\index{line\+\_\+nsigma@{line\+\_\+nsigma}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{line\+\_\+nsigma()}{line\_nsigma()}}
{\footnotesize\ttfamily double line\+\_\+nsigma (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



Calculate the total line absorption x-\/section for a specific transition allowing for stimulated emission. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & lines $\ast$ line\+\_\+ptr The line of interest \\
\hline
 & {\em \mbox{[}int\mbox{]}} & Plasma\+Ptr xplasma The plasma cell of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total x-\/section for the line
\end{DoxyReturn}
The total x-\/section for a line in the two level approximation

\paragraph*{Notes}

The effects of stimulated emission are included 

Definition at line 587 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8b5f64621f83720e21cb4440830ef473_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab2919946d2f7195f5e532eefeae7dd2d}\label{templates_8h_ab2919946d2f7195f5e532eefeae7dd2d}} 
\index{templates.\+h@{templates.\+h}!line\+\_\+paths\+\_\+add\+\_\+phot@{line\+\_\+paths\+\_\+add\+\_\+phot}}
\index{line\+\_\+paths\+\_\+add\+\_\+phot@{line\+\_\+paths\+\_\+add\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{line\+\_\+paths\+\_\+add\+\_\+phot()}{line\_paths\_add\_phot()}}
{\footnotesize\ttfamily int line\+\_\+paths\+\_\+add\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int $\ast$}]{nres }\end{DoxyParamCaption})}



Following a line emission, increments cell paths. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind cell to register photon in. \\
\hline
\mbox{\tt in}  & {\em pp} & Photon to register in wind cell \\
\hline
\mbox{\tt in}  & {\em nres} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
When given a wind cell and photon info in matom mode, iterates over the list of tracked lines to see if the transition is in it. If so adds the weight to the path array for that line.

\paragraph*{Notes}

27/2/15 -\/ Written by S\+WM 

Definition at line 212 of file paths.\+c.

\mbox{\Hypertarget{templates_8h_a376d6bf65b4a156a45f28b56bc4c017d}\label{templates_8h_a376d6bf65b4a156a45f28b56bc4c017d}} 
\index{templates.\+h@{templates.\+h}!line\+\_\+paths\+\_\+gen\+\_\+phot@{line\+\_\+paths\+\_\+gen\+\_\+phot}}
\index{line\+\_\+paths\+\_\+gen\+\_\+phot@{line\+\_\+paths\+\_\+gen\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{line\+\_\+paths\+\_\+gen\+\_\+phot()}{line\_paths\_gen\_phot()}}
{\footnotesize\ttfamily int line\+\_\+paths\+\_\+gen\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{int}]{nres }\end{DoxyParamCaption})}



Generates path for a macro-\/atom line photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind cell to spawn in \\
\hline
\mbox{\tt in,out}  & {\em pp} & Photon to set path of  \mbox{[}in\mbox{]} nres Matom line to generate for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
If the line is being tracked, pick a random path from its path histogram. If not, default to the regular path histogram.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a43541dacfceb46c42583c31aeb11d496}{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram()} 

\hyperlink{paths_8c_a7719923b66bf470bc4eeb42c454ebd48}{simple\+\_\+paths\+\_\+gen\+\_\+phot()} 

\hyperlink{paths_8c_a176ee6debad2930212ca97a2d28794c0}{wind\+\_\+paths\+\_\+gen\+\_\+phot()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 433 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a376d6bf65b4a156a45f28b56bc4c017d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0bef6952219011c118a234daaf9c5f14}\label{templates_8h_a0bef6952219011c118a234daaf9c5f14}} 
\index{templates.\+h@{templates.\+h}!line\+\_\+summary@{line\+\_\+summary}}
\index{line\+\_\+summary@{line\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{line\+\_\+summary()}{line\_summary()}}
{\footnotesize\ttfamily int line\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a848bdfe987685e5135b3437dc0dec5e7}\label{templates_8h_a848bdfe987685e5135b3437dc0dec5e7}} 
\index{templates.\+h@{templates.\+h}!linterp@{linterp}}
\index{linterp@{linterp}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{linterp()}{linterp()}}
{\footnotesize\ttfamily int linterp (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{double}]{xarray\mbox{[}$\,$\mbox{]},  }\item[{double}]{yarray\mbox{[}$\,$\mbox{]},  }\item[{int}]{xdim,  }\item[{double $\ast$}]{y,  }\item[{int}]{mode }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa8ede21a14cf7e763909094555c5240d}\label{templates_8h_aa8ede21a14cf7e763909094555c5240d}} 
\index{templates.\+h@{templates.\+h}!lucy@{lucy}}
\index{lucy@{lucy}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{lucy()}{lucy()}}
{\footnotesize\ttfamily int lucy (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



Calculates ion abundances allowing for the Lucy Mazzali correction factors to the saha abundances contained in xplasma. It thus assumes that \hyperlink{saha_8c_a16363b5cd764e733bd84a0d991cb6568}{saha()} has been called before it, in the concentrations routine. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A single plasma cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always retuns 0
\end{DoxyReturn}
This routine solves for ne (and the concentrations) using the Lucy Mazzli correction factors.

\paragraph*{Notes}

The routine needs the Saha abundances before the correction factors can be found. As a result, the sequence is to call parttion functions, concentrations and then this routine.

Procedurally, the routine is analogous to \hyperlink{saha_8c_a96f3f44cc5cf473ca91ca268747dfba1}{concentrations()}

Note that also applied the macro\+\_\+pops routine, and required that the ne convergence criteria is rigorous enough that the macro atom level populations converge on the correct values. 

Definition at line 493 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa8ede21a14cf7e763909094555c5240d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{templates_8h_aa8ede21a14cf7e763909094555c5240d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae57f2f019f9e768eecf4132a64e93ef2}\label{templates_8h_ae57f2f019f9e768eecf4132a64e93ef2}} 
\index{templates.\+h@{templates.\+h}!lucy\+\_\+mazzali1@{lucy\+\_\+mazzali1}}
\index{lucy\+\_\+mazzali1@{lucy\+\_\+mazzali1}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{lucy\+\_\+mazzali1()}{lucy\_mazzali1()}}
{\footnotesize\ttfamily int lucy\+\_\+mazzali1 (\begin{DoxyParamCaption}\item[{double}]{nh,  }\item[{double}]{t\+\_\+r,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{www,  }\item[{int}]{nelem,  }\item[{double}]{ne,  }\item[{double}]{density\mbox{[}$\,$\mbox{]},  }\item[{double}]{xne,  }\item[{double}]{newden\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a0018131577a59a5142e3677785504d37}\label{templates_8h_a0018131577a59a5142e3677785504d37}} 
\index{templates.\+h@{templates.\+h}!lum\+\_\+lines@{lum\+\_\+lines}}
\index{lum\+\_\+lines@{lum\+\_\+lines}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{lum\+\_\+lines()}{lum\_lines()}}
{\footnotesize\ttfamily double lum\+\_\+lines (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{int}]{nmin,  }\item[{int}]{nmax }\end{DoxyParamCaption})}



Calculate the line lumiosity of lines between nmin and nmax of the frequency ordered list of lines. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one A wind cell \\
\hline
\mbox{\tt in}  & {\em int} & nmin The minimum number of a line in the frequency ordered list \\
\hline
\mbox{\tt in}  & {\em int} & nmax The maximum number of a line in the frequency ordered list \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total line luminosity between element nmin and nmax of the frequncy ordered list of lines
\end{DoxyReturn}
Using densities in the plasma cell associated with this wind cell, calculate the total line luminosity.

\paragraph*{Notes}

The individual line luminosities are stored in lin\+\_\+ptr\mbox{[}n\mbox{]}-\/$>$pow 

Definition at line 103 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0018131577a59a5142e3677785504d37_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{templates_8h_a0018131577a59a5142e3677785504d37_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac86577f6c683d765ba99ffefaaa0fb32}\label{templates_8h_ac86577f6c683d765ba99ffefaaa0fb32}} 
\index{templates.\+h@{templates.\+h}!lum\+\_\+summary@{lum\+\_\+summary}}
\index{lum\+\_\+summary@{lum\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{lum\+\_\+summary()}{lum\_summary()}}
{\footnotesize\ttfamily int lum\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a1d58fccfac7eec74c69412cfabcc5caf}\label{templates_8h_a1d58fccfac7eec74c69412cfabcc5caf}} 
\index{templates.\+h@{templates.\+h}!macro\+\_\+bb\+\_\+heating@{macro\+\_\+bb\+\_\+heating}}
\index{macro\+\_\+bb\+\_\+heating@{macro\+\_\+bb\+\_\+heating}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{macro\+\_\+bb\+\_\+heating()}{macro\_bb\_heating()}}
{\footnotesize\ttfamily double macro\+\_\+bb\+\_\+heating (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total heating due to matom bb transitions 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the total heating due to bb transitions (due to collisions) for macro atoms. The heating in simple ions is taken care of elsewhere. It is used by the heating/cooling calculation to get the temperature. 

Definition at line 746 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{templates_8h_a1d58fccfac7eec74c69412cfabcc5caf_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1d58fccfac7eec74c69412cfabcc5caf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6122a3139a25688235ecb8b77e875b0f}\label{templates_8h_a6122a3139a25688235ecb8b77e875b0f}} 
\index{templates.\+h@{templates.\+h}!macro\+\_\+bf\+\_\+heating@{macro\+\_\+bf\+\_\+heating}}
\index{macro\+\_\+bf\+\_\+heating@{macro\+\_\+bf\+\_\+heating}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{macro\+\_\+bf\+\_\+heating()}{macro\_bf\_heating()}}
{\footnotesize\ttfamily double macro\+\_\+bf\+\_\+heating (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total heating due to bf transitions for macro atoms. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the total heating due to bf transitions for macro atoms. The heating in simple ions is taken care of elsewhere. It is used by the heating/cooling calculation to get the temperature. 

Definition at line 791 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6122a3139a25688235ecb8b77e875b0f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6122a3139a25688235ecb8b77e875b0f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7de597169a947d506f6d2210de2080ac}\label{templates_8h_a7de597169a947d506f6d2210de2080ac}} 
\index{templates.\+h@{templates.\+h}!macro\+\_\+gov@{macro\+\_\+gov}}
\index{macro\+\_\+gov@{macro\+\_\+gov}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{macro\+\_\+gov()}{macro\_gov()}}
{\footnotesize\ttfamily int macro\+\_\+gov (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nres,  }\item[{int}]{matom\+\_\+or\+\_\+kpkt,  }\item[{int $\ast$}]{which\+\_\+out }\end{DoxyParamCaption})}



is a routine that will sit at a higher level in the code than either matom or kpkt and will govern the passage of packets between these routines. At the moment, since matom and kpkt call each other it call all get rather confusing and loads of nested subroutine calls ensue. removes this by calling matom and kpkt which on return tell to either return an r-\/packet to resonate or make another call to either kpkt or matom as appropriate. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p the packet at the point of activation \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ nres the process which activates the Macro Atom \\
\hline
\mbox{\tt out}  & {\em int} & matom\+\_\+or\+\_\+kpkt to tell us if we should initially excite a \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ which\+\_\+out set to 1 if return is via macro atom and 2 if via kpkt \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Will return an r-\/packet after (possibly) several calls to matom and kpkt \begin{DoxyVerb}   int nres                    the process by which re-emission occurs
   PhotPtr p                   the packet following re-emission
\end{DoxyVerb}

\end{DoxyReturn}
\paragraph*{Notes}

I\textquotesingle{}ve written this to be as general as possible so that if we want to improve the treatment of simple ions it should not need to be re-\/written.

During the spectrum calculation the emission of r-\/packets within the spectral region of interest is done using emissivities obtained during the ionization cycles. Therefore whenever an r-\/packet is converted into a k-\/packet or an excited macro atom that ends the need to follow the packet any further. To deal with this, this routine sets the weights of such packets to zero. Upon return to trans\+\_\+phot these packets will then be thrown away. 

Definition at line 57 of file macro\+\_\+gov.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a7de597169a947d506f6d2210de2080ac_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a590f1ed026cd692ac6f878ed6f359d5a}\label{templates_8h_a590f1ed026cd692ac6f878ed6f359d5a}} 
\index{templates.\+h@{templates.\+h}!macro\+\_\+pops@{macro\+\_\+pops}}
\index{macro\+\_\+pops@{macro\+\_\+pops}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{macro\+\_\+pops()}{macro\_pops()}}
{\footnotesize\ttfamily int macro\+\_\+pops (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{xne }\end{DoxyParamCaption})}



uses the Monte Carlo estimators to compute a set of level populations for levels of macro atoms. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Plasma\+Ptr xplasma ??? \\
\hline
{\em \mbox{[}in} & out\mbox{]} double xne -\/$>$ current value for electron density in this shell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Should compute the fractional level populations for macro atoms and store them in \char`\"{}levden\char`\"{} array. The ion fractions are also computed and stored in w\mbox{[}n\mbox{]}.density\mbox{[}nion\mbox{]}
\end{DoxyReturn}
\paragraph*{Notes}

This routine uses a matrix inversion method to get the level populations. For now the matrix solver used is the LU decomposition method provided by the Gnu Scientific Library (G\+SL, which is free). This requires the include files that I\textquotesingle{}ve added to the top of this file and access to the G\+SL \char`\"{}library\char`\"{} file (I\textquotesingle{}ve added the library into the Makefile too). I found G\+SL to be very easy to install but if there are problems in the future we may need to switch to another matrix solver. (SS, Apr 04)

We also clean for population inversion in this routine.

The details are in Matthews\textquotesingle{} thesis. 

Definition at line 221 of file macro\+\_\+gov.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a590f1ed026cd692ac6f878ed6f359d5a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3dfc87517f580270c057d489688e7fcb}\label{templates_8h_a3dfc87517f580270c057d489688e7fcb}} 
\index{templates.\+h@{templates.\+h}!macro\+\_\+summary@{macro\+\_\+summary}}
\index{macro\+\_\+summary@{macro\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{macro\+\_\+summary()}{macro\_summary()}}
{\footnotesize\ttfamily int macro\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a0ddf1224851353fc92bfbff6f499fa97}\label{templates_8h_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{templates.\+h@{templates.\+h}!main@{main}}
\index{main@{main}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a62480c3fe99eaa0284c85a48b1e8427d}\label{templates_8h_a62480c3fe99eaa0284c85a48b1e8427d}} 
\index{templates.\+h@{templates.\+h}!make\+\_\+cdf\+\_\+randwind@{make\+\_\+cdf\+\_\+randwind}}
\index{make\+\_\+cdf\+\_\+randwind@{make\+\_\+cdf\+\_\+randwind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{make\+\_\+cdf\+\_\+randwind()}{make\_cdf\_randwind()}}
{\footnotesize\ttfamily int make\+\_\+cdf\+\_\+randwind (\begin{DoxyParamCaption}\item[{double}]{tau }\end{DoxyParamCaption})}



Definition at line 489 of file anisowind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a62480c3fe99eaa0284c85a48b1e8427d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a62480c3fe99eaa0284c85a48b1e8427d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abc2ad803345c801984f4dc64d4d4a9e0}\label{templates_8h_abc2ad803345c801984f4dc64d4d4a9e0}} 
\index{templates.\+h@{templates.\+h}!make\+\_\+spectra@{make\+\_\+spectra}}
\index{make\+\_\+spectra@{make\+\_\+spectra}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{make\+\_\+spectra()}{make\_spectra()}}
{\footnotesize\ttfamily int make\+\_\+spectra (\begin{DoxyParamCaption}\item[{int}]{restart\+\_\+stat }\end{DoxyParamCaption})}



generates the detailed spectra 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em int} & restart\+\_\+stat 0 if the is run is beginning from scratch, non-\/zero if this was a restart \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns E\+X\+I\+T\+\_\+\+S\+U\+C\+C\+E\+SS
\end{DoxyReturn}
This is the main routine for calculation detailed spectra in Python.

\paragraph*{Notes}

Definition at line 368 of file run.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abc2ad803345c801984f4dc64d4d4a9e0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9301eba8fb39302ef3da90cdb52aef4d}\label{templates_8h_a9301eba8fb39302ef3da90cdb52aef4d}} 
\index{templates.\+h@{templates.\+h}!matom@{matom}}
\index{matom@{matom}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{matom()}{matom()}}
{\footnotesize\ttfamily int matom (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nres,  }\item[{int $\ast$}]{escape }\end{DoxyParamCaption})}



The core of the implementation of Macro Atoms in python. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w the ptr to the structure defining the wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the packet at the point of activation and deactivation \\
\hline
\mbox{\tt in,out}  & {\em int} & nres the process which activates and deactivates the Macro Atom \\
\hline
\mbox{\tt in,out}  & {\em int} & escape to tell us whether the matom de-\/activation is via an r-\/packet (1) or a k-\/packet (0) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Matom is the core of the implementation of Leon Lucy\textquotesingle{}s Macro Atom approach to dealing with radiation-\/matter interactions. It is called whenever a photon packet activates a macro atom. As input it takes the process by which activation occurred (identified by the label \char`\"{}nres\char`\"{}) which allow it to deduce the level that has been excited. It then calculates all the Macro Atom jumping/deactivaion probabilities following Lucy and so deduces the process by which deactivation occurs. At output \char`\"{}nres\char`\"{} identifies this process and the packet information has been updated.

\paragraph*{Notes}

ksl-- There is a lot of arithmetic required to keep track of indices. I would be inclined to figure out a way to avoid this. One possibility would be to record the go\+\_\+to level in an array when one is calculating the emission probabilities. This would make it easier to add new processes, I suspect.

It would be possible to convert the for loop to a while statement. This would avoid the break statement in the middle.

History\+: Feb 04 SS Coding began. Mar 04 SS Minor changes made (based on comments from ksl) 04apr ksl A. Eliminated some unnecessary if statements. These are indicated by the words extra. Stuart should remove the lines assuming he agrees. B. Changed the logic of the major do loop so that the break is moved higher in the do loop. Stuart, the intent is to make the code more readable, and to reduce the level of nesting. C. Corrected an errror that on upward bb transitions seemed to leave the macro-\/atom in the same state as previously. D. Shamelessly modified some of the comments to make it more straightforward for me to understand. E. m = m + 1 --$>$ m++ in several places F. Modified selections to allow simple lines to be read in but not to affect matom. nlines\+\_\+macro is the number on macro-\/lines read in and these are the first elements in the line structure G. Modified the way matom determines that a transition is a photo ionization transition bo be consitent with change made in resonate. Apr 04 SS Modifications to include collisional jumps/deactivation included. May 04 SS Bug corrected for identification of line (nres is the place of the line in the O\+R\+D\+E\+R\+ED list, not the input list). Jun 04 SS Modified to carry the \char`\"{}escape\char`\"{} variable to identify de-\/activation via r-\/packets and k-\/packets -\/ avoids the need to call kpkt from within this routine Jun 04 SS Adding collisional ionization as an upwards jump possibility. No collisional recombination for the moment. Jun 04 SS Now putting in collisional recombination too. July04 SS Modifying so that this routine does not call alpha\+\_\+sp but rather uses pre-\/computed (stored values) for the spontaneous recombination coefficient. This is an effort to speed up the code. 06may ksl 57+ -- Adapted for use with plsama structure. Changed call to eliminate passing entire w array 06jun ksl 57g -- Split macro variables into a separate structure. The structue which is createdin gridwind, is only created if there are macroatoms. 06jul ksl 57h -- In the process of speeding up the program in the simple non-\/macro atom case, I tried to make sure that matom and the derivative routiens were not called at all. Note that at present the macroatom case is quite slow, due to what is happening in matom. I am suspicious that it could be speeded up a lot. 07jul SS Experimenting with retaining jumping/emission probabilities to save time. 

Definition at line 97 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9301eba8fb39302ef3da90cdb52aef4d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5fc061a271cdb55a6e05db67fafd504c}\label{templates_8h_a5fc061a271cdb55a6e05db67fafd504c}} 
\index{templates.\+h@{templates.\+h}!matom\+\_\+emiss\+\_\+report@{matom\+\_\+emiss\+\_\+report}}
\index{matom\+\_\+emiss\+\_\+report@{matom\+\_\+emiss\+\_\+report}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{matom\+\_\+emiss\+\_\+report()}{matom\_emiss\_report()}}
{\footnotesize\ttfamily int matom\+\_\+emiss\+\_\+report (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



a routine which reports the matom level and kpkt emissivities summed over all cells. It is called in \hyperlink{foo_8h_aa943bd857500a1f2937d8b97d84ff633}{define\+\_\+phot()} in the spectral cycles, after \hyperlink{foo_8h_ac8797bce5a5f3411f4162dff928b7920}{get\+\_\+matom\+\_\+f()} 

\begin{DoxyReturn}{Returns}
simply logs the level emissivites and kpkt emissivites in macro atom mode.
\end{DoxyReturn}
prints out the level emissivities in macro atoms, summed over each cell. Should only be used in macro atom mode in the spectral cycles (when geo.\+matom\+\_\+radiation = 1).

\paragraph*{Notes}

Definition at line 34 of file matom\+\_\+diag.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=311pt]{templates_8h_a5fc061a271cdb55a6e05db67fafd504c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac60407b8b44d5a57ec6c89122058dcf7}\label{templates_8h_ac60407b8b44d5a57ec6c89122058dcf7}} 
\index{templates.\+h@{templates.\+h}!matom\+\_\+emit\+\_\+in\+\_\+line\+\_\+prob@{matom\+\_\+emit\+\_\+in\+\_\+line\+\_\+prob}}
\index{matom\+\_\+emit\+\_\+in\+\_\+line\+\_\+prob@{matom\+\_\+emit\+\_\+in\+\_\+line\+\_\+prob}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{matom\+\_\+emit\+\_\+in\+\_\+line\+\_\+prob()}{matom\_emit\_in\_line\_prob()}}
{\footnotesize\ttfamily double matom\+\_\+emit\+\_\+in\+\_\+line\+\_\+prob (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr\+\_\+emit }\end{DoxyParamCaption})}



Prob. of cell emitting in a given line. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em one} & Pointer to cell of interest \\
\hline
\mbox{\tt in}  & {\em line\+\_\+ptr\+\_\+emit} & Pointer to line of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Probability of line emission
\end{DoxyReturn}
Given a cell and a line, calculates the probabiltiy that that cell will emit in that line.

\paragraph*{Notes}

6/15 -\/ Written by S\+WM 

Definition at line 1497 of file matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac60407b8b44d5a57ec6c89122058dcf7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1e569c92136f73f8643f20d8fb43f544}\label{templates_8h_a1e569c92136f73f8643f20d8fb43f544}} 
\index{templates.\+h@{templates.\+h}!matrix\+\_\+ion\+\_\+populations@{matrix\+\_\+ion\+\_\+populations}}
\index{matrix\+\_\+ion\+\_\+populations@{matrix\+\_\+ion\+\_\+populations}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{matrix\+\_\+ion\+\_\+populations()}{matrix\_ion\_populations()}}
{\footnotesize\ttfamily int matrix\+\_\+ion\+\_\+populations (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



A matrix solver for the ionization state in a cell. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} Plasma\+Ptr xplasma The plasma cell we are working on \\
\hline
{\em \mbox{[}in} & out\mbox{]} int mode What type of model to use for J\+\_\+nu -\/ 1=fitted model 2=blackbody \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
modes\+: 1 -\/ use a power law and or exponential model for J 2 -\/ use a dilute BB model for J defined by t\+\_\+r and w The general structure of matrix\+\_\+ion\+\_\+populations is as follows\+: First we compute all of the rates that we have data for linking all ionization stages We make an initial guess at the electron density We attempt to solve the ionization rates matrix, and produce a new guess at the electron density We then calculate new rates, re-\/solve and proceed until the electron density converges. We solve the matrix equation A x = b for the vector x, where A is a square rate matrix linking each state with each other state (often containing zeros if the ions arent linked) b is a vector containing the total density of each element arranged in a certain way (see later) and x is a vector containing the relative ion populations. We invert A to get x=b\+A$^\wedge$-\/1

\paragraph*{Notes}

Uses a relative abundance scheme -\/ reduces large number issues 

Definition at line 57 of file matrix\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1e569c92136f73f8643f20d8fb43f544_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0b0bdb47e266cd31f1c381bb2410fa80}\label{templates_8h_a0b0bdb47e266cd31f1c381bb2410fa80}} 
\index{templates.\+h@{templates.\+h}!mc\+\_\+estimator\+\_\+normalise@{mc\+\_\+estimator\+\_\+normalise}}
\index{mc\+\_\+estimator\+\_\+normalise@{mc\+\_\+estimator\+\_\+normalise}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{mc\+\_\+estimator\+\_\+normalise()}{mc\_estimator\_normalise()}}
{\footnotesize\ttfamily int mc\+\_\+estimator\+\_\+normalise (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



the routine to normalise the matom bb and bf estimators. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n the cell for which the normalisation is to be done \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
This routine normalises the bb and bf mc estimators needed for the macro atom jumping probabilities. During the main mc simulation these were stored unnormalised. They are now normalised and moved into the \char`\"{}old\char`\"{} slots for use in the next iteration. The current slots are reset to zero for use in the next iteration.

It is performed as part of the wind update stage of Python. The estimators should only be changed during the ionisation cycles -\/ after that they should be fixed. It also now computes the bf heating rate using the normalised estimators. heat\+\_\+tot and heat\+\_\+photo are incremented but nothing else is for now.

\paragraph*{Notes}

ksl -- This routine loops over nlte\+\_\+levels, which in principle could include non-\/macro ions, but that should not matter since nbfu\+\_\+jumps will be zero for these. 

Definition at line 427 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0b0bdb47e266cd31f1c381bb2410fa80_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a558bbf4d12656ab12c2a03f6475b0eee}\label{templates_8h_a558bbf4d12656ab12c2a03f6475b0eee}} 
\index{templates.\+h@{templates.\+h}!mdot\+\_\+wind@{mdot\+\_\+wind}}
\index{mdot\+\_\+wind@{mdot\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{mdot\+\_\+wind()}{mdot\_wind()}}
{\footnotesize\ttfamily int mdot\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{double}]{z,  }\item[{double}]{rmax }\end{DoxyParamCaption})}



Definition at line 1011 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a558bbf4d12656ab12c2a03f6475b0eee_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{templates_8h_a558bbf4d12656ab12c2a03f6475b0eee_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a687aa0dcc49f512e562c1e0afddc0263}\label{templates_8h_a687aa0dcc49f512e562c1e0afddc0263}} 
\index{templates.\+h@{templates.\+h}!mean\+\_\+intensity@{mean\+\_\+intensity}}
\index{mean\+\_\+intensity@{mean\+\_\+intensity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{mean\+\_\+intensity()}{mean\_intensity()}}
{\footnotesize\ttfamily double mean\+\_\+intensity (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{freq,  }\item[{int}]{mode }\end{DoxyParamCaption})}



returns a value for the mean intensity 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma Plasma\+Ptr for the cell -\/ supplies spectral model \\
\hline
\mbox{\tt in}  & {\em double} & freq the frequency at which we want to get a value of J \\
\hline
\mbox{\tt in}  & {\em int} & mode mode 1=use BB if we have not yet completed a cycle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The mean intensity at a specific frequency
\end{DoxyReturn}
This subroutine returns a value for the mean intensity J at a given frequency, using either a dilute blackbody model or a spectral model depending on the value of geo.\+ioniz\+\_\+mode. to avoid code duplication.

For ionization models that make use of the crude spectra accumulated in crude spectral bands, the routine uses these bands to get the mean intensity. If however, one is using one of the other (older) ionization modes, then the input variable mode drives how the mean intensity is calculated.\+mode appears to be used

\paragraph*{Notes}

This subroutine was produced when we started to use a spectral model to populate the upper state of a two level atom, as well as to calculate induced compton heating.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000047}{Bug}]The routine refers to a mode 5, which does not appear to exist, or at least it is not one that is included in \hyperlink{python_8h}{python.\+h} Note also that the logic of this appears overcomplicated, reflecting the evolution of banding, and various ionization modes being added without looking at trying to make this simpler.\end{DoxyRefDesc}


Definition at line 1263 of file radiation.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a687aa0dcc49f512e562c1e0afddc0263_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0413fc3066769f8cb8b90e8f6bbe2ba4}\label{templates_8h_a0413fc3066769f8cb8b90e8f6bbe2ba4}} 
\index{templates.\+h@{templates.\+h}!mo\+\_\+summary@{mo\+\_\+summary}}
\index{mo\+\_\+summary@{mo\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{mo\+\_\+summary()}{mo\_summary()}}
{\footnotesize\ttfamily int mo\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aff983708ba7fa4bd14428a0b5c39097c}\label{templates_8h_aff983708ba7fa4bd14428a0b5c39097c}} 
\index{templates.\+h@{templates.\+h}!model\+\_\+bands@{model\+\_\+bands}}
\index{model\+\_\+bands@{model\+\_\+bands}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{model\+\_\+bands()}{model\_bands()}}
{\footnotesize\ttfamily int model\+\_\+bands (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a3055ceed3869697bc2a3091fd0663900}\label{templates_8h_a3055ceed3869697bc2a3091fd0663900}} 
\index{templates.\+h@{templates.\+h}!model\+\_\+rho@{model\+\_\+rho}}
\index{model\+\_\+rho@{model\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{model\+\_\+rho()}{model\_rho()}}
{\footnotesize\ttfamily double model\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9ca1dd624c5f0c6c8a401a0e79d023b5}\label{templates_8h_a9ca1dd624c5f0c6c8a401a0e79d023b5}} 
\index{templates.\+h@{templates.\+h}!model\+\_\+velocity@{model\+\_\+velocity}}
\index{model\+\_\+velocity@{model\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{model\+\_\+velocity()}{model\_velocity()}}
{\footnotesize\ttfamily double model\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a547dbd45aa816e77d574b6bf3deb6b65}\label{templates_8h_a547dbd45aa816e77d574b6bf3deb6b65}} 
\index{templates.\+h@{templates.\+h}!model\+\_\+vgrad@{model\+\_\+vgrad}}
\index{model\+\_\+vgrad@{model\+\_\+vgrad}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{model\+\_\+vgrad()}{model\_vgrad()}}
{\footnotesize\ttfamily int model\+\_\+vgrad (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\+\_\+grad\mbox{[}$\,$\mbox{]}\mbox{[}3\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ab2e9d091ce799b56c0f3a9843989d383}\label{templates_8h_ab2e9d091ce799b56c0f3a9843989d383}} 
\index{templates.\+h@{templates.\+h}!modify\+\_\+te@{modify\+\_\+te}}
\index{modify\+\_\+te@{modify\+\_\+te}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{modify\+\_\+te()}{modify\_te()}}
{\footnotesize\ttfamily int modify\+\_\+te (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8f17a1e86112f24760862d998129d91c}\label{templates_8h_a8f17a1e86112f24760862d998129d91c}} 
\index{templates.\+h@{templates.\+h}!move\+\_\+phot@{move\+\_\+phot}}
\index{move\+\_\+phot@{move\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{move\+\_\+phot()}{move\_phot()}}
{\footnotesize\ttfamily int move\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{double}]{ds }\end{DoxyParamCaption})}



move a photon by a distance ds 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pp A photon bundle \\
\hline
\mbox{\tt in}  & {\em double} & ds The distance to move the photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine simply updates the position x of the photon using the current direction and the distance.

The path length for the photon is also updated for use in reverberation calculations

\paragraph*{Notes}

Definition at line 101 of file phot\+\_\+util.\+c.

\mbox{\Hypertarget{templates_8h_a63d5795e0b9978d33ed61a63917004e2}\label{templates_8h_a63d5795e0b9978d33ed61a63917004e2}} 
\index{templates.\+h@{templates.\+h}!nebular\+\_\+concentrations@{nebular\+\_\+concentrations}}
\index{nebular\+\_\+concentrations@{nebular\+\_\+concentrations}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{nebular\+\_\+concentrations()}{nebular\_concentrations()}}
{\footnotesize\ttfamily int nebular\+\_\+concentrations (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the Wind\+Ptr itself, such as t\+\_\+r, t\+\_\+e, w, based on the \char`\"{}mode\char`\"{}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A single plasma cell \\
\hline
\mbox{\tt in}  & {\em int} & mode A mode which describes which of the various ionization schemes to use \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status message (returned from the individual routines that calculate the ionization. 0 generally signifies success.
\end{DoxyReturn}
nebular concentrations serves as the steering routine for all ionization calculations.

\paragraph*{Notes}

Definition at line 51 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a63d5795e0b9978d33ed61a63917004e2_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a284000511485a77f13843b2019a77a01}\label{templates_8h_a284000511485a77f13843b2019a77a01}} 
\index{templates.\+h@{templates.\+h}!nphot\+\_\+summary@{nphot\+\_\+summary}}
\index{nphot\+\_\+summary@{nphot\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{nphot\+\_\+summary()}{nphot\_summary()}}
{\footnotesize\ttfamily int nphot\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aeae759ecb9918713caa2fe23a9aa2d53}\label{templates_8h_aeae759ecb9918713caa2fe23a9aa2d53}} 
\index{templates.\+h@{templates.\+h}!nscat\+\_\+split@{nscat\+\_\+split}}
\index{nscat\+\_\+split@{nscat\+\_\+split}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{nscat\+\_\+split()}{nscat\_split()}}
{\footnotesize\ttfamily int nscat\+\_\+split (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a7c21266df7327fbc81b2c5cf6b5e067f}\label{templates_8h_a7c21266df7327fbc81b2c5cf6b5e067f}} 
\index{templates.\+h@{templates.\+h}!num\+\_\+recomb@{num\+\_\+recomb}}
\index{num\+\_\+recomb@{num\+\_\+recomb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{num\+\_\+recomb()}{num\_recomb()}}
{\footnotesize\ttfamily int num\+\_\+recomb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the total number of recombinations for all of the ions in a cell 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The plasma cell of interest \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e The temperarture of interest \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch indicating whether one wants normal radiative recombination (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or dielectronic recombination (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) rates to be calculated. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0; the results are stored in xplasma-\/$>$recomb or xplasma-\/$>$inner\+\_\+recomb, depending on the mode
\end{DoxyReturn}
The routine calculates recombination rates for all the ions in a single cell. It stores the recombination rates in the arrays recomb (for normal recombination) or inner\+\_\+recomb (for dielectronic recombination)

\paragraph*{Notes}

The calculation is made purely direct recombination using the photoionization x-\/sections.

The units are \#/cm$\ast$$\ast$3/s 

Definition at line 738 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a7c21266df7327fbc81b2c5cf6b5e067f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=217pt]{templates_8h_a7c21266df7327fbc81b2c5cf6b5e067f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7b75986421190b20cefeca5ee6566be1}\label{templates_8h_a7b75986421190b20cefeca5ee6566be1}} 
\index{templates.\+h@{templates.\+h}!one\+\_\+choice@{one\+\_\+choice}}
\index{one\+\_\+choice@{one\+\_\+choice}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{one\+\_\+choice()}{one\_choice()}}
{\footnotesize\ttfamily int one\+\_\+choice (\begin{DoxyParamCaption}\item[{int}]{choice,  }\item[{char $\ast$}]{root,  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aca0d5b8835f560393ae64306e8f24ce3}\label{templates_8h_aca0d5b8835f560393ae64306e8f24ce3}} 
\index{templates.\+h@{templates.\+h}!one\+\_\+continuum@{one\+\_\+continuum}}
\index{one\+\_\+continuum@{one\+\_\+continuum}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{one\+\_\+continuum()}{one\_continuum()}}
{\footnotesize\ttfamily double one\+\_\+continuum (\begin{DoxyParamCaption}\item[{int}]{spectype,  }\item[{double}]{t,  }\item[{double}]{g,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



get a photon frequency from a grid of stored spectra from a continuum grid 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & spectype An index to the continum grid which one want got obtaining a photon \\
\hline
\mbox{\tt in}  & {\em double} & t The associated temperature (or first variable) defining the grid \\
\hline
\mbox{\tt in}  & {\em double} & g The associted gravity (or second variable) \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency desiered for a photon \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequecny for a photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A frequency for a photon
\end{DoxyReturn}
This is a routine that is used to select a function from a grid of spectra stored in the model structure. For the purpose of this routine, the model grid is assumed to be based on two variables t (temperature) and gravity (g). This reflects the fact that most of the grids used in Python to date (e.\+g Kurucz models) are these kinds of grids. The routine linearly interpolates on these to variables to produce a spectrum at the desired t and g. It then creates a coumulative distribution of the portion of the spectrum bewtween fmin and fmax and then uses a random number to obtain a frequncy for a single program.

The routine should already work for any grid.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000008}{Bug}]The model structure is general in the sense that it was intended for situation with any number of variables. However what is written here is specific to the case of two variables. This is a problem, as we have found in trying to use this in other situations. A more general routine is needed. The first step in doing this is to replace much of the code here with a call to the routine model (spectype, par) in models.\+c\end{DoxyRefDesc}


Definition at line 108 of file continuum.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aca0d5b8835f560393ae64306e8f24ce3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aca0d5b8835f560393ae64306e8f24ce3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1e3f4af5624039f9a4937939331b5219}\label{templates_8h_a1e3f4af5624039f9a4937939331b5219}} 
\index{templates.\+h@{templates.\+h}!one\+\_\+fb@{one\+\_\+fb}}
\index{one\+\_\+fb@{one\+\_\+fb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{one\+\_\+fb()}{one\_fb()}}
{\footnotesize\ttfamily double one\+\_\+fb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



generates one free bound photon with specific frequency limits 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one The wind cell in which the photon is being \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The frequency limits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The frequency of the fb photon that was generated.
\end{DoxyReturn}
\begin{DoxyVerb}Although the routine returns only a single photon, it stores more
that one for the same conditions. If the routine is called mulitiple
times from the same cell with the same frequency limits it will use the pre-
stored values.  This was intended to avoid the process of having to
generate cdfs multiple times
\end{DoxyVerb}


\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000049}{Bug}]This routine contains questions from Stuart in May 04 that have never been addressed. Furthemore, the routine has a parameter delta which is used to decide whether one is close enough in temperature to a previously generated D\+CF. This is set to 500, which is probably OK if the temperatures are high, but in appropriate if T is of order 1000 K.\end{DoxyRefDesc}


Definition at line 533 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1e3f4af5624039f9a4937939331b5219_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af59091ae76131213b5c23a085d88eb1d}\label{templates_8h_af59091ae76131213b5c23a085d88eb1d}} 
\index{templates.\+h@{templates.\+h}!one\+\_\+ff@{one\+\_\+ff}}
\index{one\+\_\+ff@{one\+\_\+ff}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{one\+\_\+ff()}{one\_ff()}}
{\footnotesize\ttfamily double one\+\_\+ff (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



randomly generate the frequency of a ff photon within the frequency interval f1 and f2 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one A specific wind cell \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A randomly geneted frequncy for a ff photon given the conditions specified
\end{DoxyReturn}
\paragraph*{Notes}

one is the windcell where the photon will be created. It is needed only for the temperature. The code would be simplified if simply the temperature were transmitted.

The routine creeates a cdf given the conditions specified and then samples this. When the routine is re-\/entered it checks if the conditions are the same as previously. Given this it is desirable to generate all of the photons in a single cell in one go. 

Definition at line 680 of file emission.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af59091ae76131213b5c23a085d88eb1d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af59091ae76131213b5c23a085d88eb1d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8a9a281cba993682e32c78c93f264f35}\label{templates_8h_a8a9a281cba993682e32c78c93f264f35}} 
\index{templates.\+h@{templates.\+h}!one\+\_\+line@{one\+\_\+line}}
\index{one\+\_\+line@{one\+\_\+line}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{one\+\_\+line()}{one\_line()}}
{\footnotesize\ttfamily double one\+\_\+line (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{int $\ast$}]{nres }\end{DoxyParamCaption})}



gets the frequency of a single collisionally excited line photon in a particular cell of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one The wind cell \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ nres The number associated with the transition \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The frequency of the transition
\end{DoxyReturn}
The routine geneerates a random number and uses this to select the transition that was excited

\paragraph*{Notes}

Definition at line 419 of file emission.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8a9a281cba993682e32c78c93f264f35_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8a9a281cba993682e32c78c93f264f35_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0c0fa3305df1f5c000e0ed0a26d413d8}\label{templates_8h_a0c0fa3305df1f5c000e0ed0a26d413d8}} 
\index{templates.\+h@{templates.\+h}!one\+\_\+shot@{one\+\_\+shot}}
\index{one\+\_\+shot@{one\+\_\+shot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{one\+\_\+shot()}{one\_shot()}}
{\footnotesize\ttfamily int one\+\_\+shot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates new densities of ions in a single element of the wind after (usually) having found the temperature which matches heating and cooling for the previous densities 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The plasma cell of interest \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch describing what approximation to use in determinging the densities \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine attempts to match heating and cooling in the wind element! To do this it calls calc\+\_\+te. Based on the returned value of te, the routine then calculates densities for various ions in the cell. The densities in xplasma are updated.

\paragraph*{Notes}

Special exceptions are made for Zeus; it is not clear why this is necessary

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000033}{Bug}]There are some numbered switches included here. This is because these values are not allowed anymore. But this needs to be cleaned up. Deactivated modes should be captured when the parameters are read in, not at this point. An else statement should provide a sufficent check for any unknown mode.\end{DoxyRefDesc}


Definition at line 358 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0c0fa3305df1f5c000e0ed0a26d413d8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{templates_8h_a0c0fa3305df1f5c000e0ed0a26d413d8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a029129746366e70434428ddf3bf2c54b}\label{templates_8h_a029129746366e70434428ddf3bf2c54b}} 
\index{templates.\+h@{templates.\+h}!overview@{overview}}
\index{overview@{overview}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{overview()}{overview()}}
{\footnotesize\ttfamily int overview (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a3579026b8eac7743ef56ad21ff9696ff}\label{templates_8h_a3579026b8eac7743ef56ad21ff9696ff}} 
\index{templates.\+h@{templates.\+h}!p\+\_\+escape@{p\+\_\+escape}}
\index{p\+\_\+escape@{p\+\_\+escape}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{p\+\_\+escape()}{p\_escape()}}
{\footnotesize\ttfamily double p\+\_\+escape (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



Estimate the esccapte probability for a line in a plasma cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & lines $\ast$ line\+\_\+ptr The element in the lines structure of a line \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma An element of the plasma structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The escape probability of the line in that plasma cell
\end{DoxyReturn}
Estimate the escape probability using the Sobolev approximation

\paragraph*{Notes}

Definition at line 773 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3579026b8eac7743ef56ad21ff9696ff_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3579026b8eac7743ef56ad21ff9696ff_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a07b4586a6bbe5e5633e165c6a9a55fb6}\label{templates_8h_a07b4586a6bbe5e5633e165c6a9a55fb6}} 
\index{templates.\+h@{templates.\+h}!p\+\_\+escape\+\_\+from\+\_\+tau@{p\+\_\+escape\+\_\+from\+\_\+tau}}
\index{p\+\_\+escape\+\_\+from\+\_\+tau@{p\+\_\+escape\+\_\+from\+\_\+tau}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{p\+\_\+escape\+\_\+from\+\_\+tau()}{p\_escape\_from\_tau()}}
{\footnotesize\ttfamily double p\+\_\+escape\+\_\+from\+\_\+tau (\begin{DoxyParamCaption}\item[{double}]{tau }\end{DoxyParamCaption})}



Given an optical depth estimate the escape probility. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & tau An optical depth \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The escape proability
\end{DoxyReturn}
p\+\_\+escape\+\_\+from\+\_\+tau calculates the probability of escape given an actual tau. It simple returns the equation

(1. -\/ exp (-\/tau)) / tau;

Except for high and low tau where it returns 1/tau and 1.\+0 respectively. This is used by p\+\_\+escape above, which calculates the sobolev escape probability, and also by the anisotropic scattering routines.

\paragraph*{Notes}

1408 JM Moved here to avoid code duplication 

Definition at line 857 of file lines.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a07b4586a6bbe5e5633e165c6a9a55fb6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa181995d7df5c31711c06ff2657f2f29}\label{templates_8h_aa181995d7df5c31711c06ff2657f2f29}} 
\index{templates.\+h@{templates.\+h}!parse\+\_\+command\+\_\+line@{parse\+\_\+command\+\_\+line}}
\index{parse\+\_\+command\+\_\+line@{parse\+\_\+command\+\_\+line}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{parse\+\_\+command\+\_\+line()}{parse\_command\_line()}}
{\footnotesize\ttfamily int parse\+\_\+command\+\_\+line (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a3d9d06afb63624f6bc6660c0bcd30057}\label{templates_8h_a3d9d06afb63624f6bc6660c0bcd30057}} 
\index{templates.\+h@{templates.\+h}!partial\+\_\+measure\+\_\+summary@{partial\+\_\+measure\+\_\+summary}}
\index{partial\+\_\+measure\+\_\+summary@{partial\+\_\+measure\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{partial\+\_\+measure\+\_\+summary()}{partial\_measure\_summary()}}
{\footnotesize\ttfamily int partial\+\_\+measure\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{element,  }\item[{int}]{istate,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a37c9b91e3450874eb15cef76079f344d}\label{templates_8h_a37c9b91e3450874eb15cef76079f344d}} 
\index{templates.\+h@{templates.\+h}!partition\+\_\+functions@{partition\+\_\+functions}}
\index{partition\+\_\+functions@{partition\+\_\+functions}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{partition\+\_\+functions()}{partition\_functions()}}
{\footnotesize\ttfamily int partition\+\_\+functions (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the partition functions for a single cell in the grid (and then calls a routine that calculates the level populations 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma A plasma cell in the wind \\
\hline
\mbox{\tt in}  & {\em int} & mode An integer which determines the way in which the partition funciton will be calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The possibilites are\+:
\begin{DoxyItemize}
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TR 0 L\+TE using t\+\_\+r
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+TE 1 L\+TE using t\+\_\+e
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+M\+L93 2 M\+L93 using a nebular approximation correction to L\+TE
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+N\+L\+T\+E\+\_\+\+S\+IM 3 // Non\+\_\+\+L\+TE with SS modification (Probably could be removed)
\item N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+L\+T\+E\+\_\+\+G\+R\+O\+U\+ND 4 // A mode which forces all levels to the GS -\/ this is used when we are modelling J\+\_\+nu.
\end{DoxyItemize}

\paragraph*{Notes}

0800802 -\/ This is a rewritten version of two routines, do\+\_\+partitions and partition. It is still true that levels is almost identical to some of the code here and therefore it is unclear why it is needed. levels is always called from partition\+\_\+functions 

Definition at line 109 of file partition.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a37c9b91e3450874eb15cef76079f344d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2de3c1f3e0adc389cfda580a1003a688}\label{templates_8h_a2de3c1f3e0adc389cfda580a1003a688}} 
\index{templates.\+h@{templates.\+h}!partition\+\_\+functions\+\_\+2@{partition\+\_\+functions\+\_\+2}}
\index{partition\+\_\+functions\+\_\+2@{partition\+\_\+functions\+\_\+2}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{partition\+\_\+functions\+\_\+2()}{partition\_functions\_2()}}
{\footnotesize\ttfamily int partition\+\_\+functions\+\_\+2 (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{xnion,  }\item[{double}]{temp,  }\item[{double}]{weight }\end{DoxyParamCaption})}



calculates the partition functions for a pair of ions at a given temperature. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma -\/ the cell we are interested in. Used to communicate back \\
\hline
\mbox{\tt in}  & {\em int} & xnion The ion number for the upper ion of a pair \\
\hline
\mbox{\tt in}  & {\em double} & temp the temperature we are using for the saha equation. \\
\hline
\mbox{\tt in}  & {\em double} & weight The ratio of the intensity of the radiation field to that of a BB \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
changes the partition functions of just two ions we are currently working on
\end{DoxyReturn}
\begin{DoxyVerb}This routine is used 
to support the pairwise ioinization state calculations where 
the saha equation is applied to a pair of states at a
temperature, then corrected. Part of this is 
a requirement to get the partition functions at that 
temperature for just two states of interest. It is 
wasteful to calculate all of the states at each temperature.

The results are stored in xplasma->partition[nion]
\end{DoxyVerb}


\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000039}{Bug}]According to the historical notes, there is no need for the weight term in the calculation since this is only called when we are making the assumption that we are in L\+TE for the saha equation.\end{DoxyRefDesc}


One of the ways in which this routine differs from partition\+\_\+functions is that here the temperature and weight are passed to the routing directly instead of being taken from the Plasma structure. 

Definition at line 299 of file partition.\+c.

\mbox{\Hypertarget{templates_8h_a4a0210aea098f52ca60dfbc90de4ecee}\label{templates_8h_a4a0210aea098f52ca60dfbc90de4ecee}} 
\index{templates.\+h@{templates.\+h}!phi@{phi}}
\index{phi@{phi}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{phi()}{phi()}}
{\footnotesize\ttfamily double phi (\begin{DoxyParamCaption}\item[{double}]{s }\end{DoxyParamCaption})}



Calculate the Roche potential at position indicated by the photon p\+\_\+roche and the length s. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance from the current position of the photon to the point where one wishes to calculate the Roche potentail \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Roche potential at the postiong given by the photon moved by a distance s
\end{DoxyReturn}
Given a photon stored in p\+\_\+roche and a distance s to move the photone, phi returns the roche potentail at that point

\paragraph*{Notes}

Definition at line 457 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=199pt]{templates_8h_a4a0210aea098f52ca60dfbc90de4ecee_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4a0210aea098f52ca60dfbc90de4ecee_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8b4486eb9a59ffa30a219586ef94b56c}\label{templates_8h_a8b4486eb9a59ffa30a219586ef94b56c}} 
\index{templates.\+h@{templates.\+h}!phot\+\_\+gen\+\_\+sum@{phot\+\_\+gen\+\_\+sum}}
\index{phot\+\_\+gen\+\_\+sum@{phot\+\_\+gen\+\_\+sum}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{phot\+\_\+gen\+\_\+sum()}{phot\_gen\_sum()}}
{\footnotesize\ttfamily int phot\+\_\+gen\+\_\+sum (\begin{DoxyParamCaption}\item[{char}]{filename\mbox{[}$\,$\mbox{]},  }\item[{char}]{mode\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a56bcc4eb80e38e626fe58bb5c989eafd}\label{templates_8h_a56bcc4eb80e38e626fe58bb5c989eafd}} 
\index{templates.\+h@{templates.\+h}!phot\+\_\+hist@{phot\+\_\+hist}}
\index{phot\+\_\+hist@{phot\+\_\+hist}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{phot\+\_\+hist()}{phot\_hist()}}
{\footnotesize\ttfamily int phot\+\_\+hist (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{iswitch }\end{DoxyParamCaption})}



Record the history of a single photon bundle, in terms of a series of photon structures that are populated as the photon goes through the grid. 

Unless phot\+\_\+hist\+\_\+on is true, then this routine is a N\+OP


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A photon to track \\
\hline
\mbox{\tt in,out}  & {\em int} & iswitch A switch that resets \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the number of photons which have been stored
\end{DoxyReturn}
This routine stores selected photons in an array, which one can use to see what is happening in a special case.

This is a diagnostic routine only

\paragraph*{Notes}

The routine is useful (at present) only in the context of a debugger since the array in which photons are stored is not written out. The basic idea is that one identifies a problem say with a specific photon and then stores the history of that photon in the array so once can inspect in detail what has happened to the photon.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000040}{Bug}]It is not obvious that this routine is needed as we now have another mechanism to write photons out to a file. In any event, this should be moved to some other place in the code.\end{DoxyRefDesc}


Definition at line 207 of file phot\+\_\+util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a56bcc4eb80e38e626fe58bb5c989eafd_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac53d695fcce14d5ae685028c7e7280ce}\label{templates_8h_ac53d695fcce14d5ae685028c7e7280ce}} 
\index{templates.\+h@{templates.\+h}!phot\+\_\+history\+\_\+summarize@{phot\+\_\+history\+\_\+summarize}}
\index{phot\+\_\+history\+\_\+summarize@{phot\+\_\+history\+\_\+summarize}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{phot\+\_\+history\+\_\+summarize()}{phot\_history\_summarize()}}
{\footnotesize\ttfamily int phot\+\_\+history\+\_\+summarize (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



The next routine is designed to update a portion of the Plasma\+Ptr to reflect where photons along the line of sight to the observer were absorbed in the wind. 

$<$N\+O\+TE\+: The \mbox{[}in, out\mbox{]} tag describes if the value of a parameter is used or altered. If it is used but not altered, delete \textquotesingle{}O\+UT\textquotesingle{}. If the original value is not used and it is written to, delete \textquotesingle{}IN\textquotesingle{}.$>$ \begin{DoxyReturn}{Returns}
??? R\+E\+T\+U\+R\+NS ???
\end{DoxyReturn}
??? D\+E\+S\+C\+R\+I\+P\+T\+I\+ON ???

\paragraph*{Notes}

As photon is extracted from the wind, tau changes due to scatters and w changes due to absorption. We are just recording how much energy is absorbed by scatterng processes here, and so the energy absorbed is the current weight (exp(-\/tau\+\_\+before) -\/ exp (-\/tau\+\_\+after)) 

Definition at line 278 of file phot\+\_\+util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac53d695fcce14d5ae685028c7e7280ce_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a48d3738f0439bd8c0cf75be5914acfc3}\label{templates_8h_a48d3738f0439bd8c0cf75be5914acfc3}} 
\index{templates.\+h@{templates.\+h}!phot\+\_\+split@{phot\+\_\+split}}
\index{phot\+\_\+split@{phot\+\_\+split}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{phot\+\_\+split()}{phot\_split()}}
{\footnotesize\ttfamily int phot\+\_\+split (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10}\label{templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10}} 
\index{templates.\+h@{templates.\+h}!photo\+\_\+gen\+\_\+agn@{photo\+\_\+gen\+\_\+agn}}
\index{photo\+\_\+gen\+\_\+agn@{photo\+\_\+gen\+\_\+agn}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+agn()}{photo\_gen\_agn()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+agn (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{r,  }\item[{double}]{alpha,  }\item[{double}]{weight,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{spectype,  }\item[{int}]{istart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



Generate a photon from an A\+GN object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p pointer to the photon array \\
\hline
\mbox{\tt in,out}  & {\em double} & r radius of the central source \\
\hline
\mbox{\tt in,out}  & {\em double} & alpha spectral index of the PL sourece -\/ also used to communicate temperature if a BB or model is used. \\
\hline
\mbox{\tt in,out}  & {\em double} & weight the weight of each photon to be made \\
\hline
\mbox{\tt in,out}  & {\em double} & f1 lower frequency bound \\
\hline
\mbox{\tt in,out}  & {\em double} & f2 upper frequency nound \\
\hline
\mbox{\tt in,out}  & {\em int} & spectype the type of S\+ED \\
\hline
\mbox{\tt in,out}  & {\em int} & istart the number of the first photon to be made -\/ index into the p array \\
\hline
\mbox{\tt in,out}  & {\em int} & nphot the number of photons to be made \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 (if successful or unscuccessful)
\end{DoxyReturn}
This subroutine produces photons from an A\+GN type source. There are a range of different S\+E\+Ds that can be used, these are communicated by the spectype and different choices cause different surbroutines to be called. The only {\itshape real} work done here is to compute the strarting location and direction of the photons.

\paragraph*{Notes}

Definition at line 374 of file agn.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{templates_8h_a82dbda6e94577f3ecd6e55c085f2aa10_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac6e59fd8ed9979322e86a14ed34c2851}\label{templates_8h_ac6e59fd8ed9979322e86a14ed34c2851}} 
\index{templates.\+h@{templates.\+h}!photo\+\_\+gen\+\_\+disk@{photo\+\_\+gen\+\_\+disk}}
\index{photo\+\_\+gen\+\_\+disk@{photo\+\_\+gen\+\_\+disk}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+disk()}{photo\_gen\_disk()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+disk (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{weight,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{spectype,  }\item[{int}]{istart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



Generate disk photons. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Phot\+Ptr} & p The entire photon structure \\
\hline
\mbox{\tt in}  & {\em double} & weight The weight of photons to generate \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maxnimum frequency \\
\hline
\mbox{\tt in}  & {\em int} & spectype The spectrum type to generate\+: 0 is bb \\
\hline
\mbox{\tt in}  & {\em int} & istart The starting point in p for generating photons \\
\hline
\mbox{\tt in}  & {\em int} & nphot The number of photons to generate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

Definition at line 1019 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac6e59fd8ed9979322e86a14ed34c2851_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{templates_8h_ac6e59fd8ed9979322e86a14ed34c2851_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4541dc581678aaea94bb9bdf0d38dfcf}\label{templates_8h_a4541dc581678aaea94bb9bdf0d38dfcf}} 
\index{templates.\+h@{templates.\+h}!photo\+\_\+gen\+\_\+kpkt@{photo\+\_\+gen\+\_\+kpkt}}
\index{photo\+\_\+gen\+\_\+kpkt@{photo\+\_\+gen\+\_\+kpkt}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+kpkt()}{photo\_gen\_kpkt()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+kpkt (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{weight,  }\item[{int}]{photstart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



produces photon packets to account for creating of r-\/packets by k-\/packets in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the ptr to the entire structure for the photons \\
\hline
\mbox{\tt in}  & {\em double} & weight the photon weight \\
\hline
\mbox{\tt in}  & {\em int} & photstart The first element of the photon stucure to be populated \\
\hline
\mbox{\tt in}  & {\em int} & nphot the number of photons to be generated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int nphot When it finishes it should have generated nphot photons from k-\/packet elliminations.
\end{DoxyReturn}
This routine is closely related to photo\+\_\+gen\+\_\+wind from which much of the code has been copied. 

Definition at line 477 of file photo\+\_\+gen\+\_\+matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4541dc581678aaea94bb9bdf0d38dfcf_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7248f385000ac034fb3f0e3d5f45298f}\label{templates_8h_a7248f385000ac034fb3f0e3d5f45298f}} 
\index{templates.\+h@{templates.\+h}!photo\+\_\+gen\+\_\+matom@{photo\+\_\+gen\+\_\+matom}}
\index{photo\+\_\+gen\+\_\+matom@{photo\+\_\+gen\+\_\+matom}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+matom()}{photo\_gen\_matom()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+matom (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{weight,  }\item[{int}]{photstart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



produces photon packets to account for creation of r-\/packets by deactivation of macro atoms in the spectrum calculation. It should only be used once the total energy emitted in this way in the wavelength range in question is well known (calculated in the ionization cycles). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the ptr to the structire for the photons \\
\hline
\mbox{\tt in}  & {\em double} & weight the photon weight \\
\hline
\mbox{\tt in}  & {\em int} & photstart The position in the photon structure of the first photon to generate \\
\hline
\mbox{\tt in}  & {\em int} & nphot the number of the photons to be generated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int nphot When it finishes it should have generated nphot photons from macro atom deactivations.
\end{DoxyReturn}
This routine is closely related to photo\+\_\+gen\+\_\+kpkt from which much of the code has been copied.

\paragraph*{Notes}

Consult Matthews thesis. 

Definition at line 645 of file photo\+\_\+gen\+\_\+matom.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a7248f385000ac034fb3f0e3d5f45298f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a19e1b27b1fe040ccadcd39a5783c4d60}\label{templates_8h_a19e1b27b1fe040ccadcd39a5783c4d60}} 
\index{templates.\+h@{templates.\+h}!photo\+\_\+gen\+\_\+star@{photo\+\_\+gen\+\_\+star}}
\index{photo\+\_\+gen\+\_\+star@{photo\+\_\+gen\+\_\+star}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+star()}{photo\_gen\_star()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+star (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{r,  }\item[{double}]{t,  }\item[{double}]{weight,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{spectype,  }\item[{int}]{istart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



Generate nphot photons from the star in the frequency interval f1 to f2. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Phot\+Ptr} & p The entire photon structure \\
\hline
\mbox{\tt in}  & {\em double} & r The radiius at which to generate photons \\
\hline
\mbox{\tt in}  & {\em double} & t The effective temperature of the stat \\
\hline
\mbox{\tt in}  & {\em double} & weight The weight of photons to generate \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequencey \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequencey \\
\hline
\mbox{\tt in}  & {\em int} & spectype The type of spectrum (bb or spectral model) to use in generating photons \\
\hline
\mbox{\tt in}  & {\em int} & istart The positions in the photon structure where the first photons will be stored \\
\hline
\mbox{\tt in}  & {\em int} & nphot The nubmer of photons to generate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine generates photons emergying from a sphere. It uses randvcos to determine the direction of the photon.

\paragraph*{Notes}

This routine is also used in generating photons from a boundary layer

The routine allows for the possibility that part of the star will be covered by a vertically extended disk and avoids generating photons there. 

Definition at line 722 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a19e1b27b1fe040ccadcd39a5783c4d60_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{templates_8h_a19e1b27b1fe040ccadcd39a5783c4d60_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5b9038968dd801ac73806fcc16fc1f0c}\label{templates_8h_a5b9038968dd801ac73806fcc16fc1f0c}} 
\index{templates.\+h@{templates.\+h}!photo\+\_\+gen\+\_\+wind@{photo\+\_\+gen\+\_\+wind}}
\index{photo\+\_\+gen\+\_\+wind@{photo\+\_\+gen\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+gen\+\_\+wind()}{photo\_gen\_wind()}}
{\footnotesize\ttfamily int photo\+\_\+gen\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{weight,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{int}]{photstart,  }\item[{int}]{nphot }\end{DoxyParamCaption})}



generates photons within the wind between two freqencies and stores them in the photon array 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Phot\+Ptr} & p The entire photon stucture \\
\hline
\mbox{\tt in}  & {\em double} & weight weight of each photon to be generated \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & photstart The place in the photon stucture where the first photon will be stored \\
\hline
\mbox{\tt in}  & {\em int} & nphot The number of photon bundles to generate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns the number of photons created.
\end{DoxyReturn}
When the routine is completed new photons will exist from p\mbox{[}istart\mbox{]} to p\mbox{[}istart+return value\mbox{]}.

The routine first generates a random number which is used to determine in which wind cell should be generated, and then determines the type of photon to generate. Once this is doen the routine cycles thourhg the Plasma\+Cells generatating all of the photons for each cell at once.

\paragraph*{Notes}

This logic was adopted for speed related reasons.

If photo\+\_\+gen\+\_\+wind tries to create more photons than exist in the photon structure the program will stop (rather than continue incorrectly or start blasting away memory.)

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000022}{Bug}]This is another example where the iteration might be made over plasma cells instead of looking for wind cells with positive volume \end{DoxyRefDesc}


Definition at line 213 of file emission.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a5b9038968dd801ac73806fcc16fc1f0c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{templates_8h_a5b9038968dd801ac73806fcc16fc1f0c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae93657d141864bdb95912c5e37df8c0c}\label{templates_8h_ae93657d141864bdb95912c5e37df8c0c}} 
\index{templates.\+h@{templates.\+h}!photo\+\_\+summary@{photo\+\_\+summary}}
\index{photo\+\_\+summary@{photo\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photo\+\_\+summary()}{photo\_summary()}}
{\footnotesize\ttfamily int photo\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a663f46d36d6962c7993e4c002442c23b}\label{templates_8h_a663f46d36d6962c7993e4c002442c23b}} 
\index{templates.\+h@{templates.\+h}!photon\+\_\+checks@{photon\+\_\+checks}}
\index{photon\+\_\+checks@{photon\+\_\+checks}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{photon\+\_\+checks()}{photon\_checks()}}
{\footnotesize\ttfamily int photon\+\_\+checks (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{char $\ast$}]{comment }\end{DoxyParamCaption})}



Perform some simple checks on the photon distribution just produced. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p The photon structure \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The minimum fequency that was used to generate the photons \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum fequency that was used to generate the photons \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ comment A comment that accompanies this particular call \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine checks photons to see if they are \char`\"{}reasonable\char`\"{}. The checks mostly have to do with the frequency of the photons. The program will exit is too many photons fail the checks

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000046}{Bug}]The routine also a few numbers that summarize some aspects of the the distribution. Some of these have to do with the Ferland definition of IP, which we are discussing deleting\end{DoxyRefDesc}


Definition at line 1286 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a663f46d36d6962c7993e4c002442c23b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7f409d6ca8a15c6c341fdb1853104685}\label{templates_8h_a7f409d6ca8a15c6c341fdb1853104685}} 
\index{templates.\+h@{templates.\+h}!pi\+\_\+correct@{pi\+\_\+correct}}
\index{pi\+\_\+correct@{pi\+\_\+correct}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{pi\+\_\+correct()}{pi\_correct()}}
{\footnotesize\ttfamily double pi\+\_\+correct (\begin{DoxyParamCaption}\item[{double}]{xtemp,  }\item[{int}]{nion,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the photoionization rate correction factor for the number density of two adjacent ions 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & xtemp the temperature at which the saha abundances were calculated \\
\hline
\mbox{\tt in}  & {\em int} & nion number of the upper ion in the pair for which the correction factor is \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The cell currnently under test -\/ this supplied the code with \\
\hline
\mbox{\tt in}  & {\em int} & mode This is the ionization mode, which should be either I\+O\+N\+M\+O\+D\+E\+\_\+\+P\+A\+I\+R\+W\+I\+S\+E\+\_\+\+M\+L93 (6) or I\+O\+N\+M\+O\+D\+E\+\_\+\+P\+A\+I\+R\+W\+I\+S\+E\+\_\+\+S\+P\+E\+C\+T\+R\+A\+L\+M\+O\+D\+EL (7) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the photoionization rate correction factor
\end{DoxyReturn}
In I\+O\+N\+M\+O\+D\+E\+\_\+\+P\+A\+I\+R\+W\+I\+S\+E\+\_\+\+M\+L93, the correction factor is calculated assuming a dilute BB function. In I\+O\+N\+M\+O\+D\+E\+\_\+\+P\+A\+I\+R\+W\+I\+S\+E\+\_\+\+S\+P\+E\+C\+T\+R\+A\+L\+M\+O\+D\+EL the factor is calculated using a piecewise power law or exponentila function.

\paragraph*{Notes}

LM is a special case of this where the temperatures are the same. 

Definition at line 446 of file variable\+\_\+temperature.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=222pt]{templates_8h_a7f409d6ca8a15c6c341fdb1853104685_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a7f409d6ca8a15c6c341fdb1853104685_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3a6359a23f10596d6bb51c80905c1c88}\label{templates_8h_a3a6359a23f10596d6bb51c80905c1c88}} 
\index{templates.\+h@{templates.\+h}!pillbox@{pillbox}}
\index{pillbox@{pillbox}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{pillbox()}{pillbox()}}
{\footnotesize\ttfamily double pillbox (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double $\ast$}]{smin,  }\item[{double $\ast$}]{smax }\end{DoxyParamCaption})}



Find out whether the photon hits the pillbox which surrounds the Roche surface of the secondary. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p The photon whose trajectory we wish to examine \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ smin If the photon, hits the pillbox, this is how far the photon must travel to enter the pillbox \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ smax If the photon, hits the pillbox, this is how far the photon must travel to exit the pillbox \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pillbox returns V\+E\+R\+Y\+\_\+\+B\+IG if the photon p has not intersected the pillbox. It appears to return the distance to the pillbox if the photon p hits the pillbox. smin and smax contain the entrance and exit distances. It is not obvious that smin $<$ smax.
\end{DoxyReturn}
The purpose of this routine is to separate photons which may hit the Roche surface and those which certainly do not by seeing if the photon avoids a pillbox surrounding the secondary. If the photons does not enter the pillbox then one dos not have to explore in detail whether the photon hits the Roche surrvace.

If the photon does pass through the secondary, then the routine returns the distances of entry and exit which are used to limit the range of root finding that then must take place.

\paragraph*{Notes}

The pillbox is defined by a plane at L1, a plane on the backside of the star and a cylinder whose radius is the maximum (half) width of the star in the plane of the orbit.

This routine distinguishes two basic types of photons, \char`\"{}normal\char`\"{} and \char`\"{}abnormal\char`\"{} photons. A normal photon is on the WD side of L1 plane; an abnormal one is on the side of the L1 plane with the secondary.

Note\+: 01jul22 ksl revised this so that it would handle photons coming in all directions for use with plot\+\_\+roche but this instantiation of pillbox still seems to me not optical. The basic point is that unless the photon is in the pillbox, the only roots that matter are ones which are positive. Only inside the pillbox will there be a positive and a negative root. Here we try to correct this at the end by making sure that both roots are not negative, but one would have thought that one might establish that that photons inside the pillbox are special and dealt with them accordindly 

Definition at line 323 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3a6359a23f10596d6bb51c80905c1c88_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{templates_8h_a3a6359a23f10596d6bb51c80905c1c88_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5c555bf81b13fcd5357bda01781ea3bc}\label{templates_8h_a5c555bf81b13fcd5357bda01781ea3bc}} 
\index{templates.\+h@{templates.\+h}!pl\+\_\+alpha\+\_\+func\+\_\+log@{pl\+\_\+alpha\+\_\+func\+\_\+log}}
\index{pl\+\_\+alpha\+\_\+func\+\_\+log@{pl\+\_\+alpha\+\_\+func\+\_\+log}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+alpha\+\_\+func\+\_\+log()}{pl\_alpha\_func\_log()}}
{\footnotesize\ttfamily double pl\+\_\+alpha\+\_\+func\+\_\+log (\begin{DoxyParamCaption}\item[{double}]{alpha }\end{DoxyParamCaption})}



Function used in zbrent to work out best value of alpha for a power law model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha -\/ the exponent of a power law model for J\+\_\+nu \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Difference between the mean of a modelled photon spectrum and the observed one
\end{DoxyReturn}
The function is just subtracts the \textquotesingle{}observed\textquotesingle{} mean frequency of the photons which passed thruogh as cell from thr mean frequency of a power law spectral model (which is computed externally). This is used in a zero finding function to work out the best value of alpha.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 361 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=319pt]{templates_8h_a5c555bf81b13fcd5357bda01781ea3bc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=275pt]{templates_8h_a5c555bf81b13fcd5357bda01781ea3bc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a29985eb821f4ce1d32c191926b84fe59}\label{templates_8h_a29985eb821f4ce1d32c191926b84fe59}} 
\index{templates.\+h@{templates.\+h}!pl\+\_\+log\+\_\+stddev@{pl\+\_\+log\+\_\+stddev}}
\index{pl\+\_\+log\+\_\+stddev@{pl\+\_\+log\+\_\+stddev}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+log\+\_\+stddev()}{pl\_log\_stddev()}}
{\footnotesize\ttfamily double pl\+\_\+log\+\_\+stddev (\begin{DoxyParamCaption}\item[{double}]{alpha,  }\item[{double}]{lnumin,  }\item[{double}]{lnumax }\end{DoxyParamCaption})}



Work out the standard deviation of a power law spectral model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha The exponent of the power law representation \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The standard deviation
\end{DoxyReturn}
This subroutine works out the standard deviation of a photon distribution modelled by a power law. First we work out the integral of nu$^\wedge$2 jnu / int jnu. Then we subtract the (mean/j)$^\wedge$2 and then take the square root.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 470 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{templates_8h_a29985eb821f4ce1d32c191926b84fe59_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{templates_8h_a29985eb821f4ce1d32c191926b84fe59_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abba07de067655328106ec96798c4794d}\label{templates_8h_abba07de067655328106ec96798c4794d}} 
\index{templates.\+h@{templates.\+h}!pl\+\_\+log\+\_\+w@{pl\+\_\+log\+\_\+w}}
\index{pl\+\_\+log\+\_\+w@{pl\+\_\+log\+\_\+w}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+log\+\_\+w()}{pl\_log\_w()}}
{\footnotesize\ttfamily double pl\+\_\+log\+\_\+w (\begin{DoxyParamCaption}\item[{double}]{j,  }\item[{double}]{alpha,  }\item[{double}]{lnumin,  }\item[{double}]{lnumax }\end{DoxyParamCaption})}



works out the scaling factor for a power law representation of a cell spectrum 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & j The \textquotesingle{}measured\textquotesingle{} mean intensity for a cell/band \\
\hline
\mbox{\tt in}  & {\em double} & alpha The exponent of the power law representation \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Band lower frequency limit \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Band upper frequency limit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
logw -\/ the log of the scaling factor
\end{DoxyReturn}
This routine works out the scaling factor for a power law representation of a spectrum in a cell -\/ the W in J\+\_\+nu=Wnu$\ast$$\ast$alpha. Assuming alpha is known, it computes w for J=W x integral from numin to numax of nu$^\wedge$alpha. For a power law model, the integral is easily done numercially. We work in log space to allow huge numbers to work and not give errors.

\paragraph*{Notes}

Definition at line 432 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{templates_8h_abba07de067655328106ec96798c4794d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{templates_8h_abba07de067655328106ec96798c4794d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1df982c704d2defe2182934f2ab66b70}\label{templates_8h_a1df982c704d2defe2182934f2ab66b70}} 
\index{templates.\+h@{templates.\+h}!pl\+\_\+logmean@{pl\+\_\+logmean}}
\index{pl\+\_\+logmean@{pl\+\_\+logmean}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{pl\+\_\+logmean()}{pl\_logmean()}}
{\footnotesize\ttfamily double pl\+\_\+logmean (\begin{DoxyParamCaption}\item[{double}]{alpha,  }\item[{double}]{lnumin,  }\item[{double}]{lnumax }\end{DoxyParamCaption})}



Computes the mean frequency of a power law with exponent alpha. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha The exponent of the power law \\
\hline
\mbox{\tt in}  & {\em double} & lnumin Miniumum frequency \\
\hline
\mbox{\tt in}  & {\em double} & lnumax Maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the mean frequency
\end{DoxyReturn}
This function computes the mean frequency of a power law disturbution. It is essentially a ratio of two integrals (nu\+Jnu) / (Jnu) For a power law this can be done algegraically, so we do that

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 390 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{templates_8h_a1df982c704d2defe2182934f2ab66b70_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1df982c704d2defe2182934f2ab66b70_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5f832b1ef434fdb41eaa62feb7edd710}\label{templates_8h_a5f832b1ef434fdb41eaa62feb7edd710}} 
\index{templates.\+h@{templates.\+h}!planck@{planck}}
\index{planck@{planck}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{planck()}{planck()}}
{\footnotesize\ttfamily double planck (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



returns the frequency for a photon which follows a Placnk distribution within defined frequncy limits 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperature of the bb \\
\hline
\mbox{\tt in}  & {\em double} & freqmin The minimum frequency for the photon \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum frequency for the photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The frequency drawn randomly from a BB function with temperature T
\end{DoxyReturn}
The frequency is pseudo random in the following limited sense. The photons are returned are weighted so that the energy distribution of a function is approximately reproduced. Within an energy bin the photon frequency is uniform.

\paragraph*{Notes}

The first time one enters the program, a cdf for a diminensionless BB function is createda. The cdf is created for values between A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX where A\+L\+P\+HA=h nu/kT. The number of points in the cdf is determined by N\+M\+AX

On subseqent entries, when the temperature or frequency limits are changed, we use standard routines to limit what portion of the dimensionless cdf to use.

If the freuency range and temperature for a photon falls outside of A\+L\+P\+H\+A\+M\+IN and A\+L\+P\+H\+A\+M\+AX special routines are used to sample the distribution there. so that the spectrum falls off as a power law at low frequencies and an exponential at high frequencies. 

Definition at line 109 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a5f832b1ef434fdb41eaa62feb7edd710_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a5f832b1ef434fdb41eaa62feb7edd710_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad6196c3c4ec0bdeda06aa797af259d81}\label{templates_8h_ad6196c3c4ec0bdeda06aa797af259d81}} 
\index{templates.\+h@{templates.\+h}!planck\+\_\+d@{planck\+\_\+d}}
\index{planck\+\_\+d@{planck\+\_\+d}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{planck\+\_\+d()}{planck\_d()}}
{\footnotesize\ttfamily double planck\+\_\+d (\begin{DoxyParamCaption}\item[{double}]{alpha }\end{DoxyParamCaption})}



The value of the dimensioless BB function at alpha. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & alpha \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the dimensionless BB function at x
\end{DoxyReturn}
The BB emittence is given by

F\+\_\+nu= 2$\ast$\+P\+I$\ast$ (k\+T/h$\ast$$\ast$3)$\ast$planck\+\_\+d(h$\ast$freq/ k T)

alpha is simply h nu/kT

\paragraph*{Notes}

Definition at line 534 of file bb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=198pt]{templates_8h_ad6196c3c4ec0bdeda06aa797af259d81_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad6196c3c4ec0bdeda06aa797af259d81_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9819dcbdbc4776804bc8acf00e47cefc}\label{templates_8h_a9819dcbdbc4776804bc8acf00e47cefc}} 
\index{templates.\+h@{templates.\+h}!plasma\+\_\+cell@{plasma\+\_\+cell}}
\index{plasma\+\_\+cell@{plasma\+\_\+cell}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{plasma\+\_\+cell()}{plasma\_cell()}}
{\footnotesize\ttfamily int plasma\+\_\+cell (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9e781dcc9df20e8b93139c48b5627be1}\label{templates_8h_a9e781dcc9df20e8b93139c48b5627be1}} 
\index{templates.\+h@{templates.\+h}!polint@{polint}}
\index{polint@{polint}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{polint()}{polint()}}
{\footnotesize\ttfamily void polint (\begin{DoxyParamCaption}\item[{double}]{xa\mbox{[}$\,$\mbox{]},  }\item[{double}]{ya\mbox{[}$\,$\mbox{]},  }\item[{int}]{n,  }\item[{double}]{x,  }\item[{double $\ast$}]{y,  }\item[{double $\ast$}]{dy }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a768f0a037ecfb93227eda643e247b219}\label{templates_8h_a768f0a037ecfb93227eda643e247b219}} 
\index{templates.\+h@{templates.\+h}!pop\+\_\+kappa\+\_\+ff\+\_\+array@{pop\+\_\+kappa\+\_\+ff\+\_\+array}}
\index{pop\+\_\+kappa\+\_\+ff\+\_\+array@{pop\+\_\+kappa\+\_\+ff\+\_\+array}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{pop\+\_\+kappa\+\_\+ff\+\_\+array()}{pop\_kappa\_ff\_array()}}
{\footnotesize\ttfamily double pop\+\_\+kappa\+\_\+ff\+\_\+array (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



populates the multiplicative constant, including a gaunt factor, to be used in the calculating free free emission (and absorption). 

The routine populates plasmamain\mbox{[}\mbox{]}.kappa\+\_\+ff\+\_\+factor

The free-\/free multiplicative constant depends only on the densities of ions in the cell, and the electron temperature (which feeds into the gaunt factor) so it saves time to calculate all this just the once.

\paragraph*{Notes}

This routine is called just before the photons are sent through the wind. 

Definition at line 984 of file radiation.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a768f0a037ecfb93227eda643e247b219_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_addfbba966a4d69bdc71b771e0d7f3cdf}\label{templates_8h_addfbba966a4d69bdc71b771e0d7f3cdf}} 
\index{templates.\+h@{templates.\+h}!populate\+\_\+bands@{populate\+\_\+bands}}
\index{populate\+\_\+bands@{populate\+\_\+bands}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{populate\+\_\+bands()}{populate\_bands()}}
{\footnotesize\ttfamily double populate\+\_\+bands (\begin{DoxyParamCaption}\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{int}]{iwind,  }\item[{struct \hyperlink{structxbands}{xbands} $\ast$}]{band }\end{DoxyParamCaption})}



Determine how many photons to allocate to each band. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & f1 A minimum frequency (N\+OT U\+S\+ED) \\
\hline
\mbox{\tt in}  & {\em double} & f2 A maximum frequency (N\+OT U\+S\+ED) \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final indicate whether this is for an ioniz\+\_\+or\+\_\+final \\
\hline
\mbox{\tt in}  & {\em int} & iwind indicates where wind photons are created \\
\hline
\mbox{\tt in,out}  & {\em struct} & xbands $\ast$ band is a pointer to the band sturctue where everythin is \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
ftot which is the sum of the band limited luminosities
\end{DoxyReturn}
This routine determines how many photons to allocate to each band. Inputs determine a minimum fraction to allocate to each band, but these need not sum to 1, and so the rest of the photons are allocated naturally (that is to say) by the luminosities within the bands.

Much of the actual work is carried out in xdefine\+\_\+phot.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000044}{Bug}]f1 and f2 do not appear to be used and should be removed from the call.\end{DoxyRefDesc}


Definition at line 188 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_addfbba966a4d69bdc71b771e0d7f3cdf_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{templates_8h_addfbba966a4d69bdc71b771e0d7f3cdf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac936489e8c884d738a840597081d3c04}\label{templates_8h_ac936489e8c884d738a840597081d3c04}} 
\index{templates.\+h@{templates.\+h}!populate\+\_\+ion\+\_\+rate\+\_\+matrix@{populate\+\_\+ion\+\_\+rate\+\_\+matrix}}
\index{populate\+\_\+ion\+\_\+rate\+\_\+matrix@{populate\+\_\+ion\+\_\+rate\+\_\+matrix}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{populate\+\_\+ion\+\_\+rate\+\_\+matrix()}{populate\_ion\_rate\_matrix()}}
{\footnotesize\ttfamily int populate\+\_\+ion\+\_\+rate\+\_\+matrix (\begin{DoxyParamCaption}\item[{double}]{rate\+\_\+matrix\mbox{[}nions\mbox{]}\mbox{[}nions\mbox{]},  }\item[{double}]{pi\+\_\+rates\mbox{[}nions\mbox{]},  }\item[{double}]{inner\+\_\+rates\mbox{[}n\+\_\+inner\+\_\+tot\mbox{]},  }\item[{double}]{rr\+\_\+rates\mbox{[}nions\mbox{]},  }\item[{double}]{b\+\_\+temp\mbox{[}nions\mbox{]},  }\item[{double}]{xne }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a43f10249d2500ec53e8e19e42f0f0c61}\label{templates_8h_a43f10249d2500ec53e8e19e42f0f0c61}} 
\index{templates.\+h@{templates.\+h}!position\+\_\+summary@{position\+\_\+summary}}
\index{position\+\_\+summary@{position\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{position\+\_\+summary()}{position\_summary()}}
{\footnotesize\ttfamily int position\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Definition at line 186 of file py\+\_\+wind\+\_\+sub.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=339pt]{templates_8h_a43f10249d2500ec53e8e19e42f0f0c61_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5672a43b959d7e6d398852cbc41ee6b1}\label{templates_8h_a5672a43b959d7e6d398852cbc41ee6b1}} 
\index{templates.\+h@{templates.\+h}!project\+\_\+from@{project\+\_\+from}}
\index{project\+\_\+from@{project\+\_\+from}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{project\+\_\+from()}{project\_from()}}
{\footnotesize\ttfamily int project\+\_\+from (\begin{DoxyParamCaption}\item[{struct \hyperlink{structbasis}{basis} $\ast$}]{basis\+\_\+from,  }\item[{double}]{v\+\_\+in\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\+\_\+out\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a2252a3d2a1a36fbe8bef311e90ffd171}\label{templates_8h_a2252a3d2a1a36fbe8bef311e90ffd171}} 
\index{templates.\+h@{templates.\+h}!project\+\_\+from\+\_\+cyl\+\_\+xyz@{project\+\_\+from\+\_\+cyl\+\_\+xyz}}
\index{project\+\_\+from\+\_\+cyl\+\_\+xyz@{project\+\_\+from\+\_\+cyl\+\_\+xyz}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{project\+\_\+from\+\_\+cyl\+\_\+xyz()}{project\_from\_cyl\_xyz()}}
{\footnotesize\ttfamily int project\+\_\+from\+\_\+cyl\+\_\+xyz (\begin{DoxyParamCaption}\item[{double}]{a\mbox{[}$\,$\mbox{]},  }\item[{double}]{b\mbox{[}$\,$\mbox{]},  }\item[{double}]{result\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ad69e520ff4f237809642951e68cc645b}\label{templates_8h_ad69e520ff4f237809642951e68cc645b}} 
\index{templates.\+h@{templates.\+h}!project\+\_\+from\+\_\+xyz\+\_\+cyl@{project\+\_\+from\+\_\+xyz\+\_\+cyl}}
\index{project\+\_\+from\+\_\+xyz\+\_\+cyl@{project\+\_\+from\+\_\+xyz\+\_\+cyl}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{project\+\_\+from\+\_\+xyz\+\_\+cyl()}{project\_from\_xyz\_cyl()}}
{\footnotesize\ttfamily int project\+\_\+from\+\_\+xyz\+\_\+cyl (\begin{DoxyParamCaption}\item[{double}]{a\mbox{[}$\,$\mbox{]},  }\item[{double}]{b\mbox{[}$\,$\mbox{]},  }\item[{double}]{result\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a6b58ffdfc9f610023bb61f333894caf4}\label{templates_8h_a6b58ffdfc9f610023bb61f333894caf4}} 
\index{templates.\+h@{templates.\+h}!project\+\_\+to@{project\+\_\+to}}
\index{project\+\_\+to@{project\+\_\+to}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{project\+\_\+to()}{project\_to()}}
{\footnotesize\ttfamily int project\+\_\+to (\begin{DoxyParamCaption}\item[{struct \hyperlink{structbasis}{basis} $\ast$}]{basis\+\_\+from,  }\item[{double}]{v\+\_\+in\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\+\_\+out\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a11cd39cf061a4a4779bf7c3500b5a631}\label{templates_8h_a11cd39cf061a4a4779bf7c3500b5a631}} 
\index{templates.\+h@{templates.\+h}!py\+\_\+wind\+\_\+help@{py\+\_\+wind\+\_\+help}}
\index{py\+\_\+wind\+\_\+help@{py\+\_\+wind\+\_\+help}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{py\+\_\+wind\+\_\+help()}{py\_wind\_help()}}
{\footnotesize\ttfamily int py\+\_\+wind\+\_\+help (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



print out some helpful information to the screen and exits 

\begin{DoxyReturn}{Returns}
N/A since the program exits once the help is written
\end{DoxyReturn}
This routine simply writes information to the screen. It should be updated whenever the program changes in a major way.

It is called if py\+\_\+wind is invoked with -\/h, or if there if it is given a switch that it does not understand.

\paragraph*{Notes}

Unfortunately unlike python the program language c is not self documenting 

Definition at line 667 of file py\+\_\+wind.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{templates_8h_a11cd39cf061a4a4779bf7c3500b5a631_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a277d190575cbdab99ac77d308dc9dfa1}\label{templates_8h_a277d190575cbdab99ac77d308dc9dfa1}} 
\index{templates.\+h@{templates.\+h}!q12@{q12}}
\index{q12@{q12}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{q12()}{q12()}}
{\footnotesize\ttfamily double q12 (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{double}]{t }\end{DoxyParamCaption})}



Calculate the collisional excitation coefficient for a line. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & lines $\ast$ line\+\_\+ptr The line of interest \\
\hline
\mbox{\tt in}  & {\em double} & t The temperature of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The collisional excitation coeffient
\end{DoxyReturn}
The routine calls q21 and uses detailed balance to derive q12

\paragraph*{Notes}

Definition at line 285 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a277d190575cbdab99ac77d308dc9dfa1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6daa97078321cf4f668d31b7004fed6c}\label{templates_8h_a6daa97078321cf4f668d31b7004fed6c}} 
\index{templates.\+h@{templates.\+h}!q21@{q21}}
\index{q21@{q21}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{q21()}{q21()}}
{\footnotesize\ttfamily double q21 (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{double}]{t }\end{DoxyParamCaption})}



calculates and returns the collisional de-\/excitation coefficient q21 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & lines $\ast$ line\+\_\+ptr A single line \\
\hline
\mbox{\tt in}  & {\em double} & t The temperature at wich to calculate the coefficient \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The collisional de-\/excitiation coefficient
\end{DoxyReturn}
This routine uses stored coefficients if we have them, or the Van Regemortor approximation if we do not.

\paragraph*{Notes}

the relevant paper to consult here is Van Regemorter 1962. We use an effective gaunt factor to calculate collision strengths. There is one regime in which kt $<$ hnu. For that consult equation 4.\+20 and 4.\+21 of Hazy. 

Definition at line 224 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6daa97078321cf4f668d31b7004fed6c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6daa97078321cf4f668d31b7004fed6c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad33c3a097208fb519a5e779c62e3d1f3}\label{templates_8h_ad33c3a097208fb519a5e779c62e3d1f3}} 
\index{templates.\+h@{templates.\+h}!q\+\_\+ioniz@{q\+\_\+ioniz}}
\index{q\+\_\+ioniz@{q\+\_\+ioniz}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{q\+\_\+ioniz()}{q\_ioniz()}}
{\footnotesize\ttfamily double q\+\_\+ioniz (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{double}]{electron\+\_\+temperature }\end{DoxyParamCaption})}



returns the collisional ionization rate co-\/efficient 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} -\/ pointer to a Topbase style cross section -\/ u \\
\hline
\mbox{\tt in}  & {\em double} & electron\+\_\+temperature -\/ electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
collisional ionization rate coefficieient
\end{DoxyReturn}
This returns the collisional ionization co-\/efficient Calculated following equation 5-\/79 of Mihalas or from data from Dere 2007.

\paragraph*{Notes}

This is extrememly similar to the routine compute\+\_\+di\+\_\+coeffs apart from the fact that it computes just one rate coefficient, and can use an approximate formula in the absence of data. It is an earlier routine used only in macroatom calculations. 

Definition at line 387 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad33c3a097208fb519a5e779c62e3d1f3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad33c3a097208fb519a5e779c62e3d1f3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6a22ee2c1e95eae27423b95ce1283f71}\label{templates_8h_a6a22ee2c1e95eae27423b95ce1283f71}} 
\index{templates.\+h@{templates.\+h}!q\+\_\+ioniz\+\_\+dere@{q\+\_\+ioniz\+\_\+dere}}
\index{q\+\_\+ioniz\+\_\+dere@{q\+\_\+ioniz\+\_\+dere}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{q\+\_\+ioniz\+\_\+dere()}{q\_ioniz\_dere()}}
{\footnotesize\ttfamily double q\+\_\+ioniz\+\_\+dere (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



Returns the collisional ionization rate coefficient for a given ion/temperature. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion Index into ion structure for current ion under analysis \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e Electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the collisional ionization rate coefficient
\end{DoxyReturn}
This uses data from Dere 07 to calculate a collisional ionization rate coefficient. Data is provided as spline fits over a range of temperatures and so an interpolation is required to arrive at the correct data for a given temperature. There is also an exponential integral which is done using a gsl routine.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 91 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{templates_8h_a6a22ee2c1e95eae27423b95ce1283f71_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a6a22ee2c1e95eae27423b95ce1283f71_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a432a9569392003e4470067b1c44dca5b}\label{templates_8h_a432a9569392003e4470067b1c44dca5b}} 
\index{templates.\+h@{templates.\+h}!q\+\_\+recomb@{q\+\_\+recomb}}
\index{q\+\_\+recomb@{q\+\_\+recomb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{q\+\_\+recomb()}{q\_recomb()}}
{\footnotesize\ttfamily double q\+\_\+recomb (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{double}]{electron\+\_\+temperature }\end{DoxyParamCaption})}



Returns a collisional recombination rate co-\/efficient. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} -\/ pointer to a topbase style PI cross section \\
\hline
{\em \mbox{[}in} & out\mbox{]} double electron\+\_\+temperature -\/ electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Collisional recombination rate coefficient
\end{DoxyReturn}
This equation comes from considering TE and getting the expression q\+\_\+recomb = 2.\+07e-\/16 $\ast$ gl/gu $\ast$ exp(E/kT) $\ast$ (T\+\_\+e$\ast$$\ast$-\/3/2) $\ast$ q\+\_\+ioniz then substituting the above expression for q\+\_\+ioniz.

\paragraph*{Notes}

This routine is very similar to compute\+\_\+qrecomb\+\_\+coeffs apart from the fact that this routine only computes one recomb coefficient and applies an approximate calculation where dere data is missing. It is used in macroatom calculations. 

Definition at line 450 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a432a9569392003e4470067b1c44dca5b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a432a9569392003e4470067b1c44dca5b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a193d6c4498adc3507b41e79e52a94016}\label{templates_8h_a193d6c4498adc3507b41e79e52a94016}} 
\index{templates.\+h@{templates.\+h}!q\+\_\+recomb\+\_\+dere@{q\+\_\+recomb\+\_\+dere}}
\index{q\+\_\+recomb\+\_\+dere@{q\+\_\+recomb\+\_\+dere}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{q\+\_\+recomb\+\_\+dere()}{q\_recomb\_dere()}}
{\footnotesize\ttfamily double q\+\_\+recomb\+\_\+dere (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{cont\+\_\+ptr,  }\item[{double}]{electron\+\_\+temperature }\end{DoxyParamCaption})}



Returns the collisional recombination co-\/efficient. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} a pointer to the topbdae style PI cross section \\
\hline
\mbox{\tt in}  & {\em double} & electron\+\_\+temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
??? R\+E\+T\+U\+R\+NS ???
\end{DoxyReturn}
This equation comes from considering TE and getting the expression q\+\_\+recomb = 2.\+07e-\/16 $\ast$ gl/gu $\ast$ exp(E/kT) $\ast$ q\+\_\+ioniz then substituting the above expression for q\+\_\+ioniz. We get the ionization threshold from the supplied PI cross section.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 315 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a193d6c4498adc3507b41e79e52a94016_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a193d6c4498adc3507b41e79e52a94016_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6386915abbe2a22bf680d7034b6e1cdc}\label{templates_8h_a6386915abbe2a22bf680d7034b6e1cdc}} 
\index{templates.\+h@{templates.\+h}!qdisk\+\_\+init@{qdisk\+\_\+init}}
\index{qdisk\+\_\+init@{qdisk\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{qdisk\+\_\+init()}{qdisk\_init()}}
{\footnotesize\ttfamily int qdisk\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize a structure (qdisk) for recording information about photons/energy impinging on the disk, which is stored in a disk structure called qdisk. 

\begin{DoxyReturn}{Returns}
Always return zero
\end{DoxyReturn}
\paragraph*{Notes}

The information stored in qdisk can be used to modify the effective temperature of the disk

The reason the qdisk is needed as well as disk structure is that whenever the wavelength bands are changed the radii in the disk structure are recalibratied. We want qdisk to have fixed boundaries when this happens. 

Definition at line 681 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{templates_8h_a6386915abbe2a22bf680d7034b6e1cdc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7c88d034953bdd81d94f7b4834f455cb}\label{templates_8h_a7c88d034953bdd81d94f7b4834f455cb}} 
\index{templates.\+h@{templates.\+h}!qdisk\+\_\+save@{qdisk\+\_\+save}}
\index{qdisk\+\_\+save@{qdisk\+\_\+save}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{qdisk\+\_\+save()}{qdisk\_save()}}
{\footnotesize\ttfamily int qdisk\+\_\+save (\begin{DoxyParamCaption}\item[{char $\ast$}]{diskfile,  }\item[{double}]{ztot }\end{DoxyParamCaption})}



Save the information in the qdisk structure to a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & $\ast$ diskfile Name of the file whihc is writteen \\
\hline
\mbox{\tt in}  & {\em double} & ztot The total luminosity of the disk as calculate over multiple cycles \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine reformats the data about disk heating which has been accumulated and writes it to a file

\paragraph*{Notes}

The data concerning heating by the disk is built up during a the ionization cycles

The file that is produced should be readable as an astropy table 

Definition at line 724 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{templates_8h_a7c88d034953bdd81d94f7b4834f455cb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{templates_8h_a7c88d034953bdd81d94f7b4834f455cb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3521f91b62531265426401a6c32fa93f}\label{templates_8h_a3521f91b62531265426401a6c32fa93f}} 
\index{templates.\+h@{templates.\+h}!qromb@{qromb}}
\index{qromb@{qromb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{qromb()}{qromb()}}
{\footnotesize\ttfamily double qromb (\begin{DoxyParamCaption}\item[{double($\ast$)(double)}]{func,  }\item[{double}]{a,  }\item[{double}]{b,  }\item[{double}]{eps }\end{DoxyParamCaption})}



Integrate a function between a and b. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em func} & The function which one wishes a root for \\
\hline
\mbox{\tt in}  & {\em a} & one end of the interval \\
\hline
\mbox{\tt in}  & {\em b} & the other end of the interval \\
\hline
\mbox{\tt in}  & {\em eps} & A tolerence \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The root of the function f .
\end{DoxyReturn}
A Numerical Recipes routine to integrates the double precision function func from a to b.

\paragraph*{Notes}

J\+M\+AX limits the total number number of times the trapezoidal rule can be called, and K determines the order of polint

This routine has been modified from that that appears in Numberical recipes so that the tolerance could be specified. Additioanlly, the convergence criterion for exiting the exiting trapzd loop to include = sign. This change was in the ansi version of qromb routine, and was needed to integrate functions which were in some cases zero throughout the range. Not only did this seem to eliminate a number of error returns, it sped up some portions of the program. 

Definition at line 66 of file recipes.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3521f91b62531265426401a6c32fa93f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0940d7c3ced7e511ec385d4de758b436}\label{templates_8h_a0940d7c3ced7e511ec385d4de758b436}} 
\index{templates.\+h@{templates.\+h}!quadratic@{quadratic}}
\index{quadratic@{quadratic}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{quadratic()}{quadratic()}}
{\footnotesize\ttfamily int quadratic (\begin{DoxyParamCaption}\item[{double}]{a,  }\item[{double}]{b,  }\item[{double}]{c,  }\item[{double}]{r\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a43541dacfceb46c42583c31aeb11d496}\label{templates_8h_a43541dacfceb46c42583c31aeb11d496}} 
\index{templates.\+h@{templates.\+h}!r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram@{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram}}
\index{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram@{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram()}{r\_draw\_from\_path\_histogram()}}
{\footnotesize\ttfamily double r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr}}]{Path\+Ptr }\end{DoxyParamCaption})}



Draws a random path from a path histogram. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Path\+Ptr} & Path histogram pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Path
\end{DoxyReturn}
Picks a random path bin, weighted by the flux in each in this cell, then assigns a path from within that bin (from a uniform random distribution)

\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 346 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=302pt]{templates_8h_a43541dacfceb46c42583c31aeb11d496_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{templates_8h_a43541dacfceb46c42583c31aeb11d496_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_adb025e0891ad334d41481551bf785170}\label{templates_8h_adb025e0891ad334d41481551bf785170}} 
\index{templates.\+h@{templates.\+h}!radiation@{radiation}}
\index{radiation@{radiation}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{radiation()}{radiation()}}
{\footnotesize\ttfamily int radiation (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds }\end{DoxyParamCaption})}



updates the field parameters in the wind and reduces the weight of the photon as a result of the effects of free free, bound-\/free and Compton scattering. The routine also keeps track of the number of photoionizations for H and He in the cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the photon \\
\hline
\mbox{\tt in}  & {\em double} & ds the distance the photon has travelled in the cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0. The pieces of the wind structure which are updated are j,ave\+\_\+freq,ntot, heat\+\_\+photo, heat\+\_\+ff, heat\+\_\+h, heat\+\_\+he1, heat\+\_\+he2, heat\+\_\+z, nioniz, and ioniz\mbox{[}\mbox{]}.
\end{DoxyReturn}
\paragraph*{Notes}

The \# of ionizations of a specific ion = (w(0)-\/w(s))$\ast$n\+\_\+i sigma\+\_\+i/ (h nu $\ast$ kappa\+\_\+tot). (The \# of ionizations is just given by the integral of n\+\_\+i sigma\+\_\+i w(s) / h nu ds, but if the density is assumed to be constant and sigma is also constant \mbox{[}therefy ignoring velocity shifts in a grid cell\mbox{]}, then n\+\_\+i sigma and h nu can be brought outside the integral. Hence the integral is just over w(s), but that is just given by (w(0)-\/w(smax))/kappa\+\_\+tot.) The routine calculates the number of ionizations per unit volume. 

Definition at line 152 of file radiation.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_adb025e0891ad334d41481551bf785170_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a451b4740f3d1e12cb07885b0d3e5ef1b}\label{templates_8h_a451b4740f3d1e12cb07885b0d3e5ef1b}} 
\index{templates.\+h@{templates.\+h}!random\+\_\+number@{random\+\_\+number}}
\index{random\+\_\+number@{random\+\_\+number}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{random\+\_\+number()}{random\_number()}}
{\footnotesize\ttfamily double random\+\_\+number (\begin{DoxyParamCaption}\item[{double}]{min,  }\item[{double}]{max }\end{DoxyParamCaption})}



Gets a random number from the generator set up in init\+\_\+rand. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em min} & The minimum value to be generated \\
\hline
\mbox{\tt in}  & {\em max} & The maximum value to be generated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\mbox{[}out\mbox{]} x The generated number
\end{DoxyReturn}
Produces a number from min to max (exclusive).

\paragraph*{Notes}

2/18 -\/ Written by N\+SH 

Definition at line 284 of file random.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{templates_8h_a451b4740f3d1e12cb07885b0d3e5ef1b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac5e9ac55fb4bf0dbb108c006f509b32b}\label{templates_8h_ac5e9ac55fb4bf0dbb108c006f509b32b}} 
\index{templates.\+h@{templates.\+h}!randvcos@{randvcos}}
\index{randvcos@{randvcos}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{randvcos()}{randvcos()}}
{\footnotesize\ttfamily int randvcos (\begin{DoxyParamCaption}\item[{double}]{lmn\mbox{[}$\,$\mbox{]},  }\item[{double}]{north\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a1881a8f6279e1472e741aab3ee654383}\label{templates_8h_a1881a8f6279e1472e741aab3ee654383}} 
\index{templates.\+h@{templates.\+h}!randvec@{randvec}}
\index{randvec@{randvec}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{randvec()}{randvec()}}
{\footnotesize\ttfamily int randvec (\begin{DoxyParamCaption}\item[{double}]{a\mbox{[}$\,$\mbox{]},  }\item[{double}]{r }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a086da1ecc9d7064c79041745de7031fa}\label{templates_8h_a086da1ecc9d7064c79041745de7031fa}} 
\index{templates.\+h@{templates.\+h}!randwind@{randwind}}
\index{randwind@{randwind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{randwind()}{randwind()}}
{\footnotesize\ttfamily int randwind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{lmn\mbox{[}3\mbox{]},  }\item[{double}]{north\mbox{[}3\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a5cc282e1f3d56ce0f29cb080bc225408}\label{templates_8h_a5cc282e1f3d56ce0f29cb080bc225408}} 
\index{templates.\+h@{templates.\+h}!randwind\+\_\+thermal\+\_\+trapping@{randwind\+\_\+thermal\+\_\+trapping}}
\index{randwind\+\_\+thermal\+\_\+trapping@{randwind\+\_\+thermal\+\_\+trapping}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{randwind\+\_\+thermal\+\_\+trapping()}{randwind\_thermal\_trapping()}}
{\footnotesize\ttfamily int randwind\+\_\+thermal\+\_\+trapping (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nnscat }\end{DoxyParamCaption})}



is the routine which chooses a new anisotropic direction in geo.\+scatter\+\_\+mode = S\+C\+A\+T\+T\+E\+R\+\_\+\+M\+O\+D\+E\+\_\+\+T\+H\+E\+R\+M\+AL 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p The photon being scattered \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ nnscat The number of times the phton scattered internally before escaping the local scattering region\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 for success. Also modifies the photon ptr p to reflect new direction (p-\/$>$lmn), and nnscat, which should be copied to the phoiton structure after calling this routine.
\end{DoxyReturn}
This routine uses a rejection method to choose a direction so that the probability distribution of directions generated reflects the probability of escape along each direction in accordance with the sobolev optical depth.

\paragraph*{Notes}

The resonance that caused the scatter must be stored in the photon bundle.

The name of the routine is something of a misnomer. Pure sobolev optical depths are used. The temperature in the cell does not come into the calculation.

Unlike randwind, this routine does not explicitly need to to make a transformation from the xz plane to the location of the photon. This is because dvds is calculated directly using dwind\+\_\+ds 

Definition at line 612 of file anisowind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a5cc282e1f3d56ce0f29cb080bc225408_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a5cc282e1f3d56ce0f29cb080bc225408_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ada5d5c91372291204ba0255184ce1f87}\label{templates_8h_ada5d5c91372291204ba0255184ce1f87}} 
\index{templates.\+h@{templates.\+h}!read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile@{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile}}
\index{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile@{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile()}{read\_non\_standard\_disk\_profile()}}
{\footnotesize\ttfamily int read\+\_\+non\+\_\+standard\+\_\+disk\+\_\+profile (\begin{DoxyParamCaption}\item[{char $\ast$}]{tprofile }\end{DoxyParamCaption})}



Read the temperature profile from a file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em char} & $\ast$ tprofile Name of the input file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The input format for the file to be read in is quite spefic The first line should contina the number of points n the profile

Subsequent lines should contian a radius and a temperarue

The radius values shoule be in units of 1e11 cm The temperature should be in units of 1000K

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000020}{Bug}]This routine which was written for the Y\+SO study needs to be made less Y\+SO centric. It should also be retested.\end{DoxyRefDesc}


Definition at line 795 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ada5d5c91372291204ba0255184ce1f87_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{templates_8h_ada5d5c91372291204ba0255184ce1f87_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a5127b2ba8d9a97446178bb48eff3e586}\label{templates_8h_a5127b2ba8d9a97446178bb48eff3e586}} 
\index{templates.\+h@{templates.\+h}!recomb\+\_\+summary@{recomb\+\_\+summary}}
\index{recomb\+\_\+summary@{recomb\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{recomb\+\_\+summary()}{recomb\_summary()}}
{\footnotesize\ttfamily int recomb\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ab14e3dce54237244859ed06cef6b5846}\label{templates_8h_ab14e3dce54237244859ed06cef6b5846}} 
\index{templates.\+h@{templates.\+h}!renorm@{renorm}}
\index{renorm@{renorm}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{renorm()}{renorm()}}
{\footnotesize\ttfamily int renorm (\begin{DoxyParamCaption}\item[{double}]{a\mbox{[}$\,$\mbox{]},  }\item[{double}]{scalar }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a85ea3570f6a740c495a6996fd1acea6e}\label{templates_8h_a85ea3570f6a740c495a6996fd1acea6e}} 
\index{templates.\+h@{templates.\+h}!reorient@{reorient}}
\index{reorient@{reorient}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{reorient()}{reorient()}}
{\footnotesize\ttfamily int reorient (\begin{DoxyParamCaption}\item[{struct \hyperlink{structbasis}{basis} $\ast$}]{basis\+\_\+from,  }\item[{struct \hyperlink{structbasis}{basis} $\ast$}]{basis\+\_\+to,  }\item[{double}]{v\+\_\+from\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\+\_\+to\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_adc18086c9912f51dae0f13aef98278de}\label{templates_8h_adc18086c9912f51dae0f13aef98278de}} 
\index{templates.\+h@{templates.\+h}!reposition@{reposition}}
\index{reposition@{reposition}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{reposition()}{reposition()}}
{\footnotesize\ttfamily int reposition (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



p) attempts to assure that a photon is not scattered a second time inappropriately by the same transition 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A photons \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns 0, but returns a negative number if p is not in the wind in the domain it is supposed to be in
\end{DoxyReturn}
For resonant scatters, the routine moves the photon by a distance D\+F\+U\+D\+GE. For non-\/resonant scattering the routine simple returns

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000051}{Bug}]This seems like an error. We have calculated cell specific values of dfudge, but this routine used the global D\+F\+U\+D\+GE to move the photon though a cell wall.\end{DoxyRefDesc}


Definition at line 45 of file reposition.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_adc18086c9912f51dae0f13aef98278de_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a782f80aab666cb86b3a296856d1f34e6}\label{templates_8h_a782f80aab666cb86b3a296856d1f34e6}} 
\index{templates.\+h@{templates.\+h}!reverb\+\_\+init@{reverb\+\_\+init}}
\index{reverb\+\_\+init@{reverb\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{reverb\+\_\+init()}{reverb\_init()}}
{\footnotesize\ttfamily int reverb\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind }\end{DoxyParamCaption})}



Initialises everything for reverb mapping. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Top-\/level wind cell array \\
\hline
\mbox{\tt in}  & {\em nangles} & Number of observers \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Reports back to user the reverb mode running, and then calls the appropriate setup routines.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a0d8a68cc8cb0e384901a71173dbc333f}{wind\+\_\+paths\+\_\+init()}
\end{DoxySeeAlso}
\paragraph*{Notes}

3/15 -\/ Written by S\+WM 

Definition at line 86 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a782f80aab666cb86b3a296856d1f34e6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a76f3cece46c92129a1e138a02aac87ca}\label{templates_8h_a76f3cece46c92129a1e138a02aac87ca}} 
\index{templates.\+h@{templates.\+h}!reweightwind@{reweightwind}}
\index{reweightwind@{reweightwind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{reweightwind()}{reweightwind()}}
{\footnotesize\ttfamily double reweightwind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



calculates the weight of a photon in the wind that is forced to scatter along a specific line of sight. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p The photon being scattered \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number corresponding to the reweighting is returned. The revised weight is also stored in p
\end{DoxyReturn}
p must contain the position and N\+EW direction for the photon being scattered. In general, p must also be up to date w. r. t. the number of the resonance that generated the photon.

\paragraph*{Notes}

This routine is called when extracting photons along a specific line of sight.

wmain.\+dv\+\_\+ds, and wmain.\+lmn are maximum value of dvds, and the direction in a cell (that is in the positive xz plane) \begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000001}{Bug}]180414 -\/ ksl -\/ It is not obvious that using D\+F\+U\+D\+GE as the way to choose whether to recalculate the cdf for scatter is correct. One would obtain the wrong answer if the photon moved a small distance and hit a different resonance. \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000002}{Bug}]This is a note related to an X\+XX comoment which read as follows\+: Factor of 2 needed because the interval is from -\/1 to 1 X\+XX It\textquotesingle{}s definitely needed to make a uniform distribution work but is this reason really right\end{DoxyRefDesc}


180415 -\/ ksl -\/ My investigation of this indicates that the cdf was generated from -\/1 to 1, and futhermore that cdf\+\_\+gen\+\_\+from\+\_\+function which is used to create the cdf always sets the norm to 1. So it is not clear to me why this is the reweghting. It is also nto clear to me why the reweighting to be less than a factor of 2, which is what if stateement requries. Basically, I do not understand what is going on here at all.

Definition at line 353 of file anisowind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a76f3cece46c92129a1e138a02aac87ca_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a76f3cece46c92129a1e138a02aac87ca_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa91d5abc6118522c3cff7b67e6275d3e}\label{templates_8h_aa91d5abc6118522c3cff7b67e6275d3e}} 
\index{templates.\+h@{templates.\+h}!rho@{rho}}
\index{rho@{rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rho()}{rho()}}
{\footnotesize\ttfamily double rho (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ab30248c42430af95e6b02e95dbc05db0}\label{templates_8h_ab30248c42430af95e6b02e95dbc05db0}} 
\index{templates.\+h@{templates.\+h}!rho\+\_\+1d@{rho\+\_\+1d}}
\index{rho\+\_\+1d@{rho\+\_\+1d}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rho\+\_\+1d()}{rho\_1d()}}
{\footnotesize\ttfamily double rho\+\_\+1d (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x }\end{DoxyParamCaption})}



Get the density for an imported spherical model at x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain for the imported model \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ x A position (3d) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The density in cgs units is returned
\end{DoxyReturn}
This routine finds rho from the imported model at a position x. The routine does not interpolate rho, but simply locates the cell associated with x

\paragraph*{Notes}

This routine is really only used to intialize rho in the Plasma structure. In reality, once the Plasma structure is initialized we always interpolate within the plasma structure and do not access the original data. 

Definition at line 294 of file import\+\_\+spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{templates_8h_ab30248c42430af95e6b02e95dbc05db0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a632e5656a7655882be49d9ab436b0372}\label{templates_8h_a632e5656a7655882be49d9ab436b0372}} 
\index{templates.\+h@{templates.\+h}!rho\+\_\+cylindrical@{rho\+\_\+cylindrical}}
\index{rho\+\_\+cylindrical@{rho\+\_\+cylindrical}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rho\+\_\+cylindrical()}{rho\_cylindrical()}}
{\footnotesize\ttfamily double rho\+\_\+cylindrical (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x }\end{DoxyParamCaption})}



Get the density for an imported cylindrical model at x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The domain for the imported model \\
\hline
\mbox{\tt in}  & {\em x} & A position \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The density in cgs units is returned
\end{DoxyReturn}
This routine finds rho from the imported model at a position x. The routine does not interpolate rho, but simply locates the cell associated with x

\paragraph*{Notes}

This routine is really only used to intialize rho in the Plasma structure. In reality, once the Plasma structure is initialized we always interpolate within the plasma structure and do not access the original data. 

Definition at line 459 of file import\+\_\+cylindrical.\+c.

\mbox{\Hypertarget{templates_8h_a59c2682b3dc23f5ce1ce89012e5a68f3}\label{templates_8h_a59c2682b3dc23f5ce1ce89012e5a68f3}} 
\index{templates.\+h@{templates.\+h}!rho\+\_\+rtheta@{rho\+\_\+rtheta}}
\index{rho\+\_\+rtheta@{rho\+\_\+rtheta}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rho\+\_\+rtheta()}{rho\_rtheta()}}
{\footnotesize\ttfamily double rho\+\_\+rtheta (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x }\end{DoxyParamCaption})}



Get the density for an imported rtheta model at x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain for the imported model \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ x A postion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The density in cgs units is returned
\end{DoxyReturn}
This routine finds rho from the imported model at a position x. The routine does not interpolate rho, but simply locates the cell associated with x

\paragraph*{Notes}

This routine is really only used to intialize rho in the Plasma structure. In reality, once the Plasma structure is initialized we always interpolate within the plasma structure and do not access the original data 

Definition at line 470 of file import\+\_\+rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{templates_8h_a59c2682b3dc23f5ce1ce89012e5a68f3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8f9cb993121bb966a8504a069b17a993}\label{templates_8h_a8f9cb993121bb966a8504a069b17a993}} 
\index{templates.\+h@{templates.\+h}!rho\+\_\+summary@{rho\+\_\+summary}}
\index{rho\+\_\+summary@{rho\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rho\+\_\+summary()}{rho\_summary()}}
{\footnotesize\ttfamily int rho\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9c51519f54c26122775ef8eaca1806d8}\label{templates_8h_a9c51519f54c26122775ef8eaca1806d8}} 
\index{templates.\+h@{templates.\+h}!roche@{roche}}
\index{roche@{roche}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{roche()}{roche()}}
{\footnotesize\ttfamily void roche (\begin{DoxyParamCaption}\item[{double}]{s,  }\item[{double $\ast$}]{value,  }\item[{double $\ast$}]{derivative }\end{DoxyParamCaption})}



Calculate the value of the Roche potential and its derivative along a particular lien of sight. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance s \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ value The value of the Roche potenial at a distance s along the path of the photon \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ derivative The derivative of the roche potential as the photon tavels \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N/A
\end{DoxyReturn}
This is the function used by the Recipes routine rtsafe to locate specific surfaces of the Roche potential. Here $\ast$value is phi and $\ast$derivative is the slope of phi at s along the vector defined by p\+\_\+roche. The value of phi has to be set in advance through geo.\+phi and would normally be that of the Roche lobe

\paragraph*{Notes}

The routime simply calls phi and dphi\+\_\+ds 

Definition at line 677 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{templates_8h_a9c51519f54c26122775ef8eaca1806d8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9c51519f54c26122775ef8eaca1806d8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad958df4fd3f6dd7f4ff01882d407c6c6}\label{templates_8h_ad958df4fd3f6dd7f4ff01882d407c6c6}} 
\index{templates.\+h@{templates.\+h}!roche2\+\_\+width\+\_\+max@{roche2\+\_\+width\+\_\+max}}
\index{roche2\+\_\+width\+\_\+max@{roche2\+\_\+width\+\_\+max}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{roche2\+\_\+width\+\_\+max()}{roche2\_width\_max()}}
{\footnotesize\ttfamily double roche2\+\_\+width\+\_\+max (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Find the half width of the secondary Roche lobe. 

\begin{DoxyReturn}{Returns}
The half width is returned
\end{DoxyReturn}
Find the maximum half width of the Roche lobe of the secondary. This routine uses the NR routine golden to find the point in x where the Roche lobe is maximized.

\paragraph*{Notes}

Definition at line 631 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad958df4fd3f6dd7f4ff01882d407c6c6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{templates_8h_ad958df4fd3f6dd7f4ff01882d407c6c6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa72cfd7beaead2acdb08bb12eafa3197}\label{templates_8h_aa72cfd7beaead2acdb08bb12eafa3197}} 
\index{templates.\+h@{templates.\+h}!roche\+\_\+deriv@{roche\+\_\+deriv}}
\index{roche\+\_\+deriv@{roche\+\_\+deriv}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{roche\+\_\+deriv()}{roche\_deriv()}}
{\footnotesize\ttfamily void roche\+\_\+deriv (\begin{DoxyParamCaption}\item[{double}]{s,  }\item[{double $\ast$}]{value,  }\item[{double $\ast$}]{derivative }\end{DoxyParamCaption})}



Calculate the first and second derivative of the roche potential along a specific line of sight. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & s The distance from the initial photon position at which derivatives are to be calcualted \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ value The first derivative \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ derivative The second derivatiove \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N/A
\end{DoxyReturn}
This is the function used by the Recipes routine rtsafe to lacate extrema of the Roche potential. Thus it can be used to find the L1 point, for example. Here $\ast$value is the derivative of phi at s along the vector defined by p\+\_\+roche, and $\ast$derivative is the second derivative

\paragraph*{Notes}

Definition at line 707 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa72cfd7beaead2acdb08bb12eafa3197_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{templates_8h_aa72cfd7beaead2acdb08bb12eafa3197_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa6c77132d4fe5cdf4cb3d66186981228}\label{templates_8h_aa6c77132d4fe5cdf4cb3d66186981228}} 
\index{templates.\+h@{templates.\+h}!roche\+\_\+width@{roche\+\_\+width}}
\index{roche\+\_\+width@{roche\+\_\+width}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{roche\+\_\+width()}{roche\_width()}}
{\footnotesize\ttfamily double roche\+\_\+width (\begin{DoxyParamCaption}\item[{double}]{x }\end{DoxyParamCaption})}



Calculate the width of the Roche potentiil at a position x along the x axis. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & x The distance the phtoon has traveled from its initial position\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the width
\end{DoxyReturn}
Calculate the half width of the Roche lobe at the position x along the x axis in the plane of the orbit.

\paragraph*{Notes}

There is no real guarantee that this would work if you were outside L2 or L3. 

Definition at line 586 of file roche.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa6c77132d4fe5cdf4cb3d66186981228_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa6c77132d4fe5cdf4cb3d66186981228_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a68cff92e2a36ec9073dbecabffa5543b}\label{templates_8h_a68cff92e2a36ec9073dbecabffa5543b}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+ds\+\_\+in\+\_\+cell@{rtheta\+\_\+ds\+\_\+in\+\_\+cell}}
\index{rtheta\+\_\+ds\+\_\+in\+\_\+cell@{rtheta\+\_\+ds\+\_\+in\+\_\+cell}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+ds\+\_\+in\+\_\+cell()}{rtheta\_ds\_in\_cell()}}
{\footnotesize\ttfamily double rtheta\+\_\+ds\+\_\+in\+\_\+cell (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



calculates the distance to the far boundary of the cell in which the photon bundle resides. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain in which the photon bundle is though to exist \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Distance to the far boundary of the cell in which the photon currently resides. Negative numbers (and zero) should be regarded as errors.
\end{DoxyReturn}
??? D\+E\+S\+C\+R\+I\+P\+T\+I\+ON ???

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 43 of file rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a68cff92e2a36ec9073dbecabffa5543b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad06961b0435b7c8b175189291537c20c}\label{templates_8h_ad06961b0435b7c8b175189291537c20c}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+extend\+\_\+density@{rtheta\+\_\+extend\+\_\+density}}
\index{rtheta\+\_\+extend\+\_\+density@{rtheta\+\_\+extend\+\_\+density}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+extend\+\_\+density()}{rtheta\_extend\_density()}}
{\footnotesize\ttfamily int rtheta\+\_\+extend\+\_\+density (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



extends the density to regions just outside the wind regiions so that extrapolations of density can be made there 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em int} & ndom ??? \\
\hline
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w ??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
??? R\+E\+T\+U\+R\+NS ???
\end{DoxyReturn}
??? D\+E\+S\+C\+R\+I\+P\+T\+I\+ON ???

\paragraph*{Notes}

Now we need to updated the densities immediately outside the wind so that the density interpolation in resonate will work. In this case all we have done is to copy the densities from the cell which is just in the wind (as one goes outward) to the cell that is just inside (or outside) the wind.

SS asked whether we should also be extending the wind for other parameters, especially ne. At present we do not interpolate on ne so this is not necessary. If we did do that it would be required.

In cylindrical coordinates, the fast dimension is z; grid positions increase up in z, and then out in r. In spperical polar coordinates, the fast dimension is theta; the grid increases in theta (measured) from the z axis), and then in r. In spherical coordinates, the grid increases as one might expect in r..
\begin{DoxyItemize}
\item 06may ksl 57+ -- Trying simply to use mappings to extend the grid in density space. The danger is that we will do other things, e.\+g update some of the wrong parameters. 
\end{DoxyItemize}

Definition at line 842 of file rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=264pt]{templates_8h_ad06961b0435b7c8b175189291537c20c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a00bbfc05ca86bbb87a4c69019564af5d}\label{templates_8h_a00bbfc05ca86bbb87a4c69019564af5d}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+get\+\_\+random\+\_\+location@{rtheta\+\_\+get\+\_\+random\+\_\+location}}
\index{rtheta\+\_\+get\+\_\+random\+\_\+location@{rtheta\+\_\+get\+\_\+random\+\_\+location}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+get\+\_\+random\+\_\+location()}{rtheta\_get\_random\_location()}}
{\footnotesize\ttfamily int rtheta\+\_\+get\+\_\+random\+\_\+location (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a36f04216329e1a6ede98f9f9e0e3989b}\label{templates_8h_a36f04216329e1a6ede98f9f9e0e3989b}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+hydro\+\_\+volumes@{rtheta\+\_\+hydro\+\_\+volumes}}
\index{rtheta\+\_\+hydro\+\_\+volumes@{rtheta\+\_\+hydro\+\_\+volumes}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+hydro\+\_\+volumes()}{rtheta\_hydro\_volumes()}}
{\footnotesize\ttfamily int rtheta\+\_\+hydro\+\_\+volumes (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Computes volumes for cells in an r-\/theta hydro model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The number of the domain which will be populated by the geometry \\
\hline
\mbox{\tt in}  & {\em w} & The wind pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
rtheta\+\_\+zeus\+\_\+volumes replaces rtheta\+\_\+volumes for a zeus model. We know wether cells are in the wimnd so all we need to do is work out the volumes.

\paragraph*{Notes}

06/13 -\/ N\+SH -\/ Coded and debugged. 08/15 -\/ K\+SL -\/ Updated for domains 

Definition at line 823 of file hydro\+\_\+import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=344pt]{templates_8h_a36f04216329e1a6ede98f9f9e0e3989b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6a70fbae6e163ad01aec40a2354ed674}\label{templates_8h_a6a70fbae6e163ad01aec40a2354ed674}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind@{rtheta\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind}}
\index{rtheta\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind@{rtheta\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind()}{rtheta\_is\_cell\_in\_wind()}}
{\footnotesize\ttfamily int rtheta\+\_\+is\+\_\+cell\+\_\+in\+\_\+wind (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



Check whether a cell in an rtheta coordiante system is in the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n The a cell number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An integer indicate whether the cell is in the wind, pratially in the wind, or not in the wind at all.
\end{DoxyReturn}
This routine performes is a robust check of whether a cell is in the wind or not.

\paragraph*{Notes}

The routine was created to speed up the evaluation of the volumes for the wind. It checks each of the four boundaries of the wind to see whether any portions of these are in the wind

Comment\+: The routine is only called by rtheta\+\_\+volumes, and so we already know that this cell is part of an rtheta coordiante system. 

Definition at line 916 of file rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=297pt]{templates_8h_a6a70fbae6e163ad01aec40a2354ed674_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{templates_8h_a6a70fbae6e163ad01aec40a2354ed674_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a29a481b4e0cfe03c2e99795dc24e10d1}\label{templates_8h_a29a481b4e0cfe03c2e99795dc24e10d1}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+make\+\_\+cones@{rtheta\+\_\+make\+\_\+cones}}
\index{rtheta\+\_\+make\+\_\+cones@{rtheta\+\_\+make\+\_\+cones}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+make\+\_\+cones()}{rtheta\_make\_cones()}}
{\footnotesize\ttfamily int rtheta\+\_\+make\+\_\+cones (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



defines the wind cones that are needed to calculate ds in a cell 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em int} & ndom The domain to populate with the cone structures \\
\hline
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w The structure which defines the wind in Python \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This subroutine defines cones that define the edges (in the theta directio) of wind cells.

\paragraph*{Notes}

Comment\+: It is not entirely clear why we don\textquotesingle{}t use fixed arrays for the cones in the domains. The data volume is small, and this would simplify windsave and windread. 

Definition at line 252 of file rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a29a481b4e0cfe03c2e99795dc24e10d1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{templates_8h_a29a481b4e0cfe03c2e99795dc24e10d1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4cb6c91545a34b48e5d6cd74a68665de}\label{templates_8h_a4cb6c91545a34b48e5d6cd74a68665de}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+make\+\_\+grid@{rtheta\+\_\+make\+\_\+grid}}
\index{rtheta\+\_\+make\+\_\+grid@{rtheta\+\_\+make\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+make\+\_\+grid()}{rtheta\_make\_grid()}}
{\footnotesize\ttfamily int rtheta\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Set up an rtheta grid. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The structure which defines entire wind \\
\hline
\mbox{\tt in}  & {\em int} & ndom The current domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\begin{DoxyVerb}For spherical polar, components we have defined the grid so that
i corresponds to a radial distance, and j corresponds to an angle,
e.g r theta.  increasing i corresponds to increasing distance,
and increasing theta corresponds to increasing angle measured from
the z axis. (This it should be fairly easy to implement true
spherical coordinates in the future.

There are two basic options:

The r-sapcing can be linear, or logarithmic.

The theta spacing is always linear
\end{DoxyVerb}


\paragraph*{Notes}

The parameters for describing the grid to be created must have to have been intialized and are part of the domain structure 

Definition at line 135 of file rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4cb6c91545a34b48e5d6cd74a68665de_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8b3c1f6c4930f2daf2e4b20af1956787}\label{templates_8h_a8b3c1f6c4930f2daf2e4b20af1956787}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+make\+\_\+grid\+\_\+import@{rtheta\+\_\+make\+\_\+grid\+\_\+import}}
\index{rtheta\+\_\+make\+\_\+grid\+\_\+import@{rtheta\+\_\+make\+\_\+grid\+\_\+import}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+make\+\_\+grid\+\_\+import()}{rtheta\_make\_grid\_import()}}
{\footnotesize\ttfamily int rtheta\+\_\+make\+\_\+grid\+\_\+import (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Use the imported data to initialize various portions of the Wind and Domain structures. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Wind\+Ptr} & w The wind structure \\
\hline
\mbox{\tt in}  & {\em int} & ndom The domain for the imported model \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine initializes the portions of the wind structure using the imported model, specirically those portions having to do with positions, and velocities.

\paragraph*{Notes}

The routine also initials wind\+\_\+x and wind\+\_\+z in the domain structure, ans sets up wind\+\_\+cones and other boundaries intended to bound the wind. 

Definition at line 257 of file import\+\_\+rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=298pt]{templates_8h_a8b3c1f6c4930f2daf2e4b20af1956787_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a38134c43cdc9afb2ef078514b06b4f88}\label{templates_8h_a38134c43cdc9afb2ef078514b06b4f88}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+make\+\_\+hydro\+\_\+grid@{rtheta\+\_\+make\+\_\+hydro\+\_\+grid}}
\index{rtheta\+\_\+make\+\_\+hydro\+\_\+grid@{rtheta\+\_\+make\+\_\+hydro\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+make\+\_\+hydro\+\_\+grid()}{rtheta\_make\_hydro\_grid()}}
{\footnotesize\ttfamily int rtheta\+\_\+make\+\_\+hydro\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Defines an r-\/theta grid to accept a hydro model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em w} & The wind pointer \\
\hline
\mbox{\tt in}  & {\em ndom} & The number of the domain which will be populated by the geometry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
rtheta\+\_\+make\+\_\+zeus\+\_\+grid defines the cells in a rtheta grid based upon the coordinates that can be read in from a zeus (the hydrocode used by Proga for some simulations)

\paragraph*{Notes}

06/13 -\/ N\+SH -\/ Coded and debugged. 

Definition at line 702 of file hydro\+\_\+import.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{templates_8h_a38134c43cdc9afb2ef078514b06b4f88_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a16377719f4171d75f5aa983c79476590}\label{templates_8h_a16377719f4171d75f5aa983c79476590}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+volumes@{rtheta\+\_\+volumes}}
\index{rtheta\+\_\+volumes@{rtheta\+\_\+volumes}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+volumes()}{rtheta\_volumes()}}
{\footnotesize\ttfamily int rtheta\+\_\+volumes (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



rtheta\+\_\+volume(w) calculates the wind volume of a cell in rtheta coordinate sysem allowing for the fact that some cells may not be in the active wind region 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w the entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\begin{DoxyVerb}ksl--04aug--some of the machinations regarding what to to at the
edge of the wind seem bizarre, like a substiture for figuring out
what one actually should be doing.  However, volume > 0 is used
for making certain choices in the existing code, and so one does
need to be careful.  The existing code does not accurately calcuate
the volume in the sense that it does not weight accroding to rho!
\end{DoxyVerb}


\paragraph*{Notes}

This is a brute-\/force integration of the volume

In calculating volumes we allow for the fact that a cell exists above and below the plane of the disk 

Definition at line 434 of file rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a16377719f4171d75f5aa983c79476590_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a711aa1dc0e92eff62111bf90e2a6b89e}\label{templates_8h_a711aa1dc0e92eff62111bf90e2a6b89e}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+where\+\_\+in\+\_\+grid@{rtheta\+\_\+where\+\_\+in\+\_\+grid}}
\index{rtheta\+\_\+where\+\_\+in\+\_\+grid@{rtheta\+\_\+where\+\_\+in\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+where\+\_\+in\+\_\+grid()}{rtheta\_where\_in\_grid()}}
{\footnotesize\ttfamily int rtheta\+\_\+where\+\_\+in\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_afd293c7e79b81faca3f4a2d115eaea6a}\label{templates_8h_afd293c7e79b81faca3f4a2d115eaea6a}} 
\index{templates.\+h@{templates.\+h}!rtheta\+\_\+wind\+\_\+complete@{rtheta\+\_\+wind\+\_\+complete}}
\index{rtheta\+\_\+wind\+\_\+complete@{rtheta\+\_\+wind\+\_\+complete}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtheta\+\_\+wind\+\_\+complete()}{rtheta\_wind\_complete()}}
{\footnotesize\ttfamily int rtheta\+\_\+wind\+\_\+complete (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Complete the creation of an rtheta wind comain by populating certain arrays used for interpolation. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain containing this wind component \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

This routine sets up a few arrays in domains that have rtheta coordiantes. These arrays are used to determine where in a cell one is, and how far it is to the edge of the cell for photon bundles.

The routine is called when the domain is set up, and called again whenever the windsave file is read in. 

Definition at line 310 of file rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_afd293c7e79b81faca3f4a2d115eaea6a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aabcf91dd6a4e633b1beb48978f9a71c1}\label{templates_8h_aabcf91dd6a4e633b1beb48978f9a71c1}} 
\index{templates.\+h@{templates.\+h}!rtsafe@{rtsafe}}
\index{rtsafe@{rtsafe}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{rtsafe()}{rtsafe()}}
{\footnotesize\ttfamily double rtsafe (\begin{DoxyParamCaption}\item[{void($\ast$)(double, double $\ast$, double $\ast$)}]{funcd,  }\item[{double}]{x1,  }\item[{double}]{x2,  }\item[{double}]{xacc }\end{DoxyParamCaption})}



A routine that mimimizes a function f. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$funcd} & \\
\hline
\mbox{\tt in}  & {\em x1} & \\
\hline
\mbox{\tt in}  & {\em x2} & \\
\hline
\mbox{\tt in}  & {\em xacc} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The minimum of the function f .
\end{DoxyReturn}
A Numerical Recipes routine to find the zero of an equation. A function which returns the value of the function and and the derivative at x is required. The root must be bracketed by x1 and x2.

\paragraph*{Notes}

Definition at line 366 of file recipes.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aabcf91dd6a4e633b1beb48978f9a71c1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a16363b5cd764e733bd84a0d991cb6568}\label{templates_8h_a16363b5cd764e733bd84a0d991cb6568}} 
\index{templates.\+h@{templates.\+h}!saha@{saha}}
\index{saha@{saha}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{saha()}{saha()}}
{\footnotesize\ttfamily int saha (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{ne,  }\item[{double}]{t }\end{DoxyParamCaption})}



Calculate the densities for all of the ions in a single cell given ne and t. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The cell \\
\hline
\mbox{\tt in}  & {\em double} & ne A trial value for ne \\
\hline
\mbox{\tt in}  & {\em double} & t A value of the temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The calculate abundances are stored in xplasma

This routine simply uses the Saha equantion to calculate the densities of all of the ions. It assumes that ne is known, and so in general if one calcualted ne from the concentrations, one would not get the input value. Iteration to calculate ne takes place in concentrations.

\paragraph*{Notes}

All of the partition functions are assumed to have been calculated before entering the routine. 

Definition at line 358 of file saha.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a16363b5cd764e733bd84a0d991cb6568_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=344pt]{templates_8h_a16363b5cd764e733bd84a0d991cb6568_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad9812264d4df596406d5878299e8b7e5}\label{templates_8h_ad9812264d4df596406d5878299e8b7e5}} 
\index{templates.\+h@{templates.\+h}!save\+\_\+extract\+\_\+photons@{save\+\_\+extract\+\_\+photons}}
\index{save\+\_\+extract\+\_\+photons@{save\+\_\+extract\+\_\+photons}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{save\+\_\+extract\+\_\+photons()}{save\_extract\_photons()}}
{\footnotesize\ttfamily int save\+\_\+extract\+\_\+photons (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{double $\ast$}]{v }\end{DoxyParamCaption})}



saves informations about phtoons in a particulare wavelength gange 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n The number of the spectrum \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p The photon before being doppler shifted \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & pp The phtoon after being doppler shiftd \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ v The velocity vector at the possibon of p/pp \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This diagnostic routine was proably written to address a concern about whether the photons were being properly doppler shifted on extract

\paragraph*{Notes}

Called from \hyperlink{extract_8c}{extract.\+c}, where currently one restricts the wavelenght range of the photons to around C\+IV 

Definition at line 348 of file diag.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad9812264d4df596406d5878299e8b7e5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1c8114c71c12528c31d3329d1a5a7777}\label{templates_8h_a1c8114c71c12528c31d3329d1a5a7777}} 
\index{templates.\+h@{templates.\+h}!save\+\_\+photon\+\_\+stats@{save\+\_\+photon\+\_\+stats}}
\index{save\+\_\+photon\+\_\+stats@{save\+\_\+photon\+\_\+stats}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{save\+\_\+photon\+\_\+stats()}{save\_photon\_stats()}}
{\footnotesize\ttfamily int save\+\_\+photon\+\_\+stats (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds,  }\item[{double}]{w\+\_\+ave }\end{DoxyParamCaption})}



prints photon statistics to a file 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one Wind\+Ptr for the cell \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p Photon pointer (for one photon) \\
\hline
\mbox{\tt in}  & {\em double} & ds ds travelled \\
\hline
\mbox{\tt in}  & {\em double} & w\+\_\+ave The avereage weight of the pohton as it travelled \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine checks whether this is one of a number of cells in which one wishes to record the photons statitics and if so writes out information about the phtoon to a file.

\paragraph*{Notes}

Called from radiation 

Definition at line 299 of file diag.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1c8114c71c12528c31d3329d1a5a7777_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8a47e3be8dabf79f57b228429bd33eb8}\label{templates_8h_a8a47e3be8dabf79f57b228429bd33eb8}} 
\index{templates.\+h@{templates.\+h}!save\+\_\+photons@{save\+\_\+photons}}
\index{save\+\_\+photons@{save\+\_\+photons}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{save\+\_\+photons()}{save\_photons()}}
{\footnotesize\ttfamily int save\+\_\+photons (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{char}]{comment\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_adaa6a9c682ca16156e768a39033e55c0}\label{templates_8h_adaa6a9c682ca16156e768a39033e55c0}} 
\index{templates.\+h@{templates.\+h}!scatter@{scatter}}
\index{scatter@{scatter}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{scatter()}{scatter()}}
{\footnotesize\ttfamily int scatter (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int $\ast$}]{nres,  }\item[{int $\ast$}]{nnscat }\end{DoxyParamCaption})}



determine a new direction and frequency for a photon that is in the wind 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p the photon of interest \\
\hline
\mbox{\tt in}  & {\em int} & $\ast$ nres either the number of the scatter or a nonresonant scatter if nres $<$ 0 \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ nnscat Returned from anisotropic thermal scattering model \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The results are stored in the Phot\+Ptr p which contains the direction and frequency of the scattered photon.

The routine calculates a new direction and frequency for a photon in both the resonant and non-\/resonant cases. In the frame of the wind, scattering is assumed to be isotropic.

\paragraph*{Notes}

This is the routine that is called when a resonant scatter does occur. It is relevant for both simple and macro atoms

The equations for the frequency shifts are accurate only to first order in beta

This routine should not move the photon at all, because other routines need to take this photon in differing directions, and if one moves it here they may encounter this resonance again 

Definition at line 985 of file resonate.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_adaa6a9c682ca16156e768a39033e55c0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4a12de5120dbfd2f67d3ac56645cb4e6}\label{templates_8h_a4a12de5120dbfd2f67d3ac56645cb4e6}} 
\index{templates.\+h@{templates.\+h}!scattering\+\_\+fraction@{scattering\+\_\+fraction}}
\index{scattering\+\_\+fraction@{scattering\+\_\+fraction}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{scattering\+\_\+fraction()}{scattering\_fraction()}}
{\footnotesize\ttfamily double scattering\+\_\+fraction (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



calculate the fraction of excited state atoms which correspond to scattered photons, i.\+e. the portion which are excited by radiation and return to the ground state via spontaneous emission. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & lines $\ast$ line\+\_\+ptr The line of interest \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The cell of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The fraction of excitations which result in a scattering event
\end{DoxyReturn}
In the radiative transfer equation for lines, we separate the fraction of photons which are \char`\"{}absorbed\char`\"{} and the fraction which are \char`\"{}scattered\char`\"{}. The results depend on the line mode


\begin{DoxyItemize}
\item If line\+\_\+mode==0, the atomosphere is a completely absorbing and no photons will be scattered. In this mode, assuming the wind is a source of emission, the emissivity will be the Einstein A coefficient
\item If line\+\_\+mode==1, the atmosphere is completely scattering, there will be no interchange of energy between the photons and the electrons as a result of radiation transfer
\item If line\+\_\+mode==2, then a simple single scattering approximation is applied in which case the scattered flux is just A21/(C21+\+A21$\ast$(1-\/exp(-\/h nu/k T\+\_\+e).
\item If line\+\_\+mode==3, then radiation trapping is included as well. The basic idea is to calculate the average number of scatters in a single interaction and there is heat lost in each of these scatters.
\end{DoxyItemize}

\paragraph*{Notes}

It may be more efficient to combine several of these routines in view of the fact that the exp is calculated several times

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000037}{Bug}]The modes used by scattering fraction are hardwired, which is not our standard approach. Note however there is a lot about the line\+\_\+mode which is quite complicated, not the least of which being that there is a related variable scatter\+\_\+mode\end{DoxyRefDesc}


Definition at line 684 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4a12de5120dbfd2f67d3ac56645cb4e6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4a12de5120dbfd2f67d3ac56645cb4e6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_adcc43b4ba5a867bfdfb8f3c05a70f20a}\label{templates_8h_adcc43b4ba5a867bfdfb8f3c05a70f20a}} 
\index{templates.\+h@{templates.\+h}!select\+\_\+continuum\+\_\+scattering\+\_\+process@{select\+\_\+continuum\+\_\+scattering\+\_\+process}}
\index{select\+\_\+continuum\+\_\+scattering\+\_\+process@{select\+\_\+continuum\+\_\+scattering\+\_\+process}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{select\+\_\+continuum\+\_\+scattering\+\_\+process()}{select\_continuum\_scattering\_process()}}
{\footnotesize\ttfamily int select\+\_\+continuum\+\_\+scattering\+\_\+process (\begin{DoxyParamCaption}\item[{double}]{kap\+\_\+cont,  }\item[{double}]{kap\+\_\+es,  }\item[{double}]{kap\+\_\+ff,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



determine what continuum process was that caused the scatter and returns this to the main routine. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & kap\+\_\+cont The continuum opacity \\
\hline
\mbox{\tt in}  & {\em double} & kap\+\_\+es The electron scattering opacity \\
\hline
\mbox{\tt in}  & {\em double} & kap\+\_\+ff The free free opacity \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The plasma cell where everyting is being calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The process that cause the photon to stop/scatter at a particular point
\end{DoxyReturn}
This routine is called to determine which of several continuum proceseses cause a photon to be scattered or absorpbed. In addition to electron scattering and free-\/free absorption, the routine can identify which photoionization process is implicated.

\paragraph*{Notes}

select\+\_\+continuum\+\_\+scattering\+\_\+proces is called when it has already been determined that a photon will stop or be scattered due to some continuum process. This determination is based on the total continuum opacity. In this routine a random number is generated and this is used to determine which of the processes was responsible. Data for the opacity due to photonionization is passed remotely via the Plasma\+Ptr. 

Definition at line 515 of file resonate.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_adcc43b4ba5a867bfdfb8f3c05a70f20a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{templates_8h_adcc43b4ba5a867bfdfb8f3c05a70f20a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a53d75807008c96f7053e25e029ed8a95}\label{templates_8h_a53d75807008c96f7053e25e029ed8a95}} 
\index{templates.\+h@{templates.\+h}!set\+\_\+max\+\_\+time@{set\+\_\+max\+\_\+time}}
\index{set\+\_\+max\+\_\+time@{set\+\_\+max\+\_\+time}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{set\+\_\+max\+\_\+time()}{set\_max\_time()}}
{\footnotesize\ttfamily int set\+\_\+max\+\_\+time (\begin{DoxyParamCaption}\item[{char $\ast$}]{root,  }\item[{double}]{t }\end{DoxyParamCaption})}



Set the maximum time the program should run. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em char} & $\ast$ root Root name of the .sig file where the max time is recorded \\
\hline
\mbox{\tt in,out}  & {\em double} & t The maximum time one wants to proposal to run \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine simple sets the max\+\_\+time (an external variable) and writs information about this to .sig and log files.

\paragraph*{Notes}

Definition at line 223 of file signal.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a53d75807008c96f7053e25e029ed8a95_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac88fda6c445f7e99eb1238b8132576ad}\label{templates_8h_ac88fda6c445f7e99eb1238b8132576ad}} 
\index{templates.\+h@{templates.\+h}!setup\+\_\+created\+\_\+files@{setup\+\_\+created\+\_\+files}}
\index{setup\+\_\+created\+\_\+files@{setup\+\_\+created\+\_\+files}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{setup\+\_\+created\+\_\+files()}{setup\_created\_files()}}
{\footnotesize\ttfamily int setup\+\_\+created\+\_\+files (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Use the root name of the .pf file to create names for the various output files written by Python. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This names of the files python uses are stored in he filenames structure. This routine uses the root of the .pf file to create names for all of the files that Python will write and stores them in the files structure

The routine also opens the parameter file if it exists

\paragraph*{Notes}

The routine establishes the names of files, but does not open them. 

Definition at line 120 of file setup\+\_\+files.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{templates_8h_ac88fda6c445f7e99eb1238b8132576ad_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab0e6804f11862cb19cf6ac6976480c3f}\label{templates_8h_ab0e6804f11862cb19cf6ac6976480c3f}} 
\index{templates.\+h@{templates.\+h}!setup\+\_\+dfudge@{setup\+\_\+dfudge}}
\index{setup\+\_\+dfudge@{setup\+\_\+dfudge}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{setup\+\_\+dfudge()}{setup\_dfudge()}}
{\footnotesize\ttfamily double setup\+\_\+dfudge (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Sets a global \char`\"{}push\+\_\+through\+\_\+distance\char`\"{} designed to prevent photons from being trapped at boundaries. 

\begin{DoxyReturn}{Returns}
dfudge the push through distance
\end{DoxyReturn}
dfudge is intended to be a small positive number that prevents photons from being trapped at the edges of cells or wind cones. It is often added to the distance to an \char`\"{}edge\char`\"{} to push the photon thorough whatever boundary is being calculated.

\paragraph*{Notes}

setup\+\_\+dfudge is used to modify the variable D\+F\+U\+D\+GE which can be found in \hyperlink{python_8h}{python.\+h}.

Originally, D\+F\+U\+D\+GE was the only number used to push through boundariies, but today D\+F\+U\+D\+GE is used sparingly, if at all, as push tryough distances within wind cells are defined differently for each cell.

There are two competing factors in defining D\+F\+U\+D\+GE. It should be short enough so that the push through distane goes only a small way into s cell. It should be large enough though that round-\/off errors do not prevent one from actually getting into a cell.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000055}{Bug}]This routine does not really belong in this file. It should be moved. \end{DoxyRefDesc}


Definition at line 703 of file setup.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{templates_8h_ab0e6804f11862cb19cf6ac6976480c3f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a404b09d110445816d66969489b854756}\label{templates_8h_a404b09d110445816d66969489b854756}} 
\index{templates.\+h@{templates.\+h}!setup\+\_\+windcone@{setup\+\_\+windcone}}
\index{setup\+\_\+windcone@{setup\+\_\+windcone}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{setup\+\_\+windcone()}{setup\_windcone()}}
{\footnotesize\ttfamily int setup\+\_\+windcone (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



sets up the windcones for each domain 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine takes input variables, the minimim and maximum radius of the wind at the disk, and the flow angles bounding the wind, and calculates the variables used to define the cones that bound each wind domain involving biconical flows.

\paragraph*{Notes}

The routine cycles through all of the existing domains, and uses variables which have been read in or entered previously.

The input variables that are used are typicall, wind\+\_\+rho\+\_\+min, wind\+\_\+rho\+\_\+max and wind\+\_\+thetamin and max. They are defined in routines like, get\+\_\+sv\+\_\+parameters.

The angles thetamin and thetamax are all defined from the z axis, so that an angle of 0 is a flow that is perpindicular to to the disk and one that is close to 90 degrees will be parallel to the plane of the disk

The routine files a structure of type cone, that contain, an element z, the place where the windcone intercepts the z axis, and an element dzdr is the slope of the cone

Wind cones are defined azimuthally around the z axis.

For models that are not biconical flows, the windcones are set to include the entire domain. 

Definition at line 463 of file setup\+\_\+domains.\+c.

\mbox{\Hypertarget{templates_8h_a1df8af4539e5836b6a2f8dab9f88572e}\label{templates_8h_a1df8af4539e5836b6a2f8dab9f88572e}} 
\index{templates.\+h@{templates.\+h}!shell\+\_\+make\+\_\+grid@{shell\+\_\+make\+\_\+grid}}
\index{shell\+\_\+make\+\_\+grid@{shell\+\_\+make\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{shell\+\_\+make\+\_\+grid()}{shell\_make\_grid()}}
{\footnotesize\ttfamily int shell\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



defines the cells in a thin shell, a special case of a spherical wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w The structure which defines the wind in Python \\
\hline
\mbox{\tt in,out}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always retunrs 0
\end{DoxyReturn}
The shell wind has 3 elements, one inside the shell, one outside, and one outside and one shell exactly fitting the shell.

\paragraph*{Notes}

The shell wind is intended for diagnostic purposes 

Definition at line 585 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{templates_8h_a1df8af4539e5836b6a2f8dab9f88572e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_add111df2de1b0fadab91816f33ee5266}\label{templates_8h_add111df2de1b0fadab91816f33ee5266}} 
\index{templates.\+h@{templates.\+h}!sigma\+\_\+compton\+\_\+partial@{sigma\+\_\+compton\+\_\+partial}}
\index{sigma\+\_\+compton\+\_\+partial@{sigma\+\_\+compton\+\_\+partial}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sigma\+\_\+compton\+\_\+partial()}{sigma\_compton\_partial()}}
{\footnotesize\ttfamily double sigma\+\_\+compton\+\_\+partial (\begin{DoxyParamCaption}\item[{double}]{f,  }\item[{double}]{x }\end{DoxyParamCaption})}



is the Klein Nishina cross section as a function of the fractional energy change 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & f -\/ the fractional energy change \\
\hline
\mbox{\tt in}  & {\em double} & x the energy of the incoming photon divided by the rest mass energy of an electron \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the cross section for the scattering angle that gives this fractional energy change.
\end{DoxyReturn}
This is a functiuon which returns the Klein-\/\+Nishina cross section implied by a supplied fractional energy change for an incoming photon.

\paragraph*{Notes}

Stuart Sim supplied this formula, but coundn\textquotesingle{}t recall where he had found it, although he had rederived it and thinks it is correct! 

Definition at line 400 of file compton.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_add111df2de1b0fadab91816f33ee5266_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a426bb5a912e3fd43013ffec072376b4a}\label{templates_8h_a426bb5a912e3fd43013ffec072376b4a}} 
\index{templates.\+h@{templates.\+h}!sigma\+\_\+phot@{sigma\+\_\+phot}}
\index{sigma\+\_\+phot@{sigma\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sigma\+\_\+phot()}{sigma\_phot()}}
{\footnotesize\ttfamily double sigma\+\_\+phot (\begin{DoxyParamCaption}\item[{struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$}]{x\+\_\+ptr,  }\item[{double}]{freq }\end{DoxyParamCaption})}



calculates the photionization crossection due to a Topbase level associated with x\+\_\+ptr at frequency freq 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em struct} & \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ x\+\_\+ptr The structure that contains Top\+Base information about the photoionization x-\/section \\
\hline
\mbox{\tt in}  & {\em double} & freq The frequency where the x-\/section is to be calculated\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The x-\/section
\end{DoxyReturn}
sigma\+\_\+phot uses the Topbase x-\/sections to calculate the bound free (or photoionization) xsection. The data must have been into the photoionization structures xphot with get\+\_\+atomic\+\_\+data and the densities of individual ions must have been calculated previously.

\paragraph*{Notes}

Definition at line 731 of file radiation.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=208pt]{templates_8h_a426bb5a912e3fd43013ffec072376b4a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=216pt]{templates_8h_a426bb5a912e3fd43013ffec072376b4a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9b943f07de31437e68d5a62c4d007588}\label{templates_8h_a9b943f07de31437e68d5a62c4d007588}} 
\index{templates.\+h@{templates.\+h}!sigma\+\_\+phot\+\_\+verner@{sigma\+\_\+phot\+\_\+verner}}
\index{sigma\+\_\+phot\+\_\+verner@{sigma\+\_\+phot\+\_\+verner}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sigma\+\_\+phot\+\_\+verner()}{sigma\_phot\_verner()}}
{\footnotesize\ttfamily double sigma\+\_\+phot\+\_\+verner (\begin{DoxyParamCaption}\item[{struct \hyperlink{structinnershell}{innershell} $\ast$}]{x\+\_\+ptr,  }\item[{double}]{freq }\end{DoxyParamCaption})}



double (x\+\_\+ptr,freq) calculates the photionization crossection due to the transition associated with x\+\_\+ptr at frequency freq (when the data is in the form of the Verner x-\/sections 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & innershell $\ast$ x\+\_\+ptr The stucture that contains information in the format of Verner for a particular ion level \\
\hline
\mbox{\tt in,out}  & {\em double} & freq The frequency where the x-\/section is calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The photoinization x-\/section
\end{DoxyReturn}
Same as sigma\+\_\+phot but using the older compilation from Verner that includes inner shells

\paragraph*{Notes}

I (N\+SH) think this routine has been largely superceeded by the new inner shell formulation of auger ionization. At some poi nt we may wish to expunge the old augerion perts of python. 

Definition at line 815 of file radiation.\+c.

\mbox{\Hypertarget{templates_8h_a7719923b66bf470bc4eeb42c454ebd48}\label{templates_8h_a7719923b66bf470bc4eeb42c454ebd48}} 
\index{templates.\+h@{templates.\+h}!simple\+\_\+paths\+\_\+gen\+\_\+phot@{simple\+\_\+paths\+\_\+gen\+\_\+phot}}
\index{simple\+\_\+paths\+\_\+gen\+\_\+phot@{simple\+\_\+paths\+\_\+gen\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{simple\+\_\+paths\+\_\+gen\+\_\+phot()}{simple\_paths\_gen\_phot()}}
{\footnotesize\ttfamily int simple\+\_\+paths\+\_\+gen\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



Generates path for a \textquotesingle{}wind\textquotesingle{} photon in photon mode. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em pp} & Photon to set path of \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Finds the straight-\/line distance between photon and the outer star radius, sets minimum path to that. Used in photon mode, and in all modes for non-\/wind starting paths.

\paragraph*{Notes}

20/8/15 -\/ Written by S\+WM 

Definition at line 324 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{templates_8h_a7719923b66bf470bc4eeb42c454ebd48_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=302pt]{templates_8h_a7719923b66bf470bc4eeb42c454ebd48_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af9a097a1df32d54cc7161c02a07c7894}\label{templates_8h_af9a097a1df32d54cc7161c02a07c7894}} 
\index{templates.\+h@{templates.\+h}!sobolev@{sobolev}}
\index{sobolev@{sobolev}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sobolev()}{sobolev()}}
{\footnotesize\ttfamily double sobolev (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{den\+\_\+ion,  }\item[{struct \hyperlink{structlines}{lines} $\ast$}]{lptr,  }\item[{double}]{dvds }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a37b054a7922fd8ef0a3c003f01b0aa2d}\label{templates_8h_a37b054a7922fd8ef0a3c003f01b0aa2d}} 
\index{templates.\+h@{templates.\+h}!solve\+\_\+matrix@{solve\+\_\+matrix}}
\index{solve\+\_\+matrix@{solve\+\_\+matrix}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{solve\+\_\+matrix()}{solve\_matrix()}}
{\footnotesize\ttfamily int solve\+\_\+matrix (\begin{DoxyParamCaption}\item[{double $\ast$}]{a\+\_\+data,  }\item[{double $\ast$}]{b\+\_\+data,  }\item[{int}]{nrows,  }\item[{double $\ast$}]{x,  }\item[{int}]{nplasma }\end{DoxyParamCaption})}



solves the matrix equation A x = b for the vector x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & a\+\_\+data -\/ the square rate matric \\
\hline
\mbox{\tt in}  & {\em double} & b\+\_\+data -\/ the vector of total elemental abundances \\
\hline
\mbox{\tt in}  & {\em int} & nrows -\/ the number of rows (and columns) in the a matrix \\
\hline
\mbox{\tt out}  & {\em double} & x -\/ the ionic abundances calculated here \\
\hline
\mbox{\tt in}  & {\em int} & nplasma -\/ the index of the plasma cell we are working on -\/ only used for reporting errors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int ierr -\/ a number defining any error state
\end{DoxyReturn}
Performs a matrix inversion to solve Ax=b for x. Most of the algorithms used for this are from the gsl library

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 632 of file matrix\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a37b054a7922fd8ef0a3c003f01b0aa2d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=269pt]{templates_8h_a37b054a7922fd8ef0a3c003f01b0aa2d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a8012f489c5fe73ae85b4e317f8bb6059}\label{templates_8h_a8012f489c5fe73ae85b4e317f8bb6059}} 
\index{templates.\+h@{templates.\+h}!sort\+\_\+and\+\_\+compress@{sort\+\_\+and\+\_\+compress}}
\index{sort\+\_\+and\+\_\+compress@{sort\+\_\+and\+\_\+compress}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sort\+\_\+and\+\_\+compress()}{sort\_and\_compress()}}
{\footnotesize\ttfamily int sort\+\_\+and\+\_\+compress (\begin{DoxyParamCaption}\item[{double $\ast$}]{array\+\_\+in,  }\item[{double $\ast$}]{array\+\_\+out,  }\item[{int}]{npts }\end{DoxyParamCaption})}



sort an array into numerical order elimination duplicates 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & $\ast$ array\+\_\+in The input array \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ array\+\_\+out The output array \\
\hline
\mbox{\tt in}  & {\em int} & npts The number of points in the input array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number of valid element in the output array
\end{DoxyReturn}
The routine uses the G\+SL routine qsort to sort the array in place, and then copies unique elements of the sorted array into the output array.

\paragraph*{Notes}

The routine is used in the creation of cdfs, which need arrays which are sorted into numerical order, and for which one really does not wish duplicated values. 

Definition at line 1703 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{templates_8h_a8012f489c5fe73ae85b4e317f8bb6059_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=237pt]{templates_8h_a8012f489c5fe73ae85b4e317f8bb6059_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abaf08b81d739ed75e14ee5932317af2d}\label{templates_8h_abaf08b81d739ed75e14ee5932317af2d}} 
\index{templates.\+h@{templates.\+h}!spec\+\_\+read@{spec\+\_\+read}}
\index{spec\+\_\+read@{spec\+\_\+read}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spec\+\_\+read()}{spec\_read()}}
{\footnotesize\ttfamily int spec\+\_\+read (\begin{DoxyParamCaption}\item[{char}]{filename\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a2bf66d8d630de2eee13ab88a332cbbfc}\label{templates_8h_a2bf66d8d630de2eee13ab88a332cbbfc}} 
\index{templates.\+h@{templates.\+h}!spec\+\_\+save@{spec\+\_\+save}}
\index{spec\+\_\+save@{spec\+\_\+save}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spec\+\_\+save()}{spec\_save()}}
{\footnotesize\ttfamily int spec\+\_\+save (\begin{DoxyParamCaption}\item[{char}]{filename\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_abe28dc93125bf28e9c3dcef85428b16a}\label{templates_8h_abe28dc93125bf28e9c3dcef85428b16a}} 
\index{templates.\+h@{templates.\+h}!spectral\+\_\+estimators@{spectral\+\_\+estimators}}
\index{spectral\+\_\+estimators@{spectral\+\_\+estimators}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spectral\+\_\+estimators()}{spectral\_estimators()}}
{\footnotesize\ttfamily int spectral\+\_\+estimators (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma }\end{DoxyParamCaption})}



Calculate the parameters of a model for J\+\_\+nu in a cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma Pointer to the plasma structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful
\end{DoxyReturn}
This routine uses the mean frequency (calculated in the photon transsport cycle) find a power law model and an exponential model. It then uses the standard deviation to decide which is best. The routine is called from \hyperlink{ionization_8c}{ionization.\+c} The results are stored in parameters in the Plasma\+Ptr structure in variables, such as spec\+\_\+mod\+\_\+type, pl\+\_\+alpah, pl\+\_\+log,exp\+\_\+temp, etc.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 52 of file spectral\+\_\+estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abe28dc93125bf28e9c3dcef85428b16a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3e05df283bba500d0e7a307679b291d6}\label{templates_8h_a3e05df283bba500d0e7a307679b291d6}} 
\index{templates.\+h@{templates.\+h}!spectrum\+\_\+create@{spectrum\+\_\+create}}
\index{spectrum\+\_\+create@{spectrum\+\_\+create}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spectrum\+\_\+create()}{spectrum\_create()}}
{\footnotesize\ttfamily int spectrum\+\_\+create (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nangle,  }\item[{int}]{select\+\_\+extract }\end{DoxyParamCaption})}



Increments the spectrum arrays after each flight of photons is processed (during ionization cycles and for detailed spectra in the Live or Die option). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p A flight of photons \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequncy in the spectrum \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency in the spectrum \\
\hline
\mbox{\tt in}  & {\em int} & nangle The number of different angles and phases for which to create detailed spectra \\
\hline
\mbox{\tt in}  & {\em int} & select\+\_\+extract The integer stating whether the Live or Die option has \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine increments the total spectrum arrays based on what has happened to each photon during ionization cycles. In the Live or Die option, the spectra at specific angles are also created here when detailed spectra are created.

The routine is called after each batch of photons has been transported through the wind and prints some intermediate results to assure the user that the program is still running.

\paragraph*{Notes}

Summing up of the spectra in the \char`\"{}extract\char`\"{} option is done in \hyperlink{extract_8c}{extract.\+c}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000059}{Bug}]To create spectra in the live or die option which are selected on the number of scatters individual photons undergo, there are some additional changes required to this routine. These changes should parallel those now in extract under the normal option. 97aug29\end{DoxyRefDesc}


Definition at line 427 of file spectra.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3e05df283bba500d0e7a307679b291d6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4dfd9797e2dca42842f8082b5f8e96c4}\label{templates_8h_a4dfd9797e2dca42842f8082b5f8e96c4}} 
\index{templates.\+h@{templates.\+h}!spectrum\+\_\+init@{spectrum\+\_\+init}}
\index{spectrum\+\_\+init@{spectrum\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spectrum\+\_\+init()}{spectrum\_init()}}
{\footnotesize\ttfamily int spectrum\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nangle,  }\item[{double}]{angle\mbox{[}$\,$\mbox{]},  }\item[{double}]{phase\mbox{[}$\,$\mbox{]},  }\item[{int}]{scat\+\_\+select\mbox{[}$\,$\mbox{]},  }\item[{int}]{top\+\_\+bot\+\_\+select\mbox{[}$\,$\mbox{]},  }\item[{int}]{select\+\_\+extract,  }\item[{double}]{rho\+\_\+select\mbox{[}$\,$\mbox{]},  }\item[{double}]{z\+\_\+select\mbox{[}$\,$\mbox{]},  }\item[{double}]{az\+\_\+select\mbox{[}$\,$\mbox{]},  }\item[{double}]{r\+\_\+select\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a6d37ca5473b25832956cb6988e1b4ed5}\label{templates_8h_a6d37ca5473b25832956cb6988e1b4ed5}} 
\index{templates.\+h@{templates.\+h}!spectrum\+\_\+restart\+\_\+renormalise@{spectrum\+\_\+restart\+\_\+renormalise}}
\index{spectrum\+\_\+restart\+\_\+renormalise@{spectrum\+\_\+restart\+\_\+renormalise}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spectrum\+\_\+restart\+\_\+renormalise()}{spectrum\_restart\_renormalise()}}
{\footnotesize\ttfamily int spectrum\+\_\+restart\+\_\+renormalise (\begin{DoxyParamCaption}\item[{int}]{nangle }\end{DoxyParamCaption})}



renormalizes the detailed spectra in case of a restart 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nangle The number of discrete angles \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine deals with a very special case when one is restarting a previous run, and adding spectral cycles to obtain a detailed spectrum with higher statistics.

In the previous run, the spectral will have been normalized so that one gets the correct flux for the simulation. We are now computing additional spectral cycles, so we have to reduce the fluxes for the spectral cycles that are read in, so we can continue. renorm\+\_\+factor = (cycles in old pf file) / (cycles in new pf file)

\paragraph*{Notes}

see Issue \#134 

Definition at line 1019 of file spectra.\+c.

\mbox{\Hypertarget{templates_8h_a8e643e0881e482c11120d32f41ff00c0}\label{templates_8h_a8e643e0881e482c11120d32f41ff00c0}} 
\index{templates.\+h@{templates.\+h}!spectrum\+\_\+summary@{spectrum\+\_\+summary}}
\index{spectrum\+\_\+summary@{spectrum\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spectrum\+\_\+summary()}{spectrum\_summary()}}
{\footnotesize\ttfamily int spectrum\+\_\+summary (\begin{DoxyParamCaption}\item[{char}]{filename\mbox{[}$\,$\mbox{]},  }\item[{int}]{nspecmin,  }\item[{int}]{nspecmax,  }\item[{int}]{select\+\_\+spectype,  }\item[{double}]{renorm,  }\item[{int}]{loglin,  }\item[{int}]{iwind }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a3810d91d16158ce91d1247c4df1ede09}\label{templates_8h_a3810d91d16158ce91d1247c4df1ede09}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+ds\+\_\+in\+\_\+cell@{spherical\+\_\+ds\+\_\+in\+\_\+cell}}
\index{spherical\+\_\+ds\+\_\+in\+\_\+cell@{spherical\+\_\+ds\+\_\+in\+\_\+cell}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+ds\+\_\+in\+\_\+cell()}{spherical\_ds\_in\_cell()}}
{\footnotesize\ttfamily double spherical\+\_\+ds\+\_\+in\+\_\+cell (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



calculates the distance to the far boundary of the cell in which the photon bundle resides. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain in which the photon resides \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Distance to the far boundary of the cell in which the photon currently resides. Negative numbers (and zero) should be regarded as errors.
\end{DoxyReturn}
The routine simply determines which grid cell the photon is in and then solves two quadradic equations for the distance to the inner and outer boundary of the cell. The routine returns the smallest positive distance.

\paragraph*{Notes}

Definition at line 84 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3810d91d16158ce91d1247c4df1ede09_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6c5300254db561924aba1c13186be975}\label{templates_8h_a6c5300254db561924aba1c13186be975}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+extend\+\_\+density@{spherical\+\_\+extend\+\_\+density}}
\index{spherical\+\_\+extend\+\_\+density@{spherical\+\_\+extend\+\_\+density}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+extend\+\_\+density()}{spherical\_extend\_density()}}
{\footnotesize\ttfamily int spherical\+\_\+extend\+\_\+density (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



extends the density to regions just outside the wind regiions so that extrapolations of density can be made there 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w The enetire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
In order for density to be continuous within the grid, and to enable linear interpolation everwhere, we need to define a density in the guard cells inside and outside the wind region.

This routine accomplishes this by assignining an element in the plasma structure to the guard cells.

\paragraph*{Notes}

In principle one could interpolate on any of the prameters in the plasma stucture, but in reality the main thing this is used for is to assure tha ion denisites are continuous. 

Definition at line 516 of file spherical.\+c.

\mbox{\Hypertarget{templates_8h_a01eb12e765998d3b9b350b3d8834347f}\label{templates_8h_a01eb12e765998d3b9b350b3d8834347f}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+get\+\_\+random\+\_\+location@{spherical\+\_\+get\+\_\+random\+\_\+location}}
\index{spherical\+\_\+get\+\_\+random\+\_\+location@{spherical\+\_\+get\+\_\+random\+\_\+location}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+get\+\_\+random\+\_\+location()}{spherical\_get\_random\_location()}}
{\footnotesize\ttfamily int spherical\+\_\+get\+\_\+random\+\_\+location (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_abc3da46eefcdd64c79fd792439a5b53d}\label{templates_8h_abc3da46eefcdd64c79fd792439a5b53d}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+make\+\_\+grid@{spherical\+\_\+make\+\_\+grid}}
\index{spherical\+\_\+make\+\_\+grid@{spherical\+\_\+make\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+make\+\_\+grid()}{spherical\_make\_grid()}}
{\footnotesize\ttfamily int spherical\+\_\+make\+\_\+grid (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



defines the cells in a spherical grid 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The structure which defines the wind in Python \\
\hline
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine defines the boundaries of cells for a spherical grid in the appropriate parts of the wind domain In spherical coordinates w runs from 0 to n.

\paragraph*{Notes}

The centers of the grid cells are defined in the xz plane at a 45 degree angle. This was done so that one would be in a plausible region of a biconical wind. 

Definition at line 144 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{templates_8h_abc3da46eefcdd64c79fd792439a5b53d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a635decc081c41b8ab55d8b547408970a}\label{templates_8h_a635decc081c41b8ab55d8b547408970a}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+make\+\_\+grid\+\_\+import@{spherical\+\_\+make\+\_\+grid\+\_\+import}}
\index{spherical\+\_\+make\+\_\+grid\+\_\+import@{spherical\+\_\+make\+\_\+grid\+\_\+import}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+make\+\_\+grid\+\_\+import()}{spherical\_make\_grid\_import()}}
{\footnotesize\ttfamily int spherical\+\_\+make\+\_\+grid\+\_\+import (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Use the imported data to initialize various portions of the Wind and Domain structures. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in}  & {\em int} & ndom The domain for the imported model \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine initializes the portions of the wind structure using the imported model, specifically those portions having to do with positions.

\paragraph*{Notes}

Definition at line 163 of file import\+\_\+spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=303pt]{templates_8h_a635decc081c41b8ab55d8b547408970a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1c6dbd2946a218d14cf553a59e41d189}\label{templates_8h_a1c6dbd2946a218d14cf553a59e41d189}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+volumes@{spherical\+\_\+volumes}}
\index{spherical\+\_\+volumes@{spherical\+\_\+volumes}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+volumes()}{spherical\_volumes()}}
{\footnotesize\ttfamily int spherical\+\_\+volumes (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



spherical\+\_\+volume(w) calculates the wind volume of cell allowing for the fact that some cells are partially in the wind 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom the domain number \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w the entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine performs a simple 2d numerical integration to find out what fraction of a shell is in the wind of a specfic domain and uses this to calculate the volume that is in the wind.

\paragraph*{Notes}

The volume of edge cells are all set to 0 

Definition at line 272 of file spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{templates_8h_a1c6dbd2946a218d14cf553a59e41d189_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a7406e8182dece78e2612793e400d1540}\label{templates_8h_a7406e8182dece78e2612793e400d1540}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+where\+\_\+in\+\_\+grid@{spherical\+\_\+where\+\_\+in\+\_\+grid}}
\index{spherical\+\_\+where\+\_\+in\+\_\+grid@{spherical\+\_\+where\+\_\+in\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+where\+\_\+in\+\_\+grid()}{spherical\_where\_in\_grid()}}
{\footnotesize\ttfamily int spherical\+\_\+where\+\_\+in\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a223201f3c894676560fbd4d94e71c167}\label{templates_8h_a223201f3c894676560fbd4d94e71c167}} 
\index{templates.\+h@{templates.\+h}!spherical\+\_\+wind\+\_\+complete@{spherical\+\_\+wind\+\_\+complete}}
\index{spherical\+\_\+wind\+\_\+complete@{spherical\+\_\+wind\+\_\+complete}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{spherical\+\_\+wind\+\_\+complete()}{spherical\_wind\_complete()}}
{\footnotesize\ttfamily int spherical\+\_\+wind\+\_\+complete (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Initialize some arrays in a domain for a spherical system that are used in various interpolation routines. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom A domain which has a spherical grid defined \\
\hline
\mbox{\tt in}  & {\em Wind\+Ptr} & w the entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Alwasy returns 0
\end{DoxyReturn}
This simple little routine just populates one dimensional arrays that are used for interpolation.

\paragraph*{Notes}

Definition at line 219 of file spherical.\+c.

\mbox{\Hypertarget{templates_8h_a0bc15d347d507f21da65e37f659de349}\label{templates_8h_a0bc15d347d507f21da65e37f659de349}} 
\index{templates.\+h@{templates.\+h}!star\+\_\+init@{star\+\_\+init}}
\index{star\+\_\+init@{star\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{star\+\_\+init()}{star\_init()}}
{\footnotesize\ttfamily int star\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{double $\ast$}]{f }\end{DoxyParamCaption})}



(r, tstar, freqmin, freqmax, ioniz\+\_\+or\+\_\+final, f) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freqmin The minimum freqency for the band \\
\hline
\mbox{\tt in}  & {\em double} & freqmax The maximum freqency for the band \\
\hline
 & {\em \mbox{[}in} & out\mbox{]} int ioniz\+\_\+or\+\_\+final A flag indicating whether this is for an ionization cycle or a detailed spectrum cycle \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ f The baand limited luminosity of the star \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine calculates the luminosity of the star and the luminosity within the frequency boundaries.

\paragraph*{Notes}

The routine allows for backscattering of light onto the star assuming the user has opted to include this in the determination of the effective temperature of the star 

Definition at line 648 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0bc15d347d507f21da65e37f659de349_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0bc15d347d507f21da65e37f659de349_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a9376da4eeb7ef89e52a867eef104cc25}\label{templates_8h_a9376da4eeb7ef89e52a867eef104cc25}} 
\index{templates.\+h@{templates.\+h}!stellar\+\_\+rho@{stellar\+\_\+rho}}
\index{stellar\+\_\+rho@{stellar\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{stellar\+\_\+rho()}{stellar\_rho()}}
{\footnotesize\ttfamily double stellar\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8dfc0e90b2ec7d2039a8a72236f3fc8f}\label{templates_8h_a8dfc0e90b2ec7d2039a8a72236f3fc8f}} 
\index{templates.\+h@{templates.\+h}!stellar\+\_\+velocity@{stellar\+\_\+velocity}}
\index{stellar\+\_\+velocity@{stellar\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{stellar\+\_\+velocity()}{stellar\_velocity()}}
{\footnotesize\ttfamily double stellar\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a1c6dc9c24a43e2bc6319b23faba4a041}\label{templates_8h_a1c6dc9c24a43e2bc6319b23faba4a041}} 
\index{templates.\+h@{templates.\+h}!stuff\+\_\+phot@{stuff\+\_\+phot}}
\index{stuff\+\_\+phot@{stuff\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{stuff\+\_\+phot()}{stuff\_phot()}}
{\footnotesize\ttfamily int stuff\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pin,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pout }\end{DoxyParamCaption})}



Simply copy one photon bundle into another. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & pin The photon bundle to be copied \\
\hline
\mbox{\tt out}  & {\em Phot\+Ptr} & pout The Phot\+Ptr that contains the output \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This just a simple utility to copy a photon bundle

\paragraph*{Notes}

All variables are (or should be) copied. 

Definition at line 46 of file phot\+\_\+util.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{templates_8h_a1c6dc9c24a43e2bc6319b23faba4a041_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a917f837a1598fc3307b17cceef5f4340}\label{templates_8h_a917f837a1598fc3307b17cceef5f4340}} 
\index{templates.\+h@{templates.\+h}!stuff\+\_\+v@{stuff\+\_\+v}}
\index{stuff\+\_\+v@{stuff\+\_\+v}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{stuff\+\_\+v()}{stuff\_v()}}
{\footnotesize\ttfamily int stuff\+\_\+v (\begin{DoxyParamCaption}\item[{double}]{vin\mbox{[}$\,$\mbox{]},  }\item[{double}]{vout\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ad8e51a07835bbd92abe5584a7330d5e5}\label{templates_8h_ad8e51a07835bbd92abe5584a7330d5e5}} 
\index{templates.\+h@{templates.\+h}!sv\+\_\+find\+\_\+wind\+\_\+rzero@{sv\+\_\+find\+\_\+wind\+\_\+rzero}}
\index{sv\+\_\+find\+\_\+wind\+\_\+rzero@{sv\+\_\+find\+\_\+wind\+\_\+rzero}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sv\+\_\+find\+\_\+wind\+\_\+rzero()}{sv\_find\_wind\_rzero()}}
{\footnotesize\ttfamily double sv\+\_\+find\+\_\+wind\+\_\+rzero (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{p\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a4139b8cafcab2d2d4fb6d4da9c064dd2}\label{templates_8h_a4139b8cafcab2d2d4fb6d4da9c064dd2}} 
\index{templates.\+h@{templates.\+h}!sv\+\_\+rho@{sv\+\_\+rho}}
\index{sv\+\_\+rho@{sv\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sv\+\_\+rho()}{sv\_rho()}}
{\footnotesize\ttfamily double sv\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a0b95d81797f46e4870ae03311b4278ab}\label{templates_8h_a0b95d81797f46e4870ae03311b4278ab}} 
\index{templates.\+h@{templates.\+h}!sv\+\_\+theta\+\_\+wind@{sv\+\_\+theta\+\_\+wind}}
\index{sv\+\_\+theta\+\_\+wind@{sv\+\_\+theta\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sv\+\_\+theta\+\_\+wind()}{sv\_theta\_wind()}}
{\footnotesize\ttfamily double sv\+\_\+theta\+\_\+wind (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{r }\end{DoxyParamCaption})}



double (r) finds the angle at which the wind emerges from at a specific radius r on surface of the disk 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number \\
\hline
\mbox{\tt in}  & {\em double} & r a radial distance on the surface of the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An angle (in radians)
\end{DoxyReturn}
As long as r is between sv\+\_\+rmin and sv\+\_\+rmax, sv\+\_\+theta\+\_\+wind returns the angle given by the SV prescription.

Inside sv\+\_\+rmin, it returns a value which smoothly goes from thetamin to 0 as the radius goes to 0.

Outside sv\+\_\+rmax, it returns sv\+\_\+thetamax

\paragraph*{Notes}

Definition at line 482 of file sv.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0b95d81797f46e4870ae03311b4278ab_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a065ea7111a89ce368a02ab78addf16dd}\label{templates_8h_a065ea7111a89ce368a02ab78addf16dd}} 
\index{templates.\+h@{templates.\+h}!sv\+\_\+velocity@{sv\+\_\+velocity}}
\index{sv\+\_\+velocity@{sv\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sv\+\_\+velocity()}{sv\_velocity()}}
{\footnotesize\ttfamily double sv\+\_\+velocity (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]},  }\item[{int}]{ndom }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_af9d14b750645265f8bcb32d68f9a3832}\label{templates_8h_af9d14b750645265f8bcb32d68f9a3832}} 
\index{templates.\+h@{templates.\+h}!sv\+\_\+wind\+\_\+mdot\+\_\+integral@{sv\+\_\+wind\+\_\+mdot\+\_\+integral}}
\index{sv\+\_\+wind\+\_\+mdot\+\_\+integral@{sv\+\_\+wind\+\_\+mdot\+\_\+integral}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sv\+\_\+wind\+\_\+mdot\+\_\+integral()}{sv\_wind\_mdot\_integral()}}
{\footnotesize\ttfamily double sv\+\_\+wind\+\_\+mdot\+\_\+integral (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



The integrand required to calculate the normalization factor between the global mass loss rate and the mass loss per unit area at a particular place on the disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r A position (radius) on the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the integrand
\end{DoxyReturn}
The SV model is defined in terms of a mass loss rate per unit area. mdot is the total mass loss rate from the disk. In order to connect the local and global rates one must integrate the local mass loss rate and renormalize this.

\paragraph*{Notes}

The integration is carried out in get get\+\_\+sv\+\_\+wind\+\_\+params 

Definition at line 520 of file sv.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=273pt]{templates_8h_af9d14b750645265f8bcb32d68f9a3832_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{templates_8h_af9d14b750645265f8bcb32d68f9a3832_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a39a48868b268c8ac038661aecd465806}\label{templates_8h_a39a48868b268c8ac038661aecd465806}} 
\index{templates.\+h@{templates.\+h}!sv\+\_\+zero\+\_\+init@{sv\+\_\+zero\+\_\+init}}
\index{sv\+\_\+zero\+\_\+init@{sv\+\_\+zero\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sv\+\_\+zero\+\_\+init()}{sv\_zero\_init()}}
{\footnotesize\ttfamily int sv\+\_\+zero\+\_\+init (\begin{DoxyParamCaption}\item[{double}]{p\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a3e9f63d90b25108ed917dbd91583ab8f}\label{templates_8h_a3e9f63d90b25108ed917dbd91583ab8f}} 
\index{templates.\+h@{templates.\+h}!sv\+\_\+zero\+\_\+r@{sv\+\_\+zero\+\_\+r}}
\index{sv\+\_\+zero\+\_\+r@{sv\+\_\+zero\+\_\+r}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{sv\+\_\+zero\+\_\+r()}{sv\_zero\_r()}}
{\footnotesize\ttfamily double sv\+\_\+zero\+\_\+r (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



Routine used by zbrent to find a footpoint of a streamline in an SV model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r A position along the surface of the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if r is the footpoint
\end{DoxyReturn}
This routine is used to test whether a guess of r\+\_\+zero is correct. If you have the answer exactly then sv\+\_\+zero\+\_\+r will return 0

sv\+\_\+zero\+\_\+r is the routine called by the numerical recipes routine zbrent to walk down on the actual value of r in the disk.

sv\+\_\+zero\+\_\+r returns the difference between rho actual (sqrt x$\ast$x + y $\ast$y ) and rho\+\_\+guessed

\paragraph*{Notes}

Definition at line 440 of file sv.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{templates_8h_a3e9f63d90b25108ed917dbd91583ab8f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3e9f63d90b25108ed917dbd91583ab8f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a6a27d9f69b11280ae32d47603b94188a}\label{templates_8h_a6a27d9f69b11280ae32d47603b94188a}} 
\index{templates.\+h@{templates.\+h}!tau\+\_\+ave\+\_\+summary@{tau\+\_\+ave\+\_\+summary}}
\index{tau\+\_\+ave\+\_\+summary@{tau\+\_\+ave\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{tau\+\_\+ave\+\_\+summary()}{tau\_ave\_summary()}}
{\footnotesize\ttfamily int tau\+\_\+ave\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{int}]{element,  }\item[{int}]{istate,  }\item[{double}]{freq,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8f9228dcd9e8de7e3dce87f75812a958}\label{templates_8h_a8f9228dcd9e8de7e3dce87f75812a958}} 
\index{templates.\+h@{templates.\+h}!tau\+\_\+h\+\_\+summary@{tau\+\_\+h\+\_\+summary}}
\index{tau\+\_\+h\+\_\+summary@{tau\+\_\+h\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{tau\+\_\+h\+\_\+summary()}{tau\_h\_summary()}}
{\footnotesize\ttfamily int tau\+\_\+h\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ac6baffec2b7a559720f862e50cabec6f}\label{templates_8h_ac6baffec2b7a559720f862e50cabec6f}} 
\index{templates.\+h@{templates.\+h}!tb\+\_\+exp1@{tb\+\_\+exp1}}
\index{tb\+\_\+exp1@{tb\+\_\+exp1}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{tb\+\_\+exp1()}{tb\_exp1()}}
{\footnotesize\ttfamily double tb\+\_\+exp1 (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



The integrand for working out the PI rate in a radiation field modelled by an exponential. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq the frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of sigma J\+\_\+nu/nu at nu
\end{DoxyReturn}
This is the integrand for computing the PI rate coefficient when j\+\_\+nu is described by an exponential law. The returned value is J\+\_\+nu x cross section / nu.

\paragraph*{Notes}

Definition at line 305 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{templates_8h_ac6baffec2b7a559720f862e50cabec6f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=216pt]{templates_8h_ac6baffec2b7a559720f862e50cabec6f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab952e8ceb4c53ae59abe06169acce763}\label{templates_8h_ab952e8ceb4c53ae59abe06169acce763}} 
\index{templates.\+h@{templates.\+h}!tb\+\_\+logpow1@{tb\+\_\+logpow1}}
\index{tb\+\_\+logpow1@{tb\+\_\+logpow1}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{tb\+\_\+logpow1()}{tb\_logpow1()}}
{\footnotesize\ttfamily double tb\+\_\+logpow1 (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



The integrand for working out the PI rate in a radiation field modelled by a power law. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq the frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of sigma J\+\_\+nu/nu at nu
\end{DoxyReturn}
This is the integrand for computing the PI rate coefficient when j\+\_\+nu is described by a power law. The returned value is J\+\_\+nu x cross section / nu. The power law is computed in log space to allow a larger range of possible values.

\paragraph*{Notes}

Definition at line 278 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{templates_8h_ab952e8ceb4c53ae59abe06169acce763_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=228pt]{templates_8h_ab952e8ceb4c53ae59abe06169acce763_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae2e3418a581094a1c02352db778e3d12}\label{templates_8h_ae2e3418a581094a1c02352db778e3d12}} 
\index{templates.\+h@{templates.\+h}!tb\+\_\+planck1@{tb\+\_\+planck1}}
\index{tb\+\_\+planck1@{tb\+\_\+planck1}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{tb\+\_\+planck1()}{tb\_planck1()}}
{\footnotesize\ttfamily double tb\+\_\+planck1 (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



The integrand for working out the PI rate in a BB radiation field. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq the frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of sigma B\+\_\+nu/nu at nu
\end{DoxyReturn}
tb\+\_\+planck is the function a and is called by Qromb in order to integrate over the frequency range where the ionisation cross section is significant. This is the function for ions with a topbase cross section N\+SH

\paragraph*{Notes}

Definition at line 246 of file pi\+\_\+rates.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=224pt]{templates_8h_ae2e3418a581094a1c02352db778e3d12_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{templates_8h_ae2e3418a581094a1c02352db778e3d12_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_adc2a482ce6c550cd7e5498bf0ee1055b}\label{templates_8h_adc2a482ce6c550cd7e5498bf0ee1055b}} 
\index{templates.\+h@{templates.\+h}!tdisk@{tdisk}}
\index{tdisk@{tdisk}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{tdisk()}{tdisk()}}
{\footnotesize\ttfamily double tdisk (\begin{DoxyParamCaption}\item[{double}]{m,  }\item[{double}]{mdot,  }\item[{double}]{r }\end{DoxyParamCaption})}



Calculate the reference temperarure for a standard Shakura-\/\+Sunyaeev disk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & m mass of the central object \\
\hline
\mbox{\tt in}  & {\em double} & mdot mass accretion rate of the disk \\
\hline
\mbox{\tt in}  & {\em double} & r radiis of the central object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The reference temperature for the disk
\end{DoxyReturn}
All of the inputs are in cgs units

\paragraph*{Notes}

For an SS disk, The maximum temperature actuallly seen in the disk is 0.\+488 tdisk 

Definition at line 41 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_adc2a482ce6c550cd7e5498bf0ee1055b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3440890f45c87b4c79fef37820f87487}\label{templates_8h_a3440890f45c87b4c79fef37820f87487}} 
\index{templates.\+h@{templates.\+h}!teff@{teff}}
\index{teff@{teff}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{teff()}{teff()}}
{\footnotesize\ttfamily double teff (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{x }\end{DoxyParamCaption})}



Calculate the temperature of the disk at a normalised distance x. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t reference temperature of the disk in degrees \\
\hline
\mbox{\tt in}  & {\em double} & x distance from center of disk in units of r/rmin \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The temperature
\end{DoxyReturn}
The routine returns the effective temperature for the disk as a distance which is measured in terms of the ratio of the actual distance to the inner edge of the disk (rmin).

A number of modifications to a simple steady state disk are possible, depending on the variable geo.\+disk\+\_\+tprofile\+:


\begin{DoxyItemize}
\item D\+I\+S\+K\+\_\+\+T\+P\+R\+O\+F\+I\+L\+E\+\_\+\+R\+E\+A\+D\+IN the returned temperature is interpolated from values that been read in
\item D\+I\+S\+K\+\_\+\+T\+P\+R\+O\+F\+I\+L\+E\+\_\+\+Y\+SO an analytic profile implemented for Y\+S\+Os
\end{DoxyItemize}

In addition for a standard profile, this is where disk heading can optionally be taken into account

\paragraph*{Notes}

A reference for the standard steady state disk is Wade, 1984 M\+N\+R\+AS 208, 381 

Definition at line 83 of file disk.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3440890f45c87b4c79fef37820f87487_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a3440890f45c87b4c79fef37820f87487_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_acadd7fa5bd8a9673141a0de53d002aba}\label{templates_8h_acadd7fa5bd8a9673141a0de53d002aba}} 
\index{templates.\+h@{templates.\+h}!temp\+\_\+func@{temp\+\_\+func}}
\index{temp\+\_\+func@{temp\+\_\+func}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{temp\+\_\+func()}{temp\_func()}}
{\footnotesize\ttfamily double temp\+\_\+func (\begin{DoxyParamCaption}\item[{double}]{solv\+\_\+temp }\end{DoxyParamCaption})}



the function minimised by zbrent to find a temperature when the ion ratios are one (so the logarithm will be 0), to avoid numerical problems. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & solv\+\_\+temp The temperature where the ??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The result of the temp\+\_\+func calculation
\end{DoxyReturn}
It is the natural log of the saha equation with the ne taken to the R\+HS. The correction factors are applied after and depend on the temperature we find.

\paragraph*{Notes}

xxxne and xip are global variables which is declared above and assigned in the main variable\+\_\+temperature routine. 

Definition at line 548 of file variable\+\_\+temperature.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_acadd7fa5bd8a9673141a0de53d002aba_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a26d57a83794fb6663434158ab7e898cf}\label{templates_8h_a26d57a83794fb6663434158ab7e898cf}} 
\index{templates.\+h@{templates.\+h}!temp\+\_\+rad@{temp\+\_\+rad}}
\index{temp\+\_\+rad@{temp\+\_\+rad}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{temp\+\_\+rad()}{temp\_rad()}}
{\footnotesize\ttfamily int temp\+\_\+rad (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a5f3da2160302fbd2c3edcfabdd480bfe}\label{templates_8h_a5f3da2160302fbd2c3edcfabdd480bfe}} 
\index{templates.\+h@{templates.\+h}!temp\+\_\+summary@{temp\+\_\+summary}}
\index{temp\+\_\+summary@{temp\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{temp\+\_\+summary()}{temp\_summary()}}
{\footnotesize\ttfamily int temp\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_af5845b25bdbd8c63768154df5f3af346}\label{templates_8h_af5845b25bdbd8c63768154df5f3af346}} 
\index{templates.\+h@{templates.\+h}!thompson@{thompson}}
\index{thompson@{thompson}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{thompson()}{thompson()}}
{\footnotesize\ttfamily int thompson (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a766e9400cf36e77e8d5dc4c5289735e2}\label{templates_8h_a766e9400cf36e77e8d5dc4c5289735e2}} 
\index{templates.\+h@{templates.\+h}!timer@{timer}}
\index{timer@{timer}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{timer()}{timer()}}
{\footnotesize\ttfamily double timer (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Return the time in seconds since the timer was initiated. 

\begin{DoxyReturn}{Returns}
The time since t\+\_\+init
\end{DoxyReturn}
The first time the routine is called it gets the time in seconds sets t\+\_\+init to this $\ast$ and returns 0, Subsequently it returns the differecne

\paragraph*{Notes}

Uses gettimeofday 

Definition at line 47 of file time.\+c.

\mbox{\Hypertarget{templates_8h_ac9b0bd2eb8c4957c99a8c369d02cd169}\label{templates_8h_ac9b0bd2eb8c4957c99a8c369d02cd169}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+bb\+\_\+cooling@{total\+\_\+bb\+\_\+cooling}}
\index{total\+\_\+bb\+\_\+cooling@{total\+\_\+bb\+\_\+cooling}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+bb\+\_\+cooling()}{total\_bb\_cooling()}}
{\footnotesize\ttfamily double total\+\_\+bb\+\_\+cooling (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total cooling in matom bb transitions 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em doublet\+\_\+e} & electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the total cooling in bb transitions (due to collisions) for both macro atoms and simple ions. It is used by the heating/cooling calculation to get the temperature. 

Definition at line 682 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{templates_8h_ac9b0bd2eb8c4957c99a8c369d02cd169_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac9b0bd2eb8c4957c99a8c369d02cd169_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a560f4bd0619fdb29b85891d46ce63a48}\label{templates_8h_a560f4bd0619fdb29b85891d46ce63a48}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+comp@{total\+\_\+comp}}
\index{total\+\_\+comp@{total\+\_\+comp}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+comp()}{total\_comp()}}
{\footnotesize\ttfamily double total\+\_\+comp (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the cooling in the cell due to inverse compton scattering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one -\/ pointer to the current wind cell \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e -\/ electron temperature that we need the cooling rate for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the compton luminosity for the cell.
\end{DoxyReturn}
This routine computes the temperature dependant compton cooling rate in ergs/second. It is mainly called as part of the search for a new temperature balancing heating and cooling rates after an ionization cycle.

\paragraph*{Notes}

Compton cooling or \textquotesingle{}inverse compton scattering\textquotesingle{} is the process of energy transfer from hot electrons to \textquotesingle{}cool\textquotesingle{} phortons, that is when 4kT $>$ hnu. For each interaction, the fractional energy loss from the electrons is given by \{\} e\}\{e\} = 4k\+\_\+\+B\+T/mc$^\wedge$2. Where we have a model for the mean intensity of radiation in a cell, we are able to compute the cooling rate by doing an integration over the mean intensity multiplied by the frequency dependant cooling cross section. which looks like C=4k\+\_\+\+B\+T/mc$^\wedge$2 $\ast$ 4/pi \{ $\ast$ beta $\ast$ J\+\_\+\{\} d\}. Beta is the effective cooling cross section from fits in Hazy 3. If we are in the low frequency limit, we dont need to integrate, because the cooling cross section is not frequency depedant in the Thompson limit so we can just multiply by the band limited mean intensity. Simiularly, if we dont have a model -\/ we just do the best we can which is to multiply by the total integrated mean indensity times the Thormpson cross section. 

Definition at line 161 of file compton.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a560f4bd0619fdb29b85891d46ce63a48_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a560f4bd0619fdb29b85891d46ce63a48_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a56f9a736ea5fdd9b253e4a7fa07103ce}\label{templates_8h_a56f9a736ea5fdd9b253e4a7fa07103ce}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+di@{total\+\_\+di}}
\index{total\+\_\+di@{total\+\_\+di}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+di()}{total\_di()}}
{\footnotesize\ttfamily double total\+\_\+di (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



computes the total cooling due collisional ionization 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one pointer to cell \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total di cooling
\end{DoxyReturn}
This routine computes the total cooling rate in a cell due to collisional ionization. This is just the rate, times the ionization thereshold of the state being recombined into.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 183 of file direct\+\_\+ion.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a56f9a736ea5fdd9b253e4a7fa07103ce_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a56f9a736ea5fdd9b253e4a7fa07103ce_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abd4b0c8d02397f42187b29be6dcebc87}\label{templates_8h_abd4b0c8d02397f42187b29be6dcebc87}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+dr@{total\+\_\+dr}}
\index{total\+\_\+dr@{total\+\_\+dr}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+dr()}{total\_dr()}}
{\footnotesize\ttfamily double total\+\_\+dr (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e }\end{DoxyParamCaption})}



calculates the total luminosity from DR. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one Pointer to the wind cell currently under analysis \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e The temperature of the cell -\/ this is from the plasma structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the total luminosity of this cell due to dielectronic recombinaions -\/ currently set to zero
\end{DoxyReturn}
This routine is a placeholder at the moment -\/ it mirrors the other routines which compute the luminosity due to various cooling routines. However, as of the current time we do not know how to work out the luminosity from dielectronic recombination. We know the rate, which is used in ionization calculations but the energy released by each recombination is complex and depends on what happens to the excited ion.

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 200 of file dielectronic.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abd4b0c8d02397f42187b29be6dcebc87_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af6c4eca39f3573084c0a1ff2d9f22209}\label{templates_8h_af6c4eca39f3573084c0a1ff2d9f22209}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+emission@{total\+\_\+emission}}
\index{total\+\_\+emission@{total\+\_\+emission}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+emission()}{total\_emission()}}
{\footnotesize\ttfamily double total\+\_\+emission (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



Calculate the band-\/limited total emission of a single cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one The wind cell of interest \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency for the calculation \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency for the calculation \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
It returns the total luminosity, but also stores the luminosity due to various types of emssion, e.\+g ff, fb, lines, compton into the Plasms cells
\end{DoxyReturn}
\paragraph*{Notes}

Total emission gives the total enery loss due to photons. It does not include other cooling sources, e. g. adiabatic expansion.

It returns the total luminosity, but also stores the luminosity due to various types of emssion, e.\+g ff, fb, lines, compton into the Plasms cell assocatied with the wind cell.

Comment\+: Compton cooling is not included here. 

Definition at line 110 of file emission.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af6c4eca39f3573084c0a1ff2d9f22209_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af6c4eca39f3573084c0a1ff2d9f22209_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4bd01941ec880877c6dbd3cbd37aaf06}\label{templates_8h_a4bd01941ec880877c6dbd3cbd37aaf06}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+emission\+\_\+summary@{total\+\_\+emission\+\_\+summary}}
\index{total\+\_\+emission\+\_\+summary@{total\+\_\+emission\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+emission\+\_\+summary()}{total\_emission\_summary()}}
{\footnotesize\ttfamily int total\+\_\+emission\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9d0d69b33092d06a7174d71c3082d2a6}\label{templates_8h_a9d0d69b33092d06a7174d71c3082d2a6}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+fb@{total\+\_\+fb}}
\index{total\+\_\+fb@{total\+\_\+fb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+fb()}{total\_fb()}}
{\footnotesize\ttfamily double total\+\_\+fb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{fb\+\_\+choice,  }\item[{int}]{mode }\end{DoxyParamCaption})}



returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t between the frequncy limits f1 and f2. The energy lost is just the kinetic energy lost from the plasma because it does not include the ionization potential associated with each recombination. Python tracks effectively the kinetic energy of the plasma (not the potential energy available if everything recombined). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one The wind cell of interest \\
\hline
\mbox{\tt in}  & {\em double} & t The temperature of the cell \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice A switch controlling whether emissivites or rates are returned \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch denoting whether normal recombination (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or inner shell recombination (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine calculates an emissivity for nommal recombination or a cooling rate for normal or dielectronic recombination
\end{DoxyReturn}
If O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL is chosen then the options are


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\end{DoxyItemize}

If I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL is chosen the recombination rate is returned.

\paragraph*{Notes}

The results in this routine are all based on the Milne relation

The routine is unusual in that one passes a the wind cell and not the plasma cell. This probably should be changed.

Note that F\+B\+\_\+\+R\+E\+D\+U\+C\+ED is not an option for this routine

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000048}{Bug}]What is preventing us from calculating a dielectronic emission rate?\end{DoxyRefDesc}


Definition at line 428 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9d0d69b33092d06a7174d71c3082d2a6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ac3d85b1663343d2b268e3bbb09e6dcc6}\label{templates_8h_ac3d85b1663343d2b268e3bbb09e6dcc6}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+fb\+\_\+matoms@{total\+\_\+fb\+\_\+matoms}}
\index{total\+\_\+fb\+\_\+matoms@{total\+\_\+fb\+\_\+matoms}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+fb\+\_\+matoms()}{total\_fb\_matoms()}}
{\footnotesize\ttfamily double total\+\_\+fb\+\_\+matoms (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



computes the cooling rate due to free-\/bound recombinations 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e electron temperature \\
\hline
\mbox{\tt in}  & {\em double} & f1 lower frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 upper frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
total
\end{DoxyReturn}
computes the cooling rate due to free-\/bound recombinations using MC estimators. It is modelled on total\+\_\+fb but makes use of the mc estimators for stimulated recombination.

\paragraph*{Notes}

K\+SL\+: This routine loops over nlte\+\_\+levels, which in principle could include non-\/macro ions, but that should not matter since since nbfu\+\_\+jumps will be zero for these. 

Definition at line 606 of file estimators.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac3d85b1663343d2b268e3bbb09e6dcc6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac3d85b1663343d2b268e3bbb09e6dcc6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d}\label{templates_8h_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+free@{total\+\_\+free}}
\index{total\+\_\+free@{total\+\_\+free}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+free()}{total\_free()}}
{\footnotesize\ttfamily double total\+\_\+free (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t\+\_\+e,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



calculates the band-\/limited ff luminosity of a cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one A wind cell \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e The electron temperature to use \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The free-\/free luminosity between f1 and f2
\end{DoxyReturn}
\paragraph*{Notes}

The program uses an integral formula rather than integrating on the fly which is not ideal but saves time

The gaunt factor used depends on whether data for this is read in from the atomic data files. If it is, then the gaunt factor determined using data from Sutherland (1998). If not, the gaunt factor is set to 1. 

Definition at line 491 of file emission.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=208pt]{templates_8h_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a1f0ea4ec7ad9218a9eb0ca03a4fc6f5d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0abc40a64ed911b152833da9a675d1b4}\label{templates_8h_a0abc40a64ed911b152833da9a675d1b4}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+line\+\_\+emission@{total\+\_\+line\+\_\+emission}}
\index{total\+\_\+line\+\_\+emission@{total\+\_\+line\+\_\+emission}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+line\+\_\+emission()}{total\_line\_emission()}}
{\footnotesize\ttfamily double total\+\_\+line\+\_\+emission (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



Calculate the total line emission from a wind cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one A specific cell in the wind \\
\hline
\mbox{\tt in}  & {\em double} & f1 A minimum frequncy \\
\hline
\mbox{\tt in}  & {\em double} & f2 A maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The line lumionisity of the cell (in erg/s)
\end{DoxyReturn}
Using t\+\_\+e and the densities of ions in a cell the routine simply calculates the total amount of line emission in the cell

\paragraph*{Notes}

The routine simply use f1 and f2 to define the range of lines to calculate the luminosity for and then calls lum\+\_\+lines

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000036}{Bug}]It is not exactly clear why two routines total\+\_\+line\+\_\+emission and lum\+\_\+lines is needed, as lum\+\_\+lines appears to be called only from total\+\_\+line\+\_\+emission. ksl -\/ 180509\end{DoxyRefDesc}


Definition at line 53 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0abc40a64ed911b152833da9a675d1b4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab1050097e6dcebb3469479d4fd5ff6c0}\label{templates_8h_ab1050097e6dcebb3469479d4fd5ff6c0}} 
\index{templates.\+h@{templates.\+h}!total\+\_\+rrate@{total\+\_\+rrate}}
\index{total\+\_\+rrate@{total\+\_\+rrate}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{total\+\_\+rrate()}{total\_rrate()}}
{\footnotesize\ttfamily double total\+\_\+rrate (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{double}]{T }\end{DoxyParamCaption})}



get the total rediative recombination rate 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion The ion number of interest \\
\hline
\mbox{\tt in}  & {\em double} & T The temperature for which the rate is calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total recombination rate for this ion for this temperature
\end{DoxyReturn}
Generates a total recombination rate for a given ion at a given temperature using data, obtained from sources such as Badnell or Shull.

If these are not present, an error is generated, and a value using the Milne relation is returned.

\paragraph*{Notes}

Recombination rates can be calculated from the Milne relation but in most cases this does not give one the most accurate recombination rate because one does not have all of the relevant levels. 

Definition at line 1479 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab1050097e6dcebb3469479d4fd5ff6c0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a36a9f5603f59602831695269c056cbe4}\label{templates_8h_a36a9f5603f59602831695269c056cbe4}} 
\index{templates.\+h@{templates.\+h}!track\+\_\+scatters@{track\+\_\+scatters}}
\index{track\+\_\+scatters@{track\+\_\+scatters}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{track\+\_\+scatters()}{track\_scatters()}}
{\footnotesize\ttfamily int track\+\_\+scatters (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{nplasma,  }\item[{char $\ast$}]{comment }\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\mbox{\tt in}  & {\em int} & nplasma the cell in which the photon resides \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ comment An arbitrary comment \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Another way to track photons. This one is focussed on what happens scattering events.

\paragraph*{Notes}

Definition at line 420 of file diag.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a36a9f5603f59602831695269c056cbe4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a620388e1c4a8e38f192c5a0ce42af389}\label{templates_8h_a620388e1c4a8e38f192c5a0ce42af389}} 
\index{templates.\+h@{templates.\+h}!trans\+\_\+phot@{trans\+\_\+phot}}
\index{trans\+\_\+phot@{trans\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{trans\+\_\+phot()}{trans\_phot()}}
{\footnotesize\ttfamily int trans\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{iextract }\end{DoxyParamCaption})}



int (w,p,iextract) oversees the propagation of a \char`\"{}flight\char`\"{} of photons 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind domain \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A pointer to a \char`\"{}fligh\char`\"{} of photons \\
\hline
\mbox{\tt in}  & {\em int} & iextract An integer controlling whether we are to process the flight in the live or die option (0) or whether we also need to extract photons in specific directions (which is usually the case in constructing spectra \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Normally returns 0
\end{DoxyReturn}
This routine oversees the propagation of individual photons. The main loop covers an entire \char`\"{}flight\char`\"{} of photons. The routine generates the random optical depth a photon can travel before scattering and monitors the progress of the photon through the grid.

The real physics is done elsewhere, in lower level routines.

\paragraph*{Notes}

At the end of the routine the position for each of the photons in p is the last point where the photon was in the wind, $\ast$ not the outer boundary of the radiative transfer 

Definition at line 85 of file trans\+\_\+phot.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a620388e1c4a8e38f192c5a0ce42af389_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2f7b8208c76fe2718f45f46c9dc3a813}\label{templates_8h_a2f7b8208c76fe2718f45f46c9dc3a813}} 
\index{templates.\+h@{templates.\+h}!trans\+\_\+phot\+\_\+single@{trans\+\_\+phot\+\_\+single}}
\index{trans\+\_\+phot\+\_\+single@{trans\+\_\+phot\+\_\+single}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{trans\+\_\+phot\+\_\+single()}{trans\_phot\_single()}}
{\footnotesize\ttfamily int trans\+\_\+phot\+\_\+single (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{int}]{iextract }\end{DoxyParamCaption})}



Transport a single photon photon through the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A single photon \\
\hline
\mbox{\tt in}  & {\em int} & iextract If 0, then process this photon in the live or die option, without calling extract\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This routine oversees the propagation of an individual photon through the wind. As the photon moves through the wind, its position, direction and weight are updated. In reverberation mode, the flight time is also tracked.

Basically what the routine does is generate a random number whihc is used to determine the optical depth to a scatter, and then it calles translate multiple times. translate involves moving the photon only a single cell (or alternatively a single tranfer in the windless region), and returns a status. Depending on what this status is, trans\+\_\+phot\+\_\+single calls trans\+\_\+phot again doing nothing, but if the scattering depth has been reached, then trans\+\_\+phot\+\_\+single causes the photon to scatter, which changes its direction. This process continues until the photon exits the system or hits a barrier. If the photon hits a radiating surface, the disk or star, then the photon may either be absorbed, or scattered depending on the reflection/absorption mode.

\paragraph*{Notes}

This routine is called by trans\+\_\+phot once for each photon in a flight of photons 

Definition at line 302 of file trans\+\_\+phot.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2f7b8208c76fe2718f45f46c9dc3a813_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2f7b8208c76fe2718f45f46c9dc3a813_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8}\label{templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8}} 
\index{templates.\+h@{templates.\+h}!translate@{translate}}
\index{translate@{translate}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{translate()}{translate()}}
{\footnotesize\ttfamily int translate (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp,  }\item[{double}]{tau\+\_\+scat,  }\item[{double $\ast$}]{tau,  }\item[{int $\ast$}]{nres }\end{DoxyParamCaption})}



a steering routine that either calls \+\_\+in\+\_\+space or \+\_\+in\+\_\+wind depending upon the current location of the photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w A pointer to the wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pp A photon \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+scat the depth at which the photon should scatter \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ tau The optical depth associated with a resonanant scatter when this is the reason the photon has stopped \\
\hline
\mbox{\tt in,out}  & {\em int} & $\ast$ nres The number of the resonance if the photon stopped. due to reaching the scattering optical depth \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status that states what caused the photon to stp as it did
\end{DoxyReturn}
The routine takes the current position of the photon and determines where it is. Depending on this it calls either translate\+\_\+in\+\_\+space or translate\+\_\+in\+\_\+wind

On exit, the position of the photon will have been updated.

\paragraph*{Notes}

Translate controls the flow of the photon through one grid cell. In Python, there are additional possibilities since there are wind free regions.

The routine first calls where\+\_\+in\+\_\+wind which returns the correct domain for a given position, or domain 0 if the position is not in the wind of a domain. The photon structure does not have the domain number directly encoded, but it can be obtained from the grid number, which where in\+\_\+grid updates

This construction is used so that the calling routines for translate (trans\+\_\+phot and extract) can be the same in the 1 and 2d versions. 

Definition at line 79 of file photon2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ae77272897af1eb8f6ebd0f7cfe2932e8_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aa1ffd17034054d51819328d892fc57e8}\label{templates_8h_aa1ffd17034054d51819328d892fc57e8}} 
\index{templates.\+h@{templates.\+h}!translate\+\_\+in\+\_\+space@{translate\+\_\+in\+\_\+space}}
\index{translate\+\_\+in\+\_\+space@{translate\+\_\+in\+\_\+space}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{translate\+\_\+in\+\_\+space()}{translate\_in\_space()}}
{\footnotesize\ttfamily int translate\+\_\+in\+\_\+space (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



translates the photon from its current position to the edge of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pp A photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status flag indication why the photon stopped
\end{DoxyReturn}
The routine translate the photon (which is assumed to be in the wind, but not in an active wind cell) to the closest boundary.

The photon position is updated in the process.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000041}{Bug}]There are questions in the comments about why an additonal check is needed as to whther the photon as hit the star. It seems superfluous so someone should check whether this addtional check can be removed.\end{DoxyRefDesc}


Definition at line 144 of file photon2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa1ffd17034054d51819328d892fc57e8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{templates_8h_aa1ffd17034054d51819328d892fc57e8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0118547dede9b08b5ac6609b4313e3e8}\label{templates_8h_a0118547dede9b08b5ac6609b4313e3e8}} 
\index{templates.\+h@{templates.\+h}!translate\+\_\+in\+\_\+wind@{translate\+\_\+in\+\_\+wind}}
\index{translate\+\_\+in\+\_\+wind@{translate\+\_\+in\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{translate\+\_\+in\+\_\+wind()}{translate\_in\_wind()}}
{\footnotesize\ttfamily int translate\+\_\+in\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{tau\+\_\+scat,  }\item[{double $\ast$}]{tau,  }\item[{int $\ast$}]{nres }\end{DoxyParamCaption})}



translates the photon within a single cell in the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A photon \\
\hline
\mbox{\tt in}  & {\em double} & tau\+\_\+scat The depth at which the photon will scatter \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ tau The tau of a resonance \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ nres The resonaance which caused the photon to stop \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status indicated whether the photon has stopped for a scattering even of for some other teason
\end{DoxyReturn}
It calculates and updates the final position of the photon p, the optical depth tau after having translated the photon, and, if the photon is scattered, the number of the resonance responsible for scattering (or absorbing) the photon bundle.

These last two quantities are calculated in ds\+\_\+calculate and simply passed back.

translate\+\_\+in\+\_\+wind returns that status directly to the calling routine.

\paragraph*{Notes}

In addition to moving the photon, the routine also updates some values having to do with the radiation filed both in and out of macro atom mode. 

Definition at line 543 of file photon2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0118547dede9b08b5ac6609b4313e3e8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{templates_8h_a0118547dede9b08b5ac6609b4313e3e8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a48cdc1c9e874cf04a9ba2eef8990e5d4}\label{templates_8h_a48cdc1c9e874cf04a9ba2eef8990e5d4}} 
\index{templates.\+h@{templates.\+h}!trapzd@{trapzd}}
\index{trapzd@{trapzd}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{trapzd()}{trapzd()}}
{\footnotesize\ttfamily double trapzd (\begin{DoxyParamCaption}\item[{double($\ast$)(double)}]{func,  }\item[{double}]{a,  }\item[{double}]{b,  }\item[{int}]{n }\end{DoxyParamCaption})}



Definition at line 112 of file recipes.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=191pt]{templates_8h_a48cdc1c9e874cf04a9ba2eef8990e5d4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a234e98c30b4b66b1f72240a79d9f4d11}\label{templates_8h_a234e98c30b4b66b1f72240a79d9f4d11}} 
\index{templates.\+h@{templates.\+h}!two\+\_\+level\+\_\+atom@{two\+\_\+level\+\_\+atom}}
\index{two\+\_\+level\+\_\+atom@{two\+\_\+level\+\_\+atom}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{two\+\_\+level\+\_\+atom()}{two\_level\_atom()}}
{\footnotesize\ttfamily double two\+\_\+level\+\_\+atom (\begin{DoxyParamCaption}\item[{struct \hyperlink{structlines}{lines} $\ast$}]{line\+\_\+ptr,  }\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double $\ast$}]{d1,  }\item[{double $\ast$}]{d2 }\end{DoxyParamCaption})}



calculates the ratio n2/n1 and gives the individual densities for the states of a two level atom. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & lines $\ast$ line\+\_\+ptr The line of interest \\
\hline
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma The plasma cell of interest \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ d1 The calculated density of the lower level for the line of interest \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ d2 The calculated density of the upper levl \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The density ratio d2/d1
\end{DoxyReturn}
In the two level approximation,

n2 / n1 = ( c12 + g2/g1 c$\ast$c / (2 h nu $\ast$ nu $\ast$ nu ) $\ast$ A21 J12) / (c21 + A21 + c$\ast$c / (2 h nu $\ast$ nu $\ast$ nu ) $\ast$ A21 J21)

In the on-\/the-\/spot approx. we assume,.

J21= W (2 h nu $\ast$ nu $\ast$ nu ) / (exp (h nu / k T(rad)) -\/1)

and this is what is calculated here

\paragraph*{Notes}

This routine is not (should not be) called for macro atoms. The program will exit if this happens 

Definition at line 423 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a234e98c30b4b66b1f72240a79d9f4d11_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a234e98c30b4b66b1f72240a79d9f4d11_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a80900ce2eec0df06ac63c9eb02d93afa}\label{templates_8h_a80900ce2eec0df06ac63c9eb02d93afa}} 
\index{templates.\+h@{templates.\+h}!update\+\_\+banded\+\_\+estimators@{update\+\_\+banded\+\_\+estimators}}
\index{update\+\_\+banded\+\_\+estimators@{update\+\_\+banded\+\_\+estimators}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{update\+\_\+banded\+\_\+estimators()}{update\_banded\_estimators()}}
{\footnotesize\ttfamily int update\+\_\+banded\+\_\+estimators (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{ds,  }\item[{double}]{w\+\_\+ave }\end{DoxyParamCaption})}



updates the estimators required for determining crude spectra in each Plasma cell 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma Plasma\+Ptr for the cell of interest \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p Photon pointer \\
\hline
\mbox{\tt in}  & {\em double} & ds ds travelled \\
\hline
\mbox{\tt in}  & {\em double} & w\+\_\+ave the weight of the photon in the cell.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
Increments the estimators that allow one to construct a crude spectrum in each cell of the wind. The frequency intervals in which the spectra are constructed are in geo.\+xfreq. This information is used in different ways (or not at all) depending on the ionization mode.

It also records the values of IP.

\paragraph*{Notes}

In non macro atom mode, w\+\_\+ave this is an average weight (passed as w\+\_\+ave), but in macro atom mode weights are never reduced (so p-\/$>$w is used).

This routine is called from bf\+\_\+estimators in macro\+\_\+atom modes and from radiation (above). Although the historical documentation suggests it is only called for certain ionization modes, it appears to be called in all cases, though clearly it is only provides diagnostic information in some of them. 

Definition at line 1096 of file radiation.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=268pt]{templates_8h_a80900ce2eec0df06ac63c9eb02d93afa_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2f3bba5e0752be019862b69eb06d5899}\label{templates_8h_a2f3bba5e0752be019862b69eb06d5899}} 
\index{templates.\+h@{templates.\+h}!upsilon@{upsilon}}
\index{upsilon@{upsilon}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{upsilon()}{upsilon()}}
{\footnotesize\ttfamily double upsilon (\begin{DoxyParamCaption}\item[{int}]{n\+\_\+coll,  }\item[{double}]{u0 }\end{DoxyParamCaption})}



calculates the thermally averaged collision strength thermally excited line emission. 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} int n\+\_\+coll the index of the collision strength record we are working with \\
\hline
{\em \mbox{[}in} & out\mbox{]} double u0 -\/ k\+T\+\_\+e/hnu -\/ where nu is the transition frequency for the line of interest and T\+\_\+e is the electron temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
upsilon -\/ the thermally averaged collision strength for a given line at a given temp
\end{DoxyReturn}
\paragraph*{Notes}

It uses data extracted from Chianti stored in \hyperlink{structcoll__stren}{coll\+\_\+stren}. The paper to consult is Burgess and Tully A\&A 254,436 (1992). u0 is the ratio of Boltzmans constant times the electron temperature in the cell divided by Plancks constant times the frequency of the line under analysis. 

Definition at line 954 of file lines.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2f3bba5e0752be019862b69eb06d5899_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2f3bba5e0752be019862b69eb06d5899_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a47e5844ec76c800f7868e793e5d8364a}\label{templates_8h_a47e5844ec76c800f7868e793e5d8364a}} 
\index{templates.\+h@{templates.\+h}!vadd@{vadd}}
\index{vadd@{vadd}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vadd()}{vadd()}}
{\footnotesize\ttfamily int vadd (\begin{DoxyParamCaption}\item[{double}]{u\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]},  }\item[{double}]{result\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a72d9769510683e30aeef87c2a255ebe4}\label{templates_8h_a72d9769510683e30aeef87c2a255ebe4}} 
\index{templates.\+h@{templates.\+h}!variable\+\_\+temperature@{variable\+\_\+temperature}}
\index{variable\+\_\+temperature@{variable\+\_\+temperature}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{variable\+\_\+temperature()}{variable\_temperature()}}
{\footnotesize\ttfamily int variable\+\_\+temperature (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{int}]{mode }\end{DoxyParamCaption})}



modifies the densities of ions, levels, and partition functions of ions within a cell of the wind based upon the mode, and other data contained within the Wind\+Ptr itself, such as t\+\_\+r, t\+\_\+e, w, based on the \char`\"{}mode\char`\"{}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma A Plasma cell \\
\hline
\mbox{\tt in}  & {\em int} & mode A choice of N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+P\+A\+I\+R\+W\+I\+S\+E\+\_\+\+M\+L93 (6) which uses a dilute blackbody to represent the spectrum or N\+E\+B\+U\+L\+A\+R\+M\+O\+D\+E\+\_\+\+P\+A\+I\+R\+W\+I\+S\+E\+\_\+\+S\+P\+E\+C\+T\+R\+A\+L\+M\+O\+D\+EL (7) which uses a crude spectrum constructed of power law or exponetial segments. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
returns 0 if the routine converged to an answer, -\/1 otherwise. On an abnormal return the density array and ne are left unchanged.
\end{DoxyReturn}
variable temperature alters portions of the variables associated with the Plasma cellr. Exactly how things are changed depends on the mode.

\paragraph*{Notes}

Section 5.\+3 of Nick\textquotesingle{}s thesis explains the undelying ratinale for the so-\/called variable temperature models. The name of the routine is misleading since there correctios are made for both a dilute power law and for a dilute bb.

Unlike nebular\+\_\+concentrations, this code works on pairs of ions at a time, and uses a temperature calculated to be suitable for that particular pair to have a ratio of abundances about equal to 1.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000062}{Bug}]There are various questions associated with this routine about whether what is being done associated with partition funcitons is correct.\end{DoxyRefDesc}


Definition at line 135 of file variable\+\_\+temperature.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a72d9769510683e30aeef87c2a255ebe4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0d368eae5d684f030c569fcbafeb9df2}\label{templates_8h_a0d368eae5d684f030c569fcbafeb9df2}} 
\index{templates.\+h@{templates.\+h}!vcos@{vcos}}
\index{vcos@{vcos}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vcos()}{vcos()}}
{\footnotesize\ttfamily double vcos (\begin{DoxyParamCaption}\item[{double}]{x }\end{DoxyParamCaption})}



Definition at line 228 of file random.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=195pt]{templates_8h_a0d368eae5d684f030c569fcbafeb9df2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab856a7685f7db0cf633936b2daac314b}\label{templates_8h_ab856a7685f7db0cf633936b2daac314b}} 
\index{templates.\+h@{templates.\+h}!vdisk@{vdisk}}
\index{vdisk@{vdisk}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vdisk()}{vdisk()}}
{\footnotesize\ttfamily double vdisk (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a5d898a3431abba975dde87769e1ad49c}\label{templates_8h_a5d898a3431abba975dde87769e1ad49c}} 
\index{templates.\+h@{templates.\+h}!vector@{vector}}
\index{vector@{vector}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vector()}{vector()}}
{\footnotesize\ttfamily double$\ast$ vector (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})}



Definition at line 323 of file recipes.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{templates_8h_a5d898a3431abba975dde87769e1ad49c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aedb7294b79d53f3a732f2738a2f9b991}\label{templates_8h_aedb7294b79d53f3a732f2738a2f9b991}} 
\index{templates.\+h@{templates.\+h}!velocity\+\_\+1d@{velocity\+\_\+1d}}
\index{velocity\+\_\+1d@{velocity\+\_\+1d}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{velocity\+\_\+1d()}{velocity\_1d()}}
{\footnotesize\ttfamily double velocity\+\_\+1d (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x,  }\item[{double $\ast$}]{v }\end{DoxyParamCaption})}



The velocity at any positiion in an imported spherical model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of the imported model \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ x A postion (3d) \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ v The velocity at x \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The speeed at x
\end{DoxyReturn}
This routine interpolates on the values read in for the imported model to give one a velocity

\paragraph*{Notes}

Note that v\+\_\+r is stored in v\+\_\+0

Not also that In practice this routine is only used to initallize v in wind structure. This is consistent with the way velocities are treated throughout Python 

Definition at line 242 of file import\+\_\+spherical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{templates_8h_aedb7294b79d53f3a732f2738a2f9b991_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a27c9c697b3fdd67b7b4fe6626abf3a65}\label{templates_8h_a27c9c697b3fdd67b7b4fe6626abf3a65}} 
\index{templates.\+h@{templates.\+h}!velocity\+\_\+cylindrical@{velocity\+\_\+cylindrical}}
\index{velocity\+\_\+cylindrical@{velocity\+\_\+cylindrical}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{velocity\+\_\+cylindrical()}{velocity\_cylindrical()}}
{\footnotesize\ttfamily double velocity\+\_\+cylindrical (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x,  }\item[{double $\ast$}]{v }\end{DoxyParamCaption})}



The velocity at any positiion in an imported cylindrical model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ndom} & The domain of the imported model \\
\hline
\mbox{\tt in}  & {\em x} & A position \\
\hline
\mbox{\tt out}  & {\em v} & The velocity at x \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The speed at x
\end{DoxyReturn}
This routine interpolates on the values read in for the imported model to give one a velocity

\paragraph*{Notes}

In practice this routine is only used to initallize v in wind structure. This is consistent with the way velocities are treated throughout Python. 

Definition at line 405 of file import\+\_\+cylindrical.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=259pt]{templates_8h_a27c9c697b3fdd67b7b4fe6626abf3a65_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1694a241d722667936d776953cad5fa5}\label{templates_8h_a1694a241d722667936d776953cad5fa5}} 
\index{templates.\+h@{templates.\+h}!velocity\+\_\+rtheta@{velocity\+\_\+rtheta}}
\index{velocity\+\_\+rtheta@{velocity\+\_\+rtheta}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{velocity\+\_\+rtheta()}{velocity\_rtheta()}}
{\footnotesize\ttfamily double velocity\+\_\+rtheta (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double $\ast$}]{x,  }\item[{double $\ast$}]{v }\end{DoxyParamCaption})}



The velcity at any position in an imported rtheat model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain for the imported model \\
\hline
\mbox{\tt in}  & {\em double} & $\ast$ x A position (3 vector) \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ v The calcuated velocity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The speed at x
\end{DoxyReturn}
This routine interpolates on the values read in for the inported model to give one a velocity

\paragraph*{Notes}

In practice this routine is only used to initallize v in wind structure. This is consistent with the way velocities are treated throughout Python. 

Definition at line 411 of file import\+\_\+rtheta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=245pt]{templates_8h_a1694a241d722667936d776953cad5fa5_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a73540a1a2630d25b811ed098f11721bf}\label{templates_8h_a73540a1a2630d25b811ed098f11721bf}} 
\index{templates.\+h@{templates.\+h}!velocity\+\_\+summary@{velocity\+\_\+summary}}
\index{velocity\+\_\+summary@{velocity\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{velocity\+\_\+summary()}{velocity\_summary()}}
{\footnotesize\ttfamily int velocity\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a121f213b4ad36619461deebbea325e66}\label{templates_8h_a121f213b4ad36619461deebbea325e66}} 
\index{templates.\+h@{templates.\+h}!vmove@{vmove}}
\index{vmove@{vmove}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vmove()}{vmove()}}
{\footnotesize\ttfamily int vmove (\begin{DoxyParamCaption}\item[{double}]{u\mbox{[}$\,$\mbox{]},  }\item[{double}]{lmn\mbox{[}$\,$\mbox{]},  }\item[{double}]{s,  }\item[{double}]{result\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a07341747eace7108cf66af7fa8846b0d}\label{templates_8h_a07341747eace7108cf66af7fa8846b0d}} 
\index{templates.\+h@{templates.\+h}!vol\+\_\+summary@{vol\+\_\+summary}}
\index{vol\+\_\+summary@{vol\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vol\+\_\+summary()}{vol\_summary()}}
{\footnotesize\ttfamily int vol\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_af170ad39af01fbe3b232230692c2aa5e}\label{templates_8h_af170ad39af01fbe3b232230692c2aa5e}} 
\index{templates.\+h@{templates.\+h}!vrandwind@{vrandwind}}
\index{vrandwind@{vrandwind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vrandwind()}{vrandwind()}}
{\footnotesize\ttfamily double vrandwind (\begin{DoxyParamCaption}\item[{double}]{x }\end{DoxyParamCaption})}



the function that is used to generate the cdf for anisotropic scattering. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em double} & x The direction cosine with respect to the direction of tau\+\_\+min\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A number proportional to the probability that a photon will scatter in a direction with a particular direction cosine
\end{DoxyReturn}
The routine calculates a function that is proportional to the probability density. d\+P/dcos(theta) for the photon.

\paragraph*{Notes}

This routine is used by cdf\+\_\+gen\+\_\+from\+\_\+func (via make\+\_\+cdf\+\_\+randwind, when that routine is called from randwind) 

Definition at line 279 of file anisowind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af170ad39af01fbe3b232230692c2aa5e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af170ad39af01fbe3b232230692c2aa5e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a3b474f3933aeab1276e52e7ed441dfc1}\label{templates_8h_a3b474f3933aeab1276e52e7ed441dfc1}} 
\index{templates.\+h@{templates.\+h}!vsub@{vsub}}
\index{vsub@{vsub}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vsub()}{vsub()}}
{\footnotesize\ttfamily int vsub (\begin{DoxyParamCaption}\item[{double}]{u\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]},  }\item[{double}]{result\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a0063dc1e42150aa43a80ac17e3070b66}\label{templates_8h_a0063dc1e42150aa43a80ac17e3070b66}} 
\index{templates.\+h@{templates.\+h}!vwind\+\_\+xyz@{vwind\+\_\+xyz}}
\index{vwind\+\_\+xyz@{vwind\+\_\+xyz}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{vwind\+\_\+xyz()}{vwind\_xyz()}}
{\footnotesize\ttfamily int vwind\+\_\+xyz (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_acb71ca3a7e18d652d5eb0df69766c022}\label{templates_8h_acb71ca3a7e18d652d5eb0df69766c022}} 
\index{templates.\+h@{templates.\+h}!walls@{walls}}
\index{walls@{walls}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{walls()}{walls()}}
{\footnotesize\ttfamily int walls (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pold,  }\item[{double $\ast$}]{normal }\end{DoxyParamCaption})}



determines whether the photon has encountered the star of disk or reached the edges of the grid and returns the appropriate tatus. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Phot\+Ptr} & p A photon at its new proposed location. On exiting the routine this will contain the position of the photon after taking wind boundaries (e.\+g wind cones) into account. \\
\hline
\mbox{\tt in,out}  & {\em Phot\+Ptr} & pold the current and previous description of the photon bundle. beore the lates movee \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ normal A vector when the star or disk has been hit, which contains the normal for the reflecting surface at the point the photon encountered the the boundary \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A status
\end{DoxyReturn}

\begin{DoxyItemize}
\item The photon has hit the star P\+\_\+\+H\+I\+T\+\_\+\+S\+T\+AR
\item The photon has hit the disk P\+\_\+\+H\+I\+T\+\_\+\+D\+I\+SK
\item The photon has reached the edge of grid P\+\_\+\+E\+S\+C\+A\+PE
\item The status is undeterminable 5
\end{DoxyItemize}

If a photon does not fall into one of these categories, walls returns the old status, which is stored in p-\/$>$istat

walls is generally called after one has calculated how far a photon can travel in a cell in order to see whether it has exited the wind region. This is necessary because some grid cells are not actually part of the wind, even though they are needed so that the grid is regular.

pold is the place where the photon was before the last attempt to move the photon forward. p on input is a proposed location for photon before considering whethe one has hit a boundary. The location of p is either at the edge of a cell, or at the position of a resonance. So pold should be a valid position for the photon, but p may need to be adjusted.

If one of the walls has been hit, the routine should have moved the photon to that wall, but not othewise changed it.

The routine also calculates the normal to the surface that was hit, which is inteneded to be used by trans\+\_\+phot to redirect the photon

\paragraph*{Notes}

This really does determine whether the photon is in the grid, as opposed to whether the photon has reached a radial distance geo.\+rwind. I am not sure whether this is what we want???. 

Definition at line 843 of file photon2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_acb71ca3a7e18d652d5eb0df69766c022_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ae344297a6e533d8464a20ca9a7bbfc2f}\label{templates_8h_ae344297a6e533d8464a20ca9a7bbfc2f}} 
\index{templates.\+h@{templates.\+h}!weight\+\_\+summary@{weight\+\_\+summary}}
\index{weight\+\_\+summary@{weight\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{weight\+\_\+summary()}{weight\_summary()}}
{\footnotesize\ttfamily int weight\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a829a331b30311e6768f4cc16a70fdab5}\label{templates_8h_a829a331b30311e6768f4cc16a70fdab5}} 
\index{templates.\+h@{templates.\+h}!where\+\_\+in\+\_\+2dcell@{where\+\_\+in\+\_\+2dcell}}
\index{where\+\_\+in\+\_\+2dcell@{where\+\_\+in\+\_\+2dcell}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{where\+\_\+in\+\_\+2dcell()}{where\_in\_2dcell()}}
{\footnotesize\ttfamily int where\+\_\+in\+\_\+2dcell (\begin{DoxyParamCaption}\item[{int}]{ichoice,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{int}]{n,  }\item[{double $\ast$}]{fx,  }\item[{double $\ast$}]{fz }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a1db4ad38f132371d7fe31fdd998ae53e}\label{templates_8h_a1db4ad38f132371d7fe31fdd998ae53e}} 
\index{templates.\+h@{templates.\+h}!where\+\_\+in\+\_\+grid@{where\+\_\+in\+\_\+grid}}
\index{where\+\_\+in\+\_\+grid@{where\+\_\+in\+\_\+grid}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{where\+\_\+in\+\_\+grid()}{where\_in\_grid()}}
{\footnotesize\ttfamily int where\+\_\+in\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a2c852998cd074100b68f8750a8d8ca99}\label{templates_8h_a2c852998cd074100b68f8750a8d8ca99}} 
\index{templates.\+h@{templates.\+h}!where\+\_\+in\+\_\+wind@{where\+\_\+in\+\_\+wind}}
\index{where\+\_\+in\+\_\+wind@{where\+\_\+in\+\_\+wind}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{where\+\_\+in\+\_\+wind()}{where\_in\_wind()}}
{\footnotesize\ttfamily int where\+\_\+in\+\_\+wind (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{int $\ast$}]{ndomain }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_aa5de177d6e8fc4d6d0becf0c2898b90d}\label{templates_8h_aa5de177d6e8fc4d6d0becf0c2898b90d}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+check@{wind\+\_\+check}}
\index{wind\+\_\+check@{wind\+\_\+check}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+check()}{wind\_check()}}
{\footnotesize\ttfamily int wind\+\_\+check (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{www,  }\item[{int}]{n }\end{DoxyParamCaption})}



Simple checks of the wind structure for reasonability. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Wind\+Ptr} & www The entire wind \\
\hline
\mbox{\tt in,out}  & {\em int} & n n $>$= 0 then an element of the array will be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine should be called in a number of ways


\begin{DoxyItemize}
\item wind\+\_\+check(w,-\/1); to check the entire structure
\item wind\+\_\+check(w,50); to check element 50 of the structure
\item wind\+\_\+check(w\mbox{[}50\mbox{]},0) to check elemetn 50 of the structure
\end{DoxyItemize}

\paragraph*{Notes}

These checks are so basic, just NaN (sane\+\_\+checks), that they hardly seem worth doing. One would think one would want to stop the program if any of them failed. But this does not take much time.

The checks are made on the wind, without reference to domains 

Definition at line 460 of file wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_aa5de177d6e8fc4d6d0becf0c2898b90d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad5c30455dbf640e7a5d68132a8e4a5c5}\label{templates_8h_ad5c30455dbf640e7a5d68132a8e4a5c5}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+complete@{wind\+\_\+complete}}
\index{wind\+\_\+complete@{wind\+\_\+complete}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+complete()}{wind\_complete()}}
{\footnotesize\ttfamily int wind\+\_\+complete (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



A driver routine that calls coordinate-\/system specific routines that complete the descirption of the wind. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
For the most point, the various routines that are called just recalculate some of the various arrays used for finding the boundaries of an individual cell.

\paragraph*{Notes}

The need to call this routine whenever a windsave file is read in could be obviated if all of the variable length arrays in domains were actually written out. But since these variables are easy to calculate again, it is done here. 

Definition at line 339 of file windsave.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad5c30455dbf640e7a5d68132a8e4a5c5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{templates_8h_ad5c30455dbf640e7a5d68132a8e4a5c5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2a31b4c75dc8f482609abe7b1618a97b}\label{templates_8h_a2a31b4c75dc8f482609abe7b1618a97b}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+cooling@{wind\+\_\+cooling}}
\index{wind\+\_\+cooling@{wind\+\_\+cooling}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+cooling()}{wind\_cooling()}}
{\footnotesize\ttfamily double wind\+\_\+cooling (\begin{DoxyParamCaption}\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



calculate the cooling rate of the entire wind between freqencies f1 and f2 (including non-\/radiative processes 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total cooling rate of the wind
\end{DoxyReturn}
Various parameters in geo having to do with the total cooling for the various properties are also populated.

This routine cycles through all of the wind cells and calculates the cooling rate in each cell.

\paragraph*{Notes}

This is not the same as the luminosty of the wind, because it includes non-\/radiative processes, such as adiabatic and Compton cooling.

Non-\/radiative process include adiabatic cooling, Compton cooling, dielectronic recombination, direct ionization

Adiabatic cooling is summed separately for cells where the adiabatic cooling is positive (tends to cool the wind) and negative (tends to heat the wind.. 

Definition at line 329 of file cooling.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a2a31b4c75dc8f482609abe7b1618a97b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad47569135f21d4ce22504b0ad5b0b221}\label{templates_8h_ad47569135f21d4ce22504b0ad5b0b221}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+div\+\_\+v@{wind\+\_\+div\+\_\+v}}
\index{wind\+\_\+div\+\_\+v@{wind\+\_\+div\+\_\+v}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+div\+\_\+v()}{wind\_div\_v()}}
{\footnotesize\ttfamily int wind\+\_\+div\+\_\+v (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Definition at line 846 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad47569135f21d4ce22504b0ad5b0b221_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{templates_8h_ad47569135f21d4ce22504b0ad5b0b221_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a83eeb6fe319aa5af7c8400e921273323}\label{templates_8h_a83eeb6fe319aa5af7c8400e921273323}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+element@{wind\+\_\+element}}
\index{wind\+\_\+element@{wind\+\_\+element}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+element()}{wind\_element()}}
{\footnotesize\ttfamily int wind\+\_\+element (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Definition at line 1477 of file py\+\_\+wind\+\_\+sub.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{templates_8h_a83eeb6fe319aa5af7c8400e921273323_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a172ddeb06a81951700723a0b02d90557}\label{templates_8h_a172ddeb06a81951700723a0b02d90557}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+ij\+\_\+to\+\_\+n@{wind\+\_\+ij\+\_\+to\+\_\+n}}
\index{wind\+\_\+ij\+\_\+to\+\_\+n@{wind\+\_\+ij\+\_\+to\+\_\+n}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+ij\+\_\+to\+\_\+n()}{wind\_ij\_to\_n()}}
{\footnotesize\ttfamily int wind\+\_\+ij\+\_\+to\+\_\+n (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{int}]{i,  }\item[{int}]{j,  }\item[{int $\ast$}]{n }\end{DoxyParamCaption})}



Translate from the 2d element for an individual domain to the wind element number. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in,out}  & {\em int} & i The element number for the first (x) dimension \\
\hline
\mbox{\tt in,out}  & {\em int} & j The element number fro the second (z or theta) dimension \\
\hline
\mbox{\tt in,out}  & {\em int} & $\ast$ n The element number in the wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The element number is returned
\end{DoxyReturn}
This is just a simple translation to find the wind domain element number

\paragraph*{Notes}

Definition at line 575 of file util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a172ddeb06a81951700723a0b02d90557_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{templates_8h_a172ddeb06a81951700723a0b02d90557_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af6ad57c004d922bda67245571bfdfeb5}\label{templates_8h_af6ad57c004d922bda67245571bfdfeb5}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+ip@{wind\+\_\+ip}}
\index{wind\+\_\+ip@{wind\+\_\+ip}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+ip()}{wind\_ip()}}
{\footnotesize\ttfamily int wind\+\_\+ip (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ae1d27b840ad2ff21462921fc2aab975c}\label{templates_8h_ae1d27b840ad2ff21462921fc2aab975c}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+luminosity@{wind\+\_\+luminosity}}
\index{wind\+\_\+luminosity@{wind\+\_\+luminosity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+luminosity()}{wind\_luminosity()}}
{\footnotesize\ttfamily double wind\+\_\+luminosity (\begin{DoxyParamCaption}\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



calculate the luminosity of the entire wind between freqencies f1 and f2 


\begin{DoxyParams}{Parameters}
{\em \mbox{[}in} & out\mbox{]} double f1 The minimum frequency for the calculation \\
\hline
{\em \mbox{[}in} & out\mbox{]} double f2 The maximum frequency \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The luminosity of the entire wind
\end{DoxyReturn}
The routine simply calls total\+\_\+emission for each wind cell with a positive volume in the wind

The routine also populates several luminosity related variables in geo, which give the luminosity for separate processes, e.\+g free-\/free and free\+\_\+ound emission.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000021}{Bug}]The do loop might be simpler if made over the plasma cells instead of the wind, but one should be careful of the dummy cell\end{DoxyRefDesc}


Definition at line 47 of file emission.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ae1d27b840ad2ff21462921fc2aab975c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ae1d27b840ad2ff21462921fc2aab975c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_aed64e9379499a741e8a7c42376e20530}\label{templates_8h_aed64e9379499a741e8a7c42376e20530}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+n\+\_\+to\+\_\+ij@{wind\+\_\+n\+\_\+to\+\_\+ij}}
\index{wind\+\_\+n\+\_\+to\+\_\+ij@{wind\+\_\+n\+\_\+to\+\_\+ij}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+n\+\_\+to\+\_\+ij()}{wind\_n\_to\_ij()}}
{\footnotesize\ttfamily int wind\+\_\+n\+\_\+to\+\_\+ij (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{int}]{n,  }\item[{int $\ast$}]{i,  }\item[{int $\ast$}]{j }\end{DoxyParamCaption})}



Translate a cell number in the wind to the two-\/d grid position in a specific domain. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in}  & {\em int} & n The 1-\/d position in the wind domain \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ i The first index for a 2d position in a given domain \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ j The second index for a 2d postion in a given domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
i,j position in a given domain
\end{DoxyReturn}
wmain contains elements for the entire winds. This routine translates from a wmain index to the two-\/d index of a specific domain so that one can interpolate.

\paragraph*{Notes}

For 2d, the underlying 1-\/d grid is organized so that as n increases, one goes up in z, and then steps out in rho., or in theta and then z as the case may be.

With domains, this routine has to be used carefully, and a better statement would be that these routines map to and from the element in wmain to the normally 2d element in an individual domain.

So this means that if you want to get the ith and jth element of domain 1, then one needs to give nstart+whatever to wind\+\_\+n\+\_\+to\+\_\+ij 

Definition at line 539 of file util.\+c.

\mbox{\Hypertarget{templates_8h_a7fe8e6139b53b931c68d444216bfd0fe}\label{templates_8h_a7fe8e6139b53b931c68d444216bfd0fe}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+add\+\_\+phot@{wind\+\_\+paths\+\_\+add\+\_\+phot}}
\index{wind\+\_\+paths\+\_\+add\+\_\+phot@{wind\+\_\+paths\+\_\+add\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+add\+\_\+phot()}{wind\_paths\_add\_phot()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+add\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



Registers a photon passage with a wind cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind cell to register photon in. \\
\hline
\mbox{\tt in}  & {\em pp} & Photon to register in wind cell. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
When given a wind cell and photon, adds the photon\textquotesingle{}s weight to the appropriate delay bin.

\paragraph*{Notes}

27/2/15 -\/ Written by S\+WM 2/15. 

Definition at line 273 of file paths.\+c.

\mbox{\Hypertarget{templates_8h_ac4d257a6939bcb61d002923ae8fbc1fc}\label{templates_8h_ac4d257a6939bcb61d002923ae8fbc1fc}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+constructor@{wind\+\_\+paths\+\_\+constructor}}
\index{wind\+\_\+paths\+\_\+constructor@{wind\+\_\+paths\+\_\+constructor}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+constructor()}{wind\_paths\_constructor()}}
{\footnotesize\ttfamily \hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr} wind\+\_\+paths\+\_\+constructor (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind }\end{DoxyParamCaption})}



Allocates the arrays for a path histogram. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Pointer to parent wind cell \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Pointer to onstructed histogram
\end{DoxyReturn}
Allocates path bins for a passed wind cell and returns a pointer to the allocated space.

\paragraph*{Notes}

9/3/15 -\/ Written by S\+WM 

Definition at line 42 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac4d257a6939bcb61d002923ae8fbc1fc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ac4d257a6939bcb61d002923ae8fbc1fc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_acfc3937b157db869057d3f33613b2e87}\label{templates_8h_acfc3937b157db869057d3f33613b2e87}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+dump@{wind\+\_\+paths\+\_\+dump}}
\index{wind\+\_\+paths\+\_\+dump@{wind\+\_\+paths\+\_\+dump}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+dump()}{wind\_paths\_dump()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+dump (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{rank\+\_\+global }\end{DoxyParamCaption})}



Dumps wind path arrays for a wind cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind cell to dump \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Outputs a file \char`\"{}root.\+wind\+\_\+paths\+\_\+\mbox{[}nwind\mbox{]}.\+csv\char`\"{} containing the path length bins and total flux in each for each line histogram (and the regular wind histogram) in the given cell.

\paragraph*{Notes}

10/15 -\/ Written by S\+WM 

Definition at line 582 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_acfc3937b157db869057d3f33613b2e87_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a210e77beda2c9c25b9008de9107a17f8}\label{templates_8h_a210e77beda2c9c25b9008de9107a17f8}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+evaluate@{wind\+\_\+paths\+\_\+evaluate}}
\index{wind\+\_\+paths\+\_\+evaluate@{wind\+\_\+paths\+\_\+evaluate}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+evaluate()}{wind\_paths\_evaluate()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+evaluate (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{i\+\_\+rank }\end{DoxyParamCaption})}



Evaluates wind path details for a cycle. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind to evaluate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Iterates over each cell in the wind.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_adac039bc6269033412fa861aa78aa111}{wind\+\_\+paths\+\_\+evaluate\+\_\+single()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 533 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a210e77beda2c9c25b9008de9107a17f8_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_adac039bc6269033412fa861aa78aa111}\label{templates_8h_adac039bc6269033412fa861aa78aa111}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+evaluate\+\_\+single@{wind\+\_\+paths\+\_\+evaluate\+\_\+single}}
\index{wind\+\_\+paths\+\_\+evaluate\+\_\+single@{wind\+\_\+paths\+\_\+evaluate\+\_\+single}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+evaluate\+\_\+single()}{wind\_paths\_evaluate\_single()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+evaluate\+\_\+single (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_af5cbc81f9fbd8ac7596e3a989073df45}{Wind\+\_\+\+Paths\+\_\+\+Ptr}}]{paths }\end{DoxyParamCaption})}



Evaluates individual wind cell paths. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Wind cell to evaluate\\
\hline
\end{DoxyParams}
Records the total flux in the cell, as well as making a simple \textquotesingle{}average path\textquotesingle{} calculation.

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a210e77beda2c9c25b9008de9107a17f8}{wind\+\_\+paths\+\_\+evaluate()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 495 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=290pt]{templates_8h_adac039bc6269033412fa861aa78aa111_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a176ee6debad2930212ca97a2d28794c0}\label{templates_8h_a176ee6debad2930212ca97a2d28794c0}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+gen\+\_\+phot@{wind\+\_\+paths\+\_\+gen\+\_\+phot}}
\index{wind\+\_\+paths\+\_\+gen\+\_\+phot@{wind\+\_\+paths\+\_\+gen\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+gen\+\_\+phot()}{wind\_paths\_gen\_phot()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+gen\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{pp }\end{DoxyParamCaption})}



Generates path for a wind photon. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind cell to spawn in \\
\hline
\mbox{\tt in,out}  & {\em pp} & Photon to set path of \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Picks a random path bin, weighted by the flux in each in this cell, then assigns a path from within that bin (from a uniform random distribution)

\begin{DoxySeeAlso}{See also}
\hyperlink{paths_8c_a43541dacfceb46c42583c31aeb11d496}{r\+\_\+draw\+\_\+from\+\_\+path\+\_\+histogram()} 

\hyperlink{paths_8c_a7719923b66bf470bc4eeb42c454ebd48}{simple\+\_\+paths\+\_\+gen\+\_\+phot()}
\end{DoxySeeAlso}
\paragraph*{Notes}

26/2/15 -\/ Written by S\+WM 24/7/15 -\/ Removed frequency 

Definition at line 392 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a176ee6debad2930212ca97a2d28794c0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a0d8a68cc8cb0e384901a71173dbc333f}\label{templates_8h_a0d8a68cc8cb0e384901a71173dbc333f}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+init@{wind\+\_\+paths\+\_\+init}}
\index{wind\+\_\+paths\+\_\+init@{wind\+\_\+paths\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+init()}{wind\_paths\_init()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind }\end{DoxyParamCaption})}



Initialises wind path structures. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em wind} & Top-\/level wind cell array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Iterates over each wind cell, and declares a single generic \textquotesingle{}wind path\textquotesingle{} array for binning the paths of incident photons in. Also declares a \textquotesingle{}wind path\textquotesingle{} array for each specific line of interest in matom mode.

\paragraph*{Notes}

10/2/15 -\/ Written by S\+WM 

Definition at line 179 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a0d8a68cc8cb0e384901a71173dbc333f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{templates_8h_a0d8a68cc8cb0e384901a71173dbc333f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abcd463073ed7efc165937715a983b7b7}\label{templates_8h_abcd463073ed7efc165937715a983b7b7}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+output\+\_\+dump@{wind\+\_\+paths\+\_\+output\+\_\+dump}}
\index{wind\+\_\+paths\+\_\+output\+\_\+dump@{wind\+\_\+paths\+\_\+output\+\_\+dump}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+output\+\_\+dump()}{wind\_paths\_output\_dump()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+output\+\_\+dump (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{i\+\_\+rank }\end{DoxyParamCaption})}



Iterates through the wind, dumping cells of interest. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Wind array to dump from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
Outputs a file \char`\"{}root.\+ngrid.\+csv\char`\"{} containing the path length bins and total flux in each for each line histogram (and the regular wind histogram) in the given cell.

\paragraph*{Notes}

10/15 -\/ Written by S\+WM 

Definition at line 640 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{templates_8h_abcd463073ed7efc165937715a983b7b7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{templates_8h_abcd463073ed7efc165937715a983b7b7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad7572cd8c842aa9c3ee2476a89888ec4}\label{templates_8h_ad7572cd8c842aa9c3ee2476a89888ec4}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+output\+\_\+vtk@{wind\+\_\+paths\+\_\+output\+\_\+vtk}}
\index{wind\+\_\+paths\+\_\+output\+\_\+vtk@{wind\+\_\+paths\+\_\+output\+\_\+vtk}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+output\+\_\+vtk()}{wind\_paths\_output\_vtk()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+output\+\_\+vtk (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{wind,  }\item[{int}]{ndom }\end{DoxyParamCaption})}



Outputs wind path information to vtk. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em wind} & Pointer to wind array. \\
\hline
\mbox{\tt in}  & {\em c\+\_\+file\+\_\+in} & Name of input file. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
When given a wind containing position and delay map information generated using R\+E\+V\+E\+R\+B\+\_\+\+W\+I\+ND, outputs a 3d model of the wind to file in A\+S\+C\+II .vtk format.

\paragraph*{Notes\#\#\# Written by S\+WM 4/15.}

Definition at line 728 of file paths.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad7572cd8c842aa9c3ee2476a89888ec4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{templates_8h_ad7572cd8c842aa9c3ee2476a89888ec4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a84734785aa6884b89825ac2b84ad5f54}\label{templates_8h_a84734785aa6884b89825ac2b84ad5f54}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+point\+\_\+index}}
\index{wind\+\_\+paths\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+point\+\_\+index}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+point\+\_\+index()}{wind\_paths\_point\_index()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+point\+\_\+index (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{int}]{k,  }\item[{int}]{i\+\_\+top,  }\item[{\hyperlink{python_8h_ae022cd774d7ee369fc758eff33990847}{Domain\+Ptr}}]{dom }\end{DoxyParamCaption})}



Given trz index in wind, returns vtk data index. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em i} & Theta index of cell. \\
\hline
\mbox{\tt in}  & {\em j} & Radius index of cell. \\
\hline
\mbox{\tt in}  & {\em k} & Height index of cell. \\
\hline
\mbox{\tt in}  & {\em i\+\_\+top} & Whether the point is above or below the disk \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Index for vtk poly.
\end{DoxyReturn}
When given the position of a cell in the wind, returns the corresponding index in the flat V\+TK data arrays. RZ uses the uses the standard wind location, theta is set as defined in geo. Used in wind\+\_\+paths\+\_\+output() only.

\paragraph*{Notes\#\#\# Written by S\+WM 4/15.}

Definition at line 681 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a84734785aa6884b89825ac2b84ad5f54_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_afd823b3b0d87b9378a04d10604a29cf1}\label{templates_8h_afd823b3b0d87b9378a04d10604a29cf1}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index}}
\index{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index@{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index()}{wind\_paths\_sphere\_point\_index()}}
{\footnotesize\ttfamily int wind\+\_\+paths\+\_\+sphere\+\_\+point\+\_\+index (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{int}]{k }\end{DoxyParamCaption})}



Given rtt index in wind, returns vtk data index. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em i} & Theta index of cell. \\
\hline
\mbox{\tt in}  & {\em j} & Radius index of cell. \\
\hline
\mbox{\tt in}  & {\em k} & Height index of cell. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Index for vtk poly.
\end{DoxyReturn}
When given the position of a cell in the wind, returns the corresponding index in the flat V\+TK data arrays. RZ uses the uses the standard wind location, theta is set as defined in geo. Used in wind\+\_\+paths\+\_\+output() only.

\paragraph*{Notes\#\#\# Written by S\+WM 4/15.}

Definition at line 705 of file paths.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_afd823b3b0d87b9378a04d10604a29cf1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a1a5d1633d95cf4e242e41401a1dd5fc5}\label{templates_8h_a1a5d1633d95cf4e242e41401a1dd5fc5}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+rad\+\_\+init@{wind\+\_\+rad\+\_\+init}}
\index{wind\+\_\+rad\+\_\+init@{wind\+\_\+rad\+\_\+init}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+rad\+\_\+init()}{wind\_rad\_init()}}
{\footnotesize\ttfamily int wind\+\_\+rad\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



zeros those portions of the wind which contain the radiation properties of the wind, i.\+e those portions which should be set to zeroed when the structure of the wind has been changed or when you simply want to start off a calculation in a known state 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine is called at the beginning of each ionization calculation cycle. It should zero all heating and radiation induced cooling in the wind array. Since cooling is recalculated in wind\+\_\+update, one needs to be sure that all of the appropriate cooling terms are also rezeroed there as well.

\paragraph*{Notes}

Definition at line 1013 of file wind\+\_\+updates2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=224pt]{templates_8h_a1a5d1633d95cf4e242e41401a1dd5fc5_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ad72f5c977c7a79152243ba8ba509cccc}\label{templates_8h_ad72f5c977c7a79152243ba8ba509cccc}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+read@{wind\+\_\+read}}
\index{wind\+\_\+read@{wind\+\_\+read}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+read()}{wind\_read()}}
{\footnotesize\ttfamily int wind\+\_\+read (\begin{DoxyParamCaption}\item[{char}]{filename\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8f1809d0fc03ad74b934bd6746f15e38}\label{templates_8h_a8f1809d0fc03ad74b934bd6746f15e38}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+reg\+\_\+summary@{wind\+\_\+reg\+\_\+summary}}
\index{wind\+\_\+reg\+\_\+summary@{wind\+\_\+reg\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+reg\+\_\+summary()}{wind\_reg\_summary()}}
{\footnotesize\ttfamily int wind\+\_\+reg\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ab38c3e9bfb1c5f325ba00fbefbae66e1}\label{templates_8h_ab38c3e9bfb1c5f325ba00fbefbae66e1}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+save@{wind\+\_\+save}}
\index{wind\+\_\+save@{wind\+\_\+save}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+save()}{wind\_save()}}
{\footnotesize\ttfamily int wind\+\_\+save (\begin{DoxyParamCaption}\item[{char}]{filename\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a861aa1ae584f627229b18f9b352ae2be}\label{templates_8h_a861aa1ae584f627229b18f9b352ae2be}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+update@{wind\+\_\+update}}
\index{wind\+\_\+update@{wind\+\_\+update}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+update()}{wind\_update()}}
{\footnotesize\ttfamily int wind\+\_\+update (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}(w)}]{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ad2938cb78e3414274491d2d778843db3}\label{templates_8h_ad2938cb78e3414274491d2d778843db3}} 
\index{templates.\+h@{templates.\+h}!wind\+\_\+x\+\_\+to\+\_\+n@{wind\+\_\+x\+\_\+to\+\_\+n}}
\index{wind\+\_\+x\+\_\+to\+\_\+n@{wind\+\_\+x\+\_\+to\+\_\+n}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{wind\+\_\+x\+\_\+to\+\_\+n()}{wind\_x\_to\_n()}}
{\footnotesize\ttfamily int wind\+\_\+x\+\_\+to\+\_\+n (\begin{DoxyParamCaption}\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{int $\ast$}]{n }\end{DoxyParamCaption})}



Determine the wind domain element number from a postion. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} A three vector describing a position \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ n The element number in the wind domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Also retruns the element number in the wind domain
\end{DoxyReturn}
The routine simply cycles through the various domains until if finds one in where x is in that domain.

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000061}{Bug}]There are no checks for whether x is within the wind. This seems very dangerous.\end{DoxyRefDesc}


Definition at line 610 of file util.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ad2938cb78e3414274491d2d778843db3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a2fe32522b8e86fa83527e71906d634ef}\label{templates_8h_a2fe32522b8e86fa83527e71906d634ef}} 
\index{templates.\+h@{templates.\+h}!write\+\_\+array@{write\+\_\+array}}
\index{write\+\_\+array@{write\+\_\+array}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{write\+\_\+array()}{write\_array()}}
{\footnotesize\ttfamily int write\+\_\+array (\begin{DoxyParamCaption}\item[{char}]{filename\mbox{[}$\,$\mbox{]},  }\item[{int}]{choice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a73ab7eda651994b533e79cc4d7957198}\label{templates_8h_a73ab7eda651994b533e79cc4d7957198}} 
\index{templates.\+h@{templates.\+h}!xadiabatic\+\_\+cooling\+\_\+summary@{xadiabatic\+\_\+cooling\+\_\+summary}}
\index{xadiabatic\+\_\+cooling\+\_\+summary@{xadiabatic\+\_\+cooling\+\_\+summary}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xadiabatic\+\_\+cooling\+\_\+summary()}{xadiabatic\_cooling\_summary()}}
{\footnotesize\ttfamily int xadiabatic\+\_\+cooling\+\_\+summary (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{char}]{rootname\mbox{[}$\,$\mbox{]},  }\item[{int}]{ochoice }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a9a0acf2d461c665dc0302defa95ded65}\label{templates_8h_a9a0acf2d461c665dc0302defa95ded65}} 
\index{templates.\+h@{templates.\+h}!xdefine\+\_\+phot@{xdefine\+\_\+phot}}
\index{xdefine\+\_\+phot@{xdefine\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xdefine\+\_\+phot()}{xdefine\_phot()}}
{\footnotesize\ttfamily int xdefine\+\_\+phot (\begin{DoxyParamCaption}\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{int}]{iwind }\end{DoxyParamCaption})}



calculates the band limited fluxes \& luminosities, and prepares for the producting of photons (by reinitializing the disk, among other things). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & f1 The minimum freqeuncy \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final 0 -\/$>$ this is for the wind ionization calculation; 1-\/$>$ it is for the final spectrum calculation \\
\hline
\mbox{\tt in}  & {\em int} & iwind if 0, include wind photons; if 1 include wind photons and force a recalcuation of ion denisities, if -\/1, ignore the possibility of wind photons \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is a routine that initilizes things. It does not generate photons itself.

The routine calls various other routines to calcuate the band limited luminosities of various radiation sources (which is used in allocating how many photons to create from each). The results are stored in elements of the geo structure.

\paragraph*{Notes}

Note\+: This routine is something of a kluge. Information is passed back to the calling routine through the geo structure, rather than a more obvious method. The routine was created when a banded approach was defined, but the whole section might be more obvious. 

Definition at line 286 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a9a0acf2d461c665dc0302defa95ded65_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{templates_8h_a9a0acf2d461c665dc0302defa95ded65_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_abbfb58b40faa368dabec2eb9f4b51c89}\label{templates_8h_abbfb58b40faa368dabec2eb9f4b51c89}} 
\index{templates.\+h@{templates.\+h}!xinteg\+\_\+fb@{xinteg\+\_\+fb}}
\index{xinteg\+\_\+fb@{xinteg\+\_\+fb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xinteg\+\_\+fb()}{xinteg\_fb()}}
{\footnotesize\ttfamily double xinteg\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nion,  }\item[{int}]{fb\+\_\+choice }\end{DoxyParamCaption})}



calculates the integrated emissivity of an ion in the plasma. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & t The temperature of interest \\
\hline
\mbox{\tt in,out}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in,out}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in,out}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in,out}  & {\em int} & fb\+\_\+choice A switch which determined exactly what is returned \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The integrated emissivity, depending on the fb\+\_\+choice. The possibilites are
\end{DoxyReturn}

\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

The routine preforms a numberical integration over the partial emissivities

\paragraph*{Notes}

This routine is called by integ\+\_\+fb. It is not intended to be called directly, which uses a Numerical Recipes routine to integrate over frequncy. 

Definition at line 1249 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abbfb58b40faa368dabec2eb9f4b51c89_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_abbfb58b40faa368dabec2eb9f4b51c89_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a250e063dde090c67146f51ea71371bfc}\label{templates_8h_a250e063dde090c67146f51ea71371bfc}} 
\index{templates.\+h@{templates.\+h}!xinteg\+\_\+inner\+\_\+fb@{xinteg\+\_\+inner\+\_\+fb}}
\index{xinteg\+\_\+inner\+\_\+fb@{xinteg\+\_\+inner\+\_\+fb}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xinteg\+\_\+inner\+\_\+fb()}{xinteg\_inner\_fb()}}
{\footnotesize\ttfamily double xinteg\+\_\+inner\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nion,  }\item[{int}]{fb\+\_\+choice }\end{DoxyParamCaption})}



calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperarure of interest \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice ??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Exactly what the the routine returns is determined by fb\+\_\+choice, which is passed as an an external variable to fb\+\_\+topbase\+\_\+partial
\end{DoxyReturn}
The possibilites are


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

\paragraph*{Notes}

This routine is virtual copy of xinteg\+\_\+fb but considers only inner shells . The integration that is requied to integrate over frequencies is carried out using the Numerical Recipes routine qromb. This is why a number of variables are passed as external variables, include fb\+\_\+choice, fmin and fmax. 

Definition at line 1375 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a250e063dde090c67146f51ea71371bfc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a250e063dde090c67146f51ea71371bfc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab7f1c9362f29a0b44f41cff21494b6df}\label{templates_8h_ab7f1c9362f29a0b44f41cff21494b6df}} 
\index{templates.\+h@{templates.\+h}!xmake\+\_\+phot@{xmake\+\_\+phot}}
\index{xmake\+\_\+phot@{xmake\+\_\+phot}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xmake\+\_\+phot()}{xmake\_phot()}}
{\footnotesize\ttfamily int xmake\+\_\+phot (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{ioniz\+\_\+or\+\_\+final,  }\item[{int}]{iwind,  }\item[{double}]{weight,  }\item[{int}]{iphot\+\_\+start,  }\item[{int}]{nphotons }\end{DoxyParamCaption})}



just makes photons 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Phot\+Ptr} & p The entire photon structure \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency for generating photons \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency for generating photons \\
\hline
\mbox{\tt in}  & {\em int} & ioniz\+\_\+or\+\_\+final A flag indicating whether this if for an ionization or detailed spectral cycle (Used to determine what underlying spectrum, e.\+g bb or detailed models) to sample \\
\hline
\mbox{\tt in}  & {\em int} & iwind A flag indicating whether or not to genrate any wind photons. \\
\hline
\mbox{\tt in}  & {\em double} & weight The weight of photons to generate \\
\hline
\mbox{\tt in}  & {\em int} & iphot\+\_\+start The position in the photon structure to start storing photons \\
\hline
\mbox{\tt in}  & {\em int} & nphotons The number of photons to generate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
make\+\_\+phot controls the actual generation of photons. All of the initializations should have been done previously (xdefine\+\_\+phot). xmake\+\_\+phot cycles throght the various possible sources of the wind, including for example, the disk, the central object, and the wind, and creates photons for each, using the ratio of the band limited luminosites to the total band limited luminosity to determine how many photons to select from each source.

\paragraph*{Notes}

Definition at line 422 of file photon\+\_\+gen.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{templates_8h_ab7f1c9362f29a0b44f41cff21494b6df_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{templates_8h_ab7f1c9362f29a0b44f41cff21494b6df_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_ab5487fc46112085131fe007108772011}\label{templates_8h_ab5487fc46112085131fe007108772011}} 
\index{templates.\+h@{templates.\+h}!xquadratic@{xquadratic}}
\index{xquadratic@{xquadratic}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xquadratic()}{xquadratic()}}
{\footnotesize\ttfamily int xquadratic (\begin{DoxyParamCaption}\item[{double}]{a,  }\item[{double}]{b,  }\item[{double}]{c,  }\item[{double}]{r\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_ab1f63fcb955cb5c77dcb2d35b5da2cd4}\label{templates_8h_ab1f63fcb955cb5c77dcb2d35b5da2cd4}} 
\index{templates.\+h@{templates.\+h}!xsignal@{xsignal}}
\index{xsignal@{xsignal}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xsignal()}{xsignal()}}
{\footnotesize\ttfamily int xsignal (\begin{DoxyParamCaption}\item[{char $\ast$}]{root,  }\item[{char $\ast$}]{format,  }\item[{}]{... }\end{DoxyParamCaption})}



xsignal generates a single line message to a file names root.\+sig 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & $\ast$ root root name of the file to wirte to \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ format A format string \\
\hline
\mbox{\tt in}  & {\em ...} & The remaining inputs for the fprintf statement \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
If one cannot write to the .sig file, Python will exit

\paragraph*{Notes}

In principle almost anything can be written to the .sig file, as this uses vfprintf to write to the file. In pracitce all of the messages have the format

Mon Nov 10 09\+:05\+:34 2008 10.\+0 message

where the message is determined by the format and the extra variables that are passed to the program.

The messages are all written from the rank 0 thread. 

Definition at line 78 of file signal.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_ab1f63fcb955cb5c77dcb2d35b5da2cd4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=219pt]{templates_8h_ab1f63fcb955cb5c77dcb2d35b5da2cd4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_adb0062a13c369fa8c13a5a02c3ffec86}\label{templates_8h_adb0062a13c369fa8c13a5a02c3ffec86}} 
\index{templates.\+h@{templates.\+h}!xsignal\+\_\+rm@{xsignal\+\_\+rm}}
\index{xsignal\+\_\+rm@{xsignal\+\_\+rm}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xsignal\+\_\+rm()}{xsignal\_rm()}}
{\footnotesize\ttfamily int xsignal\+\_\+rm (\begin{DoxyParamCaption}\item[{char $\ast$}]{root }\end{DoxyParamCaption})}



Remove the old signal file so that one can begin again. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em char} & $\ast$ root Root name of the .sig file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine checks whether a .sig file exists, and if so removes it

\paragraph*{Notes}

Thread 0 is responsible for executing the removal. 

Definition at line 164 of file signal.\+c.

\mbox{\Hypertarget{templates_8h_ad0ff63710a78f84604f2adc60d4b1c32}\label{templates_8h_ad0ff63710a78f84604f2adc60d4b1c32}} 
\index{templates.\+h@{templates.\+h}!xtemp\+\_\+rad@{xtemp\+\_\+rad}}
\index{xtemp\+\_\+rad@{xtemp\+\_\+rad}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xtemp\+\_\+rad()}{xtemp\_rad()}}
{\footnotesize\ttfamily int xtemp\+\_\+rad (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Prints out t\+\_\+r and t\+\_\+e and the total number of photons in a subsample of the the grid that fits on a typical output terminal. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is just a logging routine that prints out a few key parameters at the end of each ionization cycle so that one can get a crude overview of what is happening.

\paragraph*{Notes}

This routine is adapted from a very similar routine in py\+\_\+wind

If the number of grid cells in the x direction is less more than 30 the grid gets subsampled in the x direction

The routine won\textquotesingle{}t fail but the output is less useful when coodinates systems other than cylindrical are used.

180526 -\/ ksl -\/ Fixed \#384 

Definition at line 58 of file wind\+\_\+sum.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{templates_8h_ad0ff63710a78f84604f2adc60d4b1c32_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_af3162ce29644bbfd1d6ef9060d972643}\label{templates_8h_af3162ce29644bbfd1d6ef9060d972643}} 
\index{templates.\+h@{templates.\+h}!xtotal\+\_\+emission@{xtotal\+\_\+emission}}
\index{xtotal\+\_\+emission@{xtotal\+\_\+emission}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{xtotal\+\_\+emission()}{xtotal\_emission()}}
{\footnotesize\ttfamily double xtotal\+\_\+emission (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



calculate the cooling of a single cell due to free free, bound -\/ boound and recombination processes. 


\begin{DoxyParams}[1]{Parameters}
 & {\em \mbox{[}in} & out\mbox{]} Wind\+Ptr one A singel wind cell \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequecny \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequecny \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The cooling rate
\end{DoxyReturn}
xtotal\+\_\+emission gives the total enery loss due to photons. It does not include other coooling sources, e. g. adiabatic expansion.

\paragraph*{Notes}

It returns the total cooling, but also stores the luminosity due to various types of emssion, e.\+g ff and lines into the Plasms cells. The fb cooling calculated here is {\itshape not} equal to the fb lumniosity and so this value is stored in cool\+\_\+rr.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000010}{Bug}]The call to this routine was changed when Plasma\+Ptrs were introduced, but it appears that the various routines that were called were not changed. This needs to be fixed for consistency\end{DoxyRefDesc}


Definition at line 162 of file cooling.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af3162ce29644bbfd1d6ef9060d972643_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_af3162ce29644bbfd1d6ef9060d972643_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a624115af503ecce9d20d3fc8c3813ca0}\label{templates_8h_a624115af503ecce9d20d3fc8c3813ca0}} 
\index{templates.\+h@{templates.\+h}!yso\+\_\+rho@{yso\+\_\+rho}}
\index{yso\+\_\+rho@{yso\+\_\+rho}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{yso\+\_\+rho()}{yso\_rho()}}
{\footnotesize\ttfamily double yso\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a1ed063376968bf4fa4d573f19bae7375}\label{templates_8h_a1ed063376968bf4fa4d573f19bae7375}} 
\index{templates.\+h@{templates.\+h}!yso\+\_\+velocity@{yso\+\_\+velocity}}
\index{yso\+\_\+velocity@{yso\+\_\+velocity}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{yso\+\_\+velocity()}{yso\_velocity()}}
{\footnotesize\ttfamily double yso\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{double}]{x\mbox{[}$\,$\mbox{]},  }\item[{double}]{v\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{templates_8h_a8c30fbf58d7a0b5789604f00c96bedb6}\label{templates_8h_a8c30fbf58d7a0b5789604f00c96bedb6}} 
\index{templates.\+h@{templates.\+h}!zbrent@{zbrent}}
\index{zbrent@{zbrent}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{zbrent()}{zbrent()}}
{\footnotesize\ttfamily double zbrent (\begin{DoxyParamCaption}\item[{double($\ast$)(double)}]{func,  }\item[{double}]{x1,  }\item[{double}]{x2,  }\item[{double}]{tol }\end{DoxyParamCaption})}



A routine that finds the rooot of a function f. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$funcd} & The function which one wishes a root for \\
\hline
\mbox{\tt in}  & {\em x1} & one end of the interval \\
\hline
\mbox{\tt in}  & {\em x2} & the other end of the interval \\
\hline
\mbox{\tt in}  & {\em tol} & A tolerence for the root \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The root of the function f .
\end{DoxyReturn}
A Numerical Recipes routine to find the root of a function known to be between x1 and x2

\paragraph*{Notes}

Definition at line 220 of file recipes.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a8c30fbf58d7a0b5789604f00c96bedb6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a4027a82b7c3df9474704080c8b3137cc}\label{templates_8h_a4027a82b7c3df9474704080c8b3137cc}} 
\index{templates.\+h@{templates.\+h}!zdisk@{zdisk}}
\index{zdisk@{zdisk}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{zdisk()}{zdisk()}}
{\footnotesize\ttfamily double zdisk (\begin{DoxyParamCaption}\item[{double}]{r }\end{DoxyParamCaption})}



Calculate the height of the disk at a certain radius. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & r a radial position in the disk. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The vertical height of the disk at that point in the xy plane.
\end{DoxyReturn}
If the disk is vertically extended then the disk surface is defined in terms of the h the fraction of the disk radius at the edge of the disk, and a power law exponent. So a disk thst us a sunoke wedgge wiykd gave an exponent of 1. A flat but thick disk would have an exponent of 0. A flared disk wouuld generally have an exponent greater than 1.

\paragraph*{Notes}

\begin{DoxyVerb}zdisk returns a number that will positive or zero, so one
often needs to take this account if for example one has
a photon that hits the disk below the z=0 plane.\end{DoxyVerb}
 

Definition at line 311 of file disk.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a4027a82b7c3df9474704080c8b3137cc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a866bab53f422c2afa889e5e549df76d1}\label{templates_8h_a866bab53f422c2afa889e5e549df76d1}} 
\index{templates.\+h@{templates.\+h}!zero\+\_\+emit@{zero\+\_\+emit}}
\index{zero\+\_\+emit@{zero\+\_\+emit}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{zero\+\_\+emit()}{zero\_emit()}}
{\footnotesize\ttfamily double zero\+\_\+emit (\begin{DoxyParamCaption}\item[{double}]{t }\end{DoxyParamCaption})}



Compute the cooling for a cell given a temperature t, and compare it to the heating seen in the cell in the previous ionization cycle. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t A trial temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The difference between the recorded heating and the cooling
\end{DoxyReturn}
This routine is used to estiamate a new temperature for a cell given the heating of the cell in the previous ionization cycle.

\paragraph*{Notes}

The abundances of ions in the cell are not modified. Results are stored in the cell of interest. This routine is used in connection with a zero finding routine 

Definition at line 557 of file ionization.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a866bab53f422c2afa889e5e549df76d1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{templates_8h_a866bab53f422c2afa889e5e549df76d1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{templates_8h_a055c7dce44e704928680abae7b7aa684}\label{templates_8h_a055c7dce44e704928680abae7b7aa684}} 
\index{templates.\+h@{templates.\+h}!zero\+\_\+scatters@{zero\+\_\+scatters}}
\index{zero\+\_\+scatters@{zero\+\_\+scatters}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{zero\+\_\+scatters()}{zero\_scatters()}}
{\footnotesize\ttfamily int zero\+\_\+scatters (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



zero out the portion of plasmamain that records the number of scatters in each cell 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

The routine is called at the point where we begin to calculate the detailed spectrum. It\textquotesingle{}s a little unclear why it is simply not incorporated into spectrum\+\_\+init 

Definition at line 1151 of file wind2d.\+c.

\mbox{\Hypertarget{templates_8h_aa82b71670033cd85494ad043285e8c75}\label{templates_8h_aa82b71670033cd85494ad043285e8c75}} 
\index{templates.\+h@{templates.\+h}!zoom@{zoom}}
\index{zoom@{zoom}!templates.\+h@{templates.\+h}}
\subsubsection{\texorpdfstring{zoom()}{zoom()}}
{\footnotesize\ttfamily int zoom (\begin{DoxyParamCaption}\item[{int}]{direction }\end{DoxyParamCaption})}



Definition at line 69 of file py\+\_\+wind\+\_\+sub.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{templates_8h_aa82b71670033cd85494ad043285e8c75_cgraph}
\end{center}
\end{figure}
