\hypertarget{wind2d_8c}{}\section{/\+Users/mhewitt/python/source/wind2d.c File Reference}
\label{wind2d_8c}\index{/\+Users/mhewitt/python/source/wind2d.\+c@{/\+Users/mhewitt/python/source/wind2d.\+c}}


Routines that are used to define the wind initially.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for wind2d.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{wind2d_8c_ac98ab21bbcfcfc326f0b16fabd5587c0}{N\+S\+T\+E\+PS}~100
\begin{DoxyCompactList}\small\item\em The routine calculates and then logs the mass loss rate in two ways. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc}{define\+\_\+wind} ()
\begin{DoxyCompactList}\small\item\em initializes the structures which characterize the wind, including wmain and plasmamain. \end{DoxyCompactList}\item 
int \hyperlink{wind2d_8c_ad4b676b9911462eec0740df5f8f0da55}{where\+\_\+in\+\_\+grid} (int ndom, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em locates the element in wmain associated with a postion \end{DoxyCompactList}\item 
int \hyperlink{wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f}{vwind\+\_\+xyz} (int ndom, \hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p, \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p. \end{DoxyCompactList}\item 
int \hyperlink{wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221}{wind\+\_\+div\+\_\+v} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w)
\item 
double \hyperlink{wind2d_8c_a078472458c0ac73f723c094fc2121c14}{rho} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em find the density of the wind at x \end{DoxyCompactList}\item 
int \hyperlink{wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee}{mdot\+\_\+wind} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} w, double \hyperlink{import__cylindrical_8c_a136f2755339206755ab0c02f8e53c5fc}{z}, double rmax)
\item 
int \hyperlink{wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899}{get\+\_\+random\+\_\+location} (int n, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em is simply will produce a postion at a random place in a cell n \end{DoxyCompactList}\item 
int \hyperlink{wind2d_8c_a675b4d912b5b505f099fc17031660393}{zero\+\_\+scatters} ()
\begin{DoxyCompactList}\small\item\em zero out the portion of plasmamain that records the number of scatters in each cell \end{DoxyCompactList}\item 
int \hyperlink{wind2d_8c_a80e38cc8054ee669104c30986700d508}{check\+\_\+corners\+\_\+inwind} (int n)
\begin{DoxyCompactList}\small\item\em The routine basically just calls where\+\_\+in\+\_\+wind for each of the 4 corners of the cell. \end{DoxyCompactList}\item 
int \hyperlink{wind2d_8c_a980ea04ae2c501a6df12080eb698a851}{check\+\_\+grid} ()
\begin{DoxyCompactList}\small\item\em check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might wish to have smaller grid cells \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{wind2d_8c_ae1705b3b8167c7d811573af4a3bd063d}{wig\+\_\+n}
\item 
double \hyperlink{wind2d_8c_a85d6497ec425ae7ad645123ecd08851b}{wig\+\_\+x}
\item 
double \hyperlink{wind2d_8c_a44ecbd1b141d80e28463cf7da2bc94c7}{wig\+\_\+y}
\item 
double \hyperlink{wind2d_8c_ab087c671695d8b903dc431a91b0d85da}{wig\+\_\+z}
\item 
int \hyperlink{wind2d_8c_ad318f8972d3832930303d84e94599a89}{ierr\+\_\+vwind} = 0
\item 
int \hyperlink{wind2d_8c_a8fe8eb8bacb888783ada9dd32b523e1a}{wind\+\_\+div\+\_\+err} = (-\/3)
\begin{DoxyCompactList}\small\item\em calculates the divergence of the velocity at the center of all the grid cells. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines that are used to define the wind initially. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
May, 2018
\end{DoxyDate}
The file also contains a number of utility routines, several of which are steering routines to coordinate system specific routines. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{wind2d_8c_ac98ab21bbcfcfc326f0b16fabd5587c0}\label{wind2d_8c_ac98ab21bbcfcfc326f0b16fabd5587c0}} 
\index{wind2d.\+c@{wind2d.\+c}!N\+S\+T\+E\+PS@{N\+S\+T\+E\+PS}}
\index{N\+S\+T\+E\+PS@{N\+S\+T\+E\+PS}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{N\+S\+T\+E\+PS}{NSTEPS}}
{\footnotesize\ttfamily \#define N\+S\+T\+E\+PS~100}



The routine calculates and then logs the mass loss rate in two ways. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & w The entire wind domain \\
\hline
\mbox{\tt in}  & {\em double} & z A zheight above the disk to calculate the mass loss rate \\
\hline
\mbox{\tt in}  & {\em double} & rmax A radius at which to calculate the mass loss rate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always retruns 0
\end{DoxyReturn}
The routine calculates the mass loss rate in two ways, one in a plane with a zheight of 0 above the disk (out to a distance rmax, and one at a spherical radius rmax

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000064}{Bug}]This routine has errors. It is only correct if there is a single domain. In particular rho(w,x) gives the correct answer for rho regardless of domains, but nodom is set to 0 for vind(ndom,\&p,v). This should be fixed.\end{DoxyRefDesc}


Definition at line 1008 of file wind2d.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{wind2d_8c_a80e38cc8054ee669104c30986700d508}\label{wind2d_8c_a80e38cc8054ee669104c30986700d508}} 
\index{wind2d.\+c@{wind2d.\+c}!check\+\_\+corners\+\_\+inwind@{check\+\_\+corners\+\_\+inwind}}
\index{check\+\_\+corners\+\_\+inwind@{check\+\_\+corners\+\_\+inwind}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{check\+\_\+corners\+\_\+inwind()}{check\_corners\_inwind()}}
{\footnotesize\ttfamily int check\+\_\+corners\+\_\+inwind (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



The routine basically just calls where\+\_\+in\+\_\+wind for each of the 4 corners of the cell. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n the cell number in wmain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of corners of the cell that are in the wind
\end{DoxyReturn}
This is really just a driver routine which calls coordinate system specific routines

It is intended to standardize this check so that one can use such a routine in the volumes calculations.

\paragraph*{Notes}

This is one of the routines that makes explicity assumptions about guard cells, and it is not entirely clear why 

Definition at line 1245 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{wind2d_8c_a80e38cc8054ee669104c30986700d508_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_a80e38cc8054ee669104c30986700d508_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_a980ea04ae2c501a6df12080eb698a851}\label{wind2d_8c_a980ea04ae2c501a6df12080eb698a851}} 
\index{wind2d.\+c@{wind2d.\+c}!check\+\_\+grid@{check\+\_\+grid}}
\index{check\+\_\+grid@{check\+\_\+grid}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{check\+\_\+grid()}{check\_grid()}}
{\footnotesize\ttfamily int check\+\_\+grid (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



check whether some quantities in a grid cell are changing so rapidly in the grid cell that one might wish to have smaller grid cells 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The results are logged.

loops over the entire wind points and checks quantities like velocity gradients and optical depths across cells for large changes. If there are large changes in cells, it tells the user how many cells and suggests that the grid may need to be modified.

\paragraph*{Notes}

Must be called after define wind so N\+P\+L\+A\+S\+MA and densities are set up.

The information that is checked is very basic and it is clear that someone was thinking about doing somewhat better checks.

Errors are not generated, or rather have been commented out, and so one needs to consider whether this is useful or not. If so there should be errors. 

Definition at line 1313 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_a980ea04ae2c501a6df12080eb698a851_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=202pt]{wind2d_8c_a980ea04ae2c501a6df12080eb698a851_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc}\label{wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc}} 
\index{wind2d.\+c@{wind2d.\+c}!define\+\_\+wind@{define\+\_\+wind}}
\index{define\+\_\+wind@{define\+\_\+wind}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{define\+\_\+wind()}{define\_wind()}}
{\footnotesize\ttfamily int define\+\_\+wind (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



initializes the structures which characterize the wind, including wmain and plasmamain. 

\begin{DoxyReturn}{Returns}
Allways returns 0
\end{DoxyReturn}
This is the controlling routine for initializing the wind and related structures, calculating the salient properties (e.\+g. the volume that is in the wind) in each grid cell.

\paragraph*{Notes}

This is a fairly complex routine. In addition ot allocating space, the routine initalizes the wind. In some case the initalization is done \char`\"{}in-\/line\char`\"{} but more often other routines, many of which coordinate system specifica are clled. 

Definition at line 43 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{wind2d_8c_a41ee5cb999f1d4258673b6134394b4cc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899}\label{wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899}} 
\index{wind2d.\+c@{wind2d.\+c}!get\+\_\+random\+\_\+location@{get\+\_\+random\+\_\+location}}
\index{get\+\_\+random\+\_\+location@{get\+\_\+random\+\_\+location}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+random\+\_\+location()}{get\_random\_location()}}
{\footnotesize\ttfamily int get\+\_\+random\+\_\+location (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{ }\end{DoxyParamCaption})}



is simply will produce a postion at a random place in a cell n 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n An element number in the wind structure \\
\hline
\mbox{\tt out}  & {\em double} & x\mbox{[}\mbox{]} The random location that is calculaed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
This is really just a driver routine for coordinate system specific routines

\paragraph*{Notes}

Definition at line 1098 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_af8f7fd3a6d5f7872ee87beb27dcba899_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee}\label{wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee}} 
\index{wind2d.\+c@{wind2d.\+c}!mdot\+\_\+wind@{mdot\+\_\+wind}}
\index{mdot\+\_\+wind@{mdot\+\_\+wind}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{mdot\+\_\+wind()}{mdot\_wind()}}
{\footnotesize\ttfamily int mdot\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{double}]{z,  }\item[{double}]{rmax }\end{DoxyParamCaption})}



Definition at line 1011 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{wind2d_8c_a558bbf4d12656ab12c2a03f6475b0eee_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_a078472458c0ac73f723c094fc2121c14}\label{wind2d_8c_a078472458c0ac73f723c094fc2121c14}} 
\index{wind2d.\+c@{wind2d.\+c}!rho@{rho}}
\index{rho@{rho}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{rho()}{rho()}}
{\footnotesize\ttfamily double rho (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{ }\end{DoxyParamCaption})}



find the density of the wind at x 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w The entire wind \\
\hline
\mbox{\tt in,out}  & {\em double} & x\mbox{[}\mbox{]} A position \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The density at x, if the postion is in the active region of the wind. If the postion is not in the active region of one of the domains, then 0 is returned. No error is reported for this
\end{DoxyReturn}
The routine first determines what domain the position is located in, and then intepolates to find the density at a specific position

\paragraph*{Notes}

Definition at line 941 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_a078472458c0ac73f723c094fc2121c14_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_a078472458c0ac73f723c094fc2121c14_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f}\label{wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f}} 
\index{wind2d.\+c@{wind2d.\+c}!vwind\+\_\+xyz@{vwind\+\_\+xyz}}
\index{vwind\+\_\+xyz@{vwind\+\_\+xyz}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{vwind\+\_\+xyz()}{vwind\_xyz()}}
{\footnotesize\ttfamily int vwind\+\_\+xyz (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p,  }\item[{\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}}]{ }\end{DoxyParamCaption})}



finds the velocity vector v for the wind in cartesian coordinates at the position of the photon p. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in}  & {\em Phot\+Ptr} & p A photon \\
\hline
\mbox{\tt out}  & {\em double} & v\mbox{[}\mbox{]} The velocity at the postion given by phtoon??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on successful completion, or a negative number if photon position is not in the in the grid for the domain of interest.
\end{DoxyReturn}
This routine carries out a bilinear interpolation of the wind velocity. The velocities at the edges of the grid cells must have been defined elsewhere (e.\+g in wind\+\_\+define).

If the position is outside the wind grid, then the velocities will be returned as 0.

\paragraph*{Notes}

For all of the 2d coordinate systems, the positions in the Wind\+Ptr array are calculated in the xz plane. As a result, the velocities in that array are calcuated there as well. Hence, to obtain the velocity in cartesion coordinates one needs to do a simple rotation of the velocity vector.

For spherical (1d) coordinates the situation is complex, the philosopy that has been adopted is to let the program run as if the wind model is intrinsically 2d. The xyz positions of the grid are defined are defined so that are in the xz plane at an angle of 45 degrees to the x axis. This was done so that if one used, say an sv wind, in spherical coordinates, one would select the wind velocities at a plausible location. But it implies that the velocities that have been accepted are not purely radial as one might expect. The choice that has been made is to assume that v\mbox{[}1\mbox{]} is preserved as a non zero value in making the projection. An alternative might have been to preserve the angular rotation rate.

If we ever implement a real 3d coordinate system, one will need to look at this routine again. 

Definition at line 742 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_a7ca398a2557e2b63247eac4366bc2e4f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_ad4b676b9911462eec0740df5f8f0da55}\label{wind2d_8c_ad4b676b9911462eec0740df5f8f0da55}} 
\index{wind2d.\+c@{wind2d.\+c}!where\+\_\+in\+\_\+grid@{where\+\_\+in\+\_\+grid}}
\index{where\+\_\+in\+\_\+grid@{where\+\_\+in\+\_\+grid}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{where\+\_\+in\+\_\+grid()}{where\_in\_grid()}}
{\footnotesize\ttfamily int where\+\_\+in\+\_\+grid (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{ }\end{DoxyParamCaption})}



locates the element in wmain associated with a postion 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain number for the search \\
\hline
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} The position \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
where\+\_\+in\+\_\+grid normally returns the element in wmain associated with a position. If the positions is in the grid (of one of the domains) this will be a positive integer. If the position is not in the grid of one of the domains, a negative number -\/1 will be returned if the position is inside athe grid, -\/2 if it is outside the grid for that domain
\end{DoxyReturn}
\paragraph*{Notes}

where in grid is mainly a steering routine that calls other various coordinate system specific routines.

Where\+\_\+in grid does not tell you whether the position is in the wind!.

What one means by inside or outside the grid may well be different for different coordinate systems.

This is one of the routines in Python that has a long history, in that it existed prior to the implementation of domains. This is why it returns the position in wmain, rather than the position in one of the plasma domains. It would make sense to revise this. 

Definition at line 593 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_ad4b676b9911462eec0740df5f8f0da55_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221}\label{wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221}} 
\index{wind2d.\+c@{wind2d.\+c}!wind\+\_\+div\+\_\+v@{wind\+\_\+div\+\_\+v}}
\index{wind\+\_\+div\+\_\+v@{wind\+\_\+div\+\_\+v}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+div\+\_\+v()}{wind\_div\_v()}}
{\footnotesize\ttfamily int wind\+\_\+div\+\_\+v (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{w }\end{DoxyParamCaption})}



Definition at line 846 of file wind2d.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{wind2d_8c_ad47569135f21d4ce22504b0ad5b0b221_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind2d_8c_a675b4d912b5b505f099fc17031660393}\label{wind2d_8c_a675b4d912b5b505f099fc17031660393}} 
\index{wind2d.\+c@{wind2d.\+c}!zero\+\_\+scatters@{zero\+\_\+scatters}}
\index{zero\+\_\+scatters@{zero\+\_\+scatters}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{zero\+\_\+scatters()}{zero\_scatters()}}
{\footnotesize\ttfamily int zero\+\_\+scatters (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



zero out the portion of plasmamain that records the number of scatters in each cell 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

The routine is called at the point where we begin to calculate the detailed spectrum. It\textquotesingle{}s a little unclear why it is simply not incorporated into spectrum\+\_\+init 

Definition at line 1151 of file wind2d.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{wind2d_8c_a675b4d912b5b505f099fc17031660393_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{wind2d_8c_ad318f8972d3832930303d84e94599a89}\label{wind2d_8c_ad318f8972d3832930303d84e94599a89}} 
\index{wind2d.\+c@{wind2d.\+c}!ierr\+\_\+vwind@{ierr\+\_\+vwind}}
\index{ierr\+\_\+vwind@{ierr\+\_\+vwind}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{ierr\+\_\+vwind}{ierr\_vwind}}
{\footnotesize\ttfamily int ierr\+\_\+vwind = 0}



Definition at line 699 of file wind2d.\+c.

\mbox{\Hypertarget{wind2d_8c_ae1705b3b8167c7d811573af4a3bd063d}\label{wind2d_8c_ae1705b3b8167c7d811573af4a3bd063d}} 
\index{wind2d.\+c@{wind2d.\+c}!wig\+\_\+n@{wig\+\_\+n}}
\index{wig\+\_\+n@{wig\+\_\+n}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{wig\+\_\+n}{wig\_n}}
{\footnotesize\ttfamily int wig\+\_\+n}



Definition at line 558 of file wind2d.\+c.

\mbox{\Hypertarget{wind2d_8c_a85d6497ec425ae7ad645123ecd08851b}\label{wind2d_8c_a85d6497ec425ae7ad645123ecd08851b}} 
\index{wind2d.\+c@{wind2d.\+c}!wig\+\_\+x@{wig\+\_\+x}}
\index{wig\+\_\+x@{wig\+\_\+x}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{wig\+\_\+x}{wig\_x}}
{\footnotesize\ttfamily double wig\+\_\+x}



Definition at line 559 of file wind2d.\+c.

\mbox{\Hypertarget{wind2d_8c_a44ecbd1b141d80e28463cf7da2bc94c7}\label{wind2d_8c_a44ecbd1b141d80e28463cf7da2bc94c7}} 
\index{wind2d.\+c@{wind2d.\+c}!wig\+\_\+y@{wig\+\_\+y}}
\index{wig\+\_\+y@{wig\+\_\+y}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{wig\+\_\+y}{wig\_y}}
{\footnotesize\ttfamily double wig\+\_\+y}



Definition at line 559 of file wind2d.\+c.

\mbox{\Hypertarget{wind2d_8c_ab087c671695d8b903dc431a91b0d85da}\label{wind2d_8c_ab087c671695d8b903dc431a91b0d85da}} 
\index{wind2d.\+c@{wind2d.\+c}!wig\+\_\+z@{wig\+\_\+z}}
\index{wig\+\_\+z@{wig\+\_\+z}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{wig\+\_\+z}{wig\_z}}
{\footnotesize\ttfamily double wig\+\_\+z}



Definition at line 559 of file wind2d.\+c.

\mbox{\Hypertarget{wind2d_8c_a8fe8eb8bacb888783ada9dd32b523e1a}\label{wind2d_8c_a8fe8eb8bacb888783ada9dd32b523e1a}} 
\index{wind2d.\+c@{wind2d.\+c}!wind\+\_\+div\+\_\+err@{wind\+\_\+div\+\_\+err}}
\index{wind\+\_\+div\+\_\+err@{wind\+\_\+div\+\_\+err}!wind2d.\+c@{wind2d.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+div\+\_\+err}{wind\_div\_err}}
{\footnotesize\ttfamily int wind\+\_\+div\+\_\+err = (-\/3)}



calculates the divergence of the velocity at the center of all the grid cells. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Wind\+Ptr} & w The entire wind domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The results are stored in wmain\mbox{[}\mbox{]}.div\+\_\+v

This is one of the initialization routines for the wind. The divergence of velocity of the wind is used to calculated PdV cooling of a grid cell

\paragraph*{Notes}

Because the routine calls vwind\+\_\+xyz, one must have previously populated w\mbox{[}\mbox{]}.v. Also as a result of this fact, the routine is not tightly tied to any particular wind model.

The divergence, like othe scalar quantities, does not need to be \char`\"{}rotated\char`\"{} differently in different coordinate systems

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000063}{Bug}]This routine mixes wmain (which is passed externally) and w which is passed by calling it. While this does not generate an error it should be cleaned up, proably to use only wmain\end{DoxyRefDesc}


Definition at line 843 of file wind2d.\+c.

