\hypertarget{recomb_8c}{}\section{/\+Users/mhewitt/python/source/recomb.c File Reference}
\label{recomb_8c}\index{/\+Users/mhewitt/python/source/recomb.\+c@{/\+Users/mhewitt/python/source/recomb.\+c}}


The routines in this file all have to do with photoionization and/or recombination rates and emissivities.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}recipes.\+h\char`\"{}}\newline
Include dependency graph for recomb.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{recomb_8c_a06ce3976dc892f3d6e3aba0464c3e465}{F\+B\+E\+M\+I\+SS}~7.\+67413e-\/62
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6}{fb\+\_\+topbase\+\_\+partial} (double freq)
\begin{DoxyCompactList}\small\item\em returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms of Topbase photoionization x-\/sections. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805}{integ\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int nion, int fb\+\_\+choice, int mode)
\begin{DoxyCompactList}\small\item\em calculates the integrated emissivity of the plasma, or the number of recombinations per second of a particular ion within defined frequency bands. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6}{total\+\_\+fb} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int fb\+\_\+choice, int mode)
\begin{DoxyCompactList}\small\item\em returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t between the frequncy limits f1 and f2. The energy lost is just the kinetic energy lost from the plasma because it does not include the ionization potential associated with each recombination. Python tracks effectively the kinetic energy of the plasma (not the potential energy available if everything recombined). \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a1e3f4af5624039f9a4937939331b5219}{one\+\_\+fb} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} one, double f1, double f2)
\begin{DoxyCompactList}\small\item\em generates one free bound photon with specific frequency limits \end{DoxyCompactList}\item 
int \hyperlink{recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f}{num\+\_\+recomb} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double t\+\_\+e, int mode)
\begin{DoxyCompactList}\small\item\em calculates the total number of recombinations for all of the ions in a cell \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a9c153b5e0d982b2debddf4523274d159}{fb} (\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr} \hyperlink{compton_8c_ad65f0d74fe764d3ecae5ec1a89d63f08}{xplasma}, double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double freq, int ion\+\_\+choice, int fb\+\_\+choice)
\begin{DoxyCompactList}\small\item\em calculates either the free\+\_\+bound emissivity at a specific frequency or depending on inputs, the recombination rate \end{DoxyCompactList}\item 
int \hyperlink{recomb_8c_a86d223ebd7563467934af71d1d8e4552}{init\+\_\+freebound} (double t1, double t2, double f1, double f2)
\begin{DoxyCompactList}\small\item\em initializes the structure fb\+\_\+struc as well as some associated arrays and variables (found in \hyperlink{python_8h}{python.\+h}) that describe recombination rates and band-\/limited luminosities. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_aac492018c209163236776675dbf5c7e7}{get\+\_\+nrecomb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, int nion, int mode)
\begin{DoxyCompactList}\small\item\em Return the recombination coefficient. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d}{get\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, int nion, int narray, int fb\+\_\+choice, int mode)
\begin{DoxyCompactList}\small\item\em Interpolate from a set of stored emissivities. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89}{xinteg\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int nion, int fb\+\_\+choice)
\begin{DoxyCompactList}\small\item\em calculates the integrated emissivity of an ion in the plasma. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a250e063dde090c67146f51ea71371bfc}{xinteg\+\_\+inner\+\_\+fb} (double \hyperlink{import__spherical_8c_afc1637b8a38578a1c95ed9f689476775}{t}, double f1, double f2, int nion, int fb\+\_\+choice)
\begin{DoxyCompactList}\small\item\em calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0}{total\+\_\+rrate} (int nion, double T)
\begin{DoxyCompactList}\small\item\em get the total rediative recombination rate \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c}{gs\+\_\+rrate} (int nion, double T)
\begin{DoxyCompactList}\small\item\em get the recombination rate to the ground state for an ion at a particular temperature \end{DoxyCompactList}\item 
int \hyperlink{recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059}{sort\+\_\+and\+\_\+compress} (double $\ast$array\+\_\+in, double $\ast$array\+\_\+out, int npts)
\begin{DoxyCompactList}\small\item\em sort an array into numerical order elimination duplicates \end{DoxyCompactList}\item 
int \hyperlink{recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c}{compare\+\_\+doubles} (const void $\ast$a, const void $\ast$b)
\begin{DoxyCompactList}\small\item\em A routine used by qsort in sort\+\_\+and\+\_\+compress. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{recomb_8c_a117ad9d70df29904483bbfd9806a309a}{nfb} = 0
\item 
struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot} $\ast$ \hyperlink{recomb_8c_a8e952830acfd72d94f766bdc91bbf491}{fb\+\_\+xtop}
\begin{DoxyCompactList}\small\item\em Topbase description of a photoionization x-\/section. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a5a0b6fb88bea4c0aefe51c2450811b13}{fbt}
\begin{DoxyCompactList}\small\item\em Temperature at which thee emissivity is calculated. \end{DoxyCompactList}\item 
int \hyperlink{recomb_8c_ac916b517ddc336331a78e357a6202e51}{fbfr}
\begin{DoxyCompactList}\small\item\em fb\+\_\+choice (see above) \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_ab8c6474c3951256fbf41d3d22d31677a}{fb\+\_\+x} \mbox{[}\hyperlink{python_8h_a8fcad90a1005b8d2b876efbafa401305}{N\+C\+DF}\mbox{]}
\item 
double \hyperlink{recomb_8c_a63d256704fefe06d3279a1c8b0a2f7bd}{fb\+\_\+y} \mbox{[}\hyperlink{python_8h_a8fcad90a1005b8d2b876efbafa401305}{N\+C\+DF}\mbox{]}
\item 
double \hyperlink{recomb_8c_a69f4da9e35aa663669e0d79d99828761}{fb\+\_\+jumps} \mbox{[}\hyperlink{atomic_8h_a9acf4287226016eea5e934e8bd6d624b}{N\+L\+E\+V\+E\+LS}\mbox{]}
\begin{DoxyCompactList}\small\item\em There is at most one jump per level. \end{DoxyCompactList}\item 
double \hyperlink{recomb_8c_a06ea38515f7ca3b10e17fa80d46d8f7d}{xfb\+\_\+jumps} \mbox{[}\hyperlink{atomic_8h_a9acf4287226016eea5e934e8bd6d624b}{N\+L\+E\+V\+E\+LS}\mbox{]}
\begin{DoxyCompactList}\small\item\em This is just a dummy array that parallels fb\+\_\+jumpts. \end{DoxyCompactList}\item 
int \hyperlink{recomb_8c_abb831b6df6893db2eb3ac7730194c060}{fb\+\_\+njumps} = (-\/1)
\item 
\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} \hyperlink{recomb_8c_ac74efea186ec16a1ae177b0bcc988537}{ww\+\_\+fb}
\item 
double \hyperlink{recomb_8c_aaeb0e362d7909391fc024b6b86ee5c79}{one\+\_\+fb\+\_\+f1}
\item 
double \hyperlink{recomb_8c_ac71e7b5af5a9405f96b962586ccbbd53}{one\+\_\+fb\+\_\+f2}
\item 
double \hyperlink{recomb_8c_af02ce05060879ddcac97e53d4a2c2cb4}{one\+\_\+fb\+\_\+te}
\item 
int \hyperlink{recomb_8c_a46df0c72a985a6734d8fb62d2d7774b0}{init\+\_\+freebound\+\_\+nfb}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The routines in this file all have to do with photoionization and/or recombination rates and emissivities. 

\begin{DoxyAuthor}{Author}
ksl,nsh 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018
\end{DoxyDate}
\paragraph*{Notes}

These routines are quite complex representing a lot of work by various of us over a long period of time, and it is not entirely clear that they are quite what we want at present. It would be worthwhile to think about their structure the next time we make consider adding a physical process involving recombination.

Some of the complication associated with these routines arises from run time considerations which may no longer be very relevant today with parallel processing etc. 

\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{recomb_8c_a06ce3976dc892f3d6e3aba0464c3e465}\label{recomb_8c_a06ce3976dc892f3d6e3aba0464c3e465}} 
\index{recomb.\+c@{recomb.\+c}!F\+B\+E\+M\+I\+SS@{F\+B\+E\+M\+I\+SS}}
\index{F\+B\+E\+M\+I\+SS@{F\+B\+E\+M\+I\+SS}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{F\+B\+E\+M\+I\+SS}{FBEMISS}}
{\footnotesize\ttfamily \#define F\+B\+E\+M\+I\+SS~7.\+67413e-\/62}

F\+B\+E\+M\+I\+SS was calculated as follows\+: x= 2. $\ast$ PI $\ast$ M\+E\+L\+EC $\ast$ B\+O\+L\+T\+Z\+M\+A\+NN / (H$\ast$H); x=pow(x,-\/1.\+5); x$\ast$=8. $\ast$ PI / (C$\ast$C); x$\ast$= H; 

Definition at line 50 of file recomb.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c}\label{recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c}} 
\index{recomb.\+c@{recomb.\+c}!compare\+\_\+doubles@{compare\+\_\+doubles}}
\index{compare\+\_\+doubles@{compare\+\_\+doubles}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{compare\+\_\+doubles()}{compare\_doubles()}}
{\footnotesize\ttfamily int compare\+\_\+doubles (\begin{DoxyParamCaption}\item[{const void $\ast$}]{a,  }\item[{const void $\ast$}]{b }\end{DoxyParamCaption})}



A routine used by qsort in sort\+\_\+and\+\_\+compress. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em const} & void $\ast$ a A double precision number \\
\hline
\mbox{\tt in}  & {\em const} & void $\ast$ b A second double precision nubmer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if a is greater than b, 0 otherwise
\end{DoxyReturn}
This routine just compares two double precision numbers and returns 1 if a is greate than b, and 0 otherwise. It is needed by qsort which sorts a double precision array into numberical order.

\paragraph*{Notes}

Definition at line 1759 of file recomb.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{recomb_8c_ab14b7f5dc01c12685f12b0909b19c44c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a9c153b5e0d982b2debddf4523274d159}\label{recomb_8c_a9c153b5e0d982b2debddf4523274d159}} 
\index{recomb.\+c@{recomb.\+c}!fb@{fb}}
\index{fb@{fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fb()}{fb()}}
{\footnotesize\ttfamily double fb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t,  }\item[{double}]{freq,  }\item[{int}]{ion\+\_\+choice,  }\item[{int}]{fb\+\_\+choice }\end{DoxyParamCaption})}



calculates either the free\+\_\+bound emissivity at a specific frequency or depending on inputs, the recombination rate 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Plasma\+Ptr} & xplasma A plasma cell \\
\hline
\mbox{\tt in}  & {\em double} & t The temperature at which to calculate the emisivity \\
\hline
\mbox{\tt in}  & {\em double} & freq The frequency at which to calculate the emissivity \\
\hline
\mbox{\tt in}  & {\em int} & ion\+\_\+choice Either the total or the emissivity for a specific ion \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice determines whether what is returned is the emissivity a specific frecuency 0 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The returns depend on fb\+\_\+choice
\end{DoxyReturn}
If ion\+\_\+choice is a number less than the number of ions then the value returned for that specific ion. However if ion\+\_\+choice is set to the number of ions or greater, the the value returned is for the sum of all the ions.

The choices are\+:
\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombination rate
\end{DoxyItemize}

\paragraph*{Notes}

This routine calls subroutines that have variablew which are are transmitted externally, e.\+g fbt,fbfr, rather than though calls. The reason for this is some of the routines are also used as integrands where only one variable can be transimitted directly.

This routine does not have choices associated with inner shell recombination. 

Definition at line 840 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a9c153b5e0d982b2debddf4523274d159_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{recomb_8c_a9c153b5e0d982b2debddf4523274d159_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6}\label{recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6}} 
\index{recomb.\+c@{recomb.\+c}!fb\+\_\+topbase\+\_\+partial@{fb\+\_\+topbase\+\_\+partial}}
\index{fb\+\_\+topbase\+\_\+partial@{fb\+\_\+topbase\+\_\+partial}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fb\+\_\+topbase\+\_\+partial()}{fb\_topbase\_partial()}}
{\footnotesize\ttfamily double fb\+\_\+topbase\+\_\+partial (\begin{DoxyParamCaption}\item[{double}]{freq }\end{DoxyParamCaption})}



returns the partial (for a specific ion) emissivity or recombination rate for ions described in terms of Topbase photoionization x-\/sections. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & freq The freqeuncy of interest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An emissivity or a recombination rate
\end{DoxyReturn}
What the routine returns depends on the external variable fbfr. The choices are\+:


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

\paragraph*{Notes}

Generally speaiking this routine is integrated over frequency using a NR reciepes routine for that purpsoe. For that reason, much of the information has to be passed externally 

Definition at line 100 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a4afaeaee23214405bf4d30a7d2eb06b6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d}\label{recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d}} 
\index{recomb.\+c@{recomb.\+c}!get\+\_\+fb@{get\+\_\+fb}}
\index{get\+\_\+fb@{get\+\_\+fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+fb()}{get\_fb()}}
{\footnotesize\ttfamily double get\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{int}]{nion,  }\item[{int}]{narray,  }\item[{int}]{fb\+\_\+choice,  }\item[{int}]{mode }\end{DoxyParamCaption})}



Interpolate from a set of stored emissivities. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperure of interest \\
\hline
\mbox{\tt in}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in}  & {\em int} & narray The number of the array calculated for a particular frequency range \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice A switch used only in the case of normal recombination \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch which indicates whether one is interested in normal (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or innershell (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) recombination \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The program generally returns an emissivity or a cooling rate, and the choices are determined by the combination of fb\+\_\+choice and mode
\end{DoxyReturn}
if the mode is set for normal recombiantion, then the possiblities are\+:
\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\end{DoxyItemize}

if the mode is set for inner shell then the cooling rate (effectively F\+B\+\_\+\+F\+U\+LL) is returned.

In an effort to save time, information needed to calculate free-\/bound emissivities and cooling are calculated when a freqency interval is defined, and this routine is used to retrieve these values. The fb structures are populated by init\+\_\+freebound

\paragraph*{Notes}

Definition at line 1184 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_aa7c3eb3f3d0a8eecbbdee02b8988f17d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_aac492018c209163236776675dbf5c7e7}\label{recomb_8c_aac492018c209163236776675dbf5c7e7}} 
\index{recomb.\+c@{recomb.\+c}!get\+\_\+nrecomb@{get\+\_\+nrecomb}}
\index{get\+\_\+nrecomb@{get\+\_\+nrecomb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+nrecomb()}{get\_nrecomb()}}
{\footnotesize\ttfamily double get\+\_\+nrecomb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{int}]{nion,  }\item[{int}]{mode }\end{DoxyParamCaption})}



Return the recombination coefficient. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & t The temperature \\
\hline
\mbox{\tt in,out}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in,out}  & {\em int} & mode A switch to choose normal (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or inner shell (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) recombiantion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The recombination coefficient
\end{DoxyReturn}
Uses data from Badnell or another source to get a recombination rate

\paragraph*{Notes}

Definition at line 1133 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_aac492018c209163236776675dbf5c7e7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_aac492018c209163236776675dbf5c7e7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c}\label{recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c}} 
\index{recomb.\+c@{recomb.\+c}!gs\+\_\+rrate@{gs\+\_\+rrate}}
\index{gs\+\_\+rrate@{gs\+\_\+rrate}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{gs\+\_\+rrate()}{gs\_rrate()}}
{\footnotesize\ttfamily double gs\+\_\+rrate (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{double}]{T }\end{DoxyParamCaption})}



get the recombination rate to the ground state for an ion at a particular temperature 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in}  & {\em double} & T A temperature \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the rate
\end{DoxyReturn}
This routine generates a recombination rate to the ground state for a given ion at a given temperature using data from Badnell or other sources (with similar data formats).

If these recombination rates a are not available for the given ion the Milne relation is used.

\paragraph*{Notes}

nion is the ion that is recombining to a less ionizaed state. There is thus no rate for HI or He I, etc.

The routine is used to produce recombination rate coefficients for the matrix ionization 

Definition at line 1576 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a942292d67abfae3c22d1bbf5ed6fbc3c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a86d223ebd7563467934af71d1d8e4552}\label{recomb_8c_a86d223ebd7563467934af71d1d8e4552}} 
\index{recomb.\+c@{recomb.\+c}!init\+\_\+freebound@{init\+\_\+freebound}}
\index{init\+\_\+freebound@{init\+\_\+freebound}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+freebound()}{init\_freebound()}}
{\footnotesize\ttfamily int init\+\_\+freebound (\begin{DoxyParamCaption}\item[{double}]{t1,  }\item[{double}]{t2,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



initializes the structure fb\+\_\+struc as well as some associated arrays and variables (found in \hyperlink{python_8h}{python.\+h}) that describe recombination rates and band-\/limited luminosities. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t1 A lower limit for the temperature \\
\hline
\mbox{\tt in}  & {\em double} & t2 An upper limit for the temperature \\
\hline
\mbox{\tt in}  & {\em double} & f1 The lower limit for a frequency interval \\
\hline
\mbox{\tt in}  & {\em double} & f2 The upper limit for the frequency interval \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine generally returns 0
\end{DoxyReturn}
Python typically calculates photons in frequency ranges (in order to enable stratified sampling). For this to work, one needs freebound emissivities and cooling rates corresponding to these freqency ranges. Since we retrun to the same frequency ranges every cycle, Python stores the necessary information in structures.

This routine is responsible for populating these structures, so that they can be accessed later via the routine get\+\_\+fb.

\paragraph*{Notes}

The first time the routine is called, both recombination rates and band-\/limited luminosities are calculated. On subsequent calls the routine checks to see whether it has already calculated the band-\/limited freebound emissivities, and if so returns without redoing the calculation. However, if a new frequency interval is provided, the new luminosities are added to the free-\/bound structure. To force a re-\/initialization nfb must be set to 0.

The routine allows for the possibility that there are more frequency intervals than place to store data and will recylce the structure if this occurs (indicating this with several error messages). This allows the program to proceed, but if this happens often then the variable N\+FB in \hyperlink{python_8h}{python.\+h} should be increased. 

Definition at line 977 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a86d223ebd7563467934af71d1d8e4552_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{recomb_8c_a86d223ebd7563467934af71d1d8e4552_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805}\label{recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805}} 
\index{recomb.\+c@{recomb.\+c}!integ\+\_\+fb@{integ\+\_\+fb}}
\index{integ\+\_\+fb@{integ\+\_\+fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{integ\+\_\+fb()}{integ\_fb()}}
{\footnotesize\ttfamily double integ\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nion,  }\item[{int}]{fb\+\_\+choice,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the integrated emissivity of the plasma, or the number of recombinations per second of a particular ion within defined frequency bands. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperature at which the emissivity \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in,out}  & {\em int} & nion The ion for which the emissivity is returned \\
\hline
\mbox{\tt in,out}  & {\em int} & fb\+\_\+choice A switch which determines exactly what is to be returned \\
\hline
\mbox{\tt in,out}  & {\em int} & mode A switch which indicates whether one is interested in normal radiative recombination (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or inner shell recombinaiton (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine returns the specific emissivity, e.\+g. the emissivity and or recombination rate per electron and per ion.
\end{DoxyReturn}
The options are as follows\+:


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

The routine returns the integral of the emissivity (or recombination rate) over the frequency interval. The routine uses pre-\/calculated values if that is possible, or calculate a new values if that is not possible. (In that case xinteg\+\_\+fb updates the set of pre-\/calculated values so that they can be used in a future call.

\paragraph*{Notes}

Definition at line 242 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{recomb_8c_a7ef12badd64f5bb47d6fccbb217ba805_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f}\label{recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f}} 
\index{recomb.\+c@{recomb.\+c}!num\+\_\+recomb@{num\+\_\+recomb}}
\index{num\+\_\+recomb@{num\+\_\+recomb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{num\+\_\+recomb()}{num\_recomb()}}
{\footnotesize\ttfamily int num\+\_\+recomb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_a13ce7664e071685e1c3eaac3c32d7c8d}{Plasma\+Ptr}}]{xplasma,  }\item[{double}]{t\+\_\+e,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the total number of recombinations for all of the ions in a cell 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Plasma\+Ptr} & xplasma The plasma cell of interest \\
\hline
\mbox{\tt in}  & {\em double} & t\+\_\+e The temperarture of interest \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch indicating whether one wants normal radiative recombination (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or dielectronic recombination (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) rates to be calculated. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0; the results are stored in xplasma-\/$>$recomb or xplasma-\/$>$inner\+\_\+recomb, depending on the mode
\end{DoxyReturn}
The routine calculates recombination rates for all the ions in a single cell. It stores the recombination rates in the arrays recomb (for normal recombination) or inner\+\_\+recomb (for dielectronic recombination)

\paragraph*{Notes}

The calculation is made purely direct recombination using the photoionization x-\/sections.

The units are \#/cm$\ast$$\ast$3/s 

Definition at line 738 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=254pt]{recomb_8c_a7c21266df7327fbc81b2c5cf6b5e067f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a1e3f4af5624039f9a4937939331b5219}\label{recomb_8c_a1e3f4af5624039f9a4937939331b5219}} 
\index{recomb.\+c@{recomb.\+c}!one\+\_\+fb@{one\+\_\+fb}}
\index{one\+\_\+fb@{one\+\_\+fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{one\+\_\+fb()}{one\_fb()}}
{\footnotesize\ttfamily double one\+\_\+fb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{f1,  }\item[{double}]{f2 }\end{DoxyParamCaption})}



generates one free bound photon with specific frequency limits 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one The wind cell in which the photon is being \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The frequency limits \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The frequency of the fb photon that was generated.
\end{DoxyReturn}
\begin{DoxyVerb}Although the routine returns only a single photon, it stores more
that one for the same conditions. If the routine is called mulitiple
times from the same cell with the same frequency limits it will use the pre-
stored values.  This was intended to avoid the process of having to
generate cdfs multiple times
\end{DoxyVerb}


\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000049}{Bug}]This routine contains questions from Stuart in May 04 that have never been addressed. Furthemore, the routine has a parameter delta which is used to decide whether one is close enough in temperature to a previously generated D\+CF. This is set to 500, which is probably OK if the temperatures are high, but in appropriate if T is of order 1000 K.\end{DoxyRefDesc}


Definition at line 533 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a1e3f4af5624039f9a4937939331b5219_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a1e3f4af5624039f9a4937939331b5219_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059}\label{recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059}} 
\index{recomb.\+c@{recomb.\+c}!sort\+\_\+and\+\_\+compress@{sort\+\_\+and\+\_\+compress}}
\index{sort\+\_\+and\+\_\+compress@{sort\+\_\+and\+\_\+compress}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{sort\+\_\+and\+\_\+compress()}{sort\_and\_compress()}}
{\footnotesize\ttfamily int sort\+\_\+and\+\_\+compress (\begin{DoxyParamCaption}\item[{double $\ast$}]{array\+\_\+in,  }\item[{double $\ast$}]{array\+\_\+out,  }\item[{int}]{npts }\end{DoxyParamCaption})}



sort an array into numerical order elimination duplicates 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & $\ast$ array\+\_\+in The input array \\
\hline
\mbox{\tt out}  & {\em double} & $\ast$ array\+\_\+out The output array \\
\hline
\mbox{\tt in}  & {\em int} & npts The number of points in the input array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The number of valid element in the output array
\end{DoxyReturn}
The routine uses the G\+SL routine qsort to sort the array in place, and then copies unique elements of the sorted array into the output array.

\paragraph*{Notes}

The routine is used in the creation of cdfs, which need arrays which are sorted into numerical order, and for which one really does not wish duplicated values. 

Definition at line 1703 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=237pt]{recomb_8c_a8012f489c5fe73ae85b4e317f8bb6059_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6}\label{recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6}} 
\index{recomb.\+c@{recomb.\+c}!total\+\_\+fb@{total\+\_\+fb}}
\index{total\+\_\+fb@{total\+\_\+fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{total\+\_\+fb()}{total\_fb()}}
{\footnotesize\ttfamily double total\+\_\+fb (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{one,  }\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{fb\+\_\+choice,  }\item[{int}]{mode }\end{DoxyParamCaption})}



returns the energy lost from the plasma due to fb emission in a single wind cell at a temperature t between the frequncy limits f1 and f2. The energy lost is just the kinetic energy lost from the plasma because it does not include the ionization potential associated with each recombination. Python tracks effectively the kinetic energy of the plasma (not the potential energy available if everything recombined). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Wind\+Ptr} & one The wind cell of interest \\
\hline
\mbox{\tt in}  & {\em double} & t The temperature of the cell \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice A switch controlling whether emissivites or rates are returned \\
\hline
\mbox{\tt in}  & {\em int} & mode A switch denoting whether normal recombination (O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL) or inner shell recombination (I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The routine calculates an emissivity for nommal recombination or a cooling rate for normal or dielectronic recombination
\end{DoxyReturn}
If O\+U\+T\+E\+R\+\_\+\+S\+H\+E\+LL is chosen then the options are


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\end{DoxyItemize}

If I\+N\+N\+E\+R\+\_\+\+S\+H\+E\+LL is chosen the recombination rate is returned.

\paragraph*{Notes}

The results in this routine are all based on the Milne relation

The routine is unusual in that one passes a the wind cell and not the plasma cell. This probably should be changed.

Note that F\+B\+\_\+\+R\+E\+D\+U\+C\+ED is not an option for this routine

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000048}{Bug}]What is preventing us from calculating a dielectronic emission rate?\end{DoxyRefDesc}


Definition at line 428 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a9d0d69b33092d06a7174d71c3082d2a6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0}\label{recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0}} 
\index{recomb.\+c@{recomb.\+c}!total\+\_\+rrate@{total\+\_\+rrate}}
\index{total\+\_\+rrate@{total\+\_\+rrate}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{total\+\_\+rrate()}{total\_rrate()}}
{\footnotesize\ttfamily double total\+\_\+rrate (\begin{DoxyParamCaption}\item[{int}]{nion,  }\item[{double}]{T }\end{DoxyParamCaption})}



get the total rediative recombination rate 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & nion The ion number of interest \\
\hline
\mbox{\tt in}  & {\em double} & T The temperature for which the rate is calculated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The total recombination rate for this ion for this temperature
\end{DoxyReturn}
Generates a total recombination rate for a given ion at a given temperature using data, obtained from sources such as Badnell or Shull.

If these are not present, an error is generated, and a value using the Milne relation is returned.

\paragraph*{Notes}

Recombination rates can be calculated from the Milne relation but in most cases this does not give one the most accurate recombination rate because one does not have all of the relevant levels. 

Definition at line 1479 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_ab1050097e6dcebb3469479d4fd5ff6c0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89}\label{recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89}} 
\index{recomb.\+c@{recomb.\+c}!xinteg\+\_\+fb@{xinteg\+\_\+fb}}
\index{xinteg\+\_\+fb@{xinteg\+\_\+fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{xinteg\+\_\+fb()}{xinteg\_fb()}}
{\footnotesize\ttfamily double xinteg\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nion,  }\item[{int}]{fb\+\_\+choice }\end{DoxyParamCaption})}



calculates the integrated emissivity of an ion in the plasma. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & t The temperature of interest \\
\hline
\mbox{\tt in,out}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in,out}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in,out}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in,out}  & {\em int} & fb\+\_\+choice A switch which determined exactly what is returned \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The integrated emissivity, depending on the fb\+\_\+choice. The possibilites are
\end{DoxyReturn}

\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

The routine preforms a numberical integration over the partial emissivities

\paragraph*{Notes}

This routine is called by integ\+\_\+fb. It is not intended to be called directly, which uses a Numerical Recipes routine to integrate over frequncy. 

Definition at line 1249 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_abbfb58b40faa368dabec2eb9f4b51c89_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{recomb_8c_a250e063dde090c67146f51ea71371bfc}\label{recomb_8c_a250e063dde090c67146f51ea71371bfc}} 
\index{recomb.\+c@{recomb.\+c}!xinteg\+\_\+inner\+\_\+fb@{xinteg\+\_\+inner\+\_\+fb}}
\index{xinteg\+\_\+inner\+\_\+fb@{xinteg\+\_\+inner\+\_\+fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{xinteg\+\_\+inner\+\_\+fb()}{xinteg\_inner\_fb()}}
{\footnotesize\ttfamily double xinteg\+\_\+inner\+\_\+fb (\begin{DoxyParamCaption}\item[{double}]{t,  }\item[{double}]{f1,  }\item[{double}]{f2,  }\item[{int}]{nion,  }\item[{int}]{fb\+\_\+choice }\end{DoxyParamCaption})}



calculates the integrated fb emissivity of inner shell transitions in an ion at a given temperature 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & t The temperarure of interest \\
\hline
\mbox{\tt in}  & {\em double} & f1 The minimum frequency \\
\hline
\mbox{\tt in}  & {\em double} & f2 The maximum frequency \\
\hline
\mbox{\tt in}  & {\em int} & nion The ion of interest \\
\hline
\mbox{\tt in}  & {\em int} & fb\+\_\+choice ??? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Exactly what the the routine returns is determined by fb\+\_\+choice, which is passed as an an external variable to fb\+\_\+topbase\+\_\+partial
\end{DoxyReturn}
The possibilites are


\begin{DoxyItemize}
\item F\+B\+\_\+\+F\+U\+LL Calculate fb emissivity including energy associated with the threshold
\item F\+B\+\_\+\+R\+E\+D\+U\+C\+ED Calculate the fb emissivity without the threshold energy
\item F\+B\+\_\+\+R\+A\+TE Calulate the fb recombinarion rate
\end{DoxyItemize}

\paragraph*{Notes}

This routine is virtual copy of xinteg\+\_\+fb but considers only inner shells . The integration that is requied to integrate over frequencies is carried out using the Numerical Recipes routine qromb. This is why a number of variables are passed as external variables, include fb\+\_\+choice, fmin and fmax. 

Definition at line 1375 of file recomb.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a250e063dde090c67146f51ea71371bfc_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{recomb_8c_a250e063dde090c67146f51ea71371bfc_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{recomb_8c_a69f4da9e35aa663669e0d79d99828761}\label{recomb_8c_a69f4da9e35aa663669e0d79d99828761}} 
\index{recomb.\+c@{recomb.\+c}!fb\+\_\+jumps@{fb\+\_\+jumps}}
\index{fb\+\_\+jumps@{fb\+\_\+jumps}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fb\+\_\+jumps}{fb\_jumps}}
{\footnotesize\ttfamily double fb\+\_\+jumps\mbox{[}\hyperlink{atomic_8h_a9acf4287226016eea5e934e8bd6d624b}{N\+L\+E\+V\+E\+LS}\mbox{]}}



There is at most one jump per level. 



Definition at line 495 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_abb831b6df6893db2eb3ac7730194c060}\label{recomb_8c_abb831b6df6893db2eb3ac7730194c060}} 
\index{recomb.\+c@{recomb.\+c}!fb\+\_\+njumps@{fb\+\_\+njumps}}
\index{fb\+\_\+njumps@{fb\+\_\+njumps}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fb\+\_\+njumps}{fb\_njumps}}
{\footnotesize\ttfamily int fb\+\_\+njumps = (-\/1)}



Definition at line 498 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_ab8c6474c3951256fbf41d3d22d31677a}\label{recomb_8c_ab8c6474c3951256fbf41d3d22d31677a}} 
\index{recomb.\+c@{recomb.\+c}!fb\+\_\+x@{fb\+\_\+x}}
\index{fb\+\_\+x@{fb\+\_\+x}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fb\+\_\+x}{fb\_x}}
{\footnotesize\ttfamily double fb\+\_\+x\mbox{[}\hyperlink{python_8h_a8fcad90a1005b8d2b876efbafa401305}{N\+C\+DF}\mbox{]}}



Definition at line 493 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_a8e952830acfd72d94f766bdc91bbf491}\label{recomb_8c_a8e952830acfd72d94f766bdc91bbf491}} 
\index{recomb.\+c@{recomb.\+c}!fb\+\_\+xtop@{fb\+\_\+xtop}}
\index{fb\+\_\+xtop@{fb\+\_\+xtop}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fb\+\_\+xtop}{fb\_xtop}}
{\footnotesize\ttfamily struct \hyperlink{structtopbase__phot}{topbase\+\_\+phot}$\ast$ fb\+\_\+xtop}



Topbase description of a photoionization x-\/section. 



Definition at line 58 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_a63d256704fefe06d3279a1c8b0a2f7bd}\label{recomb_8c_a63d256704fefe06d3279a1c8b0a2f7bd}} 
\index{recomb.\+c@{recomb.\+c}!fb\+\_\+y@{fb\+\_\+y}}
\index{fb\+\_\+y@{fb\+\_\+y}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fb\+\_\+y}{fb\_y}}
{\footnotesize\ttfamily double fb\+\_\+y\mbox{[}\hyperlink{python_8h_a8fcad90a1005b8d2b876efbafa401305}{N\+C\+DF}\mbox{]}}



Definition at line 493 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_ac916b517ddc336331a78e357a6202e51}\label{recomb_8c_ac916b517ddc336331a78e357a6202e51}} 
\index{recomb.\+c@{recomb.\+c}!fbfr@{fbfr}}
\index{fbfr@{fbfr}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fbfr}{fbfr}}
{\footnotesize\ttfamily int fbfr}



fb\+\_\+choice (see above) 



Definition at line 64 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_a5a0b6fb88bea4c0aefe51c2450811b13}\label{recomb_8c_a5a0b6fb88bea4c0aefe51c2450811b13}} 
\index{recomb.\+c@{recomb.\+c}!fbt@{fbt}}
\index{fbt@{fbt}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{fbt}{fbt}}
{\footnotesize\ttfamily double fbt}



Temperature at which thee emissivity is calculated. 



Definition at line 61 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_a46df0c72a985a6734d8fb62d2d7774b0}\label{recomb_8c_a46df0c72a985a6734d8fb62d2d7774b0}} 
\index{recomb.\+c@{recomb.\+c}!init\+\_\+freebound\+\_\+nfb@{init\+\_\+freebound\+\_\+nfb}}
\index{init\+\_\+freebound\+\_\+nfb@{init\+\_\+freebound\+\_\+nfb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+freebound\+\_\+nfb}{init\_freebound\_nfb}}
{\footnotesize\ttfamily int init\+\_\+freebound\+\_\+nfb}

Indicates the total number of freebound sets that could be used 

Definition at line 931 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_a117ad9d70df29904483bbfd9806a309a}\label{recomb_8c_a117ad9d70df29904483bbfd9806a309a}} 
\index{recomb.\+c@{recomb.\+c}!nfb@{nfb}}
\index{nfb@{nfb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{nfb}{nfb}}
{\footnotesize\ttfamily int nfb = 0}

Next line is required for proper initialization Actual number of freqency intervals calculated 

Definition at line 42 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_aaeb0e362d7909391fc024b6b86ee5c79}\label{recomb_8c_aaeb0e362d7909391fc024b6b86ee5c79}} 
\index{recomb.\+c@{recomb.\+c}!one\+\_\+fb\+\_\+f1@{one\+\_\+fb\+\_\+f1}}
\index{one\+\_\+fb\+\_\+f1@{one\+\_\+fb\+\_\+f1}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{one\+\_\+fb\+\_\+f1}{one\_fb\_f1}}
{\footnotesize\ttfamily double one\+\_\+fb\+\_\+f1}



Definition at line 501 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_ac71e7b5af5a9405f96b962586ccbbd53}\label{recomb_8c_ac71e7b5af5a9405f96b962586ccbbd53}} 
\index{recomb.\+c@{recomb.\+c}!one\+\_\+fb\+\_\+f2@{one\+\_\+fb\+\_\+f2}}
\index{one\+\_\+fb\+\_\+f2@{one\+\_\+fb\+\_\+f2}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{one\+\_\+fb\+\_\+f2}{one\_fb\_f2}}
{\footnotesize\ttfamily double one\+\_\+fb\+\_\+f2}



Definition at line 501 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_af02ce05060879ddcac97e53d4a2c2cb4}\label{recomb_8c_af02ce05060879ddcac97e53d4a2c2cb4}} 
\index{recomb.\+c@{recomb.\+c}!one\+\_\+fb\+\_\+te@{one\+\_\+fb\+\_\+te}}
\index{one\+\_\+fb\+\_\+te@{one\+\_\+fb\+\_\+te}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{one\+\_\+fb\+\_\+te}{one\_fb\_te}}
{\footnotesize\ttfamily double one\+\_\+fb\+\_\+te}



Definition at line 501 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_ac74efea186ec16a1ae177b0bcc988537}\label{recomb_8c_ac74efea186ec16a1ae177b0bcc988537}} 
\index{recomb.\+c@{recomb.\+c}!ww\+\_\+fb@{ww\+\_\+fb}}
\index{ww\+\_\+fb@{ww\+\_\+fb}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{ww\+\_\+fb}{ww\_fb}}
{\footnotesize\ttfamily \hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} ww\+\_\+fb}



Definition at line 500 of file recomb.\+c.

\mbox{\Hypertarget{recomb_8c_a06ea38515f7ca3b10e17fa80d46d8f7d}\label{recomb_8c_a06ea38515f7ca3b10e17fa80d46d8f7d}} 
\index{recomb.\+c@{recomb.\+c}!xfb\+\_\+jumps@{xfb\+\_\+jumps}}
\index{xfb\+\_\+jumps@{xfb\+\_\+jumps}!recomb.\+c@{recomb.\+c}}
\subsubsection{\texorpdfstring{xfb\+\_\+jumps}{xfb\_jumps}}
{\footnotesize\ttfamily double xfb\+\_\+jumps\mbox{[}\hyperlink{atomic_8h_a9acf4287226016eea5e934e8bd6d624b}{N\+L\+E\+V\+E\+LS}\mbox{]}}



This is just a dummy array that parallels fb\+\_\+jumpts. 



Definition at line 497 of file recomb.\+c.

