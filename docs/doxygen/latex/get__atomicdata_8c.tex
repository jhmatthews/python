\hypertarget{get__atomicdata_8c}{}\section{/\+Users/mhewitt/python/source/get\+\_\+atomicdata.c File Reference}
\label{get__atomicdata_8c}\index{/\+Users/mhewitt/python/source/get\+\_\+atomicdata.\+c@{/\+Users/mhewitt/python/source/get\+\_\+atomicdata.\+c}}


Read in all of the atomic data for use with Python.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}log.\+h\char`\"{}}\newline
Include dependency graph for get\+\_\+atomicdata.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{get__atomicdata_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{get__atomicdata_8c_a10e8c7b8458375c3dbfbb4010a2aba8c}{L\+I\+N\+E\+L\+E\+N\+G\+TH}~400
\item 
\#define \hyperlink{get__atomicdata_8c_aa6b319146daf33409da1bbe4194553dc}{M\+A\+X\+W\+O\+R\+DS}~20
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7}{get\+\_\+atomic\+\_\+data} (masterfile)
\begin{DoxyCompactList}\small\item\em generalized subroutine for reading atomic data into a set of structures defined in \char`\"{}atomic.\+h\char`\"{} \end{DoxyCompactList}\item 
int \hyperlink{get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544}{index\+\_\+lines} ()
\begin{DoxyCompactList}\small\item\em sort the lines into frequency order \end{DoxyCompactList}\item 
int \hyperlink{get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6}{index\+\_\+phot\+\_\+top} ()
\begin{DoxyCompactList}\small\item\em Index the topbase photoionzation crossections by frequency. \end{DoxyCompactList}\item 
int \hyperlink{get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40}{index\+\_\+inner\+\_\+cross} ()
\begin{DoxyCompactList}\small\item\em Index inner shell xsections in frequency order. \end{DoxyCompactList}\item 
int \hyperlink{get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253}{index\+\_\+collisions} ()
\begin{DoxyCompactList}\small\item\em sorts the collisional lines into frequency order \end{DoxyCompactList}\item 
void \hyperlink{get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269}{indexx} (int n, arrin, indx)
\begin{DoxyCompactList}\small\item\em Numerical recipes routine used by various routines to sort the atomic data. \end{DoxyCompactList}\item 
int \hyperlink{get__atomicdata_8c_a8cf338374390539709c962c60a953c3d}{limit\+\_\+lines} (double freqmin, double freqmax)
\begin{DoxyCompactList}\small\item\em (freqmin,freqmax) sets the the current values of line\+\_\+min and line\+\_\+max in \hyperlink{atomic_8h}{atomic.\+h} which can be used to limit the lines searched for resonances to a specific frequency range. \end{DoxyCompactList}\item 
int \hyperlink{get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb}{check\+\_\+xsections} ()
\begin{DoxyCompactList}\small\item\em Perform sanity checks on xsection data. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Read in all of the atomic data for use with Python. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
March, 2018 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{get__atomicdata_8c_a10e8c7b8458375c3dbfbb4010a2aba8c}\label{get__atomicdata_8c_a10e8c7b8458375c3dbfbb4010a2aba8c}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!L\+I\+N\+E\+L\+E\+N\+G\+TH@{L\+I\+N\+E\+L\+E\+N\+G\+TH}}
\index{L\+I\+N\+E\+L\+E\+N\+G\+TH@{L\+I\+N\+E\+L\+E\+N\+G\+TH}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{L\+I\+N\+E\+L\+E\+N\+G\+TH}{LINELENGTH}}
{\footnotesize\ttfamily \#define L\+I\+N\+E\+L\+E\+N\+G\+TH~400}



Definition at line 159 of file get\+\_\+atomicdata.\+c.

\mbox{\Hypertarget{get__atomicdata_8c_aa6b319146daf33409da1bbe4194553dc}\label{get__atomicdata_8c_aa6b319146daf33409da1bbe4194553dc}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!M\+A\+X\+W\+O\+R\+DS@{M\+A\+X\+W\+O\+R\+DS}}
\index{M\+A\+X\+W\+O\+R\+DS@{M\+A\+X\+W\+O\+R\+DS}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{M\+A\+X\+W\+O\+R\+DS}{MAXWORDS}}
{\footnotesize\ttfamily \#define M\+A\+X\+W\+O\+R\+DS~20}



Definition at line 160 of file get\+\_\+atomicdata.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb}\label{get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!check\+\_\+xsections@{check\+\_\+xsections}}
\index{check\+\_\+xsections@{check\+\_\+xsections}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{check\+\_\+xsections()}{check\_xsections()}}
{\footnotesize\ttfamily int check\+\_\+xsections (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Perform sanity checks on xsection data. 

\begin{DoxyReturn}{Returns}
Alway returns 0; errors are written to the log file
\end{DoxyReturn}
Results are written to the log file

\paragraph*{Notes}

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000030}{Bug}]A careful look at this routine is warranted as get\+\_\+atomic\+\_\+data has changed over the years.\end{DoxyRefDesc}


Definition at line 3779 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{get__atomicdata_8c_a7bf9a7561e34466897cf3261381d56eb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7}\label{get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!get\+\_\+atomic\+\_\+data@{get\+\_\+atomic\+\_\+data}}
\index{get\+\_\+atomic\+\_\+data@{get\+\_\+atomic\+\_\+data}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{get\+\_\+atomic\+\_\+data()}{get\_atomic\_data()}}
{\footnotesize\ttfamily int get\+\_\+atomic\+\_\+data (\begin{DoxyParamCaption}\item[{masterfile}]{ }\end{DoxyParamCaption})}



generalized subroutine for reading atomic data into a set of structures defined in \char`\"{}atomic.\+h\char`\"{} 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & masterfile\mbox{[}\mbox{]} The name of the \char`\"{}masterfile\char`\"{} which refers to other files which contain the data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
get\+\_\+atomic\+\_\+data reads in all the atomic data. It also converts the data to cgs units unless otherwise noted, e.\+g ionization potentials are converted to ergs.

The masterfile is a list of other files, which contain atomic data for specific puruposes.

All of the files are ascii. The information is keyword based.

The order of the data is important. Elements should be defined before ions; ions before levels, levels before lines etc. In most if not all cases, one can either define all of the elements first, all of the ions, etc ... or the first element and its ions, the second element and its ions etc. Commenting out an element in the datafile has the effect of eliminating all of the data associated with that element, e.\+g ions, lines, etc.

The program assumes that the ions for a given element are grouped together, that the levels for a given element are grouped together, etc.

If one wants to read both Topbase and V\+F\+KY photoionization x-\/sections, then the topbase x-\/sections should be read first. The routine will ignore data in the V\+F\+KY list if there is a pre-\/existing Topbase data. The routine will stop if you but a V\+F\+KY x-\/section first on the assumption that Topbase data should trump V\+F\+KY data. (Making the program more flexible would be difficult because you would have to drop various bits of Topbase data out of the middle of the structure or mark it NG or something.)

Similarly, as a general rule the macro information should be provided before the simple ions are described, and the macro lines should be presented before simple lines.

The only data which can be mixed up completely is the line array.

Finally, get\+\_\+atomic\+\_\+data creates a pointer array to lines, which has the lines in frequency ascending order. This is actually done by a small subroutine index\+\_\+lines which in turn calls a Numerical Recipes routine.

\paragraph*{Notes}

get\+\_\+atomic data is intended to be stand-\/alone, that is one should be able to use it for routines other than Python, e.\+g for another routine intended to calculate the ionization state of a plasma in colissional equlibrium

To this end, the routines populate stuctures in \hyperlink{atomic_8h}{atomic.\+h}, which are not part of \hyperlink{python_8h}{python.\+h}. It\textquotesingle{}s imporant that future modificatiosn to get\+\_\+atomic\+\_\+data maintain this indepence.. \hypertarget{get_atomicdata.c_Elements}{}\subsection{Elements}\label{get_atomicdata.c_Elements}
A typical element has the following format

Element 6 C 8.\+56

where 6 here refers to z of the elemnt, C is the name, and 8.\+56 is the abundance relative to H at 12\hypertarget{get_atomicdata.c_Ions}{}\subsection{Ions}\label{get_atomicdata.c_Ions}
Ions are specified with the keyword Ion. A typical entry for ions looks like

\begin{DoxyVerb}*  IonV    C   6   4   2   64.49400 1000   10     1s^22s(2S_{1/2})
*  \end{DoxyVerb}


where C is the elment name, 6 is the elemnt z, 4 is the ionization state (in conventional astrophysics notation, 2 is the mulitplicity of the ground state, and 1000 and 10 refer to maximum number of allowed L\+TE and n\+L\+TE configurations. The configuration is not actually required and is for information only.

Note that keyword parsing is done only on the first 3 letters, so Ion and IonV are equivlalent

The routine still supports an earlier format which comisists of the first 6 \char`\"{}words\char`\"{} in which case default values are assigned to for the maximum number of L\+T\+E/simple and n\+L\+T\+E/macro atom configurations.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000026}{Bug}]Exactly what is meant by L\+TE here needs clarification.\end{DoxyRefDesc}
\hypertarget{get_atomicdata.c_levels}{}\subsection{Levels or Configurations}\label{get_atomicdata.c_levels}
This version of get\+\_\+atomicdata can read various types of configuration inputs, some of which should gradually be exsized from the program. Originally, the idea was that Levels would immediately follow an ion, and in that case all that was need to describe a level, was a level number, a multiplicity, and an energy for the level. An example of this type of line follows\+:

\begin{DoxyVerb}*  Ion  He  2   1   1   24.587  6 2
*  Level 1 1 0.0
*  Level 2 3 19.819
*  \end{DoxyVerb}


It is a requirement that when an O\+L\+D\+S\+T\+Y\+LE line is used, it must immediately follow the ion.

The second type of L\+E\+V\+EL style was developed solely to allow the levels to be disjoint from the ions. Disjoint in this case implies that the level must follow the ion, but it does not have to be immediately after the ion line.

It was developed to allow one to use levels developed from the Kurucz line list, and the new Verner level file.

A typical K\+U\+R\+U\+C\+Z\+S\+T\+Y\+LE record would look like\+:

\begin{DoxyVerb}*  Comment-- Ion H  1
*  \# There are 17 unique levels for 1 1
*  Level   1   1   0    2   0.000000
*  Level   1   1   1    2  10.200121
*  Level   1   1   2    4  10.200166
*  Level   1   1   3    2  12.089051
*  \end{DoxyVerb}
 where the colums are z, istate (in conventianal notation), a unique level no, the multiplicity of the level and the exitation energy of the level in eV

The new Topbase style records (created by py\+\_\+parse\+\_\+levels) look like this\+:

\begin{DoxyVerb}*  ======================================================================================
*  #      i NZ NE iSLP iLV iCONF                 E(RYD)      TE(RYD)   gi     EQN    RL(NS)
*  # ======================================================================================
*  # ======================================================================================
*  LevTop  1  1  200  1 -13.605698   0.000000  2  1.0000 1.00e+21 () 1s
*  LevTop  1  1  200  2  -3.401425  10.204273  2  2.0000 1.00e+21 () 2s
*  LevTop  1  1  211  1  -3.401425  10.204273  6  2.0000 1.60e-09 () 2p
*  LevTop  1  1  220  1  -1.511743  12.093955 10  3.0000 1.55e-08 () 3d
*  LevTop  1  1  200  3  -1.511743  12.093955  2  3.0000 1.59e-07 () 3s
*  LevTop  1  1  211  2  -1.511743  12.093955  6  3.0000 5.28e-09 () 3p
*  LevTop  2  1  100  1 -24.310389   0.000000  1  0.7481 1.00e+21 1s2
*  LevTop  2  1  300  1  -4.766334  19.544041  3  1.6895 1.00e+21 1s 2s
*  LevTop  2  1  100  2  -3.941516  20.368818  1  1.8579 1.00e+21 1s 2s
*  \end{DoxyVerb}


The details are\+:

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Name }&\textbf{ Description  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Name }&\textbf{ Description  }\\\cline{1-3}
\endhead
2 &NZ &the atomic number of the level \\\cline{1-3}
3 &NE &the ionization state according to the usual astronomical convention. \\\cline{1-3}
&&Note that Topbase uses the number of electrons but this is fixed in my reformatting program. \\\cline{1-3}
4 &i\+S\+LP &A coded version of the angular momentum \\\cline{1-3}
5 &i\+LV &The level number (starts with 1) \\\cline{1-3}
6 &\hyperlink{atomic_8h_a07484107e6d9fdf38b53edf631d6511d}{E(\+Ryd)} &The energy in eV relative to the continuum \\\cline{1-3}
7 &T\+E(\+Ryd) &The energy in ev realative to the ground state \\\cline{1-3}
8 &gi &The multiplicity \\\cline{1-3}
9 &eqn &The equivalent quantum number (Not necessarily an integer) \\\cline{1-3}
10 &rl &The radiative lifetime \\\cline{1-3}
11 &config &A string showing the configuration \\\cline{1-3}
\end{longtabu}
\hypertarget{get_atomicdata.c_matoms}{}\subsubsection{Macro Atoms (\+S\+S)}\label{get_atomicdata.c_matoms}
When the macro atom method is to be used the level data should look like\+: e.\+g.

\begin{DoxyVerb}*  #         z ion lvl ion_pot   ex_energy  g  rad_rate
*  LevMacro  1  1  1 -13.605698   0.000000  2  1.00e+21 () n=1
*  LevMacro  1  1  2  -3.401425  10.204273  8  1.60e-09 () n=2
*  LevMacro  1  1  3  -1.511743  12.093955 18  1.00e-08 () n=3
*  LevMacro  1  1  4  -0.850356  12.755342 32  1.00e-08 () n=4
*  LevMacro  1  2  1   0.000000  13.605698  1  1.00e+21 () cnt
*  \end{DoxyVerb}


The details are\+:

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Name }&\textbf{ Description  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Name }&\textbf{ Description  }\\\cline{1-3}
\endhead
2 &z &Atomic number \\\cline{1-3}
3 &ion &Ionisation state (usual astronomical convention\+: neutral=1) \\\cline{1-3}
4 &lvl &An index for the level\+: this index must be assigned consistently in all the macro input files \\\cline{1-3}
&&(i.\+e. also in photoionisation data). Each level index in a particular ion must be unique. \\\cline{1-3}
5 &ion\+\_\+pot &Ionisation potential (electron volts) \\\cline{1-3}
6 &ex\+\_\+energy &Excitation energy (electron volts). A consistent definition of energy=0 must be used for all ions of the same element\+: \\\cline{1-3}
&&ground state energy for the neutral species = 0. \\\cline{1-3}
7 &g &Statistical weight \\\cline{1-3}
8 &rad\+\_\+rate &Radiative lifetime \\\cline{1-3}
9 &&A string giving a name for the level (not used by code) \\\cline{1-3}
\end{longtabu}
\hypertarget{get_atomicdata.c_Photoionization}{}\subsection{Photoionization}\label{get_atomicdata.c_Photoionization}
Until at least Oct 2001, Python used photoionization crossections from Verner, Ferland, Korista, and Yakolev (D\+F\+KY) The routine sigma\+\_\+phot(xptr, freq) calculates the crossection based on this.

The original topbase records look like this

\begin{DoxyVerb}*  ================================================
*        I  NZ  NE  ISLP  ILV        E(RYD)      NP
*  ================================================
*        1   2   1   200    1  -4.00000E+00     101
*   3.960000E+00 1.619E+00
*   4.000000E+00 1.576E+00
*   4.101260E+00 1.474E+00
*   4.205084E+00 1.379E+00
*   4.311536E+00 1.289E+00
*   4.420684E+00 1.206E+00
* \end{DoxyVerb}


They are converted to something that is more compatible with Topbase by py\+\_\+top\+\_\+phot

The new topbase style records look like this.

\begin{DoxyVerb}* PhotTopS  2  1 200    1    54.422791 101
* PhotTop    54.422791 1.576e-18
* PhotTop    66.508772 9.197e-19
* PhotTop    78.594753 5.817e-19
* PhotTop    90.680734 3.906e-19
* PhotTop   102.766715 2.746e-19
* PhotTop   114.852696 2.001e-19
* PhotTop   126.938677 1.502e-19
* PhotTop   139.024658 1.155e-19
* PhotTop   151.110639 9.057e-20
* \end{DoxyVerb}


The main changes from the original records are that energy levels have been converted to eV, cross sections to cm$\ast$$\ast$2, and the electron number has been converted to conventional astronomical notiation for the ionstate.

\paragraph*{Macro atoms (SS)}

For the Macro Atom method the input photoionisation data should look like (one entry for every photoionisation process)\+:

\begin{DoxyVerb}* z  ion ll ul   threshold  npts
* PhotMacS  1  1  1  1    13.605698  50
* PhotMac    13.605698 6.304e-18
* PhotMac    16.627193 3.679e-18
* PhotMac    19.648688 2.327e-18
* PhotMac    22.670183 1.563e-18
* PhotMac    25.691679 1.098e-18
* PhotMac    28.713174 8.004e-19
* PhotMac    31.734669 6.006e-19
* PhotMac    34.756165 4.618e-19
* \end{DoxyVerb}


Details for the first row of each entry\+: \tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Name }&\textbf{ Description  }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Name }&\textbf{ Description  }\\\cline{1-3}
\endhead
2 &z &Atomic number \\\cline{1-3}
3 &ion &Ionisation stage (astronomical convention)\+: L\+O\+W\+ER I\+ON (i.\+e. the one that G\+E\+TS I\+O\+N\+I\+S\+ED) \\\cline{1-3}
&&it is always assumed that the upper stage is this+1! \\\cline{1-3}
4 &ll &index for the level in the L\+O\+W\+ER I\+ON (must match the index given to the level in input level data) \\\cline{1-3}
5 &ul &index for the level in the U\+P\+P\+ER I\+ON (must match the index given to the level in the input level data) \\\cline{1-3}
6 &thresh&threshold energy of edge (in eV) \\\cline{1-3}
7 &npts &number of data points in the following table \\\cline{1-3}
\end{longtabu}

\begin{DoxyItemize}
\item Then follows the table of energy and cross-\/section values (same as Top\+Base above)
\item 04dec ksl Modified this section so that \char`\"{}unknown\char`\"{} level information is skipped so that one need modify only the higher level elements\+\_\+ions file
\end{DoxyItemize}\hypertarget{get_atomicdata.c_Auger}{}\subsection{Auger}\label{get_atomicdata.c_Auger}
\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000027}{Bug}]Needs description -\/ this is a type of data that is no longer used \end{DoxyRefDesc}
\hypertarget{get_atomicdata.c_Lines}{}\subsection{Lines}\label{get_atomicdata.c_Lines}
here are various types of line files which get\+\_\+atomicdata must parse This is the original format

\begin{DoxyVerb}* Line 1 1 1215.673584 0.139000  2  2
* Line 1 1 1215.668213 0.277000  2  4
* \end{DoxyVerb}


This is the first format developed for including excited state lines. It adds the energy of the lower and upper level

\begin{DoxyVerb}* Line  6  3 1174.933000    0.115845   3   5    6.496462   17.050273
* Line  6  3 1175.263000    0.282488   1   3    6.493525   17.044369
* Line  6  3 1175.590000    0.069804   3   3    6.496462   17.044369
* \end{DoxyVerb}


Finally there is a new format developed to link lines to configurations.

\begin{DoxyVerb}* Line  1  1 1215.673584  0.139000   2   2     0.000000    10.200121    0    1
* Line  1  1 1215.668213  0.277000   2   4     0.000000    10.200166    0    2
* \end{DoxyVerb}


\paragraph*{Macro Atoms (SS)}

For the macro atom method the lines are input in the following format\+:

\begin{DoxyVerb}* # z = element, ion= ionstage, f = osc. str., gl(gu) = stat. we. lower(upper) level
* # el(eu) = energy lower(upper) level (eV), ll(lu) = lvl index lower(upper) level
* #          z ion lambda      f         gl  gu    el          eu          ll   lu
* LinMacro  1  1 1215.671021  0.416200   2   8     0.000000    10.200143    1    2
* LinMacro  1  1 1025.722046  0.079100   2  18     0.000000    12.089062    1    3
* LinMacro  1  1  972.540000  0.028990   2  32     0.000000    12.755342    1    4
* LinMacro  1  1 6562.800000  0.640700   8  18    10.200143    12.089062    2    3
* LinMacro  1  1 4861.320000  0.119300   8  32    10.200143    12.755342    2    4
* LinMacro  1  1 18751.00000  0.842100  18  32    12.089062    12.755342    3    4
* \end{DoxyVerb}


Details\+:

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Description  }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ Col }&\textbf{ Description  }\\\cline{1-2}
\endhead
2 &Atomic Number \\\cline{1-2}
3 &Ionisation stage (astronomical convention) \\\cline{1-2}
4 &Wavelength of transition (AA) \\\cline{1-2}
5 &oscillator strength \\\cline{1-2}
6 &stat. weight for lower level of transition \\\cline{1-2}
7 &stat. weight for upper level of transition \\\cline{1-2}
8 &energy of lower level of transition (eV) \\\cline{1-2}
9 &energy of upper level of transition (eV) \\\cline{1-2}
10 &index for lower level of transition (M\+U\+ST match the index assigned to this level in level data \\\cline{1-2}
11 &index for upper level of transition (M\+U\+ST match the index assigned to this level in level data \\\cline{1-2}
\end{longtabu}
04dec ksl -- I have modified the next section to try to conform to the \char`\"{}philosophy\char`\"{} of get\+\_\+atomic\+\_\+data which is that one does not need to modify the more detailed files, e.\+g the Lin\+Macro file, if one has eliminated a particular level in the elements ion file. Basically this was accomplished by checking both the upper and lower level and breaking out if either was not accounted for.\hypertarget{get_atomicdata.c_Ground}{}\subsection{state fractions}\label{get_atomicdata.c_Ground}
\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000028}{Bug}]This needs a description -\/ it is very old -\/ CK\textquotesingle{}s ground state recombination tables used to compute the zeta term. \end{DoxyRefDesc}
\hypertarget{get_atomicdata.c_Collision}{}\subsection{strengths}\label{get_atomicdata.c_Collision}
@ bug This needs a description\hypertarget{get_atomicdata.c_Dielectronic}{}\subsection{Recombination -\/ type 1}\label{get_atomicdata.c_Dielectronic}
This section reads in dielectronic recombination rates. The data comes from Chianti, and there are two types of dielectronic data. This is type 1 -\/ which has fis decribed by Arnaud \& Raymond (1992) There are two fitting parameters, E and C which represent different degrees in the fit -\/ one sums over a set of parameters.

A typical ion data would look like this

\begin{DoxyVerb}* DR_BADNL E 2 2 4.5560e+05 5.5520e+05 8.9820e+05 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 
* DR_BADNL C 2 2 5.9660e-04 1.6130e-04 -2.2230e-05 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 0.0000e+00 
\end{DoxyVerb}


where there are two lines for a given ion -\/ this is for helium (z=2) 2 (istate=2)\hypertarget{get_atomicdata.c_Dielectronic}{}\subsection{Recombination -\/ type 1}\label{get_atomicdata.c_Dielectronic}
This section reads in type 2 dielectronic recombination rates. The data comes from Chianti, and there are two types of dielectronic data. This is type 2 -\/ which has a fit decribed by Shull \& van Steenberg (1982) There are four fitting parameters. A typical ion data would look like this

\begin{DoxyVerb}* DR_SHULL 17 2 2.6510e-03 2.9300e-02 2.4120e+05 4.9410e+05 
\end{DoxyVerb}


where there are two lines for a given ion -\/ this is for z=17 (istate=2)\hypertarget{get_atomicdata.c_total}{}\subsection{radiative Recombination rates from Chianti -\/ type 1 and 2}\label{get_atomicdata.c_total}
!\+RR R\+A\+TE C\+O\+E\+F\+F\+I\+C\+I\+E\+NT F\+I\+TS (C)20110412 N. R. B\+A\+D\+N\+E\+LL, D\+E\+P\+A\+R\+T\+M\+E\+NT OF P\+H\+Y\+S\+I\+CS, U\+N\+I\+V\+E\+R\+S\+I\+TY OF S\+T\+R\+A\+T\+H\+C\+L\+Y\+DE, G\+L\+A\+S\+G\+OW G4 0\+NG, UK. !\+This is total radiative rate into all possible states or the recombined ion. !\+This data was downloaded from \href{http://amdpp.phys.strath.ac.uk/tamoc/DATA/RR/}{\tt http\+://amdpp.\+phys.\+strath.\+ac.\+uk/tamoc/\+D\+A\+T\+A/\+R\+R/} on 13/\+July/2013 !\+It is described in \href{http://adsabs.harvard.edu/abs/2006ApJS..167..334B}{\tt http\+://adsabs.\+harvard.\+edu/abs/2006\+Ap\+J\+S..\+167..\+334B} !\+Only modification to original file is to insert the B\+A\+D\+\_\+\+T\+\_\+\+RR label to the front of each line and comments !\+There are metastable levels in here, M=1 means we are recombining from the ground state, which is what we tend to want. Some of these have one four parameters, a fit introduced by Verner \& Ferland (1996) and some have six, which is from Gu (2003). A four parameter data type is shown below

\begin{DoxyVerb}* !  Z  N  M  W      A        B        T0         T1        C        T2
* BAD_T_RR  1  0  1  1  8.318E-11  0.7472  2.965E+00  7.001E+05
* BAD_T_RR  2  0  1  1  1.818E-10  0.7492  1.017E+01  2.786E+06
* BAD_T_RR  3  0  1  1  2.867E-10  0.7493  2.108E+01  6.268E+06
* BAD_T_RR  4  0  1  1  3.375E-10  0.7475  4.628E+01  1.121E+07
* BAD_T_RR  5  0  1  1  4.647E-10  0.7484  6.142E+01  1.753E+07
* \end{DoxyVerb}
\hypertarget{get_atomicdata.c_Total}{}\subsection{radiative recombination -\/ type 3}\label{get_atomicdata.c_Total}
These are some rare ion recombination rates that have a two parameter fit by Aldrovandi \& Pequignot (1973) They have data like \begin{DoxyVerb}* RR_SHULL 22 2 1.0965e-11 6.9901e-01 
* RR_SHULL 22 3 1.8600e-11 7.2800e-01 
* \end{DoxyVerb}


For erroneous historical reasons they are referred to as S\+H\+U\+LL\hypertarget{get_atomicdata.c_Ground}{}\subsection{state fractions}\label{get_atomicdata.c_Ground}
!\+RR R\+A\+TE C\+O\+E\+F\+F\+I\+C\+I\+E\+NT F\+I\+TS (C)20110412 N. R. B\+A\+D\+N\+E\+LL, D\+E\+P\+A\+R\+T\+M\+E\+NT OF P\+H\+Y\+S\+I\+CS, U\+N\+I\+V\+E\+R\+S\+I\+TY OF S\+T\+R\+A\+T\+H\+C\+L\+Y\+DE, G\+L\+A\+S\+G\+OW G4 0\+NG, UK. !\+This is resolved radiative rate from ground state to ground state. !\+This data was downloaded from \href{http://amdpp.phys.strath.ac.uk/tamoc/DATA/RR/}{\tt http\+://amdpp.\+phys.\+strath.\+ac.\+uk/tamoc/\+D\+A\+T\+A/\+R\+R/} on 13/\+July/2013 !\+It is described in \href{http://adsabs.harvard.edu/abs/2006ApJS..167..334B}{\tt http\+://adsabs.\+harvard.\+edu/abs/2006\+Ap\+J\+S..\+167..\+334B} !\+T\+He data comes as one file for each ion, with many rates. This file contains the first rate line in each file ! which should relate to the ground state of the upper ion recombining into the ground state of the recombined ion. !\+The data is tabulated in temperature, first line for each ion is temp, second is rate. !\+As with other Badnell data, first number is z, second is number of remianing electrons.

\begin{DoxyVerb}* BAD_GS_RR T 1 0 1.00E+01 2.00E+01 5.00E+01 1.00E+02 2.00E+02 5.00E+02 1.00E+03 2.00E+03 5.00E+03 1.00E+04 2.00E+04 5.00E+04 1.00E+05 2.00E+05 5.00E+05 1.00E+06 2.00E+06 5.00E+06 1.00E+07
* BAD_GS_RR R 1 0 5.21E-12 3.68E-12 2.33E-12 1.65E-12 1.16E-12 7.35E-13 5.18E-13 3.65E-13 2.28E-13 1.58E-13 1.08E-13 6.21E-14 3.88E-14 2.28E-14 1.01E-14 5.05E-15 2.36E-15 7.90E-16 3.27E-16
* \end{DoxyVerb}
\hypertarget{get_atomicdata.c_gaunt}{}\subsection{factor}\label{get_atomicdata.c_gaunt}
The following are lines to read in temperature averaged free-\/free gaunt factors from the data of Sutherland (1998). The atomic file is basically unchanged from the data on the website, just with the top few lines commented out, and a label prepended to each line The data is a spline fit to the gaunt factor as a function of g -\/ the reduced temperature. \begin{DoxyVerb} * # log(g^2) <gff(g^2)>       s1           s2            s3
 * # ------------------------------------------------------------
 * FF_GAUNT -4.00 1.113883E+00  1.348000E-02  1.047100E-02 -1.854972E-03
 * FF_GAUNT -3.80 1.116983E+00  1.744580E-02  9.358014E-03  5.564917E-03
 * FF_GAUNT -3.60 1.120891E+00  2.185680E-02  1.269696E-02  4.970250E-03
 * FF_GAUNT -3.40 1.125810E+00  2.753201E-02  1.567911E-02  6.429140E-03
* \end{DoxyVerb}
\hypertarget{get_atomicdata.c_direct}{}\subsection{(collisional) ionization data from Dere 07.}\label{get_atomicdata.c_direct}
\#\+Title\+: Ionization rate coefficients for elements H to Zn (Dere+, 2007) \#\+Table J\+\_\+\+A\+\_\+\+A\+\_\+466\+\_\+771\+\_\+table29\+: \#\+Title\+: Spline fits, multiplied by a factor of 10$^\wedge$6$^\wedge$, to the scaled ionization rate coefficients \#\+Column Z (I2) \mbox{[}1/30\mbox{]} Nuclear charge \mbox{[}ucd=phys.\+atmol.\+element\mbox{]} \#\+Column Ion (I2) \mbox{[}1/30\mbox{]} Ion (spectroscopic notation) \mbox{[}ucd=phys.\+atmol.\+ion\+Stage\mbox{]} \#\+Column Nspl (I2) \mbox{[}15/20\mbox{]} Number of splines \mbox{[}ucd=meta.\+number\mbox{]} \#\+Column I (F9.\+3) Ionization potential \mbox{[}ucd=phys.\+energy;phys.\+atmol.\+ionization\mbox{]} \#\+Column Tmin (E10.\+3) Minimum temperature \mbox{[}ucd=phys.\+temperature\mbox{]} \#\+Column x1-\/\+X20 (F7.\+4) Scaled temperature 1 (1) \mbox{[}ucd=phys.\+temperature\mbox{]} \#\+Column rho1 -\/rho20 (F8.\+4) ? Scaled rate coefficient 1 (2) \mbox{[}ucd=arith.\+rate;phys.\+atmol.\+collisional\mbox{]}\hypertarget{get_atomicdata.c_Electron}{}\subsection{yield -\/ goes with auger ionization rates}\label{get_atomicdata.c_Electron}
\#\+This is electron yield data from Kaastra \& Mewe (1993) -\/1993A\&AS...97..443K \#\+It is processed from data downloaded from \href{http://vizier.cfa.harvard.edu/viz-bin/VizieR?-source=J/A+AS/97/443}{\tt http\+://vizier.\+cfa.\+harvard.\+edu/viz-\/bin/\+Vizie\+R?-\/source=\+J/\+A+\+A\+S/97/443} \#\+Via the python script kaastra\+\_\+2\+\_\+py.\+py. Example lines of file below \# \begin{DoxyVerb}* #Label z state n l IP mean_electron_energy Prob_of_1e Prob_of_2e Prob_of_3e ....
* Kelecyield 4 1 1 0 1.1500e+02 9.280e+01 0.000e+00 1.000e+04 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00
* Kelecyield 5 1 1 0 1.9200e+02 1.639e+02 6.000e+00 9.994e+03 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00 0.000e+00
* \end{DoxyVerb}
\hypertarget{get_atomicdata.c_Fluorescent}{}\subsection{photon yield from inner shell ionization -\/ not currently used but read in.}\label{get_atomicdata.c_Fluorescent}
\#\+This is fluorescent yield data from Kaastra \& Mewe (1993) -\/1993A\&AS...97..443K \#\+It is processed from data downloaded from \href{http://vizier.cfa.harvard.edu/viz-bin/VizieR?-source=J/A+AS/97/443}{\tt http\+://vizier.\+cfa.\+harvard.\+edu/viz-\/bin/\+Vizie\+R?-\/source=\+J/\+A+\+A\+S/97/443} \#\+Via the python script kaastra\+\_\+2\+\_\+py.\+py. Data format below \# \begin{DoxyVerb}* #Label z state n l photon_energy yield
* Kphotyield 5 1 1 0 1.837e+02 6.000e-04
* Kphotyield 5 1 1 0 1.690e+01 7.129e-01
* \end{DoxyVerb}
\hypertarget{get_atomicdata.c_Chianti}{}\subsection{Collision Strengths}\label{get_atomicdata.c_Chianti}
The lines below read in collision strength data from Chianti (after Burgess and Tully). The original is stored in .scups files in chianti. The python script searches for matches to the lines\+\_\+linked\+\_\+ver\+\_\+2.\+py data file, on the basis of energy and oscillator strength (and z and state). As a rather hamfisted approach, all of the line data is stored on the same line as the collision strength data in the file, so it is possible to make a very accurate match. It does mean quite a lot is read in from a line, but most is thrown away. Currently the code below matches based on z, state, upper and lower level numbers and oscillator strength Each line is defned with a set of three lines first line is C\+S\+T\+R\+EN -\/ this contains line data to try and match Second two lines are collision strength data from Burgess and Tully 1992A\&A...254..436B These are generally 5 pojnt but up to 20 point spline fits of the T vs upsilon data. Typical lines are below \begin{DoxyVerb}CSTREN Line  1  1 1215.673584  0.139000   2   2     0.000000    10.200121    0    1       1      3   7.500e-01   2.772e-01   1.478e+00    5    1   1.700e+00
SCT   0.000e+00   2.500e-01   5.000e-01   7.500e-01   1.000e+00
SCUPS    1.132e-01   2.708e-01   5.017e-01   8.519e-01   1.478e+00        
 * \end{DoxyVerb}


\begin{DoxyVerb}\end{DoxyVerb}


Definition at line 223 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{get__atomicdata_8c_ae8afa865c507915363062a5abd9c32b7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253}\label{get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!index\+\_\+collisions@{index\+\_\+collisions}}
\index{index\+\_\+collisions@{index\+\_\+collisions}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{index\+\_\+collisions()}{index\_collisions()}}
{\footnotesize\ttfamily int index\+\_\+collisions (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



sorts the collisional lines into frequency order 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

The results are stored in xcol\+\_\+ptr 

Definition at line 3506 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{get__atomicdata_8c_af383eba7daf26143d507e52d54ea5253_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40}\label{get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!index\+\_\+inner\+\_\+cross@{index\+\_\+inner\+\_\+cross}}
\index{index\+\_\+inner\+\_\+cross@{index\+\_\+inner\+\_\+cross}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{index\+\_\+inner\+\_\+cross()}{index\_inner\_cross()}}
{\footnotesize\ttfamily int index\+\_\+inner\+\_\+cross (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Index inner shell xsections in frequency order. 

\begin{DoxyReturn}{Returns}
Alwasy returns 0
\end{DoxyReturn}
The rusults are stored in inner\+\_\+cross\+\_\+ptr

\paragraph*{Notes}

??? N\+O\+T\+ES ??? 

Definition at line 3448 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=265pt]{get__atomicdata_8c_aaa7775c752a4d5b3ea08fbd4f6395c40_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544}\label{get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!index\+\_\+lines@{index\+\_\+lines}}
\index{index\+\_\+lines@{index\+\_\+lines}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{index\+\_\+lines()}{index\_lines()}}
{\footnotesize\ttfamily int index\+\_\+lines (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



sort the lines into frequency order 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
\paragraph*{Notes}

All use a Numerical recipes routine indexx for this 

Definition at line 3333 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{get__atomicdata_8c_abc99f9b470fbc92f6639124ac0063544_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6}\label{get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!index\+\_\+phot\+\_\+top@{index\+\_\+phot\+\_\+top}}
\index{index\+\_\+phot\+\_\+top@{index\+\_\+phot\+\_\+top}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{index\+\_\+phot\+\_\+top()}{index\_phot\_top()}}
{\footnotesize\ttfamily int index\+\_\+phot\+\_\+top (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Index the topbase photoionzation crossections by frequency. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The results are stored in phot\+\_\+top\+\_\+ptr

\paragraph*{Notes}

Adapted from index\+\_\+lines as part to topbase addition to python 

Definition at line 3394 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=256pt]{get__atomicdata_8c_ae59f3a5d2afc543ec30ab6b7bce2c4a6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269}\label{get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!indexx@{indexx}}
\index{indexx@{indexx}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{indexx()}{indexx()}}
{\footnotesize\ttfamily void indexx (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{arrin}]{,  }\item[{indx}]{ }\end{DoxyParamCaption})}



Numerical recipes routine used by various routines to sort the atomic data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n The dimension of the array that needs sorting \\
\hline
\mbox{\tt in}  & {\em float} & arrin\mbox{[}\mbox{]} The array to sort \\
\hline
\mbox{\tt out}  & {\em int} & indx\mbox{[}\mbox{]} The array that contains poionters to the sorted array \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N/A
\end{DoxyReturn}
\paragraph*{Notes}

See nuerical recipes

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000029}{Bug}]Should probably replaces this with the equivalent gsl routine\end{DoxyRefDesc}


Definition at line 3570 of file get\+\_\+atomicdata.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=284pt]{get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=339pt]{get__atomicdata_8c_a8b5d80d6f35b55e30551b5ae6b5cc269_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{get__atomicdata_8c_a8cf338374390539709c962c60a953c3d}\label{get__atomicdata_8c_a8cf338374390539709c962c60a953c3d}} 
\index{get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}!limit\+\_\+lines@{limit\+\_\+lines}}
\index{limit\+\_\+lines@{limit\+\_\+lines}!get\+\_\+atomicdata.\+c@{get\+\_\+atomicdata.\+c}}
\subsubsection{\texorpdfstring{limit\+\_\+lines()}{limit\_lines()}}
{\footnotesize\ttfamily int limit\+\_\+lines (\begin{DoxyParamCaption}\item[{double}]{freqmin,  }\item[{double}]{freqmax }\end{DoxyParamCaption})}



(freqmin,freqmax) sets the the current values of line\+\_\+min and line\+\_\+max in \hyperlink{atomic_8h}{atomic.\+h} which can be used to limit the lines searched for resonances to a specific frequency range. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em double} & freqmin The minimum frequency we are interested in \\
\hline
\mbox{\tt in,out}  & {\em double} & freqmax The maximum frequency we are interested in \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of lines that are potentially in resonance.
\end{DoxyReturn}
If limit\+\_\+lines returns 0 there are no lines of interest and one does not need to worry about any resonances at this frequency. If limit\+\_\+lines returns a number greater than 0, then the lines of interest are defined by nline\+\_\+min and nline\+\_\+max (inclusive) in \hyperlink{atomic_8h}{atomic.\+h} nline\+\_\+delt is also set which is the number of lines that are in the specified range

limit\+\_\+lines define the lines that are close to a given frequency. The degree of closeness is defined by v. The routine must be used in conjuction with get\+\_\+atomic\+\_\+data which will have created an ordered list of the lines.

\paragraph*{Notes}

Limit\+\_\+lines needs to be used somewhat carefully. Carefully means checking the return value of limit\+\_\+lines or equivalently nline\+\_\+delt=0. If nline\+\_\+delt=0 then there were no lines in the region of interest. Assuming there were lines in thte range, one must sum over lines from nline\+\_\+min to nline\+\_\+max inclusive.

One might wonder why nline\+\_\+max is not set to one larger than the last line which is in range. This is because depending on how the velocity is trending you may want to sum from the highest frequency line to the lowest. 

Definition at line 3707 of file get\+\_\+atomicdata.\+c.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=245pt]{get__atomicdata_8c_a8cf338374390539709c962c60a953c3d_icgraph}
\end{center}
\end{figure}
