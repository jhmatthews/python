\hypertarget{zeta_8c}{}\section{/\+Users/mhewitt/python/source/zeta.c File Reference}
\label{zeta_8c}\index{/\+Users/mhewitt/python/source/zeta.\+c@{/\+Users/mhewitt/python/source/zeta.\+c}}


The routines in this file are to do with computing the correction to the Saha equation for a modified on the spot approach to ionization.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}recipes.\+h\char`\"{}}\newline
Include dependency graph for zeta.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{zeta_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{zeta_8c_a97b9295c2ccd68eab06cce70209049a2}{M\+I\+N\+\_\+\+F\+U\+D\+GE}~1.e-\/10
\item 
\#define \hyperlink{zeta_8c_ad2c6aa71bd92481ca7a8eabb14cae1e0}{M\+A\+X\+\_\+\+F\+U\+D\+GE}~10.
\item 
\#define \hyperlink{zeta_8c_af7e87bb3f38e7b4eed703578b90cd3a4}{T\+M\+IN}~2000.  /$\ast$ Thia T\+M\+IN is specific to CK\textquotesingle{}s ground \hyperlink{util_8c_adb5b0074d608e468f0d9a9f8493d4154}{fraction} tables $\ast$/
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{zeta_8c_a54a60a3cfc21ceae39f7c529519c25ae}{compute\+\_\+zeta} (double temp, int nion, int mode)
\begin{DoxyCompactList}\small\item\em calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equation \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The routines in this file are to do with computing the correction to the Saha equation for a modified on the spot approach to ionization. 

\begin{DoxyAuthor}{Author}
ksl,nsh 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
April, 2018 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{zeta_8c_ad2c6aa71bd92481ca7a8eabb14cae1e0}\label{zeta_8c_ad2c6aa71bd92481ca7a8eabb14cae1e0}} 
\index{zeta.\+c@{zeta.\+c}!M\+A\+X\+\_\+\+F\+U\+D\+GE@{M\+A\+X\+\_\+\+F\+U\+D\+GE}}
\index{M\+A\+X\+\_\+\+F\+U\+D\+GE@{M\+A\+X\+\_\+\+F\+U\+D\+GE}!zeta.\+c@{zeta.\+c}}
\subsubsection{\texorpdfstring{M\+A\+X\+\_\+\+F\+U\+D\+GE}{MAX\_FUDGE}}
{\footnotesize\ttfamily \#define M\+A\+X\+\_\+\+F\+U\+D\+GE~10.}

\mbox{\Hypertarget{zeta_8c_a97b9295c2ccd68eab06cce70209049a2}\label{zeta_8c_a97b9295c2ccd68eab06cce70209049a2}} 
\index{zeta.\+c@{zeta.\+c}!M\+I\+N\+\_\+\+F\+U\+D\+GE@{M\+I\+N\+\_\+\+F\+U\+D\+GE}}
\index{M\+I\+N\+\_\+\+F\+U\+D\+GE@{M\+I\+N\+\_\+\+F\+U\+D\+GE}!zeta.\+c@{zeta.\+c}}
\subsubsection{\texorpdfstring{M\+I\+N\+\_\+\+F\+U\+D\+GE}{MIN\_FUDGE}}
{\footnotesize\ttfamily \#define M\+I\+N\+\_\+\+F\+U\+D\+GE~1.e-\/10}

\mbox{\Hypertarget{zeta_8c_af7e87bb3f38e7b4eed703578b90cd3a4}\label{zeta_8c_af7e87bb3f38e7b4eed703578b90cd3a4}} 
\index{zeta.\+c@{zeta.\+c}!T\+M\+IN@{T\+M\+IN}}
\index{T\+M\+IN@{T\+M\+IN}!zeta.\+c@{zeta.\+c}}
\subsubsection{\texorpdfstring{T\+M\+IN}{TMIN}}
{\footnotesize\ttfamily \#define T\+M\+IN~2000.  /$\ast$ Thia T\+M\+IN is specific to CK\textquotesingle{}s ground \hyperlink{util_8c_adb5b0074d608e468f0d9a9f8493d4154}{fraction} tables $\ast$/}



\subsection{Function Documentation}
\mbox{\Hypertarget{zeta_8c_a54a60a3cfc21ceae39f7c529519c25ae}\label{zeta_8c_a54a60a3cfc21ceae39f7c529519c25ae}} 
\index{zeta.\+c@{zeta.\+c}!compute\+\_\+zeta@{compute\+\_\+zeta}}
\index{compute\+\_\+zeta@{compute\+\_\+zeta}!zeta.\+c@{zeta.\+c}}
\subsubsection{\texorpdfstring{compute\+\_\+zeta()}{compute\_zeta()}}
{\footnotesize\ttfamily double compute\+\_\+zeta (\begin{DoxyParamCaption}\item[{double}]{temp,  }\item[{int}]{nion,  }\item[{int}]{mode }\end{DoxyParamCaption})}



calculates the correction term used in in the L+M and Sim equations as a modfication to the Saha equation 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & temp The temperature for the calculation \\
\hline
\mbox{\tt in}  & {\em int} & nion the ion we are recombining to \\
\hline
\mbox{\tt in}  & {\em int} & mode The mode allow that controls how zeta is calcuated \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
zeta, the correction factor to the recombination rates.
\end{DoxyReturn}
zeta is part of correction factor suggested in L\+M93 in a modified version of the on-\/the spot approximation. Specifically it is the fraction of recombinations that go directly to the ground state Saha equation.


\begin{DoxyItemize}
\item mode 1 is the original version, it takes ilow, ihi and interpfrac and interpolates in the ground state fraction table.
\item mode 2 attempts to modify zeta by application of the dielectronic recombination rate -\/ this calculates zeta from first principles using ground state recombination rates and total recombination rates. It defaults to mode 1 if is it missing data but it returns an error.

The program will exit if the mode is unknown.
\end{DoxyItemize}

\paragraph*{Notes}

Values for zeta were tabulated by CK (circa 2000)

When compute\+\_\+zeta is called, nion is the lower ion in the pair whose abundances are being calculated. Calls to the various recombination rate coefficient subroutines are made with nion+1, since these rates are tabulated for the recombining ion.

The data are read in by \hyperlink{get__atomicdata_8c}{get\+\_\+atomicdata.\+c} (around line 2100) 

Definition at line 64 of file zeta.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{zeta_8c_a54a60a3cfc21ceae39f7c529519c25ae_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{zeta_8c_a54a60a3cfc21ceae39f7c529519c25ae_icgraph}
\end{center}
\end{figure}
