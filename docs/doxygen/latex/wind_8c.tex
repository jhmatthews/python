\hypertarget{wind_8c}{}\section{/\+Users/mhewitt/python/source/wind.c File Reference}
\label{wind_8c}\index{/\+Users/mhewitt/python/source/wind.\+c@{/\+Users/mhewitt/python/source/wind.\+c}}


Except for where\+\_\+in\+\_\+wind, these are convenience routines which make it easier to incorporate wind models into Python.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for wind.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac}{where\+\_\+in\+\_\+wind} (\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, int $\ast$ndomain)
\begin{DoxyCompactList}\small\item\em determines whether a position x is in a wind region. \end{DoxyCompactList}\item 
double \hyperlink{wind_8c_ae04150c3a36a71098fa438ec9401e40d}{model\+\_\+velocity} (int ndom, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, \hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v})
\begin{DoxyCompactList}\small\item\em Calculate the wind velocity at a specific point in space from the original usually analytic expressions. \end{DoxyCompactList}\item 
int \hyperlink{wind_8c_aecc0364b3155b294b0590e9900867bfb}{model\+\_\+vgrad} (int ndom, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}, v\+\_\+grad)
\begin{DoxyCompactList}\small\item\em calculate the velocity gradient at positions in the flow based on the analytic wind models and imported models. \end{DoxyCompactList}\item 
double \hyperlink{wind_8c_a6190258be2516eb521132d5a1ec1886f}{model\+\_\+rho} (int ndom, \hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x})
\begin{DoxyCompactList}\small\item\em calculate the density of the wind in from the flow based on the analytic wind models. \end{DoxyCompactList}\item 
int \hyperlink{wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d}{wind\+\_\+check} (\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr} www, int n)
\begin{DoxyCompactList}\small\item\em Simple checks of the wind structure for reasonability. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Except for where\+\_\+in\+\_\+wind, these are convenience routines which make it easier to incorporate wind models into Python. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
April, 2018
\end{DoxyDate}
where\+\_\+in\+\_\+wind determines whether a position is x is in the wind and if so in what domain. Since grid can overlap, the Python convention is that the domains are overlaid on one another, and the last one is the one that matters at a particular postion. where\+\_\+in\+\_\+wind is therefore one of the basic utilites to determine where one is at any time.

In Python, the actual radiative transfer is carried on various grids (domains). During radiative transfer quatnities like velocity and density are obtained by interpolating on values in the grid, and not from the formulae that defince for, e. g. a SV model. The routines, here model\+\_\+velocity, model\+\_\+vgrad, model\+\_\+rho, etc are used to populate the grid.

\paragraph*{Notes}

The file also contains a routine wind\+\_\+check that probably could be removed altogether, as it has not revealed a problem in a very long time. 

\subsection{Function Documentation}
\mbox{\Hypertarget{wind_8c_a6190258be2516eb521132d5a1ec1886f}\label{wind_8c_a6190258be2516eb521132d5a1ec1886f}} 
\index{wind.\+c@{wind.\+c}!model\+\_\+rho@{model\+\_\+rho}}
\index{model\+\_\+rho@{model\+\_\+rho}!wind.\+c@{wind.\+c}}
\subsubsection{\texorpdfstring{model\+\_\+rho()}{model\_rho()}}
{\footnotesize\ttfamily double model\+\_\+rho (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{ }\end{DoxyParamCaption})}



calculate the density of the wind in from the flow based on the analytic wind models. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} A position in the domain \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
rho at the position
\end{DoxyReturn}
The checks the wind type for this domain, e.\+g SV, and then calls the appropriate routine to that model, e.\+g sv\+\_\+rho, to get the density

\paragraph*{Notes}

This routine is normally only used during the initialization of the wind 

Definition at line 380 of file wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind_8c_a6190258be2516eb521132d5a1ec1886f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind_8c_ae04150c3a36a71098fa438ec9401e40d}\label{wind_8c_ae04150c3a36a71098fa438ec9401e40d}} 
\index{wind.\+c@{wind.\+c}!model\+\_\+velocity@{model\+\_\+velocity}}
\index{model\+\_\+velocity@{model\+\_\+velocity}!wind.\+c@{wind.\+c}}
\subsubsection{\texorpdfstring{model\+\_\+velocity()}{model\_velocity()}}
{\footnotesize\ttfamily double model\+\_\+velocity (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{,  }\item[{\hyperlink{import__spherical_8c_ac2915aad3a05ff2328a7ad7fa6d37e86}{v}}]{ }\end{DoxyParamCaption})}



Calculate the wind velocity at a specific point in space from the original usually analytic expressions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt out}  & {\em double} & x\mbox{[}\mbox{]} A position (nominally in the domain) \\
\hline
\mbox{\tt out}  & {\em double} & v\mbox{[}\mbox{]} The resulting velicity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The speed at that postion
\end{DoxyReturn}
This is a convenience function that allows one to obtain the velocity at any point in space for a given domain. The routine uses the domain number to decide what velocity law is appriate. For models which are defined from a set of parametric equations the velocity will sill be calculated. For models that are read in as a grid, the models will be interpolated from the imported grid

\paragraph*{Notes}

This routine is used to set up the grid of velocities at the corners of grid cells. It is not used later on. 

Definition at line 236 of file wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind_8c_ae04150c3a36a71098fa438ec9401e40d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{wind_8c_ae04150c3a36a71098fa438ec9401e40d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind_8c_aecc0364b3155b294b0590e9900867bfb}\label{wind_8c_aecc0364b3155b294b0590e9900867bfb}} 
\index{wind.\+c@{wind.\+c}!model\+\_\+vgrad@{model\+\_\+vgrad}}
\index{model\+\_\+vgrad@{model\+\_\+vgrad}!wind.\+c@{wind.\+c}}
\subsubsection{\texorpdfstring{model\+\_\+vgrad()}{model\_vgrad()}}
{\footnotesize\ttfamily int model\+\_\+vgrad (\begin{DoxyParamCaption}\item[{int}]{ndom,  }\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{,  }\item[{v\+\_\+grad}]{ }\end{DoxyParamCaption})}



calculate the velocity gradient at positions in the flow based on the analytic wind models and imported models. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & ndom The domain of interest \\
\hline
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} A position in the domain \\
\hline
\mbox{\tt out}  & {\em double} & v\+\_\+grad\mbox{[}\mbox{]}\mbox{[}3\mbox{]} The velocity gradient tensor at the postion \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routien calls model\+\_\+velocity multiple times to calculate the velocity gradient tensor at a particular position.

\paragraph*{Notes}

This routine is normally used only during the initialization of the wind 

Definition at line 315 of file wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind_8c_aecc0364b3155b294b0590e9900867bfb_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac}\label{wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac}} 
\index{wind.\+c@{wind.\+c}!where\+\_\+in\+\_\+wind@{where\+\_\+in\+\_\+wind}}
\index{where\+\_\+in\+\_\+wind@{where\+\_\+in\+\_\+wind}!wind.\+c@{wind.\+c}}
\subsubsection{\texorpdfstring{where\+\_\+in\+\_\+wind()}{where\_in\_wind()}}
{\footnotesize\ttfamily int where\+\_\+in\+\_\+wind (\begin{DoxyParamCaption}\item[{\hyperlink{import__cylindrical_8c_a099bc7b5a9501685180c163c1ffb67d0}{x}}]{,  }\item[{int $\ast$}]{ndomain }\end{DoxyParamCaption})}



determines whether a position x is in a wind region. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em double} & x\mbox{[}\mbox{]} a position \\
\hline
\mbox{\tt out}  & {\em int} & $\ast$ ndomain the wind domain that the position lies in, if it does \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
W\+\_\+\+A\+L\+L\+\_\+\+I\+N\+W\+I\+ND if the position is in a wind, W\+\_\+\+I\+N\+\_\+\+D\+I\+SK if inside a vertically extended disk, W\+\_\+\+N\+O\+T\+\_\+\+I\+N\+W\+I\+ND otherwise
\end{DoxyReturn}
where\+\_\+in\+\_\+wind searches the wind domains in reverse order to decide whether a position in a particular wind domain or not. For most types of wind, where the edges of the wind are defined by wind\+\_\+cones and by min and max radii etc. For imported models, where the wind\+\_\+cones are insufficient, we check whether the position is in a cell that is in the wind.

\paragraph*{Notes}

Since domains can overlap in principle, e.\+g one can have say a bipolar wind which starts at the disk surface and goes to a very large radius, and then a coronal just above the disk, one needs a convention to know which domain to use when there are two possibilities. The Python convention is to lay the grids on top of one another so that the last one matters when there is a conflict. For this reason the grids are searched in reverse order.

Where\+\_\+in\+\_\+wind does not tell you whether a position is in the grid or not, just whether he photon is between the two wind cones and/or inside minimum or maximum radius of the wind. 

Definition at line 78 of file wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{wind_8c_a5f63dccb9b43b11cc312ab51e4d0d0ac_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d}\label{wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d}} 
\index{wind.\+c@{wind.\+c}!wind\+\_\+check@{wind\+\_\+check}}
\index{wind\+\_\+check@{wind\+\_\+check}!wind.\+c@{wind.\+c}}
\subsubsection{\texorpdfstring{wind\+\_\+check()}{wind\_check()}}
{\footnotesize\ttfamily int wind\+\_\+check (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad957272e4ddecfb558775b2aeddf2ac4}{Wind\+Ptr}}]{www,  }\item[{int}]{n }\end{DoxyParamCaption})}



Simple checks of the wind structure for reasonability. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em Wind\+Ptr} & www The entire wind \\
\hline
\mbox{\tt in,out}  & {\em int} & n n $>$= 0 then an element of the array will be checked \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine should be called in a number of ways


\begin{DoxyItemize}
\item wind\+\_\+check(w,-\/1); to check the entire structure
\item wind\+\_\+check(w,50); to check element 50 of the structure
\item wind\+\_\+check(w\mbox{[}50\mbox{]},0) to check elemetn 50 of the structure
\end{DoxyItemize}

\paragraph*{Notes}

These checks are so basic, just NaN (sane\+\_\+checks), that they hardly seem worth doing. One would think one would want to stop the program if any of them failed. But this does not take much time.

The checks are made on the wind, without reference to domains 

Definition at line 460 of file wind.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=298pt]{wind_8c_aa5de177d6e8fc4d6d0becf0c2898b90d_icgraph}
\end{center}
\end{figure}
