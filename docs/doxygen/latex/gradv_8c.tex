\hypertarget{gradv_8c}{}\section{/\+Users/mhewitt/python/source/gradv.c File Reference}
\label{gradv_8c}\index{/\+Users/mhewitt/python/source/gradv.\+c@{/\+Users/mhewitt/python/source/gradv.\+c}}


Routines related to calculating velocity gradients.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}atomic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}python.\+h\char`\"{}}\newline
Include dependency graph for gradv.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gradv_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{gradv_8c_a0ae0cb9bce1fbaa25bf7e787b9f73f6d}{N\+\_\+\+D\+V\+D\+S\+\_\+\+A\+VE}~10000
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{gradv_8c_a96c552f69871659978a481c47617fc6c}{dvwind\+\_\+ds} (\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr} p)
\begin{DoxyCompactList}\small\item\em find the gradient velocity vector v, dv\+\_\+ds for a photon at a certain postion travelling in a certain direction \end{DoxyCompactList}\item 
int \hyperlink{gradv_8c_a235a802835206be746f7ab4cd2d90129}{dvds\+\_\+ave} ()
\begin{DoxyCompactList}\small\item\em Calculate the direction averaged (and maximum) dv\+\_\+ds in each grid cell of the wind. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Routines related to calculating velocity gradients. 

\begin{DoxyAuthor}{Author}
ksl 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
January, 2018 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{gradv_8c_a0ae0cb9bce1fbaa25bf7e787b9f73f6d}\label{gradv_8c_a0ae0cb9bce1fbaa25bf7e787b9f73f6d}} 
\index{gradv.\+c@{gradv.\+c}!N\+\_\+\+D\+V\+D\+S\+\_\+\+A\+VE@{N\+\_\+\+D\+V\+D\+S\+\_\+\+A\+VE}}
\index{N\+\_\+\+D\+V\+D\+S\+\_\+\+A\+VE@{N\+\_\+\+D\+V\+D\+S\+\_\+\+A\+VE}!gradv.\+c@{gradv.\+c}}
\subsubsection{\texorpdfstring{N\+\_\+\+D\+V\+D\+S\+\_\+\+A\+VE}{N\_DVDS\_AVE}}
{\footnotesize\ttfamily \#define N\+\_\+\+D\+V\+D\+S\+\_\+\+A\+VE~10000}



Definition at line 159 of file gradv.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{gradv_8c_a235a802835206be746f7ab4cd2d90129}\label{gradv_8c_a235a802835206be746f7ab4cd2d90129}} 
\index{gradv.\+c@{gradv.\+c}!dvds\+\_\+ave@{dvds\+\_\+ave}}
\index{dvds\+\_\+ave@{dvds\+\_\+ave}!gradv.\+c@{gradv.\+c}}
\subsubsection{\texorpdfstring{dvds\+\_\+ave()}{dvds\_ave()}}
{\footnotesize\ttfamily int dvds\+\_\+ave (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Calculate the direction averaged (and maximum) dv\+\_\+ds in each grid cell of the wind. 

\begin{DoxyReturn}{Returns}
Always returns 0
\end{DoxyReturn}
The routine cycles through all of the cells in the wind, and calculates the aveage value of dv\+\_\+ds at the center of the wind cell by randomly generating directions and then calculating dv\+\_\+ds in these directions

It not only finds the average value, it also keeps track of the maximum value of dvds and its direction

\paragraph*{Notes}

The routine is called during the intialization process and fills the following elements of wmain


\begin{DoxyItemize}
\item dvds\+\_\+ave -\/ the average dvds
\item dvds\+\_\+max -\/ the maximum value of dvds
\item lmn -\/ the direction of the maximum value
\end{DoxyItemize}

There is an advanced mode which prints this information to file. 

Definition at line 191 of file gradv.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=216pt]{gradv_8c_a235a802835206be746f7ab4cd2d90129_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=347pt]{gradv_8c_a235a802835206be746f7ab4cd2d90129_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{gradv_8c_a96c552f69871659978a481c47617fc6c}\label{gradv_8c_a96c552f69871659978a481c47617fc6c}} 
\index{gradv.\+c@{gradv.\+c}!dvwind\+\_\+ds@{dvwind\+\_\+ds}}
\index{dvwind\+\_\+ds@{dvwind\+\_\+ds}!gradv.\+c@{gradv.\+c}}
\subsubsection{\texorpdfstring{dvwind\+\_\+ds()}{dvwind\_ds()}}
{\footnotesize\ttfamily double dvwind\+\_\+ds (\begin{DoxyParamCaption}\item[{\hyperlink{python_8h_ad2424d53ebcf811656882a87e11b440c}{Phot\+Ptr}}]{p }\end{DoxyParamCaption})}



find the gradient velocity vector v, dv\+\_\+ds for a photon at a certain postion travelling in a certain direction 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Phot\+Ptr} & p A photon \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
dvds on successful completion the value of where in grid if the photon outside the wind grid.
\end{DoxyReturn}
\paragraph*{Notes}

For spherical coordinates the routine calculates the gradient on the fly, that is moves the photon a bit and calculates dvds

For 2d systems, the velocity gradient is calculated using the velocity gradient tensors, which contain the velocity gradient in the xz plane.

It\textquotesingle{}s not clear how much faster the method used for 2d systems actually is, and one might want to consider the on-\/the-\/ fly appoach for all systems. 

Definition at line 47 of file gradv.\+c.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gradv_8c_a96c552f69871659978a481c47617fc6c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{gradv_8c_a96c552f69871659978a481c47617fc6c_icgraph}
\end{center}
\end{figure}
